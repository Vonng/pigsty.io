<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="/zh/docs/reference/">
<link rel="alternate" type="application/rss&#43;xml" href="/zh/docs/reference/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>参考信息 | Pigsty</title>
<meta name="description" content="详细的参考信息与列表：支持的操作系统，模块，参数，监控指标，数据库扩展，同类对比，术语表等。">
<meta property="og:title" content="参考信息" />
<meta property="og:description" content="详细的参考信息与列表：支持的操作系统，模块，参数，监控指标，数据库扩展，同类对比，术语表等。" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/zh/docs/reference/" />

<meta itemprop="name" content="参考信息">
<meta itemprop="description" content="详细的参考信息与列表：支持的操作系统，模块，参数，监控指标，数据库扩展，同类对比，术语表等。"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="参考信息"/>
<meta name="twitter:description" content="详细的参考信息与列表：支持的操作系统，模块，参数，监控指标，数据库扩展，同类对比，术语表等。"/>




<link rel="preload" href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" as="style">
<link href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" rel="stylesheet" integrity="">

<script
  src="/js/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="/js/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-LG1V9WTKGE');
}
</script>
  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/zh/"><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class="navbar-brand__name">Pigsty</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/zh/docs/"><i class='fa-solid fa-book'></i><span>文档</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/zh/blog/"><i class="fas fa-blog"></i><span>博客</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/Vonng/pigsty/" target="_blank" rel="noopener"><i class='fab fa-github'></i><span>GitHub</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <i class="fa-solid fa-language"></i>中文</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/docs/reference/">English</a></li>
    </ul>
</div>
</li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.4125b29715bb03f7dec1973b107267cd.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/zh/docs/reference/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">参考信息</h1>
<div class="lead">详细的参考信息与列表：支持的操作系统，模块，参数，监控指标，数据库扩展，同类对比，术语表等。</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-d1a5b117e7245bf2c0440d8ef0d4582a">OS兼容性</a></li>


    
  
    
    
	
<li>2: <a href="#pg-edd87fdd8acaabad7b8183cbb20b2318">参数列表</a></li>


    
  
    
    
	
<li>3: <a href="#pg-e702b44e01d91c35371415f67a25ac19">扩展列表</a></li>


    
  
    
    
	
<li>4: <a href="#pg-eccd19a576ee933ff16667af4533c033">文件结构</a></li>


    
  
    
    
	
<li>5: <a href="#pg-84ae7ee461c44a3c65150c096169dfc2">同类对比</a></li>


    
  
    
    
	
<li>6: <a href="#pg-724a9899719548b393b18b25ed0323cb">成本参考</a></li>


    
  
    
    
	
<li>7: <a href="#pg-dbab37f93e145eb07dbd2362106ccd61">术语列表</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-d1a5b117e7245bf2c0440d8ef0d4582a">1 - OS兼容性</h1>
    <div class="lead">Pigsty 兼容的操作系统发行版、内核与架构，PostgreSQL 大版本支持策略，不同环境下的可用的功能集差异。</div>
	<hr>
<h2 id="概述">概述</h2>
<p>Pigsty 建议使用 <strong>Linux</strong> 内核，<strong>amd64</strong> 架构的节点，使用 <strong>RockyLinux 8.9</strong>，<strong>Debian 12</strong> 或 <strong>Ubuntu 22.04</strong> 操作系统。</p>
<p><a href="/zh/docs/reference/compatibility/#内核架构兼容性"><strong>内核架构兼容性</strong></a>：<code>Linux</code> 内核，<code>amd64</code>/<code>arm64</code> 架构（<code>x86_64</code>/<code>arm64</code>）</p>
<p><a href="/zh/docs/reference/compatibility/#el系发行版支持"><strong>EL发行版支持</strong></a>： <strong>EL7</strong>（已经EOL，在专业版中提供支持），<strong>EL8</strong>，<strong>EL9</strong> ；（RHEL, Rocky, CentOS, Alma, Oracle, Anolis,&hellip;）</p>
<p><a href="/zh/docs/reference/compatibility/#debian系发行版支持"><strong>Debian系发行版支持</strong></a>：<strong>Ubuntu</strong> <strong>24.04</strong> <code>noble</code>, <strong>22.04</strong> <code>jammy</code>, <strong>20.04</strong> <code>focal</code>；<strong>Debian 12</strong> <code>bookworm</code> 与 <strong>11</strong> <code>bullseye</code> (EOL)。</p>
<p>Pigsty 不使用任何虚拟化容器化技术，直接运行于裸操作系统上。
<strong>EL</strong> 是我们长期支持的主力核心操作系统，而 Ubuntu/Debian 系统的支持近期于 v2.5 版本中引入。
EL 系与 Debian 系的主要差别是：软件包名有显著差异，以及默认可用的 PostgreSQL <a href="https://ext.pigsty.io/#list"><strong>扩展插件</strong></a> 会有所不同。</p>
<p>我们强烈建议使用 <strong>RockyLinux 8.9</strong> 或 <strong>Ubuntu 22.04.3 LTS</strong> 作为安装 Pigsty 的操作系统。</p>
<p>如果您有对兼容性的高级需求，例如使用特定操作系统发行版大小版本，支持特定版本的 PostgreSQL，我们亦提供专业的 <a href="/zh/docs/about/service"><strong>服务支持</strong></a> 选项（ <i class="fas fa-circle-check text-secondary"></i> ）。</p>
<table>
<thead>
<tr>
<th style="text-align:center">Code</th>
<th>Distro</th>
<th style="text-align:center"><code>x86_64</code></th>
<th style="text-align:center">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
<th style="text-align:center"><code>Arm64</code></th>
<th style="text-align:right">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>EL9</strong></td>
<td>RHEL 9 / Rocky9 / Alma9</td>
<td style="text-align:center"><code>el9.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><code>el9.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>EL8</strong></td>
<td>RHEL 8 / Rocky8 / Alma8 / Anolis8</td>
<td style="text-align:center"><code>el8.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><code>el8.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>U24</strong></td>
<td>Ubuntu 24.04 (noble)</td>
<td style="text-align:center"><code>u24.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><code>u24.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>U22</strong></td>
<td>Ubuntu 22.04 (jammy)</td>
<td style="text-align:center"><code>u22.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><code>u22.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>D12</strong></td>
<td>Debian 12 (bookworm)</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><code>d12.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>D11</strong></td>
<td>Debian 11 (bullseye)</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><code>d11.arm64</code></td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>U20</strong></td>
<td>Ubuntu 20.04 (focal)</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><code>u20.arm64</code></td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>EL7</strong></td>
<td>RHEL7 / CentOS7</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><code>el7.arm64</code></td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<hr>
<h2 id="内核架构兼容性">内核架构兼容性</h2>
<p>Pigsty 目前支持 <strong>Linux</strong> 内核，<code>x86_64</code> / <code>amd64</code> 芯片架构。</p>
<p>MacOS 与 Windows 操作系统可以通过 Linux 虚拟机/容器的方式安装 Pigsty。
我们提供了 <a href="/zh/docs/setup/provision/"><strong>Vagrant</strong></a> 本地沙箱支持，可以在其他操作系统上使用 Vagrant 和 Virtualbox/Libvirt/VMWare 等虚拟化软件一键拉起 Pigsty 所需的部署环境。</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">ARM64 支持</h4>

    我们在 <a href="/zh/docs/about/service">企业级订阅服务</a> 中试点提供部分国产操作系统/国产芯片的 <code>arm64</code> 架构支持，目前支持 EL9, Ubuntu 22.04, Debian 12 以及 Anolis / Euler 等国产操作系统。

</div>

<hr>
<h2 id="el系发行版支持">EL系发行版支持</h2>
<p>EL 系操作系统是 Pigsty 的首要支持目标，包括 Red Hat Enterprise Linux，RockyLinux，CentOS，AlmaLinux，OracleLinux, Anolis 等兼容发行版，Pigsty 支持最近三个大版本： <strong>7</strong>，<strong>8</strong>，<strong>9</strong></p>
<ul>
<li><strong>EL9</strong>： RHEL，RockyLinux，AlmaLinux （<i class="fas fa-star text-secondary"></i> 推荐使用 Rocky 9.3）</li>
<li><strong>EL8</strong>： RHEL，RockyLinux，AlmaLinux，Anolis（推荐使用 Rocky 8.9）</li>
<li><strong>EL7</strong>： RHEL，CentOS 7.9 （推荐使用 CentOS 7.9，已在开源版本中弃用！）</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">代码</th>
<th>发行版</th>
<th>小版本</th>
<th style="text-align:center">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
<th>局限性</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>EL9</strong></td>
<td>RHEL 9 / Rocky9 / Alma9</td>
<td>9.4</td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td><i class="fas fa-star text-secondary"></i> <strong>EL系标准功能集</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>EL8</strong></td>
<td>RHEL 8 / Rocky8 / Alma8 / Anolis8</td>
<td>8.10</td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td><i class="fas fa-triangle-exclamation text-secondary"></i> 缺少 <code>pljava</code> 扩展，<code>arm</code> 缺包</td>
</tr>
<tr>
<td style="text-align:center"><strong>EL7</strong></td>
<td>RHEL7 / CentOS7</td>
<td>7.9</td>
<td style="text-align:center"><i class="fas fa-triangle-exclamation text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-triangle-exclamation text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td><i class="fas fa-triangle-exclamation text-danger"></i> EOL，PG16/17, 大部分三方扩展不可用</td>
</tr>
</tbody>
</table>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">建议使用 RockyLinux 9.4</h4>

    <i class="fas fa-star text-secondary"></i>
Rocky 9.4 在系统可靠性/稳定性与软件版本的新颖性/齐全性上取得了良好的平衡，建议 EL 系用户默认使用此系统版本。

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">EL7 弃用通知</h4>

    <p><i class="fas fa-triangle-exclamation text-danger"></i>
Red Hat Enterprise Linux 7 已经于 2024年6月<a href="https://www.redhat.com/en/blog/end-maintenance-red-hat-enterprise-linux-7-almost-here">停止维护</a>，同时 PGDG 也不再为 PostgreSQL 16 提供 EL7 二进制包支持。</p>
<p>Pigsty <a href="/zh/docs/about/service">专业版订阅</a> 中提供针对 EL7 操作系统的扩展支持。</p>


</div>

<hr>
<h2 id="debian系发行版支持">Debian系发行版支持</h2>
<p>Pigsty 支持 <strong>Ubuntu</strong> / <strong>Debian</strong> 系操作系统及其兼容发行版，目前支持范围为两个最近的 LTS 大版本，即：</p>
<ul>
<li><strong>U22</strong>： Ubuntu 22.04 jammy（推荐使用 22.04.3 LTS）</li>
<li><strong>D12</strong>： Debian 12 bookworm（推荐使用 12.7）</li>
<li><strong>U20</strong>： Ubuntu 20.04 focal（推荐使用 20.04.6 LTS，已弃用支持）</li>
<li><strong>D11</strong>： Debian 11 bullseye（推荐使用 11.11，已弃用支持）</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">代码</th>
<th>Debian系发行版</th>
<th>小版本</th>
<th style="text-align:center">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
<th>局限性</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>U24</strong></td>
<td>Ubuntu 24.04 (jammy)</td>
<td>24.04.1</td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td><i class="fas fa-star text-secondary"></i> 少部分扩展包缺失</td>
</tr>
<tr>
<td style="text-align:center"><strong>U22</strong></td>
<td>Ubuntu 22.04 (jammy)</td>
<td>22.04.3</td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td><i class="fas fa-star text-secondary"></i> <strong>Debian标准功能集</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>D12</strong></td>
<td>Debian 12 (bookworm)</td>
<td>12.4</td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td><i class="fas fa-star text-secondary"></i> 缺少 PolarDB，Babelfish，PGML</td>
</tr>
<tr>
<td style="text-align:center"><strong>D11</strong></td>
<td>Debian 11 (bullseye)</td>
<td>11.8</td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td><i class="fas fa-triangle-exclamation text-secondary"></i> 已弃用支持</td>
</tr>
<tr>
<td style="text-align:center"><strong>U20</strong></td>
<td>Ubuntu 20.04 (focal)</td>
<td>20.04.6</td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-secondary"></i></td>
<td><i class="fas fa-triangle-exclamation text-secondary"></i> 已弃用支持</td>
</tr>
</tbody>
</table>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">建议使用 Ubuntu 22.04 LTS / Debian 12</h4>

    <i class="fas fa-star text-secondary"></i>
Ubuntu 22.04 与 Debian 12 在系统可靠性/稳定性与软件版本的新颖性/齐全性上取得了良好的平衡，建议 Debian 系用户默认使用此系统版本。

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Ubuntu 20.04 / Debian 11 弃用通知</h4>

    <p><i class="fas fa-triangle-exclamation text-secondary"></i>
Debian 11 已经于 2024-07 进入 EOL，Ubuntu 20.04 将于 2025-04 进入 EOL。</p>
<p>Pigsty 将不再针对 Debian 11 / Ubuntu 20.04 提供新功能支持与扩展插件打包服务。</p>
<p>Pigsty <a href="/zh/docs/about/service">专业版订阅</a> 中提供针对 Debian 11 / Ubuntu 20.04 两个操作系统大版本的扩展支持。</p>


</div>

<hr>
<h2 id="vagrant-镜像参考">Vagrant 镜像参考</h2>
<p>当您使用云服务器部署 Pigsty 时，可以考虑在 Vagrant 中使用以下操作系统镜像，这也是 Pigsty 开发测试构建使用的镜像。</p>
<ul>
<li><a href="https://app.vagrantup.com/generic/boxes/centos7"><code>generic/centos7</code></a>： CentOS 7.9</li>
<li><a href="https://app.vagrantup.com/generic/boxes/rocky8"><code>generic/rocky8</code></a>： Rocky 8.9</li>
<li><a href="https://app.vagrantup.com/generic/boxes/rocky9"><code>generic/rocky9</code></a>： Rocky 9.3</li>
<li><a href="https://app.vagrantup.com/generic/boxes/debian11"><code>generic/debian11</code></a>： Debian 11.8</li>
<li><a href="https://app.vagrantup.com/generic/boxes/debian12"><code>generic/debian12</code></a>： Debian 12.4</li>
<li><a href="https://app.vagrantup.com/generic/boxes/ubuntu2004"><code>generic/ubuntu2004</code></a>： Ubuntu 20.04.6</li>
<li><a href="https://app.vagrantup.com/generic/boxes/ubuntu2204"><code>generic/ubuntu2204</code></a>： Ubuntu 22.04.3</li>
<li><a href="https://portal.cloud.hashicorp.com/vagrant/discover/bento/ubuntu-24.04"><code>bento/ubuntu-24.04</code></a>： Ubuntu 24.04</li>
</ul>
<hr>
<h2 id="terraform-镜像参考">Terraform 镜像参考</h2>
<p>当您使用云服务器部署 Pigsty 时，可以考虑在 Terraform 中使用以下操作系统基础镜像，以阿里云为例：</p>
<ul>
<li>CentOS 7.9     :  <code>centos_7_9_x64_20G_alibase_20240628.vhd</code></li>
<li>Rocky 8.10     :  <code>rockylinux_8_10_x64_20G_alibase_20240923.vhd</code></li>
<li>Rocky 9.4      :  <code>rockylinux_9_4_x64_20G_alibase_20240925.vhd</code></li>
<li>Ubuntu 20.04   :  <code>ubuntu_20_04_x64_20G_alibase_20240925.vhd</code></li>
<li>Ubuntu 22.04   :  <code>ubuntu_22_04_x64_20G_alibase_20240926.vhd</code></li>
<li>Ubuntu 24.04   :  <code>ubuntu_24_04_x64_20G_alibase_20240923.vhd</code></li>
<li>Debian 11.11   :  <code>debian_11_11_x64_20G_alibase_20240923.vhd</code></li>
<li>Debian 12.7    :  <code>debian_12_7_x64_20G_alibase_20240927.vhd</code></li>
<li>Anolis 8.8     :  <code>anolisos_8_9_x64_20G_rhck_alibase_20240724.vhd</code></li>
</ul>
<hr>
<h2 id="参考阅读">参考阅读</h2>
<p>《<a href="/zh/blog/db/rhel-compatibility/">EL系操作系统兼容性哪家强？</a>》</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-edd87fdd8acaabad7b8183cbb20b2318">2 - 参数列表</h1>
    <div class="lead">Pigsty 提供了约 280+ 配置参数，用于描述整个环境与各个模块的方方面面。</div>
	<p>Pigsty 提供了 280+ 参数，用于描述数据库集群与整个环境的方方面面。</p>
<table>
<thead>
<tr>
<th>序号</th>
<th>参数</th>
<th style="text-align:center">模块</th>
<th style="text-align:center">参数组</th>
<th>类型</th>
<th>层次</th>
<th>中文说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>101</td>
<td><a href="/zh/docs/reference/param/#version"><code>version</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#meta"><code>META</code></a></td>
<td>string</td>
<td>G</td>
<td>pigsty 版本字符串</td>
</tr>
<tr>
<td>102</td>
<td><a href="/zh/docs/reference/param/#admin_ip"><code>admin_ip</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#meta"><code>META</code></a></td>
<td>ip</td>
<td>G</td>
<td>管理节点 IP 地址</td>
</tr>
<tr>
<td>103</td>
<td><a href="/zh/docs/reference/param/#region"><code>region</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#meta"><code>META</code></a></td>
<td>enum</td>
<td>G</td>
<td>上游镜像区域：default,china,europe</td>
</tr>
<tr>
<td>104</td>
<td><a href="/zh/docs/reference/param/#proxy_env"><code>proxy_env</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#meta"><code>META</code></a></td>
<td>dict</td>
<td>G</td>
<td>下载包时使用的全局代理环境变量</td>
</tr>
<tr>
<td>105</td>
<td><a href="/zh/docs/reference/param/#ca_method"><code>ca_method</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#ca"><code>CA</code></a></td>
<td>enum</td>
<td>G</td>
<td>CA处理方式：create,recreate,copy，默认为没有则创建</td>
</tr>
<tr>
<td>106</td>
<td><a href="/zh/docs/reference/param/#ca_cn"><code>ca_cn</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#ca"><code>CA</code></a></td>
<td>string</td>
<td>G</td>
<td>CA CN名称，固定为 pigsty-ca</td>
</tr>
<tr>
<td>107</td>
<td><a href="/zh/docs/reference/param/#cert_validity"><code>cert_validity</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#ca"><code>CA</code></a></td>
<td>interval</td>
<td>G</td>
<td>证书有效期，默认为 20 年</td>
</tr>
<tr>
<td>108</td>
<td><a href="/zh/docs/reference/param/#infra_seq"><code>infra_seq</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra_id"><code>INFRA_ID</code></a></td>
<td>int</td>
<td>I</td>
<td>基础设施节号，必选身份参数</td>
</tr>
<tr>
<td>109</td>
<td><a href="/zh/docs/reference/param/#infra_portal"><code>infra_portal</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra_id"><code>INFRA_ID</code></a></td>
<td>dict</td>
<td>G</td>
<td>通过Nginx门户暴露的基础设施服务列表</td>
</tr>
<tr>
<td>110</td>
<td><a href="/zh/docs/reference/param/#repo_enabled"><code>repo_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上创建软件仓库？</td>
</tr>
<tr>
<td>111</td>
<td><a href="/zh/docs/reference/param/#repo_home"><code>repo_home</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>path</td>
<td>G</td>
<td>软件仓库主目录，默认为<code>/www</code></td>
</tr>
<tr>
<td>112</td>
<td><a href="/zh/docs/reference/param/#repo_name"><code>repo_name</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string</td>
<td>G</td>
<td>软件仓库名称，默认为 pigsty</td>
</tr>
<tr>
<td>113</td>
<td><a href="/zh/docs/reference/param/#repo_endpoint"><code>repo_endpoint</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>url</td>
<td>G</td>
<td>仓库的访问点：域名或 <code>ip:port</code> 格式</td>
</tr>
<tr>
<td>114</td>
<td><a href="/zh/docs/reference/param/#repo_remove"><code>repo_remove</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>构建本地仓库时是否移除现有上游仓库源定义文件？</td>
</tr>
<tr>
<td>115</td>
<td><a href="/zh/docs/reference/param/#repo_modules"><code>repo_modules</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string</td>
<td>G/A</td>
<td>启用的上游仓库模块列表，用逗号分隔</td>
</tr>
<tr>
<td>116</td>
<td><a href="/zh/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>upstream[]</td>
<td>G</td>
<td>上游仓库源定义：从哪里下载上游包？</td>
</tr>
<tr>
<td>117</td>
<td><a href="/zh/docs/reference/param/#repo_packages"><code>repo_packages</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string[]</td>
<td>G</td>
<td>从上游仓库下载哪些软件包？</td>
</tr>
<tr>
<td>118</td>
<td><a href="/zh/docs/reference/param/#repo_extra_packages"><code>repo_extra_packages</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string[]</td>
<td>G/C/I</td>
<td>从上游仓库下载哪些额外的软件包？</td>
</tr>
<tr>
<td>119</td>
<td><a href="/zh/docs/reference/param/#repo_url_packages"><code>repo_url_packages</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string[]</td>
<td>G</td>
<td>使用URL下载的额外软件包列表</td>
</tr>
<tr>
<td>120</td>
<td><a href="/zh/docs/reference/param/#infra_packages"><code>infra_packages</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra_package"><code>INFRA_PACKAGE</code></a></td>
<td>string[]</td>
<td>G</td>
<td>在基础设施节点上要安装的软件包</td>
</tr>
<tr>
<td>121</td>
<td><a href="/zh/docs/reference/param/#infra_packages_pip"><code>infra_packages_pip</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra_package"><code>INFRA_PACKAGE</code></a></td>
<td>string</td>
<td>G</td>
<td>在基础设施节点上使用 pip 安装的包</td>
</tr>
<tr>
<td>130</td>
<td><a href="/zh/docs/reference/param/#nginx_enabled"><code>nginx_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上启用 nginx？</td>
</tr>
<tr>
<td>131</td>
<td><a href="/zh/docs/reference/param/#nginx_enabled"><code>nginx_exporter_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上启用 nginx_exporter？</td>
</tr>
<tr>
<td>132</td>
<td><a href="/zh/docs/reference/param/#nginx_sslmode"><code>nginx_sslmode</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>enum</td>
<td>G</td>
<td>nginx SSL模式？disable,enable,enforce</td>
</tr>
<tr>
<td>133</td>
<td><a href="/zh/docs/reference/param/#nginx_home"><code>nginx_home</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>path</td>
<td>G</td>
<td>nginx 内容目录，默认为 <code>/www</code>，通常和仓库目录一致</td>
</tr>
<tr>
<td>134</td>
<td><a href="/zh/docs/reference/param/#nginx_port"><code>nginx_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>port</td>
<td>G</td>
<td>nginx 监听端口，默认为 80</td>
</tr>
<tr>
<td>135</td>
<td><a href="/zh/docs/reference/param/#nginx_ssl_port"><code>nginx_ssl_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>port</td>
<td>G</td>
<td>nginx SSL监听端口，默认为 443</td>
</tr>
<tr>
<td>136</td>
<td><a href="/zh/docs/reference/param/#nginx_navbar"><code>nginx_navbar</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>index[]</td>
<td>G</td>
<td>nginx 首页导航链接列表</td>
</tr>
<tr>
<td>140</td>
<td><a href="/zh/docs/reference/param/#dns_enabled"><code>dns_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#dns"><code>DNS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上设置dnsmasq？</td>
</tr>
<tr>
<td>141</td>
<td><a href="/zh/docs/reference/param/#dns_port"><code>dns_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#dns"><code>DNS</code></a></td>
<td>port</td>
<td>G</td>
<td>DNS 服务器监听端口，默认为 53</td>
</tr>
<tr>
<td>142</td>
<td><a href="/zh/docs/reference/param/#dns_records"><code>dns_records</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#dns"><code>DNS</code></a></td>
<td>string[]</td>
<td>G</td>
<td>由 dnsmasq 解析的动态 DNS 记录</td>
</tr>
<tr>
<td>150</td>
<td><a href="/zh/docs/reference/param/#prometheus_enabled"><code>prometheus_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上启用 prometheus？</td>
</tr>
<tr>
<td>151</td>
<td><a href="/zh/docs/reference/param/#prometheus_clean"><code>prometheus_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>初始化Prometheus的时候清除现有数据？</td>
</tr>
<tr>
<td>152</td>
<td><a href="/zh/docs/reference/param/#prometheus_data"><code>prometheus_data</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>path</td>
<td>G</td>
<td>Prometheus 数据目录，默认为 <code>/data/prometheus</code></td>
</tr>
<tr>
<td>153</td>
<td><a href="/zh/docs/reference/param/#prometheus_sd_dir"><code>prometheus_sd_dir</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>path</td>
<td>G</td>
<td>Prometheus 服务发现目标文件目录</td>
</tr>
<tr>
<td>154</td>
<td><a href="/zh/docs/reference/param/#prometheus_sd_interval"><code>prometheus_sd_interval</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>interval</td>
<td>G</td>
<td>Prometheus 目标刷新间隔，默认为 5s</td>
</tr>
<tr>
<td>155</td>
<td><a href="/zh/docs/reference/param/#prometheus_scrape_interval"><code>prometheus_scrape_interval</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>interval</td>
<td>G</td>
<td>Prometheus 抓取 &amp; 评估间隔，默认为 10s</td>
</tr>
<tr>
<td>156</td>
<td><a href="/zh/docs/reference/param/#prometheus_scrape_timeout"><code>prometheus_scrape_timeout</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>interval</td>
<td>G</td>
<td>Prometheus 全局抓取超时，默认为 8s</td>
</tr>
<tr>
<td>157</td>
<td><a href="/zh/docs/reference/param/#prometheus_options"><code>prometheus_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>arg</td>
<td>G</td>
<td>Prometheus 额外的命令行参数选项</td>
</tr>
<tr>
<td>158</td>
<td><a href="/zh/docs/reference/param/#pushgateway_enabled"><code>pushgateway_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上设置 pushgateway？</td>
</tr>
<tr>
<td>159</td>
<td><a href="/zh/docs/reference/param/#pushgateway_options"><code>pushgateway_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>arg</td>
<td>G</td>
<td>pushgateway 额外的命令行参数选项</td>
</tr>
<tr>
<td>160</td>
<td><a href="/zh/docs/reference/param/#blackbox_enabled"><code>blackbox_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上设置 blackbox_exporter？</td>
</tr>
<tr>
<td>161</td>
<td><a href="/zh/docs/reference/param/#blackbox_options"><code>blackbox_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>arg</td>
<td>G</td>
<td>blackbox_exporter 额外的命令行参数选项</td>
</tr>
<tr>
<td>162</td>
<td><a href="/zh/docs/reference/param/#alertmanager_enabled"><code>alertmanager_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上设置 alertmanager？</td>
</tr>
<tr>
<td>163</td>
<td><a href="/zh/docs/reference/param/#alertmanager_options"><code>alertmanager_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>arg</td>
<td>G</td>
<td>alertmanager 额外的命令行参数选项</td>
</tr>
<tr>
<td>164</td>
<td><a href="/zh/docs/reference/param/#exporter_metrics_path"><code>exporter_metrics_path</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>path</td>
<td>G</td>
<td>exporter 指标路径，默认为 /metrics</td>
</tr>
<tr>
<td>165</td>
<td><a href="/zh/docs/reference/param/#exporter_install"><code>exporter_install</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>enum</td>
<td>G</td>
<td>如何安装 exporter？none,yum,binary</td>
</tr>
<tr>
<td>166</td>
<td><a href="/zh/docs/reference/param/#exporter_repo_url"><code>exporter_repo_url</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>url</td>
<td>G</td>
<td>通过 yum 安装exporter时使用的yum仓库文件地址</td>
</tr>
<tr>
<td>170</td>
<td><a href="/zh/docs/reference/param/#grafana_enabled"><code>grafana_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上启用 Grafana？</td>
</tr>
<tr>
<td>171</td>
<td><a href="/zh/docs/reference/param/#grafana_clean"><code>grafana_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>初始化Grafana期间清除数据？</td>
</tr>
<tr>
<td>172</td>
<td><a href="/zh/docs/reference/param/#grafana_admin_username"><code>grafana_admin_username</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>username</td>
<td>G</td>
<td>Grafana 管理员用户名，默认为 <code>admin</code></td>
</tr>
<tr>
<td>173</td>
<td><a href="/zh/docs/reference/param/#grafana_admin_password"><code>grafana_admin_password</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>password</td>
<td>G</td>
<td>Grafana 管理员密码，默认为 <code>pigsty</code></td>
</tr>
<tr>
<td>174</td>
<td><a href="/zh/docs/reference/param/#grafana_plugin_cache"><code>grafana_plugin_cache</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>path</td>
<td>G</td>
<td>Grafana 插件缓存 tarball 的路径</td>
</tr>
<tr>
<td>175</td>
<td><a href="/zh/docs/reference/param/#grafana_plugin_list"><code>grafana_plugin_list</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>string[]</td>
<td>G</td>
<td>使用 grafana-cli 下载的 Grafana 插件</td>
</tr>
<tr>
<td>176</td>
<td><a href="/zh/docs/reference/param/#loki_enabled"><code>loki_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#loki"><code>LOKI</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>在此基础设施节点上启用 loki？</td>
</tr>
<tr>
<td>177</td>
<td><a href="/zh/docs/reference/param/#loki_clean"><code>loki_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#loki"><code>LOKI</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>是否删除现有的 loki 数据？</td>
</tr>
<tr>
<td>178</td>
<td><a href="/zh/docs/reference/param/#loki_data"><code>loki_data</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#loki"><code>LOKI</code></a></td>
<td>path</td>
<td>G</td>
<td>loki 数据目录，默认为 <code>/data/loki</code></td>
</tr>
<tr>
<td>179</td>
<td><a href="/zh/docs/reference/param/#loki_retention"><code>loki_retention</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#loki"><code>LOKI</code></a></td>
<td>interval</td>
<td>G</td>
<td>loki 日志保留期，默认为 15d</td>
</tr>
<tr>
<td>201</td>
<td><a href="/zh/docs/reference/param/#nodename"><code>nodename</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>string</td>
<td>I</td>
<td>node 实例标识，如缺失则使用主机名，可选</td>
</tr>
<tr>
<td>202</td>
<td><a href="/zh/docs/reference/param/#node_cluster"><code>node_cluster</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>string</td>
<td>C</td>
<td>node 集群标识，如缺失则使用默认值&rsquo;nodes&rsquo;，可选</td>
</tr>
<tr>
<td>203</td>
<td><a href="/zh/docs/reference/param/#nodename_overwrite"><code>nodename_overwrite</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>bool</td>
<td>C</td>
<td>用 nodename 覆盖节点的主机名吗？</td>
</tr>
<tr>
<td>204</td>
<td><a href="/zh/docs/reference/param/#nodename_exchange"><code>nodename_exchange</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>bool</td>
<td>C</td>
<td>在剧本主机之间交换 nodename 吗？</td>
</tr>
<tr>
<td>205</td>
<td><a href="/zh/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>bool</td>
<td>C</td>
<td>如果可行，是否借用 postgres 身份作为节点身份？</td>
</tr>
<tr>
<td>210</td>
<td><a href="/zh/docs/reference/param/#node_write_etc_hosts"><code>node_write_etc_hosts</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>bool</td>
<td>G/C/I</td>
<td>是否修改目标节点上的 <code>/etc/hosts</code>？</td>
</tr>
<tr>
<td>211</td>
<td><a href="/zh/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>string[]</td>
<td>G</td>
<td>/etc/hosts 中的静态 DNS 记录</td>
</tr>
<tr>
<td>212</td>
<td><a href="/zh/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>string[]</td>
<td>C</td>
<td>/etc/hosts 中的额外静态 DNS 记录</td>
</tr>
<tr>
<td>213</td>
<td><a href="/zh/docs/reference/param/#node_dns_method"><code>node_dns_method</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>enum</td>
<td>C</td>
<td>如何处理现有DNS服务器：add,none,overwrite</td>
</tr>
<tr>
<td>214</td>
<td><a href="/zh/docs/reference/param/#node_dns_servers"><code>node_dns_servers</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>string[]</td>
<td>C</td>
<td>/etc/resolv.conf 中的动态域名服务器列表</td>
</tr>
<tr>
<td>215</td>
<td><a href="/zh/docs/reference/param/#node_dns_options"><code>node_dns_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>string[]</td>
<td>C</td>
<td>/etc/resolv.conf 中的DNS解析选项</td>
</tr>
<tr>
<td>220</td>
<td><a href="/zh/docs/reference/param/#node_repo_modules"><code>node_repo_modules</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_package"><code>NODE_PACKAGE</code></a></td>
<td>enum</td>
<td>C</td>
<td>在节点上启用哪些软件源模块？默认为 local 使用本地源</td>
</tr>
<tr>
<td>221</td>
<td><a href="/zh/docs/reference/param/#node_repo_remove"><code>node_repo_remove</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_package"><code>NODE_PACKAGE</code></a></td>
<td>bool</td>
<td>C</td>
<td>配置节点软件仓库时，删除节点上现有的仓库吗？</td>
</tr>
<tr>
<td>223</td>
<td><a href="/zh/docs/reference/param/#node_packages"><code>node_packages</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_package"><code>NODE_PACKAGE</code></a></td>
<td>string[]</td>
<td>C</td>
<td>要在当前节点上安装的软件包列表</td>
</tr>
<tr>
<td>224</td>
<td><a href="/zh/docs/reference/param/#node_default_packages"><code>node_default_packages</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_package"><code>NODE_PACKAGE</code></a></td>
<td>string[]</td>
<td>G</td>
<td>默认在所有节点上安装的软件包列表</td>
</tr>
<tr>
<td>230</td>
<td><a href="/zh/docs/reference/param/#node_disable_firewall"><code>node_disable_firewall</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>禁用节点防火墙？默认为 <code>true</code></td>
</tr>
<tr>
<td>231</td>
<td><a href="/zh/docs/reference/param/#node_disable_selinux"><code>node_disable_selinux</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>禁用节点 selinux？默认为  <code>true</code></td>
</tr>
<tr>
<td>232</td>
<td><a href="/zh/docs/reference/param/#node_disable_numa"><code>node_disable_numa</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>禁用节点 numa，禁用需要重启</td>
</tr>
<tr>
<td>233</td>
<td><a href="/zh/docs/reference/param/#node_disable_swap"><code>node_disable_swap</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>禁用节点 Swap，谨慎使用</td>
</tr>
<tr>
<td>234</td>
<td><a href="/zh/docs/reference/param/#node_static_network"><code>node_static_network</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>重启后保留 DNS 解析器设置，即静态网络，默认启用</td>
</tr>
<tr>
<td>235</td>
<td><a href="/zh/docs/reference/param/#node_disk_prefetch"><code>node_disk_prefetch</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>在 HDD 上配置磁盘预取以提高性能</td>
</tr>
<tr>
<td>236</td>
<td><a href="/zh/docs/reference/param/#node_kernel_modules"><code>node_kernel_modules</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>string[]</td>
<td>C</td>
<td>在此节点上启用的内核模块列表</td>
</tr>
<tr>
<td>237</td>
<td><a href="/zh/docs/reference/param/#node_hugepage_count"><code>node_hugepage_count</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>int</td>
<td>C</td>
<td>主机节点分配的 2MB 大页数量，优先级比比例更高</td>
</tr>
<tr>
<td>238</td>
<td><a href="/zh/docs/reference/param/#node_hugepage_ratio"><code>node_hugepage_ratio</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>float</td>
<td>C</td>
<td>主机节点分配的内存大页占总内存比例，0 默认禁用</td>
</tr>
<tr>
<td>239</td>
<td><a href="/zh/docs/reference/param/#node_overcommit_ratio"><code>node_overcommit_ratio</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>float</td>
<td>C</td>
<td>节点内存允许的 OverCommit 超额比率 (50-100)，0 默认禁用</td>
</tr>
<tr>
<td>240</td>
<td><a href="/zh/docs/reference/param/#node_tune"><code>node_tune</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>enum</td>
<td>C</td>
<td>节点调优配置文件：无，oltp,olap,crit,tiny</td>
</tr>
<tr>
<td>241</td>
<td><a href="/zh/docs/reference/param/#node_sysctl_params"><code>node_sysctl_params</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>dict</td>
<td>C</td>
<td>额外的 sysctl 配置参数，k:v 格式</td>
</tr>
<tr>
<td>250</td>
<td><a href="/zh/docs/reference/param/#node_data"><code>node_data</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>path</td>
<td>C</td>
<td>节点主数据目录，默认为 <code>/data</code></td>
</tr>
<tr>
<td>251</td>
<td><a href="/zh/docs/reference/param/#node_admin_enabled"><code>node_admin_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>bool</td>
<td>C</td>
<td>在目标节点上创建管理员用户吗？</td>
</tr>
<tr>
<td>252</td>
<td><a href="/zh/docs/reference/param/#node_admin_uid"><code>node_admin_uid</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>int</td>
<td>C</td>
<td>节点管理员用户的 uid 和 gid</td>
</tr>
<tr>
<td>253</td>
<td><a href="/zh/docs/reference/param/#node_admin_username"><code>node_admin_username</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>username</td>
<td>C</td>
<td>节点管理员用户的名称，默认为 <code>dba</code></td>
</tr>
<tr>
<td>254</td>
<td><a href="/zh/docs/reference/param/#node_admin_ssh_exchange"><code>node_admin_ssh_exchange</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>bool</td>
<td>C</td>
<td>是否在节点集群之间交换管理员 ssh 密钥</td>
</tr>
<tr>
<td>255</td>
<td><a href="/zh/docs/reference/param/#node_admin_pk_current"><code>node_admin_pk_current</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>bool</td>
<td>C</td>
<td>将当前用户的 ssh 公钥添加到管理员的 authorized_keys 中吗？</td>
</tr>
<tr>
<td>256</td>
<td><a href="/zh/docs/reference/param/#node_admin_pk_list"><code>node_admin_pk_list</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>string[]</td>
<td>C</td>
<td>要添加到管理员用户的 ssh 公钥</td>
</tr>
<tr>
<td>260</td>
<td><a href="/zh/docs/reference/param/#node_timezone"><code>node_timezone</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>string</td>
<td>C</td>
<td>设置主机节点时区，空字符串跳过</td>
</tr>
<tr>
<td>261</td>
<td><a href="/zh/docs/reference/param/#node_ntp_enabled"><code>node_ntp_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>bool</td>
<td>C</td>
<td>启用 chronyd 时间同步服务吗？</td>
</tr>
<tr>
<td>262</td>
<td><a href="/zh/docs/reference/param/#node_ntp_servers"><code>node_ntp_servers</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>string[]</td>
<td>C</td>
<td>/etc/chrony.conf 中的 ntp 服务器列表</td>
</tr>
<tr>
<td>263</td>
<td><a href="/zh/docs/reference/param/#node_crontab_overwrite"><code>node_crontab_overwrite</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>bool</td>
<td>C</td>
<td>写入 /etc/crontab 时，追加写入还是全部覆盖？</td>
</tr>
<tr>
<td>264</td>
<td><a href="/zh/docs/reference/param/#node_crontab"><code>node_crontab</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>string[]</td>
<td>C</td>
<td>在 /etc/crontab 中的 crontab 条目</td>
</tr>
<tr>
<td>270</td>
<td><a href="/zh/docs/reference/param/#vip_enabled"><code>vip_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>bool</td>
<td>C</td>
<td>在此节点集群上启用 L2 vip 吗？</td>
</tr>
<tr>
<td>271</td>
<td><a href="/zh/docs/reference/param/#vip_address"><code>vip_address</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>ip</td>
<td>C</td>
<td>节点 vip 地址的 ipv4 格式，启用 vip 时为必要参数</td>
</tr>
<tr>
<td>272</td>
<td><a href="/zh/docs/reference/param/#vip_vrid"><code>vip_vrid</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>int</td>
<td>C</td>
<td>所需的整数，1-254，在同一 VLAN 中应唯一</td>
</tr>
<tr>
<td>273</td>
<td><a href="/zh/docs/reference/param/#vip_role"><code>vip_role</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>enum</td>
<td>I</td>
<td>可选，master/backup，默认为 backup，用作初始角色</td>
</tr>
<tr>
<td>274</td>
<td><a href="/zh/docs/reference/param/#vip_preempt"><code>vip_preempt</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>bool</td>
<td>C/I</td>
<td>可选，true/false，默认为 false，启用 vip 抢占</td>
</tr>
<tr>
<td>275</td>
<td><a href="/zh/docs/reference/param/#vip_interface"><code>vip_interface</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>string</td>
<td>C/I</td>
<td>节点 vip 网络接口监听，默认为 eth0</td>
</tr>
<tr>
<td>276</td>
<td><a href="/zh/docs/reference/param/#vip_dns_suffix"><code>vip_dns_suffix</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>string</td>
<td>C</td>
<td>节点 vip DNS 名称后缀，默认为空字符串</td>
</tr>
<tr>
<td>277</td>
<td><a href="/zh/docs/reference/param/#vip_exporter_port"><code>vip_exporter_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>port</td>
<td>C</td>
<td>keepalived exporter 监听端口，默认为 9650</td>
</tr>
<tr>
<td>280</td>
<td><a href="/zh/docs/reference/param/#haproxy_enabled"><code>haproxy_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>bool</td>
<td>C</td>
<td>在此节点上启用 haproxy 吗？</td>
</tr>
<tr>
<td>281</td>
<td><a href="/zh/docs/reference/param/#haproxy_clean"><code>haproxy_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>清除所有现有的 haproxy 配置吗？</td>
</tr>
<tr>
<td>282</td>
<td><a href="/zh/docs/reference/param/#haproxy_reload"><code>haproxy_reload</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>bool</td>
<td>A</td>
<td>配置后重新加载 haproxy 吗？</td>
</tr>
<tr>
<td>283</td>
<td><a href="/zh/docs/reference/param/#haproxy_auth_enabled"><code>haproxy_auth_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>bool</td>
<td>G</td>
<td>启用 haproxy 管理页面的身份验证？</td>
</tr>
<tr>
<td>284</td>
<td><a href="/zh/docs/reference/param/#haproxy_admin_username"><code>haproxy_admin_username</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>username</td>
<td>G</td>
<td>haproxy 管理用户名，默认为 <code>admin</code></td>
</tr>
<tr>
<td>285</td>
<td><a href="/zh/docs/reference/param/#haproxy_admin_password"><code>haproxy_admin_password</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>password</td>
<td>G</td>
<td>haproxy 管理密码，默认为 <code>pigsty</code></td>
</tr>
<tr>
<td>286</td>
<td><a href="/zh/docs/reference/param/#haproxy_exporter_port"><code>haproxy_exporter_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>port</td>
<td>C</td>
<td>haproxy exporter 的端口，默认为 9101</td>
</tr>
<tr>
<td>287</td>
<td><a href="/zh/docs/reference/param/#haproxy_client_timeout"><code>haproxy_client_timeout</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>interval</td>
<td>C</td>
<td>haproxy 客户端连接超时，默认为 24h</td>
</tr>
<tr>
<td>288</td>
<td><a href="/zh/docs/reference/param/#haproxy_server_timeout"><code>haproxy_server_timeout</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>interval</td>
<td>C</td>
<td>haproxy 服务器端连接超时，默认为 24h</td>
</tr>
<tr>
<td>289</td>
<td><a href="/zh/docs/reference/param/#haproxy_services"><code>haproxy_services</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>service[]</td>
<td>C</td>
<td>要在节点上对外暴露的 haproxy 服务列表</td>
</tr>
<tr>
<td>290</td>
<td><a href="/zh/docs/reference/param/#node_exporter_enabled"><code>node_exporter_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_exporter"><code>NODE_EXPORTER</code></a></td>
<td>bool</td>
<td>C</td>
<td>在此节点上配置 node_exporter 吗？</td>
</tr>
<tr>
<td>291</td>
<td><a href="/zh/docs/reference/param/#node_exporter_port"><code>node_exporter_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_exporter"><code>NODE_EXPORTER</code></a></td>
<td>port</td>
<td>C</td>
<td>node exporter 监听端口，默认为 9100</td>
</tr>
<tr>
<td>292</td>
<td><a href="/zh/docs/reference/param/#node_exporter_options"><code>node_exporter_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_exporter"><code>NODE_EXPORTER</code></a></td>
<td>arg</td>
<td>C</td>
<td>node_exporter 的额外服务器选项</td>
</tr>
<tr>
<td>293</td>
<td><a href="/zh/docs/reference/param/#promtail_enabled"><code>promtail_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#promtail"><code>PROMTAIL</code></a></td>
<td>bool</td>
<td>C</td>
<td>启用 promtail 日志收集器吗？</td>
</tr>
<tr>
<td>294</td>
<td><a href="/zh/docs/reference/param/#promtail_clean"><code>promtail_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#promtail"><code>PROMTAIL</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>初始化期间清除现有的 promtail 状态文件吗？</td>
</tr>
<tr>
<td>295</td>
<td><a href="/zh/docs/reference/param/#promtail_port"><code>promtail_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#promtail"><code>PROMTAIL</code></a></td>
<td>port</td>
<td>C</td>
<td>promtail 监听端口，默认为 9080</td>
</tr>
<tr>
<td>296</td>
<td><a href="/zh/docs/reference/param/#promtail_positions"><code>promtail_positions</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node"><code>NODE</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#promtail"><code>PROMTAIL</code></a></td>
<td>path</td>
<td>C</td>
<td>promtail 位置状态文件路径</td>
</tr>
<tr>
<td>401</td>
<td><a href="/zh/docs/reference/param/#docker_enabled"><code>docker_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>bool</td>
<td>G/C/I</td>
<td>在当前节点上启用 Docker？默认不启用</td>
</tr>
<tr>
<td>402</td>
<td><a href="/zh/docs/reference/param/#docker_cgroups_driver"><code>docker_cgroups_driver</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>enum</td>
<td>G/C/I</td>
<td>Docker CGroup 文件系统驱动：cgroupfs,systemd</td>
</tr>
<tr>
<td>403</td>
<td><a href="/zh/docs/reference/param/#docker_registry_mirrors"><code>docker_registry_mirrors</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>string[]</td>
<td>G/C/I</td>
<td>Docker 仓库镜像列表</td>
</tr>
<tr>
<td>404</td>
<td><a href="/zh/docs/reference/param/#docker_image"><code>docker_image</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>string[]</td>
<td>G/C/I</td>
<td>Docker 待拉取的镜像列表，默认为空列表</td>
</tr>
<tr>
<td>405</td>
<td><a href="/zh/docs/reference/param/#docker_image_cache"><code>docker_image_cache</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>path[]</td>
<td>G/C/I</td>
<td>Docker 待导入的镜像压缩包路径，默认为 <code>/tmp/docker/*.tgz</code></td>
</tr>
<tr>
<td>501</td>
<td><a href="/zh/docs/reference/param/#etcd_seq"><code>etcd_seq</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>int</td>
<td>I</td>
<td>etcd 实例标识符，必填</td>
</tr>
<tr>
<td>502</td>
<td><a href="/zh/docs/reference/param/#etcd_cluster"><code>etcd_cluster</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>string</td>
<td>C</td>
<td>etcd 集群名，默认固定为 etcd</td>
</tr>
<tr>
<td>503</td>
<td><a href="/zh/docs/reference/param/#etcd_safeguard"><code>etcd_safeguard</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>etcd 防误删保险，阻止清除正在运行的 etcd 实例？</td>
</tr>
<tr>
<td>504</td>
<td><a href="/zh/docs/reference/param/#etcd_clean"><code>etcd_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>etcd 清除指令：在初始化时清除现有的 etcd 实例？</td>
</tr>
<tr>
<td>505</td>
<td><a href="/zh/docs/reference/param/#etcd_data"><code>etcd_data</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>path</td>
<td>C</td>
<td>etcd 数据目录，默认为 /data/etcd</td>
</tr>
<tr>
<td>506</td>
<td><a href="/zh/docs/reference/param/#etcd_port"><code>etcd_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>port</td>
<td>C</td>
<td>etcd 客户端端口，默认为 2379</td>
</tr>
<tr>
<td>507</td>
<td><a href="/zh/docs/reference/param/#etcd_peer_port"><code>etcd_peer_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>port</td>
<td>C</td>
<td>etcd 同伴端口，默认为 2380</td>
</tr>
<tr>
<td>508</td>
<td><a href="/zh/docs/reference/param/#etcd_init"><code>etcd_init</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>enum</td>
<td>C</td>
<td>etcd 初始集群状态，新建或已存在</td>
</tr>
<tr>
<td>509</td>
<td><a href="/zh/docs/reference/param/#etcd_election_timeout"><code>etcd_election_timeout</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>int</td>
<td>C</td>
<td>etcd 选举超时，默认为 1000ms</td>
</tr>
<tr>
<td>510</td>
<td><a href="/zh/docs/reference/param/#etcd_heartbeat_interval"><code>etcd_heartbeat_interval</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>int</td>
<td>C</td>
<td>etcd 心跳间隔，默认为 100ms</td>
</tr>
<tr>
<td>601</td>
<td><a href="/zh/docs/reference/param/#minio_seq"><code>minio_seq</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>int</td>
<td>I</td>
<td>minio 实例标识符，必填</td>
</tr>
<tr>
<td>602</td>
<td><a href="/zh/docs/reference/param/#minio_cluster"><code>minio_cluster</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>C</td>
<td>minio 集群名称，默认为 minio</td>
</tr>
<tr>
<td>603</td>
<td><a href="/zh/docs/reference/param/#minio_clean"><code>minio_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>初始化时清除 minio？默认为 false</td>
</tr>
<tr>
<td>604</td>
<td><a href="/zh/docs/reference/param/#minio_user"><code>minio_user</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>username</td>
<td>C</td>
<td>minio 操作系统用户，默认为 <code>minio</code></td>
</tr>
<tr>
<td>605</td>
<td><a href="/zh/docs/reference/param/#minio_node"><code>minio_node</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>C</td>
<td>minio 节点名模式</td>
</tr>
<tr>
<td>606</td>
<td><a href="/zh/docs/reference/param/#minio_data"><code>minio_data</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>path</td>
<td>C</td>
<td>minio 数据目录，使用 <code>{x...y}</code> 指定多个磁盘</td>
</tr>
<tr>
<td>607</td>
<td><a href="/zh/docs/reference/param/#minio_domain"><code>minio_domain</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>G</td>
<td>minio 外部域名，默认为 <code>sss.pigsty</code></td>
</tr>
<tr>
<td>608</td>
<td><a href="/zh/docs/reference/param/#minio_port"><code>minio_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>port</td>
<td>C</td>
<td>minio 服务端口，默认为 9000</td>
</tr>
<tr>
<td>609</td>
<td><a href="/zh/docs/reference/param/#minio_admin_port"><code>minio_admin_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>port</td>
<td>C</td>
<td>minio 控制台端口，默认为 9001</td>
</tr>
<tr>
<td>610</td>
<td><a href="/zh/docs/reference/param/#minio_access_key"><code>minio_access_key</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>username</td>
<td>C</td>
<td>根访问密钥，默认为 <code>minioadmin</code></td>
</tr>
<tr>
<td>611</td>
<td><a href="/zh/docs/reference/param/#minio_secret_key"><code>minio_secret_key</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>password</td>
<td>C</td>
<td>根密钥，默认为 <code>minioadmin</code></td>
</tr>
<tr>
<td>612</td>
<td><a href="/zh/docs/reference/param/#minio_extra_vars"><code>minio_extra_vars</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>C</td>
<td>minio 服务器的额外环境变量</td>
</tr>
<tr>
<td>613</td>
<td><a href="/zh/docs/reference/param/#minio_alias"><code>minio_alias</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>G</td>
<td>minio 部署的客户端别名</td>
</tr>
<tr>
<td>614</td>
<td><a href="/zh/docs/reference/param/#minio_buckets"><code>minio_buckets</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>bucket[]</td>
<td>C</td>
<td>待创建的 minio 存储桶列表</td>
</tr>
<tr>
<td>615</td>
<td><a href="/zh/docs/reference/param/#minio_users"><code>minio_users</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>user[]</td>
<td>C</td>
<td>待创建的 minio 用户列表</td>
</tr>
<tr>
<td>701</td>
<td><a href="/zh/docs/reference/param/#redis_cluster"><code>redis_cluster</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>string</td>
<td>C</td>
<td>Redis数据库集群名称，必选身份参数</td>
</tr>
<tr>
<td>702</td>
<td><a href="/zh/docs/reference/param/#redis_instances"><code>redis_instances</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>dict</td>
<td>I</td>
<td>Redis节点上的实例定义</td>
</tr>
<tr>
<td>703</td>
<td><a href="/zh/docs/reference/param/#redis_node"><code>redis_node</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>int</td>
<td>I</td>
<td>Redis节点编号，正整数，集群内唯一，必选身份参数</td>
</tr>
<tr>
<td>710</td>
<td><a href="/zh/docs/reference/param/#redis_fs_main"><code>redis_fs_main</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>path</td>
<td>C</td>
<td>Redis主数据目录，默认为 <code>/data</code></td>
</tr>
<tr>
<td>711</td>
<td><a href="/zh/docs/reference/param/#redis_exporter_enabled"><code>redis_exporter_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>C</td>
<td>Redis Exporter 是否启用？</td>
</tr>
<tr>
<td>712</td>
<td><a href="/zh/docs/reference/param/#redis_exporter_port"><code>redis_exporter_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>port</td>
<td>C</td>
<td>Redis Exporter监听端口</td>
</tr>
<tr>
<td>713</td>
<td><a href="/zh/docs/reference/param/#redis_exporter_options"><code>redis_exporter_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>string</td>
<td>C/I</td>
<td>Redis Exporter命令参数</td>
</tr>
<tr>
<td>720</td>
<td><a href="/zh/docs/reference/param/#redis_safeguard"><code>redis_safeguard</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>禁止抹除现存的Redis</td>
</tr>
<tr>
<td>721</td>
<td><a href="/zh/docs/reference/param/#redis_clean"><code>redis_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>初始化Redis是否抹除现存实例</td>
</tr>
<tr>
<td>722</td>
<td><a href="/zh/docs/reference/param/#redis_rmdata"><code>redis_rmdata</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>移除Redis实例时是否一并移除数据？</td>
</tr>
<tr>
<td>723</td>
<td><a href="/zh/docs/reference/param/#redis_mode"><code>redis_mode</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>enum</td>
<td>C</td>
<td>Redis集群模式：sentinel，cluster，standalone</td>
</tr>
<tr>
<td>724</td>
<td><a href="/zh/docs/reference/param/#redis_conf"><code>redis_conf</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>string</td>
<td>C</td>
<td>Redis配置文件模板，sentinel 除外</td>
</tr>
<tr>
<td>725</td>
<td><a href="/zh/docs/reference/param/#redis_bind_address"><code>redis_bind_address</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>ip</td>
<td>C</td>
<td>Redis监听地址，默认留空则会绑定主机IP</td>
</tr>
<tr>
<td>726</td>
<td><a href="/zh/docs/reference/param/#redis_max_memory"><code>redis_max_memory</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>size</td>
<td>C/I</td>
<td>Redis可用的最大内存</td>
</tr>
<tr>
<td>727</td>
<td><a href="/zh/docs/reference/param/#redis_mem_policy"><code>redis_mem_policy</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>enum</td>
<td>C</td>
<td>Redis内存逐出策略</td>
</tr>
<tr>
<td>728</td>
<td><a href="/zh/docs/reference/param/#redis_password"><code>redis_password</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>password</td>
<td>C</td>
<td>Redis密码，默认留空则禁用密码</td>
</tr>
<tr>
<td>729</td>
<td><a href="/zh/docs/reference/param/#redis_rdb_save"><code>redis_rdb_save</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>string[]</td>
<td>C</td>
<td>Redis RDB 保存指令，字符串列表，空数组则禁用RDB</td>
</tr>
<tr>
<td>730</td>
<td><a href="/zh/docs/reference/param/#redis_aof_enabled"><code>redis_aof_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>C</td>
<td>Redis AOF 是否启用？</td>
</tr>
<tr>
<td>731</td>
<td><a href="/zh/docs/reference/param/#redis_rename_commands"><code>redis_rename_commands</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>dict</td>
<td>C</td>
<td>Redis危险命令重命名列表</td>
</tr>
<tr>
<td>732</td>
<td><a href="/zh/docs/reference/param/#redis_cluster_replicas"><code>redis_cluster_replicas</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>int</td>
<td>C</td>
<td>Redis原生集群中每个主库配几个从库？</td>
</tr>
<tr>
<td>733</td>
<td><a href="/zh/docs/reference/param/#redis_sentinel_monitor"><code>redis_sentinel_monitor</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>master[]</td>
<td>C</td>
<td>Redis哨兵监控的主库列表，只在哨兵集群上使用</td>
</tr>
<tr>
<td>801</td>
<td><a href="/zh/docs/reference/param/#pg_mode"><code>pg_mode</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>enum</td>
<td>C</td>
<td>pgsql 集群模式: pgsql,citus,mssql,polar,ivory,oracle,gpsql</td>
</tr>
<tr>
<td>802</td>
<td><a href="/zh/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>string</td>
<td>C</td>
<td>pgsql 集群名称, 必选身份参数</td>
</tr>
<tr>
<td>803</td>
<td><a href="/zh/docs/reference/param/#pg_seq"><code>pg_seq</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>int</td>
<td>I</td>
<td>pgsql 实例号, 必选身份参数</td>
</tr>
<tr>
<td>804</td>
<td><a href="/zh/docs/reference/param/#pg_role"><code>pg_role</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>enum</td>
<td>I</td>
<td>pgsql 实例角色, 必选身份参数, 可为 primary，replica，offline</td>
</tr>
<tr>
<td>805</td>
<td><a href="/zh/docs/reference/param/#pg_instances"><code>pg_instances</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>dict</td>
<td>I</td>
<td>在一个节点上定义多个 pg 实例，使用 <code>{port:ins_vars}</code> 格式</td>
</tr>
<tr>
<td>806</td>
<td><a href="/zh/docs/reference/param/#pg_upstream"><code>pg_upstream</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>ip</td>
<td>I</td>
<td>级联从库或备份集群或的复制上游节点IP地址</td>
</tr>
<tr>
<td>807</td>
<td><a href="/zh/docs/reference/param/#pg_shard"><code>pg_shard</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>string</td>
<td>C</td>
<td>pgsql 分片名，对 citus 与 gpsql 等水平分片集群为必选身份参数</td>
</tr>
<tr>
<td>808</td>
<td><a href="/zh/docs/reference/param/#pg_group"><code>pg_group</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>int</td>
<td>C</td>
<td>pgsql 分片号，正整数，对 citus 与 gpsql 等水平分片集群为必选身份参数</td>
</tr>
<tr>
<td>809</td>
<td><a href="/zh/docs/reference/param/#gp_role"><code>gp_role</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>enum</td>
<td>C</td>
<td>这个集群的 greenplum 角色，可以是 master 或 segment</td>
</tr>
<tr>
<td>810</td>
<td><a href="/zh/docs/reference/param/#pg_exporters"><code>pg_exporters</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>dict</td>
<td>C</td>
<td>在该节点上设置额外的 pg_exporters 用于监控远程 postgres 实例</td>
</tr>
<tr>
<td>811</td>
<td><a href="/zh/docs/reference/param/#pg_offline_query"><code>pg_offline_query</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>bool</td>
<td>I</td>
<td>设置为 true 将此只读实例标记为特殊的离线从库，承载 Offline 服务，允许离线查询</td>
</tr>
<tr>
<td>820</td>
<td><a href="/zh/docs/reference/param/#pg_users"><code>pg_users</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>user[]</td>
<td>C</td>
<td>postgres 业务用户</td>
</tr>
<tr>
<td>821</td>
<td><a href="/zh/docs/reference/param/#pg_databases"><code>pg_databases</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>database[]</td>
<td>C</td>
<td>postgres 业务数据库</td>
</tr>
<tr>
<td>822</td>
<td><a href="/zh/docs/reference/param/#pg_services"><code>pg_services</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>service[]</td>
<td>C</td>
<td>postgres 业务服务</td>
</tr>
<tr>
<td>823</td>
<td><a href="/zh/docs/reference/param/#pg_hba_rules"><code>pg_hba_rules</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>hba[]</td>
<td>C</td>
<td>postgres 的业务 hba 规则</td>
</tr>
<tr>
<td>824</td>
<td><a href="/zh/docs/reference/param/#pgb_hba_rules"><code>pgb_hba_rules</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>hba[]</td>
<td>C</td>
<td>pgbouncer 的业务 hba 规则</td>
</tr>
<tr>
<td>831</td>
<td><a href="/zh/docs/reference/param/#pg_replication_username"><code>pg_replication_username</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>username</td>
<td>G</td>
<td>postgres 复制用户名，默认为 <code>replicator</code></td>
</tr>
<tr>
<td>832</td>
<td><a href="/zh/docs/reference/param/#pg_replication_password"><code>pg_replication_password</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>password</td>
<td>G</td>
<td>postgres 复制密码，默认为 <code>DBUser.Replicator</code></td>
</tr>
<tr>
<td>833</td>
<td><a href="/zh/docs/reference/param/#pg_admin_username"><code>pg_admin_username</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>username</td>
<td>G</td>
<td>postgres 管理员用户名，默认为 <code>dbuser_dba</code></td>
</tr>
<tr>
<td>834</td>
<td><a href="/zh/docs/reference/param/#pg_admin_password"><code>pg_admin_password</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>password</td>
<td>G</td>
<td>postgres 管理员明文密码，默认为 <code>DBUser.DBA</code></td>
</tr>
<tr>
<td>835</td>
<td><a href="/zh/docs/reference/param/#pg_monitor_username"><code>pg_monitor_username</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>username</td>
<td>G</td>
<td>postgres 监控用户名，默认为 <code>dbuser_monitor</code></td>
</tr>
<tr>
<td>836</td>
<td><a href="/zh/docs/reference/param/#pg_monitor_password"><code>pg_monitor_password</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>password</td>
<td>G</td>
<td>postgres 监控密码，默认为 <code>DBUser.Monitor</code></td>
</tr>
<tr>
<td>837</td>
<td><a href="/zh/docs/reference/param/#pg_dbsu_password"><code>pg_dbsu_password</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>password</td>
<td>G/C</td>
<td>dbsu 密码，默认为空字符串意味着不设置 dbsu 密码，最好不要设置。</td>
</tr>
<tr>
<td>840</td>
<td><a href="/zh/docs/reference/param/#pg_dbsu"><code>pg_dbsu</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>username</td>
<td>C</td>
<td>操作系统 dbsu 名称，默认为 postgres，最好不要更改</td>
</tr>
<tr>
<td>841</td>
<td><a href="/zh/docs/reference/param/#pg_dbsu_uid"><code>pg_dbsu_uid</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>int</td>
<td>C</td>
<td>操作系统 dbsu uid 和 gid，对于默认的 postgres 用户和组为 26</td>
</tr>
<tr>
<td>842</td>
<td><a href="/zh/docs/reference/param/#pg_dbsu_sudo"><code>pg_dbsu_sudo</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>enum</td>
<td>C</td>
<td>dbsu sudo 权限, none,limit,all,nopass，默认为 limit，有限sudo权限</td>
</tr>
<tr>
<td>843</td>
<td><a href="/zh/docs/reference/param/#pg_dbsu_home"><code>pg_dbsu_home</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>path</td>
<td>C</td>
<td>postgresql 主目录，默认为 <code>/var/lib/pgsql</code></td>
</tr>
<tr>
<td>844</td>
<td><a href="/zh/docs/reference/param/#pg_dbsu_ssh_exchange"><code>pg_dbsu_ssh_exchange</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>bool</td>
<td>C</td>
<td>在 pgsql 集群之间交换 postgres dbsu ssh 密钥</td>
</tr>
<tr>
<td>845</td>
<td><a href="/zh/docs/reference/param/#pg_version"><code>pg_version</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>enum</td>
<td>C</td>
<td>要安装的 postgres 主版本，默认为 16</td>
</tr>
<tr>
<td>846</td>
<td><a href="/zh/docs/reference/param/#pg_bin_dir"><code>pg_bin_dir</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres 二进制目录，默认为 <code>/usr/pgsql/bin</code></td>
</tr>
<tr>
<td>847</td>
<td><a href="/zh/docs/reference/param/#pg_log_dir"><code>pg_log_dir</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres 日志目录，默认为 <code>/pg/log/postgres</code></td>
</tr>
<tr>
<td>848</td>
<td><a href="/zh/docs/reference/param/#pg_packages"><code>pg_packages</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>string[]</td>
<td>C</td>
<td>要安装的 pg 包，<code>${pg_version}</code> 将被替换为实际主版本号</td>
</tr>
<tr>
<td>849</td>
<td><a href="/zh/docs/reference/param/#pg_extensions"><code>pg_extensions</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>string[]</td>
<td>C</td>
<td>要安装的 pg 扩展，<code>${pg_version}</code> 将被替换为实际主版本号</td>
</tr>
<tr>
<td>850</td>
<td><a href="/zh/docs/reference/param/#pg_safeguard"><code>pg_safeguard</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>防误删保险，禁止清除正在运行的 postgres 实例？默认为 false</td>
</tr>
<tr>
<td>851</td>
<td><a href="/zh/docs/reference/param/#pg_clean"><code>pg_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>在 pgsql 初始化期间清除现有的 postgres？默认为 true</td>
</tr>
<tr>
<td>852</td>
<td><a href="/zh/docs/reference/param/#pg_data"><code>pg_data</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres 数据目录，默认为 <code>/pg/data</code></td>
</tr>
<tr>
<td>853</td>
<td><a href="/zh/docs/reference/param/#pg_fs_main"><code>pg_fs_main</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres 主数据的挂载点/路径，默认为 <code>/data</code></td>
</tr>
<tr>
<td>854</td>
<td><a href="/zh/docs/reference/param/#pg_fs_bkup"><code>pg_fs_bkup</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>pg 备份数据的挂载点/路径，默认为 <code>/data/backup</code></td>
</tr>
<tr>
<td>855</td>
<td><a href="/zh/docs/reference/param/#pg_storage_type"><code>pg_storage_type</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>pg 主数据的存储类型，SSD、HDD，默认为 SSD，影响自动优化的参数。</td>
</tr>
<tr>
<td>856</td>
<td><a href="/zh/docs/reference/param/#pg_dummy_filesize"><code>pg_dummy_filesize</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>size</td>
<td>C</td>
<td><code>/pg/dummy</code> 的大小，默认保留 64MB 磁盘空间用于紧急抢修</td>
</tr>
<tr>
<td>857</td>
<td><a href="/zh/docs/reference/param/#pg_listen"><code>pg_listen</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>ip(s)</td>
<td>C/I</td>
<td>postgres/pgbouncer 的监听地址，用逗号分隔的IP列表，默认为 <code>0.0.0.0</code></td>
</tr>
<tr>
<td>858</td>
<td><a href="/zh/docs/reference/param/#pg_port"><code>pg_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>port</td>
<td>C</td>
<td>postgres 监听端口，默认为 5432</td>
</tr>
<tr>
<td>859</td>
<td><a href="/zh/docs/reference/param/#pg_localhost"><code>pg_localhost</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres 的 Unix 套接字目录，用于本地连接</td>
</tr>
<tr>
<td>860</td>
<td><a href="/zh/docs/reference/param/#pg_namespace"><code>pg_namespace</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>在 etcd 中的顶级键命名空间，被 patroni &amp; vip 用于高可用管理</td>
</tr>
<tr>
<td>861</td>
<td><a href="/zh/docs/reference/param/#patroni_enabled"><code>patroni_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>C</td>
<td>如果禁用，初始化期间不会创建 postgres 集群</td>
</tr>
<tr>
<td>862</td>
<td><a href="/zh/docs/reference/param/#patroni_mode"><code>patroni_mode</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>patroni 工作模式：default,pause,remove</td>
</tr>
<tr>
<td>863</td>
<td><a href="/zh/docs/reference/param/#patroni_port"><code>patroni_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>port</td>
<td>C</td>
<td>patroni 监听端口，默认为 8008</td>
</tr>
<tr>
<td>864</td>
<td><a href="/zh/docs/reference/param/#patroni_log_dir"><code>patroni_log_dir</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>patroni 日志目录，默认为 <code>/pg/log/patroni</code></td>
</tr>
<tr>
<td>865</td>
<td><a href="/zh/docs/reference/param/#patroni_ssl_enabled"><code>patroni_ssl_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>G</td>
<td>使用 SSL 保护 patroni RestAPI 通信？</td>
</tr>
<tr>
<td>866</td>
<td><a href="/zh/docs/reference/param/#patroni_watchdog_mode"><code>patroni_watchdog_mode</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>patroni 看门狗模式：automatic,required,off，默认为 off</td>
</tr>
<tr>
<td>867</td>
<td><a href="/zh/docs/reference/param/#patroni_username"><code>patroni_username</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>username</td>
<td>C</td>
<td>patroni restapi 用户名，默认为 <code>postgres</code></td>
</tr>
<tr>
<td>868</td>
<td><a href="/zh/docs/reference/param/#patroni_password"><code>patroni_password</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>password</td>
<td>C</td>
<td>patroni restapi 密码，默认为 <code>Patroni.API</code></td>
</tr>
<tr>
<td>869</td>
<td><a href="/zh/docs/reference/param/#pg_primary_db"><code>pg_primary_db</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>string</td>
<td>C</td>
<td>指定集群中首要使用的数据库名，Citus等模式会用到，默认为 <code>postgres</code></td>
</tr>
<tr>
<td>870</td>
<td><a href="/zh/docs/reference/param/#pg_parameters"><code>pg_parameters</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>dict</td>
<td>C</td>
<td>覆盖 postgresql.auto.conf 中的 PostgreSQL 参数</td>
</tr>
<tr>
<td>871</td>
<td><a href="/zh/docs/reference/param/#pg_files"><code>pg_files</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path[]</td>
<td>C</td>
<td>拷贝至PGDATA目录中的额外文件列表 (例如许可证文件)</td>
</tr>
<tr>
<td>872</td>
<td><a href="/zh/docs/reference/param/#pg_conf"><code>pg_conf</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>配置模板：oltp,olap,crit,tiny，默认为 <code>oltp.yml</code></td>
</tr>
<tr>
<td>873</td>
<td><a href="/zh/docs/reference/param/#pg_max_conn"><code>pg_max_conn</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>int</td>
<td>C</td>
<td>postgres 最大连接数，<code>auto</code> 将使用推荐值</td>
</tr>
<tr>
<td>874</td>
<td><a href="/zh/docs/reference/param/#pg_shared_buffer_ratio"><code>pg_shared_buffer_ratio</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>float</td>
<td>C</td>
<td>postgres 共享缓冲区内存比率，默认为 0.25，范围 0.1~0.4</td>
</tr>
<tr>
<td>875</td>
<td><a href="/zh/docs/reference/param/#pg_rto"><code>pg_rto</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>int</td>
<td>C</td>
<td>恢复时间目标（秒），默认为 <code>30s</code></td>
</tr>
<tr>
<td>876</td>
<td><a href="/zh/docs/reference/param/#pg_rpo"><code>pg_rpo</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>int</td>
<td>C</td>
<td>恢复点目标（字节），默认为 <code>1MiB</code></td>
</tr>
<tr>
<td>877</td>
<td><a href="/zh/docs/reference/param/#pg_libs"><code>pg_libs</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>string</td>
<td>C</td>
<td>预加载的库，默认为 <code>timescaledb,pg_stat_statements,auto_explain</code></td>
</tr>
<tr>
<td>878</td>
<td><a href="/zh/docs/reference/param/#pg_delay"><code>pg_delay</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>interval</td>
<td>I</td>
<td>备份集群主库的WAL重放应用延迟，用于制备延迟从库</td>
</tr>
<tr>
<td>879</td>
<td><a href="/zh/docs/reference/param/#pg_checksum"><code>pg_checksum</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>C</td>
<td>为 postgres 集群启用数据校验和？</td>
</tr>
<tr>
<td>880</td>
<td><a href="/zh/docs/reference/param/#pg_pwd_enc"><code>pg_pwd_enc</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>密码加密算法：md5,scram-sha-256</td>
</tr>
<tr>
<td>881</td>
<td><a href="/zh/docs/reference/param/#pg_encoding"><code>pg_encoding</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>数据库集群编码，默认为 <code>UTF8</code></td>
</tr>
<tr>
<td>882</td>
<td><a href="/zh/docs/reference/param/#pg_locale"><code>pg_locale</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>数据库集群本地化设置，默认为 <code>C</code></td>
</tr>
<tr>
<td>883</td>
<td><a href="/zh/docs/reference/param/#pg_lc_collate"><code>pg_lc_collate</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>数据库集群排序，默认为 <code>C</code></td>
</tr>
<tr>
<td>884</td>
<td><a href="/zh/docs/reference/param/#pg_lc_ctype"><code>pg_lc_ctype</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>数据库字符类型，默认为 <code>en_US.UTF8</code></td>
</tr>
<tr>
<td>890</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_enabled"><code>pgbouncer_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>C</td>
<td>如果禁用，则不会配置 pgbouncer 连接池</td>
</tr>
<tr>
<td>891</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_port"><code>pgbouncer_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>port</td>
<td>C</td>
<td>pgbouncer 监听端口，默认为 6432</td>
</tr>
<tr>
<td>892</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_log_dir"><code>pgbouncer_log_dir</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>pgbouncer 日志目录，默认为 <code>/pg/log/pgbouncer</code></td>
</tr>
<tr>
<td>893</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_auth_query"><code>pgbouncer_auth_query</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>C</td>
<td>使用 AuthQuery 来从 postgres 获取未列出的业务用户？</td>
</tr>
<tr>
<td>894</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_poolmode"><code>pgbouncer_poolmode</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>池化模式：transaction,session,statement，默认为 transaction</td>
</tr>
<tr>
<td>895</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_sslmode"><code>pgbouncer_sslmode</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>pgbouncer 客户端 SSL 模式，默认为禁用</td>
</tr>
<tr>
<td>900</td>
<td><a href="/zh/docs/reference/param/#pg_provision"><code>pg_provision</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>bool</td>
<td>C</td>
<td>在引导后置备 postgres 集群内部的业务对象？</td>
</tr>
<tr>
<td>901</td>
<td><a href="/zh/docs/reference/param/#pg_init"><code>pg_init</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>string</td>
<td>G/C</td>
<td>为集群模板提供初始化脚本，默认为 <code>pg-init</code></td>
</tr>
<tr>
<td>902</td>
<td><a href="/zh/docs/reference/param/#pg_default_roles"><code>pg_default_roles</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>role[]</td>
<td>G/C</td>
<td>postgres 集群中的默认预定义角色和系统用户</td>
</tr>
<tr>
<td>903</td>
<td><a href="/zh/docs/reference/param/#pg_default_privileges"><code>pg_default_privileges</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>string[]</td>
<td>G/C</td>
<td>由管理员用户创建数据库内对象时的默认权限</td>
</tr>
<tr>
<td>904</td>
<td><a href="/zh/docs/reference/param/#pg_default_schemas"><code>pg_default_schemas</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>string[]</td>
<td>G/C</td>
<td>要创建的默认模式列表</td>
</tr>
<tr>
<td>905</td>
<td><a href="/zh/docs/reference/param/#pg_default_extensions"><code>pg_default_extensions</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>extension[]</td>
<td>G/C</td>
<td>要创建的默认扩展列表</td>
</tr>
<tr>
<td>906</td>
<td><a href="/zh/docs/reference/param/#pg_reload"><code>pg_reload</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>bool</td>
<td>A</td>
<td>更改HBA后，是否立即重载 postgres 配置</td>
</tr>
<tr>
<td>907</td>
<td><a href="/zh/docs/reference/param/#pg_default_hba_rules"><code>pg_default_hba_rules</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>hba[]</td>
<td>G/C</td>
<td>postgres 基于主机的认证规则，全局PG默认HBA</td>
</tr>
<tr>
<td>908</td>
<td><a href="/zh/docs/reference/param/#pgb_default_hba_rules"><code>pgb_default_hba_rules</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>hba[]</td>
<td>G/C</td>
<td>pgbouncer 默认的基于主机的认证规则，全局PGB默认HBA</td>
</tr>
<tr>
<td>910</td>
<td><a href="/zh/docs/reference/param/#pgbackrest_enabled"><code>pgbackrest_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>bool</td>
<td>C</td>
<td>在 pgsql 主机上启用 pgbackrest？</td>
</tr>
<tr>
<td>911</td>
<td><a href="/zh/docs/reference/param/#pgbackrest_clean"><code>pgbackrest_clean</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>bool</td>
<td>C</td>
<td>在初始化时删除以前的 pg 备份数据？</td>
</tr>
<tr>
<td>912</td>
<td><a href="/zh/docs/reference/param/#pgbackrest_log_dir"><code>pgbackrest_log_dir</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>path</td>
<td>C</td>
<td>pgbackrest 日志目录，默认为 <code>/pg/log/pgbackrest</code></td>
</tr>
<tr>
<td>913</td>
<td><a href="/zh/docs/reference/param/#pgbackrest_method"><code>pgbackrest_method</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>enum</td>
<td>C</td>
<td>pgbackrest 使用的仓库：local,minio,等&hellip;</td>
</tr>
<tr>
<td>914</td>
<td><a href="/zh/docs/reference/param/#pgbackrest_repo"><code>pgbackrest_repo</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>dict</td>
<td>G/C</td>
<td>pgbackrest 仓库<a href="https://pgbackrest.org/configuration.html#section-repository">定义</a></td>
</tr>
<tr>
<td>921</td>
<td><a href="/zh/docs/reference/param/#pg_weight"><code>pg_weight</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>int</td>
<td>I</td>
<td>在服务中的相对负载均衡权重，默认为 100，范围 0-255</td>
</tr>
<tr>
<td>922</td>
<td><a href="/zh/docs/reference/param/#pg_service_provider"><code>pg_service_provider</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>string</td>
<td>G/C</td>
<td>专用的 haproxy 节点组名称，或默认空字符，使用本地节点上的 haproxy</td>
</tr>
<tr>
<td>923</td>
<td><a href="/zh/docs/reference/param/#pg_default_service_dest"><code>pg_default_service_dest</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>enum</td>
<td>G/C</td>
<td>如果 svc.dest=&lsquo;default&rsquo;，默认服务指向哪里？postgres 或 pgbouncer，默认指向 pgbouncer</td>
</tr>
<tr>
<td>924</td>
<td><a href="/zh/docs/reference/param/#pg_default_services"><code>pg_default_services</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>service[]</td>
<td>G/C</td>
<td>postgres 默认服务定义列表，全局共用。</td>
</tr>
<tr>
<td>931</td>
<td><a href="/zh/docs/reference/param/#pg_vip_enabled"><code>pg_vip_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>bool</td>
<td>C</td>
<td>是否为 pgsql 主节点启用 L2 VIP？默认不启用</td>
</tr>
<tr>
<td>932</td>
<td><a href="/zh/docs/reference/param/#pg_vip_address"><code>pg_vip_address</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>cidr4</td>
<td>C</td>
<td>vip 地址的格式为 <ipv4>/<mask>，启用 vip 时为必选参数</td>
</tr>
<tr>
<td>933</td>
<td><a href="/zh/docs/reference/param/#pg_vip_interface"><code>pg_vip_interface</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>string</td>
<td>C/I</td>
<td>监听的 vip 网络接口，默认为 eth0</td>
</tr>
<tr>
<td>934</td>
<td><a href="/zh/docs/reference/param/#pg_dns_suffix"><code>pg_dns_suffix</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>string</td>
<td>C</td>
<td>pgsql dns 后缀，默认为空</td>
</tr>
<tr>
<td>935</td>
<td><a href="/zh/docs/reference/param/#pg_dns_target"><code>pg_dns_target</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>enum</td>
<td>C</td>
<td>PG DNS 解析到哪里？auto、primary、vip、none 或者特定的 IP 地址</td>
</tr>
<tr>
<td>940</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_enabled"><code>pg_exporter_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>bool</td>
<td>C</td>
<td>在 pgsql 主机上启用 pg_exporter 吗？</td>
</tr>
<tr>
<td>941</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_config"><code>pg_exporter_config</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>pg_exporter 配置文件/模板名称</td>
</tr>
<tr>
<td>942</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_cache_ttls"><code>pg_exporter_cache_ttls</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>pg_exporter 收集器阶梯TTL配置，默认为4个由逗号分隔的秒数：&lsquo;1,10,60,300&rsquo;</td>
</tr>
<tr>
<td>943</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_port"><code>pg_exporter_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>port</td>
<td>C</td>
<td>pg_exporter 监听端口，默认为 9630</td>
</tr>
<tr>
<td>944</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_params"><code>pg_exporter_params</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>pg_exporter dsn 中传入的额外 URL 参数</td>
</tr>
<tr>
<td>945</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_url"><code>pg_exporter_url</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>pgurl</td>
<td>C</td>
<td>如果指定，则覆盖自动生成的 postgres DSN 连接串</td>
</tr>
<tr>
<td>946</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_auto_discovery"><code>pg_exporter_auto_discovery</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>bool</td>
<td>C</td>
<td>监控是否启用自动数据库发现？默认启用</td>
</tr>
<tr>
<td>947</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_exclude_database"><code>pg_exporter_exclude_database</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>启用自动发现时，排除在外的数据库名称列表，用逗号分隔</td>
</tr>
<tr>
<td>948</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_include_database"><code>pg_exporter_include_database</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>启用自动发现时，只监控这个列表中的数据库，名称用逗号分隔</td>
</tr>
<tr>
<td>949</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_connect_timeout"><code>pg_exporter_connect_timeout</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>int</td>
<td>C</td>
<td>pg_exporter 连接超时，单位毫秒，默认为 200</td>
</tr>
<tr>
<td>950</td>
<td><a href="/zh/docs/reference/param/#pg_exporter_options"><code>pg_exporter_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>arg</td>
<td>C</td>
<td>pg_exporter 的额外命令行参数选项</td>
</tr>
<tr>
<td>951</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_exporter_enabled"><code>pgbouncer_exporter_enabled</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>bool</td>
<td>C</td>
<td>在 pgsql 主机上启用 pgbouncer_exporter 吗？</td>
</tr>
<tr>
<td>952</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_exporter_port"><code>pgbouncer_exporter_port</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>port</td>
<td>C</td>
<td>pgbouncer_exporter 监听端口，默认为 9631</td>
</tr>
<tr>
<td>953</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_exporter_url"><code>pgbouncer_exporter_url</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>pgurl</td>
<td>C</td>
<td>如果指定，则覆盖自动生成的 pgbouncer dsn 连接串</td>
</tr>
<tr>
<td>954</td>
<td><a href="/zh/docs/reference/param/#pgbouncer_exporter_options"><code>pgbouncer_exporter_options</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>arg</td>
<td>C</td>
<td>pgbouncer_exporter 的额外命令行参数选项</td>
</tr>
</tbody>
</table>
<hr>
<h1 id="infra"><code>INFRA</code></h1>
<p>关于基础设施组件的配置参数：本地软件源，Nginx，DNSMasq，Prometheus，Grafana，Loki，Alertmanager，Pushgateway，Blackbox_exporter 等&hellip;</p>
<hr>
<h2 id="meta"><code>META</code></h2>
<p>这一小节指定了一套 Pigsty 部署的元数据：包括版本号，管理员节点 IP 地址，软件源镜像上游<a href="/zh/docs/reference/param/#region"><code>区域</code></a> 和下载软件包时使用的 http(s) 代理。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v2.8.0                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pigsty 版本号</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">admin_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.10</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># 管理节点IP地址</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 上游镜像区域：default,china,europe</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">proxy_env</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># 全局HTTPS代理，用于下载、安装软件包。</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">no_proxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16,*.pigsty,*.aliyun.com,mirrors.*,*.myqcloud.com,*.tsinghua.edu.cn&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># http_proxy:  # set your proxy here: e.g http://user:pass@proxy.xxx.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># https_proxy: # set your proxy here: e.g http://user:pass@proxy.xxx.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># all_proxy:   # set your proxy here: e.g http://user:pass@proxy.xxx.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="version"><code>version</code></h3>
<p>参数名称： <code>version</code>， 类型： <code>string</code>， 层次：<code>G</code></p>
<p>Pigsty 版本号字符串，默认值为当前版本：<code>v3.0.4</code>。</p>
<p>Pigsty 内部会使用版本号进行功能控制与内容渲染。</p>
<p>Pigsty使用语义化版本号，版本号字符串通常以字符 <code>v</code> 开头。</p>
<h3 id="admin_ip"><code>admin_ip</code></h3>
<p>参数名称： <code>admin_ip</code>， 类型： <code>ip</code>， 层次：<code>G</code></p>
<p>管理节点的 IP 地址，默认为占位符 IP 地址：<code>10.10.10.10</code></p>
<p>由该参数指定的节点将被视为管理节点，通常指向安装 Pigsty 时的第一个节点，即中控节点。</p>
<p>默认值 <code>10.10.10.10</code> 是一个占位符，会在 <a href="/zh/docs/setup/install#%E9%85%8D%E7%BD%AE">configure</a> 过程中被替换为实际的管理节点 IP 地址。</p>
<p>许多参数都会引用此参数，例如：</p>
<ul>
<li><a href="/zh/docs/reference/param/#infra_portal"><code>infra_portal</code></a></li>
<li><a href="/zh/docs/reference/param/#repo_endpoint"><code>repo_endpoint</code></a></li>
<li><a href="/zh/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a></li>
<li><a href="/zh/docs/reference/param/#dns_records"><code>dns_records</code></a></li>
<li><a href="/zh/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a></li>
<li><a href="/zh/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a></li>
</ul>
<p>在这些参数中，字符串 <code>${admin_ip}</code> 会被替换为 <code>admin_ip</code> 的真实取值。使用这种机制，您可以为不同的节点指定不同的中控管理节点。</p>
<h3 id="region"><code>region</code></h3>
<p>参数名称： <code>region</code>， 类型： <code>enum</code>， 层次：<code>G</code></p>
<p>上游镜像的区域，默认可选值为：upstream mirror region: default,china,europe，默认为： <code>default</code></p>
<p>如果一个不同于 <code>default</code> 的区域被设置，且在 <a href="/zh/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> 中有对应的条目，将会使用该条目对应 <code>baseurl</code> 代替 <code>default</code> 中的 <code>baseurl</code>。</p>
<p>例如，如果您的区域被设置为 <code>china</code>，那么 Pigsty 会尝试使用中国地区的上游软件镜像站点以加速下载，如果某个上游软件仓库没有对应的中国地区镜像，那么会使用默认的上游镜像站点替代。
同时，在 <a href="/zh/docs/reference/param/#repo_url_packages"><code>repo_url_packages</code></a> 中定义的 URL 地址，也会进行从 <code>repo.pigsty.io</code> 到 <code>repo.pigsty.cc</code> 的替换，以使用国内的镜像源。</p>
<h3 id="proxy_env"><code>proxy_env</code></h3>
<p>参数名称： <code>proxy_env</code>， 类型： <code>dict</code>， 层次：<code>G</code></p>
<p>下载包时使用的全局代理环境变量，默认值指定了 <code>no_proxy</code>，即不使用代理的地址列表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">proxy_env</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">no_proxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16,*.pigsty,*.aliyun.com,mirrors.aliyuncs.com,mirrors.tuna.tsinghua.edu.cn,mirrors.zju.edu.cn&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic">#http_proxy: &#39;http://username:password@proxy.address.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic">#https_proxy: &#39;http://username:password@proxy.address.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic">#all_proxy: &#39;http://username:password@proxy.address.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>当您在中国大陆地区从互联网上游安装时，特定的软件包可能会被墙，您可以使用代理来解决这个问题。</p>
<p>请注意，如果使用了 Docker 模块，那么这里的代理服务器配置也会写入 Docker Daemon 配置文件中。</p>
<p>请注意，如果在 <code>./configure</code> 过程中指定了 <code>-x</code> 参数，那么当前环境中的代理配置信息将会被自动填入到生成的 <code>pigsty.yaml</code> 文件中。</p>
<hr>
<h2 id="ca"><code>CA</code></h2>
<p>Pigsty 使用的自签名 CA 证书，用于支持高级安全特性。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">ca_method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">create                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># CA处理方式：create,recreate,copy，默认为没有则创建</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ca_cn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty-ca                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># CA CN名称，固定为 pigsty-ca</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">cert_validity</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">7300d             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 证书有效期，默认为 20 年</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="ca_method"><code>ca_method</code></h3>
<p>参数名称： <code>ca_method</code>， 类型： <code>enum</code>， 层次：<code>G</code></p>
<p>CA处理方式：<code>create</code> , <code>recreate</code> ,<code>copy</code>，默认为没有则创建</p>
<p>默认值为： <code>create</code>，即如果不存在则创建一个新的 CA 证书。</p>
<ul>
<li><code>create</code>：如果 <code>files/pki/ca</code> 中不存在现有的CA，则创建一个全新的 CA 公私钥对，否则就直接使用现有的 CA 公私钥对。</li>
<li><code>recreate</code>：总是创建一个新的 CA 公私钥对，覆盖现有的 CA 公私钥对。注意，这是一个危险的操作。</li>
<li><code>copy</code>：假设<code>files/pki/ca</code> 目录下已经有了一对CA公私钥对，并将 <code>ca_method</code> 设置为 <code>copy</code>，Pigsty 将会使用现有的 CA 公私钥对。如果不存在则会报错</li>
</ul>
<p>如果您已经有了一对 CA 公私钥对，可以将其复制到 <code>files/pki/ca</code> 目录下，并将 <code>ca_method</code> 设置为 <code>copy</code>，Pigsty 将会使用现有的 CA 公私钥对，而不是新建一个。</p>
<p>请注意，务必保留并备份好一套部署新生成的 CA 私钥文件。</p>
<h3 id="ca_cn"><code>ca_cn</code></h3>
<p>参数名称： <code>ca_cn</code>， 类型： <code>string</code>， 层次：<code>G</code></p>
<p>CA CN名称，固定为 <code>pigsty-ca</code>，不建议修改。</p>
<p>你可以使用以下命令来查看节点上的 Pigsty CA 证书： <code>openssl x509 -text -in /etc/pki/ca.crt</code></p>
<h3 id="cert_validity"><code>cert_validity</code></h3>
<p>参数名称： <code>cert_validity</code>， 类型： <code>interval</code>， 层次：<code>G</code></p>
<p>签发证书的有效期，默认为 20 年，对绝大多数场景都足够了。默认值为： <code>7300d</code></p>
<hr>
<h2 id="infra_id"><code>INFRA_ID</code></h2>
<p>Infrastructure identity and portal definition.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#infra_seq: 1                     # infra node identity, explicitly required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra_portal</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># infra services exposed via portal</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">home         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">h.pigsty }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">grafana      </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: g.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3000&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">prometheus   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: p.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9090&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">alertmanager </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: a.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9093&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">blackbox     </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9115&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">loki         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3100&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="infra_seq"><code>infra_seq</code></h3>
<p>参数名称： <code>infra_seq</code>， 类型： <code>int</code>， 层次：<code>I</code></p>
<p>基础设施节号，必选身份参数，所以不提供默认值，必须在基础设施节点上显式指定。</p>
<h3 id="infra_portal"><code>infra_portal</code></h3>
<p>参数名称： <code>infra_portal</code>， 类型： <code>dict</code>， 层次：<code>G</code></p>
<p>通过Nginx门户暴露的基础设施服务列表，默认情况下，Pigsty 会通过 Nginx 对外暴露以下服务：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">infra_portal</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">home         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">h.pigsty }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">grafana      </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: g.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3000&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">prometheus   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: p.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9090&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">alertmanager </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: a.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9093&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">blackbox     </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9115&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">loki         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3100&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>每条记录由一个 Key 与一个 Value 字典组成，<code>name</code> 作为键，代表组件名称，value 中唯一一个必选字段为 <code>domain</code> ，代表域名。</p>
<ul>
<li><code>domain</code> 是用于外部访问此上游服务器的域名。域名将被添加到Nginx SSL证书的 <code>SAN</code> 字段中，此字段为必选项目。
<ul>
<li><strong>默认记录</strong> 的 <code>name</code> 是固定的，其他模块会引用它，所以不要修改默认条目的 <strong>名称</strong>。</li>
</ul>
</li>
<li><code>endpoint</code> 是一个可以内部访问的TCP端口，如果指定，Nginx会将请求转发至此 endpoint 指定的地址。
<ul>
<li><code>endpoint</code> 中 如果包含 <code>${admin_ip}</code> ，则将在运行时被实际的 <a href="/zh/docs/reference/param/#admin_ip"><code>admin_ip</code></a> 替换。</li>
</ul>
</li>
<li><code>path</code> 是一个可以本地访问的路径，如果指定将作为本地 Web 服务器的根，Nginx会将 <code>domain</code> 对应的请求转发至这里。
<ul>
<li><code>endpoint</code> 与 <code>path</code> 互斥，你只能在一个条目中二选一：是上游 Proxy，还是本地 Web Server。</li>
</ul>
</li>
<li>如果 <code>websocket</code> 设置为 <code>true</code>，http协议将自动为 Websocket 连接升级。
<ul>
<li>当上游用到 WebSocket 时，可以启用此选项（例如 Grafana/Jupyter）</li>
</ul>
</li>
<li>如果给定了 <code>scheme</code>（<code>http</code> 或 <code>https</code>），它将被用作 proxy_pass URL的一部分。
<ul>
<li>作为 Proxy 时，当上游要求 Proxy 使用 HTTPS 而不是 HTTP 时使用此选项。（例如 MinIO ）</li>
</ul>
</li>
</ul>
<hr>
<h2 id="repo"><code>REPO</code></h2>
<p>本节配置是关于本地软件仓库的。 Pigsty 默认会在基础设施节点上启用一个本地软件仓库（APT / YUM）。</p>
<p>在初始化过程中，Pigsty 会从互联网上游仓库（由 <a href="/zh/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> 指定）下载所有软件包及其依赖项（由 <a href="/zh/docs/reference/param/#repo_packages"><code>repo_packages</code></a> 指定）到 <a href="/zh/docs/reference/param/#nginx_home"><code>{{ nginx_home }}</code></a> / <a href="/zh/docs/reference/param/#repo_name"><code>{{ repo_name }}</code></a> （默认为 <code>/www/pigsty</code>），所有软件及其依赖的总大小约为1GB左右。</p>
<p>创建本地软件仓库时，如果仓库已存在（判断方式：仓库目录目录中有一个名为 <code>repo_complete</code> 的标记文件）Pigsty 将认为仓库已经创建完成，跳过软件下载阶段，直接使用构建好的仓库。</p>
<p>如果某些软件包的下载速度太慢，您可以通过使用 <a href="/zh/docs/reference/param/#proxy_env"><code>proxy_env</code></a> 配置项来设置下载代理来完成首次下载，或直接下载预打包的 <a href="/zh/docs/setup/offline">离线软件包</a>，离线软件包本质上就是在同样操作系统上构建好的本地软件源。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">repo_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># create a yum repo on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_home</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/www                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># repo home dir, `/www` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># repo name, pigsty by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://${admin_ip}:80</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># access point to this repo by domain or ip:port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_remove</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># remove existing upstream repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">infra,node,pgsql   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># install upstream repo during repo bootstrap</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#repo_upstream: []                # where to download</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#repo_packages: []                # which packages to download</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#repo_extra_packages: []          # extra packages to download</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_url_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># extra packages from url</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;pev.html&#34;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://repo.pigsty.io/etc/pev-1.12.1.html&#34;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;chart.tgz&#34;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://repo.pigsty.io/etc/chart-1.0.0.tgz&#34;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;plugins.tgz&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://repo.pigsty.io/etc/plugins-11.3.0.tgz&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="repo_enabled"><code>repo_enabled</code></h3>
<p>参数名称： <code>repo_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在当前的基础设施节点上启用本地软件源？默认为： <code>true</code>，即所有 Infra 节点都会设置一个本地软件仓库。</p>
<p>如果您有多个基础设施节点，可以只保留 1 ～ 2 个节点作为软件仓库，其他节点可以通过设置此参数为 <code>false</code> 来避免重复软件下载构建。</p>
<h3 id="repo_home"><code>repo_home</code></h3>
<p>参数名称： <code>repo_home</code>， 类型： <code>path</code>， 层次：<code>G</code></p>
<p>本地软件仓库的家目录，默认为 Nginx 的根目录，也就是： <code>/www</code>，我们不建议您修改此目录。如果修改，需要和 <a href="/zh/docs/reference/param/#nginx_home"><code>nginx_home</code></a></p>
<h3 id="repo_name"><code>repo_name</code></h3>
<p>参数名称： <code>repo_name</code>， 类型： <code>string</code>， 层次：<code>G</code></p>
<p>本地仓库名称，默认为 <code>pigsty</code>，更改此仓库的名称是不明智的行为。</p>
<h3 id="repo_endpoint"><code>repo_endpoint</code></h3>
<p>参数名称： <code>repo_endpoint</code>， 类型： <code>url</code>， 层次：<code>G</code></p>
<p>其他节点访问此仓库时使用的端点，默认值为：<code>http://${admin_ip}:80</code>。</p>
<p>Pigsty 默认会在基础设施节点 80/443 端口启动 Nginx，对外提供本地软件源（静态文件）服务。</p>
<p>如果您修改了 <a href="/zh/docs/reference/param/#nginx_port"><code>nginx_port</code></a> 与 <a href="/zh/docs/reference/param/#nginx_ssl_port"><code>nginx_ssl_port</code></a>，或者使用了不同于中控节点的基础设施节点，请相应调整此参数。</p>
<p>如果您使用了域名，可以在 <a href="/zh/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a>、<a href="/zh/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a>、或者 <a href="/zh/docs/reference/param/#dns_records"><code>dns_records</code></a> 中添加解析。</p>
<h3 id="repo_remove"><code>repo_remove</code></h3>
<p>参数名称： <code>repo_remove</code>， 类型： <code>bool</code>， 层次：<code>G/A</code></p>
<p>在构建本地软件源时，是否移除现有的上游仓库定义？默认值： <code>true</code>。</p>
<p>当启用此参数时，<code>/etc/yum.repos.d</code> 中所有已有仓库文件会被移动备份至<code>/etc/yum.repos.d/backup</code>，在 Debian 系上是移除 <code>/etc/apt/sources.list</code> 和 <code>/etc/apt/sources.list.d</code>，将文件备份至 <code>/etc/apt/backup</code> 中。</p>
<p>因为操作系统已有的源内容不可控，使用 Pigsty 验证过的上游软件源可以提高从互联网下载软件包的成功率与速度。</p>
<p>但在一些特定情况下（例如您的操作系统是某种 EL/Deb 兼容版，许多软件包使用了自己的私有源），您可能需要保留现有的上游仓库定义，此时可以将此参数设置为 <code>false</code>。</p>
<h3 id="repo_modules"><code>repo_modules</code></h3>
<p>参数名称： <code>repo_modules</code>， 类型： <code>string</code>， 层次：<code>G/A</code></p>
<p>哪些上游仓库模块会被添加到本地软件源中，默认值： <code>infra,node,pgsql</code></p>
<p>当 Pigsty 尝试添加上游仓库时，会根据此参数的值来过滤 <a href="/zh/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> 中的条目，只有 <code>module</code> 字段与此参数值匹配的条目才会被添加到本地软件源中。</p>
<p>模块以逗号分隔，可用的模块列表请参考 <code>repo_upstream</code> 中的定义</p>
<h3 id="repo_upstream"><code>repo_upstream</code></h3>
<p>参数名称： <code>repo_upstream</code>， 类型： <code>upstream[]</code>， 层次：<code>G</code></p>
<p>构建本地软件源时，从哪里下载上游软件包？本参数没有默认值，如果用户不在配置文件中显式指定，则会从根据当前节点的操作系统族，从定义于 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> 中的 <code>repo_upstream_default</code> 变量中加载获取。</p>
<p>对于 EL （7，8，9）系统，默认使用的软件源如下所示：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-local   ,description: &#39;Pigsty Local&#39;      ,module: local   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://${admin_ip}/pigsty&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># used by intranet nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-infra   ,description: &#39;Pigsty INFRA&#39;      ,module: infra   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.pigsty.io/yum/infra/$basearch&#39; ,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/yum/infra/$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-pgsql   ,description: &#39;Pigsty PGSQL&#39;      ,module: pgsql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.pigsty.io/yum/pgsql/el$releasever.$basearch&#39; ,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/yum/pgsql/el$releasever.$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: nginx          ,description: &#39;Nginx Repo&#39;        ,module: infra   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://nginx.org/packages/rhel/$releasever/$basearch/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: baseos         ,description: &#39;EL 8+ BaseOS&#39;      ,module: node    ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/BaseOS/$basearch/os/&#39;     ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/BaseOS/$basearch/os/&#39;          ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/BaseOS/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: appstream      ,description: &#39;EL 8+ AppStream&#39;   ,module: node    ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/AppStream/$basearch/os/&#39;  ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/AppStream/$basearch/os/&#39;       ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/AppStream/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: extras         ,description: &#39;EL 8+ Extras&#39;      ,module: node    ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/extras/$basearch/os/&#39;     ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/extras/$basearch/os/&#39;          ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/extras/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: powertools     ,description: &#39;EL 8 PowerTools&#39;   ,module: node    ,releases: [  8  ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/PowerTools/$basearch/os/&#39; ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/PowerTools/$basearch/os/&#39;      ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/PowerTools/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: crb            ,description: &#39;EL 9 CRB&#39;          ,module: node    ,releases: [    9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/CRB/$basearch/os/&#39;        ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/CRB/$basearch/os/&#39;             ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/CRB/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">        </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: epel           ,description: &#39;EL 8+ EPEL&#39;        ,module: node    ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;http://download.fedoraproject.org/pub/epel/$releasever/Everything/$basearch/&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/epel/$releasever/Everything/$basearch/&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/epel/$releasever/Everything/$basearch/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg-common    ,description: &#39;PostgreSQL Common&#39; ,module: pgsql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/common/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/common/redhat/rhel-$releasever-$basearch&#39; , europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/common/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg-extras    ,description: &#39;PostgreSQL Extra&#39;  ,module: pgsql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/common/pgdg-rhel$releasever-extras/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/common/pgdg-rhel$releasever-extras/redhat/rhel-$releasever-$basearch&#39; , europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/common/pgdg-rhel$releasever-extras/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg-el8fix    ,description: &#39;PostgreSQL EL8FIX&#39; ,module: pgsql   ,releases: [  8  ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/common/pgdg-centos8-sysupdates/redhat/rhel-8-x86_64/&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/common/pgdg-centos8-sysupdates/redhat/rhel-8-x86_64/&#39; , europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/common/pgdg-centos8-sysupdates/redhat/rhel-8-x86_64/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg-el9fix    ,description: &#39;PostgreSQL EL9FIX&#39; ,module: pgsql   ,releases: [    9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/common/pgdg-rocky9-sysupdates/redhat/rhel-9-x86_64/&#39;  ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/common/pgdg-rocky9-sysupdates/redhat/rhel-9-x86_64/&#39; , europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/common/pgdg-rocky9-sysupdates/redhat/rhel-9-x86_64/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg17         ,description: &#39;PostgreSQL 17&#39;     ,module: pgsql   ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/17/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/17/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/17/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg17-nonfree ,description: &#39;PostgreSQL 17+&#39;    ,module: pgsql   ,releases: [  8,9] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: timescaledb    ,description: &#39;TimescaleDB&#39;       ,module: pgsql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://packagecloud.io/timescale/timescaledb/el/$releasever/$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># these repos are not used by default, but can be enabled by setting repo_modules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg12         ,description: &#39;PostgreSQL 12&#39;     ,module: pg12    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/12/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/12/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/12/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg12-nonfree ,description: &#39;PostgreSQL 12+&#39;    ,module: pg12    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/12/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/12/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/12/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg13         ,description: &#39;PostgreSQL 13&#39;     ,module: pg13    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/13/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/13/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/13/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg13-nonfree ,description: &#39;PostgreSQL 13+&#39;    ,module: pg13    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/13/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/13/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/13/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg14         ,description: &#39;PostgreSQL 14&#39;     ,module: pg14    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/14/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/14/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/14/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg14-nonfree ,description: &#39;PostgreSQL 14+&#39;    ,module: pg14    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/14/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/14/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/14/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg15         ,description: &#39;PostgreSQL 15&#39;     ,module: pg15    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/15/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/15/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/15/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg15-nonfree ,description: &#39;PostgreSQL 15+&#39;    ,module: pg15    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/15/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/15/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/15/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg16         ,description: &#39;PostgreSQL 16&#39;     ,module: pg16    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/16/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/16/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/16/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg16-nonfree ,description: &#39;PostgreSQL 16+&#39;    ,module: pg16    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/16/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/16/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/16/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg17         ,description: &#39;PostgreSQL 17&#39;     ,module: pg17    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/17/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/17/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/17/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg17-nonfree ,description: &#39;PostgreSQL 17+&#39;    ,module: pg17    ,releases: [7,8,9] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: docker-ce      ,description: &#39;Docker CE&#39;         ,module: docker  ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.docker.com/linux/centos/$releasever/$basearch/stable&#39;    ,china: &#39;https://mirrors.aliyun.com/docker-ce/linux/centos/$releasever/$basearch/stable&#39;  ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/docker-ce/linux/centos/$releasever/$basearch/stable&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: kubernetes     ,description: &#39;Kubernetes&#39;        ,module: kube    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://pkgs.k8s.io/core:/stable:/v1.31/rpm/&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/kubernetes-new/core/stable/v1.31/rpm/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: wiltondb       ,description: &#39;WiltonDB&#39;          ,module: mssql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.copr.fedorainfracloud.org/results/wiltondb/wiltondb/epel-$releasever-$basearch/&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/yum/mssql/el$releasever.$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: ivorysql       ,description: &#39;IvorySQL&#39;          ,module: ivory   ,releases: [7,8,9] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.pigsty.io/yum/ivory/el$releasever.$basearch&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/yum/ivory/el$releasever.$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: mysql          ,description: &#39;MySQL&#39;             ,module: mysql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.mysql.com/yum/mysql-8.0-community/el/$releasever/$basearch/&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/mysql/yum/mysql-8.0-community-el7-$basearch/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: grafana        ,description: &#39;Grafana&#39;           ,module: grafana ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://rpm.grafana.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>对于 Debian （11，12）或 Ubuntu （20.04，22.04），默认使用的软件源如下所示：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-local  ,description: &#39;Pigsty Local&#39;     ,module: local     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://${admin_ip}/pigsty ./&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-pgsql  ,description: &#39;Pigsty PgSQL&#39;     ,module: pgsql     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.io/apt/pgsql/${distro_codename} ${distro_codename} main&#39;</span><span style="color:#204a87;font-weight:bold">, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/apt/pgsql/${distro_codename} ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-infra  ,description: &#39;Pigsty Infra&#39;     ,module: infra     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.pigsty.io/apt/infra/ generic main&#39; ,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/apt/infra/ generic main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: nginx         ,description: &#39;Nginx&#39;            ,module: infra     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://nginx.org/packages/${distro_name} ${distro_codename} nginx&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: base          ,description: &#39;Debian Basic&#39;     ,module: node      ,releases: [11,12         ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://deb.debian.org/debian/ ${distro_codename} main non-free-firmware&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/debian/ ${distro_codename} main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: updates       ,description: &#39;Debian Updates&#39;   ,module: node      ,releases: [11,12         ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://deb.debian.org/debian/ ${distro_codename}-updates main non-free-firmware&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/debian/ ${distro_codename}-updates main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: security      ,description: &#39;Debian Security&#39;  ,module: node      ,releases: [11,12         ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://security.debian.org/debian-security ${distro_codename}-security main non-free-firmware&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: base          ,description: &#39;Ubuntu Basic&#39;     ,module: node      ,releases: [      20,22,24] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.edge.kernel.org/ubuntu/ ${distro_codename}           main universe multiverse restricted&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu/ ${distro_codename}           main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: updates       ,description: &#39;Ubuntu Updates&#39;   ,module: node      ,releases: [      20,22,24] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.edge.kernel.org/ubuntu/ ${distro_codename}-backports main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu/ ${distro_codename}-updates   main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: backports     ,description: &#39;Ubuntu Backports&#39; ,module: node      ,releases: [      20,22,24] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.edge.kernel.org/ubuntu/ ${distro_codename}-security  main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu/ ${distro_codename}-backports main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: security      ,description: &#39;Ubuntu Security&#39;  ,module: node      ,releases: [      20,22,24] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.edge.kernel.org/ubuntu/ ${distro_codename}-updates   main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu/ ${distro_codename}-security  main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: base          ,description: &#39;Ubuntu Basic&#39;     ,module: node      ,releases: [      20,22,24] ,arch: [        aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://ports.ubuntu.com/ubuntu-ports/ ${distro_codename}           main universe multiverse restricted&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu-ports/ ${distro_codename}           main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: updates       ,description: &#39;Ubuntu Updates&#39;   ,module: node      ,releases: [      20,22,24] ,arch: [        aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://ports.ubuntu.com/ubuntu-ports/ ${distro_codename}-backports main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu-ports/ ${distro_codename}-updates   main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: backports     ,description: &#39;Ubuntu Backports&#39; ,module: node      ,releases: [      20,22,24] ,arch: [        aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://ports.ubuntu.com/ubuntu-ports/ ${distro_codename}-security  main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu-ports/ ${distro_codename}-backports main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: security      ,description: &#39;Ubuntu Security&#39;  ,module: node      ,releases: [      20,22,24] ,arch: [        aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://ports.ubuntu.com/ubuntu-ports/ ${distro_codename}-updates   main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu-ports/ ${distro_codename}-security  main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg          ,description: &#39;PGDG&#39;             ,module: pgsql     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://apt.postgresql.org/pub/repos/apt/ ${distro_codename}-pgdg main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/apt/ ${distro_codename}-pgdg main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: citus         ,description: &#39;Citus&#39;            ,module: pgsql     ,releases: [11,12,20,22   ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://packagecloud.io/citusdata/community/${distro_name}/ ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: timescaledb   ,description: &#39;Timescaledb&#39;      ,module: pgsql     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://packagecloud.io/timescale/timescaledb/${distro_name}/ ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># these repos are not used by default, but can be enabled by setting repo_modules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: grafana      ,description: &#39;Grafana&#39;           ,module: grafana   ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://apt.grafana.com stable main&#39; ,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/grafana/apt/ stable main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgml         ,description: &#39;PostgresML&#39;        ,module: pgml      ,releases: [         22   ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://apt.postgresml.org ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: wiltondb     ,description: &#39;WiltonDB&#39;          ,module: mssql     ,releases: [      20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://ppa.launchpadcontent.net/wiltondb/wiltondb/ubuntu/ ${distro_codename} main&#39;</span><span style="color:#204a87;font-weight:bold">, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/apt/mssql/ ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: mysql        ,description: &#39;MySQL&#39;             ,module: mysql     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.mysql.com/apt/${distro_name} ${distro_codename} mysql-8.0 mysql-tools&#39;</span><span style="color:#204a87;font-weight:bold">, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/mysql/apt/${distro_name} ${distro_codename} mysql-8.0 mysql-tools&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: docker-ce    ,description: &#39;Docker&#39;            ,module: docker    ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://download.docker.com/linux/${distro_name} ${distro_codename} stable&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux//${distro_name} ${distro_codename} stable&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: kubernetes   ,description: &#39;Kubernetes&#39;        ,module: kube      ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://pkgs.k8s.io/core:/stable:/v1.31/deb/ /&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/kubernetes-new/core/stable/v1.31/deb/ /&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Pigsty 构建配置模板 <a href="https://github.com/Vonng/pigsty/blob/main/conf/build/oss.yml"><code>oss.yml</code></a> 提供了不同操作系统下的默认值。</p>
<h3 id="repo_packages"><code>repo_packages</code></h3>
<p>参数名称： <code>repo_packages</code>， 类型： <code>string[]</code>， 层次：<code>G</code></p>
<p>字符串数组类型，每一行都是 <strong>由空格分隔</strong> 的软件包列表字符串，指定将要使用 <code>repotrack</code> 或 <code>apt download</code> 下载到本地的软件包（及其依赖）。</p>
<p>本参数没有默认值，即默认值为未定义状态。如果该参数没有被显式定义，那么 Pigsty 会从  <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> 中定义的 <code>repo_packages_default</code> 变量中加载获取默认值，默认值为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node-bootstrap, infra-package, infra-addons, node-package1, node-package2, pgsql-utility ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>该参数中的每个元素，都会在上述文件中定义的 <code>package_map</code> 中，根据特定的操作系统发行版大版本进行翻译。例如在 EL 系统上会翻译为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node-bootstrap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#4e9a06">&#34;ansible python3 python3-pip python3-virtualenv python3-requests python3-jmespath python3-cryptography dnf-utils modulemd-tools createrepo_c sshpass&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra-package</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;nginx dnsmasq etcd haproxy vip-manager pg_exporter pgbackrest_exporter redis_exporter redis minio mcli ferretdb duckdb&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra-addons</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#4e9a06">&#34;grafana loki logcli promtail prometheus2 alertmanager pushgateway node_exporter blackbox_exporter nginx_exporter keepalived_exporter&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node-package1</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;lz4 unzip bzip2 zlib yum pv jq git ncdu make patch bash lsof wget uuid tuned nvme-cli numactl grubby sysstat iotop htop rsync tcpdump perf flamegraph chkconfig&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node-package2</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;netcat socat ftp lrzsz net-tools ipvsadm bind-utils telnet audit ca-certificates readline vim-minimal keepalived chrony openssl openssh-server openssh-clients&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgsql-utility</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;patroni patroni-etcd pgbouncer pgbackrest pgbadger pg_activity pg_timetable pgFormatter pg_filedump pgxnclient timescaledb-tools pgcopydb pgloader&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>而在 Debian 系统上会被翻译为对应的 Debian DEB 包名：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node-bootstrap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#4e9a06">&#34;ansible python3 python3-pip python3-venv python3-jmespath dpkg-dev sshpass ftp linux-tools-generic&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra-package</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;nginx dnsmasq etcd haproxy vip-manager pg-exporter pgbackrest-exporter redis-exporter redis minio mcli ferretdb duckdb&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra-addons</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#4e9a06">&#34;grafana loki logcli promtail prometheus2 alertmanager pushgateway node-exporter blackbox-exporter nginx-exporter keepalived-exporter&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node-package1</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;lz4 unzip bzip2 zlib1g pv jq git ncdu make patch bash lsof wget uuid tuned nvme-cli numactl sysstat iotop htop rsync tcpdump acl chrony&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node-package2</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;netcat-openbsd socat lrzsz net-tools ipvsadm dnsutils telnet ca-certificates libreadline-dev vim-tiny keepalived openssl openssh-server openssh-client&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgsql-utility</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;patroni pgbouncer pgbackrest pgbadger pg-activity pg-timetable pgformatter postgresql-filedump pgxnclient timescaledb-tools pgcopydb pgloader&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>作为一个使用约定，<code>repo_packages</code> 中通常包括了那些与 PostgreSQL 大版本号无关的软件包（例如 Infra，Node 和 PGDG Common 等部分），而 PostgreSQL 大版本相关的软件包（内核，扩展），通常在 <code>repo_extra_packages</code> 中指定，方便用户切换 PG 大版本。</p>
<h3 id="repo_extra_packages"><code>repo_extra_packages</code></h3>
<p>参数名称： <code>repo_extra_packages</code>， 类型： <code>string[]</code>， 层次：<code>G/C/I</code></p>
<p>用于在不修改 <a href="/zh/docs/reference/param/#repo_packages"><code>repo_packages</code></a> 的基础上，指定额外需要下载的软件包（通常是 PG 大版本相关的软件包），默认值为空列表。</p>
<p>如果该参数没有被显式定义，那么 Pigsty 会从  <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> 中定义的 <code>repo_extra_packages_default</code> 变量中加载获取默认值，默认值为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql-main ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>该参数中的每个元素，都会在上述文件中定义的 <code>package_map</code> 中，根据特定的操作系统发行版大版本进行翻译。例如在 EL 系统上会翻译为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">postgresql$v* pg_repack_$v* wal2json_$v* pgvector_$v*</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>而在 Debian 系统上会被翻译为对应的 Debian DEB 包名：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">postgresql-$v postgresql-client-$v postgresql-plpython3-$v postgresql-plperl-$v postgresql-pltcl-$v postgresql-server-dev-$v postgresql-$v-repack postgresql-$v-wal2json postgresql-$v-pgvector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>这里的 <code>$v</code> 会被替换为 <a href="/zh/docs/reference/param/#pg_version"><code>pg_version</code></a>，即当前 PG 大版本号 （默认为 <code>17</code>）。通常用户可以在这里指定 PostgreSQL 大版本相关的软件包，而不影响 <code>repo_packages</code> 中定义的其他 PG 大版本无关的软件包。</p>
<h3 id="repo_url_packages"><code>repo_url_packages</code></h3>
<p>参数名称： <code>repo_url_packages</code>， 类型： <code>object[] | string[]</code>， 层次：<code>G</code></p>
<p>直接使用 URL 从互联网上下载的软件包，默认为一些额外可选的资源包：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">repo_url_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># extra packages from url</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;pev.html&#34;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://repo.pigsty.io/etc/pev-1.12.1.html&#34;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Explain Visualizer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;chart.tgz&#34;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://repo.pigsty.io/etc/chart-1.0.0.tgz&#34;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Grafana Maps</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;plugins.tgz&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://repo.pigsty.io/etc/plugins-11.1.4.tgz&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Grafana Plugins</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>这几个都是可选的加装项：例如，如果不下载 <code>plugins.tgz</code>，Grafana 初始化的时候就会直接从互联网上下载插件，这样会导致初始化时间变长（而且有可能被墙），但是不会影响最终结果。</p>
<p>您可以直接在本参数中使用 URL 字符串作为数组元素，也可以使用 Pigsty v3 新引入的对象结构，显式指定 URL 与文件名称。</p>
<p>请注意，本参数会收到 <a href="/zh/docs/reference/param/#region"><code>region</code></a> 变量的影响，如果您在中国大陆地区，Pigsty 会自动将 URL 替换为国内镜像站点，即将 URL 里的 <code>repo.pigsty.io</code> 替换为 <code>repo.pigsty.cc</code>。</p>
<hr>
<h2 id="infra_package"><code>INFRA_PACKAGE</code></h2>
<p>这些软件包只会在 INFRA 节点上安装，包括普通的 RPM/DEB 软件包，以及 PIP 软件包。</p>
<h3 id="infra_packages"><code>infra_packages</code></h3>
<p>参数名称： <code>infra_packages</code>， 类型： <code>string[]</code>， 层次：<code>G</code></p>
<p>字符串数组类型，每一行都是 <strong>由空格分隔</strong> 的软件包列表字符串，指定将要在 Infra 节点上安装的软件包列表。</p>
<p>本参数没有默认值，即默认值为未定义状态。如果用户不在配置文件中显式指定本参数，则 Pigsty 会从根据当前节点的操作系统族，从定义于 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> 中的 <code>infra_packages_default</code> 变量中加载获取默认值。</p>
<p>默认值（EL系操作系统）：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">infra_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># packages to be installed on infra nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">grafana,loki,logcli,promtail,prometheus2,alertmanager,pushgateway</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">node_exporter,blackbox_exporter,nginx_exporter,pg_exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">nginx,dnsmasq,ansible,etcd,python3-requests,redis,mcli</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>默认值（Debian/Ubuntu）：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">infra_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># packages to be installed on infra nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">grafana,loki,logcli,promtail,prometheus2,alertmanager,pushgateway</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">node-exporter,blackbox-exporter,nginx-exporter,pg-exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">nginx,dnsmasq,ansible,etcd,python3-requests,redis,mcli</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="infra_packages_pip"><code>infra_packages_pip</code></h3>
<p>参数名称： <code>infra_packages_pip</code>， 类型： <code>string</code>， 层次：<code>G</code></p>
<p>Infra 节点上要使用 <code>pip</code> 额外安装的软件包，包名使用逗号分隔，默认值是空字符串，即不安装任何额外的 python 包。</p>
<hr>
<h2 id="nginx"><code>NGINX</code></h2>
<p>Pigsty 会通过 Nginx 代理所有的 Web 服务访问：Home Page、Grafana、Prometheus、AlertManager 等等。
以及其他可选的工具，如 PGWe、Jupyter Lab、Pgadmin、Bytebase 等等，还有一些静态资源和报告，如 <code>pev</code>、<code>schemaspy</code> 和 <code>pgbadger</code>。</p>
<p>最重要的是，Nginx 还作为本地软件仓库（Yum/Apt）的 Web 服务器，用于存储和分发 Pigsty 的软件包。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">nginx_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># enable nginx on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># enable nginx_exporter on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_sslmode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">enable            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># nginx ssl mode? disable,enable,enforce</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_home</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/www                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># nginx content dir, `/www` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">80</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># nginx listen port, 80 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_ssl_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">443</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># nginx ssl listen port, 443 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_navbar</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># nginx index page navigation links</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: CA Cert ,url: &#39;/ca.crt&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pigsty self-signed ca.crt&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Package ,url: &#39;/pigsty&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;local yum repo packages&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: PG Logs ,url: &#39;/logs&#39;     ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;postgres raw csv logs&#39;</span><span style="color:#f8f8f8;text-decoration:underline">       </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Reports ,url: &#39;/report&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pgbadger summary report&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Explain ,url: &#39;/pigsty/pev.html&#39; ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;postgres explain visualizer&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="nginx_enabled"><code>nginx_enabled</code></h3>
<p>参数名称： <code>nginx_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在当前的 Infra 节点上启用 Nginx？默认值为： <code>true</code>。</p>
<h3 id="nginx_exporter_enabled"><code>nginx_exporter_enabled</code></h3>
<p>参数名称： <code>nginx_exporter_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>在此基础设施节点上启用 nginx_exporter ？默认值为： <code>true</code>。</p>
<p>如果禁用此选项，还会一并禁用 <code>/nginx</code> 健康检查 stub，当您安装使用的 Nginx 版本不支持此功能是可以考虑关闭此开关</p>
<h3 id="nginx_sslmode"><code>nginx_sslmode</code></h3>
<p>参数名称： <code>nginx_sslmode</code>， 类型： <code>enum</code>， 层次：<code>G</code></p>
<p>Nginx 的 SSL工作模式？有三种选择：<code>disable</code> , <code>enable</code> , <code>enforce</code>， 默认值为 <code>enable</code>，即启用 SSL，但不强制使用。</p>
<ul>
<li><code>disable</code>：只监听 <a href="/zh/docs/reference/param/#nginx_port"><code>nginx_port</code></a> 指定的端口服务 HTTP 请求。</li>
<li><code>enable</code>：同时会监听 <a href="/zh/docs/reference/param/#nginx_ssl_port"><code>nginx_ssl_port</code></a> 指定的端口服务 HTTPS 请求。</li>
<li><code>enforce</code>：所有链接都会被渲染为默认使用 <code>https://</code></li>
</ul>
<h3 id="nginx_home"><code>nginx_home</code></h3>
<p>参数名称： <code>nginx_home</code>， 类型： <code>path</code>， 层次：<code>G</code></p>
<p>Nginx服务器静态文件目录，默认为： <code>/www</code></p>
<p>Nginx服务器的根目录，包含静态资源和软件仓库文件。最好不要随意修改此参数，修改时需要与 <a href="/zh/docs/reference/param/#repo_home"><code>repo_home</code></a> 参数保持一致。</p>
<h3 id="nginx_port"><code>nginx_port</code></h3>
<p>参数名称： <code>nginx_port</code>， 类型： <code>port</code>， 层次：<code>G</code></p>
<p>Nginx 默认监听的端口（提供HTTP服务），默认为 <code>80</code> 端口，最好不要修改这个参数。</p>
<p>当您的服务器 80 端口被占用时，可以考虑修改此参数，但是需要同时修改 <a href="/zh/docs/reference/param/#repo_endpoint"><code>repo_endpoint</code></a> ，以及 <a href="/zh/docs/reference/param/#node_repo_local_urls"><code>node_repo_local_urls</code></a> 所使用的端口并与这里保持一致。</p>
<h3 id="nginx_ssl_port"><code>nginx_ssl_port</code></h3>
<p>参数名称： <code>nginx_ssl_port</code>， 类型： <code>port</code>， 层次：<code>G</code></p>
<p>Nginx SSL 默认监听的端口，默认为 <code>443</code>，最好不要修改这个参数。</p>
<h3 id="nginx_navbar"><code>nginx_navbar</code></h3>
<p>参数名称： <code>nginx_navbar</code>， 类型： <code>index[]</code>， 层次：<code>G</code></p>
<p>Nginx 首页上的导航栏内容，默认值：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">nginx_navbar</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># nginx index page navigation links</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: CA Cert ,url: &#39;/ca.crt&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pigsty self-signed ca.crt&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Package ,url: &#39;/pigsty&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;local yum repo packages&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: PG Logs ,url: &#39;/logs&#39;     ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;postgres raw csv logs&#39;</span><span style="color:#f8f8f8;text-decoration:underline">       </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Reports ,url: &#39;/report&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pgbadger summary report&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Explain ,url: &#39;/pigsty/pev.html&#39; ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;postgres explain visualizer&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>每一条记录都会被渲染为一个导航链接，链接到 Pigsty 首页的 App 下拉菜单，所有的 App 都是可选的，默认挂载在 Pigsty 默认服务器下的 <code>http://pigsty/</code> 。</p>
<p><code>url</code> 参数指定了 App 的 URL PATH，但是如果 URL 中包含 <code>${grafana}</code> 字符串，它会被自动替换为 <a href="/zh/docs/reference/param/#infra_portal"><code>infra_portal</code></a> 中定义的 Grafana 域名。</p>
<p>所以您可以将一些使用 Grafana 的数据应用挂载到 Pigsty 的首页导航栏中。</p>
<hr>
<h2 id="dns"><code>DNS</code></h2>
<p>Pigsty 默认会在 Infra 节点上启用 DNSMASQ 服务，用于解析一些辅助域名，例如 <code>h.pigsty</code> <code>a.pigsty</code> <code>p.pigsty</code> <code>g.pigsty</code> 等等，以及可选 MinIO 的 <code>sss.pigsty</code>。</p>
<p>解析记录会记录在 Infra 节点的 <code>/etc/hosts.d/default</code> 文件中。 要使用这个 DNS 服务器，您必须将 <code>nameserver &lt;ip&gt;</code> 添加到 <code>/etc/resolv</code> 中，<a href="/zh/docs/reference/param/#node_dns_servers"><code>node_dns_servers</code></a> 参数可以解决这个问题。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">dns_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># setup dnsmasq on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">dns_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">53</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># dns server listen port, 53 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">dns_records</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># dynamic dns records resolved by dnsmasq</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} h.pigsty a.pigsty p.pigsty g.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} api.pigsty adm.pigsty cli.pigsty ddl.pigsty lab.pigsty git.pigsty sss.pigsty wiki.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="dns_enabled"><code>dns_enabled</code></h3>
<p>参数名称： <code>dns_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在这个 Infra 节点上启用 DNSMASQ 服务？默认值为： <code>true</code>。</p>
<p>如果你不想使用默认的 DNS 服务器，（比如你已经有了外部的DNS服务器，或者您的供应商不允许您使用 DNS 服务器）可以将此值设置为 <code>false</code> 来禁用它。
并使用 <a href="/zh/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a> 和 <a href="/zh/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a> 静态解析记录代替。</p>
<h3 id="dns_port"><code>dns_port</code></h3>
<p>参数名称： <code>dns_port</code>， 类型： <code>port</code>， 层次：<code>G</code></p>
<p>DNSMASQ 的默认监听端口，默认是 <code>53</code>，不建议修改 DNS 服务默认端口。</p>
<h3 id="dns_records"><code>dns_records</code></h3>
<p>参数名称： <code>dns_records</code>， 类型： <code>string[]</code>， 层次：<code>G</code></p>
<p>由 dnsmasq 负责解析的动态 DNS 记录，一般用于将一些辅助域名解析到本地，例如 <code>h.pigsty</code> <code>a.pigsty</code> <code>p.pigsty</code> <code>g.pigsty</code> 等等。这些记录会被写入到基础设置节点的 <code>/etc/hosts.d/default</code> 文件中。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">dns_records</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># dynamic dns records resolved by dnsmasq</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} h.pigsty a.pigsty p.pigsty g.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} api.pigsty adm.pigsty cli.pigsty ddl.pigsty lab.pigsty git.pigsty sss.pigsty wiki.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><hr>
<h2 id="prometheus"><code>PROMETHEUS</code></h2>
<p>Prometheus 被用作时序数据库，用于存储和分析监控指标数据，进行指标预计算，评估告警规则。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">prometheus_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># enable prometheus on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># clean prometheus data during init?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/etc/prometheus/targets</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus data dir, `/etc/prometheus/targets` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">5s       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus target refresh interval, 5s by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_scrape_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10s  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus scrape &amp; eval interval, 10s by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_scrape_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">8s    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus global scrape timeout, 8s by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--storage.tsdb.retention.time=15d&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus extra server options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pushgateway_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># setup pushgateway on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pushgateway_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--persistence.interval=1m&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pushgateway extra server options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">blackbox_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># setup blackbox_exporter on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">blackbox_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># blackbox_exporter extra server options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">alertmanager_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># setup alertmanager on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">alertmanager_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># alertmanager extra server options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_metrics_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/metrics  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># exporter metric path, `/metrics` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_install</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># how to install exporter? none,yum,binary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_repo_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># exporter repo file url if install exporter via yum</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="prometheus_enabled"><code>prometheus_enabled</code></h3>
<p>参数名称： <code>prometheus_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在当前 Infra 节点上启用 Prometheus？ 默认值为 <code>true</code>，即所有基础设施节点默认都会安装启用 Prometheus。</p>
<p>例如，如果您有多个元节点，默认情况下，Pigsty会在所有元节点上部署Prometheus。如果您想一台用于Prometheus监控指标收集，一台用于Loki日志收集，则可以在其他元节点的实例层次上将此参数设置为<code>false</code>。</p>
<h3 id="prometheus_clean"><code>prometheus_clean</code></h3>
<p>参数名称： <code>prometheus_clean</code>， 类型： <code>bool</code>， 层次：<code>G/A</code></p>
<p>是否在执行 Prometheus 初始化的时候清除现有 Prometheus 数据？默认值为 <code>true</code>。</p>
<h3 id="prometheus_data"><code>prometheus_data</code></h3>
<p>参数名称： <code>prometheus_data</code>， 类型： <code>path</code>， 层次：<code>G</code></p>
<p>Prometheus数据库目录, 默认位置为 <code>/data/prometheus</code>。</p>
<h3 id="prometheus_sd_dir"><code>prometheus_sd_dir</code></h3>
<p>参数名称： <code>prometheus_sd_dir</code>， 类型： <code>path</code>， 层次：<code>G</code></p>
<p>Prometheus 静态文件服务发现的对象存储目录，默认值为 <code>/etc/prometheus/targets</code>。</p>
<h3 id="prometheus_sd_interval"><code>prometheus_sd_interval</code></h3>
<p>参数名称： <code>prometheus_sd_interval</code>， 类型： <code>interval</code>， 层次：<code>G</code></p>
<p>Prometheus 静态文件服务发现的刷新周期，默认值为 <code>5s</code>。</p>
<p>这意味着 Prometheus 每隔这样长的时间就会重新扫描一次 <a href="/zh/docs/reference/param/#prometheus_sd_dir"><code>prometheus_sd_dir</code></a> （默认为：<code>/etc/prometheus/targets</code> 目录），以发现新的监控对象。</p>
<h3 id="prometheus_scrape_interval"><code>prometheus_scrape_interval</code></h3>
<p>参数名称： <code>prometheus_scrape_interval</code>， 类型： <code>interval</code>， 层次：<code>G</code></p>
<p>Prometheus 全局指标抓取周期, 默认值为 <code>10s</code>。在生产环境，10秒 - 30秒是一个较为合适的抓取周期。如果您需要更精细的的监控数据粒度，则可以调整此参数。</p>
<h3 id="prometheus_scrape_timeout"><code>prometheus_scrape_timeout</code></h3>
<p>参数名称： <code>prometheus_scrape_timeout</code>， 类型： <code>interval</code>， 层次：<code>G</code></p>
<p>Prometheus 全局抓取超时，默认为 <code>8s</code>。</p>
<p>设置抓取超时可以有效避免监控系统查询导致的雪崩，设置原则是，本参数必须小于并接近 <a href="/zh/docs/reference/param/#prometheus_scrape_interval"><code>prometheus_scrape_interval</code></a> ，确保每次抓取时长不超过抓取周期。</p>
<h3 id="prometheus_options"><code>prometheus_options</code></h3>
<p>参数名称： <code>prometheus_options</code>， 类型： <code>arg</code>， 层次：<code>G</code></p>
<p>Prometheus 的额外的命令行参数，默认值：<code>--storage.tsdb.retention.time=15d</code></p>
<p>默认的参数会为 Prometheus 配置一个 15 天的保留期限来限制磁盘使用量。</p>
<h3 id="pushgateway_enabled"><code>pushgateway_enabled</code></h3>
<p>参数名称： <code>pushgateway_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在当前 Infra 节点上启用 PushGateway？ 默认值为 <code>true</code>，即所有基础设施节点默认都会安装启用 PushGateway。</p>
<h3 id="pushgateway_options"><code>pushgateway_options</code></h3>
<p>参数名称： <code>pushgateway_options</code>， 类型： <code>arg</code>， 层次：<code>G</code></p>
<p>PushGateway 的额外的命令行参数，默认值：<code>--persistence.interval=1m</code>，即每分钟进行一次持久化操作。</p>
<h3 id="blackbox_enabled"><code>blackbox_enabled</code></h3>
<p>参数名称： <code>blackbox_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在当前 Infra 节点上启用 BlackboxExporter ？ 默认值为 <code>true</code>，即所有基础设施节点默认都会安装启用 BlackboxExporter 。</p>
<p>BlackboxExporter 会向节点 IP 地址， VIP 地址，PostgreSQL VIP 地址发送 ICMP 报文测试网络连通性。</p>
<h3 id="blackbox_options"><code>blackbox_options</code></h3>
<p>参数名称： <code>blackbox_options</code>， 类型： <code>arg</code>， 层次：<code>G</code></p>
<p>BlackboxExporter 的额外的命令行参数，默认值：空字符串。</p>
<h3 id="alertmanager_enabled"><code>alertmanager_enabled</code></h3>
<p>参数名称： <code>alertmanager_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在当前 Infra 节点上启用 AlertManager ？ 默认值为 <code>true</code>，即所有基础设施节点默认都会安装启用 AlertManager 。</p>
<h3 id="alertmanager_options"><code>alertmanager_options</code></h3>
<p>参数名称： <code>alertmanager_options</code>， 类型： <code>arg</code>， 层次：<code>G</code></p>
<p>AlertManager 的额外的命令行参数，默认值：空字符串。</p>
<h3 id="exporter_metrics_path"><code>exporter_metrics_path</code></h3>
<p>参数名称： <code>exporter_metrics_path</code>， 类型： <code>path</code>， 层次：<code>G</code></p>
<p>监控 exporter 暴露指标的 HTTP 端点路径，默认为： <code>/metrics</code> ，不建议修改此参数。</p>
<h3 id="exporter_install"><code>exporter_install</code></h3>
<p>参数名称： <code>exporter_install</code>， 类型： <code>enum</code>， 层次：<code>G</code></p>
<p>（弃用参数）安装监控组件的方式，有三种可行选项：<code>none</code>, <code>yum</code>, <code>binary</code></p>
<p>指明安装Exporter的方式：</p>
<ul>
<li><code>none</code>：不安装，（默认行为，Exporter已经在先前由 <a href="/zh/docs/node#nodeyml"><code>node_pkg</code></a> 任务完成安装）</li>
<li><code>yum</code>：使用yum（apt）安装（如果启用yum安装，在部署Exporter前执行yum安装 <a href="/zh/docs/reference/param/#node_exporter"><code>node_exporter</code></a> 与 <a href="/zh/docs/reference/param/#pg_exporter"><code>pg_exporter</code></a> ）</li>
<li><code>binary</code>：使用拷贝二进制的方式安装（从元节点中直接拷贝<a href="/zh/docs/reference/param/#node_exporter"><code>node_exporter</code></a> 与 <a href="/zh/docs/reference/param/#pg_exporter"><code>pg_exporter</code></a> 二进制，不推荐）</li>
</ul>
<p>使用<code>yum</code>安装时，如果指定了<code>exporter_repo_url</code>（不为空），在执行安装时会首先将该URL下的REPO文件安装至<code>/etc/yum.repos.d</code>中。这一功能可以在不执行节点基础设施初始化的环境下直接进行Exporter的安装。
不推荐普通用户使用<code>binary</code>安装，这种模式通常用于紧急故障抢修与临时问题修复。</p>
<h3 id="exporter_repo_url"><code>exporter_repo_url</code></h3>
<p>参数名称： <code>exporter_repo_url</code>， 类型： <code>url</code>， 层次：<code>G</code></p>
<p>（弃用参数）监控组件的 Yum Repo URL</p>
<p>默认为空，当 <a href="/zh/docs/reference/param/#exporter_install"><code>exporter_install</code></a> 为 <code>yum</code> 时，该参数指定的Repo会被添加至节点源列表中。</p>
<hr>
<h2 id="grafana"><code>GRAFANA</code></h2>
<p>Pigsty 使用 Grafana 作为监控系统前端。它也可以做为数据分析与可视化平台，或者用于低代码数据应用开发，制作数据应用原型等目的。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">grafana_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># enable grafana on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">grafana_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># clean grafana data during init?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">grafana_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">admin    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># grafana admin username, `admin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">grafana_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># grafana admin password, `pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">grafana_plugin_cache</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/www/pigsty/plugins.tgz</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># path to grafana plugins cache tarball</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">grafana_plugin_list</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># grafana plugins to be downloaded with grafana-cli</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-echarts-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-image-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-form-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-variable-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-grapi-datasource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-static-datasource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-json-datasource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-dynamictext-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-treemap-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-calendar-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-hourly-heatmap-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">knightss27-weathermap-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loki_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># enable loki on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loki_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># whether remove existing loki data?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loki_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/loki            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># loki data dir, `/data/loki` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loki_retention</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">15d              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># loki log retention period, 15d by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="grafana_enabled"><code>grafana_enabled</code></h3>
<p>参数名称： <code>grafana_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在Infra节点上启用Grafana？默认值为： <code>true</code>，即所有基础设施节点默认都会安装启用 Grafana。</p>
<h3 id="grafana_clean"><code>grafana_clean</code></h3>
<p>参数名称： <code>grafana_clean</code>， 类型： <code>bool</code>， 层次：<code>G/A</code></p>
<p>是否在初始化 Grafana 时一并清理其数据文件？默认为：<code>true</code>。</p>
<p>该操作会移除 <code>/var/lib/grafana/grafana.db</code>，确保 Grafana 全新安装。</p>
<h3 id="grafana_admin_username"><code>grafana_admin_username</code></h3>
<p>参数名称： <code>grafana_admin_username</code>， 类型： <code>username</code>， 层次：<code>G</code></p>
<p>Grafana管理员用户名，<code>admin</code> by default</p>
<h3 id="grafana_admin_password"><code>grafana_admin_password</code></h3>
<p>参数名称： <code>grafana_admin_password</code>， 类型： <code>password</code>， 层次：<code>G</code></p>
<p>Grafana管理员密码，<code>pigsty</code> by default</p>
<blockquote>
<p>提示：请务必在生产部署中修改此密码参数！</p>
</blockquote>
<h3 id="grafana_plugin_cache"><code>grafana_plugin_cache</code></h3>
<p>参数名称： <code>grafana_plugin_cache</code>， 类型： <code>path</code>， 层次：<code>G</code></p>
<p>Grafana 插件缓存地址，一个指向 Tarball 的路径，默认值为：<code>/www/pigsty/plugins.tgz</code></p>
<p>如果该文件存在，Pigsty会直接将其解压至：<code>/var/lib/grafana/plugins</code> 中并跳过从互联网下载 Grafana 插件的步骤。</p>
<h3 id="grafana_plugin_list"><code>grafana_plugin_list</code></h3>
<p>参数名称： <code>grafana_plugin_list</code>， 类型： <code>string[]</code>， 层次：<code>G</code></p>
<p>列表中的 Grafana 插件将会被下载，默认包含了来自 volkovlabs 与 marusolsson 的几个实用扩展。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">grafana_plugin_list</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># grafana plugins to be downloaded with grafana-cli</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-echarts-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-image-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-form-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-variable-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">volkovlabs-grapi-datasource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-static-datasource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-json-datasource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-dynamictext-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-treemap-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-calendar-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">marcusolsson-hourly-heatmap-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">knightss27-weathermap-panel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>每个数组元素是一个字符串，表示插件的名称。插件会通过<code>grafana-cli plugins install</code>的方式进行安装。</p>
<hr>
<h2 id="loki"><code>LOKI</code></h2>
<p>Loki 是Grafana提供的轻量级日志收集/检索平台，它可以提供一个集中查询服务器/数据库日志的地方。</p>
<h3 id="loki_enabled"><code>loki_enabled</code></h3>
<p>参数名称： <code>loki_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/I</code></p>
<p>是否在当前 Infra 节点上启用 Loki ？ 默认值为 <code>true</code>，即所有基础设施节点默认都会安装启用 Loki 。</p>
<h3 id="loki_clean"><code>loki_clean</code></h3>
<p>参数名称： <code>loki_clean</code>， 类型： <code>bool</code>， 层次：<code>G/A</code></p>
<p>是否在安装Loki时清理数据库目录？默认值： <code>false</code>，现有日志数据在初始化时会保留。</p>
<h3 id="loki_data"><code>loki_data</code></h3>
<p>参数名称： <code>loki_data</code>， 类型： <code>path</code>， 层次：<code>G</code></p>
<p>Loki的数据目录，默认值为： <code>/data/loki</code></p>
<h3 id="loki_retention"><code>loki_retention</code></h3>
<p>参数名称： <code>loki_retention</code>， 类型： <code>interval</code>， 层次：<code>G</code></p>
<p>Loki日志默认保留天数，默认保留 <code>15d</code> 。</p>
<hr>
<h1 id="node"><code>NODE</code></h1>
<p><a href="/zh/docs/node">NODE</a> 模块负责将主机节点调整到期待的目标状态，并将其纳入 Pigsty 的监控系统中。</p>
<hr>
<h2 id="node_id"><code>NODE_ID</code></h2>
<p>每个节点都有<strong>身份参数</strong>，通过在<code>&lt;cluster&gt;.hosts</code>与<code>&lt;cluster&gt;.vars</code>中的相关参数进行配置。</p>
<p>Pigsty使用<strong>IP地址</strong>作为<strong>数据库节点</strong>的唯一标识，<strong>该IP地址必须是数据库实例监听并对外提供服务的IP地址</strong>，但不宜使用公网IP地址。
尽管如此，用户并不一定非要通过该IP地址连接至该数据库。例如，通过SSH隧道或跳板机中转的方式间接操作管理目标节点也是可行的。
但在标识数据库节点时，首要IPv4地址依然是节点的核心标识符。<strong>这一点非常重要，用户应当在配置时保证这一点</strong>。
IP地址即配置清单中主机的<code>inventory_hostname</code> ，体现为<code>&lt;cluster&gt;.hosts</code>对象中的<code>key</code>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node-test</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">nodename</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node-test-1 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">nodename</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node-test-2 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">nodename</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node-test-3 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">node_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node-test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>除此之外，在Pigsty监控系统中，节点还有两个重要的身份参数：<a href="/zh/docs/reference/param/#nodename"><code>nodename</code></a> 与 <a href="/zh/docs/reference/param/#node_cluster"><code>node_cluster</code></a>，这两者将在监控系统中被用作节点的 <strong>实例标识</strong>（<code>ins</code>） 与 <strong>集群标识</strong> （<code>cls</code>）。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">node_load1{cls=&#34;pg-meta&#34;, ins=&#34;pg-meta-1&#34;, ip=&#34;10.10.10.10&#34;, job=&#34;nodes&#34;}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">node_load1{cls=&#34;pg-test&#34;, ins=&#34;pg-test-1&#34;, ip=&#34;10.10.10.11&#34;, job=&#34;nodes&#34;}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">node_load1{cls=&#34;pg-test&#34;, ins=&#34;pg-test-2&#34;, ip=&#34;10.10.10.12&#34;, job=&#34;nodes&#34;}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">node_load1{cls=&#34;pg-test&#34;, ins=&#34;pg-test-3&#34;, ip=&#34;10.10.10.13&#34;, job=&#34;nodes&#34;}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>在执行默认的PostgreSQL部署时，因为Pigsty默认采用节点独占1:1部署，因此可以通过 <a href="/zh/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a> 参数，将数据库实例的身份参数（ <a href="/zh/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a> 借用至节点的<code>ins</code>与<code>cls</code>标签上。</p>
<table>
<thead>
<tr>
<th style="text-align:center">名称</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">层级</th>
<th>必要性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>inventory_hostname</code></td>
<td style="text-align:center"><code>ip</code></td>
<td style="text-align:center"><strong>-</strong></td>
<td><strong>必选</strong></td>
<td><strong>节点IP地址</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/zh/docs/reference/param/#nodename"><code>nodename</code></a></td>
<td style="text-align:center"><code>string</code></td>
<td style="text-align:center"><strong>I</strong></td>
<td>可选</td>
<td><strong>节点名称</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/zh/docs/reference/param/#node_cluster"><code>node_cluster</code></a></td>
<td style="text-align:center"><code>string</code></td>
<td style="text-align:center"><strong>C</strong></td>
<td>可选</td>
<td><strong>节点集群名称</strong></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#nodename:                # [实例] # 节点实例标识，如缺失则使用现有主机名，可选，无默认值</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nodes       # [集群]</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 节点集群标识，如缺失则使用默认值&#39;nodes&#39;，可选</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nodename_overwrite</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># 用 nodename 覆盖节点的主机名吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nodename_exchange</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># 在剧本主机之间交换 nodename 吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_id_from_pg</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># 如果可行，是否借用 postgres 身份作为节点身份？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="nodename"><code>nodename</code></h3>
<p>参数名称： <code>nodename</code>， 类型： <code>string</code>， 层次：<code>I</code></p>
<p>主机节点的身份参数，如果没有显式设置，则会使用现有的主机 Hostname 作为节点名。本参数虽然是身份参数，但因为有合理默认值，所以是可选项。</p>
<p>如果启用了 <a href="/zh/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a> 选项（默认启用），且 <code>nodename</code> 没有被显式指定，
那么 <a href="/zh/docs/reference/param/#nodename"><code>nodename</code></a> 会尝试使用 <code>${pg_cluster}-${pg_seq}</code> 作为实例身份参数，如果集群没有定义 PGSQL 模块，那么会回归到默认值，也就是主机节点的 HOSTNAME。</p>
<h3 id="node_cluster"><code>node_cluster</code></h3>
<p>参数名称： <code>node_cluster</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>该选项可为节点显式指定一个集群名称，通常在节点集群层次定义才有意义。使用默认空值将直接使用固定值<code>nodes</code>作为节点集群标识。</p>
<p>如果启用了 <a href="/zh/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a> 选项（默认启用），且 <code>node_cluster</code> 没有被显式指定，那么 <a href="/zh/docs/reference/param/#node_cluster"><code>node_cluster</code></a> 会尝试使用 <code>${pg_cluster}-${pg_seq}</code> 作为集群身份参数，如果集群没有定义 PGSQL 模块，那么会回归到默认值 <code>nodes</code>。</p>
<h3 id="nodename_overwrite"><code>nodename_overwrite</code></h3>
<p>参数名称： <code>nodename_overwrite</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否使用 <a href="/zh/docs/reference/param/#nodename"><code>nodename</code></a> 覆盖主机名？默认值为 <code>true</code>，在这种情况下，如果你设置了一个非空的 <a href="/zh/docs/reference/param/#nodename"><code>nodename</code></a> ，那么它会被用作当前主机的 HOSTNAME 。</p>
<p>当 <code>nodename</code> 配置为空时，如果  <a href="/zh/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a> 参数被配置为 <code>true</code> （默认为真），那么 Pigsty 会尝试借用1:1定义在节点上的 PostgreSQL 实例的身份参数作为主机的节点名。
也就是 <code>{{ pg_cluster }}-{{ pg_seq }}</code>，如果该节点没有安装 PGSQL 模块，则会回归到默认什么都不做的状态。</p>
<p>因此，如果您将 <a href="/zh/docs/reference/param/#nodename"><code>nodename</code></a> 留空，并且没有启用 <a href="/zh/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a> 参数时，Pigsty不会对现有主机名进行任何修改。</p>
<h3 id="nodename_exchange"><code>nodename_exchange</code></h3>
<p>参数名称： <code>nodename_exchange</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否在剧本节点间交换主机名？默认值为：<code>false</code></p>
<p>启用此参数时，同一批组执行 <a href="/zh/docs/node#nodeyml"><code>node.yml</code></a> 剧本的节点之间会相互交换节点名称，写入<code>/etc/hosts</code>中。</p>
<h3 id="node_id_from_pg"><code>node_id_from_pg</code></h3>
<p>参数名称： <code>node_id_from_pg</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>从节点上 1:1 部署的 PostgreSQL 实例/集群上借用身份参数？ 默认值为 <code>true</code>。</p>
<p>Pigsty 中的 PostgreSQL 实例与节点默认使用 1:1 部署，因此，您可以从数据库实例上“借用” 身份参数。
此参数默认启用，这意味着一套 PostgreSQL 集群如果没有特殊配置，主机节点集群和实例的身份参数默认值是与数据库身份参数保持一致的。对于问题分析，监控数据处理都提供了额外便利。</p>
<hr>
<h2 id="node_dns"><code>NODE_DNS</code></h2>
<p>Pigsty会为节点配置静态DNS解析记录与动态DNS服务器。</p>
<p>如果您的节点供应商已经为您配置了DNS服务器，您可以将 <a href="/zh/docs/reference/param/#node_dns_method"><code>node_dns_method</code></a> 设置为 <code>none</code> 跳过DNS设置。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_write_etc_hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># modify `/etc/hosts` on target node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_default_etc_hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># static dns records in `/etc/hosts`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} h.pigsty a.pigsty p.pigsty g.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_etc_hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># extra static dns records in `/etc/hosts`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_dns_method: add              # how to handle dns servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">add,none,overwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_dns_servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;${admin_ip}&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dynamic nameserver in `/etc/resolv.conf`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_dns_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># dns resolv options in `/etc/resolv.conf`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">options single-request-reopen timeout:1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_write_etc_hosts">node_write_etc_hosts</h3>
<p>参数名称： <code>node_write_etc_hosts</code>， 类型： <code>bool</code>， 层次：<code>G|C|I</code></p>
<p>是否修改目标节点上的 <code>/etc/hosts</code>？例如，在容器环境中通常不允许修改此配置文件。</p>
<h3 id="node_default_etc_hosts"><code>node_default_etc_hosts</code></h3>
<p>参数名称： <code>node_default_etc_hosts</code>， 类型： <code>string[]</code>， 层次：<code>G</code></p>
<p>默认写入所有节点 <code>/etc/hosts</code> 的静态DNS记录，默认值为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;${admin_ip} h.pigsty a.pigsty p.pigsty g.pigsty&#34;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><a href="/zh/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a> 是一个数组，每个元素都是一条 DNS 记录，格式为 <code>&lt;ip&gt; &lt;name&gt;</code>，您可以指定多个用空格分隔的域名。</p>
<p>这个参数是用于配置全局静态DNS解析记录的，如果您希望为单个集群与实例配置特定的静态DNS解析，则可以使用 <a href="/zh/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a> 参数。</p>
<h3 id="node_etc_hosts"><code>node_etc_hosts</code></h3>
<p>参数名称： <code>node_etc_hosts</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>写入节点 <code>/etc/hosts</code> 的额外的静态DNS记录，默认值为：<code>[]</code> 空数组。</p>
<p>本参数与 <a href="/zh/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a>，形式一样，但用途不同：适合在集群/实例层面进行配置。</p>
<h3 id="node_dns_method"><code>node_dns_method</code></h3>
<p>参数名称： <code>node_dns_method</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>如何配置DNS服务器？有三种选项：<code>add</code>、<code>none</code>、<code>overwrite</code>，默认值为 <code>add</code>。</p>
<ul>
<li><code>add</code>：将 <a href="/zh/docs/reference/param/#node_dns_servers"><code>node_dns_servers</code></a> 中的记录<strong>追加</strong>至<code>/etc/resolv.conf</code>，并保留已有DNS服务器。（默认）</li>
<li><code>overwrite</code>：使用将 <a href="/zh/docs/reference/param/#node_dns_servers"><code>node_dns_servers</code></a> 中的记录覆盖<code>/etc/resolv.conf</code></li>
<li><code>none</code>：跳过DNS服务器配置，如果您的环境中已经配置有DNS服务器，则可以直接跳过DNS配置。</li>
</ul>
<h3 id="node_dns_servers"><code>node_dns_servers</code></h3>
<p>参数名称： <code>node_dns_servers</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>配置 <code>/etc/resolv.conf</code> 中的动态DNS服务器列表：默认值为： <code>[&quot;${admin_ip}&quot;]</code>，即将管理节点作为首要DNS服务器。</p>
<h3 id="node_dns_options"><code>node_dns_options</code></h3>
<p>参数名称： <code>node_dns_options</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p><code>/etc/resolv.conf</code> 中的DNS解析选项，默认值为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#4e9a06">&#34;options single-request-reopen timeout:1&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>如果 <a href="/zh/docs/reference/param/#node_dns_method"><code>node_dns_method</code></a> 配置为<code>add</code>或<code>overwrite</code>，则本配置项中的记录会被首先写入<code>/etc/resolv.conf</code> 中。具体格式请参考Linux文档关于<code>/etc/resolv.conf</code>的说明</p>
<hr>
<h2 id="node_package"><code>NODE_PACKAGE</code></h2>
<p>Pigsty会为纳入管理的节点配置Yum源，并安装软件包。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_repo_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># upstream repo to be added on node, local by default.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_repo_remove</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># remove existing repo on node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># packages to be installed current nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#node_default_packages:           # default packages to be installed on all nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_repo_modules"><code>node_repo_modules</code></h3>
<p>参数名称： <code>node_repo_modules</code>， 类型： <code>string</code>， 层次：<code>C/A</code></p>
<p>需要在节点上添加的的软件源模块列表，形式同 <a href="/zh/docs/reference/param/#repo_modules"><code>repo_modules</code></a>。默认值为 <code>local</code>，即使用 <a href="/zh/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> 中 <code>local</code> 所指定的本地软件源。</p>
<p>当 Pigsty 纳管节点时，会根据此参数的值来过滤 <a href="/zh/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> 中的条目，只有 <code>module</code> 字段与此参数值匹配的条目才会被添加到节点的软件源中。</p>
<h3 id="node_repo_remove"><code>node_repo_remove</code></h3>
<p>参数名称： <code>node_repo_remove</code>， 类型： <code>bool</code>， 层次：<code>C/A</code></p>
<p>是否移除节点已有的软件仓库定义？默认值为：<code>true</code>。</p>
<p>如果启用，则Pigsty会 <strong>移除</strong> 节点上<code>/etc/yum.repos.d</code>中原有的配置文件，并备份至<code>/etc/yum.repos.d/backup</code>。
在 Debian/Ubuntu 系统上，则是 <code>/etc/apt/sources.list(.d)</code> 备份至 <code>/etc/apt/backup</code>。</p>
<h3 id="node_packages"><code>node_packages</code></h3>
<p>参数名称： <code>node_packages</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>在当前节点上要安装并升级的软件包列表，默认值为：<code>[openssh-server]</code> ，即在安装时会将 sshd 升级到最新版本（避免安全漏洞）。</p>
<p>每一个数组元素都是字符串：由逗号分隔的软件包名称。形式上与 <a href="/zh/docs/reference/param/#node_default_packages"><code>node_packages_default</code></a> 相同。本参数通常用于在节点/集群层面指定需要额外安装的软件包。</p>
<p>在本参数中指定的软件包，会 <strong>升级到可用的最新版本</strong>，如果您需要保持现有节点软件版本不变（存在即可），请使用 <a href="/zh/docs/reference/param/#node_default_packages"><code>node_default_packages</code></a> 参数。</p>
<h3 id="node_default_packages"><code>node_default_packages</code></h3>
<p>参数名称： <code>node_default_packages</code>， 类型： <code>string[]</code>， 层次：<code>G</code></p>
<p>默认在所有节点上安装的软件包，默认值是 EL 7/8/9 通用的 RPM 软件包列表，数组，每个元素为逗号分隔的包名：</p>
<p>字符串数组类型，每一行都是 <strong>由空格分隔</strong> 的软件包列表字符串，指定默认在所有节点上安装的软件包列表。</p>
<p>在此变量中指定的软件包，只要求 <strong>存在</strong>，而不要求 <strong>最新</strong>。如果您需要安装最新版本的软件包，请使用 <a href="/zh/docs/reference/param/#node_packages"><code>node_packages</code></a> 参数。</p>
<p>本参数没有默认值，即默认值为未定义状态。如果用户不在配置文件中显式指定本参数，则 Pigsty 会从根据当前节点的操作系统族，从定义于 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> 中的 <code>node_packages_default</code> 变量中加载获取默认值。</p>
<p>默认值（EL系操作系统）：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">lz4,unzip,bzip2,pv,jq,git,ncdu,make,patch,bash,lsof,wget,uuid,tuned,nvme-cli,numactl,sysstat,iotop,htop,rsync,tcpdump</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">python3,python3-pip,socat,lrzsz,net-tools,ipvsadm,telnet,ca-certificates,openssl,keepalived,etcd,haproxy,chrony</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">zlib,yum,audit,bind-utils,readline,vim-minimal,node_exporter,grubby,openssh-server,openssh-clients</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>默认值（Debian/Ubuntu）：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">lz4,unzip,bzip2,pv,jq,git,ncdu,make,patch,bash,lsof,wget,uuid,tuned,nvme-cli,numactl,sysstat,iotop,htop,rsync,tcpdump</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">python3,python3-pip,socat,lrzsz,net-tools,ipvsadm,telnet,ca-certificates,openssl,keepalived,etcd,haproxy,chrony</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">zlib1g,acl,dnsutils,libreadline-dev,vim-tiny,node-exporter,openssh-server,openssh-client</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>本参数形式上与 <a href="/zh/docs/reference/param/#node_packages"><code>node_packages</code></a> 相同，但本参数通常用于全局层面指定所有节点都必须安装的默认软件包</p>
<hr>
<h2 id="node_tune"><code>NODE_TUNE</code></h2>
<p>主机节点特性、内核模块与参数调优模板。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_disable_firewall</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># disable node firewall? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_disable_selinux</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># disable node selinux? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_disable_numa</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># disable node numa, reboot required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_disable_swap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># disable node swap, use with caution</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_static_network</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># preserve dns resolver settings after reboot</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_disk_prefetch</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># setup disk prefetch on HDD to increase performance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_kernel_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">softdog, br_netfilter, ip_vs, ip_vs_rr, ip_vs_wrr, ip_vs_sh ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_hugepage_count</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># number of 2MB hugepage, take precedence over ratio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_hugepage_ratio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># node mem hugepage ratio, 0 disable it by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_overcommit_ratio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># node mem overcommit ratio, 0 disable it by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_tune: oltp                   # node tuned profile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none,oltp,olap,crit,tiny</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_sysctl_params</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># sysctl parameters in k:v format in addition to tuned</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_disable_firewall"><code>node_disable_firewall</code></h3>
<p>参数名称： <code>node_disable_firewall</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>关闭节点防火墙？默认关闭防火墙：<code>true</code>。</p>
<p>如果您在受信任的内网部署，可以关闭防火墙。在 EL 下是 <code>firewalld</code> 服务，在 Ubuntu下是 <code>ufw</code> 服务。</p>
<h3 id="node_disable_selinux"><code>node_disable_selinux</code></h3>
<p>参数名称： <code>node_disable_selinux</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>关闭节点SELINUX？默认关闭SELinux：<code>true</code>。</p>
<p>如果您没有操作系统/安全专家，请关闭 SELinux。</p>
<p>当使用 Kubernetes 模块时，请关闭 SELinux。</p>
<h3 id="node_disable_numa"><code>node_disable_numa</code></h3>
<p>参数名称： <code>node_disable_numa</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否关闭NUMA？默认不关闭NUMA：<code>false</code>。</p>
<p>注意，关闭NUMA需要重启机器后方可生效！如果您不清楚如何绑核，在生产环境使用数据库时建议关闭 NUMA。</p>
<h3 id="node_disable_swap"><code>node_disable_swap</code></h3>
<p>参数名称： <code>node_disable_swap</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否关闭 SWAP ？ 默认不关闭SWAP：<code>false</code>。</p>
<p>通常情况下不建议关闭 SWAP，例外情况是如果您有足够的内存用于独占式 PostgreSQL 部署，则可以关闭 SWAP 提高性能。</p>
<p>例外：当您的节点用于部署 Kubernetes 模块时，应当禁用SWAP。</p>
<h3 id="node_static_network"><code>node_static_network</code></h3>
<p>参数名称： <code>node_static_network</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否使用静态DNS服务器, 类型：<code>bool</code>，层级：C，默认值为：<code>true</code>，默认启用。</p>
<p>启用静态网络，意味着您的DNS Resolv配置不会因为机器重启与网卡变动被覆盖，建议启用，或由网络工程师负责配置。</p>
<h3 id="node_disk_prefetch"><code>node_disk_prefetch</code></h3>
<p>参数名称： <code>node_disk_prefetch</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否启用磁盘预读？默认不启用：<code>false</code>。</p>
<p>针对HDD部署的实例可以优化性能，使用机械硬盘时建议启用。</p>
<h3 id="node_kernel_modules"><code>node_kernel_modules</code></h3>
<p>参数名称： <code>node_kernel_modules</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>启用哪些内核模块？默认启用以下内核模块：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_kernel_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">softdog, br_netfilter, ip_vs, ip_vs_rr, ip_vs_wrr, ip_vs_sh ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>形式上是由内核模块名称组成的数组，声明了需要在节点上安装的内核模块。</p>
<h3 id="node_hugepage_count"><code>node_hugepage_count</code></h3>
<p>参数名称： <code>node_hugepage_count</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>在节点上分配 2MB 大页的数量，默认为 <code>0</code>，另一个相关的参数是 <a href="/zh/docs/reference/param/#node_hugepage_ratio"><code>node_hugepage_ratio</code></a>。</p>
<p>如果这两个参数 <code>node_hugepage_count</code> 和 <code>node_hugepage_ratio</code> 都为 <code>0</code>（默认），则大页将完全被禁用，本参数的优先级相比 <a href="/zh/docs/reference/param/#node_hugepage_ratio"><code>node_hugepage_ratio</code></a> 更高，因为它更加精确。</p>
<p>如果设定了一个非零值，它将被写入 <code>/etc/sysctl.d/hugepage.conf</code> 中应用生效；负值将不起作用，高于 90% 节点内存的数字将被限制为节点内存的 90%</p>
<p>如果不为零，它应该略大于<a href="/zh/docs/reference/param/#pg_shared_buffer_ratio"><code>pg_shared_buffer_ratio</code></a> 的对应值，这样才能让 PostgreSQL 用上大页。</p>
<h3 id="node_hugepage_ratio"><code>node_hugepage_ratio</code></h3>
<p>参数名称： <code>node_hugepage_ratio</code>， 类型： <code>float</code>， 层次：<code>C</code></p>
<p>节点内存大页占内存的比例，默认为 <code>0</code>，有效范围：<code>0</code> ~ <code>0.40</code></p>
<p>此内存比例将以大页的形式分配，并为PostgreSQL预留。 <a href="/zh/docs/reference/param/#node_hugepage_count"><code>node_hugepage_count</code></a> 是具有更高优先级和精度的参数版本。</p>
<p>默认值：<code>0</code>，这将设置 <code>vm.nr_hugepages=0</code> 并完全不使用大页。</p>
<p>本参数应该等于或略大于<a href="/zh/docs/reference/param/#pg_shared_buffer_ratio"><code>pg_shared_buffer_ratio</code></a>，如果不为零。</p>
<p>例如，如果您为Postgres共享缓冲区默认分配了25%的内存，您可以将此值设置为 0.27 ~ 0.30，并在初始化后使用 <code>/pg/bin/pg-tune-hugepage</code> 精准回收浪费的大页。</p>
<h3 id="node_overcommit_ratio"><code>node_overcommit_ratio</code></h3>
<p>参数名称： <code>node_overcommit_ratio</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>节点内存超额分配比率，默认为：<code>0</code>。这是一个从 <code>0</code> 到 <code>100+</code> 的整数。</p>
<p>默认值：<code>0</code>，这将设置 <code>vm.overcommit_memory=0</code>，否则将使用 <code>vm.overcommit_memory=2</code>， 并使用此值作为 <code>vm.overcommit_ratio</code>。</p>
<p>建议在 pgsql 独占节点上设置 <code>vm.overcommit_ratio</code>，避免内存过度提交。</p>
<h3 id="node_tune-1"><code>node_tune</code></h3>
<p>参数名称： <code>node_tune</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>针对机器进行调优的预制方案，基于<code>tuned</code> 提供服务。有四种预制模式：</p>
<ul>
<li><code>tiny</code>：微型虚拟机</li>
<li><code>oltp</code>：常规OLTP模板，优化延迟（默认值）</li>
<li><code>olap</code>：常规OLAP模板，优化吞吐量</li>
<li><code>crit</code>：核心金融业务模板，优化脏页数量</li>
</ul>
<p>通常，数据库的调优模板 <a href="/zh/docs/reference/param#pg_conf"><code>pg_conf</code></a>应当与机器调优模板配套。</p>
<h3 id="node_sysctl_params"><code>node_sysctl_params</code></h3>
<p>参数名称： <code>node_sysctl_params</code>， 类型： <code>dict</code>， 层次：<code>C</code></p>
<p>使用 K:V 形式的 sysctl 内核参数，会添加到 <code>tuned</code> profile 中，默认值为： <code>{}</code> 空对象。</p>
<p>这是一个 KV 结构的字典参数，Key 是内核 <code>sysctl</code> 参数名，Value 是参数值。你也可以考虑直接在 <code>roles/node/templates</code> 中的 tuned 模板中直接定义额外的 sysctl 参数。</p>
<hr>
<h2 id="node_admin"><code>NODE_ADMIN</code></h2>
<p>这一节关于主机节点上的管理员，谁能登陆，怎么登陆。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># node main data directory, `/data` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># create a admin user on target node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_uid</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">88</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># uid and gid for node admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dba         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># name of node admin user, `dba` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_ssh_exchange</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#8f5902;font-style:italic"># exchange admin ssh key among node cluster</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_pk_current</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># add current user&#39;s ssh pk to admin authorized_keys</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_pk_list</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># ssh public keys to be added to admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_data"><code>node_data</code></h3>
<p>参数名称： <code>node_data</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>节点的主数据目录，默认为 <code>/data</code>。</p>
<p>如果该目录不存在，则该目录会被创建。该目录应当由 <code>root</code> 拥有，并拥有 <code>777</code> 权限。</p>
<h3 id="node_admin_enabled"><code>node_admin_enabled</code></h3>
<p>参数名称： <code>node_admin_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否在本节点上创建一个专用管理员用户？默认值为：<code>true</code>。</p>
<p>Pigsty默认会在每个节点上创建一个管理员用户（拥有免密sudo与ssh权限），默认的管理员名为<code>dba (uid=88)</code>的管理用户，可以从元节点上通过SSH免密访问环境中的其他节点并执行免密sudo。</p>
<h3 id="node_admin_uid"><code>node_admin_uid</code></h3>
<p>参数名称： <code>node_admin_uid</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>管理员用户UID，默认值为：<code>88</code>。</p>
<p>请尽可能确保 UID 在所有节点上都相同，可以避免一些无谓的权限问题。</p>
<p>如果默认 UID 88 已经被占用，您可以选择一个其他 UID ，手工分配时请注意UID命名空间冲突。</p>
<h3 id="node_admin_username"><code>node_admin_username</code></h3>
<p>参数名称： <code>node_admin_username</code>， 类型： <code>username</code>， 层次：<code>C</code></p>
<p>管理员用户名，默认为 <code>dba</code> 。</p>
<h3 id="node_admin_ssh_exchange"><code>node_admin_ssh_exchange</code></h3>
<p>参数名称： <code>node_admin_ssh_exchange</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>在节点集群间交换节点管理员SSH密钥, 类型：<code>bool</code>，层级：C，默认值为：<code>true</code></p>
<p>启用时，Pigsty会在执行剧本时，在成员间交换SSH公钥，允许管理员 <a href="/zh/docs/reference/param/#node_admin_username"><code>node_admin_username</code></a> 从不同节点上相互访问。</p>
<h3 id="node_admin_pk_current"><code>node_admin_pk_current</code></h3>
<p>参数名称： <code>node_admin_pk_current</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否将当前节点 &amp; 用户的公钥加入管理员账户，默认值是： <code>true</code></p>
<p>启用时，将会把当前节点上执行此剧本的管理用户的SSH公钥（<code>~/.ssh/id_rsa.pub</code>）拷贝至目标节点管理员用户的 <code>authorized_keys</code> 中。</p>
<p>生产环境部署时，请务必注意此参数，此参数会将当前执行命令用户的默认公钥安装至所有机器的管理用户上。</p>
<h3 id="node_admin_pk_list"><code>node_admin_pk_list</code></h3>
<p>参数名称： <code>node_admin_pk_list</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>可登陆管理员的公钥列表，默认值为：<code>[]</code> 空数组。</p>
<p>数组的每一个元素为字符串，内容为写入到管理员用户<code>~/.ssh/authorized_keys</code>中的公钥，持有对应私钥的用户可以以管理员身份登录。</p>
<p>生产环境部署时，请务必注意此参数，仅将信任的密钥加入此列表中。</p>
<hr>
<h2 id="node_time"><code>NODE_TIME</code></h2>
<p>关于主机时间/时区/NTP/定时任务的相关配置。</p>
<p>时间同步对于数据库服务来说非常重要，请确保系统 <code>chronyd</code> 授时服务正常运行。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_timezone</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># 设置节点时区，空字符串表示跳过</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_ntp_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># 启用chronyd时间同步服务？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_ntp_servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># `/etc/chrony.conf`中的ntp服务器</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">pool pool.ntp.org iburst</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_crontab_overwrite</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># 覆盖还是追加到`/etc/crontab`？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_crontab</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># `/etc/crontab`中的crontab条目</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_timezone"><code>node_timezone</code></h3>
<p>参数名称： <code>node_timezone</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>设置节点时区，空字符串表示跳过。默认值是空字符串，默认不会修改默认的时区（即使用通常的默认值UTC）</p>
<p>在中国地区使用时，建议设置为 <code>Asia/Hong_Kong</code>。</p>
<h3 id="node_ntp_enabled"><code>node_ntp_enabled</code></h3>
<p>参数名称： <code>node_ntp_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>启用chronyd时间同步服务？默认值为：<code>true</code></p>
<p>此时 Pigsty 将使用 <a href="/zh/docs/reference/param/#node_ntp_servers"><code>node_ntp_servers</code></a> 中指定的 NTP服务器列表覆盖节点的 <code>/etc/chrony.conf</code>。</p>
<p>如果您的节点已经配置好了 NTP 服务器，那么可以将此参数设置为 <code>false</code> 跳过时间同步配置。</p>
<h3 id="node_ntp_servers"><code>node_ntp_servers</code></h3>
<p>参数名称： <code>node_ntp_servers</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>在 <code>/etc/chrony.conf</code> 中使用的 NTP 服务器列表。默认值为：<code>[&quot;pool pool.ntp.org iburst&quot;]</code></p>
<p>本参数是一个数组，每一个数组元素是一个字符串，代表一行 NTP 服务器配置。仅当 <a href="/zh/docs/reference/param/#node_ntp_enabled"><code>node_ntp_enabled</code></a> 启用时生效。</p>
<p>Pigsty 默认使用全球 NTP 服务器 <code>pool.ntp.org</code>，您可以根据自己的网络环境修改此参数，例如 <code>cn.pool.ntp.org iburst</code>，或内网的时钟服务。</p>
<p>您也可以在配置中使用 <code>${admin_ip}</code> 占位符，使用管理节点上的时间服务器。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_ntp_servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pool ${admin_ip} iburst&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_crontab_overwrite"><code>node_crontab_overwrite</code></h3>
<p>参数名称： <code>node_crontab_overwrite</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>处理 <a href="/zh/docs/reference/param/#node_crontab"><code>node_crontab</code></a> 中的定时任务时，是追加还是覆盖？默认值为：<code>true</code>，即覆盖。</p>
<p>如果您希望在节点上追加定时任务，可以将此参数设置为 <code>false</code>，Pigsty 将会在节点的 crontab 上 <strong>追加</strong>，而非 <strong>覆盖所有</strong> 定时任务。</p>
<h3 id="node_crontab"><code>node_crontab</code></h3>
<p>参数名称： <code>node_crontab</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>定义在节点 <code>/etc/crontab</code> 中的定时任务：默认值为：<code>[]</code> 空数组。</p>
<p>每一个数组数组元素都是一个字符串，代表一行定时任务。使用标准的 cron 格式定义。</p>
<p>例如，以下配置会以  postgres 用户在每天凌晨1点执行全量备份任务。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_crontab</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># make a full backup every 1am</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><hr>
<h2 id="node_vip"><code>NODE_VIP</code></h2>
<p>您可以为节点集群绑定一个可选的 L2 VIP，默认不启用此特性。L2 VIP 只对一组节点集群有意义，该 VIP 会根据配置的优先级在集群中的节点之间进行切换，确保节点服务的高可用。</p>
<p>请注意，L2 VIP  <strong>只能</strong> 在同一 L2 网段中使用，这可能会对您的网络拓扑产生额外的限制，如果不想受此限制，您可以考虑使用 DNS LB 或者 Haproxy 实现类似的功能。</p>
<p>当启用此功能时，您需要为这个 L2 VIP 显式分配可用的 <a href="/zh/docs/reference/param/#vip_address"><code>vip_address</code></a> 与 <a href="/zh/docs/reference/param/#vip_vrid"><code>vip_vrid</code></a>，用户应当确保这两者在同一网段内唯一。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">vip_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># enable vip on this node cluster?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_address:         [IDENTITY] # node vip address in ipv4 format, required if vip is enabled</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_vrid:            [IDENTITY] # required, integer, 1-254, should be unique among same VLAN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">backup                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, `master/backup`, backup by default, use as init role</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_preempt</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># optional, `true/false`, false by default, enable vip preemption</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth0              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># node vip network interface to listen, `eth0` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_dns_suffix</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># node vip dns name suffix, empty string by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9650</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># keepalived exporter listen port, 9650 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="vip_enabled"><code>vip_enabled</code></h3>
<p>参数名称： <code>vip_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否在当前这个节点集群中配置一个由 Keepalived 管理的 L2 VIP ？ 默认值为： <code>false</code>。</p>
<h3 id="vip_address"><code>vip_address</code></h3>
<p>参数名称： <code>vip_address</code>， 类型： <code>ip</code>， 层次：<code>C</code></p>
<p>节点 VIP 地址，IPv4 格式（不带 CIDR 网段后缀），当节点启用 <a href="/zh/docs/reference/param/#vip_enabled"><code>vip_enabled</code></a> 时，这是一个必选参数。</p>
<p>本参数没有默认值，这意味着您必须显式地为节点集群分配一个唯一的 VIP 地址。</p>
<h3 id="vip_vrid"><code>vip_vrid</code></h3>
<p>参数名称： <code>vip_address</code>， 类型： <code>ip</code>， 层次：<code>C</code></p>
<p>VRID 是一个范围从 <code>1</code> 到 <code>254</code> 的正整数，用于标识一个网络中的 VIP，当节点启用 <a href="/zh/docs/reference/param/#vip_enabled"><code>vip_enabled</code></a> 时，这是一个必选参数。</p>
<p>本参数没有默认值，这意味着您必须显式地为节点集群分配一个网段内唯一的 ID。</p>
<h3 id="vip_role"><code>vip_role</code></h3>
<p>参数名称： <code>vip_role</code>， 类型： <code>enum</code>， 层次：<code>I</code></p>
<p>节点 VIP 角色，可选值为： <code>master</code> 或 <code>backup</code>，默认值为 <code>backup</code></p>
<p>该参数的值会被设置为 keepalived 的初始状态。</p>
<h3 id="vip_preempt"><code>vip_preempt</code></h3>
<p>参数名称： <code>vip_preempt</code>， 类型： <code>bool</code>， 层次：<code>C/I</code></p>
<p>是否启用 VIP 抢占？可选参数，默认值为 <code>false</code>，即不抢占 VIP。</p>
<p>所谓抢占，是指一个 <code>backup</code> 角色的节点，当其优先级高于当前存活且正常工作的 <code>master</code> 角色的节点时，是否取抢占其 VIP？</p>
<h3 id="vip_interface"><code>vip_interface</code></h3>
<p>参数名称： <code>vip_interface</code>， 类型： <code>string</code>， 层次：<code>C/I</code></p>
<p>节点 VIP 监听使用的网卡，默认为 <code>eth0</code>。</p>
<p>您应当使用与节点主IP地址（即：你填入清单中IP地址）所使用网卡相同的名称。</p>
<p>如果你的节点有着不同的网卡名称，你可以在实例/节点层次对其进行覆盖。</p>
<h3 id="vip_dns_suffix"><code>vip_dns_suffix</code></h3>
<p>参数名称： <code>vip_dns_suffix</code>， 类型： <code>string</code>， 层次：<code>C/I</code></p>
<p>节点集群 L2 VIP 使用的DNS名称，默认是空字符串，即直接使用集群名本身作为DNS名。</p>
<h3 id="vip_exporter_port"><code>vip_exporter_port</code></h3>
<p>参数名称： <code>vip_exporter_port</code>， 类型： <code>port</code>， 层次：<code>C/I</code></p>
<p>keepalived exporter 监听端口号，默认为：<code>9650</code>。</p>
<hr>
<h2 id="haproxy"><code>HAPROXY</code></h2>
<p>HAProxy 默认在所有节点上安装启用，并以类似于 Kubernetes NodePort 的方式对外暴露服务。</p>
<p><a href="/zh/docs/pgsql"><code>PGSQL</code></a> 模块对外<a href="pgsql-service">服务</a>使用到了 Haproxy。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">haproxy_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># 在此节点上启用haproxy？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># 清理所有现有的haproxy配置？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># 配置后重新加载haproxy？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_auth_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># 为haproxy管理页面启用身份验证</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">admin    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># haproxy管理用户名，默认为`admin`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># haproxy管理密码，默认为`pigsty`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9101</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># haproxy管理/导出端口，默认为9101</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_client_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">24h      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 客户端连接超时，默认为24小时</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_server_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">24h      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 服务器端连接超时，默认为24小时</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># 需要在节点上暴露的haproxy服务列表</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="haproxy_enabled"><code>haproxy_enabled</code></h3>
<p>参数名称： <code>haproxy_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>在此节点上启用haproxy？默认值为： <code>true</code>。</p>
<h3 id="haproxy_clean"><code>haproxy_clean</code></h3>
<p>参数名称： <code>haproxy_clean</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>清理所有现有的haproxy配置？默认值为 <code>false</code>。</p>
<h3 id="haproxy_reload"><code>haproxy_reload</code></h3>
<p>参数名称： <code>haproxy_reload</code>， 类型： <code>bool</code>， 层次：<code>A</code></p>
<p>配置后重新加载 haproxy？默认值为 <code>true</code>，配置更改后会重新加载haproxy。</p>
<p>如果您希望在应用配置前进行手工检查，您可以使用命令参数关闭此选项，并进行检查后再应用。</p>
<h3 id="haproxy_auth_enabled"><code>haproxy_auth_enabled</code></h3>
<p>参数名称： <code>haproxy_auth_enabled</code>， 类型： <code>bool</code>， 层次：<code>G</code></p>
<p>为haproxy管理页面启用身份验证，默认值为 <code>true</code>，它将要求管理页面进行http基本身份验证。</p>
<p>建议不要禁用认证，因为您的流量控制页面将对外暴露，这是比较危险的。</p>
<h3 id="haproxy_admin_username"><code>haproxy_admin_username</code></h3>
<p>参数名称： <code>haproxy_admin_username</code>， 类型： <code>username</code>， 层次：<code>G</code></p>
<p>haproxy 管理员用户名，默认为：<code>admin</code>。</p>
<h3 id="haproxy_admin_password"><code>haproxy_admin_password</code></h3>
<p>参数名称： <code>haproxy_admin_password</code>， 类型： <code>password</code>， 层次：<code>G</code></p>
<p>haproxy管理密码，默认为 <code>pigsty</code></p>
<blockquote>
<p>在生产环境中请务必修改此密码！</p>
</blockquote>
<h3 id="haproxy_exporter_port"><code>haproxy_exporter_port</code></h3>
<p>参数名称： <code>haproxy_exporter_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>haproxy 流量管理/指标对外暴露的端口，默认为：<code>9101</code></p>
<h3 id="haproxy_client_timeout"><code>haproxy_client_timeout</code></h3>
<p>参数名称： <code>haproxy_client_timeout</code>， 类型： <code>interval</code>， 层次：<code>C</code></p>
<p>客户端连接超时，默认为 <code>24h</code>。</p>
<p>设置一个超时可以避免难以清理的超长的连接，但如果您真的需要一个长连接，您可以将其设置为更长的时间。</p>
<h3 id="haproxy_server_timeout"><code>haproxy_server_timeout</code></h3>
<p>参数名称： <code>haproxy_server_timeout</code>， 类型： <code>interval</code>， 层次：<code>C</code></p>
<p>服务端连接超时，默认为 <code>24h</code>。</p>
<p>设置一个超时可以避免难以清理的超长的连接，但如果您真的需要一个长连接，您可以将其设置为更长的时间。</p>
<h3 id="haproxy_services"><code>haproxy_services</code></h3>
<p>参数名称： <code>haproxy_services</code>， 类型： <code>service[]</code>， 层次：<code>C</code></p>
<p>需要在此节点上通过 Haproxy 对外暴露的服务列表，默认值为： <code>[]</code> 空数组。</p>
<p>每一个数组元素都是一个服务定义，下面是一个服务定义的例子：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">haproxy_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># list of haproxy service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># expose pg-test read only replicas</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-test-ro               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># [REQUIRED] service name, unique</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5440</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># [REQUIRED] service port, unique</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] service listen addr, &#34;*&#34; by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">protocol</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tcp                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] service protocol, &#39;tcp&#39; by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">balance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">leastconn             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] load balance algorithm, roundrobin by default (or leastconn)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">maxconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">20000</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] max allowed front-end connection, 20000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;inter 3s fastinter 1s downinter 5s rise 3 fall 3 on-marked-down shutdown-sessions slowstart 30s maxconn 3000 maxqueue 128 weight 100&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">option httpchk</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">option http-keep-alive</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">http-check send meth OPTIONS uri /read-only</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">http-check expect status 200</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg-test-1 ,ip: 10.10.10.11 , port: 5432 , options: check port 8008 , backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg-test-2 ,ip: 10.10.10.12 , port: 5432 , options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">check port 8008 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg-test-3 ,ip: 10.10.10.13 , port: 5432 , options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">check port 8008 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>每个服务定义会被渲染为 <code>/etc/haproxy/&lt;service.name&gt;.cfg</code> 配置文件，并在 Haproxy 重载后生效。</p>
<hr>
<h2 id="node_exporter"><code>NODE_EXPORTER</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># setup node_exporter on this node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9100</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># node exporter listen port, 9100 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--no-collector.softnet --no-collector.nvme --collector.tcpstat --collector.processes&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_exporter_enabled"><code>node_exporter_enabled</code></h3>
<p>参数名称： <code>node_exporter_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>在当前节点上启用节点指标收集器？默认启用：<code>true</code></p>
<h3 id="node_exporter_port"><code>node_exporter_port</code></h3>
<p>参数名称： <code>node_exporter_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>对外暴露节点指标使用的端口，默认为 <code>9100</code>。</p>
<h3 id="node_exporter_options"><code>node_exporter_options</code></h3>
<p>参数名称： <code>node_exporter_options</code>， 类型： <code>arg</code>， 层次：<code>C</code></p>
<p>节点指标采集器的命令行参数，默认值为：</p>
<p><code>--no-collector.softnet --no-collector.nvme --collector.tcpstat --collector.processes</code></p>
<p>该选项会启用/禁用一些指标收集器，请根据您的需要进行调整。</p>
<hr>
<h2 id="promtail"><code>PROMTAIL</code></h2>
<p>Promtail 是与 Loki 配套的日志收集组件，会收集各个模块产生的日志并发送至基础设施节点上的 <a href="/zh/docs/reference/param/#loki"><code>LOKI</code></a> 服务。</p>
<ul>
<li>
<p><code>INFRA</code>： 基础设施组件的日志只会在 Infra 节点上收集。</p>
<ul>
<li><code>nginx-access</code>: <code>/var/log/nginx/access.log</code></li>
<li><code>nginx-error</code>: <code>/var/log/nginx/error.log</code></li>
<li><code>grafana</code>: <code>/var/log/grafana/grafana.log</code></li>
</ul>
</li>
<li>
<p><code>NODES</code>：主机相关的日志，所有节点上都会启用收集。</p>
<ul>
<li><code>syslog</code>: <code>/var/log/messages</code> （Debian上为 <code>/var/log/syslog</code>）</li>
<li><code>dmesg</code>: <code>/var/log/dmesg</code></li>
<li><code>cron</code>: <code>/var/log/cron</code></li>
</ul>
</li>
<li>
<p><code>PGSQL</code>：PostgreSQL 相关的日志，只有节点配置了 <a href="/zh/docs/pgsql">PGSQL</a> 模块才会启用收集。</p>
<ul>
<li><code>postgres</code>: <code>/pg/log/postgres/*</code></li>
<li><code>patroni</code>: <code>/pg/log/patroni.log</code></li>
<li><code>pgbouncer</code>: <code>/pg/log/pgbouncer/pgbouncer.log</code></li>
<li><code>pgbackrest</code>: <code>/pg/log/pgbackrest/*.log</code></li>
</ul>
</li>
<li>
<p><code>REDIS</code>：Redis 相关日志，只有节点配置了 <a href="/zh/docs/redis">REDIS</a> 模块才会启用收集。</p>
<ul>
<li><code>redis</code>: <code>/var/log/redis/*.log</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>日志目录会根据这些参数的配置自动调整：<a href="/zh/docs/reference/param/#pg_log_dir"><code>pg_log_dir</code></a>, <a href="/zh/docs/reference/param/#patroni_log_dir"><code>patroni_log_dir</code></a>, <a href="/zh/docs/reference/param/#pgbouncer_log_dir"><code>pgbouncer_log_dir</code></a>, <a href="/zh/docs/reference/param/#pgbackrest_log_dir"><code>pgbackrest_log_dir</code></a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">promtail_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># enable promtail logging collector?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">promtail_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># purge existing promtail status file during init?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">promtail_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9080</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># promtail listen port, 9080 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">promtail_positions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/var/log/positions.yaml</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># promtail position status file path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="promtail_enabled"><code>promtail_enabled</code></h3>
<p>参数名称： <code>promtail_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否启用Promtail日志收集服务？默认值为： <code>true</code></p>
<h3 id="promtail_clean"><code>promtail_clean</code></h3>
<p>参数名称： <code>promtail_clean</code>， 类型： <code>bool</code>， 层次：<code>G/A</code></p>
<p>是否在安装 Promtail 时移除已有状态信息？默认值为： <code>false</code>。</p>
<p>默认不会清理，当您选择清理时，Pigsty会在部署Promtail时移除现有状态文件 <a href="/zh/docs/reference/param/#promtail_positions"><code>promtail_positions</code></a>，这意味着Promtail会重新收集当前节点上的所有日志并发送至Loki。</p>
<h3 id="promtail_port"><code>promtail_port</code></h3>
<p>参数名称： <code>promtail_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>Promtail 监听使用的默认端口号， 默认为：<code>9080</code></p>
<h3 id="promtail_positions"><code>promtail_positions</code></h3>
<p>参数名称： <code>promtail_positions</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>Promtail 状态文件路径，默认值为：<code>/var/log/positions.yaml</code>。</p>
<p>Promtail记录了所有日志的消费偏移量，定期写入由本参数指定的文件中。</p>
<hr>
<h1 id="docker"><code>DOCKER</code></h1>
<p>您可以使用 <a href="https://github.com/Vonng/pigsty/blob/main/docker.yml"><code>docker.yml</code></a> 剧本，在节点上安装并启用 Docker。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">docker_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># enable docker on this node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">docker_cgroups_driver: systemd    # docker cgroup fs driver</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cgroupfs,systemd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">docker_registry_mirrors</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># docker registry mirror list</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">docker_image</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># docker image to be pulled after bootstrap</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">docker_image_cache</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/tmp/docker/*.tgz</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># docker image cache file/glob, `/tmp/docker/*.tgz` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="docker_enabled"><code>docker_enabled</code></h3>
<p>参数名称： <code>docker_enabled</code>， 类型： <code>bool</code>， 层次：<code>G/C/I</code></p>
<p>是否在当前节点启用Docker？默认为： <code>false</code>，即不启用。</p>
<h3 id="docker_cgroups_driver"><code>docker_cgroups_driver</code></h3>
<p>参数名称： <code>docker_cgroups_driver</code>， 类型： <code>enum</code>， 层次：<code>G/C/I</code></p>
<p>Docker使用的 CGroup FS 驱动，可以是 <code>cgroupfs</code> 或 <code>systemd</code>，默认值为： <code>systemd</code></p>
<h3 id="docker_registry_mirrors"><code>docker_registry_mirrors</code></h3>
<p>参数名称： <code>docker_registry_mirrors</code>， 类型： <code>string[]</code>， 层次：<code>G/C/I</code></p>
<p>Docker使用的镜像仓库地址，默认值为：<code>[]</code> 空数组。</p>
<p>您可以使用Docker镜像站点加速镜像拉取，下面是一些例子：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://mirror.ccs.tencentyun.com&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># 腾讯云内网的镜像站点</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;https://registry.cn-hangzhou.aliyuncs.com&#34;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># 阿里云镜像站点，需要登陆</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>如果拉取速度太慢，您也可以考虑：<code>docker login quay.io</code> 使用其他的 Registry。</p>
<h3 id="docker_image"><code>docker_image</code></h3>
<p>参数名称： <code>docker_image</code>， 类型： <code>string[]</code>， 层次：<code>G/C/I</code></p>
<p>Docker 待拉取的镜像列表，默认为空列表 <code>[]</code>。</p>
<p>在这里指定的 Docker 镜像名称会在安装阶段自动拉取。</p>
<h3 id="docker_image_cache"><code>docker_image_cache</code></h3>
<p>参数名称： <code>docker_image_cache</code>， 类型： <code>path[]</code>， 层次：<code>G/C/I</code></p>
<p>本地 Docker 镜像离线缓存包路径列表， 数组，默认为 <code>[&quot;/tmp/docker/*.tgz&quot;]</code>。</p>
<p>您可以使用 <code>docker save | gzip</code> 的方式将镜像打包，并通过此参数在 Docker 安装阶段自动导入。</p>
<p>匹配该参数的 tarball 将使用以下方式 导入 Docker 中：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat *.tgz <span style="color:#000;font-weight:bold">|</span> gzip -d -c - <span style="color:#000;font-weight:bold">|</span> docker load
</span></span></code></pre></div><hr>
<h1 id="etcd"><code>ETCD</code></h1>
<p><a href="/zh/docs/etcd"><strong><code>ETCD</code></strong></a> 是一个分布式、可靠的键值存储，用于分布式系统的最关键数据。Pigsty使用 etcd 作为DCS，这对 PostgreSQL 的高可用性非常重要。</p>
<p>Pigsty为etcd集群使用一个硬编码的集群组名 <code>etcd</code>，它可以是一套现有的外部 etcd 集群，或者默认由 Pigsty 使用 <a href="/zh/docs/etcd#etcdyml">etcd.yml</a> 剧本部署创建的新etcd集群。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#etcd_seq: 1                      # etcd实例标识符，需要显式指定</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#etcd_cluster: etcd               # etcd集群和组名称，默认为etcd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># 组织清除正在运行的etcd实例？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># 在初始化过程中清除现有的etcd？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/etcd            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># etcd数据目录，默认为/data/etcd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2379</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># etcd客户端端口，默认为2379</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_peer_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2380</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># etcd对等端口，默认为2380</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_init</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">new                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># etcd初始集群状态，新建或现有</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_election_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1000</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># etcd选举超时，默认为1000ms</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_heartbeat_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># etcd心跳间隔，默认为100ms</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="etcd_seq"><code>etcd_seq</code></h3>
<p>参数名称： <code>etcd_seq</code>， 类型： <code>int</code>， 层次：<code>I</code></p>
<p>etcd 实例标号， 这是必选参数，必须为每一个 etcd 实例指定一个唯一的标号。</p>
<p>以下是一个3节点etcd集群的示例，分配了 1 ～ 3 三个标号。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">etcd</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dcs service for postgres/patroni ha consensus</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># 1 node for testing, 3 or 5 for production</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># etcd_seq required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># assign from 1 ~ n</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># odd number please</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># cluster level parameter override roles/etcd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">etcd_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">etcd </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># mark etcd cluster name etcd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">etcd_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># safeguard against purging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">etcd_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># purge etcd during init process</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="etcd_cluster"><code>etcd_cluster</code></h3>
<p>参数名称： <code>etcd_cluster</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>etcd 集群 &amp; 分组名称，默认值为硬编码值 <code>etcd</code>。</p>
<p>当您想要部署另外的 etcd 集群备用时，可以修改此参数并使用其他集群名。</p>
<h3 id="etcd_safeguard"><code>etcd_safeguard</code></h3>
<p>参数名称： <code>etcd_safeguard</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>安全保险参数，防止清除正在运行的etcd实例？默认值为 <code>false</code>。</p>
<p>如果启用安全保险，<a href="/zh/docs/etcd#etcdyml">etcd.yml</a> 剧本不会清除正在运行的etcd实例。</p>
<h3 id="etcd_clean"><code>etcd_clean</code></h3>
<p>参数名称： <code>etcd_clean</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>在初始化时清除现有的 etcd ？默认值为<code>true</code>。</p>
<p>如果启用，<a href="/zh/docs/etcd#etcdyml">etcd.yml</a> 剧本将清除正在运行的 etcd 实例，这将使其成为一个真正幂等的剧本（总是抹除现有集群）。</p>
<p>但是如果启用了<a href="/zh/docs/reference/param/#etcd_safeguard"><code>etcd_safeguard</code></a>，即使设置了此参数，剧本依然会在遇到运行中的 etcd 实例时中止，避免误删。</p>
<h3 id="etcd_data"><code>etcd_data</code></h3>
<p>参数名称： <code>etcd_data</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>etcd 数据目录，默认为<code>/data/etcd</code> 。</p>
<h3 id="etcd_port"><code>etcd_port</code></h3>
<p>参数名称： <code>etcd_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>etcd 客户端端口号，默认为<code>2379</code>。</p>
<h3 id="etcd_peer_port"><code>etcd_peer_port</code></h3>
<p>参数名称： <code>etcd_peer_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>etcd peer 端口，默认为 <code>2380</code> 。</p>
<h3 id="etcd_init"><code>etcd_init</code></h3>
<p>参数名称： <code>etcd_init</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>etcd初始集群状态，可以是<code>new</code>或<code>existing</code>，默认值：<code>new</code>。</p>
<p>默认将创建一个独立的新etcd集群，当尝试向现有etcd集群<a href="/zh/docs/etcd#%E6%B7%BB%E5%8A%A0%E6%88%90%E5%91%98">添加新成员</a>时，应当使用 <code>existing</code>。</p>
<h3 id="etcd_election_timeout"><code>etcd_election_timeout</code></h3>
<p>参数名称： <code>etcd_election_timeout</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>etcd 选举超时，默认为 <code>1000</code> (毫秒)，也就是 1 秒。</p>
<h3 id="etcd_heartbeat_interval"><code>etcd_heartbeat_interval</code></h3>
<p>参数名称： <code>etcd_heartbeat_interval</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>etcd心跳间隔，默认为 <code>100</code> (毫秒)。</p>
<hr>
<h1 id="minio"><code>MINIO</code></h1>
<p>MinIO 是一个与S3兼容的对象存储服务，它被用作PostgreSQL的可选的集中式备份存储库。</p>
<p>但你也可以将其用于其他目的，如存储大文件、文档、图片和视频。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#minio_seq: 1                     # minio instance identifier, REQUIRED</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio cluster name, minio by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># cleanup minio during init?, false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio os user, `minio` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_node</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${minio_cluster}-${minio_seq}.pigsty&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio node name pattern</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;/data/minio&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># minio data dir(s), use {x...y} to specify multi drivers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss.pigsty         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio external domain name, `sss.pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9000</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># minio service port, 9000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_admin_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9001</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio console port, 9001 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_access_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minioadmin     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># root access key, `minioadmin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_secret_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minioadmin     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># root secret key, `minioadmin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_extra_vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># extra environment variables</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_alias</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># alias name for local minio deployment</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_buckets</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql }, { name: infra },  { name: redis } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: dba , secret_key: S3User.DBA, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consoleAdmin }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: pgbackrest , secret_key: S3User.Backup, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="minio_seq"><code>minio_seq</code></h3>
<p>参数名称： <code>minio_seq</code>， 类型： <code>int</code>， 层次：<code>I</code></p>
<p>MinIO 实例标识符，必需的身份参数。没有默认值，您必须手动分配。</p>
<h3 id="minio_cluster"><code>minio_cluster</code></h3>
<p>参数名称： <code>minio_cluster</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>MinIO 集群名称，默认为 <code>minio</code>。当部署多个MinIO集群时，可以使用此参数进行区分。</p>
<h3 id="minio_clean"><code>minio_clean</code></h3>
<p>参数名称： <code>minio_clean</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>是否在初始化时清理 MinIO ？默认为 <code>false</code>，即不清理现有数据。</p>
<h3 id="minio_user"><code>minio_user</code></h3>
<p>参数名称： <code>minio_user</code>， 类型： <code>username</code>， 层次：<code>C</code></p>
<p>MinIO 操作系统用户名，默认为 <code>minio</code>。</p>
<h3 id="minio_node"><code>minio_node</code></h3>
<p>参数名称： <code>minio_node</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>MinIO 节点名称模式，用于<a href="/zh/docs/minio#%E5%A4%9A%E6%9C%BA%E5%A4%9A%E7%9B%98">多节点</a>部署。</p>
<p>默认值为：<code>${minio_cluster}-${minio_seq}.pigsty</code>，即以实例名 + <code>.pigsty</code> 后缀作为默认的节点名。</p>
<h3 id="minio_data"><code>minio_data</code></h3>
<p>参数名称： <code>minio_data</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>MinIO 数据目录（们），默认值：<code>/data/minio</code>，这是<a href="/zh/docs/minio#%E5%8D%95%E6%9C%BA%E5%8D%95%E7%9B%98">单节点</a>部署的常见目录。</p>
<p>对于<a href="/zh/docs/minio#%E5%8D%95%E6%9C%BA%E5%A4%9A%E7%9B%98">多个磁盘</a>部署，您可以使用 <code>{x...y}</code> 的记法来指定多个驱动器。</p>
<h3 id="minio_domain"><code>minio_domain</code></h3>
<p>参数名称： <code>minio_domain</code>， 类型： <code>string</code>， 层次：<code>G</code></p>
<p>MinIO 服务域名，默认为<code>sss.pigsty</code>。</p>
<p>客户端可以通过此域名访问 MinIO S3服务。此名称将注册到本地DNSMASQ，并包含在SSL证书字段中。</p>
<h3 id="minio_port"><code>minio_port</code></h3>
<p>参数名称： <code>minio_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>MinIO 服务端口，默认为<code>9000</code>。</p>
<h3 id="minio_admin_port"><code>minio_admin_port</code></h3>
<p>参数名称： <code>minio_admin_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>MinIO 控制台端口，默认为<code>9001</code>。</p>
<h3 id="minio_access_key"><code>minio_access_key</code></h3>
<p>参数名称： <code>minio_access_key</code>， 类型： <code>username</code>， 层次：<code>C</code></p>
<p>根访问用户名（access key），默认为<code>minioadmin</code>。</p>
<h3 id="minio_secret_key"><code>minio_secret_key</code></h3>
<p>参数名称： <code>minio_secret_key</code>， 类型： <code>password</code>， 层次：<code>C</code></p>
<p>根访问密钥（secret key），默认为<code>minioadmin</code>。</p>
<blockquote>
<p><strong>请务必在生产部署中更改此参数！</strong></p>
</blockquote>
<h3 id="minio_extra_vars"><code>minio_extra_vars</code></h3>
<p>参数名称： <code>minio_extra_vars</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>MinIO 服务器的额外环境变量。查看<a href="https://min.io/docs/minio/linux/reference/minio-server/minio-server.html">Minio Server</a> 文档以获取完整列表。</p>
<p>默认值为空字符串，您可以使用多行字符串来传递多个环境变量。</p>
<h3 id="minio_alias"><code>minio_alias</code></h3>
<p>参数名称： <code>minio_alias</code>， 类型： <code>string</code>， 层次：<code>G</code></p>
<p>本地MinIO集群的MinIO别名，默认值：<code>sss</code>，它将被写入基础设施节点/管理员用户的客户端别名配置文件中。</p>
<h3 id="minio_buckets"><code>minio_buckets</code></h3>
<p>参数名称： <code>minio_buckets</code>， 类型： <code>bucket[]</code>， 层次：<code>C</code></p>
<p>默认创建的minio存储桶列表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">minio_buckets</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql }, { name: infra },  { name: redis } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>为模块<a href="/zh/docs/pgsql"><code>PGSQL</code></a>、<a href="/zh/docs/infra"><code>INFRA</code></a>和<a href="/zh/docs/redis"><code>REDIS</code></a>创建了三个默认的存储桶。</p>
<h3 id="minio_users"><code>minio_users</code></h3>
<p>参数名称： <code>minio_users</code>， 类型： <code>user[]</code>， 层次：<code>C</code></p>
<p>要创建的minio用户列表，默认值：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">minio_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: dba , secret_key: S3User.DBA, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consoleAdmin }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: pgbackrest , secret_key: S3User.Backup, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>默认配置会为 PostgreSQL DBA 和 pgBackREST 创建两个默认用户。</p>
<blockquote>
<p><strong>请务必在您的部署中调整这些凭证！</strong></p>
</blockquote>
<hr>
<h1 id="redis"><code>REDIS</code></h1>
<p><a href="/zh/docs/redis">Redis</a> 模块包含了20个配置参数。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#redis_cluster:             &lt;集群&gt; # Redis数据库集群名称，必选身份参数</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#redis_node: 1              &lt;节点&gt; # Redis节点上的实例定义</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#redis_instances: {}        &lt;节点&gt; # Redis节点编号，正整数，集群内唯一，必选身份参数</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_fs_main</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Redis主数据目录，默认为 `/data`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># Redis Exporter 是否启用？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9121</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># Redis Exporter监听端口</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># Redis Exporter命令参数</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># 禁止抹除现存的Redis</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># 初始化Redis是否抹除现存实例</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_rmdata</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># 移除Redis实例时是否一并移除数据？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">standalone           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Redis集群模式：sentinel，cluster，standalone</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_conf</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">redis.conf           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Redis配置文件模板，sentinel 除外</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_bind_address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;0.0.0.0&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#8f5902;font-style:italic"># Redis监听地址，默认留空则会绑定主机IP</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_max_memory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1GB            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Redis可用的最大内存</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_mem_policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allkeys-lru    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Redis内存逐出策略</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># Redis密码，默认留空则禁用密码</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_rdb_save</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;1200 1&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># Redis RDB 保存指令，字符串列表，空数组则禁用RDB</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_aof_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># Redis AOF 是否启用？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_rename_commands</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># Redis危险命令重命名列表</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_cluster_replicas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># Redis原生集群中每个主库配几个从库？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="redis_cluster"><code>redis_cluster</code></h3>
<p>参数名称： <code>redis_cluster</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>身份参数，必选参数，必须显式在集群层面配置，将用作集群内资源的命名空间。</p>
<p>需要遵循特定命名规则：<code>[a-z][a-z0-9-]*</code>，以兼容不同约束对身份标识的要求，建议使用<code>redis-</code>作为集群名前缀。</p>
<h3 id="redis_node"><code>redis_node</code></h3>
<p>参数名称： <code>redis_node</code>， 类型： <code>int</code>， 层次：<code>I</code></p>
<p>Redis节点序列号，身份参数，必选参数，必须显式在节点（Host）层面配置。</p>
<p>自然数，在集群中应当是唯一的，用于区别与标识集群内的不同节点，从0或1开始分配。</p>
<h3 id="redis_instances"><code>redis_instances</code></h3>
<p>参数名称： <code>redis_instances</code>， 类型： <code>dict</code>， 层次：<code>I</code></p>
<p>当前 Redis 节点上的 Redis 实例定义，必选参数，必须显式在节点（Host）层面配置。</p>
<p>内容为JSON KV对象格式。Key为数值类型端口号，Value为该实例特定的JSON配置项。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">redis-test: # redis native cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">3m x 3s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">redis_node: 1 ,redis_instances</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">6379</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">} ,6380</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">} ,6381</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">redis_node: 2 ,redis_instances</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">6379</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">} ,6380</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">} ,6381</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">redis_cluster: redis-test ,redis_password: &#39;redis.test&#39; ,redis_mode: cluster, redis_max_memory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">32MB }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>每一个Redis实例在对应节点上监听一个唯一端口，实例配置项中<code>replica_of</code> 用于设置一个实例的上游主库地址，构建主从复制关系。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">redis_instances</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">6379</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">6380</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">replica_of</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;10.10.10.13 6379&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">6381</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">replica_of</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;10.10.10.13 6379&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="redis_fs_main"><code>redis_fs_main</code></h3>
<p>参数名称： <code>redis_fs_main</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>Redis使用的主数据盘挂载点，默认为<code>/data</code>，Pigsty会在该目录下创建<code>redis</code>目录，用于存放Redis数据。</p>
<p>所以实际存储数据的目录为 <code>/data/redis</code>，该目录的属主为操作系统用户 <code>redis</code>，内部结构详情请参考 <a href="/zh/docs/fhs#redis-fhs">FHS：Redis</a></p>
<h3 id="redis_exporter_enabled"><code>redis_exporter_enabled</code></h3>
<p>参数名称： <code>redis_exporter_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否启用Redis监控组件 Redis Exporter？</p>
<p>默认启用，在每个Redis节点上部署一个，默认监听 <a href="/zh/docs/reference/param/#redis_exporter_port"><code>redis_exporter_port</code></a> <code>9121</code> 端口。所有本节点上 Redis 实例的监控指标都由它负责抓取。</p>
<h3 id="redis_exporter_port"><code>redis_exporter_port</code></h3>
<p>参数名称： <code>redis_exporter_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>Redis Exporter监听端口，默认值为：<code>9121</code></p>
<h3 id="redis_exporter_options"><code>redis_exporter_options</code></h3>
<p>参数名称： <code>redis_exporter_options</code>， 类型： <code>string</code>， 层次：<code>C/I</code></p>
<p>传给 Redis Exporter 的额外命令行参数，会被渲染到 <code>/etc/defaut/redis_exporter</code> 中，默认为空字符串。</p>
<h3 id="redis_safeguard"><code>redis_safeguard</code></h3>
<p>参数名称： <code>redis_safeguard</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>Redis的防误删安全保险开关：打开后无法使用剧本抹除正在运行的 Redis 实例。</p>
<p>默认值为 <code>false</code>，如果设置为 <code>true</code>，那么当剧本遇到正在运行的 Redis 实例时，会中止初始化/抹除的操作，避免误删。</p>
<h3 id="redis_clean"><code>redis_clean</code></h3>
<p>参数名称： <code>redis_clean</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>Redis清理开关：是否在初始化的过程中抹除运行中的Redis实例？默认值为：<code>true</code>。</p>
<p>剧本 <code>redis.yml</code> 会在执行时抹除具有相同定义的现有 Redis 实例，这样可以保证剧本的幂等性。</p>
<p>如果您不希望 <code>redis.yml</code> 这样做，可以将此参数设置为 <code>false</code>，那么当剧本遇到正在运行的 Redis 实例时，会中止初始化/抹除的操作，避免误删。</p>
<p>如果安全保险参数 <a href="/zh/docs/reference/param/#redis_safeguard"><code>redis_safeguard</code></a> 已经打开，那么本参数的优先级低于该参数。</p>
<h3 id="redis_rmdata"><code>redis_rmdata</code></h3>
<p>参数名称： <code>redis_rmdata</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>移除 Redis 实例的时候，是否一并移除 Redis 数据目录？默认为 <code>true</code>。</p>
<p>数据目录包含了 Redis 的 RDB与AOF文件，如果不抹除它们，那么新拉起的 Redis 实例将会从这些备份文件中加载数据。</p>
<h3 id="redis_mode"><code>redis_mode</code></h3>
<p>参数名称： <code>redis_mode</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>Redis集群的工作模式，有三种选项：<code>standalone</code>, <code>cluster</code>, <code>sentinel</code>，默认值为 <code>standalone</code></p>
<ul>
<li><code>standalone</code>：默认，独立的Redis主从模式</li>
<li><code>cluster</code>： Redis原生集群模式</li>
<li><code>sentinel</code>：Redis高可用组件：哨兵</li>
</ul>
<p>当使用<code>standalone</code>模式时，Pigsty会根据 <code>replica_of</code> 参数设置Redis主从复制关系。</p>
<p>当使用<code>cluster</code>模式时，Pigsty会根据 <a href="/zh/docs/reference/param/#redis_cluster_replicas"><code>redis_cluster_replicas</code></a> 参数使用所有定义的实例创建原生Redis集群。</p>
<h3 id="redis_conf"><code>redis_conf</code></h3>
<p>参数名称： <code>redis_conf</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>Redis 配置模板路径，Sentinel除外。</p>
<p>默认值：<code>redis.conf</code>，这是一个模板文件，位于 <a href="https://github.com/Vonng/pigsty/blob/main/roles/redis/templates/redis.conf"><code>roles/redis/templates/redis.conf</code></a>。</p>
<p>如果你想使用自己的 Redis 配置模板，你可以将它放在 <code>templates/</code> 目录中，并设置此参数为模板文件名。</p>
<p>注意： Redis Sentinel 使用的是另一个不同的模板文件，即 <a href="https://github.com/Vonng/pigsty/blob/main/roles/redis/templates/redis-sentinel.conf"><code>roles/redis/templates/redis-sentinel.conf</code></a>。</p>
<h3 id="redis_bind_address"><code>redis_bind_address</code></h3>
<p>参数名称： <code>redis_bind_address</code>， 类型： <code>ip</code>， 层次：<code>C</code></p>
<p>Redis服务器绑定的IP地址，空字符串将使用配置清单中定义的主机名。</p>
<p>默认值：<code>0.0.0.0</code>，这将绑定到此主机上的所有可用 IPv4 地址。</p>
<p>在生产环境中出于安全性考虑，建议仅绑定内网 IP，即将此值设置为空字符串 <code>''</code></p>
<h3 id="redis_max_memory"><code>redis_max_memory</code></h3>
<p>参数名称： <code>redis_max_memory</code>， 类型： <code>size</code>， 层次：<code>C/I</code></p>
<p>每个 Redis 实例使用的最大内存配置，默认值：<code>1GB</code>。</p>
<h3 id="redis_mem_policy"><code>redis_mem_policy</code></h3>
<p>参数名称： <code>redis_mem_policy</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>Redis 内存回收策略，默认值：<code>allkeys-lru</code>，</p>
<ul>
<li><code>noeviction</code>：内存达限时不保存新值：当使用主从复制时仅适用于主库</li>
<li><code>allkeys-lru</code>：保持最近使用的键；删除最近最少使用的键（LRU）</li>
<li><code>allkeys-lfu</code>：保持频繁使用的键；删除最少频繁使用的键（LFU）</li>
<li><code>volatile-lru</code>：删除带有真实过期字段的最近最少使用的键</li>
<li><code>volatile-lfu</code>：删除带有真实过期字段的最少频繁使用的键</li>
<li><code>allkeys-random</code>：随机删除键以为新添加的数据腾出空间</li>
<li><code>volatile-random</code>：随机删除带有过期字段的键</li>
<li><code>volatile-ttl</code>：删除带有真实过期字段和最短剩余生存时间（TTL）值的键。</li>
</ul>
<p>详情请参阅<a href="https://redis.io/docs/reference/eviction/">Redis内存回收策略</a>。</p>
<h3 id="redis_password"><code>redis_password</code></h3>
<p>参数名称： <code>redis_password</code>， 类型： <code>password</code>， 层次：<code>C/N</code></p>
<p>Redis 密码，空字符串将禁用密码，这是默认行为。</p>
<p>注意，由于 redis_exporter 的实现限制，您每个节点只能设置一个 <code>redis_password</code>。这通常不是问题，因为 pigsty 不允许在同一节点上部署两个不同的 Redis 集群。</p>
<blockquote>
<p>请在生产环境中使用强密码</p>
</blockquote>
<h3 id="redis_rdb_save"><code>redis_rdb_save</code></h3>
<p>参数名称： <code>redis_rdb_save</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>Redis RDB 保存指令，使用空列表则禁用 RDB。</p>
<p>默认值是 <code>[&quot;1200 1&quot;]</code>：如果最近20分钟至少有1个键更改，则将数据集转储到磁盘。</p>
<p>详情请参考 <a href="https://redis.io/docs/management/persistence/">Redis持久化</a>。</p>
<h3 id="redis_aof_enabled"><code>redis_aof_enabled</code></h3>
<p>参数名称： <code>redis_aof_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>启用 Redis AOF 吗？默认值是 <code>false</code>，即不使用 AOF。</p>
<h3 id="redis_rename_commands"><code>redis_rename_commands</code></h3>
<p>参数名称： <code>redis_rename_commands</code>， 类型： <code>dict</code>， 层次：<code>C</code></p>
<p>重命名 Redis 危险命令，这是一个 k:v 字典：<code>old: new</code>，old是待重命名的命令名称，new是重命名后的名字。</p>
<p>默认值：<code>{}</code>，你可以通过设置此值来隐藏像 <code>FLUSHDB</code> 和 <code>FLUSHALL</code> 这样的危险命令，下面是一个例子：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>{<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">&#34;keys&#34;: </span><span style="color:#4e9a06">&#34;op_keys&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">&#34;flushdb&#34;: </span><span style="color:#4e9a06">&#34;op_flushdb&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">&#34;flushall&#34;: </span><span style="color:#4e9a06">&#34;op_flushall&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">&#34;config&#34;: </span><span style="color:#4e9a06">&#34;op_config&#34;</span><span style="color:#f8f8f8;text-decoration:underline">  
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="redis_cluster_replicas"><code>redis_cluster_replicas</code></h3>
<p>参数名称： <code>redis_cluster_replicas</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>在 Redis 原生集群中，应当为一个 Master/Primary 实例配置多少个从库？默认值为： <code>1</code>，即每个主库配一个从库。</p>
<h3 id="redis_sentinel_monitor"><code>redis_sentinel_monitor</code></h3>
<p>参数名称： <code>redis_sentinel_monitor</code>， 类型： <code>master[]</code>， 层次：<code>C</code></p>
<p>Redis哨兵监控的主库列表，只在哨兵集群上使用。每个待纳管的主库定义方式如下所示：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">redis_sentinel_monitor</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># primary list for redis sentinel, use cls as name, primary ip:port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: redis-src, host: 10.10.10.45, port: 6379 ,password: redis.src, quorum</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: redis-dst, host: 10.10.10.48, port: 6379 ,password: redis.dst, quorum</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>其中，<code>name</code>，<code>host</code> 是必选参数，<code>port</code>，<code>password</code>，<code>quorum</code> 是可选参数，<code>quorum</code> 用于设置判定主库失效所需的法定人数数，通常大于哨兵实例数的一半（默认为1）。</p>
<hr>
<h1 id="pgsql"><code>PGSQL</code></h1>
<p><a href="/zh/docs/pgsql"><code>PGSQL</code></a> 模块需要在 Pigsty 管理的节点上安装（即节点已经配置了 <a href="/zh/docs/node"><code>NODE</code></a> 模块），同时还要求您的部署中有一套可用的 <a href="/zh/docs/etcd"><code>ETCD</code></a> 集群来存储集群元数据。</p>
<p>在单个节点上安装 <code>PGSQL</code> 模块将创建一个独立的 PGSQL 服务器/实例，即<a href="/zh/docs/pgsql/config#%E8%AF%BB%E5%86%99%E4%B8%BB%E5%BA%93">主实例</a>。
在额外节点上安装将创建<a href="/zh/docs/pgsql/config#%E5%8F%AA%E8%AF%BB%E4%BB%8E%E5%BA%93">只读副本</a>，可以作为备用实例，并用于承载分担只读请求。
您还可以创建用于 ETL/OLAP/交互式查询的<a href="/zh/docs/pgsql/config#%E7%A6%BB%E7%BA%BF%E4%BB%8E%E5%BA%93">离线</a>实例， 使用<a href="/zh/docs/pgsql/config#%E5%90%8C%E6%AD%A5%E5%A4%87%E5%BA%93">同步备库</a> 和 <a href="/zh/docs/pgsql/config#%E6%B3%95%E5%AE%9A%E4%BA%BA%E6%95%B0%E6%8F%90%E4%BA%A4">法定人数提交</a> 来提高数据一致性，
甚至搭建<a href="/zh/docs/pgsql/config#%E5%A4%87%E4%BB%BD%E9%9B%86%E7%BE%A4">备份集群</a> 和 <a href="/zh/docs/pgsql/config#%E5%BB%B6%E8%BF%9F%E9%9B%86%E7%BE%A4">延迟集群</a> 以快速应对人为失误与软件缺陷导致的数据损失。</p>
<p>您可以定义多个 PGSQL 集群并进一步组建一个水平分片集群： Pigsty 支持原生的 <a href="/zh/docs/pgsql/config#citus%E9%9B%86%E7%BE%A4">citus 集群组</a>，可以将您的标准 PGSQL 集群原地升级为一个分布式的数据库集群。</p>
<hr>
<h2 id="pg_id"><code>PG_ID</code></h2>
<p>以下是一些常用的参数，用于标识 PGSQL 模块中的<a href="/zh/docs/pgsql/arch#%E5%AE%9E%E4%BD%93%E6%A6%82%E5%BF%B5%E5%9B%BE">实体</a>：集群、实例、服务等&hellip;</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># pg_cluster:           #CLUSTER  # pgsql 集群名称，必需的标识参数</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_seq: 0             #INSTANCE # pgsql 实例序列号，必需的标识参数</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_role: replica      #INSTANCE # pgsql 角色，必需的，可以是 primary,replica,offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_instances: {}      #INSTANCE # 在节点上定义多个 pg 实例，使用 `{port:ins_vars}` 格式</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_upstream:          #INSTANCE # 备用集群或级联副本的 repl 上游 ip 地址</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_shard:             #CLUSTER  # pgsql 分片名称，分片集群的可选标识</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_group: 0           #CLUSTER  # pgsql 分片索引号，分片集群的可选标识</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># gp_role: master       #CLUSTER  # 此集群的 greenplum 角色，可以是 master 或 segment</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_offline_query</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#INSTANCE # 设置为 true 以在此实例上启用离线查询</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>您必须显式指定这些<strong>身份参数</strong>，它们没有默认值：</p>
<table>
<thead>
<tr>
<th style="text-align:center">名称</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">级别</th>
<th>扩展说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a></td>
<td style="text-align:center"><code>string</code></td>
<td style="text-align:center"><strong>C</strong></td>
<td><strong>PG 数据库集群名称</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_seq"><code>pg_seq</code></a></td>
<td style="text-align:center"><code>number</code></td>
<td style="text-align:center"><strong>I</strong></td>
<td><strong>PG 数据库实例 ID</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_role"><code>pg_role</code></a></td>
<td style="text-align:center"><code>enum</code></td>
<td style="text-align:center"><strong>I</strong></td>
<td><strong>PG 数据库实例角色</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_shard"><code>pg_shard</code></a></td>
<td style="text-align:center"><code>string</code></td>
<td style="text-align:center"><strong>C</strong></td>
<td><strong>数据库分片名称</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/zh/docs/reference/param/#pg_group"><code>pg_group</code></a></td>
<td style="text-align:center"><code>number</code></td>
<td style="text-align:center"><strong>C</strong></td>
<td><strong>数据库分片序号</strong></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="/zh/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a>: 它标识集群的名称，该名称在集群级别配置。</li>
<li><a href="/zh/docs/reference/param/#pg_role"><code>pg_role</code></a>: 在实例级别配置，标识 ins 的角色。只有 <code>primary</code> 角色会特别处理。如果不填写，默认为 <code>replica</code> 角色和特殊的 <code>delayed</code> 和 <code>offline</code> 角色。</li>
<li><a href="/zh/docs/reference/param/#pg_seq"><code>pg_seq</code></a>: 用于在集群内标识 ins，通常是从 0 或 1 递增的整数，一旦分配就不会更改。</li>
<li><code>{{ pg_cluster }}-{{ pg_seq }}</code> 用于唯一标识 ins，即 <code>pg_instance</code>。</li>
<li><code>{{ pg_cluster }}-{{ pg_role }}</code> 用于标识集群内的服务，即 <code>pg_service</code>。</li>
<li><a href="/zh/docs/reference/param/#pg_shard"><code>pg_shard</code></a> 和 <a href="/zh/docs/reference/param/#pg_group"><code>pg_group</code></a> 用于水平分片集群，仅用于 citus、greenplum 和 matrixdb。</li>
</ul>
<p><a href="/zh/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a>、<a href="/zh/docs/reference/param/#pg_role"><code>pg_role</code></a>、<a href="/zh/docs/reference/param/#pg_seq"><code>pg_seq</code></a> 是核心<strong>标识参数</strong>，对于任何 Postgres 集群都是<strong>必选</strong>的，并且必须显式指定。以下是一个示例：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg-test</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 2, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">primary}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 3, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>所有其他参数都可以从全局配置或默认配置继承，但标识参数必须<strong>明确指定</strong>和<strong>手动分配</strong>。</p>
<h3 id="pg_mode"><code>pg_mode</code></h3>
<p>参数名称： <code>pg_mode</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>PostgreSQL 集群模式，默认值为 <code>pgsql</code>，即标准的 PostgreSQL 集群。</p>
<p>可用的模式选项包括：</p>
<ul>
<li><code>pgsql</code>：标准的 PostgreSQL 集群</li>
<li><code>citus</code>：Citus 分布式数据库集群</li>
<li><code>mssql</code>：Babelfish MSSQL 线缆协议兼容内核</li>
<li><code>ivory</code>：IvorySQL Oracle 兼容内核</li>
<li><code>polar</code>：PolarDB for PostgreSQL 内核</li>
<li><code>oracle</code>：PolarDB for Oracle 内核</li>
<li><code>gpsql</code>：Greenplum 并行数据库集群（监控）</li>
</ul>
<p>如果 <code>pg_mode</code> 设置为 <code>citus</code> 或 <code>gpsql</code>，则需要两个额外的必选身份参数 <a href="/zh/docs/reference/param/#pg_shard"><code>pg_shard</code></a> 和 <a href="/zh/docs/reference/param/#pg_group"><code>pg_group</code></a> 来定义水平分片集群的身份。</p>
<p>在这两种情况下，每一个 PostgreSQL 集群都是一组更大的业务单元的一部分。</p>
<h3 id="pg_cluster"><code>pg_cluster</code></h3>
<p>参数名称： <code>pg_cluster</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>PostgreSQL 集群名称，必选的身份标识参数,没有默认值</p>
<p>集群名将用作资源的命名空间。</p>
<p>集群命名需要遵循特定的命名模式：<code>[a-z][a-z0-9-]*</code>，即，只使用数字与小写字母，且不以数字开头，以符合标识上的不同约束的要求。</p>
<h3 id="pg_seq"><code>pg_seq</code></h3>
<p>参数名称： <code>pg_seq</code>， 类型： <code>int</code>， 层次：<code>I</code></p>
<p>PostgreSQL 实例序列号，必选的身份标识参数，无默认值。</p>
<p>此实例的序号，在其<strong>集群</strong>内是唯一分配的，通常使用自然数，从0或1开始分配，通常不会回收重用。</p>
<h3 id="pg_role"><code>pg_role</code></h3>
<p>参数名称： <code>pg_role</code>， 类型： <code>enum</code>， 层次：<code>I</code></p>
<p>PostgreSQL 实例角色，必选的身份标识参数，无默认值。取值可以是：<code>primary</code>, <code>replica</code>, <code>offline</code></p>
<p>PGSQL 实例的角色，可以是：<code>primary</code>、<code>replica</code>、<code>standby</code> 或 <code>offline</code>。</p>
<ul>
<li><code>primary</code>: 主实例，在集群中有且仅有一个。</li>
<li><code>replica</code>: 用于承载在线只读流量的副本，高负载下可能会有轻微复制延迟（10ms~100ms, 100KB）。</li>
<li><code>offline</code>: 用于处理离线只读流量的离线副本，如统计分析/ETL/个人查询等。</li>
</ul>
<h3 id="pg_instances"><code>pg_instances</code></h3>
<p>参数名称： <code>pg_instances</code>， 类型： <code>dict</code>， 层次：<code>I</code></p>
<p>使用 <code>{port:ins_vars}</code> 的形式在一台主机上定义多个 PostgreSQL 实例。</p>
<p>此参数是为在单个节点上的多实例部署保留的参数，Pigsty 尚未实现此功能，并强烈建议独占节点部署。</p>
<h3 id="pg_upstream"><code>pg_upstream</code></h3>
<p>参数名称： <code>pg_upstream</code>， 类型： <code>ip</code>， 层次：<code>I</code></p>
<p><a href="/zh/docs/pgsql/config#%E5%A4%87%E4%BB%BD%E9%9B%86%E7%BE%A4">备份集群</a>或级联从库的上游实例 IP 地址。</p>
<p>在集群的 <code>primary</code> 实例上设置 <code>pg_upstream</code> ，表示此集群是一个<a href="/zh/docs/pgsql/config#%E5%A4%87%E4%BB%BD%E9%9B%86%E7%BE%A4">备份集群</a>，该实例将作为 <code>standby leader</code>，从上游集群接收并应用更改。</p>
<p>对非 <code>primary</code> 实例设置 <code>pg_upstream</code> 参数将指定一个具体实例作为物理复制的上游，如果与主实例 ip 地址不同，此实例将成为 <strong>级联副本</strong> 。确保上游 IP 地址是同一集群中的另一个实例是用户的责任。</p>
<h3 id="pg_shard"><code>pg_shard</code></h3>
<p>参数名称： <code>pg_shard</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>PostgreSQL 水平分片名称，对于分片集群来说（例如 citus 集群），这是的必选标识参数。</p>
<p>当多个标准的 PostgreSQL 集群一起以水平分片方式为同一业务提供服务时，Pigsty 将此组集群标记为 <strong>水平分片集群</strong>。</p>
<p><a href="/zh/docs/reference/param/#pg_shard"><code>pg_shard</code></a> 是分片组名称。它通常是 <a href="/zh/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a> 的前缀。</p>
<p>例如，如果我们有一个分片组 <code>pg-citus</code>，并且其中有4个集群，它们的标识参数将是：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>cls pg_shard: pg-citus
</span></span><span style="display:flex;"><span>cls pg_group = 0:   pg-citus0
</span></span><span style="display:flex;"><span>cls pg_group = 1:   pg-citus1
</span></span><span style="display:flex;"><span>cls pg_group = 2:   pg-citus2
</span></span><span style="display:flex;"><span>cls pg_group = 3:   pg-citus3
</span></span></code></pre></div><h3 id="pg_group"><code>pg_group</code></h3>
<p>参数名称： <code>pg_group</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>PostgreSQL 水平分片集群的分片索引号，对于分片集群来说（例如 citus 集群），这是的必选标识参数。</p>
<p>此参数与 <a href="/zh/docs/reference/param/#pg_shard">pg_shard</a> 配对使用，通常可以使用非负整数作为索引号。</p>
<h3 id="gp_role"><code>gp_role</code></h3>
<p>参数名称： <code>gp_role</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>PostgreSQL 集群的 Greenplum/Matrixdb 角色，可以是 <code>master</code> 或 <code>segment</code>。</p>
<ul>
<li><code>master</code>: 标记 postgres 集群为 greenplum 主实例（协调节点），这是默认值。</li>
<li><code>segment</code> 标记 postgres 集群为 greenplum 段集群（数据节点）。</li>
</ul>
<p>此参数仅用于 Greenplum/MatrixDB 数据库 （<a href="/zh/docs/reference/param/#pg_mode"><code>pg_mode</code></a> 为 <code>gpsql</code>），对于普通的 PostgreSQL 集群没有意义。</p>
<h3 id="pg_exporters"><code>pg_exporters</code></h3>
<p>参数名称： <code>pg_exporters</code>， 类型： <code>dict</code>， 层次：<code>C</code></p>
<p>额外用于<a href="/zh/docs/pgsql/monitor">监控</a>远程 PostgreSQL 实例的 Exporter 定义，默认值：<code>{}</code></p>
<p>如果您希望监控远程 PostgreSQL 实例，请在监控系统所在节点（Infra节点）集群上的 <code>pg_exporters</code> 参数中定义它们，并使用 <a href="/zh/docs/pgsql/playbook#pgsql-monitoryml"><code>pgsql-monitor.yml</code></a> 剧本来完成部署。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_exporters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># list all remote instances here, alloc a unique unused local port as k</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">20001</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_cluster: pg-foo, pg_seq: 1, pg_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.10</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">20004</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_cluster: pg-foo, pg_seq: 2, pg_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.11</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">20002</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_cluster: pg-bar, pg_seq: 1, pg_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.12</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">20003</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_cluster: pg-bar, pg_seq: 1, pg_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.13</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_offline_query"><code>pg_offline_query</code></h3>
<p>参数名称： <code>pg_offline_query</code>， 类型： <code>bool</code>， 层次：<code>I</code></p>
<p>设置为 <code>true</code> 以在此实例上启用离线查询，默认为 <code>false</code>。</p>
<p>当某个 PostgreSQL 实例启用此参数时， 属于 <code>dbrole_offline</code> 分组的用户可以直接连接到该 PostgreSQL 实例上执行离线查询（慢查询，交互式查询，ETL/分析类查询）。</p>
<p>带有此标记的实例在效果上类似于为实例设置 <code>pg_role</code> = <code>offline</code> ，唯一的区别在于 <code>offline</code> 实例默认不会承载 <code>replica</code> 服务的请求，是作为专用的离线/分析从库实例而存在的。</p>
<p>如果您没有富余的实例可以专门用于此目的，则可以挑选一台普通的从库，在实例层次启用此参数，以便在需要时承载离线查询。</p>
<hr>
<h2 id="pg_business"><code>PG_BUSINESS</code></h2>
<p>定制集群模板：用户，数据库，服务，权限规则。</p>
<p>用户需<strong>重点关注</strong>此部分参数，因为这里是业务声明自己所需数据库对象的地方。</p>
<ul>
<li>业务用户定义： <a href="/zh/docs/reference/param/#pg_users"><code>pg_users</code></a></li>
<li>业务数据库定义： <a href="/zh/docs/reference/param/#pg_databases"><code>pg_databases</code></a></li>
<li>集群专有服务定义： <a href="/zh/docs/reference/param/#pg_services"><code>pg_services</code></a> （全局定义：<a href="/zh/docs/reference/param/#pg_default_services"><code>pg_default_services</code></a>）</li>
<li>PostgreSQL集群/实例特定的HBA规则： <a href="/zh/docs/reference/param/#pg_default_services"><code>pg_default_services</code></a></li>
<li>Pgbouncer连接池特定HBA规则： <a href="/zh/docs/reference/param/#pgb_hba_rules"><code>pgb_hba_rules</code></a></li>
</ul>
<p><a href="/zh/docs/pgsql/acl#%E9%BB%98%E8%AE%A4%E7%94%A8%E6%88%B7">默认</a>的数据库用户及其凭据，强烈建议在生产环境中修改这些用户的密码。</p>
<ul>
<li>PG管理员用户：<a href="/zh/docs/reference/param/#pg_admin_username"><code>pg_admin_username</code></a> / <a href="/zh/docs/reference/param/#pg_admin_password"><code>pg_admin_password</code></a></li>
<li>PG复制用户： <a href="/zh/docs/reference/param/#pg_replication_username"><code>pg_replication_username</code></a> / <a href="/zh/docs/reference/param/#pg_replication_password"><code>pg_replication_password</code></a></li>
<li>PG监控用户：<a href="/zh/docs/reference/param/#pg_monitor_username"><code>pg_monitor_username</code></a> / <a href="/zh/docs/reference/param/#pg_monitor_password"><code>pg_monitor_password</code></a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># postgres business object definition, overwrite in group vars</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># postgres business users</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># postgres business databases</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># postgres business services</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># business hba rules for postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgb_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># business hba rules for pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># global credentials, overwrite in global vars</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># dbsu password, empty string means no dbsu password by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_replication_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_replication_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_dba</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.DBA</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_monitor_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_monitor_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_users"><code>pg_users</code></h3>
<p>参数名称： <code>pg_users</code>， 类型： <code>user[]</code>， 层次：<code>C</code></p>
<p>PostgreSQL 业务用户列表，需要在 PG 集群层面进行定义。默认值为：<code>[]</code> 空列表。</p>
<p>每一个数组元素都是一个 <a href="/zh/docs/pgsql/user">用户/角色</a> 定义，例如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_meta              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 必需，`name` 是用户定义的唯一必选字段</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Meta          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，密码，可以是 scram-sha-256 哈希字符串或明文</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">login</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># 可选，默认情况下可以登录</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">superuser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># 可选，默认为 false，是超级用户吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">createdb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># 可选，默认为 false，可以创建数据库吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># 可选，默认为 false，可以创建角色吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">inherit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># 可选，默认情况下，此角色可以使用继承的权限吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">replication</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># 可选，默认为 false，此角色可以进行复制吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">bypassrls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># 可选，默认为 false，此角色可以绕过行级安全吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># 可选，默认为 false，将此用户添加到 pgbouncer 用户列表吗？（使用连接池的生产用户应该显式定义为 true）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># 可选，用户连接限制，默认 -1 禁用限制</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">expire_in</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3650</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># 可选，此角色过期时间：从创建时 + n天计算（优先级比 expire_at 更高）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">expire_at</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;2030-12-31&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># 可选，此角色过期的时间点，使用 YYYY-MM-DD 格式的字符串指定一个特定日期（优先级没 expire_in 高）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty admin user     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，此用户/角色的说明与备注字符串</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_admin]          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，默认角色为：dbrole_{admin,readonly,readwrite,offline}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># 可选，使用 `ALTER ROLE SET` 针对这个角色，配置角色级的数据库参数</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">transaction         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，默认为 transaction 的 pgbouncer 池模式，用户级别</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># 可选，用户级别的最大数据库连接数，默认 -1 禁用限制</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">search_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，根据 postgresql 文档的键值配置参数（例如：使用 pigsty 作为默认 search_path）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_databases"><code>pg_databases</code></h3>
<p>参数名称： <code>pg_databases</code>， 类型： <code>database[]</code>， 层次：<code>C</code></p>
<p>PostgreSQL 业务数据库列表，需要在 PG 集群层面进行定义。默认值为：<code>[]</code> 空列表。</p>
<p>每一个数组元素都是一个 <a href="/zh/docs/pgsql/db">业务数据库</a> 定义，例如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 必选，`name` 是数据库定义的唯一必选字段</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">baseline</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cmdb.sql             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，数据库 sql 的基线定义文件路径（ansible 搜索路径中的相对路径，如 files/）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># 可选，是否将此数据库添加到 pgbouncer 数据库列表？默认为 true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">pigsty]              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，要创建的附加模式，由模式名称字符串组成的数组</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># 可选，要安装的附加扩展： 扩展对象的数组</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgis , schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public } </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可以指定将扩展安装到某个模式中，也可以不指定（不指定则安装到 search_path 首位模式中）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">timescaledb }              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 例如有的扩展会创建并使用固定的模式，就不需要指定模式。</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty meta database  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，数据库的说明与备注信息</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">owner</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，数据库所有者，默认为 postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">template1            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，要使用的模板，默认为 template1，目标必须是一个模板数据库</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，数据库编码，默认为 UTF8（必须与模板数据库相同）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，数据库地区设置，默认为 C（必须与模板数据库相同）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">lc_collate</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，数据库 collate 排序规则，默认为 C（必须与模板数据库相同），没有理由不建议更改。</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">lc_ctype</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，数据库 ctype 字符集，默认为 C（必须与模板数据库相同）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">tablespace</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_default         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，默认表空间，默认为 &#39;pg_default&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">allowconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># 可选，是否允许连接，默认为 true。显式设置 false 将完全禁止连接到此数据库</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">revokeconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># 可选，撤销公共连接权限。默认为 false，设置为 true 时，属主和管理员之外用户的 CONNECT 权限会被回收</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">register_datasource</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># 可选，是否将此数据库注册到 grafana 数据源？默认为 true，显式设置为 false 会跳过注册</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># 可选，数据库连接限制，默认为 -1 ，不限制，设置为正整数则会限制连接数。</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_auth_user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_meta    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，连接到此 pgbouncer 数据库的所有连接都将使用此用户进行验证（启用 pgbouncer_auth_query 才有用）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">transaction         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，数据库级别的 pgbouncer 池化模式，默认为 transaction</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_size</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">64</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># 可选，数据库级别的 pgbouncer 默认池子大小，默认为 64</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_size_reserve</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">32</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># 可选，数据库级别的 pgbouncer 池子保留空间，默认为 32，当默认池子不够用时，最多再申请这么多条突发连接。</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_size_min</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># 可选，数据库级别的 pgbouncer 池的最小大小，默认为 0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_max_db_conn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># 可选，数据库级别的最大数据库连接数，默认为 100</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>在每个数据库定义对象中，只有 <code>name</code> 是必选字段，其他的字段都是可选项。</p>
<h3 id="pg_services"><code>pg_services</code></h3>
<p>参数名称： <code>pg_services</code>， 类型： <code>service[]</code>， 层次：<code>C</code></p>
<p>PostgreSQL 服务列表，需要在 PG 集群层面进行定义。默认值为：<code>[]</code> ，空列表。</p>
<p>用于在数据库集群层面定义额外的服务，数组中的每一个对象定义了一个<a href="/zh/docs/pgsql/svc#%E5%AE%9A%E4%B9%89%E6%9C%8D%E5%8A%A1">服务</a>，一个完整的服务定义样例如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">standby                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 必选，服务名称，最终的 svc 名称会使用 `pg_cluster` 作为前缀，例如：pg-meta-standby</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5435</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># 必选，暴露的服务端口（作为 kubernetes 服务节点端口模式）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># 可选，服务绑定的 IP 地址，默认情况下为所有 IP 地址</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># 必选，服务成员选择器，使用 JMESPath 来筛选配置清单</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary`]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># 可选，服务成员选择器（备份），也就是当默认选择器选中的实例都宕机后，服务才会由这里选中的实例成员来承载</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">dest</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，目标端口，default|postgres|pgbouncer|&lt;port_number&gt;，默认为 &#39;default&#39;，Default的意思就是使用 pg_default_service_dest 的取值来最终决定</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">check</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/sync                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，健康检查 URL 路径，默认为 /，这里使用 Patroni API：/sync ，只有同步备库和主库才会返回 200 健康状态码 </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">maxconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5000</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># 可选，允许的前端连接最大数，默认为5000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">balance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">roundrobin            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 可选，haproxy 负载均衡算法（默认为 roundrobin，其他选项：leastconn）</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;inter 3s fastinter 1s downinter 5s rise 3 fall 3 on-marked-down shutdown-sessions slowstart 30s maxconn 3000 maxqueue 128 weight 100&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>请注意，本参数用于在集群层面添加额外的服务。如果您想在全局定义所有 PostgreSQL 数据库都要提供的服务，可以使用 <a href="/zh/docs/reference/param/#pg_default_services"><code>pg_default_services</code></a> 参数。</p>
<h3 id="pg_hba_rules"><code>pg_hba_rules</code></h3>
<p>参数名称： <code>pg_hba_rules</code>， 类型： <code>hba[]</code>， 层次：<code>C</code></p>
<p>数据库集群/实例的客户端IP黑白名单规则。默认为：<code>[]</code> 空列表。</p>
<p>对象数组，每一个对象都代表一条规则， <a href="/zh/docs/pgsql/hba#%E5%AE%9A%E4%B9%89hba">hba</a> 规则对象的定义形式如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow intranet password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">host   all  all  10.0.0.0/8      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">host   all  all  172.16.0.0/12   md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">host   all  all  192.168.0.0/16  md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><ul>
<li><code>title</code>： 规则的标题名称，会被渲染为 HBA 文件中的注释。</li>
<li><code>rules</code>：规则数组，每个元素是一条标准的 HBA 规则字符串。</li>
<li><code>role</code>：规则的应用范围，哪些实例角色会启用这条规则？
<ul>
<li><code>common</code>：对于所有实例生效</li>
<li><code>primary</code>, <code>replica</code>,<code>offline</code>： 只针对特定的角色 <a href="/zh/docs/reference/param/#pg_role"><code>pg_role</code></a> 实例生效。</li>
<li>特例：<code>role: 'offline'</code> 的规则除了会应用在 <code>pg_role : offline</code> 的实例上，对于带有 <a href="/zh/docs/reference/param/#pg_offline_query"><code>pg_offline_query</code></a> 标记的实例也生效。</li>
</ul>
</li>
</ul>
<p>除了上面这种原生 HBA 规则定义形式，Pigsty 还提供了另外一种更为简便的别名形式：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">addr</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;intra&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># world|intra|infra|admin|local|localhost|cluster|&lt;cidr&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">auth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># trust|pwd|ssl|cert|deny|&lt;official auth method&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;all&#39;</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># all|${dbsu}|${repl}|${admin}|${monitor}|&lt;user&gt;|&lt;group&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">db</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;all&#39;</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># all|replication|....</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># raw hba string precedence over above all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow intranet password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><a href="/zh/docs/reference/param/#pg_default_hba_rules"><code>pg_default_hba_rules</code></a> 与本参数基本类似，但它是用于定义全局的 HBA 规则，而本参数通常用于定制某个集群/实例的 HBA 规则。</p>
<h3 id="pgb_hba_rules"><code>pgb_hba_rules</code></h3>
<p>参数名称： <code>pgb_hba_rules</code>， 类型： <code>hba[]</code>， 层次：<code>C</code></p>
<p>Pgbouncer 业务HBA规则，默认值为： <code>[]</code>， 空数组。</p>
<p>此参数与 <a href="/zh/docs/reference/param/#pg_hba_rules"><code>pg_hba_rules</code></a> 基本类似，都是 <a href="/zh/docs/pgsql/hba#define-hba">hba</a> 规则对象的数组，区别在于本参数是为 Pgbouncer 准备的。</p>
<p><a href="/zh/docs/reference/param/#pgb_default_hba_rules"><code>pgb_default_hba_rules</code></a> 与本参数基本类似，但它是用于定义全局连接池 HBA 规则，而本参数通常用于定制某个连接池集群/实例的 HBA 规则。</p>
<h3 id="pg_replication_username"><code>pg_replication_username</code></h3>
<p>参数名称： <code>pg_replication_username</code>， 类型： <code>username</code>， 层次：<code>G</code></p>
<p>PostgreSQL 物理复制用户名，默认使用 <code>replicator</code>，不建议修改此参数。</p>
<h3 id="pg_replication_password"><code>pg_replication_password</code></h3>
<p>参数名称： <code>pg_replication_password</code>， 类型： <code>password</code>， 层次：<code>G</code></p>
<p>PostgreSQL 物理复制用户密码，默认值为：<code>DBUser.Replicator</code>。</p>
<blockquote>
<p>警告：请在生产环境中修改此密码！</p>
</blockquote>
<h3 id="pg_admin_username"><code>pg_admin_username</code></h3>
<p>参数名称： <code>pg_admin_username</code>， 类型： <code>username</code>， 层次：<code>G</code></p>
<p>PostgreSQL / Pgbouncer 管理员名称，默认为：<code>dbuser_dba</code>。</p>
<p>这是全局使用的数据库管理员，具有数据库的 Superuser 权限与连接池的流量管理权限，请务必控制使用范围。</p>
<h3 id="pg_admin_password"><code>pg_admin_password</code></h3>
<p>参数名称： <code>pg_admin_password</code>， 类型： <code>password</code>， 层次：<code>G</code></p>
<p>PostgreSQL / Pgbouncer 管理员密码，默认为： <code>DBUser.DBA</code>。</p>
<blockquote>
<p>警告：请在生产环境中修改此密码！</p>
</blockquote>
<h3 id="pg_monitor_username"><code>pg_monitor_username</code></h3>
<p>参数名称： <code>pg_monitor_username</code>， 类型： <code>username</code>， 层次：<code>G</code></p>
<p>PostgreSQL/Pgbouncer 监控用户名，默认为：<code>dbuser_monitor</code>。</p>
<p>这是一个用于监控的数据库/连接池用户，不建议修改此用户名。</p>
<p>但如果您的现有数据库使用了不同的监控用户，可以在指定监控目标时使用此参数传入使用的监控用户名。</p>
<h3 id="pg_monitor_password"><code>pg_monitor_password</code></h3>
<p>参数名称： <code>pg_monitor_password</code>， 类型： <code>password</code>， 层次：<code>G</code></p>
<p>PostgreSQL/Pgbouncer 监控用户使用的密码，默认为：<code>DBUser.Monitor</code>。</p>
<p>请尽可能不要在密码中使用 <code>@:/</code> 这些容易与 URL 分隔符混淆的字符，减少不必要的麻烦。</p>
<blockquote>
<p>警告：请在生产环境中修改此密码！</p>
</blockquote>
<h3 id="pg_dbsu_password"><code>pg_dbsu_password</code></h3>
<p>参数名称： <code>pg_dbsu_password</code>， 类型： <code>password</code>， 层次：<code>G/C</code></p>
<p>PostgreSQL <a href="/zh/docs/reference/param/#pg_dbsu"><code>pg_dbsu</code></a> 超级用户密码，默认是空字符串，即不为其设置密码。</p>
<p>我们不建议为 dbsu 配置密码登陆，这会增大攻击面。例外情况是：<a href="/zh/docs/reference/param/#pg_mode"><code>pg_mode</code></a> = <code>citus</code>，这时候需要为每个分片集群的 dbsu 配置密码，以便在分片集群内部进行连接。</p>
<hr>
<h2 id="pg_install"><code>PG_INSTALL</code></h2>
<p>本节负责安装 PostgreSQL 及其扩展。如果您希望安装不同大版本与扩展插件，修改 <a href="/zh/docs/reference/param/#pg_version"><code>pg_version</code></a> 与 <a href="/zh/docs/reference/param/#pg_extensions"><code>pg_extensions</code></a> 即可，不过请注意，并不是所有扩展都在所有大版本可用。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_dbsu</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># os 数据库超级用户名称，默认为 postgres，最好不要更改</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_uid</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">26</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># os 数据库超级用户 uid 和 gid，默认为 26，适用于默认的 postgres 用户和组</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_sudo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">limit              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 数据库超级用户 sudo 权限，可选 none,limit,all,nopass。默认为 limit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_home</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/var/lib/pgsql     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgresql 主目录，默认为 `/var/lib/pgsql`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_ssh_exchange</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># 是否在相同的 pgsql 集群中交换 postgres 数据库超级用户的 ssh 密钥</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">16</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># 要安装的 postgres 主版本，默认为 15</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_bin_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/usr/pgsql/bin       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres 二进制目录，默认为 `/usr/pgsql/bin`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_log_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/log/postgres     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres 日志目录，默认为 `/pg/log/postgres`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># pg packages to be installed, alias can be used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">postgresql</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager wal2json pg_repack</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># pg extensions to be installed, alias can be used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">postgis timescaledb pgvector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_dbsu"><code>pg_dbsu</code></h3>
<p>参数名称： <code>pg_dbsu</code>， 类型： <code>username</code>， 层次：<code>C</code></p>
<p>PostgreSQL 使用的操作系统 dbsu 用户名， 默认为 <code>postgres</code>，改这个用户名是不太明智的。</p>
<p>不过在特定情况下，您可能会使用到不同于 <code>postgres</code> 的用户名，例如在安装配置 Greenplum / MatrixDB 时，需要使用 <code>gpadmin</code> / <code>mxadmin</code> 作为相应的操作系统超级用户。</p>
<h3 id="pg_dbsu_uid"><code>pg_dbsu_uid</code></h3>
<p>参数名称： <code>pg_dbsu_uid</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>操作系统数据库超级用户的 uid 和 gid，<code>26</code> 是 PGDG RPM 默认的 postgres 用户 UID/GID。</p>
<p>对于 Debian/Ubuntu 系统，没有默认值，且 <code>26</code> 号用户经常被占用。因此Pigsty 在检测到安装环境为 Debian 系，且 uid 为 <code>26</code> 时，会自动使用替换的 <code>pg_dbsu_uid = 543</code>。</p>
<h3 id="pg_dbsu_sudo"><code>pg_dbsu_sudo</code></h3>
<p>参数名称： <code>pg_dbsu_sudo</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>数据库超级用户的 sudo 权限，可以是 <code>none</code>、<code>limit</code>、<code>all</code> 或 <code>nopass</code>。默认为 <code>limit</code></p>
<ul>
<li>
<p><code>none</code>: 无 Sudo 权限</p>
</li>
<li>
<p><code>limit</code>: 有限的 sudo 权限，用于执行与数据库相关的组件的 <code>systemctl</code> 命令（默认选项）。</p>
</li>
<li>
<p><code>all</code>: 完全的 <code>sudo</code> 权限，需要密码。</p>
</li>
<li>
<p><code>nopass</code>: 不需要密码的完全 <code>sudo</code> 权限（不推荐）。</p>
</li>
<li>
<p>默认值为 <code>limit</code>，只允许执行 <code>sudo systemctl &lt;start|stop|reload&gt; &lt;postgres|patroni|pgbouncer|...&gt; </code>。</p>
</li>
</ul>
<h3 id="pg_dbsu_home"><code>pg_dbsu_home</code></h3>
<p>参数名称： <code>pg_dbsu_home</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>postgresql 主目录，默认为 <code>/var/lib/pgsql</code>，与官方的 pgdg RPM 保持一致。</p>
<h3 id="pg_dbsu_ssh_exchange"><code>pg_dbsu_ssh_exchange</code></h3>
<p>参数名称： <code>pg_dbsu_ssh_exchange</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否在同一 PostgreSQL 集群中交换操作系统 dbsu 的 ssh 密钥？</p>
<p>默认值为 <code>true</code>，意味着同一集群中的数据库超级用户可以互相 ssh 访问。</p>
<h3 id="pg_version"><code>pg_version</code></h3>
<p>参数名称： <code>pg_version</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>要安装的 postgres 主版本，默认为 <code>16</code>。</p>
<p>请注意，PostgreSQL 的物理流复制不能跨主要版本，因此最好不要在实例级别上配置此项。</p>
<p>您可以使用 <a href="/zh/docs/reference/param/#pg_packages"><code>pg_packages</code></a> 和 <a href="/zh/docs/reference/param/#pg_extensions"><code>pg_extensions</code></a> 中的参数来为特定的 PG 大版本安装不同的软件包与扩展。</p>
<h3 id="pg_bin_dir"><code>pg_bin_dir</code></h3>
<p>参数名称： <code>pg_bin_dir</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>PostgreSQL 二进制程序目录，默认为 <code>/usr/pgsql/bin</code>。</p>
<p>默认值是在安装过程中手动创建的软链接，指向安装的特定的 Postgres 版本目录。</p>
<p>例如 <code>/usr/pgsql -&gt; /usr/pgsql-15</code>。在 Ubuntu/Debian 上则指向 <code>/usr/lib/postgresql/15/bin</code>。</p>
<p>更多详细信息，请查看 <a href="/zh/docs/fhs#postgres-fhs">PGSQL 文件结构</a>。</p>
<h3 id="pg_log_dir"><code>pg_log_dir</code></h3>
<p>参数名称： <code>pg_log_dir</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>PostgreSQL 日志目录，默认为：<code>/pg/log/postgres</code>，<a href="/zh/docs/reference/param/#promtail">Promtail</a> 会使用此变量收集 PostgreSQL 日志。</p>
<p>请注意，如果日志目录 <a href="/zh/docs/reference/param/#pg_log_dir"><code>pg_log_dir</code></a> 以数据库目录 <a href="/zh/docs/reference/param/#pg_data"><code>pg_data</code></a> 作为前缀，则不会显式创建（数据库目录初始化时自动创建）。</p>
<h3 id="pg_packages"><code>pg_packages</code></h3>
<p>参数名称： <code>pg_packages</code>， 类型： <code>string[]</code>， 层次：<code>C</code></p>
<p>要安装的 PostgreSQL 软件包（rpm/deb），这是一个由软件包名组成的数组，每个元素都是逗号或空格分割的 PG 软件包名。</p>
<p>默认值为 PostgreSQL 内核，以及支持 PG RDS 的核心组件，以及两个重要的扩展插件 <code>pg_repack</code> 与 <code>wal2json</code>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># pg packages to be installed, alias can be used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">postgresql</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager wal2json pg_repack</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>从 Pigsty v3 开始，您可以在本参数中使用<a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> 中由 <code>pg_package_map</code> 指定的包别名。</p>
<p>使用包别名的好处是，您无需操心 PostgreSQL 相关软件包在不同系统平台上的包名，架构，以及大版本号，从而屏蔽了不同 OS 之间的区别：</p>
<p>定义在这里的软件包会首先经过 <code>pg_package_map</code> 的翻译，然后经过 PG 大版本号的替换，最后安装实际的 RPM/DEB 包。</p>
<p>您也可以直接指定最终安装的 RPM/DEB 包名称，包名中的 <code>${pg_version}</code> 或 <code>$v</code> 版本号占位符将被替换为具体的大版本号  <a href="/zh/docs/reference/param/#pg_version"><code>pg_version</code></a> 。</p>
<h3 id="pg_extensions"><code>pg_extensions</code></h3>
<p>参数名称： <code>pg_extensions</code>， 类型： <code>string[]</code>， 层次：<code>G/C</code></p>
<p>要安装的 PostgreSQL 扩展包（rpm/deb），这是一个由扩展包名组成的数组，每个元素都是逗号或空格分割的 PG 扩展包名。</p>
<p>本参数在形式上与 <a href="/zh/docs/reference/param/#pg_packages"><code>pg_packages</code></a> 一致，但是通常用于指定需要安装的扩展插件，而且在这里指定的软件包会升级到可用的最新版本。</p>
<p>本参数的默认值为 PG 扩展生态最重要的三个扩展插件：<code>postgis</code>, <code>timescaledb</code>, <code>pgvector</code>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># pg extensions to be installed, alias can be used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">postgis timescaledb pgvector </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 注意：在 EL7 中，postgis 应该使用 postgis33 代替</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>完整可用的扩展列表，已经在 Pigsty 默认生成的配置文件中给出，用户按需使用即可。例如，以下是 EL9 中可用的扩展插件列表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pg_extensions: <span style="color:#8f5902;font-style:italic"># extensions to be installed on this cluster</span>
</span></span><span style="display:flex;"><span>  - timescaledb periods temporal_tables emaj table_version pg_cron pg_later pg_background pg_timetable
</span></span><span style="display:flex;"><span>  - postgis pgrouting pointcloud pg_h3 q3c ogr_fdw geoip <span style="color:#8f5902;font-style:italic">#pg_geohash #mobilitydb</span>
</span></span><span style="display:flex;"><span>  - pgvector pgvectorscale pg_vectorize pg_similarity pg_tiktoken pgml <span style="color:#8f5902;font-style:italic">#smlar</span>
</span></span><span style="display:flex;"><span>  - pg_search pg_bigm zhparser hunspell
</span></span><span style="display:flex;"><span>  - hydra pg_analytics pg_lakehouse pg_duckdb duckdb_fdw pg_fkpart pg_partman plproxy <span style="color:#8f5902;font-style:italic">#pg_strom citus</span>
</span></span><span style="display:flex;"><span>  - pg_hint_plan age hll rum pg_graphql pg_jsonschema jsquery index_advisor hypopg imgsmlr pg_ivm pgmq pgq <span style="color:#8f5902;font-style:italic">#rdkit</span>
</span></span><span style="display:flex;"><span>  - pg_tle plv8 pllua plprql pldebugger plpgsql_check plprofiler plsh <span style="color:#8f5902;font-style:italic">#pljava plr pgtap faker dbt2</span>
</span></span><span style="display:flex;"><span>  - prefix semver pgunit md5hash asn1oid roaringbitmap pgfaceting pgsphere pg_country pg_currency pgmp numeral pg_rational pguint ip4r timestamp9 chkpass <span style="color:#8f5902;font-style:italic">#pg_uri #pgemailaddr #acl #debversion #pg_rrule</span>
</span></span><span style="display:flex;"><span>  - topn pg_gzip pg_http pg_net pg_html5_email_address pgsql_tweaks pg_extra_time pg_timeit count_distinct extra_window_functions first_last_agg tdigest aggs_for_arrays pg_arraymath pg_idkit pg_uuidv7 permuteseq pg_hashids
</span></span><span style="display:flex;"><span>  - sequential_uuids pg_math pg_random pg_base36 pg_base62 floatvec pg_financial pgjwt pg_hashlib shacrypt cryptint pg_ecdsa pgpcre icu_ext envvar url_encode <span style="color:#8f5902;font-style:italic">#pg_zstd #aggs_for_vecs #quantile #lower_quantile #pgqr #pg_protobuf</span>
</span></span><span style="display:flex;"><span>  - pg_repack pg_squeeze pg_dirtyread pgfincore pgdd ddlx pg_prioritize pg_checksums pg_readonly safeupdate pg_permissions pgautofailover pg_catcheck preprepare pgcozy pg_orphaned pg_crash pg_cheat_funcs pg_savior table_log pg_fio <span style="color:#8f5902;font-style:italic">#pgpool pgagent</span>
</span></span><span style="display:flex;"><span>  - pg_profile pg_show_plans pg_stat_kcache pg_stat_monitor pg_qualstats pg_store_plans pg_track_settings pg_wait_sampling system_stats pg_meta pgnodemx pg_sqlog bgw_replstatus pgmeminfo toastinfo pagevis powa pg_top <span style="color:#8f5902;font-style:italic">#pg_statviz #pgexporter_ext #pg_mon</span>
</span></span><span style="display:flex;"><span>  - passwordcheck supautils pgsodium pg_vault anonymizer pg_tde pgsmcrypto pgaudit pgauditlogtofile pg_auth_mon credcheck pgcryptokey pg_jobmon logerrors login_hook set_user pg_snakeoil pgextwlist pg_auditor noset <span style="color:#8f5902;font-style:italic">#sslutils</span>
</span></span><span style="display:flex;"><span>  - wrappers multicorn odbc_fdw mysql_fdw tds_fdw sqlite_fdw pgbouncer_fdw mongo_fdw redis_fdw pg_redis_pubsub kafka_fdw hdfs_fdw firebird_fdw aws_s3 log_fdw <span style="color:#8f5902;font-style:italic">#oracle_fdw #db2_fdw #jdbc_fdw</span>
</span></span><span style="display:flex;"><span>  - orafce pgtt session_variable pg_statement_rollback pg_dbms_metadata pg_dbms_lock pgmemcache <span style="color:#8f5902;font-style:italic">#pg_dbms_job #wiltondb</span>
</span></span><span style="display:flex;"><span>  - pglogical pgl_ddl_deploy pg_failover_slots wal2json wal2mongo decoderbufs decoder_raw mimeo pgcopydb pgloader pg_fact_loader pg_bulkload pg_comparator pgimportdoc pgexportdoc <span style="color:#8f5902;font-style:italic">#repmgr #slony</span>
</span></span><span style="display:flex;"><span>  - gis-stack rag-stack fdw-stack fts-stack etl-stack feat-stack olap-stack supa-stack stat-stack json-stack
</span></span></code></pre></div><p>完整列表请参考：<a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a></p>
<hr>
<h2 id="pg_bootstrap"><code>PG_BOOTSTRAP</code></h2>
<p>使用 Patroni 引导拉起 PostgreSQL 集群，并设置 1:1 对应的 Pgbouncer 连接池。</p>
<p>它还会使用 <a href="/zh/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a> 中定义的默认角色、用户、权限、模式、扩展来初始化数据库集群</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># prevent purging running postgres instance? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># purging existing postgres during pgsql init? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/data                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres data directory, `/pg/data` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_fs_main</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># mountpoint/path for postgres main data, `/data` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_fs_bkup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/backups        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># mountpoint/path for pg backup data, `/data/backup` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_storage_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SSD             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># storage type for pg main data, SSD,HDD, SSD by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dummy_filesize</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">64MiB         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># size of `/pg/dummy`, hold 64MB disk space for emergency use</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_listen</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;0.0.0.0&#39;</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># postgres/pgbouncer listen addresses, comma separated list</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5432</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># postgres listen port, 5432 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_localhost</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/var/run/postgresql</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres unix socket dir for localhost connection</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># if disabled, no postgres cluster will be created during init</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_mode: default             # patroni working mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default,pause,remove</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_namespace</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># top level key namespace in etcd, used by patroni &amp; vip</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8008</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># patroni listen port, 8008 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_log_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/log/patroni </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># patroni log dir, `/pg/log/patroni` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_ssl_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># secure patroni RestAPI communications with SSL?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_watchdog_mode: off        # patroni watchdog mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">automatic,required,off. off by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># patroni restapi username, `postgres` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Patroni.API    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># patroni restapi password, `Patroni.API` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_primary_db</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># primary database name, used by citus,etc... ,postgres by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># extra parameters in postgresql.auto.conf</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_files</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># extra files to be copied to postgres data directory (e.g. license)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_conf: oltp.yml                 # config template</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">oltp,olap,crit,tiny. `oltp.yml` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_max_conn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">auto                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres max connections, `auto` will use recommended value</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_shared_buffer_ratio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0.25</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># postgres shared buffers ratio, 0.25 by default, 0.1~0.4</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_rto</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">30</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># recovery time objective in seconds,  `30s` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_rpo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1048576</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># recovery point objective in bytes, `1MiB` at most by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_libs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pg_stat_statements, auto_explain&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># preloaded libraries, `pg_stat_statements,auto_explain` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_delay</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># replication apply delay for standby cluster leader</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_checksum</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># enable data checksum for postgres cluster?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_pwd_enc: scram-sha-256         # passwords encryption algorithm</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">md5,scram-sha-256</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># database cluster encoding, `UTF8` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># database cluster local, `C` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_lc_collate</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># database cluster collate, `C` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_lc_ctype</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">en_US.UTF8          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># database character type, `en_US.UTF8` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># if disabled, pgbouncer will not be launched on pgsql host</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">6432</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># pgbouncer listen port, 6432 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_log_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/log/pgbouncer </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbouncer log dir, `/pg/log/pgbouncer` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_auth_query</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># query postgres to retrieve unlisted business users?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_poolmode: transaction   # pooling mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">transaction,session,statement, transaction by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_sslmode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">disable       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbouncer client ssl mode, disable by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_safeguard"><code>pg_safeguard</code></h3>
<p>参数名称： <code>pg_safeguard</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>是否防止清除正在运行的Postgres实例？默认为：<code>false</code>。</p>
<p>如果启用，<a href="/zh/docs/pgsql/playbook#pgsqlyml"><code>pgsql.yml</code></a> 和 <a href="/zh/docs/pgsql/playbook#pgsql-rmyml"><code>pgsql-rm.yml</code></a> 在检测到任何正在运行的postgres实例时将立即中止。</p>
<h3 id="pg_clean"><code>pg_clean</code></h3>
<p>参数名称： <code>pg_clean</code>， 类型： <code>bool</code>， 层次：<code>G/C/A</code></p>
<p>在 PostgreSQL 初始化期间清除现有的 PG 实例吗？默认为：<code>true</code>。</p>
<p>默认值为<code>true</code>，在 <a href="/zh/docs/pgsql/playbook#pgsqlyml"><code>pgsql.yml</code></a> 初始化期间它将清除现有的postgres实例，这使得playbook具有幂等性。</p>
<p>如果设置为 <code>false</code>，<a href="/zh/docs/pgsql/playbook#pgsqlyml"><code>pgsql.yml</code></a> 会在遇到正在运行的 PostgreSQL 实例时中止。而 <a href="/zh/docs/pgsql/playbook#pgsql-rmyml"><code>pgsql-rm.yml</code></a> 将不会删除 PostgreSQL 的数据目录（只会停止服务器）。</p>
<h3 id="pg_data"><code>pg_data</code></h3>
<p>参数名称： <code>pg_data</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>Postgres 数据目录，默认为 <code>/pg/data</code>。</p>
<p>这是一个指向底层实际数据目录的符号链接，在多处被使用，请不要修改它。参阅 <a href="/zh/docs/fhs">PGSQL文件结构</a> 获取详细信息。</p>
<h3 id="pg_fs_main"><code>pg_fs_main</code></h3>
<p>参数名称： <code>pg_fs_main</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>PostgreSQL 主数据盘的挂载点/文件系统路径，默认为<code>/data</code>。</p>
<p>默认值：<code>/data</code>，它将被用作 PostgreSQL 主数据目录（<code>/data/postgres</code>）的父目录。</p>
<p>建议使用 NVME SSD 作为 PostgreSQL 主数据存储，Pigsty默认为SSD存储进行了优化，但是也支持HDD。</p>
<p>您可以更改<a href="/zh/docs/reference/param/#pg_storage_type"><code>pg_storage_type</code></a>为<code>HDD</code>以针对HDD存储进行优化。</p>
<h3 id="pg_fs_bkup"><code>pg_fs_bkup</code></h3>
<p>参数名称： <code>pg_fs_bkup</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>PostgreSQL 备份数据盘的挂载点/文件系统路径，默认为<code>/data/backup</code>。</p>
<p>如果您使用的是默认的 <a href="/zh/docs/reference/param/#pgbackrest_method"><code>pgbackrest_method</code></a> = <code>local</code>，建议为备份存储使用一个单独的磁盘。</p>
<p>备份磁盘应足够大，以容纳所有的备份，至少足以容纳3个基础备份+2天的WAL归档。 通常容量不是什么大问题，因为您可以使用便宜且大的机械硬盘作为备份盘。</p>
<p>建议为备份存储使用一个单独的磁盘，否则 Pigsty 将回退到主数据磁盘，并占用主数据盘的容量与IO。</p>
<h3 id="pg_storage_type"><code>pg_storage_type</code></h3>
<p>参数名称： <code>pg_storage_type</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>PostgreSQL 数据存储介质的类型：<code>SSD</code>或<code>HDD</code>，默认为<code>SSD</code>。</p>
<p>默认值：<code>SSD</code>，它会影响一些调优参数，如 <code>random_page_cost</code> 和 <code>effective_io_concurrency</code> 。</p>
<h3 id="pg_dummy_filesize"><code>pg_dummy_filesize</code></h3>
<p>参数名称： <code>pg_dummy_filesize</code>， 类型： <code>size</code>， 层次：<code>C</code></p>
<p><code>/pg/dummy</code>的大小，默认值为<code>64MiB</code>，用于紧急使用的64MB磁盘空间。</p>
<p>当磁盘已满时，删除占位符文件可以为紧急使用释放一些空间，建议生产使用至少<code>8GiB</code>。</p>
<h3 id="pg_listen"><code>pg_listen</code></h3>
<p>参数名称： <code>pg_listen</code>， 类型： <code>ip</code>， 层次：<code>C</code></p>
<p>PostgreSQL / Pgbouncer 的监听地址，默认为<code>0.0.0.0</code>（所有ipv4地址）。</p>
<p>您可以在此变量中使用占位符，例如：<code>'${ip},${lo}'</code>或<code>'${ip},${vip},${lo}'</code>：</p>
<ul>
<li><code>${ip}</code>：转换为 <code>inventory_hostname</code>，它是配置清单中定义的首要内网IP地址。</li>
<li><code>${vip}</code>：如果启用了<a href="/zh/docs/reference/param/#pg_vip_enabled"><code>pg_vip_enabled</code></a>，将使用<a href="/zh/docs/reference/param/#pg_vip_address"><code>pg_vip_address</code></a>的主机部分。</li>
<li><code>${lo}</code>：将替换为<code>127.0.0.1</code></li>
</ul>
<p>对于高安全性要求的生产环境，建议限制监听的IP地址。</p>
<h3 id="pg_port"><code>pg_port</code></h3>
<p>参数名称： <code>pg_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>PostgreSQL 服务器监听的端口，默认为 <code>5432</code>。</p>
<h3 id="pg_localhost"><code>pg_localhost</code></h3>
<p>参数名称： <code>pg_localhost</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>本地主机连接 PostgreSQL 使用的 Unix套接字目录，默认值为<code>/var/run/postgresql</code>。</p>
<p>PostgreSQL 和 Pgbouncer 本地连接的Unix套接字目录，<a href="/zh/docs/reference/param/#pg_exporter"><code>pg_exporter</code></a> 和 patroni 都会优先使用 Unix 套接字访问 PostgreSQL。</p>
<h3 id="pg_namespace"><code>pg_namespace</code></h3>
<p>参数名称： <code>pg_namespace</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>在 <a href="/zh/docs/reference/param/#etcd">etcd</a> 中使用的顶级命名空间，由 patroni 和 vip-manager 使用，默认值是：<code>/pg</code>，不建议更改。</p>
<h3 id="patroni_enabled"><code>patroni_enabled</code></h3>
<p>参数名称： <code>patroni_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否启用 Patroni ？默认值为：<code>true</code>。</p>
<p>如果禁用，则在初始化期间不会创建Postgres集群。Pigsty将跳过拉起 patroni的任务，当试图向现有的postgres实例添加一些组件时，可以使用此参数。</p>
<h3 id="patroni_mode"><code>patroni_mode</code></h3>
<p>参数名称： <code>patroni_mode</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>Patroni 工作模式：<code>default</code>，<code>pause</code>，<code>remove</code>。默认值：<code>default</code>。</p>
<ul>
<li><code>default</code>：正常使用 Patroni 引导 PostgreSQL 集群</li>
<li><code>pause</code>：与<code>default</code>相似，但在引导后进入维护模式</li>
<li><code>remove</code>：使用Patroni初始化集群，然后删除Patroni并使用原始 PostgreSQL。</li>
</ul>
<h3 id="patroni_port"><code>patroni_port</code></h3>
<p>参数名称： <code>patroni_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>patroni监听端口，默认为<code>8008</code>，不建议更改。</p>
<p>Patroni API服务器在此端口上监听健康检查和API请求。</p>
<h3 id="patroni_log_dir"><code>patroni_log_dir</code></h3>
<p>参数名称： <code>patroni_log_dir</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>patroni日志目录，默认为<code>/pg/log/patroni</code>，由<a href="/zh/docs/reference/param/#promtail"><code>promtail</code></a>收集。</p>
<h3 id="patroni_ssl_enabled"><code>patroni_ssl_enabled</code></h3>
<p>参数名称： <code>patroni_ssl_enabled</code>， 类型： <code>bool</code>， 层次：<code>G</code></p>
<p>使用SSL保护patroni RestAPI通信吗？默认值为<code>false</code>。</p>
<p>此参数是一个全局标志，只能在部署之前预先设置。因为如果为 patroni 启用了SSL，您将必须使用 HTTPS 而不是 HTTP 执行健康检查、获取指标，调用API。</p>
<h3 id="patroni_watchdog_mode"><code>patroni_watchdog_mode</code></h3>
<p>参数名称： <code>patroni_watchdog_mode</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>patroni看门狗模式：<code>automatic</code>，<code>required</code>，<code>off</code>，默认值为 <code>off</code>。</p>
<p>在主库故障的情况下，Patroni 可以使用<a href="https://patroni.readthedocs.io/en/latest/watchdog.html">看门狗</a> 来强制关机旧主库节点以避免脑裂。</p>
<ul>
<li><code>off</code>：不使用<code>看门狗</code>。完全不进行 Fencing （默认行为）</li>
<li><code>automatic</code>：如果内核启用了<code>softdog</code>模块并且看门狗属于dbsu，则启用 <code>watchdog</code>。</li>
<li><code>required</code>：强制启用 <code>watchdog</code>，如果<code>softdog</code>不可用则拒绝启动 Patroni/PostgreSQL。</li>
</ul>
<p>默认值为<code>off</code>，您不应该在 Infra节点 启用看门狗，数据一致性优先于可用性的关键系统，特别是与钱有关的业务集群可以考虑打开此选项。</p>
<p>请注意，如果您的所有访问流量都使用 HAproxy 健康检查<a href="/zh/docs/pgsql/svc#%E6%8E%A5%E5%85%A5%E6%9C%8D%E5%8A%A1">服务接入</a>，正常是不存在脑裂风险的。</p>
<h3 id="patroni_username"><code>patroni_username</code></h3>
<p>参数名称： <code>patroni_username</code>， 类型： <code>username</code>， 层次：<code>C</code></p>
<p>Patroni REST API 用户名，默认为<code>postgres</code>，与<a href="/zh/docs/reference/param/#patroni_password"><code>patroni_password</code></a> 配对使用。</p>
<p>Patroni的危险 REST API （比如重启集群）由额外的用户名/密码保护，查看<a href="/zh/docs/pgsql/admin#%E9%85%8D%E7%BD%AE%E9%9B%86%E7%BE%A4">配置集群</a>和<a href="https://patroni.readthedocs.io/en/latest/rest_api.html">Patroni RESTAPI</a>以获取详细信息。</p>
<h3 id="patroni_password"><code>patroni_password</code></h3>
<p>参数名称： <code>patroni_password</code>， 类型： <code>password</code>， 层次：<code>C</code></p>
<p>Patroni REST API 密码，默认为<code>Patroni.API</code>。</p>
<blockquote>
<p>警告：务必生产环境中修改此参数！</p>
</blockquote>
<h3 id="pg_primary_db"><code>pg_primary_db</code></h3>
<p>参数名称： <code>pg_primary_db</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>指定集群中的主数据库名称，用于 citus 等业务数据库，默认为 <code>postgres</code>。</p>
<p>例如，在使用 Patroni 管理高可用的 Citus 集群时，您必须选择一个 “主数据库”。</p>
<p>此外，在这里指定的数据库名称，将在 PGSQL 模块安装完成后，显示在打印的连接串中。</p>
<h3 id="pg_parameters"><code>pg_parameters</code></h3>
<p>参数名称： <code>pg_parameters</code>， 类型： <code>dict</code>， 层次：<code>G/C/I</code></p>
<p>可用于指定并管理 <code>postgresql.auto.conf</code> 中的配置参数。</p>
<p>当集群所有实例完成初始化后，<code>pg_param</code> 任务将会把本字典中的 key / value 键值对依次覆盖写入 <code>/pg/data/postgresql.auto.conf</code> 中。</p>
<blockquote>
<p>注意：请不要手工修改该配置文件，或通过 <code>ALTER SYSTEM</code> 修改集群配置参数，修改会在下一次配置同步时被覆盖。</p>
</blockquote>
<p>该变量的优先级大于 Patroni / DCS 中的集群配置（即优先级高于集群配置，由 Patroni <code>edit-config</code> 编辑的配置），因此通常可以在实例级别覆盖集群默认参数。</p>
<p>当您的集群成员有着不同的规格（不推荐的行为！）时，您可以通过本参数对每个实例的配置进行精细化管理。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg-test</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role: primary , pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">shared_buffers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;5GB&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 2, pg_role: replica , pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">shared_buffers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;4GB&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 3, pg_role: replica , pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">shared_buffers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;3GB&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>请注意，一些 <a href="https://patroni.readthedocs.io/en/latest/patroni_configuration.html#important-rules">重要的集群参数</a>（对主从库参数值有要求）是 Patroni 直接通过命令行参数管理的，具有最高优先级，无法通过此方式覆盖，对于这些参数，您必须使用 Patroni <code>edit-config</code> 进行管理与配置。</p>
<p>在主从上必须保持一致的 PostgreSQL 参数（不一致会导致从库无法启动！）：</p>
<ul>
<li><code>wal_level</code></li>
<li><code>max_connections</code></li>
<li><code>max_locks_per_transaction</code></li>
<li><code>max_worker_processes</code></li>
<li><code>max_prepared_transactions</code></li>
<li><code>track_commit_timestamp</code></li>
</ul>
<p>在主从上最好保持一致的参数（考虑到主从切换的可能性）：</p>
<ul>
<li><code>listen_addresses</code></li>
<li><code>port</code></li>
<li><code>cluster_name</code></li>
<li><code>hot_standby</code></li>
<li><code>wal_log_hints</code></li>
<li><code>max_wal_senders</code></li>
<li><code>max_replication_slots</code></li>
<li><code>wal_keep_segments</code></li>
<li><code>wal_keep_size</code></li>
</ul>
<p>您可以设置不存在的参数（例如来自扩展的 GUC，从而配置 <code>ALTER SYSTEM</code> 无法修改的“尚未存在”的参数），但将现有配置修改为非法值可能会导致 PostgreSQL 无法启动，请谨慎配置！</p>
<h3 id="pg_files"><code>pg_files</code></h3>
<p>参数名称： <code>pg_files</code>， 类型： <code>path[]</code>， 层次：<code>C</code></p>
<p>用于指定需要拷贝至PGDATA目录的文件列表，默认为空数组：<code>[]</code></p>
<p>在本参数中指定的文件将会被拷贝至 <code>{{ pg_data }}</code> 目录下，这主要用于下发特殊商业版本 PostgreSQL 内核要求的 License 文件。</p>
<p>目前仅有 PolarDB （Oracle兼容）内核需要许可证文件，例如，您可以将 <code>license.lic</code> 文件放置在 <code>files/</code> 目录下，并在 <code>pg_files</code> 中指定：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_files</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">license.lic ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_conf"><code>pg_conf</code></h3>
<p>参数名称： <code>pg_conf</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>配置模板：<code>{oltp,olap,crit,tiny}.yml</code>，默认为<code>oltp.yml</code>。</p>
<ul>
<li><code>tiny.yml</code>：为小节点、虚拟机、小型演示优化（1-8核，1-16GB）</li>
<li><code>oltp.yml</code>：为OLTP工作负载和延迟敏感应用优化（4C8GB+）（默认模板）</li>
<li><code>olap.yml</code>：为OLAP工作负载和吞吐量优化（4C8G+）</li>
<li><code>crit.yml</code>：为数据一致性和关键应用优化（4C8G+）</li>
</ul>
<p>默认值：<code>oltp.yml</code>，但是<a href="/zh/docs/setup/install#%E9%85%8D%E7%BD%AE">配置</a>程序将在当前节点为小节点时将此值设置为 <code>tiny.yml</code>。</p>
<p>您可以拥有自己的模板，只需将其放在<code>templates/&lt;mode&gt;.yml</code>下，并将此值设置为模板名称即可使用。</p>
<h3 id="pg_max_conn"><code>pg_max_conn</code></h3>
<p>参数名称： <code>pg_max_conn</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>PostgreSQL 服务器最大连接数。你可以选择一个介于 50 到 5000 之间的值，或使用 <code>auto</code> 选择推荐值。</p>
<p>默认值为 <code>auto</code>，会根据 <a href="/zh/docs/reference/param/#pg_conf"><code>pg_conf</code></a> 和 <a href="/zh/docs/reference/param/#pg_default_service_dest"><code>pg_default_service_dest</code></a> 来设定最大连接数。</p>
<ul>
<li>tiny: 100</li>
<li>olap: 200</li>
<li>oltp: 200 (pgbouncer) / 1000 (postgres)
<ul>
<li>pg_default_service_dest = pgbouncer : 200</li>
<li>pg_default_service_dest = postgres : 1000</li>
</ul>
</li>
<li>crit: 200 (pgbouncer) / 1000 (postgres)
<ul>
<li>pg_default_service_dest = pgbouncer : 200</li>
<li>pg_default_service_dest = postgres : 1000</li>
</ul>
</li>
</ul>
<p>不建议将此值设定为超过 5000，否则你还需要手动增加 haproxy 服务的连接限制。</p>
<p>Pgbouncer 的事务池可以缓解过多的 OLTP 连接问题，因此默认情况下不建议设置很大的连接数。</p>
<p>对于 OLAP 场景， <a href="/zh/docs/reference/param/#pg_default_service_dest"><code>pg_default_service_dest</code></a> 修改为 <code>postgres</code> 可以绕过连接池。</p>
<h3 id="pg_shared_buffer_ratio"><code>pg_shared_buffer_ratio</code></h3>
<p>参数名称： <code>pg_shared_buffer_ratio</code>， 类型： <code>float</code>， 层次：<code>C</code></p>
<p>Postgres 共享缓冲区内存比例，默认为 <code>0.25</code>，正常范围在 <code>0.1</code>~<code>0.4</code> 之间。</p>
<p>默认值：<code>0.25</code>，意味着节点内存的 25% 将被用作 PostgreSQL 的分片缓冲区。如果您想为 PostgreSQL 启用大页，那么此参数值应当适当小于 <a href="/zh/docs/reference/param/#node_hugepage_ratio"><code>node_hugepage_ratio</code></a>。</p>
<p>将此值设定为大于 0.4（40%）通常不是好主意，但在极端情况下可能有用。</p>
<p>注意，共享缓冲区只是 PostgreSQL 中共享内存的一部分，要计算总共享内存，使用 <code>show shared_memory_size_in_huge_pages;</code>。</p>
<h3 id="pg_rto"><code>pg_rto</code></h3>
<p>参数名称： <code>pg_rto</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>以秒为单位的恢复时间目标（RTO）。这将用于计算 Patroni 的 TTL 值，默认为 <code>30</code> 秒。</p>
<p>如果主实例在这么长时间内失踪，将触发新的领导者选举，此值并非越低越好，它涉及到利弊权衡：</p>
<p>减小这个值可以减少集群故障转移期间的不可用时间（无法写入）， 但会使集群对短期网络抖动更加敏感，从而增加误报触发故障转移的几率。</p>
<p>您需要根据网络状况和业务约束来配置这个值，在故障几率和故障影响之间做出<strong>权衡</strong>， 默认值是 <code>30s</code>，它将影响以下的 Patroni 参数：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 获取领导者租约的 TTL（以秒为单位）。将其视为启动自动故障转移过程之前的时间长度。默认值：30</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ttl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_rto }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># 循环将休眠的秒数。默认值：10，这是 patroni 检查循环间隔</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loop_wait</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">(pg_rto / 3)|round(0, &#39;ceil&#39;)|int }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># DCS 和 PostgreSQL 操作重试的超时时间（以秒为单位）。比这短的 DCS 或网络问题不会导致 Patroni 降级领导。默认值：10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">retry_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">(pg_rto / 3)|round(0, &#39;ceil&#39;)|int }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># 主实例在触发故障转移之前允许从故障中恢复的时间（以秒为单位），最大 RTO：2 倍循环等待 + primary_start_timeout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">primary_start_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">(pg_rto / 3)|round(0, &#39;ceil&#39;)|int }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_rpo"><code>pg_rpo</code></h3>
<p>参数名称： <code>pg_rpo</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>以字节为单位的恢复点目标（RPO），默认值：<code>1048576</code>。</p>
<p>默认为 1MiB，这意味着在故障转移期间最多可以容忍 1MiB 的数据丢失。</p>
<p>当主节点宕机并且所有副本都滞后时，你必须做出一个艰难的选择，<strong>在可用性和一致性之间进行权衡</strong>：</p>
<ul>
<li>提升一个从库成为新的主库，并尽快将系统恢复服务，但要付出可接受的数据丢失代价（例如，少于 1MB）。</li>
<li>等待主库重新上线（可能永远不会），或人工干预以避免任何数据丢失。</li>
</ul>
<p>你可以使用 <code>crit.yml</code> <a href="/zh/docs/reference/param/#pg_conf">conf</a> 模板来确保在故障转移期间没有数据丢失，但这会牺牲一些性能。</p>
<h3 id="pg_libs"><code>pg_libs</code></h3>
<p>参数名称： <code>pg_libs</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>预加载的动态共享库，默认为 <code>pg_stat_statements,auto_explain</code>，这是两个 PostgreSQL 自带的扩展，强烈建议启用。</p>
<p>对于现有集群，您可以直接<a href="/zh/docs/pgsql/admin#%E9%85%8D%E7%BD%AE%E9%9B%86%E7%BE%A4">配置集群</a>的 <code>shared_preload_libraries</code> 参数并应用生效。</p>
<p>如果您想使用 TimescaleDB 或 Citus 扩展，您需要将 <code>timescaledb</code> 或 <code>citus</code> 添加到此列表中。<code>timescaledb</code> 和 <code>citus</code> 应当放在这个列表的最前面，例如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>citus,timescaledb,pg_stat_statements,auto_explain
</span></span></code></pre></div><p>其他需要动态加载的扩展也可以添加到这个列表中，例如 <code>pg_cron</code>， <code>pgml</code> 等，通常 <code>citus</code> 和 <code>timescaledb</code> 有着最高的优先级，应该添加到列表的最前面。</p>
<h3 id="pg_delay"><code>pg_delay</code></h3>
<p>参数名称： <code>pg_delay</code>， 类型： <code>interval</code>， 层次：<code>I</code></p>
<p>延迟备库复制延迟，默认值：<code>0</code>。</p>
<p>如果此值被设置为一个正值，备用集群主库在应用 WAL 变更之前将被延迟这个时间。设置为 <code>1h</code> 意味着该集群中的数据将始终滞后原集群一个小时。</p>
<p>查看 <a href="/zh/docs/pgsql/config#%E5%BB%B6%E8%BF%9F%E9%9B%86%E7%BE%A4">延迟备用集群</a> 以获取详细信息。</p>
<h3 id="pg_checksum"><code>pg_checksum</code></h3>
<p>参数名称： <code>pg_checksum</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>为 PostgreSQL 集群启用数据校验和吗？默认值是 <code>false</code>，不启用。</p>
<p>这个参数只能在 PGSQL 部署之前设置（但你可以稍后手动启用它）。</p>
<p>如果使用 <a href="/zh/docs/reference/param/#pg_conf"><code>pg_conf</code></a> <code>crit.yml</code> 模板，无论此参数如何，都会始终启用数据校验和，以确保数据完整性。</p>
<h3 id="pg_pwd_enc"><code>pg_pwd_enc</code></h3>
<p>参数名称： <code>pg_pwd_enc</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>密码加密算法：<code>md5</code> 或 <code>scram-sha-256</code>，默认值：<code>scram-sha-256</code>。</p>
<p>前者已经不再安全，如果你与旧客户端有兼容性问题，你可以将其设置为 <code>md5</code>。</p>
<h3 id="pg_encoding"><code>pg_encoding</code></h3>
<p>参数名称： <code>pg_encoding</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>数据库集群编码，默认为 <code>UTF8</code>。</p>
<p>不建议使用其他非 <code>UTF8</code> 系编码。</p>
<h3 id="pg_locale"><code>pg_locale</code></h3>
<p>参数名称： <code>pg_locale</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>数据库集群编码，默认为 <code>UTF8</code>。</p>
<p>数据库集群本地化规则集，默认为 <code>UTF8</code>。</p>
<h3 id="pg_lc_collate"><code>pg_lc_collate</code></h3>
<p>参数名称： <code>pg_lc_collate</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>数据库集群本地化排序规则，默认为 <code>C</code>。</p>
<p>除非您知道自己在做什么，否则不建议修改集群级别的本地排序规则设置。</p>
<h3 id="pg_lc_ctype"><code>pg_lc_ctype</code></h3>
<p>参数名称： <code>pg_lc_ctype</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>数据库字符集 CTYPE，默认为 <code>en_US.UTF8</code>。</p>
<h3 id="pgbouncer_enabled"><code>pgbouncer_enabled</code></h3>
<p>参数名称： <code>pgbouncer_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>默认值为 <code>true</code>，如果禁用，将不会在 PGSQL节点上配置连接池 Pgbouncer。</p>
<h3 id="pgbouncer_port"><code>pgbouncer_port</code></h3>
<p>参数名称： <code>pgbouncer_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>Pgbouncer 监听端口，默认为 <code>6432</code>。</p>
<h3 id="pgbouncer_log_dir"><code>pgbouncer_log_dir</code></h3>
<p>参数名称： <code>pgbouncer_log_dir</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>Pgbouncer 日志目录，默认为 <code>/pg/log/pgbouncer</code>，日志代理 <a href="/zh/docs/reference/param/#promtail">promtail</a> 会根据此参数收集 Pgbouncer 日志。</p>
<h3 id="pgbouncer_auth_query"><code>pgbouncer_auth_query</code></h3>
<p>参数名称： <code>pgbouncer_auth_query</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否允许 Pgbouncer 查询 PostgreSQL，以允许未显式列出的用户通过连接池访问 PostgreSQL？默认值是 <code>false</code>。</p>
<p>如果启用，pgbouncer 用户将使用 <code>SELECT username, password FROM monitor.pgbouncer_auth($1)</code> 对 postgres 数据库进行身份验证，否则，只有带有 <code>pgbouncer: true</code> 的业务用户才被允许连接到 Pgbouncer 连接池。</p>
<h3 id="pgbouncer_poolmode"><code>pgbouncer_poolmode</code></h3>
<p>参数名称： <code>pgbouncer_poolmode</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>Pgbouncer 连接池池化模式：<code>transaction</code>,<code>session</code>,<code>statement</code>，默认为 <code>transaction</code>。</p>
<ul>
<li><code>session</code>：会话级池化，具有最佳的功能兼容性。</li>
<li><code>transaction</code>：事务级池化，具有更好的性能（许多小连接），可能会破坏某些会话级特性，如<code>NOTIFY/LISTEN</code> 等&hellip;</li>
<li><code>statements</code>：语句级池化，用于简单的只读查询。</li>
</ul>
<p>如果您的应用出现功能兼容性问题，可以考虑修改此参数为 <code>session</code>。</p>
<h3 id="pgbouncer_sslmode"><code>pgbouncer_sslmode</code></h3>
<p>参数名称： <code>pgbouncer_sslmode</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>Pgbouncer 客户端 ssl 模式，默认为 <code>disable</code>。</p>
<p>注意，启用 SSL 可能会对你的 pgbouncer 产生巨大的性能影响。</p>
<ul>
<li><code>disable</code>：如果客户端请求 TLS 则忽略（默认）</li>
<li><code>allow</code>：如果客户端请求 TLS 则使用。如果没有则使用纯TCP。不验证客户端证书。</li>
<li><code>prefer</code>：与 allow 相同。</li>
<li><code>require</code>：客户端必须使用 TLS。如果没有则拒绝客户端连接。不验证客户端证书。</li>
<li><code>verify-ca</code>：客户端必须使用有效的客户端证书的TLS。</li>
<li><code>verify-full</code>：与 verify-ca 相同。</li>
</ul>
<hr>
<h2 id="pg_provision"><code>PG_PROVISION</code></h2>
<p>如果说 <a href="/zh/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a> 是创建一个新的集群，那么 PG_PROVISION 就是在集群中创建默认的对象，包括：</p>
<ul>
<li><a href="/zh/docs/pgsql/acl#%E9%BB%98%E8%AE%A4%E8%A7%92%E8%89%B2">默认角色</a></li>
<li><a href="/zh/docs/pgsql/acl#%E9%BB%98%E8%AE%A4%E7%94%A8%E6%88%B7">默认用户</a></li>
<li><a href="/zh/docs/pgsql/acl#%E9%BB%98%E8%AE%A4%E6%9D%83%E9%99%90">默认权限</a></li>
<li><a href="/zh/docs/pgsql/hba#%E9%BB%98%E8%AE%A4hba">默认HBA规则</a></li>
<li>默认模式</li>
<li>默认扩展</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_provision</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># 在引导后提供postgres集群</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_init</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-init                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 集群模板的初始化脚本，默认为`pg-init`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># postgres集群中的默认角色和用户</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_readonly  ,login: false ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for global read-only access     }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_offline   ,login: false ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for restricted read-only access }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_readwrite ,login: false ,roles: [dbrole_readonly] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for global read-write access }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_admin     ,login: false ,roles: [pg_monitor, dbrole_readwrite] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for object creation }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgres     ,superuser: true  ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system superuser }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replicator ,replication: true  ,roles: [pg_monitor, dbrole_readonly] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system replicator }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_dba   ,superuser: true  ,roles: [dbrole_admin]  ,pgbouncer: true ,pool_mode: session, pool_connlimit: 16 ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql admin user }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_monitor ,roles: [pg_monitor] ,pgbouncer: true ,parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">log_min_duration_statement: 1000 } ,pool_mode: session ,pool_connlimit: 8 ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql monitor user }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_privileges</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># 管理员用户创建时的默认权限</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SCHEMAS   TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON TABLES    TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON SEQUENCES TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE    ON FUNCTIONS TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SCHEMAS   TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON TABLES    TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON SEQUENCES TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE    ON FUNCTIONS TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT INSERT     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT UPDATE     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT DELETE     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT UPDATE     ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRUNCATE   ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT REFERENCES ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRIGGER    ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT CREATE     ON SCHEMAS   TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor ]  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 默认模式</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># 默认扩展</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: adminpack          ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_catalog }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_stat_statements ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgstattuple        ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_buffercache     ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pageinspect        ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_prewarm         ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_visibility      ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_freespacemap    ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgres_fdw       ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: file_fdw           ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: btree_gist         ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: btree_gin          ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_trgm            ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: intagg             ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: intarray           ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_repack }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># HBA变化后是否重载配置？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># postgres 默认 HBA 规则集</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: local     ,auth: ident ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu access via local os user ident&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: local     ,auth: ident ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu replication from local os ident&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator replication from localhost&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator replication from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: postgres    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator postgres db from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor from localhost with password&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: infra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor from infra host with password&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: infra     ,auth: ssl   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin @ infra nodes with pwd &amp; ssl&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: ssl   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin @ everywhere with ssl &amp; pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_readonly&#39;,db: all    ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pgbouncer read/write via local socket&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_readonly&#39;,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;read/write biz user via password&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_offline&#39; ,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow etl offline tasks from intranet&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgb_default_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># pgbouncer 默认 HBA 规则集</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: pgbouncer   ,addr: local     ,auth: peer  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu local admin access with os ident&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;all&#39;        ,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow all user local access with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: pgbouncer   ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor access via intranet with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: deny  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;reject all other monitor access addr&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin access via intranet with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: deny  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;reject all other admin access addr&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;all&#39;        ,db: all         ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow all user intra access with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_provision-1"><code>pg_provision</code></h3>
<p>参数名称： <code>pg_provision</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>在集群拉起后，完整本节定义的 PostgreSQL 集群置备工作。默认值为<code>true</code>。</p>
<p>如果禁用，不会置备 PostgreSQL 集群。对于一些特殊的 &ldquo;PostgreSQL&rdquo; 集群，比如 Greenplum，可以关闭此选项跳过置备阶段。</p>
<h3 id="pg_init"><code>pg_init</code></h3>
<p>参数名称： <code>pg_init</code>， 类型： <code>string</code>， 层次：<code>G/C</code></p>
<p>用于初始化数据库模板的Shell脚本位置，默认为 <code>pg-init</code>，该脚本会被拷贝至<code>/pg/bin/pg-init</code>后执行。</p>
<p>该脚本位于 <a href="https://github.com/Vonng/pigsty/blob/main/roles/pgsql/templates/pg-init"><code>roles/pgsql/templates/pg-init</code></a></p>
<p>你可以在该脚本中添加自己的逻辑，或者提供一个新的脚本放置在 <code>templates/</code> 目录下，并将 <code>pg_init</code> 设置为新的脚本名称。使用自定义脚本时请保留现有的初始化逻辑。</p>
<h3 id="pg_default_roles"><code>pg_default_roles</code></h3>
<p>参数名称： <code>pg_default_roles</code>， 类型： <code>role[]</code>， 层次：<code>G/C</code></p>
<p>Postgres 集群中的默认角色和用户。</p>
<p>Pigsty有一个内置的角色系统，请查看<a href="/zh/docs/pgsql/acl#%E8%A7%92%E8%89%B2%E7%B3%BB%E7%BB%9F">PGSQL访问控制：角色系统</a>了解详情。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># postgres集群中的默认角色和用户</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_readonly  ,login: false ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for global read-only access     }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_offline   ,login: false ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for restricted read-only access }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_readwrite ,login: false ,roles: [dbrole_readonly] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for global read-write access }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_admin     ,login: false ,roles: [pg_monitor, dbrole_readwrite] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for object creation }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgres     ,superuser: true  ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system superuser }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replicator ,replication: true  ,roles: [pg_monitor, dbrole_readonly] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system replicator }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_dba   ,superuser: true  ,roles: [dbrole_admin]  ,pgbouncer: true ,pool_mode: session, pool_connlimit: 16 ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql admin user }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_monitor ,roles: [pg_monitor] ,pgbouncer: true ,parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">log_min_duration_statement: 1000 } ,pool_mode: session ,pool_connlimit: 8 ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql monitor user }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_default_privileges"><code>pg_default_privileges</code></h3>
<p>参数名称： <code>pg_default_privileges</code>， 类型： <code>string[]</code>， 层次：<code>G/C</code></p>
<p>每个数据库中的默认权限（<code>DEFAULT PRIVILEGE</code>）设置：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_privileges</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># 管理员用户创建时的默认权限</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SCHEMAS   TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON TABLES    TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON SEQUENCES TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE    ON FUNCTIONS TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SCHEMAS   TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON TABLES    TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON SEQUENCES TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE    ON FUNCTIONS TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT INSERT     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT UPDATE     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT DELETE     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT UPDATE     ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRUNCATE   ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT REFERENCES ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRIGGER    ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT CREATE     ON SCHEMAS   TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Pigsty 基于默认角色系统提供了相应的默认权限设置，请查看<a href="/zh/docs/pgsql/acl#%E9%BB%98%E8%AE%A4%E6%9D%83%E9%99%90">PGSQL访问控制：权限</a>了解详情。</p>
<h3 id="pg_default_schemas"><code>pg_default_schemas</code></h3>
<p>参数名称： <code>pg_default_schemas</code>， 类型： <code>string[]</code>， 层次：<code>G/C</code></p>
<p>要创建的默认模式，默认值为：<code>[ monitor ]</code>，这将在所有数据库上创建一个<code>monitor</code>模式，用于放置各种监控扩展、表、视图、函数。</p>
<h3 id="pg_default_extensions"><code>pg_default_extensions</code></h3>
<p>参数名称： <code>pg_default_extensions</code>， 类型： <code>extension[]</code>， 层次：<code>G/C</code></p>
<p>要在所有数据库中默认创建启用的扩展列表，默认值：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default extensions to be created</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: adminpack          ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_catalog }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_stat_statements ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgstattuple        ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_buffercache     ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pageinspect        ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_prewarm         ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_visibility      ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_freespacemap    ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgres_fdw       ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: file_fdw           ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: btree_gist         ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: btree_gin          ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_trgm            ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: intagg             ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: intarray           ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_repack }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>唯一的三方扩展是 <code>pg_repack</code>，这对于数据库维护很重要，所有其他扩展都是内置的 PostgreSQL Contrib 扩展插件。</p>
<p>监控相关的扩展默认安装在 <code>monitor</code> 模式中，该模式由<a href="/zh/docs/reference/param/#pg_default_schemas"><code>pg_default_schemas</code></a>创建。</p>
<h3 id="pg_reload"><code>pg_reload</code></h3>
<p>参数名称： <code>pg_reload</code>， 类型： <code>bool</code>， 层次：<code>A</code></p>
<p>在hba更改后重新加载 PostgreSQL，默认值为<code>true</code></p>
<p>当您想在应用HBA更改之前进行检查时，将其设置为<code>false</code>以禁用自动重新加载配置。</p>
<h3 id="pg_default_hba_rules"><code>pg_default_hba_rules</code></h3>
<p>参数名称： <code>pg_default_hba_rules</code>， 类型： <code>hba[]</code>， 层次：<code>G/C</code></p>
<p>PostgreSQL 基于主机的认证规则，全局默认规则定义。默认值为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># postgres default host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: local     ,auth: ident ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu access via local os user ident&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: local     ,auth: ident ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu replication from local os ident&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator replication from localhost&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator replication from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: postgres    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator postgres db from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor from localhost with password&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: infra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor from infra host with password&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: infra     ,auth: ssl   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin @ infra nodes with pwd &amp; ssl&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: ssl   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin @ everywhere with ssl &amp; pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_readonly&#39;,db: all    ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pgbouncer read/write via local socket&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_readonly&#39;,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;read/write biz user via password&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_offline&#39; ,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow etl offline tasks from intranet&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>默认值为常见场景提供了足够的安全级别，请查看<a href="/zh/docs/pgsql/hba">PGSQL身份验证</a>了解详情。</p>
<p>本参数为 <a href="/zh/docs/pgsql/hba#define-hba">HBA</a>规则对象组成的数组，在形式上与 <a href="/zh/docs/reference/param/#pg_hba_rules"><code>pg_hba_rules</code></a> 完全一致。
建议在全局配置统一的 <a href="/zh/docs/reference/param/#pg_default_hba_rules"><code>pg_default_hba_rules</code></a>，针对特定集群使用 <a href="/zh/docs/reference/param/#pg_hba_rules"><code>pg_hba_rules</code></a> 进行额外定制。两个参数中的规则都会依次应用，后者优先级更高。</p>
<h3 id="pgb_default_hba_rules"><code>pgb_default_hba_rules</code></h3>
<p>参数名称： <code>pgb_default_hba_rules</code>， 类型： <code>hba[]</code>， 层次：<code>G/C</code></p>
<p>pgbouncer default host-based authentication rules, array or <a href="/zh/docs/pgsql/hba#define-hba">hba</a> rule object.</p>
<p>default value provides a fair enough security level for common scenarios, check <a href="/zh/docs/pgsql/hba">PGSQL Authentication</a> for details.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pgb_default_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># pgbouncer default host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: pgbouncer   ,addr: local     ,auth: peer  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu local admin access with os ident&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;all&#39;        ,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow all user local access with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: pgbouncer   ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor access via intranet with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: deny  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;reject all other monitor access addr&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin access via intranet with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: deny  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;reject all other admin access addr&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;all&#39;        ,db: all         ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow all user intra access with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>默认的Pgbouncer HBA规则很简单：</p>
<ol>
<li>允许从<strong>本地</strong>使用密码登陆</li>
<li>允许从内网网断使用密码登陆</li>
</ol>
<p>用户可以按照自己的需求进行定制。</p>
<p>本参数在形式上与 <a href="/zh/docs/reference/param/#pgb_hba_rules"><code>pgb_hba_rules</code></a> 完全一致，建议在全局配置统一的 <a href="/zh/docs/reference/param/#pgb_default_hba_rules"><code>pgb_default_hba_rules</code></a>，针对特定集群使用 <a href="/zh/docs/reference/param/#pgb_hba_rules"><code>pgb_hba_rules</code></a> 进行额外定制。两个参数中的规则都会依次应用，后者优先级更高。</p>
<hr>
<h2 id="pg_backup"><code>PG_BACKUP</code></h2>
<p>本节定义了用于 <a href="https://pgbackrest.org/">pgBackRest</a> 的变量，它被用于 PGSQL 时间点恢复 PITR 。</p>
<p>查看 <a href="/zh/docs/pgsql/pitr">PGSQL 备份 &amp; PITR</a> 以获取详细信息。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pgbackrest_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># 在 pgsql 主机上启用 pgBackRest 吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbackrest_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># 初始化时删除 pg 备份数据？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbackrest_log_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/log/pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbackrest 日志目录，默认为 `/pg/log/pgbackrest`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbackrest_method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbackrest 仓库方法：local, minio, [用户定义...]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbackrest_repo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># pgbackrest 仓库：https://pgbackrest.org/configuration.html#section-repository</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">local</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># 默认使用本地 posix 文件系统的 pgbackrest 仓库</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/backup             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 本地备份目录，默认为 `/pg/backup`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">count   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 按计数保留完整备份</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># 使用本地文件系统仓库时，最多保留 3 个完整备份，至少保留 2 个</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># pgbackrest 的可选 minio 仓库</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 是与 s3 兼容的，所以使用 s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss.pigsty      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 端点域名，默认为 `sss.pigsty`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 区域，默认为 us-east-1，对 minio 无效</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 桶名称，默认为 `pgsql`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbackrest           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbackrest 的 minio 用户访问密钥</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_key_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">S3User.Backup </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbackrest 的 minio 用户秘密密钥</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_uri_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 对 minio 使用路径风格的 uri，而不是主机风格</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pgbackrest            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 备份路径，默认为 `/pgbackrest`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storage_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9000</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio 端口，默认为 9000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storage_ca_file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/etc/pki/ca.crt </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio ca 文件路径，默认为 `/etc/pki/ca.crt`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">bundle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">y</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># 将小文件打包成一个文件</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">cipher_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aes-256-cbc     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 为远程备份仓库启用 AES 加密</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">cipher_pass</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgBackRest      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># AES 加密密码，默认为 &#39;pgBackRest&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">time    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 在 minio 仓库上按时间保留完整备份</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">14</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># 保留过去 14 天的完整备份</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pgbackrest_enabled"><code>pgbackrest_enabled</code></h3>
<p>参数名称： <code>pgbackrest_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否在 PGSQL 节点上启用 pgBackRest？默认值为： <code>true</code></p>
<p>在使用本地文件系统备份仓库（<code>local</code>）时，只有集群主库才会真正启用 <code>pgbackrest</code>。其他实例只会初始化一个空仓库。</p>
<h3 id="pgbackrest_clean"><code>pgbackrest_clean</code></h3>
<p>参数名称： <code>pgbackrest_clean</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>初始化时删除 PostgreSQL 备份数据吗？默认值为 <code>true</code>。</p>
<h3 id="pgbackrest_log_dir"><code>pgbackrest_log_dir</code></h3>
<p>参数名称： <code>pgbackrest_log_dir</code>， 类型： <code>path</code>， 层次：<code>C</code></p>
<p>pgBackRest 日志目录，默认为 <code>/pg/log/pgbackrest</code>，<a href="/zh/docs/reference/param/#promtail"><code>promtail</code></a> 日志代理会引用此参数收集日志。</p>
<h3 id="pgbackrest_method"><code>pgbackrest_method</code></h3>
<p>参数名称： <code>pgbackrest_method</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>pgBackRest 仓库方法：默认可选项为：<code>local</code>、<code>minio</code> 或其他用户定义的方法，默认为 <code>local</code>。</p>
<p>此参数用于确定用于 pgBackRest 的仓库，所有可用的仓库方法都在 <a href="/zh/docs/reference/param/#pgbackrest_repo"><code>pgbackrest_repo</code></a> 中定义。</p>
<p>Pigsty 默认使用 <code>local</code> 备份仓库，这将在主实例的 <code>/pg/backup</code> 目录上创建一个备份仓库。底层存储路径由 <a href="/zh/docs/reference/param/#pg_fs_bkup"><code>pg_fs_bkup</code></a> 指定。</p>
<h3 id="pgbackrest_repo"><code>pgbackrest_repo</code></h3>
<p>参数名称： <code>pgbackrest_repo</code>， 类型： <code>dict</code>， 层次：<code>G/C</code></p>
<p>pgBackRest 仓库文档：https://pgbackrest.org/configuration.html#section-repository</p>
<p>默认值包括两种仓库方法：<code>local</code> 和 <code>minio</code>，定义如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pgbackrest_repo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># pgbackrest 仓库：https://pgbackrest.org/configuration.html#section-repository</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">local</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># 默认使用本地 posix 文件系统的 pgbackrest 仓库</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/backup             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 本地备份目录，默认为 `/pg/backup`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">count   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 按计数保留完整备份</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># 使用本地文件系统仓库时，最多保留 3 个完整备份，至少保留 2 个</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># pgbackrest 的可选 minio 仓库</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 是与 s3 兼容的，所以使用 s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss.pigsty      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 端点域名，默认为 `sss.pigsty`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 区域，默认为 us-east-1，对 minio 无效</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 桶名称，默认为 `pgsql`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbackrest           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbackrest 的 minio 用户访问密钥</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_key_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">S3User.Backup </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbackrest 的 minio 用户秘密密钥</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_uri_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 对 minio 使用路径风格的 uri，而不是主机风格</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pgbackrest            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio 备份路径，默认为 `/pgbackrest`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storage_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9000</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio 端口，默认为 9000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storage_ca_file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/etc/pki/ca.crt </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio ca 文件路径，默认为 `/etc/pki/ca.crt`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">bundle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">y</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># 将小文件打包成一个文件</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">cipher_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aes-256-cbc     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 为远程备份仓库启用 AES 加密</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">cipher_pass</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgBackRest      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># AES 加密密码，默认为 &#39;pgBackRest&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">time    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 在 minio 仓库上按时间保留完整备份</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">14</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># 保留过去 14 天的完整备份</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>您可以定义新的备份仓库，例如使用 AWS S3，GCP 或其他云供应商的 S3 兼容存储服务。</p>
<hr>
<h2 id="pg_service"><code>PG_SERVICE</code></h2>
<p>本节介绍如何将PostgreSQL服务暴露给外部世界，包括：</p>
<ul>
<li>使用<code>haproxy</code>在不同的端口上暴露不同的PostgreSQL服务</li>
<li>使用<code>vip-manager</code>将可选的L2 VIP绑定到主实例</li>
<li>在基础设施节点上使用<code>dnsmasq</code>注册集群/实例DNS记录</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_weight</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#实例 # 服务中的相对负载均衡权重，默认为100，范围0-255</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_service_dest</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 如果svc.dest=&#39;default&#39;，则此为默认服务目的地</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># postgres默认服务定义</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: primary ,port: 5433 ,dest: default  ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replica ,port: 5434 ,dest: default  ,check: /read-only ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary` || pg_role == `offline` ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: default ,port: 5436 ,dest: postgres ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: offline ,port: 5438 ,dest: postgres ,check: /replica   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `offline` || pg_offline_query ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `replica` &amp;&amp; !pg_offline_query]&#34;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_vip_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># 为pgsql主要实例启用l2 vip吗? 默认为false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_vip_address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">127.0.0.1</span><span style="color:#000">/24     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># `&lt;ipv4&gt;/&lt;mask&gt;`格式的vip地址，如果启用vip则需要</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth0           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># vip网络接口监听，默认为eth0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dns_suffix</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># pgsql dns后缀，默认为空</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dns_target</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">auto              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># auto、primary、vip、none或特定的ip</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_weight"><code>pg_weight</code></h3>
<p>参数名称： <code>pg_weight</code>， 类型： <code>int</code>， 层次：<code>G</code></p>
<p>服务中的相对负载均衡权重，默认为100，范围0-255。</p>
<p>默认值： <code>100</code>。您必须在实例变量中定义它，并<a href="/zh/docs/pgsql/admin#%E9%87%8D%E8%BD%BD%E6%9C%8D%E5%8A%A1">重载服务</a>以生效。</p>
<h3 id="pg_service_provider"><code>pg_service_provider</code></h3>
<p>参数名称： <code>pg_service_provider</code>， 类型： <code>string</code>， 层次：<code>G/C</code></p>
<p>专用的haproxy节点组名，或默认为本地节点的空字符串。</p>
<p>如果指定，PostgreSQL服务将注册到专用的haproxy节点组，而不是当下的 PGSQL 集群节点。</p>
<p>请记住为每个服务在专用的 haproxy 节点上分配<strong>唯一</strong>的端口！</p>
<p>例如，如果我们在3节点的 <code>pg-test</code> 集群上定义以下参数：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_service_provider</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">infra      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># use load balancer on group `infra`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># alloc port 10001 and 10002 for pg-test primary/replica service  </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: primary ,port: 10001 ,dest: postgres  ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replica ,port: 10002 ,dest: postgres  ,check: /read-only ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary` || pg_role == `offline` ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_default_service_dest"><code>pg_default_service_dest</code></h3>
<p>参数名称： <code>pg_default_service_dest</code>， 类型： <code>enum</code>， 层次：<code>G/C</code></p>
<p>当定义一个<a href="/zh/docs/pgsql/svc#define-service">服务</a>时，如果 <code>svc.dest='default'</code>，此参数将用作默认值。</p>
<p>默认值： <code>pgbouncer</code>，意味着5433主服务和5434副本服务将默认将流量路由到 pgbouncer。</p>
<p>如果您不想使用pgbouncer，将其设置为<code>postgres</code>。流量将直接路由到 postgres。</p>
<h3 id="pg_default_services"><code>pg_default_services</code></h3>
<p>参数名称： <code>pg_default_services</code>， 类型： <code>service[]</code>， 层次：<code>G/C</code></p>
<p>postgres默认服务定义</p>
<p>默认值是四个默认服务定义，如<a href="/zh/docs/pgsql/svc#%E6%9C%8D%E5%8A%A1%E6%A6%82%E8%BF%B0">PGSQL Service</a>所述</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># postgres default service definitions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: primary ,port: 5433 ,dest: default  ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replica ,port: 5434 ,dest: default  ,check: /read-only ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary` || pg_role == `offline` ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: default ,port: 5436 ,dest: postgres ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: offline ,port: 5438 ,dest: postgres ,check: /replica   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `offline` || pg_offline_query ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `replica` &amp;&amp; !pg_offline_query]&#34;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_vip_enabled"><code>pg_vip_enabled</code></h3>
<p>参数名称： <code>pg_vip_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>为 PGSQL 集群启用 L2 VIP吗？默认值是<code>false</code>，表示不创建 L2 VIP。</p>
<p>启用 L2 VIP 后，会有一个 VIP 绑定在集群主实例节点上，由 <code>vip-manager</code> 管理，根据 <code>etcd</code> 中的数据进行判断。</p>
<p>L2 VIP只能在相同的L2网络中使用，这可能会对您的网络拓扑产生额外的限制。</p>
<h3 id="pg_vip_address"><code>pg_vip_address</code></h3>
<p>参数名称： <code>pg_vip_address</code>， 类型： <code>cidr4</code>， 层次：<code>C</code></p>
<p>如果启用vip，则需要<code>&lt;ipv4&gt;/&lt;mask&gt;</code>格式的vip地址。</p>
<p>默认值： <code>127.0.0.1/24</code>。这个值由两部分组成：<code>ipv4</code>和<code>mask</code>，用<code>/</code>分隔。</p>
<h3 id="pg_vip_interface"><code>pg_vip_interface</code></h3>
<p>参数名称： <code>pg_vip_interface</code>， 类型： <code>string</code>， 层次：<code>C/I</code></p>
<p>vip network interface to listen, <code>eth0</code> by default.</p>
<p>L2 VIP 监听的网卡接口，默认为 <code>eth0</code>。</p>
<p>它应该是您节点的首要网卡名，即您在配置清单中使用的IP地址。</p>
<p>如果您的节点有多块名称不同的网卡，您可以在实例变量上进行覆盖：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg-test</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role: replica ,pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth0 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 2, pg_role: primary ,pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth1 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 3, pg_role: replica ,pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth2 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">pg_vip_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># 为这个集群启用L2 VIP，默认绑定到主实例</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">pg_vip_address: 10.10.10.3/24 # L2网络CIDR: 10.10.10.0/24, vip地址</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># pg_vip_interface: eth1      # 如果您的节点有统一的接口，您可以在这里定义它</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_dns_suffix"><code>pg_dns_suffix</code></h3>
<p>参数名称： <code>pg_dns_suffix</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>PostgreSQL DNS 名称后缀，默认为空字符串。</p>
<p>在默认情况下，PostgreQL 集群名会作为 DNS 域名注册到 Infra 节点的 <code>dnsmasq</code> 中对外提供解析。</p>
<p>您可以通过本参数指定一个域名后缀，这样会使用 <code>{{ pg_cluster }}{{ pg_dns_suffix }}</code> 作为集群 DNS 名称。</p>
<p>例如，如果您将 <code>pg_dns_suffix</code> 设置为 <code>.db.vip.company.tld</code>，那么 <code>pg-test</code> 的集群 DNS 名称将是 <code>pg-test.db.vip.company.tld</code></p>
<h3 id="pg_dns_target"><code>pg_dns_target</code></h3>
<p>参数名称： <code>pg_dns_target</code>， 类型： <code>enum</code>， 层次：<code>C</code></p>
<p>Could be: <code>auto</code>, <code>primary</code>, <code>vip</code>, <code>none</code>, or an ad hoc ip address, which will be the target IP address of cluster DNS record.</p>
<p>default values: <code>auto</code> , which will bind to <code>pg_vip_address</code> if <code>pg_vip_enabled</code>, or fallback to cluster primary instance ip address.</p>
<ul>
<li><code>vip</code>: bind to <code>pg_vip_address</code></li>
<li><code>primary</code>: resolve to cluster primary instance ip address</li>
<li><code>auto</code>: resolve to <code>pg_vip_address</code> if <code>pg_vip_enabled</code>, or fallback to cluster primary instance ip address.</li>
<li><code>none</code>: do not bind to any ip address</li>
<li><code>&lt;ipv4&gt;</code>: bind to the given IP address</li>
</ul>
<p>可以是：<code>auto</code>、<code>primary</code>、<code>vip</code>、<code>none</code>或一个特定的IP地址，它将是集群DNS记录的解析目标IP地址。</p>
<p>默认值： <code>auto</code>，如果<code>pg_vip_enabled</code>，将绑定到<code>pg_vip_address</code>，否则会回退到集群主实例的 IP 地址。</p>
<ul>
<li><code>vip</code>：绑定到<code>pg_vip_address</code></li>
<li><code>primary</code>：解析为集群主实例IP地址</li>
<li><code>auto</code>：如果 <a href="/zh/docs/reference/param/#pg_vip_enabled"><code>pg_vip_enabled</code></a>，解析为 <a href="/zh/docs/reference/param/#pg_vip_address"><code>pg_vip_address</code></a>，或回退到集群主实例ip地址。</li>
<li><code>none</code>：不绑定到任何ip地址</li>
<li><code>&lt;ipv4&gt;</code>：绑定到指定的IP地址</li>
</ul>
<hr>
<h2 id="pg_exporter"><code>PG_EXPORTER</code></h2>
<p>PG Exporter 用于监控 PostgreSQL 数据库与 Pgbouncer 连接池的状态。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># 在 pgsql 主机上启用 pg_exporter 吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_config</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_exporter.yml   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pg_exporter 配置文件名</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_cache_ttls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;1,10,60,300&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># pg_exporter 收集器 ttl 阶段（秒），默认为 &#39;1,10,60,300&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9630</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># pg_exporter 监听端口，默认为 9630</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_params</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;sslmode=disable&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># pg_exporter dsn 的额外 url 参数</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># 如果指定，将覆盖自动生成的 pg dsn</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_auto_discovery</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># 启用自动数据库发现？默认启用</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_exclude_database</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;template0,template1,postgres&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 在自动发现过程中不会被监控的数据库的 csv 列表</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_include_database</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># 在自动发现过程中将被监控的数据库的 csv 列表</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_connect_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">200</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># pg_exporter 连接超时（毫秒），默认为 200</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># 覆盖 pg_exporter 的额外选项</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># 在 pgsql 主机上启用 pgbouncer_exporter 吗？</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9631</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># pgbouncer_exporter 监听端口，默认为 9631</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># 如果指定，将覆盖自动生成的 pgbouncer dsn</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># 覆盖 pgbouncer_exporter 的额外选项</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_exporter_enabled"><code>pg_exporter_enabled</code></h3>
<p>参数名称： <code>pg_exporter_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>是否在 PGSQL 节点上启用 pg_exporter？默认值为：<code>true</code>。</p>
<p>PG Exporter 用于监控 PostgreSQL 数据库实例，如果不想安装 pg_exporter 可以设置为 <code>false</code>。</p>
<h3 id="pg_exporter_config"><code>pg_exporter_config</code></h3>
<p>参数名称： <code>pg_exporter_config</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>pg_exporter 配置文件名，PG Exporter 和 PGBouncer Exporter 都会使用这个配置文件。默认值：<code>pg_exporter.yml</code>。</p>
<p>如果你想使用自定义配置文件，你可以在这里定义它。你的自定义配置文件应当放置于 <code>files/&lt;name&gt;.yml</code>。</p>
<p>例如，当您希望监控一个远程的 PolarDB 数据库实例时，可以使用样例配置：<code>files/polar_exporter.yml</code>。</p>
<h3 id="pg_exporter_cache_ttls"><code>pg_exporter_cache_ttls</code></h3>
<p>参数名称： <code>pg_exporter_cache_ttls</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>pg_exporter 收集器 TTL 阶梯（秒），默认为 &lsquo;1,10,60,300&rsquo;</p>
<p>默认值：<code>1,10,60,300</code>，它将为不同的度量收集器使用不同的TTL值： 1s, 10s, 60s, 300s。</p>
<p>PG Exporter 内置了缓存机制，避免多个 Prometheus 重复抓取对数据库产生不当影响，所有指标收集器按 TTL 分为四类：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">ttl_fast</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ pg_exporter_cache_ttls.split(&#39;,&#39;)[0]|int }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># critical queries</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ttl_norm</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ pg_exporter_cache_ttls.split(&#39;,&#39;)[1]|int }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># common queries</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ttl_slow</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ pg_exporter_cache_ttls.split(&#39;,&#39;)[2]|int }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># slow queries (e.g table size)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ttl_slowest</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ pg_exporter_cache_ttls.split(&#39;,&#39;)[3]|int }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># ver slow queries (e.g bloat)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>例如，在默认配置下，存活类指标默认最多缓存 <code>1s</code>，大部分普通指标会缓存 <code>10s</code>（应当与 <a href="/zh/docs/reference/param/#prometheus_scrape_interval"><code>prometheus_scrape_interval</code></a> 相同）。
少量变化缓慢的查询会有 <code>60s</code> 的TTL，极个别大开销监控查询会有 <code>300s</code> 的TTL。</p>
<h3 id="pg_exporter_port"><code>pg_exporter_port</code></h3>
<p>参数名称： <code>pg_exporter_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>pg_exporter 监听端口号，默认值为：<code>9631</code></p>
<h3 id="pg_exporter_params"><code>pg_exporter_params</code></h3>
<p>参数名称： <code>pg_exporter_params</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>pg_exporter 所使用 DSN 中额外的 URL PATH 参数。</p>
<p>默认值：<code>sslmode=disable</code>，它将禁用用于监控连接的 SSL（因为默认使用本地 unix 套接字）。</p>
<h3 id="pg_exporter_url"><code>pg_exporter_url</code></h3>
<p>参数名称： <code>pg_exporter_url</code>， 类型： <code>pgurl</code>， 层次：<code>C</code></p>
<p>如果指定了本参数，将会覆盖自动生成的 PostgreSQL DSN，使用指定的 DSN 连接 PostgreSQL 。默认值为空字符串。</p>
<p>如果没有指定此参数，PG Exporter 默认会使用以下的连接串访问 PostgreSQL ：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#000">postgres</span><span style="color:#000;font-weight:bold">:</span><span style="color:#ce5c00;font-weight:bold">//</span><span style="color:#000;font-weight:bold">{{</span> <span style="color:#000">pg_monitor_username</span> <span style="color:#000;font-weight:bold">}}:{{</span> <span style="color:#000">pg_monitor_password</span> <span style="color:#000;font-weight:bold">}}</span><span style="color:#a40000">@</span><span style="color:#000;font-weight:bold">{{</span> <span style="color:#000">pg_host</span> <span style="color:#000;font-weight:bold">}}:{{</span> <span style="color:#000">pg_port</span> <span style="color:#000;font-weight:bold">}}</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">postgres</span><span style="color:#000;font-weight:bold">{</span><span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">pg_exporter_params</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#4e9a06">&#39;&#39;</span> <span style="color:#ce5c00;font-weight:bold">%</span><span style="color:#000;font-weight:bold">}</span><span style="color:#a40000">?</span><span style="color:#000;font-weight:bold">{{</span> <span style="color:#000">pg_exporter_params</span> <span style="color:#000;font-weight:bold">}}{</span><span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">endif</span> <span style="color:#ce5c00;font-weight:bold">%</span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>当您想监控一个远程的 PostgreSQL 实例时，或者需要使用不同的监控用户/密码，配置选项时，可以使用这个参数。</p>
<h3 id="pg_exporter_auto_discovery"><code>pg_exporter_auto_discovery</code></h3>
<p>参数名称： <code>pg_exporter_auto_discovery</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>启用自动数据库发现吗？ 默认启用：<code>true</code>。</p>
<p>PG Exporter 默认会连接到 DSN 中指定的数据库 （默认为管理数据库 <code>postgres</code>） 收集全局指标，如果您希望收集所有业务数据库的指标，可以开启此选项。
PG Exporter 会自动发现目标 PostgreSQL 实例中的所有数据库，并在这些数据库中收集 <strong>库级监控指标</strong>。</p>
<h3 id="pg_exporter_exclude_database"><code>pg_exporter_exclude_database</code></h3>
<p>参数名称： <code>pg_exporter_exclude_database</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>如果启用了数据库自动发现（默认启用），在这个参数指定的列表中的数据库将不会被监控。
默认值为： <code>template0,template1,postgres</code>，即管理数据库 <code>postgres</code> 与模板数据库会被排除在自动监控的数据库之外。</p>
<p>作为例外，DSN 中指定的数据库不受此参数影响，例如，PG Exporter 如果连接的是 <code>postgres</code> 数据库，那么即使 <code>postgres</code> 在此列表中，也会被监控。</p>
<h3 id="pg_exporter_include_database"><code>pg_exporter_include_database</code></h3>
<p>参数名称： <code>pg_exporter_include_database</code>， 类型： <code>string</code>， 层次：<code>C</code></p>
<p>如果启用了数据库自动发现（默认启用），在这个参数指定的列表中的数据库才会被监控。默认值为空字符串，即不启用此功能。</p>
<p>参数的形式是由逗号分隔的数据库名称列表，例如：<code>db1,db2,db3</code>。</p>
<p>此参数相对于 [<code>pg_exporter_exclude_database</code>] 有更高的优先级，相当于白名单模式。如果您只希望监控特定的数据库，可以使用此参数。</p>
<h3 id="pg_exporter_connect_timeout"><code>pg_exporter_connect_timeout</code></h3>
<p>参数名称： <code>pg_exporter_connect_timeout</code>， 类型： <code>int</code>， 层次：<code>C</code></p>
<p>pg_exporter 连接超时（毫秒），默认为 <code>200</code> （单位毫秒）</p>
<p>当 PG Exporter 尝试连接到 PostgreSQL 数据库时，最多会等待多长时间？超过这个时间，PG Exporter 将会放弃连接并报错。</p>
<p>默认值 200毫秒 对于绝大多数场景（例如：同可用区监控）都是足够的，但是如果您监控的远程 PostgreSQL 位于另一个大洲，您可能需要增加此值以避免连接超时。</p>
<h3 id="pg_exporter_options"><code>pg_exporter_options</code></h3>
<p>参数名称： <code>pg_exporter_options</code>， 类型： <code>arg</code>， 层次：<code>C</code></p>
<p>传给 PG Exporter 的命令行参数，默认值为：<code>&quot;&quot;</code> 空字符串。</p>
<p>当使用空字符串时，会使用默认的命令参数：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>% <span style="color:#204a87;font-weight:bold">if</span> pg_exporter_port !<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;&#39;</span> %<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PG_EXPORTER_OPTS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;--web.listen-address=:{{ pg_exporter_port }} {{ pg_exporter_options }}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>% <span style="color:#204a87;font-weight:bold">else</span> %<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PG_EXPORTER_OPTS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;--web.listen-address=:{{ pg_exporter_port }} --log.level=info&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>% endif %<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>注意，请不要在本参数中覆盖 <a href="/zh/docs/reference/param/#pg_exporter_port"><code>pg_exporter_port</code></a> 的端口配置。</p>
<h3 id="pgbouncer_exporter_enabled"><code>pgbouncer_exporter_enabled</code></h3>
<p>参数名称： <code>pgbouncer_exporter_enabled</code>， 类型： <code>bool</code>， 层次：<code>C</code></p>
<p>在 PGSQL 节点上，是否启用 pgbouncer_exporter ？默认值为：<code>true</code>。</p>
<h3 id="pgbouncer_exporter_port"><code>pgbouncer_exporter_port</code></h3>
<p>参数名称： <code>pgbouncer_exporter_port</code>， 类型： <code>port</code>， 层次：<code>C</code></p>
<p>pgbouncer_exporter 监听端口号，默认值为：<code>9631</code></p>
<h3 id="pgbouncer_exporter_url"><code>pgbouncer_exporter_url</code></h3>
<p>参数名称： <code>pgbouncer_exporter_url</code>， 类型： <code>pgurl</code>， 层次：<code>C</code></p>
<p>如果指定了本参数，将会覆盖自动生成的 pgbouncer DSN，使用指定的 DSN 连接 pgbouncer。默认值为空字符串。</p>
<p>如果没有指定此参数，Pgbouncer Exporter 默认会使用以下的连接串访问 Pgbouncer：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>postgres://{{ pg_monitor_username }}:{{ pg_monitor_password }}@:{{ pgbouncer_port }}/pgbouncer?host={{ pg_localhost }}&amp;sslmode=disable
</span></span></code></pre></div><p>当您想监控一个远程的 Pgbouncer 实例时，或者需要使用不同的监控用户/密码，配置选项时，可以使用这个参数。</p>
<h3 id="pgbouncer_exporter_options"><code>pgbouncer_exporter_options</code></h3>
<p>参数名称： <code>pgbouncer_exporter_options</code>， 类型： <code>arg</code>， 层次：<code>C</code></p>
<p>传给 Pgbouncer Exporter 的命令行参数，默认值为：<code>&quot;&quot;</code> 空字符串。</p>
<p>当使用空字符串时，会使用默认的命令参数：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>% <span style="color:#204a87;font-weight:bold">if</span> pgbouncer_exporter_options !<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;&#39;</span> %<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PG_EXPORTER_OPTS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;--web.listen-address=:{{ pgbouncer_exporter_port }} {{ pgbouncer_exporter_options }}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>% <span style="color:#204a87;font-weight:bold">else</span> %<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PG_EXPORTER_OPTS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;--web.listen-address=:{{ pgbouncer_exporter_port }} --log.level=info&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>% endif %<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>注意，请不要在本参数中覆盖 <a href="/zh/docs/reference/param/#pgbouncer_exporter_port"><code>pgbouncer_exporter_port</code></a> 的端口配置。</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e702b44e01d91c35371415f67a25ac19">3 - 扩展列表</h1>
    <div class="lead">本文列出了 Pigsty 支持的 PostgreSQL 扩展插件，以及这些插件在不同系统下的支持情况。</div>
	<p>Pigsty 中总共有 <a href="https://ext.pigsty.io/#/list"><strong>340</strong></a> 个可用扩展，其中 EL 可用 <a href="/zh/docs/pgext/list/rpm"><strong>RPM扩展</strong></a> <strong>334</strong> 个，Debian/Ubuntu 可用 <a href="/zh/docs/pgext/list/deb"><strong>DEB扩展</strong></a> <strong>326</strong> 个。
其中包括 PostgreSQL 自带的 <strong>70</strong> 个 <a href="/zh/docs/pgext/list/contrib"><strong>Contrib扩展</strong></a>。</p>
<p><a href="https://ext.pigsty.io/#/list"><img alt="pigsty-ecosystem.jpg" src="/img/pigsty/ecosystem.jpg"></a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-eccd19a576ee933ff16667af4533c033">4 - 文件结构</h1>
    <div class="lead">Pigsty 的文件系统结构是如何设计与组织的，以及各个模块使用的目录结构。</div>
	<hr>
<h2 id="pigsty-fhs">Pigsty FHS</h2>
<p>Pigsty 的主目录默认放置于于 <code>~/pigsty</code>，该目录下的文件结构如下所示：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># pigsty</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@app                    # 额外的示例应用资源</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@bin                    # bin 脚本</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@docs                   # 文档（可docsify化）</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@files                  # ansible 文件资源</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@pigsty       # pigsty 配置模板文件</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@prometheus   # prometheus 规则定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@grafana      # grafana 仪表盘</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@postgres     # /pg/bin/ 脚本</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@migration    # pgsql 迁移任务定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@pki          # 自签名 CA 和证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@roles                  # ansible 剧本实现</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@templates              # ansible 模板文件</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@vagrant                # Vagrant 沙箱虚拟机定义模板</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@terraform              # Terraform 云虚拟机申请模板</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----configure               # 配置向导脚本</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----ansible.cfg             # ansible 默认配置文件</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----pigsty.yml              # pigsty 默认配置文件</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----*.yml                   # ansible 剧本</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># /etc/pigsty/</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@targets                # 基于文件的服务发现目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@dashboards             # grafana 监控面板</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@datasources            # grafana 数据源</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@playbooks              # ansible 剧本</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span>
</span></span></code></pre></div><hr>
<h2 id="ca-fhs">CA FHS</h2>
<p>Pigsty 的自签名 CA 位于 Pigsty 主目录下的 <code>files/pki/</code>。</p>
<p><strong>你必须妥善保管 CA 的密钥文件</strong>：<code>files/pki/ca/ca.key</code>，该密钥是在 <code>install.yml</code> 或 <code>infra.yml</code> 的 <code>ca</code> 角色负责生成的。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># pigsty/files/pki</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@ca                      # 自签名 CA 密钥和证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#         ^-----@ca.key           # 非常重要：保守其秘密</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#         ^-----@ca.crt           # 非常重要：在所有地方都受信任</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@csr                     # 签名请求 csr</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@misc                    # 杂项证书，已签发证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@etcd                    # etcd 服务器证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@minio                   # minio 服务器证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@nginx                   # nginx SSL 证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@infra                   # infra 客户端证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@pgsql                   # pgsql 服务器证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@mongo                   # mongodb/ferretdb 服务器证书</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@mysql                   # mysql 服务器证书（占位符）</span>
</span></span></code></pre></div><p>被 Pigsty 所管理的节点将安装以下证书文件：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>/etc/pki/ca.crt                             # 所有节点都添加的根证书
</span></span><span style="display:flex;"><span>/etc/pki/ca-trust/source/anchors/ca.crt     # 软链接到系统受信任的锚点
</span></span></code></pre></div><p>所有 infra 节点都会有以下证书：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>/etc/pki/infra.crt                          # infra 节点证书
</span></span><span style="display:flex;"><span>/etc/pki/infra.key                          # infra 节点密钥
</span></span></code></pre></div><p>当您的管理节点出现故障时，<code>files/pki</code> 目录与 <code>pigsty.yml</code> 文件应当在备份的管理节点上可用。你可以用 <code>rsync</code> 做到这一点。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># run on meta-1, rsync to meta2</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>rsync -avz ./ meta-2:~/pigsty  
</span></span></code></pre></div><hr>
<h2 id="node-fhs">NODE FHS</h2>
<p>节点的数据目录由参数 <a href="/zh/docs/reference/param#node_data"><code>node_data</code></a> 指定，默认为 <code>/data</code>，由 <code>root</code> 用户持有，权限为 <code>0777</code>。</p>
<p>每个组件的默认数据目录都位于这个数据库目录下，如下所示：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/data
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@postgres                   # postgres 数据库目录</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@backups                    # postgres 备份数据目录（没有专用备份盘时）</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@redis                      # redis 数据目录（多实例共用）</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@minio                      # minio 数据目录（单机单盘模式）</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@etcd                       # etcd 主数据目录</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@prometheus                 # prometheus 监控时序数据目录</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@loki                       # Loki 日志数据目录</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@docker                     # Docker数据目录</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@...                        # 其他组件的数据目录</span>
</span></span></code></pre></div><hr>
<h2 id="prometheus-fhs">Prometheus FHS</h2>
<p>Prometheus 的主配置文件则位于 <a href="https://github.com/Vonng/pigsty/blob/main/roles/infra/templates/prometheus/prometheus.yml.j2"><code>roles/infra/templates/prometheus/prometheus.yml.j2</code></a> ，并渲染至所有基础设施节点的 <code>/etc/prometheus/prometheus.yml</code>。</p>
<p>Prometheus 相关的脚本与规则定义放置于 pigsty 主目录下的 <a href="https://github.com/Vonng/pigsty/tree/master/files/prometheus"><code>files/prometheus/</code></a> 目录，会被拷贝至所有基础设施节点的 <code>/etc/prometheus/</code> 下。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># /etc/prometheus/</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----prometheus.yml              # Prometheus 主配置文件</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@bin                        # 工具脚本：检查配置，显示状态，重载配置，重建集群</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@rules                      # 记录和报警规则定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----agent.yml         # agnet 规则和报警</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----infra.yml         # infra 规则和报警</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----etcd.yml          # etcd 规则和报警</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----node.yml          # node  规则和报警</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----pgsql.yml         # pgsql 规则和报警</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----redis.yml         # redis 规则和报警</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----minio.yml         # minio 规则和报警</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----mysql.yml         # mysql 规则和报警（占位）</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@targets                    # 基于文件的服务发现目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@infra            # infra 静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@node             # node  静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@pgsql            # pgsql 静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@pgrds            # pgsql 远程RDS目标</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@redis            # redis 静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@minio            # minio 静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@mongo            # mongo 静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@mysql            # mysql 静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@etcd             # etcd 静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@ping             # ping 静态目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@patroni          # patroni 静态目标定义 （当patroni启用SSL时使用此目录）</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@.....            # 其他监控目标定义</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># /etc/alertmanager.yml              # 告警组件主配置文件</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># /etc/blackbox.yml                  # 黑盒探测主配置文件</span>
</span></span></code></pre></div><hr>
<h2 id="postgres-fhs">Postgres FHS</h2>
<p>以下参数与PostgreSQL数据库目录结构相关:</p>
<ul>
<li><a href="/zh/docs/reference/param#pg_dbsu_home">pg_dbsu_home</a>： Postgres 默认用户的家目录，默认为<code>/var/lib/pgsql</code></li>
<li><a href="/zh/docs/reference/param#pg_bin_dir">pg_bin_dir</a>： Postgres二进制目录，默认为<code>/usr/pgsql/bin/</code></li>
<li><a href="/zh/docs/reference/param#pg_data">pg_data</a>：Postgres数据库目录，默认为<code>/pg/data</code></li>
<li><a href="/zh/docs/reference/param#pg_fs_main">pg_fs_main</a>：Postgres主数据盘挂载点，默认为<code>/data</code></li>
<li><a href="/zh/docs/reference/param#pg_fs_bkup">pg_fs_bkup</a>：Postgres备份盘挂载点，默认为<code>/var/backups</code>（可选，也可以选择备份到主数据盘上的子目录）</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 工作假设:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#   {{ pg_fs_main }} 主数据目录，默认位置：`/data`          [快速SSD]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#   {{ pg_fs_bkup }} 备份数据盘，默认位置：`/data/backups`  [廉价HDD]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#--------------------------------------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># 默认配置:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#     pg_fs_main = /data             高速SSD</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#     pg_fs_bkup = /data/backups     廉价HDD (可选)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#     /pg      -&gt; /data/postgres/pg-test-15    (软链接)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#     /pg/data -&gt; /data/postgres/pg-test-15/data</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#--------------------------------------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">create postgresql directories</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">tags</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_dir</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">become</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">yes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">block</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">make main and backup data dir</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path={{ item }} state=directory owner=root mode=0777</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">with_items</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_fs_main }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_fs_bkup }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># pg_cluster_dir:    &#34;{{ pg_fs_main }}/postgres/{{ pg_cluster }}-{{ pg_version }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">create postgres directories</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path={{ item }} state=directory owner={{ pg_dbsu }} group=postgres mode=0700</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">with_items</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_fs_main }}/postgres&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/bin&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/log&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/tmp&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/cert&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/conf&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/data&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/meta&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/stat&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/change&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_backup_dir }}/backup&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>数据文件结构</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 真实目录</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{{</span> pg_fs_main <span style="color:#ce5c00;font-weight:bold">}}</span>     /data                      <span style="color:#8f5902;font-style:italic"># 顶层数据目录，通常为高速SSD挂载点</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{{</span> pg_dir_main <span style="color:#ce5c00;font-weight:bold">}}</span>    /data/postgres             <span style="color:#8f5902;font-style:italic"># 包含所有 Postgres 实例的数据目录（可能有多个实例/不同版本）</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{{</span> pg_cluster_dir <span style="color:#ce5c00;font-weight:bold">}}</span> /data/postgres/pg-test-15  <span style="color:#8f5902;font-style:italic"># 包含了 `pg-test` 集群的数据 (大版本是15)</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/bin            <span style="color:#8f5902;font-style:italic"># 关于 PostgreSQL 的实用脚本</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/log            <span style="color:#8f5902;font-style:italic"># 日志：postgres/pgbouncer/patroni/pgbackrest</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/tmp            <span style="color:#8f5902;font-style:italic"># 临时文件，例如渲染出的 SQL 文件</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/cert           <span style="color:#8f5902;font-style:italic"># postgres 服务器证书</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/conf           <span style="color:#8f5902;font-style:italic"># postgres 相关配置文件索引</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/data           <span style="color:#8f5902;font-style:italic"># postgres 主数据目录</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/meta           <span style="color:#8f5902;font-style:italic"># postgres 身份信息</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/stat           <span style="color:#8f5902;font-style:italic"># 统计信息，日志报表，汇总摘要</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/change         <span style="color:#8f5902;font-style:italic"># 变更记录</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/backup         <span style="color:#8f5902;font-style:italic"># 指向备份目录的软链接。</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{{</span> pg_fs_bkup <span style="color:#ce5c00;font-weight:bold">}}</span>     /data/backups                            <span style="color:#8f5902;font-style:italic"># 可选的备份盘目录/挂载点</span>
</span></span><span style="display:flex;"><span>                     /data/backups/postgres/pg-test-15/backup <span style="color:#8f5902;font-style:italic"># 集群备份的实际存储位置</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 软链接</span>
</span></span><span style="display:flex;"><span>/pg             -&gt;   /data/postgres/pg-test-15                <span style="color:#8f5902;font-style:italic"># pg 根软链接</span>
</span></span><span style="display:flex;"><span>/pg/data        -&gt;   /data/postgres/pg-test-15/data           <span style="color:#8f5902;font-style:italic"># pg 数据目录</span>
</span></span><span style="display:flex;"><span>/pg/backup      -&gt;   /var/backups/postgres/pg-test-15/backup  <span style="color:#8f5902;font-style:italic"># pg 备份目录</span>
</span></span></code></pre></div><p><strong>二进制文件结构</strong></p>
<p>在 EL 兼容发行版上（使用yum），PostgreSQL 默认安装位置为</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/pgsql-<span style="color:#4e9a06">${</span><span style="color:#000">pg_version</span><span style="color:#4e9a06">}</span>/
</span></span></code></pre></div><p>Pigsty 会创建一个名为 <code>/usr/pgsql</code> 的软连接，指向由 <a href="/zh/docs/reference/param#pg_version"><code>pg_version</code></a> 参数指定的实际版本，例如</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/pgsql -&gt; /usr/pgsql-15
</span></span></code></pre></div><p>因此，默认的 <a href="/zh/docs/reference/param#pg_bin_dir"><code>pg_bin_dir</code></a> 是 <code>/usr/pgsql/bin/</code>，而该路径会被添加至系统的 <code>PATH</code> 环境变量中，定义文件为：<code>/etc/profile.d/pgsql.sh</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PATH</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;/usr/pgsql/bin:/pg/bin:</span><span style="color:#000">$PATH</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PGHOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/usr/pgsql
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PGDATA</span><span style="color:#ce5c00;font-weight:bold">=</span>/pg/data
</span></span></code></pre></div><p>在 Ubuntu/Debian 上，PostgreSQL Deb 包的默认安装位置是：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/lib/postgresql/<span style="color:#4e9a06">${</span><span style="color:#000">pg_version</span><span style="color:#4e9a06">}</span>/bin
</span></span></code></pre></div><hr>
<h2 id="pgbouncer-fhs">Pgbouncer FHS</h2>
<p>Pgbouncer 使用与 <code>{{ pg_dbsu }}</code> （默认为 <code>postgres</code>） 相同的用户运行，配置文件位于<code>/etc/pgbouncer</code>。</p>
<ul>
<li><code>pgbouncer.ini</code>，连接池主配置文件</li>
<li><code>database.txt</code>：定义连接池中的数据库</li>
<li><code>userlist.txt</code>：定义连接池中的用户</li>
<li><code>pgb_hba.conf</code>：定义连接池的访问权限</li>
</ul>
<hr>
<h2 id="redis-fhs">Redis FHS</h2>
<p>Pigsty提供了对Redis部署与监控对基础支持。</p>
<p>Redis二进制使用RPM包或复制二进制的方式安装于<code>/bin/</code>中，包括</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>redis-server    
</span></span><span style="display:flex;"><span>redis-server    
</span></span><span style="display:flex;"><span>redis-cli       
</span></span><span style="display:flex;"><span>redis-sentinel  
</span></span><span style="display:flex;"><span>redis-check-rdb 
</span></span><span style="display:flex;"><span>redis-check-aof 
</span></span><span style="display:flex;"><span>redis-benchmark 
</span></span><span style="display:flex;"><span>/usr/libexec/redis-shutdown
</span></span></code></pre></div><p>对于一个名为 <code>redis-test-1-6379</code> 的 Redis 实例，与其相关的资源如下所示：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/lib/systemd/system/redis-test-1-6379.service               <span style="color:#8f5902;font-style:italic"># 服务 (在Debian系中为/lib/systemd)</span>
</span></span><span style="display:flex;"><span>/etc/redis/redis-test-1-6379.conf                               <span style="color:#8f5902;font-style:italic"># 配置 </span>
</span></span><span style="display:flex;"><span>/data/redis/redis-test-1-6379                                   <span style="color:#8f5902;font-style:italic"># 数据库目录</span>
</span></span><span style="display:flex;"><span>/data/redis/redis-test-1-6379/redis-test-1-6379.rdb             <span style="color:#8f5902;font-style:italic"># RDB文件</span>
</span></span><span style="display:flex;"><span>/data/redis/redis-test-1-6379/redis-test-1-6379.aof             <span style="color:#8f5902;font-style:italic"># AOF文件</span>
</span></span><span style="display:flex;"><span>/var/log/redis/redis-test-1-6379.log                            <span style="color:#8f5902;font-style:italic"># 日志</span>
</span></span><span style="display:flex;"><span>/var/run/redis/redis-test-1-6379.pid                            <span style="color:#8f5902;font-style:italic"># PID</span>
</span></span></code></pre></div><p>对于 Ubuntu / Debian 而言，systemd 服务的默认目录不是 <code>/usr/lib/systemd/system/</code> 而是 <code>/lib/systemd/system/</code></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-84ae7ee461c44a3c65150c096169dfc2">5 - 同类对比</h1>
    <div class="lead">本文列出了与 Pigsty 生态位有重叠的产品与项目，并比较其在特性上的差异。</div>
	<hr>
<h2 id="与-rds-对比">与 RDS 对比</h2>
<p><a href="https://pigsty.io">Pigsty</a> 是使用 AGPLv3 开源的本地优先 RDS 替代，可以部署在您自己的物理机/虚拟机上，也可以部署在云服务器上。</p>
<p>因此，我们选择了全球份额第一的亚马逊云 <a href="https://aws.amazon.com/cn/rds/postgresql/">AWS RDS for PostgreSQL</a>，以及中国市场份额第一的阿里云 <a href="https://www.alibabacloud.com/zh/product/apsaradb-for-rds-postgresql">RDS for PostgreSQL</a> 作为参照对象。</p>
<p>阿里云 RDS 与 AWS RDS 均为闭源云数据库服务，通过租赁模式，仅在公有云上对外提供，以下对比基于最新的 PostgreSQL 16 主干版本进行，对比截止日期为 2024 年 2 月份。</p>
<hr>
<h3 id="功能特性">功能特性</h3>
<table>
<thead>
<tr>
<th><strong>指标</strong></th>
<th><strong>Pigsty</strong></th>
<th><strong>Aliyun RDS</strong></th>
<th><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>大版本支持</td>
<td>12 - 17</td>
<td>12 - 17</td>
<td>12 - 17</td>
</tr>
<tr>
<td>只读从库</td>
<td><i class="fas fa-circle-check text-success"></i> 支持任意数量只读从库</td>
<td><i class="fas fa-circle-xmark text-danger"></i> 备实例不对用户开放</td>
<td><i class="fas fa-circle-xmark text-danger"></i> 备实例不对用户开放</td>
</tr>
<tr>
<td>读写分离</td>
<td><i class="fas fa-circle-check text-success"></i> 支持端口区分读写流量</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> 独立收费组件</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> 独立收费组件</td>
</tr>
<tr>
<td>快慢分离</td>
<td><i class="fas fa-circle-check text-success"></i> 支持离线 ETL 实例</td>
<td><i class="fas fa-circle-xmark text-danger"></i> 未见相关特性</td>
<td><i class="fas fa-circle-xmark text-danger"></i> 未见相关特性</td>
</tr>
<tr>
<td>异地灾备</td>
<td><i class="fas fa-circle-check text-success"></i> 支持备份集群</td>
<td><i class="fas fa-circle-check text-success"></i> 支持多可用区部署</td>
<td><i class="fas fa-circle-check text-success"></i> 支持多可用区部署</td>
</tr>
<tr>
<td>延迟从库</td>
<td><i class="fas fa-circle-check text-success"></i> 支持延迟实例</td>
<td><i class="fas fa-circle-xmark text-danger"></i> 未见相关特性</td>
<td><i class="fas fa-circle-xmark text-danger"></i> 未见相关特性</td>
</tr>
<tr>
<td>负载均衡</td>
<td><i class="fas fa-circle-check text-success"></i> HAProxy / LVS</td>
<td><i class="fas fa-circle-check text-success"></i> 独立收费组件</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> 独立收费组件</td>
</tr>
<tr>
<td>连接池</td>
<td><i class="fas fa-circle-check text-success"></i> Pgbouncer</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> 独立收费组件：RDS</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> 独立收费组件：RDS Proxy</td>
</tr>
<tr>
<td>高可用</td>
<td><i class="fas fa-circle-check text-success"></i> Patroni / etcd</td>
<td><i class="fas fa-circle-check text-success"></i> 需高可用版提供支持</td>
<td><i class="fas fa-circle-check text-success"></i> 需高可用版提供支持</td>
</tr>
<tr>
<td>时间点恢复</td>
<td><i class="fas fa-circle-check text-success"></i> pgBackRest / MinIO</td>
<td><i class="fas fa-circle-check text-success"></i> 提供备份支持</td>
<td><i class="fas fa-circle-check text-success"></i> 提供备份支持</td>
</tr>
<tr>
<td>指标监控</td>
<td><i class="fas fa-circle-check text-success"></i> Prometheus / Exporter</td>
<td><i class="fas fa-circle-check text-secondary"></i> 免费基础版/收费进阶版</td>
<td><i class="fas fa-circle-check text-secondary"></i>  免费基础版/收费进阶版</td>
</tr>
<tr>
<td>日志采集</td>
<td><i class="fas fa-circle-check text-success"></i> Loki / Promtail</td>
<td><i class="fas fa-circle-check text-success"></i>  基础支持</td>
<td><i class="fas fa-circle-check text-success"></i> 基础支持</td>
</tr>
<tr>
<td>可视化系统</td>
<td><i class="fas fa-circle-check text-success"></i> Grafana / Echarts</td>
<td><i class="fas fa-circle-check text-secondary"></i> 提供基本监控</td>
<td><i class="fas fa-circle-check text-secondary"></i> 提供基本监控</td>
</tr>
<tr>
<td>告警聚合通知</td>
<td><i class="fas fa-circle-check text-success"></i> AlterManager</td>
<td><i class="fas fa-circle-check text-success"></i> 基础支持</td>
<td><i class="fas fa-circle-check text-success"></i> 基础支持</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="重要扩展">重要扩展</h3>
<p>这里列出了一些重要扩展，对比基于最新的 PostgreSQL 16 主干版本进行，截止至 2024-02-28</p>
<ul>
<li><a href="/zh/docs/reference/extension/"><strong>Pigsty 扩展列表</strong></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/PostgreSQLReleaseNotes/postgresql-extensions.html"><strong>AWS RDS 扩展列表</strong></a>:</li>
<li><a href="https://help.aliyun.com/zh/rds/apsaradb-rds-for-postgresql/extensions-supported-by-apsaradb-rds-for-postgresql"><strong>阿里云 RDS 扩展列表</strong></a></li>
</ul>
<table>
<thead>
<tr>
<th><strong>扩展名称</strong></th>
<th><strong>Pigsty RDS</strong> / PGDG 官方仓库</th>
<th style="text-align:center"><strong>阿里云 RDS</strong></th>
<th style="text-align:center"><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>加装扩展</td>
<td><i class="fas fa-circle-check text-success"></i> 自由加装</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i> 不允许</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i> 不允许</td>
</tr>
<tr>
<td>地理空间</td>
<td><i class="fas fa-circle-check text-success"></i> PostGIS 3.4.2</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PostGIS 3.3.4 / Ganos 6.1</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PostGIS 3.4.1</td>
</tr>
<tr>
<td>雷达点云</td>
<td><i class="fas fa-circle-check text-success"></i> PG PointCloud 1.2.5</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> Ganos PointCloud 6.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>向量嵌入</td>
<td><i class="fas fa-circle-check text-success"></i> PGVector 0.6.1 / Svector 0.5.6</td>
<td style="text-align:center"><i class="fas fa-triangle-exclamation text-secondary"></i> pase 0.0.1</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PGVector 0.6</td>
</tr>
<tr>
<td>机器学习</td>
<td><i class="fas fa-circle-check text-success"></i> PostgresML 2.8.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>时序扩展</td>
<td><i class="fas fa-circle-check text-success"></i> TimescaleDB 2.14.2</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>水平分布式</td>
<td><i class="fas fa-circle-check text-success"></i> Citus 12.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>列存扩展</td>
<td><i class="fas fa-circle-check text-success"></i> Hydra 1.1.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>全文检索</td>
<td><i class="fas fa-circle-check text-success"></i> pg_bm25 0.5.6<br /></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>图数据库</td>
<td><i class="fas fa-circle-check text-success"></i> Apache AGE 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>GraphQL</td>
<td><i class="fas fa-circle-check text-success"></i> PG GraphQL 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>OLAP</td>
<td><i class="fas fa-circle-check text-success"></i> pg_analytics 0.5.6</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>消息队列</td>
<td><i class="fas fa-circle-check text-success"></i> pgq 3.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>DuckDB</td>
<td><i class="fas fa-circle-check text-success"></i> duckdb_fdw 1.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>模糊分词</td>
<td><i class="fas fa-circle-check text-success"></i> zhparser 1.1 / pg_bigm 1.2</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> zhparser 1.0 / pg_jieba</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pg_bigm 1.2</td>
</tr>
<tr>
<td>CDC抽取</td>
<td><i class="fas fa-circle-check text-success"></i> wal2json 2.5.3</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> wal2json 2.5</td>
</tr>
<tr>
<td>膨胀治理</td>
<td><i class="fas fa-circle-check text-success"></i> pg_repack 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pg_repack 1.4.8</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pg_repack 1.5.0</td>
</tr>
</tbody>
</table>
<details><summary>AWS RDS PG 可用扩展</summary>
<p>AWS RDS for PostgreSQL 16 可用扩展（已刨除PG自带扩展）</p>
<table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">pg16</th>
<th style="text-align:left">pg15</th>
<th style="text-align:left">pg14</th>
<th style="text-align:left">pg13</th>
<th style="text-align:left">pg12</th>
<th style="text-align:left">pg11</th>
<th style="text-align:left">pg10</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">amcheck</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">auto_explain</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
</tr>
<tr>
<td style="text-align:left">autoinc</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">bloom</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">bool_plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">btree_gin</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">btree_gist</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
</tr>
<tr>
<td style="text-align:left">citext</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
</tr>
<tr>
<td style="text-align:left">cube</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">dblink</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">dict_int</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">dict_xsyn</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">earthdistance</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">fuzzystrmatch</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">hstore</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
</tr>
<tr>
<td style="text-align:left">hstore_plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">insert_username</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">intagg</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">intarray</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">isn</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">jsonb_plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">lo</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">ltree</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">moddatetime</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">old_snapshot</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">pageinspect</td>
<td style="text-align:left">1.12</td>
<td style="text-align:left">1.11</td>
<td style="text-align:left">1.9</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
</tr>
<tr>
<td style="text-align:left">pg_buffercache</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pg_freespacemap</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">pg_prewarm</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">pg_stat_statements</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.9</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
</tr>
<tr>
<td style="text-align:left">pg_trgm</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pg_visibility</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">pg_walinspect</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">pgcrypto</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pgrowlocks</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">pgstattuple</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
</tr>
<tr>
<td style="text-align:left">plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">plpgsql</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">pltcl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">postgres_fdw</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">refint</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">seg</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">sslinfo</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">tablefunc</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">tcn</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">tsm_system_rows</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">tsm_system_time</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">unaccent</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">uuid-ossp</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
</tbody>
</table>
</details>
<details><summary>Aliyun RDS PG 可用扩展</summary>
<p>阿里云 RDS for PostgreSQL 16 可用扩展（已刨除PG自带扩展）</p>
<table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">pg16</th>
<th style="text-align:left">pg15</th>
<th style="text-align:left">pg14</th>
<th style="text-align:left">pg13</th>
<th style="text-align:left">pg12</th>
<th style="text-align:left">pg11</th>
<th style="text-align:left">pg10</th>
<th style="text-align:left">ali_desc</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">bloom</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">提供一种基于布鲁姆过滤器的索引访问方法。</td>
</tr>
<tr>
<td style="text-align:left">btree_gin</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">提供一个为多种数据类型和所有enum类型实现B树等价行为的GIN操作符类示例。</td>
</tr>
<tr>
<td style="text-align:left">btree_gist</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">提供一个为多种数据类型和所有enum类型实现B树等价行为的GiST操作符类示例。</td>
</tr>
<tr>
<td style="text-align:left">citext</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">提供一种大小写不敏感的字符串类型。</td>
</tr>
<tr>
<td style="text-align:left">cube</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">提供一种数据类型来表示多维立方体。</td>
</tr>
<tr>
<td style="text-align:left">dblink</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">跨库操作表。</td>
</tr>
<tr>
<td style="text-align:left">dict_int</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">附加全文搜索词典模板的示例。</td>
</tr>
<tr>
<td style="text-align:left">earthdistance</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">提供两种不同的方法来计算地球表面的大圆距离。</td>
</tr>
<tr>
<td style="text-align:left">fuzzystrmatch</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">判断字符串之间的相似性和距离。</td>
</tr>
<tr>
<td style="text-align:left">hstore</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">在单一PostgreSQL值中存储键值对。</td>
</tr>
<tr>
<td style="text-align:left">intagg</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">提供一个整数聚集器和一个枚举器。</td>
</tr>
<tr>
<td style="text-align:left">intarray</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">提供一些有用的函数和操作符来操纵不含空值的整数数组。</td>
</tr>
<tr>
<td style="text-align:left">isn</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">按照一个硬编码的前缀列表对输入进行验证，也被用来在输出时连接号码。</td>
</tr>
<tr>
<td style="text-align:left">ltree</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">用于表示存储在一个层次树状结构中的数据的标签。</td>
</tr>
<tr>
<td style="text-align:left">pg_buffercache</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">提供一种方法实时检查共享缓冲区。</td>
</tr>
<tr>
<td style="text-align:left">pg_freespacemap</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">检查空闲空间映射（FSM）。</td>
</tr>
<tr>
<td style="text-align:left">pg_prewarm</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">提供一种方便的方法把数据载入到操作系统缓冲区或者PostgreSQL缓冲区。</td>
</tr>
<tr>
<td style="text-align:left">pg_stat_statements</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.9</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">提供一种方法追踪服务器执行的所有SQL语句的执行统计信息。</td>
</tr>
<tr>
<td style="text-align:left">pg_trgm</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">提供字母数字文本相似度的函数和操作符，以及支持快速搜索相似字符串的索引操作符类。</td>
</tr>
<tr>
<td style="text-align:left">pgcrypto</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">为PostgreSQL提供了密码函数。</td>
</tr>
<tr>
<td style="text-align:left">pgrowlocks</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">提供一个函数来显示一个指定表的行锁定信息。</td>
</tr>
<tr>
<td style="text-align:left">pgstattuple</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">提供多种函数来获得元组层的统计信息。</td>
</tr>
<tr>
<td style="text-align:left">plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">提供perl过程语言。</td>
</tr>
<tr>
<td style="text-align:left">plpgsql</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">提供SQL过程语言。</td>
</tr>
<tr>
<td style="text-align:left">pltcl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">提供tcl过程语言。</td>
</tr>
<tr>
<td style="text-align:left">postgres_fdw</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">跨库操作表。</td>
</tr>
<tr>
<td style="text-align:left">sslinfo</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">提供当前客户端提供的 SSL 证书的有关信息。</td>
</tr>
<tr>
<td style="text-align:left">tablefunc</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">包括多个返回表的函数。</td>
</tr>
<tr>
<td style="text-align:left">tsm_system_rows</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">提供表采样方法SYSTEM_ROWS。</td>
</tr>
<tr>
<td style="text-align:left">tsm_system_time</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">提供了表采样方法SYSTEM_TIME。</td>
</tr>
<tr>
<td style="text-align:left">unaccent</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">文本搜索字典，它能从词位中移除重音（附加符号）。</td>
</tr>
<tr>
<td style="text-align:left">uuid-ossp</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">提供函数使用几种标准算法之一产生通用唯一标识符（UUID）。</td>
</tr>
<tr>
<td style="text-align:left">xml2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">提供XPath查询和XSLT功能。</td>
</tr>
</tbody>
</table>
</details>
<hr>
<h3 id="性能对比">性能对比</h3>
<table>
<thead>
<tr>
<th><strong>指标</strong></th>
<th><strong>Pigsty</strong></th>
<th><strong>Aliyun RDS</strong></th>
<th><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>最佳性能</td>
<td><a href="https://github.com/Vonng/pgtpc/tree/master/sysbench">PGTPC on NVME SSD 评测</a> sysbench oltp_rw</td>
<td><a href="https://help.aliyun.com/document_detail/101470.html">RDS PG 性能白皮书</a> sysbench oltp 场景 每核 QPS 4000 ~ 8000</td>
<td></td>
</tr>
<tr>
<td>存储规格：最高档容量</td>
<td>32TB / <a href="https://en.shannon-sys.com/product.html?name=gen_4">NVME SSD</a></td>
<td>32 TB / <strong>ESSD PL3</strong></td>
<td>64 TB / <strong>io2</strong> <a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">EBS</a> Block Express</td>
</tr>
<tr>
<td>存储规格：最高档IOPS</td>
<td>4K随机读：最大3M，随机写 2000~350K</td>
<td>4K随机读：最大 1M</td>
<td>16K随机IOPS： 256K</td>
</tr>
<tr>
<td>存储规格：最高档延迟</td>
<td>4K随机读：75µs，随机写 15µs</td>
<td>4K随机读：200µs</td>
<td>500µs / 推断为16K随机IO</td>
</tr>
<tr>
<td>存储规格：最高档可靠性</td>
<td>UBER &lt; 1e-18，折合18个9 MTBF: 200万小时 5DWPD，持续三年</td>
<td>可靠性 9个9， 合 UBER 1e-9 <a href="https://help.aliyun.com/document_detail/476273.html">存储与数据可靠性</a></td>
<td><strong>持久性</strong>：99.999%，5个9 （0.001% 年故障率） <a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">io2 说明</a></td>
</tr>
<tr>
<td>存储规格：最高档成本</td>
<td>31.5 ¥/TB·月 ( 5年质保均摊 / 3.2T / 企业级 / MLC )</td>
<td>3200¥/TB·月 （原价 6400¥，包月4000¥） 3年预付整体打5折才有此价格</td>
<td>1900 ¥/TB·月 使用最大规格 65536GB / 256K IOPS 最大优惠</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="可观测性">可观测性</h3>
<p>Pigsty 提供了近 3000 类监控指标，提供了 50+ 监控面板，覆盖了数据库监控、主机监控、连接池监控、负载均衡监控等方方面面，为用户提供无与伦比的可观测性体验。</p>
<p><img src="/img/pigsty/dashboard.jpg"></p>
<p>Pigsty 提供了 638 与 PostgreSQL 有关的监控指标，而 AWS RDS 只有 99 个，阿里云 RDS 更是只有个位数指标：</p>
<p><img src="/img/docs/compare/aliyun.png"></p>
<p>此外，也有一些项目提供了监控 PostgreSQL 的能力，但都相对比较简单初级：</p>
<ul>
<li><a href="https://pgwatch.com/">pgwatch</a>： 123 类指标</li>
<li><a href="https://github.com/CrunchyData/pgmonitor">pgmonitor</a> ： 156 类指标</li>
<li><a href="https://docs.datadoghq.com/integrations/postgres">datadog</a> ： 69 类指标</li>
<li><a href="https://pgdash.io/">pgDash</a></li>
<li><a href="https://severalnines.com/product/clustercontrol">ClusterControl</a></li>
<li><a href="https://pganalyze.com/">pganalyze</a></li>
<li><a href="https://help.aliyun.com/document_detail/102748.html">Aliyun RDS</a> ： 8 类指标</li>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html">AWS RDS</a> ： 99 类指标</li>
<li><a href="https://docs.microsoft.com/en-us/azure/postgresql/">Azure RDS</a></li>
</ul>
<hr>
<h3 id="可维护性">可维护性</h3>
<table>
<thead>
<tr>
<th><strong>指标</strong></th>
<th><strong>Pigsty</strong></th>
<th><strong>Aliyun RDS</strong></th>
<th><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>系统易用性</td>
<td>简单</td>
<td>简单</td>
<td>简单</td>
</tr>
<tr>
<td>配置管理</td>
<td>配置文件 / CMDB 基于 Ansible Inventory</td>
<td>可使用 Terraform</td>
<td>可使用 Terraform</td>
</tr>
<tr>
<td>变更方式</td>
<td>幂等剧本 基于 Ansible Playbook</td>
<td>控制台点击操作</td>
<td>控制台点击操作</td>
</tr>
<tr>
<td>参数调优</td>
<td>自动根据节点适配 四种预置模板 OLTP, OLAP, TINY, CRIT</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Infra as Code</td>
<td>原生支持</td>
<td>可使用 Terraform</td>
<td>可使用 Terraform</td>
</tr>
<tr>
<td>可定制参数点</td>
<td><a href="/zh/docs/about/param/">Pigsty Parameters</a> 283 个</td>
<td></td>
<td></td>
</tr>
<tr>
<td>服务与支持</td>
<td>提供商业订阅支持兜底</td>
<td>提供售后工单支持</td>
<td>提供售后工单支持</td>
</tr>
<tr>
<td>无互联网部署</td>
<td>可离线安装部署</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>数据库迁移</td>
<td>提供从现有v10+ PG实例基于逻辑复制不停机迁移至Pigsty托管实例的剧本</td>
<td>提供上云辅助迁移 <a href="https://help.aliyun.com/document_detail/322179.html?spm=a2c4g.11186623.0.0.5fb374c9OOi4Dm">Aliyun RDS 数据同步</a></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<h3 id="成本">成本</h3>
<p>经验上看，软硬件资源的部分 RDS 单位成本是自建的 5 ～ 15 倍，租售比通常在一个月。详情请参考 <a href="/zh/docs/reference/cost/">成本分析</a>。</p>
<table>
<thead>
<tr>
<th>要素</th>
<th><strong>指标</strong></th>
<th><strong>Pigsty</strong></th>
<th><strong>Aliyun RDS</strong></th>
<th><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>成本</td>
<td>软件授权/服务费用</td>
<td>免费，硬件约 20 - 40 ¥/核·月</td>
<td>200 ～ 400 ¥/核·月</td>
<td>400 ~ 1300 ¥/核·月</td>
</tr>
<tr>
<td></td>
<td>服务支持费用</td>
<td>服务约 100 ¥/ 核·月</td>
<td>包含在 RDS 成本中</td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<h2 id="其他本地数据库管控软件">其他本地数据库管控软件</h2>
<p>一些提供管理 PostgreSQL 能力的软件与供应商</p>
<ul>
<li><a href="https://aiven.io/">Aiven</a>： 闭源商业云托管方案</li>
<li><a href="https://www.percona.com/software/postgresql-distribution">Percona</a>： 商业咨询，简易PG发行版</li>
<li><a href="https://docs.severalnines.com/docs/clustercontrol/">ClusterControl</a>：商业数据库管控软件</li>
</ul>
<hr>
<h2 id="其他-kubernetes-operator">其他 Kubernetes Operator</h2>
<p>Pigsty 拒绝在生产环境中使用 Kubernetes 管理数据库，因此与这些方案在生态位上存在差异。</p>
<ul>
<li>PGO</li>
<li>StackGres</li>
<li>CloudNativePG</li>
<li>TemboOperator</li>
<li>PostgresOperator</li>
<li>PerconaOperator</li>
<li>Kubegres</li>
<li>KubeDB</li>
<li>KubeBlocks</li>
</ul>
<p>更多信息请参阅：</p>
<ul>
<li>《<a href="/zh/blog/db/db-in-k8s/">将数据库放入K8S中是一个好主意吗？</a>》</li>
<li>《<a href="/zh/blog/db/pg-in-docker/">将数据库放入容器中是一个好主意吗？</a>》</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-724a9899719548b393b18b25ed0323cb">6 - 成本参考</h1>
    <div class="lead">本文提供了一组成本数据，供您评估 Pigsty 自建，使用云数据库 RDS 所需的成本，以及常规的 DBA 薪酬参考。</div>
	<hr>
<h2 id="总体概览">总体概览</h2>
<table>
<thead>
<tr>
<th style="text-align:center">EC2</th>
<th style="text-align:center">核·月</th>
<th style="text-align:center">RDS</th>
<th style="text-align:center">核·月</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">DHH 自建核月价格（192C 384G）</td>
<td style="text-align:center"><strong>25.32</strong></td>
<td style="text-align:center">初级开源数据库DBA参考工资</td>
<td style="text-align:center">15K/人·月</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房（独占物理机: 64C384G）</td>
<td style="text-align:center"><strong>19.53</strong></td>
<td style="text-align:center">中级开源数据库DBA参考工资</td>
<td style="text-align:center">30K/人·月</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房（容器，超卖500%）</td>
<td style="text-align:center">7</td>
<td style="text-align:center">高级开源数据库DBA参考工资</td>
<td style="text-align:center">60K/人·月</td>
</tr>
<tr>
<td style="text-align:center">UCloud 弹性虚拟机（8C16G，有超卖）</td>
<td style="text-align:center">25</td>
<td style="text-align:center">ORACLE 数据库授权</td>
<td style="text-align:center">10000</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 2x内存（独占无超卖）</td>
<td style="text-align:center">107</td>
<td style="text-align:center">阿里云 RDS PG 2x内存（独占）</td>
<td style="text-align:center">260</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 4x内存（独占无超卖）</td>
<td style="text-align:center">138</td>
<td style="text-align:center">阿里云 RDS PG 4x内存（独占）</td>
<td style="text-align:center">320</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 8x内存（独占无超卖）</td>
<td style="text-align:center">180</td>
<td style="text-align:center">阿里云 RDS PG 8x内存（独占）</td>
<td style="text-align:center">410</td>
</tr>
<tr>
<td style="text-align:center">AWS C5D.METAL 96C 200G (按月无预付)</td>
<td style="text-align:center">100</td>
<td style="text-align:center">AWS RDS PostgreSQL db.T2 (2x)</td>
<td style="text-align:center">440</td>
</tr>
<tr>
<td style="text-align:center">AWS C5D.METAL 96C 200G (预付三年)</td>
<td style="text-align:center">80</td>
<td style="text-align:center">AWS RDS PostgreSQL db.M5 (4x)</td>
<td style="text-align:center">611</td>
</tr>
<tr>
<td style="text-align:center">AWS C7A.METAL 192C 384G (预付三年)</td>
<td style="text-align:center">104.8</td>
<td style="text-align:center">AWS RDS PostgreSQL db.R6G (8x)</td>
<td style="text-align:center">786</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="rds成本参考">RDS成本参考</h2>
<table>
<thead>
<tr>
<th>付费模式</th>
<th>价格</th>
<th>折合每年（万¥）</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDC自建（单物理机）</td>
<td>¥7.5w / 5年</td>
<td>1.5</td>
</tr>
<tr>
<td>IDC自建（2～3台组HA）</td>
<td>¥15w / 5年</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>阿里云 RDS 按需</td>
<td>¥87.36/时</td>
<td>76.5</td>
</tr>
<tr>
<td>阿里云 RDS 月付（基准）</td>
<td>¥4.2w / 月</td>
<td>50</td>
</tr>
<tr>
<td>阿里云 RDS 年付（85折）</td>
<td>¥425095 / 年</td>
<td>42.5</td>
</tr>
<tr>
<td>阿里云 RDS 3年付（5折）</td>
<td>¥750168 / 3年</td>
<td>25</td>
</tr>
<tr>
<td>AWS 按需</td>
<td>$25,817 / 月</td>
<td>217</td>
</tr>
<tr>
<td>AWS 1年不预付</td>
<td>$22,827 / 月</td>
<td>191.7</td>
</tr>
<tr>
<td>AWS 3年全预付</td>
<td>12w$ + 17.5k$/月</td>
<td>175</td>
</tr>
<tr>
<td>AWS 中国/宁夏按需</td>
<td>¥197,489 / 月</td>
<td>237</td>
</tr>
<tr>
<td>AWS 中国/宁夏1年不预付</td>
<td>¥143,176 / 月</td>
<td>171</td>
</tr>
<tr>
<td>AWS 中国/宁夏3年全预付</td>
<td>¥647k + 116k/月</td>
<td>160.6</td>
</tr>
</tbody>
</table>
<p>我们可以对比一下自建与云数据库的成本差异：</p>
<table>
<thead>
<tr>
<th>方式</th>
<th>折合每年（万元）</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDC托管服务器 64C / 384G / 3.2TB NVME SSD 660K IOPS (2～3台)</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>阿里云 RDS PG 高可用版 pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3</td>
<td>25 ～ 50</td>
</tr>
<tr>
<td>AWS RDS PG 高可用版 db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS</td>
<td>160 ～ 217</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="ecs-成本参考">ECS 成本参考</h2>
<h3 id="排除-nvme-ssd--essd-pl3-后的纯算力价格对比">排除 NVMe SSD / ESSD PL3 后的纯算力价格对比</h3>
<p>以阿里云为例，纯算力包月模式的价格是自建基准的 5 ～ 7 倍，预付五年的价格是自建的 2 倍</p>
<table>
<thead>
<tr>
<th style="text-align:center">付费模式</th>
<th style="text-align:center">单价（¥/核·月）</th>
<th style="text-align:center">相对于标准价格</th>
<th style="text-align:center">自建溢价倍率</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">按量付费（1.5倍）</td>
<td style="text-align:center">¥ 202</td>
<td style="text-align:center">160 %</td>
<td style="text-align:center">9.2 ~ 11.2</td>
</tr>
<tr>
<td style="text-align:center">包月（标准价格）</td>
<td style="text-align:center">¥ 126</td>
<td style="text-align:center">100 %</td>
<td style="text-align:center">5.7 ～ 7.0</td>
</tr>
<tr>
<td style="text-align:center">预付一年（65折）</td>
<td style="text-align:center">¥ 83.7</td>
<td style="text-align:center">66 %</td>
<td style="text-align:center">3.8 ～ 4.7</td>
</tr>
<tr>
<td style="text-align:center">预付二年（55折）</td>
<td style="text-align:center">¥ 70.6</td>
<td style="text-align:center">56 %</td>
<td style="text-align:center">3.2 ~ 3.9</td>
</tr>
<tr>
<td style="text-align:center">预付三年（44折）</td>
<td style="text-align:center">¥ 55.1</td>
<td style="text-align:center">44 %</td>
<td style="text-align:center">2.5 ~ 3.1</td>
</tr>
<tr>
<td style="text-align:center">预付四年（35折）</td>
<td style="text-align:center">¥ 45</td>
<td style="text-align:center">35 %</td>
<td style="text-align:center">2.0 ~ 2.5</td>
</tr>
<tr>
<td style="text-align:center">预付五年（30折）</td>
<td style="text-align:center">¥ 38.5</td>
<td style="text-align:center">30 %</td>
<td style="text-align:center">1.8 ~ 2.1</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">DHH @ 2023</td>
<td style="text-align:center">¥ 22.0</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">探探 IDC 自建</td>
<td style="text-align:center">¥ 18.0</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h3 id="含-nvme-ssd--essd-pl3-情况下的等效价格对比">含 NVMe SSD / ESSD PL3 情况下的等效价格对比</h3>
<p>包含常用规格后的 NVMe SSD 规格之后，纯算力包月模式的价格是自建基准的 11 ～ 14 倍，预付五年的价格是自建的 9 倍左右。</p>
<table>
<thead>
<tr>
<th style="text-align:center">付费模式</th>
<th style="text-align:center">单价（¥/核·月）</th>
<th style="text-align:center">+ 40GB ESSD PL3</th>
<th style="text-align:center">自建溢价比例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">按量付费（1.5倍）</td>
<td style="text-align:center">¥ 202</td>
<td style="text-align:center">¥ 362</td>
<td style="text-align:center">14.3 ～ 18.6</td>
</tr>
<tr>
<td style="text-align:center">包月（标准价格）</td>
<td style="text-align:center">¥ 126</td>
<td style="text-align:center">¥ 286</td>
<td style="text-align:center">11.3 ～ 14.7</td>
</tr>
<tr>
<td style="text-align:center">预付一年（65折）</td>
<td style="text-align:center">¥ 83.7</td>
<td style="text-align:center">¥ 244</td>
<td style="text-align:center">9.6 ～ 12.5</td>
</tr>
<tr>
<td style="text-align:center">预付二年（55折）</td>
<td style="text-align:center">¥ 70.6</td>
<td style="text-align:center">¥ 230</td>
<td style="text-align:center">9.1 ～ 11.8</td>
</tr>
<tr>
<td style="text-align:center">预付三年（44折）</td>
<td style="text-align:center">¥ 55.1</td>
<td style="text-align:center">¥ 215</td>
<td style="text-align:center">8.5 ～ 11.0</td>
</tr>
<tr>
<td style="text-align:center">预付四年（35折）</td>
<td style="text-align:center">¥ 45</td>
<td style="text-align:center">¥ 205</td>
<td style="text-align:center">8.1 ～ 10.5</td>
</tr>
<tr>
<td style="text-align:center">预付五年（30折）</td>
<td style="text-align:center">¥ 38.5</td>
<td style="text-align:center">¥ 199</td>
<td style="text-align:center">7.9 ～ 10.2</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">DHH @ 2023</td>
<td style="text-align:center">¥ 25.3</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">探探 IDC 自建</td>
<td style="text-align:center">¥ 19.5</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<blockquote>
<p>DHH案例：192核配12.8TB Gen4 SSD (1c:66)；探探案例： 64核配3.2T Gen3 MLC SSD (1c:50)。</p>
<p>云上价格每核配比40GB ESSD PL3（1核:4x内存:40x磁盘）计算。</p>
</blockquote>
<hr>
<h2 id="ebs成本参考">EBS成本参考</h2>
<table>
<thead>
<tr>
<th><strong>评估因素</strong></th>
<th><strong>本地</strong> <strong>PCI-E NVME SSD</strong></th>
<th><strong>Aliyun ESSD PL3</strong></th>
<th><strong>AWS io2 Block Express</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>容量</td>
<td>32TB</td>
<td>32 TB</td>
<td>64 TB</td>
</tr>
<tr>
<td>IOPS</td>
<td>4K随机读：600K ~ 1.1M 4K随机写 200K ~ 350K</td>
<td>4K随机读：最大 1M</td>
<td>16K随机IOPS： 256K</td>
</tr>
<tr>
<td>延迟</td>
<td>4K随机读：75µs 4K随机写：15µs</td>
<td>4K 随机读： 200µs</td>
<td>随机IO：500µs 上下文推断为16K</td>
</tr>
<tr>
<td>可靠性</td>
<td>UBER &lt; 1e-18，折合18个9 MTBF: 200万小时 5DWPD，持续三年</td>
<td>数据可靠性 9个9 <a href="https://help.aliyun.com/document_detail/476273.html">存储与数据可靠性</a></td>
<td><strong>持久性</strong>：99.999%，5个9 （0.001% 年故障率） <a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">io2 说明</a></td>
</tr>
<tr>
<td>成本</td>
<td>**16 ¥/TB·**<strong>月</strong> ( 5年均摊 / 3.2T MLC ) 5 年质保，¥3000 零售</td>
<td>**3200¥/TB·**<strong>月</strong> （原价 6400¥，包月4000¥） 3年预付整体打5折才有此价格</td>
<td>**1900 ¥/TB·**<strong>月</strong> 使用最大规格 65536GB 256K IOPS 最优惠状态</td>
</tr>
<tr>
<td>SLA</td>
<td>5年质保 出问题直接换新</td>
<td><a href="https://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201910310944_35008.html?spm=a2c4g.11186623.0.0.270e6e37n8Exh5">Aliyun RDS SLA</a> 可用性 99.99%: 月费 15% 99%: 月费 30% 95%: 月费 100%</td>
<td><a href="https://d1.awsstatic.com/legal/amazonrdsservice/Amazon-RDS-Service-Level-Agreement-Chinese.pdf">Amazon RDS SLA</a> 可用性 99.95%: 月费 15% 99%: 月费 25% 95%: 月费 100%</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="s3成本参考">S3成本参考</h2>
<table>
<thead>
<tr>
<th style="text-align:center">Date</th>
<th style="text-align:center">$/GB·月</th>
<th style="text-align:center">¥/TB·5年</th>
<th style="text-align:center">HDD ¥/TB</th>
<th style="text-align:center">SSD ¥/TB</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/cn/blogs/aws/amazon_s3/">2006</a>.03</td>
<td style="text-align:center">0.150</td>
<td style="text-align:center">63000</td>
<td style="text-align:center">2800</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2010/11/what-can-i-say-another-amazon-s3-price-reduction.html">2010</a>.11</td>
<td style="text-align:center">0.140</td>
<td style="text-align:center">58800</td>
<td style="text-align:center">1680</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2012/11/amazon-s3-price-reduction-december-1-2012.html">2012</a>.12</td>
<td style="text-align:center">0.095</td>
<td style="text-align:center">39900</td>
<td style="text-align:center">420</td>
<td style="text-align:center">15400</td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2014/03/aws-price-reduction-42-ec2-s3-rds-elasticache-and-elastic-mapreduce.html">2014</a>.04</td>
<td style="text-align:center">0.030</td>
<td style="text-align:center">12600</td>
<td style="text-align:center">371</td>
<td style="text-align:center">9051</td>
</tr>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/ru/blogs/aws/aws-storage-update-s3-glacier-price-reductions/">2016</a>.12</td>
<td style="text-align:center">0.023</td>
<td style="text-align:center">9660</td>
<td style="text-align:center">245</td>
<td style="text-align:center">3766</td>
</tr>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/cn/s3/pricing">2023</a>.12</td>
<td style="text-align:center">0.023</td>
<td style="text-align:center">9660</td>
<td style="text-align:center">105</td>
<td style="text-align:center">280</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>其他参考价</strong></td>
<td style="text-align:center"><strong>高性能存储</strong></td>
<td style="text-align:center"><strong>顶配底折价</strong></td>
<td style="text-align:center"><strong>与采购NVMe SSD</strong></td>
<td style="text-align:center"><strong>价格参考</strong></td>
</tr>
<tr>
<td style="text-align:center">S3 Express</td>
<td style="text-align:center">0.160</td>
<td style="text-align:center">67200</td>
<td style="text-align:center">DHH 12T</td>
<td style="text-align:center">1400</td>
</tr>
<tr>
<td style="text-align:center">EBS io2</td>
<td style="text-align:center">0.125 + IOPS</td>
<td style="text-align:center">114000</td>
<td style="text-align:center">Shannon 3.2T</td>
<td style="text-align:center">900</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="下云合集">下云合集</h2>
<p>曾几何时，“<strong>上云</strong>“近乎成为技术圈的政治正确，整整一代应用开发者的视野被云遮蔽。就让我们用实打实的数据分析与亲身经历，讲清楚公有云租赁模式的价值与陷阱 —— 在这个降本增效的时代中，供您借鉴与参考 —— 请看 《<a href="/zh/blog/cloud/cloud-exit/">云计算泥石流：合订本</a>》</p>
<p><strong>云基础资源篇</strong></p>
<ul>
<li>
<p><a href="https://mp.weixin.qq.com/s/1OSRcBfd58s0tgZTUZHB9g">重新拿回计算机硬件的红利</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/HathxpQ_KUuqxyrtyCDzWw">扒皮对象存储：从降本到杀猪</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">云盘是不是杀猪盘？</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/LefEAXTcBH-KBJNhXNoc7A">云数据库是不是智商税</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/ANFnbDXwuhKI99fgYRZ9ug">垃圾腾讯云CDN：从入门到放弃</a></p>
</li>
</ul>
<hr>
<p><strong>云商业模式篇</strong></p>
<ul>
<li>
<p><a href="https://mp.weixin.qq.com/s/Yp_PU8nmyK-NVq0clD98RQ">FinOps终点是下云</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/2w0bLJI7TvUNp1tzLYbvsA">云计算为啥还没挖沙子赚钱？</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA">云SLA是不是安慰剂？</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/TksQ108v_nGaW11-87Es3A">杀猪盘真的降价了吗？</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/Yp6L0hh4b4HuJQRPD3aJYw">范式转移：从云到本地优先</a></p>
</li>
</ul>
<hr>
<p><strong>下云奥德赛篇</strong></p>
<ul>
<li>
<p><a href="https://mp.weixin.qq.com/s/yIVal-9U6_TXX-dZpVtjBg">下云高可用的秘诀：拒绝智力自慰</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/xaa079P4DRCz0hzNovGoOA">半年下云省千万：DHH下云FAQ答疑</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/CicctyvV1xk5B-AsKfzPjw">是时候放弃云计算了吗？</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/H2S3TV-AsqS43A5Hh-XMhQ">下云奥德赛</a></p>
</li>
</ul>
<hr>
<p><strong>云故障复盘篇</strong></p>
<ul>
<li>
<p><a href="https://mp.weixin.qq.com/s/FIOB_Oqefx1oez1iu7AGGg">从降本增笑到真的降本增效</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/OIlR0rolEQff9YfCpj3wIQ">我们能从阿里云史诗级故障中学到什么</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/3F1ud-tWB3eymu1-dxSHMA">阿里云周爆：云数据库管控又挂了</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/cTge3xOlIQCALQc8Mi-P8w">【阿里】云计算史诗级大翻车来了</a></p>
</li>
</ul>
<hr>
<p><strong>RDS翻车篇</strong></p>
<ul>
<li>
<p><a href="https://mp.weixin.qq.com/s/-E_-HZ7LvOze5lmzy3QbQA">更好的开源RDS替代：Pigsty</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/CMRrqI2yBWlNbACHpNgL1g">驳《再论为什么你不应该招DBA》</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/AGEW1iHQkQy4NQyYC2GonQ">云RDS：从删库到跑路</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/4a8Qy4O80xqsnytC4l9lRg">数据库应该放入K8S里吗？</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/kFftay1IokBDqyMuArqOpg">把数据库放入Docker是一个好主意吗？</a></p>
</li>
</ul>
<hr>
<p><strong>云厂商画像篇</strong></p>
<ul>
<li>
<p><a href="https://mp.weixin.qq.com/s/8ZffsCgchv8LH5ujv0lRGQ">互联网技术大师速成班 </a>【转载】</p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/qSTEf9txjHNTHeEFv3NkWg">门内的国企如何看门外的云厂商</a>【转载】</p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/1dse1KSCq2xG-QaL1JzZ8Q">卡在政企客户门口的阿里云</a>【转载】</p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/OxhhJ4U1P43di_eaE1uGPw">互联网故障背后的草台班子们</a>【转载】</p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/y9IradwxTxOsUGcOHia1XQ">云厂商眼中的客户：又穷又闲又缺爱</a>【转载】</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dbab37f93e145eb07dbd2362106ccd61">7 - 术语列表</h1>
    <div class="lead">本文列出了文档中使用的技术术语，以及它们的释义与说明。</div>
	
</div>



    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Mail" aria-label="Mail">
    <a target="_blank" rel="noopener" href="mailto:rh@vonng.com" aria-label="Mail">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/Vonng/pigsty" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/GobeUncleWang" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="WeChat" aria-label="WeChat">
    <a target="_blank" rel="noopener" href="/img/pigsty/pigsty-cc.jpg" aria-label="WeChat">
      <i class="fa fa-comment"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Discord" aria-label="Discord">
    <a target="_blank" rel="noopener" href="https://discord.gg/wDzt5VyWEz" aria-label="Discord">
      <i class="fab fa-discord"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Telegram" aria-label="Telegram">
    <a target="_blank" rel="noopener" href="https://t.me/joinchat/gV9zfZraNPM3YjFh" aria-label="Telegram">
      <i class="fab fa-telegram"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2018&ndash;2024
    <span class="td-footer__authors">Ruohang Feng</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span></span><span class="ms-2"><a href="https://vonng.com/en/" target="_blank" rel="noopener">@Vonng</a></span>
<br><span>Pigsty® distributed under <a href="/docs/about/license" target="_blank" rel="noopener">AGPLv3</a></span>
<br><span class="ms-2"><a href="/docs/about/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
<span><a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">浙ICP备15016890号</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.248655eb216150e39da254c2f7aa5357805d0ec66bdb741b591cd35fb5f629ab.js" integrity="sha256-JIZV6yFhUOOdolTC96pTV4BdDsZr23QbWRzTX7X2Kas=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
