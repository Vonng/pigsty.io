<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>版本发布历史 | Pigsty</title>
<meta name="description" content="Pigsty 历史版本发行注记">
<meta property="og:title" content="版本发布历史" />
<meta property="og:description" content="Pigsty 历史版本发行注记" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/zh/docs/releasenote/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2024-12-25T19:08:22+08:00" />

<meta itemprop="name" content="版本发布历史">
<meta itemprop="description" content="Pigsty 历史版本发行注记">
<meta itemprop="dateModified" content="2024-12-25T19:08:22+08:00" />
<meta itemprop="wordCount" content="8966">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="版本发布历史"/>
<meta name="twitter:description" content="Pigsty 历史版本发行注记"/>




<link rel="preload" href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" as="style">
<link href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" rel="stylesheet" integrity="">

<script
  src="/js/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="/js/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-LG1V9WTKGE');
}
</script>
  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/zh/"><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class="navbar-brand__name">Pigsty</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/zh/docs/"><i class='fa-solid fa-book'></i><span>文档</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/zh/blog/"><i class="fas fa-blog"></i><span>博客</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/Vonng/pigsty/" target="_blank" rel="noopener"><i class='fab fa-github'></i><span>GitHub</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <i class="fa-solid fa-language"></i>中文</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/docs/releasenote/">English</a></li>
    </ul>
</div>
</li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.3d8b467986443809a569a1430978f580.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.3d8b467986443809a569a1430978f580.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="td-sidebar-nav collapse foldable-nav" id="td-section-nav">
    <div class="td-sidebar-nav__section nav-item dropdown d-block d-lg-none">
      <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <i class="fa-solid fa-language"></i>中文</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/docs/releasenote/">English</a></li>
    </ul>
</div>

    </div>
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-zhdocs-li">
  <a href="/zh/docs/" title="Pigsty 中文文档 v3.2" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-zhdocs"><span class="">文档</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocssetup-li">
  <input type="checkbox" id="m-zhdocssetup-check"/>
  <label for="m-zhdocssetup-check"><a href="/zh/docs/setup/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocssetup"><i class="fas fa-rocket"></i><span class="">快速开始</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupinstall-li">
  <input type="checkbox" id="m-zhdocssetupinstall-check"/>
  <label for="m-zhdocssetupinstall-check"><a href="/zh/docs/setup/install/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupinstall"><i class="fa-solid fa-cloud-arrow-down"></i><span class="">安装部署</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupoffline-li">
  <input type="checkbox" id="m-zhdocssetupoffline-check"/>
  <label for="m-zhdocssetupoffline-check"><a href="/zh/docs/setup/offline/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupoffline"><i class="fa-solid fa-download"></i><span class="">离线安装</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupslim-li">
  <input type="checkbox" id="m-zhdocssetupslim-check"/>
  <label for="m-zhdocssetupslim-check"><a href="/zh/docs/setup/slim/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupslim"><i class="fa-solid fa-minimize"></i><span class="">精简安装</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupconfig-li">
  <input type="checkbox" id="m-zhdocssetupconfig-check"/>
  <label for="m-zhdocssetupconfig-check"><a href="/zh/docs/setup/config/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupconfig"><i class="fa-solid fa-code"></i><span class="">声明配置</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupprepare-li">
  <input type="checkbox" id="m-zhdocssetupprepare-check"/>
  <label for="m-zhdocssetupprepare-check"><a href="/zh/docs/setup/prepare/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupprepare"><i class="fa-solid fa-calculator"></i><span class="">准备工作</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupplaybook-li">
  <input type="checkbox" id="m-zhdocssetupplaybook-check"/>
  <label for="m-zhdocssetupplaybook-check"><a href="/zh/docs/setup/playbook/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupplaybook"><i class="fa-solid fa-scroll"></i><span class="">执行剧本</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupprovision-li">
  <input type="checkbox" id="m-zhdocssetupprovision-check"/>
  <label for="m-zhdocssetupprovision-check"><a href="/zh/docs/setup/provision/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupprovision"><i class="fa-solid fa-server"></i><span class="">置备机器</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupsecurity-li">
  <input type="checkbox" id="m-zhdocssetupsecurity-check"/>
  <label for="m-zhdocssetupsecurity-check"><a href="/zh/docs/setup/security/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupsecurity"><i class="fas fa-shield-halved"></i><span class="">安全考量</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssetupfaq-li">
  <input type="checkbox" id="m-zhdocssetupfaq-check"/>
  <label for="m-zhdocssetupfaq-check"><a href="/zh/docs/setup/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssetupfaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsabout-li">
  <input type="checkbox" id="m-zhdocsabout-check"/>
  <label for="m-zhdocsabout-check"><a href="/zh/docs/about/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsabout"><i class="fa-solid fa-circle-info"></i><span class="">关于Pigsty</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutfeature-li">
  <input type="checkbox" id="m-zhdocsaboutfeature-check"/>
  <label for="m-zhdocsaboutfeature-check"><a href="/zh/docs/about/feature/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutfeature"><i class="fa-solid fa-wand-magic-sparkles"></i><span class="">亮点特性</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutmodule-li">
  <input type="checkbox" id="m-zhdocsaboutmodule-check"/>
  <label for="m-zhdocsaboutmodule-check"><a href="/zh/docs/about/module/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutmodule"><i class="fa-solid fa-boxes-stacked"></i><span class="">模块列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutroadmap-li">
  <input type="checkbox" id="m-zhdocsaboutroadmap-check"/>
  <label for="m-zhdocsaboutroadmap-check"><a href="/zh/docs/about/roadmap/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutroadmap"><i class="fas fa-map"></i><span class="">发展规划</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsabouthistory-li">
  <input type="checkbox" id="m-zhdocsabouthistory-check"/>
  <label for="m-zhdocsabouthistory-check"><a href="/zh/docs/about/history/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsabouthistory"><i class="fa-solid fa-clock-rotate-left"></i><span class="">历史沿革</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutevent-li">
  <input type="checkbox" id="m-zhdocsaboutevent-check"/>
  <label for="m-zhdocsaboutevent-check"><a href="/zh/docs/about/event/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutevent"><i class="fa-regular fa-newspaper"></i><span class="">活动新闻</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutcommunity-li">
  <input type="checkbox" id="m-zhdocsaboutcommunity-check"/>
  <label for="m-zhdocsaboutcommunity-check"><a href="/zh/docs/about/community/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutcommunity"><i class="fas fa-user-group"></i><span class="">加入社区</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutprivacy-li">
  <input type="checkbox" id="m-zhdocsaboutprivacy-check"/>
  <label for="m-zhdocsaboutprivacy-check"><a href="/zh/docs/about/privacy/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutprivacy"><i class="fas fa-fingerprint"></i><span class="">隐私政策</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutlicense-li">
  <input type="checkbox" id="m-zhdocsaboutlicense-check"/>
  <label for="m-zhdocsaboutlicense-check"><a href="/zh/docs/about/license/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutlicense"><i class="fas fa-balance-scale"></i><span class="">开源协议</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutsponsor-li">
  <input type="checkbox" id="m-zhdocsaboutsponsor-check"/>
  <label for="m-zhdocsaboutsponsor-check"><a href="/zh/docs/about/sponsor/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutsponsor"><i class="fas fa-heart"></i><span class="">赞助我们</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutcase-li">
  <input type="checkbox" id="m-zhdocsaboutcase-check"/>
  <label for="m-zhdocsaboutcase-check"><a href="/zh/docs/about/case/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutcase"><i class="fa-solid fa-certificate"></i><span class="">行业案例</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsaboutservice-li">
  <input type="checkbox" id="m-zhdocsaboutservice-check"/>
  <label for="m-zhdocsaboutservice-check"><a href="/zh/docs/about/service/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsaboutservice"><i class="fas fa-briefcase"></i><span class="">订阅服务</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsconcept-li">
  <input type="checkbox" id="m-zhdocsconcept-check"/>
  <label for="m-zhdocsconcept-check"><a href="/zh/docs/concept/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsconcept"><i class="fa-solid fa-compass"></i><span class="">核心概念</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconceptarch-li">
  <input type="checkbox" id="m-zhdocsconceptarch-check"/>
  <label for="m-zhdocsconceptarch-check"><a href="/zh/docs/concept/arch/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconceptarch"><i class="fa-solid fa-archway"></i><span class="">系统架构</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconceptmodel-li">
  <input type="checkbox" id="m-zhdocsconceptmodel-check"/>
  <label for="m-zhdocsconceptmodel-check"><a href="/zh/docs/concept/model/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconceptmodel"><i class="fa-solid fa-coins"></i><span class="">集群模型</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconceptca-li">
  <input type="checkbox" id="m-zhdocsconceptca-check"/>
  <label for="m-zhdocsconceptca-check"><a href="/zh/docs/concept/ca/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconceptca"><i class="fa-solid fa-bank"></i><span class="">本地 CA</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconceptiac-li">
  <input type="checkbox" id="m-zhdocsconceptiac-check"/>
  <label for="m-zhdocsconceptiac-check"><a href="/zh/docs/concept/iac/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconceptiac"><i class="fa-solid fa-file-code"></i><span class="">基础设施即代码</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconceptha-li">
  <input type="checkbox" id="m-zhdocsconceptha-check"/>
  <label for="m-zhdocsconceptha-check"><a href="/zh/docs/concept/ha/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconceptha"><i class="fa-solid fa-infinity"></i><span class="">数据库高可用</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconceptpitr-li">
  <input type="checkbox" id="m-zhdocsconceptpitr-check"/>
  <label for="m-zhdocsconceptpitr-check"><a href="/zh/docs/concept/pitr/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconceptpitr"><i class="fa-solid fa-clock-rotate-left"></i><span class="">时间点恢复</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconceptsvc-li">
  <input type="checkbox" id="m-zhdocsconceptsvc-check"/>
  <label for="m-zhdocsconceptsvc-check"><a href="/zh/docs/concept/svc/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconceptsvc"><i class="fa-solid fa-arrow-down-up-across-line"></i><span class="">服务接入</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconceptac-li">
  <input type="checkbox" id="m-zhdocsconceptac-check"/>
  <label for="m-zhdocsconceptac-check"><a href="/zh/docs/concept/ac/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconceptac"><i class="fa-solid fa-lock"></i><span class="">访问控制</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsconf-li">
  <input type="checkbox" id="m-zhdocsconf-check"/>
  <label for="m-zhdocsconf-check"><a href="/zh/docs/conf/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsconf"><i class="fa-solid fa-sliders"></i><span class="">配置模板</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfoverview-li">
  <input type="checkbox" id="m-zhdocsconfoverview-check"/>
  <label for="m-zhdocsconfoverview-check"><a href="/zh/docs/conf/overview/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfoverview"><i class="fa-solid fa-sliders"></i><span class="">配置总览</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfmeta-li">
  <input type="checkbox" id="m-zhdocsconfmeta-check"/>
  <label for="m-zhdocsconfmeta-check"><a href="/zh/docs/conf/meta/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfmeta"><i class="fa-solid fa-dice-one"></i><span class="">单节点：meta</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfrich-li">
  <input type="checkbox" id="m-zhdocsconfrich-check"/>
  <label for="m-zhdocsconfrich-check"><a href="/zh/docs/conf/rich/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfrich"><i class="fa-solid fa-dice-one"></i><span class="">单节点：rich</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfpitr-li">
  <input type="checkbox" id="m-zhdocsconfpitr-check"/>
  <label for="m-zhdocsconfpitr-check"><a href="/zh/docs/conf/pitr/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfpitr"><i class="fa-solid fa-dice-one"></i><span class="">单节点：pitr</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfdemo-li">
  <input type="checkbox" id="m-zhdocsconfdemo-check"/>
  <label for="m-zhdocsconfdemo-check"><a href="/zh/docs/conf/demo/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfdemo"><i class="fa-solid fa-dice-one"></i><span class="">单节点：demo</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfsupa-li">
  <input type="checkbox" id="m-zhdocsconfsupa-check"/>
  <label for="m-zhdocsconfsupa-check"><a href="/zh/docs/conf/supa/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfsupa"><i class="fa-solid fa-dice-one"></i><span class="">单节点：supa</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfbare-li">
  <input type="checkbox" id="m-zhdocsconfbare-check"/>
  <label for="m-zhdocsconfbare-check"><a href="/zh/docs/conf/bare/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfbare"><i class="fa-solid fa-dice-one"></i><span class="">单节点：bare</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconffull-li">
  <input type="checkbox" id="m-zhdocsconffull-check"/>
  <label for="m-zhdocsconffull-check"><a href="/zh/docs/conf/full/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconffull"><i class="fa-solid fa-dice-four"></i><span class="">四节点：full</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfsafe-li">
  <input type="checkbox" id="m-zhdocsconfsafe-check"/>
  <label for="m-zhdocsconfsafe-check"><a href="/zh/docs/conf/safe/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfsafe"><i class="fa-solid fa-dice-four"></i><span class="">四节点：safe</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfmssql-li">
  <input type="checkbox" id="m-zhdocsconfmssql-check"/>
  <label for="m-zhdocsconfmssql-check"><a href="/zh/docs/conf/mssql/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfmssql"><i class="fa-solid fa-dice-four"></i><span class="">四节点：mssql</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfpolar-li">
  <input type="checkbox" id="m-zhdocsconfpolar-check"/>
  <label for="m-zhdocsconfpolar-check"><a href="/zh/docs/conf/polar/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfpolar"><i class="fa-solid fa-dice-four"></i><span class="">四节点：polar</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfivory-li">
  <input type="checkbox" id="m-zhdocsconfivory-check"/>
  <label for="m-zhdocsconfivory-check"><a href="/zh/docs/conf/ivory/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfivory"><i class="fa-solid fa-dice-four"></i><span class="">四节点：ivory</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfminio-li">
  <input type="checkbox" id="m-zhdocsconfminio-check"/>
  <label for="m-zhdocsconfminio-check"><a href="/zh/docs/conf/minio/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfminio"><i class="fa-solid fa-dice-four"></i><span class="">四节点：minio</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfdual-li">
  <input type="checkbox" id="m-zhdocsconfdual-check"/>
  <label for="m-zhdocsconfdual-check"><a href="/zh/docs/conf/dual/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfdual"><i class="fa-solid fa-dice-two"></i><span class="">双节点：dual</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfslim-li">
  <input type="checkbox" id="m-zhdocsconfslim-check"/>
  <label for="m-zhdocsconfslim-check"><a href="/zh/docs/conf/slim/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfslim"><i class="fa-solid fa-dice-two"></i><span class="">双节点：slim</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconftrio-li">
  <input type="checkbox" id="m-zhdocsconftrio-check"/>
  <label for="m-zhdocsconftrio-check"><a href="/zh/docs/conf/trio/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconftrio"><i class="fa-solid fa-dice-three"></i><span class="">三节点：trio</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfoss-li">
  <input type="checkbox" id="m-zhdocsconfoss-check"/>
  <label for="m-zhdocsconfoss-check"><a href="/zh/docs/conf/oss/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfoss"><i class="fa-solid fa-dice-five"></i><span class="">五节点：oss</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfext-li">
  <input type="checkbox" id="m-zhdocsconfext-check"/>
  <label for="m-zhdocsconfext-check"><a href="/zh/docs/conf/ext/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfext"><i class="fa-solid fa-dice-five"></i><span class="">五节点：ext</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsconfprod-li">
  <input type="checkbox" id="m-zhdocsconfprod-check"/>
  <label for="m-zhdocsconfprod-check"><a href="/zh/docs/conf/prod/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsconfprod"><i class="fa-solid fa-dice-four"></i><span class="">36节点：prod</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsreference-li">
  <input type="checkbox" id="m-zhdocsreference-check"/>
  <label for="m-zhdocsreference-check"><a href="/zh/docs/reference/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsreference"><i class="fas fa-map"></i><span class="">参考信息</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsreferencecompatibility-li">
  <input type="checkbox" id="m-zhdocsreferencecompatibility-check"/>
  <label for="m-zhdocsreferencecompatibility-check"><a href="/zh/docs/reference/compatibility/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsreferencecompatibility"><i class="fa-brands fa-redhat"></i><span class="">OS兼容性</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsreferenceparam-li">
  <input type="checkbox" id="m-zhdocsreferenceparam-check"/>
  <label for="m-zhdocsreferenceparam-check"><a href="/zh/docs/reference/param/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsreferenceparam"><i class="fa-solid fa-terminal"></i><span class="">参数列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsreferenceextension-li">
  <input type="checkbox" id="m-zhdocsreferenceextension-check"/>
  <label for="m-zhdocsreferenceextension-check"><a href="/zh/docs/reference/extension/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsreferenceextension"><i class="fa-brands fa-usb"></i><span class="">扩展列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsreferencefhs-li">
  <input type="checkbox" id="m-zhdocsreferencefhs-check"/>
  <label for="m-zhdocsreferencefhs-check"><a href="/zh/docs/reference/fhs/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsreferencefhs"><i class="fa-solid fa-folder-tree"></i><span class="">文件结构</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsreferencecompare-li">
  <input type="checkbox" id="m-zhdocsreferencecompare-check"/>
  <label for="m-zhdocsreferencecompare-check"><a href="/zh/docs/reference/compare/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsreferencecompare"><i class="fa-solid fa-circle-half-stroke"></i><span class="">同类对比</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsreferencecost-li">
  <input type="checkbox" id="m-zhdocsreferencecost-check"/>
  <label for="m-zhdocsreferencecost-check"><a href="/zh/docs/reference/cost/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsreferencecost"><i class="fa-solid fa-sack-dollar"></i><span class="">成本参考</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsreferenceglossary-li">
  <input type="checkbox" id="m-zhdocsreferenceglossary-check"/>
  <label for="m-zhdocsreferenceglossary-check"><a href="/zh/docs/reference/glossary/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsreferenceglossary"><i class="fa-solid fa-list-ul"></i><span class="">术语列表</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsprice-li">
  <input type="checkbox" id="m-zhdocsprice-check"/>
  <label for="m-zhdocsprice-check"><a href="/zh/docs/price/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsprice"><i class="fas fa-dollar-sign"></i><span class="">服务定价</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocspgsql-li">
  <input type="checkbox" id="m-zhdocspgsql-check"/>
  <label for="m-zhdocspgsql-check"><a href="/zh/docs/pgsql/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocspgsql"><i class="fas fa-database"></i><span class="">模块：PGSQL</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlconcept-li">
  <input type="checkbox" id="m-zhdocspgsqlconcept-check"/>
  <label for="m-zhdocspgsqlconcept-check"><a href="/zh/docs/pgsql/concept/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlconcept"><i class="fa-solid fa-brain"></i><span class="">核心概念</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlarch-li">
  <input type="checkbox" id="m-zhdocspgsqlarch-check"/>
  <label for="m-zhdocspgsqlarch-check"><a href="/zh/docs/pgsql/arch/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlarch"><i class="fa-solid fa-archway"></i><span class="">系统架构</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqluser-li">
  <input type="checkbox" id="m-zhdocspgsqluser-check"/>
  <label for="m-zhdocspgsqluser-check"><a href="/zh/docs/pgsql/user/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqluser"><i class="fa-solid fa-users"></i><span class="">用户/角色</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqldb-li">
  <input type="checkbox" id="m-zhdocspgsqldb-check"/>
  <label for="m-zhdocspgsqldb-check"><a href="/zh/docs/pgsql/db/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqldb"><i class="fa-solid fa-coins"></i><span class="">数据库</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlsvc-li">
  <input type="checkbox" id="m-zhdocspgsqlsvc-check"/>
  <label for="m-zhdocspgsqlsvc-check"><a href="/zh/docs/pgsql/svc/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlsvc"><i class="fa-solid fa-arrow-down-up-across-line"></i><span class="">服务/接入</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlextension-li">
  <input type="checkbox" id="m-zhdocspgsqlextension-check"/>
  <label for="m-zhdocspgsqlextension-check"><a href="/zh/docs/pgsql/extension/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlextension"><i class="fa-brands fa-usb"></i><span class="">扩展插件</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlhba-li">
  <input type="checkbox" id="m-zhdocspgsqlhba-check"/>
  <label for="m-zhdocspgsqlhba-check"><a href="/zh/docs/pgsql/hba/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlhba"><i class="fa-solid fa-key"></i><span class="">认证 / HBA</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlconfig-li">
  <input type="checkbox" id="m-zhdocspgsqlconfig-check"/>
  <label for="m-zhdocspgsqlconfig-check"><a href="/zh/docs/pgsql/config/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlconfig"><i class="fa-solid fa-code"></i><span class="">集群配置</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlplaybook-li">
  <input type="checkbox" id="m-zhdocspgsqlplaybook-check"/>
  <label for="m-zhdocspgsqlplaybook-check"><a href="/zh/docs/pgsql/playbook/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlplaybook"><i class="fa-solid fa-scroll"></i><span class="">预置剧本</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqladmin-li">
  <input type="checkbox" id="m-zhdocspgsqladmin-check"/>
  <label for="m-zhdocspgsqladmin-check"><a href="/zh/docs/pgsql/admin/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqladmin"><i class="fa-solid fa-building-columns"></i><span class="">管理预案</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlacl-li">
  <input type="checkbox" id="m-zhdocspgsqlacl-check"/>
  <label for="m-zhdocspgsqlacl-check"><a href="/zh/docs/pgsql/acl/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlacl"><i class="fa-solid fa-lock"></i><span class="">访问控制</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlpitr-li">
  <input type="checkbox" id="m-zhdocspgsqlpitr-check"/>
  <label for="m-zhdocspgsqlpitr-check"><a href="/zh/docs/pgsql/pitr/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlpitr"><i class="fa-solid fa-clock-rotate-left"></i><span class="">备份恢复</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlmigration-li">
  <input type="checkbox" id="m-zhdocspgsqlmigration-check"/>
  <label for="m-zhdocspgsqlmigration-check"><a href="/zh/docs/pgsql/migration/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlmigration"><i class="fa-solid fa-truck-moving"></i><span class="">迁移</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlmonitor-li">
  <input type="checkbox" id="m-zhdocspgsqlmonitor-check"/>
  <label for="m-zhdocspgsqlmonitor-check"><a href="/zh/docs/pgsql/monitor/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlmonitor"><i class="fa-solid fa-binoculars"></i><span class="">监控接入</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqldashboard-li">
  <input type="checkbox" id="m-zhdocspgsqldashboard-check"/>
  <label for="m-zhdocspgsqldashboard-check"><a href="/zh/docs/pgsql/dashboard/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqldashboard"><i class="fa-solid fa-gauge-simple-high"></i><span class="">监控面板</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlmetric-li">
  <input type="checkbox" id="m-zhdocspgsqlmetric-check"/>
  <label for="m-zhdocspgsqlmetric-check"><a href="/zh/docs/pgsql/metric/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlmetric"><i class="fa-solid fa-list-check"></i><span class="">指标列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgsqlfaq-li">
  <input type="checkbox" id="m-zhdocspgsqlfaq-check"/>
  <label for="m-zhdocspgsqlfaq-check"><a href="/zh/docs/pgsql/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgsqlfaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocskernel-li">
  <input type="checkbox" id="m-zhdocskernel-check"/>
  <label for="m-zhdocskernel-check"><a href="/zh/docs/kernel/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocskernel"><i class="fas fa-gear"></i><span class="">内核：PGSQL</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelcitus-li">
  <input type="checkbox" id="m-zhdocskernelcitus-check"/>
  <label for="m-zhdocskernelcitus-check"><a href="/zh/docs/kernel/citus/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelcitus"><i class="fas fa-lemon"></i><span class="">Citus (Distributive)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelbabelfish-li">
  <input type="checkbox" id="m-zhdocskernelbabelfish-check"/>
  <label for="m-zhdocskernelbabelfish-check"><a href="/zh/docs/kernel/babelfish/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelbabelfish"><i class="fab fa-microsoft"></i><span class="">Babelfish (MSSQL)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelivorysql-li">
  <input type="checkbox" id="m-zhdocskernelivorysql-check"/>
  <label for="m-zhdocskernelivorysql-check"><a href="/zh/docs/kernel/ivorysql/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelivorysql"><i class="fas fa-server"></i><span class="">IvorySQL (Oracle)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelpolardb-li">
  <input type="checkbox" id="m-zhdocskernelpolardb-check"/>
  <label for="m-zhdocskernelpolardb-check"><a href="/zh/docs/kernel/polardb/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelpolardb"><i class="fas fa-paw"></i><span class="">PolarDB PG (RAC)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelpolardb-o-li">
  <input type="checkbox" id="m-zhdocskernelpolardb-o-check"/>
  <label for="m-zhdocskernelpolardb-o-check"><a href="/zh/docs/kernel/polardb-o/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelpolardb-o"><i class="fas fa-paw"></i><span class="">PolarDB O(racle)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelpgml-li">
  <input type="checkbox" id="m-zhdocskernelpgml-check"/>
  <label for="m-zhdocskernelpgml-check"><a href="/zh/docs/kernel/pgml/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelpgml"><i class="fas fa-bolt"></i><span class="">PostgresML (AI/ML)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelsupabase-li">
  <input type="checkbox" id="m-zhdocskernelsupabase-check"/>
  <label for="m-zhdocskernelsupabase-check"><a href="/zh/docs/kernel/supabase/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelsupabase"><i class="fas fa-bolt"></i><span class="">Supabase (Firebase)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelgreenplum-li">
  <input type="checkbox" id="m-zhdocskernelgreenplum-check"/>
  <label for="m-zhdocskernelgreenplum-check"><a href="/zh/docs/kernel/greenplum/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelgreenplum"><i class="fas fa-leaf"></i><span class="">Greenplum (MPP)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelcloudberry-li">
  <input type="checkbox" id="m-zhdocskernelcloudberry-check"/>
  <label for="m-zhdocskernelcloudberry-check"><a href="/zh/docs/kernel/cloudberry/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelcloudberry"><i class="fas fa-leaf"></i><span class="">Cloudberry (MPP)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocskernelneon-li">
  <input type="checkbox" id="m-zhdocskernelneon-check"/>
  <label for="m-zhdocskernelneon-check"><a href="/zh/docs/kernel/neon/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocskernelneon"><i class="fab fa-neos"></i><span class="">Neon (Serverless)</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocspgext-li">
  <input type="checkbox" id="m-zhdocspgext-check"/>
  <label for="m-zhdocspgext-check"><a href="/zh/docs/pgext/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocspgext"><i class="fa-brands fa-usb"></i><span class="">扩展：PGSQL</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocspgextusage-li">
  <input type="checkbox" id="m-zhdocspgextusage-check"/>
  <label for="m-zhdocspgextusage-check"><a href="/zh/docs/pgext/usage/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocspgextusage"><i class="fas fa-cloud-arrow-down"></i><span class="">安装使用</span></a></label>
  
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusageintro-li">
  <input type="checkbox" id="m-zhdocspgextusageintro-check"/>
  <label for="m-zhdocspgextusageintro-check"><a href="/zh/docs/pgext/usage/intro/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusageintro"><i class="fas fa-boxes-stacked"></i><span class="">快速上手</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusagedownload-li">
  <input type="checkbox" id="m-zhdocspgextusagedownload-check"/>
  <label for="m-zhdocspgextusagedownload-check"><a href="/zh/docs/pgext/usage/download/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusagedownload"><i class="fas fa-boxes-stacked"></i><span class="">下载扩展</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusagerepo-li">
  <input type="checkbox" id="m-zhdocspgextusagerepo-check"/>
  <label for="m-zhdocspgextusagerepo-check"><a href="/zh/docs/pgext/usage/repo/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusagerepo"><i class="fas fa-boxes-stacked"></i><span class="">扩展仓库</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusageinstall-li">
  <input type="checkbox" id="m-zhdocspgextusageinstall-check"/>
  <label for="m-zhdocspgextusageinstall-check"><a href="/zh/docs/pgext/usage/install/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusageinstall"><i class="fas fa-boxes-stacked"></i><span class="">安装扩展</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusageload-li">
  <input type="checkbox" id="m-zhdocspgextusageload-check"/>
  <label for="m-zhdocspgextusageload-check"><a href="/zh/docs/pgext/usage/load/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusageload"><i class="fas fa-boxes-stacked"></i><span class="">加载扩展</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusagecreate-li">
  <input type="checkbox" id="m-zhdocspgextusagecreate-check"/>
  <label for="m-zhdocspgextusagecreate-check"><a href="/zh/docs/pgext/usage/create/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusagecreate"><i class="fas fa-boxes-stacked"></i><span class="">启用扩展</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusageupdate-li">
  <input type="checkbox" id="m-zhdocspgextusageupdate-check"/>
  <label for="m-zhdocspgextusageupdate-check"><a href="/zh/docs/pgext/usage/update/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusageupdate"><i class="fas fa-boxes-stacked"></i><span class="">更新扩展</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusageremove-li">
  <input type="checkbox" id="m-zhdocspgextusageremove-check"/>
  <label for="m-zhdocspgextusageremove-check"><a href="/zh/docs/pgext/usage/remove/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusageremove"><i class="fas fa-boxes-stacked"></i><span class="">卸载扩展</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextusagestack-li">
  <input type="checkbox" id="m-zhdocspgextusagestack-check"/>
  <label for="m-zhdocspgextusagestack-check"><a href="/zh/docs/pgext/usage/stack/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextusagestack"><i class="fab fa-stack-overflow"></i><span class="">预定义扩展栈</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocspgextlist-li">
  <input type="checkbox" id="m-zhdocspgextlist-check"/>
  <label for="m-zhdocspgextlist-check"><a href="/zh/docs/pgext/list/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocspgextlist"><i class="fa-solid fa-earth-asia"></i><span class="">扩展清单</span></a></label>
  
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextlistmeta-li">
  <input type="checkbox" id="m-zhdocspgextlistmeta-check"/>
  <label for="m-zhdocspgextlistmeta-check"><a href="/zh/docs/pgext/list/meta/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextlistmeta"><i class="fas fa-tags"></i><span class="">扩展元数据</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextlistrpm-li">
  <input type="checkbox" id="m-zhdocspgextlistrpm-check"/>
  <label for="m-zhdocspgextlistrpm-check"><a href="/zh/docs/pgext/list/rpm/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextlistrpm"><i class="fab fa-redhat"></i><span class="">RPM 扩展清单</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextlistdeb-li">
  <input type="checkbox" id="m-zhdocspgextlistdeb-check"/>
  <label for="m-zhdocspgextlistdeb-check"><a href="/zh/docs/pgext/list/deb/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextlistdeb"><i class="fab fa-debian"></i><span class="">DEB 扩展清单</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextlistcontrib-li">
  <input type="checkbox" id="m-zhdocspgextlistcontrib-check"/>
  <label for="m-zhdocspgextlistcontrib-check"><a href="/zh/docs/pgext/list/contrib/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextlistcontrib"><i class="fas fa-database"></i><span class="">Contrib 扩展清单</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocspgextbuild-li">
  <input type="checkbox" id="m-zhdocspgextbuild-check"/>
  <label for="m-zhdocspgextbuild-check"><a href="/zh/docs/pgext/build/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocspgextbuild"><i class="fas fa-screwdriver-wrench"></i><span class="">构建打包</span></a></label>
  
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextbuildenv-li">
  <input type="checkbox" id="m-zhdocspgextbuildenv-check"/>
  <label for="m-zhdocspgextbuildenv-check"><a href="/zh/docs/pgext/build/env/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextbuildenv"><span class="">虚拟机构建环境</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextbuildrust-li">
  <input type="checkbox" id="m-zhdocspgextbuildrust-check"/>
  <label for="m-zhdocspgextbuildrust-check"><a href="/zh/docs/pgext/build/rust/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextbuildrust"><span class="">准备 rust 与 pgrx</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextbuildpgml-li">
  <input type="checkbox" id="m-zhdocspgextbuildpgml-check"/>
  <label for="m-zhdocspgextbuildpgml-check"><a href="/zh/docs/pgext/build/pgml/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextbuildpgml"><span class="">PGML 构建指南</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextbuildplv8-li">
  <input type="checkbox" id="m-zhdocspgextbuildplv8-check"/>
  <label for="m-zhdocspgextbuildplv8-check"><a href="/zh/docs/pgext/build/plv8/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextbuildplv8"><span class="">PLv8 构建指南</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextbuildparadedb-li">
  <input type="checkbox" id="m-zhdocspgextbuildparadedb-check"/>
  <label for="m-zhdocspgextbuildparadedb-check"><a href="/zh/docs/pgext/build/paradedb/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextbuildparadedb"><span class="">ParadeDB 构建指南</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextbuildduckdb_fdw-li">
  <input type="checkbox" id="m-zhdocspgextbuildduckdb_fdw-check"/>
  <label for="m-zhdocspgextbuildduckdb_fdw-check"><a href="/zh/docs/pgext/build/duckdb_fdw/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextbuildduckdb_fdw"><span class="">DuckDB FDW 构建指南</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspgextbuildparquet_s3_fdw-li">
  <input type="checkbox" id="m-zhdocspgextbuildparquet_s3_fdw-check"/>
  <label for="m-zhdocspgextbuildparquet_s3_fdw-check"><a href="/zh/docs/pgext/build/parquet_s3_fdw/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocspgextbuildparquet_s3_fdw"><span class="">Parquet S3 FDW 构建指南</span></a></label>
  
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsinfra-li">
  <input type="checkbox" id="m-zhdocsinfra-check"/>
  <label for="m-zhdocsinfra-check"><a href="/zh/docs/infra/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsinfra"><i class="fas fa-bank"></i><span class="">模块：INFRA</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsinframetric-li">
  <input type="checkbox" id="m-zhdocsinframetric-check"/>
  <label for="m-zhdocsinframetric-check"><a href="/zh/docs/infra/metric/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsinframetric"><i class="fa-solid fa-list-check"></i><span class="">指标列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsinfrafaq-li">
  <input type="checkbox" id="m-zhdocsinfrafaq-check"/>
  <label for="m-zhdocsinfrafaq-check"><a href="/zh/docs/infra/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsinfrafaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsnode-li">
  <input type="checkbox" id="m-zhdocsnode-check"/>
  <label for="m-zhdocsnode-check"><a href="/zh/docs/node/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsnode"><i class="fas fa-server"></i><span class="">模块：NODE</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsnodemetric-li">
  <input type="checkbox" id="m-zhdocsnodemetric-check"/>
  <label for="m-zhdocsnodemetric-check"><a href="/zh/docs/node/metric/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsnodemetric"><i class="fa-solid fa-list-check"></i><span class="">指标列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsnodefaq-li">
  <input type="checkbox" id="m-zhdocsnodefaq-check"/>
  <label for="m-zhdocsnodefaq-check"><a href="/zh/docs/node/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsnodefaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsetcd-li">
  <input type="checkbox" id="m-zhdocsetcd-check"/>
  <label for="m-zhdocsetcd-check"><a href="/zh/docs/etcd/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsetcd"><i class="fas fa-gears"></i><span class="">模块：ETCD</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsetcdconfig-li">
  <input type="checkbox" id="m-zhdocsetcdconfig-check"/>
  <label for="m-zhdocsetcdconfig-check"><a href="/zh/docs/etcd/config/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsetcdconfig"><i class="fa-solid fa-code"></i><span class="">集群配置</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsetcdparam-li">
  <input type="checkbox" id="m-zhdocsetcdparam-check"/>
  <label for="m-zhdocsetcdparam-check"><a href="/zh/docs/etcd/param/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsetcdparam"><i class="fa-solid fa-terminal"></i><span class="">参数列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsetcdplaybook-li">
  <input type="checkbox" id="m-zhdocsetcdplaybook-check"/>
  <label for="m-zhdocsetcdplaybook-check"><a href="/zh/docs/etcd/playbook/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsetcdplaybook"><i class="fa-solid fa-scroll"></i><span class="">预置剧本</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsetcdadmin-li">
  <input type="checkbox" id="m-zhdocsetcdadmin-check"/>
  <label for="m-zhdocsetcdadmin-check"><a href="/zh/docs/etcd/admin/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsetcdadmin"><i class="fa-solid fa-building-columns"></i><span class="">管理预案</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsetcdmonitor-li">
  <input type="checkbox" id="m-zhdocsetcdmonitor-check"/>
  <label for="m-zhdocsetcdmonitor-check"><a href="/zh/docs/etcd/monitor/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsetcdmonitor"><i class="fa-solid fa-binoculars"></i><span class="">监控告警</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsetcdmetric-li">
  <input type="checkbox" id="m-zhdocsetcdmetric-check"/>
  <label for="m-zhdocsetcdmetric-check"><a href="/zh/docs/etcd/metric/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsetcdmetric"><i class="fa-solid fa-list-check"></i><span class="">指标列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsetcdfaq-li">
  <input type="checkbox" id="m-zhdocsetcdfaq-check"/>
  <label for="m-zhdocsetcdfaq-check"><a href="/zh/docs/etcd/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsetcdfaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsminio-li">
  <input type="checkbox" id="m-zhdocsminio-check"/>
  <label for="m-zhdocsminio-check"><a href="/zh/docs/minio/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsminio"><i class="fas fa-boxes-stacked"></i><span class="">模块：MINIO</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsminiousage-li">
  <input type="checkbox" id="m-zhdocsminiousage-check"/>
  <label for="m-zhdocsminiousage-check"><a href="/zh/docs/minio/usage/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsminiousage"><i class="fa-solid fa-bell-concierge"></i><span class="">使用方法</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsminioconfig-li">
  <input type="checkbox" id="m-zhdocsminioconfig-check"/>
  <label for="m-zhdocsminioconfig-check"><a href="/zh/docs/minio/config/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsminioconfig"><i class="fa-solid fa-code"></i><span class="">集群配置</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsminioparam-li">
  <input type="checkbox" id="m-zhdocsminioparam-check"/>
  <label for="m-zhdocsminioparam-check"><a href="/zh/docs/minio/param/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsminioparam"><i class="fa-solid fa-terminal"></i><span class="">参数列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsminioplaybook-li">
  <input type="checkbox" id="m-zhdocsminioplaybook-check"/>
  <label for="m-zhdocsminioplaybook-check"><a href="/zh/docs/minio/playbook/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsminioplaybook"><i class="fa-solid fa-scroll"></i><span class="">预置剧本</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsminioadmin-li">
  <input type="checkbox" id="m-zhdocsminioadmin-check"/>
  <label for="m-zhdocsminioadmin-check"><a href="/zh/docs/minio/admin/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsminioadmin"><i class="fa-solid fa-building-columns"></i><span class="">管理预案</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsminiomonitor-li">
  <input type="checkbox" id="m-zhdocsminiomonitor-check"/>
  <label for="m-zhdocsminiomonitor-check"><a href="/zh/docs/minio/monitor/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsminiomonitor"><i class="fa-solid fa-binoculars"></i><span class="">监控告警</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsminiometric-li">
  <input type="checkbox" id="m-zhdocsminiometric-check"/>
  <label for="m-zhdocsminiometric-check"><a href="/zh/docs/minio/metric/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsminiometric"><i class="fa-solid fa-list-check"></i><span class="">指标列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsminiofaq-li">
  <input type="checkbox" id="m-zhdocsminiofaq-check"/>
  <label for="m-zhdocsminiofaq-check"><a href="/zh/docs/minio/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsminiofaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsredis-li">
  <input type="checkbox" id="m-zhdocsredis-check"/>
  <label for="m-zhdocsredis-check"><a href="/zh/docs/redis/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsredis"><i class="fas fa-layer-group"></i><span class="">模块：REDIS</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsredismetric-li">
  <input type="checkbox" id="m-zhdocsredismetric-check"/>
  <label for="m-zhdocsredismetric-check"><a href="/zh/docs/redis/metric/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsredismetric"><i class="fa-solid fa-list-check"></i><span class="">指标列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsredisfaq-li">
  <input type="checkbox" id="m-zhdocsredisfaq-check"/>
  <label for="m-zhdocsredisfaq-check"><a href="/zh/docs/redis/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsredisfaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsferret-li">
  <input type="checkbox" id="m-zhdocsferret-check"/>
  <label for="m-zhdocsferret-check"><a href="/zh/docs/ferret/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsferret"><i class="fas fa-leaf"></i><span class="">模块：FERRET</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsferretmetric-li">
  <input type="checkbox" id="m-zhdocsferretmetric-check"/>
  <label for="m-zhdocsferretmetric-check"><a href="/zh/docs/ferret/metric/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsferretmetric"><i class="fa-solid fa-list-check"></i><span class="">指标列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsferretfaq-li">
  <input type="checkbox" id="m-zhdocsferretfaq-check"/>
  <label for="m-zhdocsferretfaq-check"><a href="/zh/docs/ferret/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsferretfaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsdocker-li">
  <input type="checkbox" id="m-zhdocsdocker-check"/>
  <label for="m-zhdocsdocker-check"><a href="/zh/docs/docker/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsdocker"><i class="fa-brands fa-docker"></i><span class="">模块：DOCKER</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsdockerusage-li">
  <input type="checkbox" id="m-zhdocsdockerusage-check"/>
  <label for="m-zhdocsdockerusage-check"><a href="/zh/docs/docker/usage/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsdockerusage"><i class="fa-solid fa-bell-concierge"></i><span class="">使用方法</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsdockerparam-li">
  <input type="checkbox" id="m-zhdocsdockerparam-check"/>
  <label for="m-zhdocsdockerparam-check"><a href="/zh/docs/docker/param/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsdockerparam"><i class="fa-solid fa-terminal"></i><span class="">参数列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsdockerplaybook-li">
  <input type="checkbox" id="m-zhdocsdockerplaybook-check"/>
  <label for="m-zhdocsdockerplaybook-check"><a href="/zh/docs/docker/playbook/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsdockerplaybook"><i class="fa-solid fa-scroll"></i><span class="">预置剧本</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsdockermetric-li">
  <input type="checkbox" id="m-zhdocsdockermetric-check"/>
  <label for="m-zhdocsdockermetric-check"><a href="/zh/docs/docker/metric/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsdockermetric"><i class="fa-solid fa-list-check"></i><span class="">指标列表</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsdockerfaq-li">
  <input type="checkbox" id="m-zhdocsdockerfaq-check"/>
  <label for="m-zhdocsdockerfaq-check"><a href="/zh/docs/docker/faq/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsdockerfaq"><i class="fa-solid fa-circle-question"></i><span class="">常见问题</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocspro-li">
  <input type="checkbox" id="m-zhdocspro-check"/>
  <label for="m-zhdocspro-check"><a href="/zh/docs/pro/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocspro"><i class="fas fa-flask-vial"></i><span class="">模块：专业/试点</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocspromysql-li">
  <input type="checkbox" id="m-zhdocspromysql-check"/>
  <label for="m-zhdocspromysql-check"><a href="/zh/docs/pro/mysql/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocspromysql"><i class="fas fa-fish"></i><span class="">模块：MySQL</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsprokafka-li">
  <input type="checkbox" id="m-zhdocsprokafka-check"/>
  <label for="m-zhdocsprokafka-check"><a href="/zh/docs/pro/kafka/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsprokafka"><i class="fas fa-share-nodes"></i><span class="">模块：Kafka</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsproduckdb-li">
  <input type="checkbox" id="m-zhdocsproduckdb-check"/>
  <label for="m-zhdocsproduckdb-check"><a href="/zh/docs/pro/duckdb/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsproduckdb"><i class="fas fa-crow"></i><span class="">模块：DuckDB</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsprotigerbeetle-li">
  <input type="checkbox" id="m-zhdocsprotigerbeetle-check"/>
  <label for="m-zhdocsprotigerbeetle-check"><a href="/zh/docs/pro/tigerbeetle/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsprotigerbeetle"><i class="fas fa-bug"></i><span class="">模块：TigerBeetle</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsprokube-li">
  <input type="checkbox" id="m-zhdocsprokube-check"/>
  <label for="m-zhdocsprokube-check"><a href="/zh/docs/pro/kube/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsprokube"><i class="fas fa-dharmachakra"></i><span class="">模块：Kubernetes</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsproconsul-li">
  <input type="checkbox" id="m-zhdocsproconsul-check"/>
  <label for="m-zhdocsproconsul-check"><a href="/zh/docs/pro/consul/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsproconsul"><i class="fas fa-c"></i><span class="">模块：Consul</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsprovictoria-li">
  <input type="checkbox" id="m-zhdocsprovictoria-check"/>
  <label for="m-zhdocsprovictoria-check"><a href="/zh/docs/pro/victoria/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsprovictoria"><i class="fas fa-layer-group"></i><span class="">模块：Victoria</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsprojupyter-li">
  <input type="checkbox" id="m-zhdocsprojupyter-check"/>
  <label for="m-zhdocsprojupyter-check"><a href="/zh/docs/pro/jupyter/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsprojupyter"><i class="fab fa-python"></i><span class="">模块：Jupyter</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocstasks-li">
  <input type="checkbox" id="m-zhdocstasks-check"/>
  <label for="m-zhdocstasks-check"><a href="/zh/docs/tasks/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocstasks"><i class="fas fa-tasks"></i><span class="">任务与教程</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocstasksnginx-li">
  <input type="checkbox" id="m-zhdocstasksnginx-check"/>
  <label for="m-zhdocstasksnginx-check"><a href="/zh/docs/tasks/nginx/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocstasksnginx"><i class="fa-solid fa-arrow-right-from-bracket"></i><span class="">Nginx：向外代理暴露Web服务</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocstasksdocker-li">
  <input type="checkbox" id="m-zhdocstasksdocker-check"/>
  <label for="m-zhdocstasksdocker-check"><a href="/zh/docs/tasks/docker/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocstasksdocker"><i class="fa-brands fa-docker"></i><span class="">Docker：启用容器支持与配置</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocstasksansible-li">
  <input type="checkbox" id="m-zhdocstasksansible-check"/>
  <label for="m-zhdocstasksansible-check"><a href="/zh/docs/tasks/ansible/" title="使用 PostgreSQL 作为 Ansible 的配置清单与 CMDB" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocstasksansible"><i class="fa-solid fa-database"></i><span class="">Ansible：使用PG作为配置源</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocstasksnode-vip-li">
  <input type="checkbox" id="m-zhdocstasksnode-vip-check"/>
  <label for="m-zhdocstasksnode-vip-check"><a href="/zh/docs/tasks/node-vip/" title="使用 Keepalived 为 Pigsty 节点集群配置二层 VIP" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocstasksnode-vip"><i class="fa-solid fa-share-nodes"></i><span class="">Node VIP：为节点集群绑定VIP</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocstaskspg-vip-li">
  <input type="checkbox" id="m-zhdocstaskspg-vip-check"/>
  <label for="m-zhdocstaskspg-vip-check"><a href="/zh/docs/tasks/pg-vip/" title="使用 VIP-Manager 为 PostgreSQL 集群配置二层 VIP" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocstaskspg-vip"><i class="fa-solid fa-arrows-split-up-and-left"></i><span class="">PGSQL VIP：为PG集群绑定VIP</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocstasksgrafana-li">
  <input type="checkbox" id="m-zhdocstasksgrafana-check"/>
  <label for="m-zhdocstasksgrafana-check"><a href="/zh/docs/tasks/grafana/" title="使用 PostgreSQL 作为 Grafana 后端数据库" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocstasksgrafana"><i class="fa-solid fa-microscope"></i><span class="">Grafana：使用PG存储元数据</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocstaskspromscale-li">
  <input type="checkbox" id="m-zhdocstaskspromscale-check"/>
  <label for="m-zhdocstaskspromscale-check"><a href="/zh/docs/tasks/promscale/" title="使用 TimescaleDB &#43; Promscale 存储 Prometheus 时序指标数据" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocstaskspromscale"><i class="fa-solid fa-truck-moving"></i><span class="">Prometheus：使用PG存储指标</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocssoftware-li">
  <input type="checkbox" id="m-zhdocssoftware-check"/>
  <label for="m-zhdocssoftware-check"><a href="/zh/docs/software/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocssoftware"><i class="fa-brands fa-docker"></i><span class="">软件镜像模板</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwaredify-li">
  <input type="checkbox" id="m-zhdocssoftwaredify-check"/>
  <label for="m-zhdocssoftwaredify-check"><a href="/zh/docs/software/dify/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwaredify"><span class="">Dify：自建开源AI工作流编排平台</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwareodoo-li">
  <input type="checkbox" id="m-zhdocssoftwareodoo-check"/>
  <label for="m-zhdocssoftwareodoo-check"><a href="/zh/docs/software/odoo/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwareodoo"><span class="">Odoo：自建开源ERP系统</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwarekong-li">
  <input type="checkbox" id="m-zhdocssoftwarekong-check"/>
  <label for="m-zhdocssoftwarekong-check"><a href="/zh/docs/software/kong/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwarekong"><span class="">Kong：企业级开源 API 网关</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwarejupyter-li">
  <input type="checkbox" id="m-zhdocssoftwarejupyter-check"/>
  <label for="m-zhdocssoftwarejupyter-check"><a href="/zh/docs/software/jupyter/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwarejupyter"><span class="">Jupyter：数据分析笔记本与AI IDE</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwaregitea-li">
  <input type="checkbox" id="m-zhdocssoftwaregitea-check"/>
  <label for="m-zhdocssoftwaregitea-check"><a href="/zh/docs/software/gitea/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwaregitea"><span class="">Gitea：自建简易代码托管平台</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwarewiki-li">
  <input type="checkbox" id="m-zhdocssoftwarewiki-check"/>
  <label for="m-zhdocssoftwarewiki-check"><a href="/zh/docs/software/wiki/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwarewiki"><span class="">Wiki.js：搭建你自己的维基百科</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwareminio-li">
  <input type="checkbox" id="m-zhdocssoftwareminio-check"/>
  <label for="m-zhdocssoftwareminio-check"><a href="/zh/docs/software/minio/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwareminio"><span class="">Minio：开源S3，简单对象存储服务</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwarebytebase-li">
  <input type="checkbox" id="m-zhdocssoftwarebytebase-check"/>
  <label for="m-zhdocssoftwarebytebase-check"><a href="/zh/docs/software/bytebase/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwarebytebase"><span class="">ByteBase：PG模式迁移工具</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwarepgadmin-li">
  <input type="checkbox" id="m-zhdocssoftwarepgadmin-check"/>
  <label for="m-zhdocssoftwarepgadmin-check"><a href="/zh/docs/software/pgadmin/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwarepgadmin"><span class="">PGAdmin4：用GUI管理PG数据库</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwarepostgrest-li">
  <input type="checkbox" id="m-zhdocssoftwarepostgrest-check"/>
  <label for="m-zhdocssoftwarepostgrest-check"><a href="/zh/docs/software/postgrest/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwarepostgrest"><span class="">PostgREST：自动生成REST API</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwareschemaspy-li">
  <input type="checkbox" id="m-zhdocssoftwareschemaspy-check"/>
  <label for="m-zhdocssoftwareschemaspy-check"><a href="/zh/docs/software/schemaspy/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwareschemaspy"><span class="">SchemaSPY：PG模式可视化</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwarepgweb-li">
  <input type="checkbox" id="m-zhdocssoftwarepgweb-check"/>
  <label for="m-zhdocssoftwarepgweb-check"><a href="/zh/docs/software/pgweb/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwarepgweb"><span class="">PGWeb：从浏览器访问PostgreSQL</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwarediscourse-li">
  <input type="checkbox" id="m-zhdocssoftwarediscourse-check"/>
  <label for="m-zhdocssoftwarediscourse-check"><a href="/zh/docs/software/discourse/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwarediscourse"><span class="">Discourse：开源技术论坛</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocssoftwaregitlab-li">
  <input type="checkbox" id="m-zhdocssoftwaregitlab-check"/>
  <label for="m-zhdocssoftwaregitlab-check"><a href="/zh/docs/software/gitlab/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocssoftwaregitlab"><span class="">GitLab：企业级开源代码托管平台</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-zhdocsapplet-li">
  <input type="checkbox" id="m-zhdocsapplet-check"/>
  <label for="m-zhdocsapplet-check"><a href="/zh/docs/applet/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-zhdocsapplet"><i class="fa-solid fa-chart-line"></i><span class="">数据分析应用</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsappletpglog-li">
  <input type="checkbox" id="m-zhdocsappletpglog-check"/>
  <label for="m-zhdocsappletpglog-check"><a href="/zh/docs/applet/pglog/" title="PGLOG：PG自带日志分析应用" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsappletpglog"><span class="">PGLOG CSV日志分析</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsappletisd-li">
  <input type="checkbox" id="m-zhdocsappletisd-check"/>
  <label for="m-zhdocsappletisd-check"><a href="/zh/docs/applet/isd/" title="NOAA ISD 全球气象站历史数据查询" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsappletisd"><span class="">ISD 全球气象数据查询</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsappletcovid-li">
  <input type="checkbox" id="m-zhdocsappletcovid-check"/>
  <label for="m-zhdocsappletcovid-check"><a href="/zh/docs/applet/covid/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsappletcovid"><span class="">WHO COVID-19 疫情大盘</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsappletcloud-li">
  <input type="checkbox" id="m-zhdocsappletcloud-check"/>
  <label for="m-zhdocsappletcloud-check"><a href="/zh/docs/applet/cloud/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsappletcloud"><span class="">AWS 阿里云 服务器价格</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsappletpoker24-li">
  <input type="checkbox" id="m-zhdocsappletpoker24-check"/>
  <label for="m-zhdocsappletpoker24-check"><a href="/zh/docs/applet/poker24/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsappletpoker24"><span class="">使用一条 SQL 计算扑克24点</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsappletdb-engine-li">
  <input type="checkbox" id="m-zhdocsappletdb-engine-check"/>
  <label for="m-zhdocsappletdb-engine-check"><a href="/zh/docs/applet/db-engine/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsappletdb-engine"><span class="">DB-Engine 数据库热度趋势分析</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-zhdocsappletsf-survey-li">
  <input type="checkbox" id="m-zhdocsappletsf-survey-check"/>
  <label for="m-zhdocsappletsf-survey-check"><a href="/zh/docs/applet/sf-survey/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-zhdocsappletsf-survey"><span class="">StackOverflow 全球开发者调研</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-zhdocsreleasenote-li">
  <input type="checkbox" id="m-zhdocsreleasenote-check" checked/>
  <label for="m-zhdocsreleasenote-check"><a href="/zh/docs/releasenote/" class="align-left ps-0  active td-sidebar-link td-sidebar-link__page" id="m-zhdocsreleasenote"><i class="fa-regular fa-clipboard"></i><span class="td-sidebar-nav-active-item">版本发布历史</span></a></label>
  
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">
<a href="https://github.com/Vonng/pigsty.cc/tree/main/content/zh/docs/releasenote.md" class="td-page-meta--view td-page-meta__view" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
  <a href="https://github.com/Vonng/pigsty.cc/edit/main/content/zh/docs/releasenote.md" class="td-page-meta--edit td-page-meta__edit" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
  <a href="https://github.com/Vonng/pigsty.cc/new/main/content/zh/docs?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child td-page-meta__child" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
  <a href="https://github.com/Vonng/pigsty.cc/issues/new?title=%e7%89%88%e6%9c%ac%e5%8f%91%e5%b8%83%e5%8e%86%e5%8f%b2" class="td-page-meta--issue td-page-meta__issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
  <a href="https://github.com/Vonng/pigsty/issues/new" class="td-page-meta--project td-page-meta__project-issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
  <a id="print" href="/zh/docs/_print/"><i class="fa-solid fa-print fa-fw"></i> Print entire section</a>

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#v320">v3.2.0</a></li>
    <li><a href="#v310">v3.1.0</a></li>
    <li><a href="#v304">v3.0.4</a></li>
    <li><a href="#v303">v3.0.3</a></li>
    <li><a href="#v302">v3.0.2</a></li>
    <li><a href="#v301">v3.0.1</a></li>
    <li><a href="#v300">v3.0.0</a></li>
    <li><a href="#v270">v2.7.0</a></li>
    <li><a href="#v260">v2.6.0</a></li>
    <li><a href="#v251">v2.5.1</a></li>
    <li><a href="#v250">v2.5.0</a></li>
    <li><a href="#v241">v2.4.1</a></li>
    <li><a href="#v240">v2.4.0</a></li>
    <li><a href="#v231">v2.3.1</a></li>
    <li><a href="#v230">v2.3.0</a></li>
    <li><a href="#v220">v2.2.0</a></li>
    <li><a href="#v210">v2.1.0</a></li>
    <li><a href="#v202">v2.0.2</a></li>
    <li><a href="#v201">v2.0.1</a></li>
    <li><a href="#v200">v2.0.0</a></li>
    <li><a href="#v151">v1.5.1</a></li>
    <li><a href="#v150">v1.5.0</a></li>
    <li><a href="#v141">v1.4.1</a></li>
    <li><a href="#v140">v1.4.0</a></li>
    <li><a href="#v131">v1.3.1</a></li>
    <li><a href="#v130">v1.3.0</a></li>
    <li><a href="#v120">v1.2.0</a></li>
    <li><a href="#v111">v1.1.1</a></li>
    <li><a href="#v110">v1.1.0</a></li>
    <li><a href="#v101">v1.0.1</a></li>
    <li><a href="#v100">v1.0.0</a></li>
    <li><a href="#v090">v0.9.0</a></li>
    <li><a href="#v080">v0.8.0</a></li>
    <li><a href="#v070">v0.7.0</a></li>
    <li><a href="#v060">v0.6.0</a></li>
    <li><a href="#v050">v0.5.0</a></li>
    <li><a href="#v040">v0.4.0</a></li>
    <li><a href="#v030">v0.3.0</a></li>
  </ul>
</nav>
      </div>
    
            <div class="taxonomy taxonomy-terms-cloud taxo-module">
      <h5 class="taxonomy-title">Modules</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="/zh/module/app/" data-taxonomy-term="app"><span class="taxonomy-label">APP</span><span class="taxonomy-count">9</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/blog/" data-taxonomy-term="blog"><span class="taxonomy-label">BLOG</span><span class="taxonomy-count">8</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/docker/" data-taxonomy-term="docker"><span class="taxonomy-label">DOCKER</span><span class="taxonomy-count">8</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/etcd/" data-taxonomy-term="etcd"><span class="taxonomy-label">ETCD</span><span class="taxonomy-count">7</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/infra/" data-taxonomy-term="infra"><span class="taxonomy-label">INFRA</span><span class="taxonomy-count">9</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/jupyter/" data-taxonomy-term="jupyter"><span class="taxonomy-label">JUPYTER</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/kafka/" data-taxonomy-term="kafka"><span class="taxonomy-label">KAFKA</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/minio/" data-taxonomy-term="minio"><span class="taxonomy-label">MINIO</span><span class="taxonomy-count">9</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/mongo/" data-taxonomy-term="mongo"><span class="taxonomy-label">MONGO</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/mysql/" data-taxonomy-term="mysql"><span class="taxonomy-label">MYSQL</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/node/" data-taxonomy-term="node"><span class="taxonomy-label">NODE</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/pgsql/" data-taxonomy-term="pgsql"><span class="taxonomy-label">PGSQL</span><span class="taxonomy-count">62</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/pigsty/" data-taxonomy-term="pigsty"><span class="taxonomy-label">PIGSTY</span><span class="taxonomy-count">42</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/redis/" data-taxonomy-term="redis"><span class="taxonomy-label">REDIS</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/software/" data-taxonomy-term="software"><span class="taxonomy-label">SOFTWARE</span><span class="taxonomy-count">16</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/tigerbeetle/" data-taxonomy-term="tigerbeetle"><span class="taxonomy-label">TigerBeetle</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/module/victoria/" data-taxonomy-term="victoria"><span class="taxonomy-label">VICTORIA</span><span class="taxonomy-count">1</span></a></li>
        </ul>
    </div>
  <div class="taxonomy taxonomy-terms-cloud taxo-categories">
      <h5 class="taxonomy-title">Categories</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="/zh/categories/about/" data-taxonomy-term="about"><span class="taxonomy-label">About</span><span class="taxonomy-count">10</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/admin/" data-taxonomy-term="admin"><span class="taxonomy-label">Admin</span><span class="taxonomy-count">23</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/ai/" data-taxonomy-term="ai"><span class="taxonomy-label">AI</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/arch/" data-taxonomy-term="arch"><span class="taxonomy-label">Arch</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/business/" data-taxonomy-term="business"><span class="taxonomy-label">Business</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/concept/" data-taxonomy-term="concept"><span class="taxonomy-label">Concept</span><span class="taxonomy-count">12</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/config/" data-taxonomy-term="config"><span class="taxonomy-label">Config</span><span class="taxonomy-count">25</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/dashboard/" data-taxonomy-term="dashboard"><span class="taxonomy-label">Dashboard</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/database/" data-taxonomy-term="database"><span class="taxonomy-label">Database</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/develop/" data-taxonomy-term="develop"><span class="taxonomy-label">Develop</span><span class="taxonomy-count">11</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/enterprise/" data-taxonomy-term="enterprise"><span class="taxonomy-label">Enterprise</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/extension/" data-taxonomy-term="extension"><span class="taxonomy-label">Extension</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/faq/" data-taxonomy-term="faq"><span class="taxonomy-label">FAQ</span><span class="taxonomy-count">9</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/install/" data-taxonomy-term="install"><span class="taxonomy-label">Install</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/kernel/" data-taxonomy-term="kernel"><span class="taxonomy-label">Kernel</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/metrics/" data-taxonomy-term="metrics"><span class="taxonomy-label">Metrics</span><span class="taxonomy-count">8</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/module/" data-taxonomy-term="module"><span class="taxonomy-label">Module</span><span class="taxonomy-count">16</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/monitor/" data-taxonomy-term="monitor"><span class="taxonomy-label">Monitor</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/overview/" data-taxonomy-term="overview"><span class="taxonomy-label">Overview</span><span class="taxonomy-count">20</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/param/" data-taxonomy-term="param"><span class="taxonomy-label">Param</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/playbook/" data-taxonomy-term="playbook"><span class="taxonomy-label">Playbook</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/postgresql/" data-taxonomy-term="postgresql"><span class="taxonomy-label">PostgreSQL</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/price/" data-taxonomy-term="price"><span class="taxonomy-label">Price</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/reference/" data-taxonomy-term="reference"><span class="taxonomy-label">Reference</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/release/" data-taxonomy-term="release"><span class="taxonomy-label">Release</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/section/" data-taxonomy-term="section"><span class="taxonomy-label">Section</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/setup/" data-taxonomy-term="setup"><span class="taxonomy-label">Setup</span><span class="taxonomy-count">14</span></a></li>
        <li><a class="taxonomy-term" href="/zh/categories/usage/" data-taxonomy-term="usage"><span class="taxonomy-label">Usage</span><span class="taxonomy-count">2</span></a></li>
        </ul>
    </div>
  <div class="taxonomy taxonomy-terms-cloud taxo-tags">
      <h5 class="taxonomy-title">Tags</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="/zh/tags/1-node/" data-taxonomy-term="1-node"><span class="taxonomy-label">1-Node</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/2-node/" data-taxonomy-term="2-node"><span class="taxonomy-label">2-Node</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/3-node/" data-taxonomy-term="3-node"><span class="taxonomy-label">3-Node</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/4-node/" data-taxonomy-term="4-node"><span class="taxonomy-label">4-Node</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/5-node/" data-taxonomy-term="5-node"><span class="taxonomy-label">5-Node</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/access/" data-taxonomy-term="access"><span class="taxonomy-label">Access</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/admin/" data-taxonomy-term="admin"><span class="taxonomy-label">Admin</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/auth/" data-taxonomy-term="auth"><span class="taxonomy-label">Auth</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/aws/" data-taxonomy-term="aws"><span class="taxonomy-label">AWS</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/cdc/" data-taxonomy-term="cdc"><span class="taxonomy-label">CDC</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/cdn/" data-taxonomy-term="cdn"><span class="taxonomy-label">CDN</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/citus/" data-taxonomy-term="citus"><span class="taxonomy-label">Citus</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/cloudberry/" data-taxonomy-term="cloudberry"><span class="taxonomy-label">Cloudberry</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/cloudflare/" data-taxonomy-term="cloudflare"><span class="taxonomy-label">Cloudflare</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/cost/" data-taxonomy-term="cost"><span class="taxonomy-label">Cost</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/database/" data-taxonomy-term="database"><span class="taxonomy-label">Database</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/dba/" data-taxonomy-term="dba"><span class="taxonomy-label">DBA</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/dhh/" data-taxonomy-term="dhh"><span class="taxonomy-label">DHH</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/docker/" data-taxonomy-term="docker"><span class="taxonomy-label">Docker</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/ebs/" data-taxonomy-term="ebs"><span class="taxonomy-label">EBS</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/ecs/" data-taxonomy-term="ecs"><span class="taxonomy-label">ECS</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/extension/" data-taxonomy-term="extension"><span class="taxonomy-label">Extension</span><span class="taxonomy-count">24</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/failure/" data-taxonomy-term="failure"><span class="taxonomy-label">Failure</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/finops/" data-taxonomy-term="finops"><span class="taxonomy-label">FinOps</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/gin/" data-taxonomy-term="gin"><span class="taxonomy-label">GIN</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/gis/" data-taxonomy-term="gis"><span class="taxonomy-label">GIS</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/go/" data-taxonomy-term="go"><span class="taxonomy-label">Go</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/greenplum/" data-taxonomy-term="greenplum"><span class="taxonomy-label">Greenplum</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/hba/" data-taxonomy-term="hba"><span class="taxonomy-label">HBA</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/kernel/" data-taxonomy-term="kernel"><span class="taxonomy-label">Kernel</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/knn/" data-taxonomy-term="knn"><span class="taxonomy-label">KNN</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/kubernetes/" data-taxonomy-term="kubernetes"><span class="taxonomy-label">Kubernetes</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/linux/" data-taxonomy-term="linux"><span class="taxonomy-label">Linux</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/migration/" data-taxonomy-term="migration"><span class="taxonomy-label">Migration</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/mongodb/" data-taxonomy-term="mongodb"><span class="taxonomy-label">MongoDB</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/mssql/" data-taxonomy-term="mssql"><span class="taxonomy-label">MSSQL</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/mysql/" data-taxonomy-term="mysql"><span class="taxonomy-label">MySQL</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/neon/" data-taxonomy-term="neon"><span class="taxonomy-label">Neon</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/offline/" data-taxonomy-term="offline"><span class="taxonomy-label">Offline</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/oracle/" data-taxonomy-term="oracle"><span class="taxonomy-label">Oracle</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/os/" data-taxonomy-term="os"><span class="taxonomy-label">OS</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/pg%E5%86%85%E6%A0%B8/" data-taxonomy-term="pg%E5%86%85%E6%A0%B8"><span class="taxonomy-label">PG内核</span><span class="taxonomy-count">14</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/pg%E5%BC%80%E5%8F%91/" data-taxonomy-term="pg%E5%BC%80%E5%8F%91"><span class="taxonomy-label">PG开发</span><span class="taxonomy-count">20</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/pg%E7%94%9F%E6%80%81/" data-taxonomy-term="pg%E7%94%9F%E6%80%81"><span class="taxonomy-label">PG生态</span><span class="taxonomy-count">18</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/pg%E7%AE%A1%E7%90%86/" data-taxonomy-term="pg%E7%AE%A1%E7%90%86"><span class="taxonomy-label">PG管理</span><span class="taxonomy-count">40</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/pigsty/" data-taxonomy-term="pigsty"><span class="taxonomy-label">Pigsty</span><span class="taxonomy-count">24</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/pigstyapp/" data-taxonomy-term="pigstyapp"><span class="taxonomy-label">PigstyApp</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/pitr/" data-taxonomy-term="pitr"><span class="taxonomy-label">PITR</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/polardb/" data-taxonomy-term="polardb"><span class="taxonomy-label">PolarDB</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/postgresql/" data-taxonomy-term="postgresql"><span class="taxonomy-label">PostgreSQL</span><span class="taxonomy-count">102</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/provision/" data-taxonomy-term="provision"><span class="taxonomy-label">Provision</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/rds/" data-taxonomy-term="rds"><span class="taxonomy-label">RDS</span><span class="taxonomy-count">8</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/redis/" data-taxonomy-term="redis"><span class="taxonomy-label">Redis</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/release/" data-taxonomy-term="release"><span class="taxonomy-label">Release</span><span class="taxonomy-count">23</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/rpm/" data-taxonomy-term="rpm"><span class="taxonomy-label">RPM</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/s3/" data-taxonomy-term="s3"><span class="taxonomy-label">S3</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/security/" data-taxonomy-term="security"><span class="taxonomy-label">Security</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/service/" data-taxonomy-term="service"><span class="taxonomy-label">Service</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/sla/" data-taxonomy-term="sla"><span class="taxonomy-label">SLA</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/slim/" data-taxonomy-term="slim"><span class="taxonomy-label">Slim</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/sop/" data-taxonomy-term="sop"><span class="taxonomy-label">SOP</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/sponsor/" data-taxonomy-term="sponsor"><span class="taxonomy-label">Sponsor</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/sql/" data-taxonomy-term="sql"><span class="taxonomy-label">SQL</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/user/" data-taxonomy-term="user"><span class="taxonomy-label">User</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/visualization/" data-taxonomy-term="visualization"><span class="taxonomy-label">Visualization</span><span class="taxonomy-count">8</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/wal/" data-taxonomy-term="wal"><span class="taxonomy-label">WAL</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E4%B8%8B%E4%BA%91/" data-taxonomy-term="%E4%B8%8B%E4%BA%91"><span class="taxonomy-label">下云</span><span class="taxonomy-count">34</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E4%BA%91%E6%95%85%E9%9A%9C/" data-taxonomy-term="%E4%BA%91%E6%95%85%E9%9A%9C"><span class="taxonomy-label">云故障</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" data-taxonomy-term="%E4%BA%91%E8%AE%A1%E7%AE%97"><span class="taxonomy-label">云计算</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2/" data-taxonomy-term="%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2"><span class="taxonomy-label">全文检索</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%87%BD%E6%95%B0/" data-taxonomy-term="%E5%87%BD%E6%95%B0"><span class="taxonomy-label">函数</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" data-taxonomy-term="%E5%88%86%E5%B8%83%E5%BC%8F"><span class="taxonomy-label">分布式</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%90%91%E9%87%8F/" data-taxonomy-term="%E5%90%91%E9%87%8F"><span class="taxonomy-label">向量</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" data-taxonomy-term="%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="taxonomy-label">向量数据库</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%95%86%E4%B8%9A/" data-taxonomy-term="%E5%95%86%E4%B8%9A"><span class="taxonomy-label">商业</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%9B%BD%E4%BA%A7%E6%95%B0%E6%8D%AE%E5%BA%93/" data-taxonomy-term="%E5%9B%BD%E4%BA%A7%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="taxonomy-label">国产数据库</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%A4%87%E4%BB%BD/" data-taxonomy-term="%E5%A4%87%E4%BB%BD"><span class="taxonomy-label">备份</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%B7%A5%E5%85%B7/" data-taxonomy-term="%E5%B7%A5%E5%85%B7"><span class="taxonomy-label">工具</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E5%BC%80%E6%BA%90/" data-taxonomy-term="%E5%BC%80%E6%BA%90"><span class="taxonomy-label">开源</span><span class="taxonomy-count">7</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%80%A7%E8%83%BD/" data-taxonomy-term="%E6%80%A7%E8%83%BD"><span class="taxonomy-label">性能</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%89%A9%E5%B1%95/" data-taxonomy-term="%E6%89%A9%E5%B1%95"><span class="taxonomy-label">扩展</span><span class="taxonomy-count">13</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%8C%87%E6%A0%87/" data-taxonomy-term="%E6%8C%87%E6%A0%87"><span class="taxonomy-label">指标</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/" data-taxonomy-term="%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F"><span class="taxonomy-label">推荐系统</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" data-taxonomy-term="%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="taxonomy-label">操作系统</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%95%85%E9%9A%9C/" data-taxonomy-term="%E6%95%85%E9%9A%9C"><span class="taxonomy-label">故障</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%95%85%E9%9A%9C%E6%A1%A3%E6%A1%88/" data-taxonomy-term="%E6%95%85%E9%9A%9C%E6%A1%A3%E6%A1%88"><span class="taxonomy-label">故障档案</span><span class="taxonomy-count">8</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" data-taxonomy-term="%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="taxonomy-label">数据库</span><span class="taxonomy-count">32</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%95%B0%E6%8D%AE%E6%8D%9F%E5%9D%8F/" data-taxonomy-term="%E6%95%B0%E6%8D%AE%E6%8D%9F%E5%9D%8F"><span class="taxonomy-label">数据损坏</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%97%A5%E5%BF%97/" data-taxonomy-term="%E6%97%A5%E5%BF%97"><span class="taxonomy-label">日志</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%9E%B6%E6%9E%84/" data-taxonomy-term="%E6%9E%B6%E6%9E%84"><span class="taxonomy-label">架构</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E6%BC%8F%E6%B4%9E/" data-taxonomy-term="%E6%BC%8F%E6%B4%9E"><span class="taxonomy-label">漏洞</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E7%9B%91%E6%8E%A7/" data-taxonomy-term="%E7%9B%91%E6%8E%A7"><span class="taxonomy-label">监控</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E7%A1%AC%E4%BB%B6/" data-taxonomy-term="%E7%A1%AC%E4%BB%B6"><span class="taxonomy-label">硬件</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E7%BC%96%E7%A0%81/" data-taxonomy-term="%E7%BC%96%E7%A0%81"><span class="taxonomy-label">编码</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/" data-taxonomy-term="%E8%85%BE%E8%AE%AF%E4%BA%91"><span class="taxonomy-label">腾讯云</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E8%A7%84%E7%BA%A6/" data-taxonomy-term="%E8%A7%84%E7%BA%A6"><span class="taxonomy-label">规约</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E8%A7%A6%E5%8F%91%E5%99%A8/" data-taxonomy-term="%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="taxonomy-label">触发器</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E8%BF%81%E7%A7%BB/" data-taxonomy-term="%E8%BF%81%E7%A7%BB"><span class="taxonomy-label">迁移</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E8%BF%9E%E6%8E%A5%E6%B1%A0/" data-taxonomy-term="%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="taxonomy-label">连接池</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E9%94%81/" data-taxonomy-term="%E9%94%81"><span class="taxonomy-label">锁</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="/zh/tags/%E9%98%BF%E9%87%8C%E4%BA%91/" data-taxonomy-term="%E9%98%BF%E9%87%8C%E4%BA%91"><span class="taxonomy-label">阿里云</span><span class="taxonomy-count">7</span></a></li>
        </ul>
    </div>
  
	
          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/zh/docs/">文档</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    版本发布历史</li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>版本发布历史</h1>
	<div class="lead">Pigsty 历史版本发行注记</div>
	<header class="article-meta">
		<div class="taxonomy taxonomy-terms-article taxo-module">
  <h5 class="taxonomy-title">Module:</h5>
  <ul class="taxonomy-terms">
    <li><a class="taxonomy-term" href="/zh/module/pigsty/" data-taxonomy-term="pigsty"><span class="taxonomy-label">PIGSTY</span></a></li>
    </ul>
</div>
<div class="taxonomy taxonomy-terms-article taxo-categories">
  <h5 class="taxonomy-title">Categories:</h5>
  <ul class="taxonomy-terms">
    <li><a class="taxonomy-term" href="/zh/categories/release/" data-taxonomy-term="release"><span class="taxonomy-label">Release</span></a></li>
    </ul>
</div>

  </header>
	<table>
<thead>
<tr>
<th style="text-align:left">版本</th>
<th style="text-align:center">发布时间</th>
<th>摘要</th>
<th>地址</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v320">v3.2.0</a></td>
<td style="text-align:center">2024-12-24</td>
<td>扩展管理 CLI ，Grafana 强化，ARM64 扩展补完</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v3.2.0">v3.2.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v310">v3.1.0</a></td>
<td style="text-align:center">2024-11-24</td>
<td>PG 17 升默认大版本，配置简化，Ubuntu24与ARM 支持，Supabase，MinIO 改进</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v3.1.0">v3.1.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v304">v3.0.4</a></td>
<td style="text-align:center">2024-10-30</td>
<td>PG 17 扩展，OLAP 全家桶，pg_duckdb</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v3.0.4">v3.0.4</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v303">v3.0.3</a></td>
<td style="text-align:center">2024-09-27</td>
<td>PostgreSQL 17，Etcd 运维优化，IvorySQL 3.4，PostGIS 3.5</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v3.0.3">v3.0.3</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v302">v3.0.2</a></td>
<td style="text-align:center">2024-09-07</td>
<td>精简安装模式，PolarDB 15支持，监控视图更新</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v3.0.2">v3.0.2</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v301">v3.0.1</a></td>
<td style="text-align:center">2024-08-31</td>
<td>例行问题修复，Patroni 4支持，Oracle兼容性改进</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v3.0.1">v3.0.1</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v300">v3.0.0</a></td>
<td style="text-align:center">2024-08-25</td>
<td>333个扩展插件，可插拔内核，MSSQL，Oracle，PolarDB 兼容性</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v3.0.0">v3.0.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v270">v2.7.0</a></td>
<td style="text-align:center">2024-05-20</td>
<td>扩展大爆炸，新增20+强力扩展插件，与多款Docker应用</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.7.0">v2.7.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v260">v2.6.0</a></td>
<td style="text-align:center">2024-02-28</td>
<td>PG 16 作为默认大版本，引入 ParadeDB 与 DuckDB 等扩展</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.6.0">v2.6.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v251">v2.5.1</a></td>
<td style="text-align:center">2023-12-01</td>
<td>例行小版本更新，PG16重要扩展支持</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.5.1">v2.5.1</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v250">v2.5.0</a></td>
<td style="text-align:center">2023-09-24</td>
<td>Ubuntu/Debian支持：bullseye, bookworm, jammy, focal</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.5.0">v2.5.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v241">v2.4.1</a></td>
<td style="text-align:center">2023-09-24</td>
<td>Supabase/PostgresML支持与各种新扩展：graphql, jwt, pg_net, vault</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.4.1">v2.4.1</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v240">v2.4.0</a></td>
<td style="text-align:center">2023-09-14</td>
<td>PG16，监控RDS，服务咨询支持，新扩展：中文分词全文检索/图/HTTP/嵌入等</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.4.0">v2.4.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v231">v2.3.1</a></td>
<td style="text-align:center">2023-09-01</td>
<td>带HNSW的PGVector，PG 16 RC1, 文档翻新，中文文档，例行问题修复</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.3.1">v2.3.1</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v230">v2.3.0</a></td>
<td style="text-align:center">2023-08-20</td>
<td>主机VIP, ferretdb, nocodb, MySQL存根, CVE修复</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.3.0">v2.3.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v220">v2.2.0</a></td>
<td style="text-align:center">2023-08-04</td>
<td>仪表盘 &amp; 置备重做，UOS 兼容性</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.2.0">v2.2.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v210">v2.1.0</a></td>
<td style="text-align:center">2023-06-10</td>
<td>支持 PostgreSQL 12 ~ 16beta</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.1.0">v2.1.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v202">v2.0.2</a></td>
<td style="text-align:center">2023-03-31</td>
<td>新增 pgvector 支持，修复 MinIO CVE</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.2">v2.0.2</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v201">v2.0.1</a></td>
<td style="text-align:center">2023-03-21</td>
<td>v2 错误修复，安全增强，升级 Grafana 版本</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.1">v2.0.1</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v200">v2.0.0</a></td>
<td style="text-align:center">2023-02-28</td>
<td>架构大升级，兼容性、安全性、可维护性显著增强</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.0">v2.0.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v151">v1.5.1</a></td>
<td style="text-align:center">2022-06-18</td>
<td>Grafana 安全性修复</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v1.5.1">v1.5.1</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v150">v1.5.0</a></td>
<td style="text-align:center">2022-05-31</td>
<td>Docker 应用程序支持</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v1.5.0">v1.5.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v141">v1.4.1</a></td>
<td style="text-align:center">2022-04-20</td>
<td>错误修复 &amp; 英文文档完整翻译</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v1.4.1">v1.4.1</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v140">v1.4.0</a></td>
<td style="text-align:center">2022-03-31</td>
<td>MatrixDB 支持，分离 INFRA/NODES/PGSQL/REDIS模块</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v1.4.0">v1.4.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v130">v1.3.0</a></td>
<td style="text-align:center">2021-11-30</td>
<td>PGCAT 重整 &amp; PGSQL 增强 &amp; Redis Beta支持</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v1.3.0">v1.3.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v120">v1.2.0</a></td>
<td style="text-align:center">2021-11-03</td>
<td>默认 PGSQL 版本升级至 14</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v1.2.0">v1.2.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v110">v1.1.0</a></td>
<td style="text-align:center">2021-10-12</td>
<td>主页, JupyterLab, PGWEB, Pev2 &amp; pgbadger</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v1.1.0">v1.1.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v100">v1.0.0</a></td>
<td style="text-align:center">2021-07-26</td>
<td>v1 正式版, 监控系统重整</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v1.0.0">v1.0.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v090">v0.9.0</a></td>
<td style="text-align:center">2021-04-04</td>
<td>Pigsty 图形界面, 命令行界面, 日志集成</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v0.9.0">v0.9.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v080">v0.8.0</a></td>
<td style="text-align:center">2021-03-28</td>
<td>服务置备，定制对外暴露的数据库服务</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v0.8.0">v0.8.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v070">v0.7.0</a></td>
<td style="text-align:center">2021-03-01</td>
<td>仅监控部署，监控现有 PostgreSQL 实例</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v0.7.0">v0.7.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v060">v0.6.0</a></td>
<td style="text-align:center">2021-02-19</td>
<td>架构增强，将PG与Consul解耦</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v0.6.0">v0.6.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v050">v0.5.0</a></td>
<td style="text-align:center">2021-01-07</td>
<td>支持在配置中定义业务数据库/用户</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v0.5.0">v0.5.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v040">v0.4.0</a></td>
<td style="text-align:center">2020-12-14</td>
<td>支持 PostgreSQL 13，添加官方文档</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v0.4.0">v0.4.0</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="/zh/docs/releasenote/#v030">v0.3.0</a></td>
<td style="text-align:center">2020-10-22</td>
<td>虚拟机置备方案正式定稿</td>
<td><a href="https://github.com/Vonng/pigsty/releases/tag/v0.3.0">v0.3.0</a></td>
</tr>
<tr>
<td style="text-align:left">v0.2.0</td>
<td style="text-align:center">2020-07-10</td>
<td>PG监控系统第六版正式发布</td>
<td><a href="https://github.com/Vonng/pigsty/commit/385e33a62a19817e8ba19997260e6b77d99fe2ba">v0.2.0</a></td>
</tr>
<tr>
<td style="text-align:left">v0.1.0</td>
<td style="text-align:center">2020-06-20</td>
<td>在生产仿真测试环境中验证通过</td>
<td><a href="https://github.com/Vonng/pigsty/commit/1cf2ea5ee91db071de00ec805032928ff582453b">v0.1.0</a></td>
</tr>
<tr>
<td style="text-align:left">v0.0.5</td>
<td style="text-align:center">2020-08-19</td>
<td>离线安装模式：无需互联网访问即可交付</td>
<td><a href="https://github.com/Vonng/pigsty/commit/0fe9e829b298fe5e56307de3f78c95071de28245">v0.0.5</a></td>
</tr>
<tr>
<td style="text-align:left">v0.0.4</td>
<td style="text-align:center">2020-07-27</td>
<td>将 Ansible 剧本重构为 Role Refactor playbooks into ansible roles</td>
<td><a href="https://github.com/Vonng/pigsty/commit/90b44259818d2c71e37df5250fe8ed1078a883d0">v0.0.4</a></td>
</tr>
<tr>
<td style="text-align:left">v0.0.3</td>
<td style="text-align:center">2020-06-22</td>
<td>接口设计改进</td>
<td><a href="https://github.com/Vonng/pigsty/commit/4c5c68ccd57bc32a9e9c98aa3f264aa19f45c7ee">v0.0.3</a></td>
</tr>
<tr>
<td style="text-align:left">v0.0.2</td>
<td style="text-align:center">2020-04-30</td>
<td>首次提交</td>
<td><a href="https://github.com/Vonng/pigsty/commit/dd646775624ddb33aef7884f4f030682bdc371f8">v0.0.2</a></td>
</tr>
<tr>
<td style="text-align:left">v0.0.1</td>
<td style="text-align:center">2019-05-15</td>
<td>概念原型</td>
<td><a href="https://github.com/Vonng/pg/commit/fa2ade31f8e81093eeba9d966c20120054f0646b">v0.0.1</a></td>
</tr>
</tbody>
</table>
<hr>
<h2 id="v320">v3.2.0</h2>
<p><strong>亮点特性</strong></p>
<ul>
<li>Pigsty 命令行工具：<a href="https://github.com/pgsty/pig"><code>pig</code></a>，可用于管理扩展插件。</li>
<li>提供五大发行版上 <a href="https://ext.pigsty.io/">340 个扩展</a> 的 ARM64 扩展支持</li>
<li>Supabase 发布周最新版本更新，全发行版均可自建。</li>
<li>Grafana 更新至 11.4 ，新增 infinity 数据源。</li>
</ul>
<p><strong>软件包变化</strong></p>
<ul>
<li>
<p><strong>新增扩展</strong></p>
<ul>
<li>新增 timescaledb, timescaledb-loader timescaledb-toolkit timescaledb-tool to PIGSTY repo</li>
<li>新增 <a href="https://github.com/timescale/timescaledb">pg_timescaledb</a>，针对 EL 进行的编译重制版本</li>
<li>新增 <a href="https://ext.pigsty.io/#/pgroonga">pgroonga</a>，针对 EL 全系进行编译重制</li>
<li>新增 <a href="https://github.com/tensorchord/VectorChord">vchord</a> 0.1.0</li>
<li>新增 <a href="https://github.com/tensorchord/pg_bestmatch.rs">pg_bestmatch.rs</a> 0.0.1</li>
<li>新增 <a href="https://github.com/frectonz/pglite-fusion">pglite_fusion</a> 0.0.3</li>
<li>新增 <a href="https://github.com/Florents-Tselai/pgpdf">pgpdf</a> 0.1.0</li>
</ul>
</li>
<li>
<p><strong>更新扩展</strong></p>
<ul>
<li>pgvectorscale 0.4.0 -&gt; 0.5.1</li>
<li>pg_parquet 0.1.0 -&gt; 0.1.1</li>
<li>pg_polyline 0.0.1</li>
<li>pg_cardano 1.0.2 -&gt; 1.0.3</li>
<li>pg_vectorize 0.20.0</li>
<li>pg_duckdb 0.1.0 -&gt; 0.2.0</li>
<li>pg_search 0.13.0 -&gt; 0.13.1</li>
<li>aggs_for_vecs 1.3.1 -&gt; 1.3.2</li>
<li><code>pgoutput</code> 被标记为新的 PostgreSQL Contrib 扩展</li>
</ul>
</li>
<li>
<p><strong>基础设施</strong></p>
<ul>
<li>新增 promscale 0.17.0</li>
<li>新增 grafana-plugins 11.4</li>
<li>新增 grafana-infinity-plugins</li>
<li>新增 grafana-victoriametrics-ds</li>
<li>新增 grafana-victorialogs-ds</li>
<li>vip-manager 2.8.0 -&gt; 3.0.0</li>
<li>vector 0.42.0 -&gt; 0.43.0</li>
<li>grafana 11.3 -&gt; 11.4</li>
<li>prometheus 3.0.0 -&gt; 3.0.1 (软件包名从 <code>prometheus2</code> 变更为 <code>prometheus</code>)</li>
<li>nginx_exporter 1.3.0 -&gt; 1.4.0</li>
<li>mongodb_exporter 0.41.2 -&gt; 0.43.0</li>
<li>VictoriaMetrics 1.106.1 -&gt; 1.107.0</li>
<li>VictoriaLogs 1.0.0 -&gt; 1.3.2</li>
<li>pg_timetable 5.9.0 -&gt; 5.10.0</li>
<li>tigerbeetle 0.16.13 -&gt; 0.16.17</li>
<li>pg_export 0.7.0 -&gt; 0.7.1</li>
</ul>
</li>
<li>
<p><strong>缺陷修复</strong></p>
<ul>
<li>el8.aarch64 添加 python3-cdiff 修复 patroni 依赖错漏问题</li>
<li>el9.aarch64 添加 timescaledb-tools ，修复官方仓库缺失问题</li>
<li>el9.aarch64 添加 pg_filedump ，修复官方仓库缺失问题</li>
</ul>
</li>
<li>
<p><strong>移除扩展</strong></p>
<ul>
<li><strong>pg_mooncake</strong> 因为与 <code>pg_duckdb</code> 冲突而被移除。</li>
<li><strong>pg_top</strong> 因为出现太多版本出现缺失，因质量问题而淘汰。</li>
<li><strong>hunspell_pt_pt</strong> 因为与 PG 官方字典文件冲突而被淘汰。</li>
<li><strong>pg_timeit</strong> 因为无法在 AARCH64 架构上使用而被淘汰。</li>
<li><strong>pgdd</strong> 因为缺乏维护，PG 17 与 pgrx 版本老旧而被标记为弃用。</li>
<li><strong>old_snapshot</strong> 与 <strong>adminpack</strong> 被标记为 PG 17 不可用。</li>
<li><strong>pgml</strong> 被设置为默认不下载不安装。</li>
</ul>
</li>
</ul>
<p><strong>API变化</strong></p>
<ul>
<li><a href="https://pigsty.cc/zh/docs/reference/param/#repo_url_packages"><code>repo_url_packages</code></a> 参数现在默认值为空数组，因为所有软件包现在都通过操作系统包管理器进行安装。</li>
<li><code>grafana_plugin_cache</code> 参数弃用，现在 Grafana 插件通过操作系统包管理器进行安装</li>
<li><code>grafana_plugin_list</code> 参数弃用，现在 Grafana 插件通过操作系统包管理器进行安装</li>
<li>原名为 <code>prod</code> 的 36 节点仿真模板现在重命名为 <code>simu</code>。</li>
<li>原本在 <code>node_id/vars</code> 针对每个发行版代码生成的配置，现在同样针对 <code>aarch64</code> 生成。</li>
<li><code>infra_packages</code> 中默认添加命令行管理工具 <code>pig</code></li>
<li><code>configure</code> 命令同样会修改自动生成配置文件中 <code>pgsql-xxx</code> 别名的版本号。</li>
<li><code>adminpack</code> 在 PG 17 中被移除，因此从 Pigsty 默认扩展中被移除。</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>修复了 <code>pgbouncer</code> 仪表盘选择器问题 <a href="https://github.com/Vonng/pigsty/issues/474">#474</a></li>
<li><code>pg-pitr</code> 新增 <code>--arg value</code> 参数解析支持 by <a href="https://github.com/Vonng/pigsty/pulls?q=is%3Apr+author%3Awaitingsong">@waitingsong</a></li>
<li>修复 Redis 日志信息 typo by <a href="https://github.com/Vonng/pigsty/pull/476">@waitingsong</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>6351b5c378b149fe4b82d1e93bb1fa7e  pigsty-v3.2.0.tgz
</span></span></code></pre></div><hr>
<h2 id="v310">v3.1.0</h2>
<p><strong>亮点特性</strong></p>
<ul>
<li>PostgreSQL 17 现已成为默认使用的主要版本 (17.2)</li>
<li>Ubuntu 24.04 系统支持</li>
<li>arm 架构支持：EL9, Debian12, Ubuntu 22.04</li>
<li>Supabase 一键自建，新的剧本 <code>supabase.yml</code></li>
<li>MinIO 最佳实践改进，配置模板与 Vagrant 模板</li>
<li>提供了一系列开箱即用的配置模板与文档说明。</li>
<li>允许在 <code>configure</code> 过程中使用 <code>-v|--version</code> 指定使用的 PG 大版本。</li>
<li>调整 PG 默认插件策略：默认安装 <code>pg_repack</code>, <code>wal2json</code> 以及 <code>pgvector</code> 三个关键扩展。</li>
<li>大幅简化 <code>repo_packages</code> 本地软件源构建逻辑，允许在 <code>repo_packages</code> 中使用软件包组别名</li>
<li>提供了 WiltonDB，IvorySQL，PolarDB 的软件源镜像，简化三者的安装。</li>
<li>默认启用数据库校验和。</li>
<li>修复 ETCD 与 MINIO 日志面板</li>
</ul>
<p><strong>软件升级</strong></p>
<ul>
<li>PostgreSQL 17.2, 16.6, 15.10, 14.15, 13.18, 12.22</li>
<li>PostgreSQL 扩展版本变动请参考：https://ext.pigsty.io</li>
<li>Patroni 4.0.4</li>
<li>MinIO 20241107 / MCLI 20241117</li>
<li>Rclone 1.68.2</li>
<li>Prometheus: 2.54.0 -&gt; 3.0.0</li>
<li>VictoriaMetrics 1.102.1 -&gt; 1.106.1</li>
<li>VictoriaLogs v0.28.0 -&gt; 1.0.0</li>
<li>vslogcli 1.0.0</li>
<li>MySQL Exporter 0.15.1 -&gt; 0.16.0</li>
<li>Redis Exporter 1.62.0 -&gt; 1.66.0</li>
<li>MongoDB Exporter 0.41.2 -&gt; 0.42.0</li>
<li>Keepalived Exporter 1.3.3 -&gt; 1.4.0</li>
<li>DuckDB 1.1.2 -&gt; 1.1.3</li>
<li>etcd 3.5.16 -&gt; 3.5.17</li>
<li>tigerbeetle 16.8 -&gt; 0.16.13</li>
</ul>
<p><strong>API变更</strong></p>
<ul>
<li><code>repo_upstream</code>: 针对每个具体的操作系统发行版生成默认值：<a href="https://github.com/Vonng/pigsty/tree/main/roles/node_id/vars"><code>roles/node_id/vars</code></a></li>
<li><code>repo_packages</code>: 允许使用 <code>package_map</code> 中定义的别名。</li>
<li><code>repo_extra_packages</code>: 新增未指定时的默认值，允许使用 <code>package_map</code> 中定义的别名。</li>
<li><code>pg_checksum</code>: 默认值修改为 <code>true</code>，默认打开。</li>
<li><code>pg_packages</code>: 默认值修改为：<code>postgresql, wal2json pg_repack pgvector, patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager</code></li>
<li><code>pg_extensions</code>: 默认值修改为空数组 <code>[]</code>。</li>
<li><code>infra_portal</code>: 允许为 <code>home</code> 服务器指定 <code>path</code>，替代默认的本地仓库路径 <code>nginx_home</code> (<code>/www</code>)</li>
</ul>
<p><strong>校验和</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>e62f9ce9f89a58958609da7b234bf2f2  pigsty-v3.1.0.tgz
</span></span></code></pre></div><hr>
<h2 id="v304">v3.0.4</h2>
<p><strong>特性</strong></p>
<ul>
<li>针对 PostgreSQL 17 编译了所有支持的 Pigsty 扩展插件</li>
<li>提供了全新的 OLAP 扩展支持：<code>pg_duckdb</code> 与 <code>pg_parquet</code></li>
<li>简化并优化了最新版本 Supabase 自建的流程</li>
<li>新增参数 <code>docker_image</code>，允许在 Docker 安装后自动拉取镜像。</li>
</ul>
<p><strong>扩展</strong></p>
<p>欢迎查阅我们最新的 PostgreSQL 扩展目录： <a href="https://ext.pigsty.io">https://ext.pigsty.io</a></p>
<table>
<thead>
<tr>
<th style="text-align:center">统计项</th>
<th style="text-align:center">总计</th>
<th style="text-align:center">PGDG</th>
<th style="text-align:center">PIGSTY</th>
<th style="text-align:center">MISC</th>
<th style="text-align:center">MISS</th>
<th style="text-align:center">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">EL系统扩展</td>
<td style="text-align:center">338</td>
<td style="text-align:center">134</td>
<td style="text-align:center">130</td>
<td style="text-align:center">4</td>
<td style="text-align:center">7</td>
<td style="text-align:center">298</td>
<td style="text-align:center">334</td>
<td style="text-align:center">336</td>
<td style="text-align:center">328</td>
<td style="text-align:center">319</td>
<td style="text-align:center">310</td>
</tr>
<tr>
<td style="text-align:center">Deb系统扩展</td>
<td style="text-align:center">326</td>
<td style="text-align:center">109</td>
<td style="text-align:center">143</td>
<td style="text-align:center">74</td>
<td style="text-align:center">19</td>
<td style="text-align:center">290</td>
<td style="text-align:center">322</td>
<td style="text-align:center">324</td>
<td style="text-align:center">316</td>
<td style="text-align:center">307</td>
<td style="text-align:center">300</td>
</tr>
<tr>
<td style="text-align:center">RPM 软件包</td>
<td style="text-align:center">313</td>
<td style="text-align:center">122</td>
<td style="text-align:center">129</td>
<td style="text-align:center">4</td>
<td style="text-align:center">6</td>
<td style="text-align:center">275</td>
<td style="text-align:center">309</td>
<td style="text-align:center">311</td>
<td style="text-align:center">303</td>
<td style="text-align:center">294</td>
<td style="text-align:center">285</td>
</tr>
<tr>
<td style="text-align:center">DEB 软件包</td>
<td style="text-align:center">298</td>
<td style="text-align:center">93</td>
<td style="text-align:center">142</td>
<td style="text-align:center">64</td>
<td style="text-align:center">19</td>
<td style="text-align:center">264</td>
<td style="text-align:center">294</td>
<td style="text-align:center">296</td>
<td style="text-align:center">288</td>
<td style="text-align:center">279</td>
<td style="text-align:center">272</td>
</tr>
</tbody>
</table>
<p><strong>版本升级</strong></p>
<ul>
<li>
<p><strong>新的PGSQL扩展</strong></p>
<ul>
<li><a href="https://github.com/CrunchyData/pg_parquet/">pg_parquet</a></li>
<li><a href="https://github.com/davidgomes/pg-explain-ui">pg_explain_ui</a></li>
<li><a href="https://github.com/yihong0618/pg_polyline">pg_polyline</a></li>
<li><a href="https://github.com/Fell-x27/pg_cardano">pg_cardano</a></li>
<li><a href="https://github.com/Fell-x27/pg_base58">pg_base58</a></li>
<li><a href="https://github.com/HexaCluster/pg_summarize">pg_summarize</a></li>
<li><a href="https://pgxn.org/dist/pg_relusage/0.0.1/">pg_relusage</a></li>
<li><a href="https://github.com/tembo-io/pgmq">pgmq</a></li>
<li><a href="https://github.com/tembo-io/pg_timeseries">pg_timeseries</a></li>
<li><a href="https://github.com/pgexperts/pg_plan_filter">pg_plan_filter</a></li>
</ul>
</li>
<li>
<p><strong>升级与跟进PG扩展</strong></p>
<ul>
<li>pg_search 0.11.0</li>
<li>pg_analytics 0.2.0</li>
<li>plv8 3.2.3</li>
<li>supautils 2.5.0</li>
<li>icu_ext 1.9.0</li>
<li>redis_fdw 17</li>
<li>pg_failover_slots 1.1.0</li>
<li>pg_later 0.1.3</li>
<li>plprql 1.0.0</li>
<li>pg_vectorize 0.18.3</li>
<li>unit 7.7 -&gt; 7.9</li>
<li>log_fdw 1.4</li>
<li>pg_duckdb 0.1.0</li>
<li>pg_graphql 1.5.9 (+17)</li>
<li>pg_jsonschema 0.3.2 (+17)</li>
<li>pgvectorscale 0.4.0 (+17)</li>
<li>wrappers 0.4.3 +pg17</li>
<li>pg_ivm 1.9</li>
<li>pg_timeseries 0.1.6</li>
<li>pgmq 1.4.4</li>
<li>pg_protobuf 16 17</li>
<li>pg_uuidv7 1.6</li>
<li>pg_readonly</li>
<li>pgddl 0.28</li>
<li>pg_safeupdate</li>
<li>pg_stat_monitor 2.1</li>
<li>pg_profile 4.7</li>
<li>system_stats 3.2</li>
<li>pg_auth_mon 3.0</li>
<li>login_hook 1.6</li>
<li>logerrors 2.1.3</li>
<li>pg-orphaned</li>
<li>pgnodemx 1.7</li>
<li>sslutils 1.4 (deb+pg16,17)</li>
<li>timestamp9 (deb)</li>
</ul>
</li>
<li>
<p><strong>修复不支持PG16/17的扩展</strong></p>
<ul>
<li>pg_mon</li>
<li>pg_uri</li>
<li>agg_for_vecs</li>
<li>quantile</li>
<li>lower_quantile</li>
<li>pg_protobuf</li>
<li>acl</li>
<li>pg_emailaddr</li>
<li>pg_zstd</li>
<li>smlar</li>
<li>geohash</li>
<li>pgsmcrypto (+17)</li>
<li>pg_tiktoken (+17)</li>
<li>pg_idkit (+17)</li>
</ul>
</li>
<li>
<p><strong>基础设施软件包</strong></p>
<ul>
<li>Grafana 11.3</li>
<li>duckdb 1.1.2</li>
<li>etcd 3.5.16</li>
<li>ferretdb 1.24.0</li>
<li>minio 20241013133411</li>
<li>mcli 2024101313411</li>
<li>pushgateway 1.10</li>
<li>tigerbeetle 0.16.8</li>
<li>mongodb_exporter 0.41.2</li>
<li>redis_exporter 1.64.1</li>
<li>vector 0.41.1</li>
<li>vip-manager 2.7</li>
<li>sealos 5.0.1</li>
</ul>
</li>
</ul>
<hr>
<h2 id="v303">v3.0.3</h2>
<p><strong>特性</strong></p>
<ul>
<li>提供对最新发布的 PostgreSQL 17 支持。</li>
<li>优化了 etcd 配置，监控，与告警规则</li>
<li>（Oracle兼容的）IvorySQL 3.4 支持，与 PostgreSQL 16.4 同步</li>
</ul>
<p><strong>版本升级</strong></p>
<ul>
<li>PostGIS 3.5</li>
<li>Grafana 11.2</li>
<li>duckdb 1.1</li>
<li>pg_search 0.10.2</li>
<li>pg_analytics 0.1.4</li>
</ul>
<hr>
<h2 id="v302">v3.0.2</h2>
<p><strong>特性</strong></p>
<ul>
<li><a href="https://pigsty.io/docs/setup/slim/">精简安装模式</a>：使用 <code>slim.yml</code> 进行最精简的 HA PGSQL 部署。</li>
<li><a href="https://github.com/ApsaraDB/PolarDB-for-PostgreSQL">PolarDB PG 15</a> 的原生支持。</li>
<li>优化 <code>monitor.pg_table_bloat</code> 与 <code>monitor.pg_index_bloat</code>，使用安全定义包装函数规避 PolarDB 统计视图权限问题。</li>
<li>在各模块的监控注册阶段，尊重 <code>prometheus_enabled</code> 与 <code>grafana_enabled</code> 配置选项，关闭时不再注册。</li>
<li>在 <code>/etc/profile.d/pgsql.sh</code> 中添加 <code>PGDATABASE</code> 与 <code>PGPORT</code> 环境变量，设置为 <code>pg_primary_db</code>（默认<code>postgres</code>）</li>
</ul>
<p><strong>变更</strong></p>
<ul>
<li>在 Pigsty PGSQL 仓库中移除 PolarDB 11 与 CloudberryDB 1.5.4 的 RPM/APT 包。</li>
<li>使用专用的仓库分发 PolarDB 15 与 CloudberryDB 1.6.0 的 RPM/APT 包。</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>修复 Redis 的 <code>/etc/tmp.files.d</code> 文件名错误。</li>
<li>在管理 pgbouncer 用户时，设置 <code>PGHOST</code> 与 <code>PGPORT</code> 环境变量。</li>
<li>临时移除 <code>pg_snakeoil</code> 扩展支持，因为 EL8 上游源 <code>clamv</code> 出现依赖缺失问题。</li>
<li>移除 <code>pgsql</code> 角色的 Notify / Handler，以兼容更老的 Ansible 2.9 版本。</li>
</ul>
<hr>
<h2 id="v301">v3.0.1</h2>
<p><strong>特性改进</strong></p>
<ul>
<li>PolarDB Oracle 兼容性模式支持（需要第三方商业闭源内核）</li>
<li>使用 Oracle 兼容的 SQL 语法改写监控视图与相关 SQL 语句</li>
<li>Patroni <a href="https://patroni.readthedocs.io/en/latest/releases.html">4</a> 支持与适配</li>
<li>新增扩展 <code>pg_analytics</code>，通过 duckdb 为 PG 加装分析能力</li>
<li>添加新扩展：<code>odbc_fdw</code> 与 <code>jdbc_fdw</code>，提供通用的外部数据源连接能力</li>
<li>仓库添加新内核 <code>cloudberrydb</code> (Greenplum 原班开发者的开源分支)</li>
<li>仓库添加新工具 <code>walminer</code>，从WAL（replica等级）中提取原始 SQL。（高级特性需自行购买License）</li>
<li>更新执行计划可视化工具 Pev2 版本至 1.12.1</li>
<li>新增Grafana插件：<code>volkovlabs-rss-datasource</code></li>
<li>在PGCAT databases监控面板中添加了已安装和待安装的扩展插件</li>
<li>PGSQL 主库初始化后，会重启一次以便 pg_param &amp; pg_files 生效，因此 Supabase PG / PolarDB 集群置备后无需重启。</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>修复了 Grafana 11.1.4 面板插件默认不加载的问题</li>
<li>修复了特定操作系统上 BlackBox Exporter Ping 探针失效的问题</li>
<li>确保 /var/run/postgresql 与 /var/run/redis 临时目录总是在重启后自动创建</li>
<li>修复了 <code>cache.yml</code> 剧本没有正确移除老旧的 patroni 3.0.4 RPM 包问题</li>
<li>修复了个别告警规则中的描述信息错误</li>
<li>移除了 Patroni 配置文件中过时的 Bootstrap User/HBA 参数</li>
</ul>
<hr>
<h2 id="v300">v3.0.0</h2>
<p><strong>亮点特性</strong></p>
<ul>
<li><strong>扩展大爆炸</strong>：</li>
</ul>
<p>Pigsty v3 提供了史无前例的 <a href="/zh/docs/pgext/list"><strong>333</strong></a> 个可用扩展插件。
包括 <strong>121</strong> 个扩展 <a href="/zh/docs/pgext/list/rpm/"><strong>RPM包</strong></a> 与 <strong>133</strong> 个 <a href="/zh/docs/pgext/list/deb/"><strong>DEB包</strong></a>，数量已经超过了 PGDG 官方仓库提供的扩展数量总和（135 RPM/ 109 DEB）。
而且，Pigsty 还将EL系统与Debian生态的独有PG扩展插件相互移植，实现了两大发行版的插件生态大对齐。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">timescaledb periods temporal_tables emaj table_version pg_cron pg_later pg_background pg_timetable</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">postgis pgrouting pointcloud pg_h3 q3c ogr_fdw geoip #pg_geohash</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#mobilitydb</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pgvector pgvectorscale pg_vectorize pg_similarity pg_tiktoken pgml</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#smlar</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_search pg_bigm zhparser hunspell</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">hydra pg_lakehouse pg_duckdb duckdb_fdw pg_fkpart pg_partman plproxy</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pg_strom citus</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_hint_plan age hll rum pg_graphql pg_jsonschema jsquery index_advisor hypopg imgsmlr pg_ivm pgmq pgq</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#rdkit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_tle plv8 pllua plprql pldebugger plpgsql_check plprofiler plsh</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pljava plr pgtap faker dbt2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">prefix semver pgunit md5hash asn1oid roaringbitmap pgfaceting pgsphere pg_country pg_currency pgmp numeral pg_rational pguint ip4r timestamp9 chkpass #pg_uri #pgemailaddr #acl #debversion</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pg_rrule</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">topn pg_gzip pg_http pg_net pg_html5_email_address pgsql_tweaks pg_extra_time pg_timeit count_distinct extra_window_functions first_last_agg tdigest aggs_for_arrays pg_arraymath pg_idkit pg_uuidv7 permuteseq pg_hashids</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">sequential_uuids pg_math pg_random pg_base36 pg_base62 floatvec pg_financial pgjwt pg_hashlib shacrypt cryptint pg_ecdsa pgpcre icu_ext envvar url_encode #pg_zstd #aggs_for_vecs #quantile #lower_quantile #pgqr</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pg_protobuf</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_repack pg_squeeze pg_dirtyread pgfincore pgdd ddlx pg_prioritize pg_checksums pg_readonly safeupdate pg_permissions pgautofailover pg_catcheck preprepare pgcozy pg_orphaned pg_crash pg_cheat_funcs pg_savior table_log pg_fio</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pgpool pgagent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_profile pg_show_plans pg_stat_kcache pg_stat_monitor pg_qualstats pg_store_plans pg_track_settings pg_wait_sampling system_stats pg_meta pgnodemx pg_sqlog bgw_replstatus pgmeminfo toastinfo pagevis powa pg_top #pg_statviz #pgexporter_ext</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pg_mon</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">passwordcheck supautils pgsodium pg_vault anonymizer pg_tde pgsmcrypto pgaudit pgauditlogtofile pg_auth_mon credcheck pgcryptokey pg_jobmon logerrors login_hook set_user pg_snakeoil pgextwlist pg_auditor noset</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#sslutils</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">wrappers multicorn mysql_fdw tds_fdw sqlite_fdw pgbouncer_fdw mongo_fdw redis_fdw pg_redis_pubsub kafka_fdw hdfs_fdw firebird_fdw aws_s3 log_fdw #oracle_fdw</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#db2_fdw</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">orafce pgtt session_variable pg_statement_rollback pg_dbms_metadata pg_dbms_lock pgmemcache #pg_dbms_job</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#wiltondb</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pglogical pgl_ddl_deploy pg_failover_slots wal2json wal2mongo decoderbufs decoder_raw mimeo pgcopydb pgloader pg_fact_loader pg_bulkload pg_comparator pgimportdoc pgexportdoc #repmgr</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#slony</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">gis-stack rag-stack fdw-stack fts-stack etl-stack feat-stack olap-stack supa-stack stat-stack json-stack</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><ul>
<li><strong>可插拔内核</strong>：</li>
</ul>
<p>Pigsty v3 允许您更换 PostgreSQL 内核，目前支持了 SQL Server 兼容的 Babelfish （线缆协议级仿真），Oracle 兼容的 IvorySQL，以及 PG 版的 RAC PolarDB；此外，现在自托管 Supabase 也在 Debian 系统中可用。
您可以让 Pigsty 中带有 HA，IaC，PITR，监控的生产级 PostgreSQL 集群仿真 MSSQL (via WiltonDB)，Oracle via (IvorySQL)，Oracle RAC (via PolarDB), MongoDB（via FerretDB），以及 Firebase （via Supabase）。</p>
<ul>
<li><strong>专业级服务</strong>：</li>
</ul>
<p>我们现在提供 Pigsty Pro <a href="/zh/docs/price"><strong>专业版</strong></a>，在开源版的功能基础上提供增值服务。专业版提供额外的功能模块：MSSQL，Oracle，Mongo，K8S，Victoria，Kafka，TigerBeetle 等……，并提供更广泛的 PG 大版本、操作系统、芯片架构的支持。
提供针对全系操作系统精准小版本定制的离线安装包，以及 EL7，Debian 11，Ubuntu 20.04 等过保老系统的支持；此外，专业版还提供内核可插拔定制服务，并对PolarDB PG 的原生部署、监控管控支持以满足“国产化”需要。</p>
<p>使用以下命令快速安装体验：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL https://repo.pigsty.cc/get <span style="color:#000;font-weight:bold">|</span> bash
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty<span style="color:#000;font-weight:bold">;</span> ./bootstrap<span style="color:#000;font-weight:bold">;</span> ./configure<span style="color:#000;font-weight:bold">;</span> ./install.yml
</span></span></code></pre></div><hr>
<p><strong>重大变更</strong></p>
<p>本次 Pigsty 发布调整大版本号，从 2.x 升级到 3.0，带有一些重大变更：</p>
<ul>
<li>
<p>首要支持操作系统调整为：EL 8 / EL 9 / Debian 12 / Ubuntu 22.04</p>
<ul>
<li>EL7 / Debian 11 / Ubuntu 20.04 等系统进入弃用阶段，不再提供支持</li>
<li>有在这些系统上运行需求的用户请考虑我们的 <a href="https://pigsty.io/zh/docs/about/service">订阅服务</a></li>
</ul>
</li>
<li>
<p>默认使用在线安装，不再提供离线软件包，从而解决操作系统小版本兼容性问题。</p>
<ul>
<li><code>bootstrap</code> 过程现在不再询问是否下载离线安装包，但如果 <code>/tmp/pkg.tgz</code> 存在，仍然会自动使用离线安装包。</li>
<li>有离线安装需求请自行制作离线软件包或考虑我们的 <a href="https://pigsty.io/zh/docs/about/service">订阅服务</a></li>
</ul>
</li>
<li>
<p>Pigsty 使用的上游软件仓库进行统一调整，地址变更，并对所有软件包进行 GPG 签名与校验</p>
<ul>
<li>标准仓库： <code>https://repo.pigsty.io/{apt/yum}</code></li>
<li>国内镜像： <code>https://repo.pigsty.cc/{apt/yum}</code></li>
</ul>
</li>
<li>
<p>API 参数变更与配置模板变更</p>
<ul>
<li>EL 系与 Debian 系配置模板现在收拢统一，有差异的参数统一放置于 <a href="https://github.com/Vonng/pigsty/tree/master/roles/node_id/vars"><code>roles/node_id/vars/</code></a> 目录进行管理。</li>
<li>配置目录变更，所有配置文件模板统一放置在 <code>conf</code> 目录下，并分为 <code>default</code>, <code>dbms</code>, <code>demo</code>, <code>build</code> 四大类。</li>
</ul>
</li>
</ul>
<hr>
<p><strong>其他新特性</strong></p>
<ul>
<li>PG OLAP 分析能力史诗级加强：DuckDB 1.0.0，DuckDB FDW，以及 PG Lakehouse，Hydra 移植至 Deb 系统中。</li>
<li>PG 向量检索与全文检索能力加强：Vectorscale 提供 DiskANN 向量索引，Hunspell 分词字典支持，pg_search 0.8.6。</li>
<li>帮助 ParadeDB 解决了软件包构建问题，现在我们在 Debian/Ubuntu 上也能提供这一扩展。</li>
<li>Supabase 所需的扩展在 Debian/Ubuntu 上全部可用，Supabase 现在可在全OS上自托管。</li>
<li>提供了场景化预置扩展堆栈的能力，如果您不知道安装哪些扩展，我们准备了针对特定应用场景的扩展推荐包（Stack）。</li>
<li>针对所有 PostgreSQL 生态的扩展，制作了元数据表格、文档、索引、名称映射，针对 EL与Deb 进行对齐，确保扩展可用性。</li>
<li>为了解决 DockerHub 被 Ban 的问题，我们加强了 <code>proxy_env</code> 参数的功能并简化其配置方式。</li>
<li>建设了一个专用的新软件仓库，提供了 12-17 版本的全部扩展插件，其中，PG16的扩展仓库会在 Pigsty 默认的版本中实装。</li>
<li>现有软件仓库升级改造，使用标准的签名与校验机制，确保软件包的完整性与安全性。APT 仓库采用新的标准布局通过 <code>reprepro</code> 构建。</li>
<li>提供了 1,2,3,4,43 节点的沙箱环境：<code>meta</code>, <code>dual</code>, <code>trio</code>, <code>full</code>, <code>prod</code>，以及针对 7 大 OS Distro 的快捷配置模板。</li>
<li>PG Exporter 新增了 PostgreSQL 17 与 pgBouncer 1.23 新监控指标收集器的定义，与使用这些指标的 Grafana Panel</li>
<li>监控面板修缮，修复了各种问题，为 PGSQL Pgbouncer 与 PGSQL Patroni 监控面板添加了日志仪表盘。</li>
<li>使用全新的 <code>cache.yml</code> Ansible 剧本，替换了原有制作离线软件包的 <code>bin/cache</code> 与 <code>bin/release-pkg</code> 脚本。</li>
</ul>
<hr>
<p><strong>API变更</strong></p>
<ul>
<li>新参数选项： <code>pg_mode</code> 现在支持的模式有 <code>pgsql</code>, <code>citus</code>, <code>gpsql</code>, <code>mssql</code>, <code>ivory</code>, <code>polar</code>，用于指定 PostgreSQL 集群的模式
<ul>
<li><code>pgsql</code>： 标准 PostgreSQL 高可用集群</li>
<li><code>citus</code>： Citus 水平分布式 PostgreSQL 原生高可用集群</li>
<li><code>gpsql</code>： 用于 Greenplum 与 GP 兼容数据库的监控（专业版）</li>
<li><code>mssql</code>： 安装 WiltonDB / Babelfish，提供 Microsoft SQL Server 兼容性模式的标准 PostgreSQL 高可用集群，线缆协议级支持，扩展不可用</li>
<li><code>ivory</code>： 安装 IvorySQL 提供的 Oracle 兼容性 PostgreSQL 高可用集群，Oracle语法/数据类型/函数/存储过程兼容，扩展不可用 （专业版）</li>
<li><code>polar</code>： 安装 PolarDB for PostgreSQL （PG RAC）开源版本，提供国产化数据库能力支持，扩展不可用。（专业版）</li>
</ul>
</li>
<li>新参数： <code>pg_parameters</code>，用于在实例级别指定 <code>postgresql.auto.conf</code> 中的参数，覆盖集群配置，实现不同实例成员的个性化配置。</li>
<li>新参数： <code>pg_files</code>，用于将额外的文件拷贝到PGDATA数据目录，针对需要License文件的商业版PostgreSQL分叉内核设计。</li>
<li>新参数： <code>repo_extra_packages</code>，用于额外指定需要下载的软件包，与 <code>repo_packages</code> 共同使用，便于指定OS版本独有的扩展列表。</li>
<li>参数重命名： <code>patroni_citus_db</code> 重命名为 <code>pg_primary_db</code>，用于指定集群中的主要数据库（在 Citus 模式中使用）</li>
<li>参数强化：<code>proxy_env</code> 中的代理服务器配置会写入 Docker Daemon，解决科学上网问题，<code>configure -x</code> 选项会自动在配置中写入当前环境中的代理服务器配置。</li>
<li>参数强化：<code>infra_portal</code> 参数现在支持指定 <code>path</code> 选项，对外暴露本机上的目录，提供web服务。</li>
<li>参数强化：<code>repo_url_packages</code> 中的 <code>repo.pigsty.io</code> 会在区域为中国时自动替换为 <code>repo.pigsty.cc</code>，解决科学上网问题，此外，现在可以指定下载后的文件名称。</li>
<li>参数强化：<code>pg_databases.extensions</code> 中的 <code>extension</code> 字段现在可以支持字典与扩展名字符串两种模式，字典模式提供 <code>version</code> 支持，允许安装特定版本的扩展。</li>
<li>参数强化：<code>repo_upstream</code> 参数如果没有显式覆盖定义，将从 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> 或 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>deb.yml</code></a> 中定义的 <code>repo_upstream_default</code> 提取对应系统的默认值。</li>
<li>参数强化：<code>repo_packages</code> 参数如果没有显式覆盖定义，将从 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> 或 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>deb.yml</code></a> 中定义的 <code>repo_packages_default</code> 提取对应系统的默认值。</li>
<li>参数强化：<code>infra_packages</code> 参数如果没有显式覆盖定义，将从 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> 或 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>deb.yml</code></a> 中定义的 <code>infra_packages_default</code> 提取对应系统的默认值。</li>
<li>参数强化：<code>node_default_packages</code> 参数如果没有显式覆盖定义，将从 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> 或 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>deb.yml</code></a> 中定义的 <code>node_packages_default</code> 提取对应系统的默认值。</li>
<li>参数强化：<code>pg_packages</code> 与 <code>pg_extensions</code> 中的扩展现在都会从  <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> 或 <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/rpm.yml"><code>deb.yml</code></a> 中定义的 <code>pg_package_map</code> 执行一次查找与翻译。</li>
<li>参数强化：<code>node_packages</code> 与 <code>pg_extensions</code> 参数中指定的软件包在安装时会升级至最新版本， <code>node_packages</code> 中现在默认值变为 <code>[openssh-server</code>]，帮助修复 <a href="https://pigsty.io/zh/blog/db/cve-2024-6387/">OpenSSH CVE</a></li>
<li>参数强化：<code>pg_dbsu_uid</code> 会自动根据操作系统类型调整为 <code>26</code> （EL）或 <code>543</code> （Debian），避免了手工调整。</li>
<li>设置了 pgbouncer 默认参数，<code>max_prepared_statements = 128</code> 启用了事物池化模式下的准备语句支持，并设置 <code>server_lifetime</code> 为 600，</li>
<li>修改了 patroni 模板默认参数，统一增大 <code>max_worker_processes</code> +8 可用后端进程，提高 <code>max_wal_senders</code> 与 <code>max_replication_slots</code> 至 50，并增大 OLAP 模板临时文件的大小限制为主磁盘的 1/5</li>
</ul>
<hr>
<p><strong>版本升级</strong></p>
<p>截止至发布时刻，Pigsty 主要组件的版本升级如下：</p>
<ul>
<li><a href="https://www.postgresql.org/about/news/postgresql-164-158-1413-1316-1220-and-17-beta-3-released-2910/"><strong>PostgreSQL</strong></a> 16.4, 15.8, 14.13, 13.16, 12.20</li>
<li><a href="https://github.com/Vonng/pg_exporter">pg_exporter</a> : 0.7.0</li>
<li><a href="https://patroni.readthedocs.io/en/latest/">Patroni</a>: 3.3.2</li>
<li><a href="https://www.pgbouncer.org/2024/08/pgbouncer-1-23-1">pgBouncer</a>: 1.23.1</li>
<li><a href="https://pgbackrest.org/release.html#2.53.1">pgBackRest</a>: 2.53.1</li>
<li><a href="https://github.com/duckdb/duckdb">duckdb</a> : 1.0.0</li>
<li><a href="https://github.com/etcd-io/etcd">etcd</a> : 3.5.15</li>
<li><a href="https://github.com/cybertec-postgresql/pg_timetable">pg_timetable</a>: 5.9.0</li>
<li><a href="https://github.com/FerretDB/FerretDB">ferretdb</a>: 1.23.1</li>
<li><a href="https://github.com/cybertec-postgresql/vip-manager">vip-manager</a>: 2.6.0</li>
<li><a href="https://github.com/minio/minio">minio</a>: 20240817012454</li>
<li><a href="https://github.com/minio/mc">mcli</a>: 20240817113350</li>
<li><a href="https://github.com/grafana/grafana/">grafana</a> : 11.1.4</li>
<li><a href="https://github.com/grafana/loki">loki</a> : 3.1.1</li>
<li><a href="https://github.com/grafana/loki">promtail</a> : 3.0.0</li>
<li><a href="https://github.com/prometheus/prometheus">prometheus</a> : 2.54.0</li>
<li><a href="https://github.com/prometheus/pushgateway">pushgateway</a> : 1.9.0</li>
<li><a href="https://github.com/prometheus/alertmanager">alertmanager</a> : 0.27.0</li>
<li><a href="https://github.com/prometheus/blackbox_exporter">blackbox_exporter</a> : 0.25.0</li>
<li><a href="https://github.com/nginxinc/nginx-prometheus-exporter">nginx_exporter</a> : 1.3.0</li>
<li><a href="https://github.com/prometheus/node_exporter">node_exporter</a> : 1.8.2</li>
<li><a href="https://github.com/gen2brain/keepalived_exporter">keepalived_exporter</a> : 0.7.0</li>
<li><a href="https://github.com/woblerr/pgbackrest_exporter">pgbackrest_exporter</a> 0.18.0</li>
<li><a href="https://github.com/prometheus/mysqld_exporter">mysqld_exporter</a> : 0.15.1</li>
<li><a href="https://github.com/oliver006/redis_exporter">redis_exporter</a> : v1.62.0</li>
<li><a href="https://github.com/danielqsj/kafka_exporter">kafka_exporter</a> : 1.8.0</li>
<li><a href="https://github.com/percona/mongodb_exporter">mongodb_exporter</a> : 0.40.0</li>
<li><a href="https://github.com/VictoriaMetrics/VictoriaMetrics">VictoriaMetrics</a> : 1.102.1</li>
<li><a href="https://github.com/VictoriaMetrics/VictoriaMetrics/releases">VictoriaLogs</a> : v0.28.0</li>
<li><a href="https://github.com/labring/sealos">sealos</a>: 5.0.0</li>
<li><a href="https://github.com/vectordotdev/vector/releases">vector</a> : 0.40.0</li>
</ul>
<p>Pigsty 重新编译了所有 PostgreSQL 扩展插件，PostgreSQL 扩展插件的最新版本，可用的 333 个扩展插件请参考 <a href="/zh/docs/pgext/list/"><strong>扩展列表</strong></a></p>
<p><strong>新应用</strong></p>
<p>Pigsty 现在提供开箱即用的 Dify 与 Odoo 两款使用 PostgreSQL 软件的 Docker Compose 模板：</p>
<ul>
<li><a href="/zh/docs/software/dify">Dify</a>： AI智能体工作流编排与 LLMOps，使用 PostgreSQL 作为元数据库，PGVector 作为向量存储。</li>
<li><a href="/zh/docs/software/odoo">Odoo</a>： 企业级开源 ERP 系统，使用 PostgreSQL 作为底层数据库。</li>
</ul>
<p>Pigsty 专业版现在提供试点的 Kubernetes 部署支持与 Kafka KRaft 集群部署与监控支持</p>
<ul>
<li><strong><code>KUBE</code></strong>： 使用 cri-dockerd 或 containerd 部署由 Pigsty 托管的 Kubernetes 集群</li>
<li><strong><code>KAFKA</code></strong>：部署由 Kraft 协议支持的高可用 Kafka 集群</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>修复了 Ubuntu / Debian 系统中，节点重启后可能出现的 postgresql-common 服务自动启动替代默认数据库集群的缺陷</li>
<li>通过 <code>node_packages</code> 中的默认值 <code>[openssh-server</code>]，<a href="https://pigsty.io/zh/blog/db/cve-2024-6387/">CVE-2024-6387</a> 可以在 Pigsty 安装过程中被自动修复。</li>
<li>修复了 Loki 解析 Nginx 日志标签基数过大导致的内存消耗问题。</li>
<li>修复了 EL8 系统中上游 Ansible 依赖变化导致的 bootstrap 失效问题（python3.11-jmespath 升级至 python3.12-jmespath）</li>
</ul>
<hr>
<h2 id="v270">v2.7.0</h2>
<p><strong>亮点特性</strong></p>
<p>新增了大量强力扩展插件，特别是一些使用 <code>rust</code> 与 <code>pgrx</code> 进行开发的强力扩展：</p>
<ul>
<li><a href="https://github.com/paradedb/paradedb/tree/dev/pg_search">pg_search</a> v0.7.0：使用 BM25 算法对 SQL 表进行全文搜索</li>
<li><a href="https://github.com/paradedb/paradedb/tree/dev/pg_lakehouse">pg_lakehouse</a> v0.7.0：在对象存储（如 S3）和表格式（如 DeltaLake）上进行查询的引擎</li>
<li><a href="https://github.com/paradedb/pg_analytics">pg_analytics</a> v0.6.1：加速 PostgreSQL 内部的分析查询处理</li>
<li><a href="https://github.com/supabase/pg_graphql">pg_graphql</a> v1.5.4：为 PostgreSQL 数据库提供 GraphQL 支持</li>
<li><a href="https://github.com/supabase/pg_jsonschema">pg_jsonschema</a> v0.3.1：提供 JSON Schema 校验的 PostgreSQL 扩展</li>
<li><a href="https://github.com/supabase/wrappers">wrappers</a> v0.3.1：由 Supabase 提供的 PostgreSQL 外部数据封装器集合</li>
<li><a href="https://github.com/tembo-io/pgmq">pgmq</a> v1.5.2：轻量级消息队列，类似于 AWS SQS 和 RSMQ</li>
<li><a href="https://github.com/tembo-io/pg_tier">pg_tier</a> v0.0.3：支将将冷数据分级存储到 AWS S3</li>
<li><a href="https://github.com/tembo-io/pg_vectorize">pg_vectorize</a> v0.15.0: 在 PG 中实现 RAG 向量检索的封装</li>
<li><a href="https://github.com/tembo-io/pg_later">pg_later</a> v0.1.0：现在执行 SQL，并在稍后获取结果</li>
<li><a href="https://github.com/VADOSWARE/pg_idkit">pg_idkit</a> v0.2.3：生成多种流行类型的标识符（UUID）</li>
<li><a href="https://github.com/kaspermarstal/plprql">plprql</a> v0.1.0：在 PostgreSQL 中使用 PRQL 查询语言</li>
<li><a href="https://github.com/zhuobie/pgsmcrypto">pgsmcrypto</a> v0.1.0：PostgreSQL 的国密 SM 算法扩展</li>
<li><a href="https://github.com/kelvich/pg_tiktoken">pg_tiktoken</a> v0.0.1：计算 OpenAI 使用的 Token 数量</li>
<li><a href="https://github.com/rustprooflabs/pgdd">pgdd</a> v0.5.2：通过纯 SQL 接口，访问数据目录的元数据</li>
</ul>
<p>当然，也有一些使用原生 C 和 C++ 开发的强力扩展：</p>
<ul>
<li><a href="https://github.com/pgspider/parquet_s3_fdw">parquet_s3_fdw</a> 1.1.0：从 S3 存取 Parquet 格式文件，作为湖仓之用</li>
<li><a href="https://github.com/plv8/plv8">plv8</a> 3.2.2：使用 V8 引擎，允许在 PostgreSQL 中使用 Javascript 语言编写存储过程</li>
<li><a href="https://github.com/tvondra/md5hash">md5hash</a> 1.0.1：用于存储原生MD5哈希数据类型，而非文本。</li>
<li><a href="https://github.com/Percona-Lab/pg_tde">pg_tde</a> 1.0 alpha：PostgreSQL 的实验性加密存储引擎。</li>
<li><a href="https://github.com/df7cb/pg_dirtyread">pg_dirtyread</a> 2.6：从 PostgreSQL 表中读取未清理的死元组，用于脏读</li>
<li>新的 deb PGDG 扩展：<code>pg_roaringbitmap</code>, <code>pgfaceting</code>, <code>mobilitydb</code>, <code>pgsql-http</code>, <code>pg_hint_plan</code>, <code>pg_statviz</code>, <code>pg_rrule</code></li>
<li>新的 rpm PGDG 扩展：<code>pg_profile</code>, <code>pg_show_plans</code>, 使用 PGDG 的 <code>pgsql_http</code>, <code>pgsql_gzip</code>, <code>pg_net</code>, <code>pg_bigm</code> 替代 Pigsty 维护的 RPM。</li>
</ul>
<p><strong>新特性</strong></p>
<ul>
<li>允许 Pigsty 在特定 Docker 虚拟机镜像中运行。</li>
<li>针对 Ubuntu 与 EL 系操作系统发行版准备了 INFRA &amp; PGSQL 模块的 arm64 软件包</li>
<li>新安装脚本，可从 cloudflare 下载软件，可以指定版本，提供更完善的提示信息。</li>
<li>新增的 PGSQL PITR 监控面板，用于在 PITR 过程中提供更好的可观测性</li>
<li>针对在 Docker 虚拟机镜像中运行 Pigsty 进行了一系列铺垫与准备。</li>
<li>新增了 <a href="https://github.com/Vonng/pigsty/issues/402">防呆设计</a>，避免在非 Pigsty 纳管的节点上运行 pgsql.yml 剧本 （<a href="https://github.com/AdamYLK">AdamYLK</a>）</li>
<li>针对每个支持的发行版大版本配置了独立的配置文件：el7, el8, el9, debian11, debian12, ubuntu20, ubuntu22</li>
</ul>
<p><strong>软件版本升级</strong></p>
<ul>
<li><strong>PostgreSQL 16.3</strong></li>
<li>Patroni 3.3.0</li>
<li>pgBackRest 2.51</li>
<li>VIP-Manager v2.5.0</li>
<li>Haproxy 2.9.7</li>
<li>Grafana 10.4.2</li>
<li>Prometheus 2.51</li>
<li>Loki &amp; Promtail: 3.0.0 (警告：大版本非兼容性变更！)</li>
<li>Alertmanager 0.27.0</li>
<li>BlackBox Exporter 0.25.0</li>
<li>Node Exporter 1.8.0</li>
<li>pgBackrest Exporter 0.17.0</li>
<li>duckdb 0.10.2</li>
<li>etcd 3.5.13</li>
<li>minio-20240510014138 / mcli-20240509170424</li>
<li>pev2 v1.8.0 -&gt; v1.11.0</li>
<li><strong>pgvector</strong> 0.6.1 -&gt; 0.7.0</li>
<li>pg_tle: v1.3.4 -&gt; v1.4.0</li>
<li>hydra: v1.1.1 -&gt; v1.1.2</li>
<li>duckdb_fdw: v1.1.0 重新针对 libduckdb 0.10.2 进行编译</li>
<li>pg_bm25 0.5.6 -&gt; pg_search 0.7.0</li>
<li>pg_analytics: 0.5.6 -&gt; 0.6.1</li>
<li>pg_graphql: 1.5.0 -&gt; 1.5.4</li>
<li>pg_net 0.8.0 -&gt; 0.9.1</li>
<li>pg_sparse (deprecated)</li>
</ul>
<p><strong>Docker应用模板</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/odoo">Odoo</a>：开源 ERP 软件与插件</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/jupyter">Jupyter</a>：使用容器运行 Jupyter Notebook</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/polardb">PolarDB</a>：运行“国产数据库” PolarDB，应付信创检查！</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/supabase">supabase</a>：更新至最近的 GA 版本</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/bytebase">bytebase</a>：使用 <code>latest</code> 标签替代特定版本号。</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/pg_exporter">pg_exporter</a>：更新了 Docker 镜像的例子。</li>
</ul>
<p><strong>缺陷修复</strong></p>
<ul>
<li>修复了 pg_exporters 角色中的变量空白问题。</li>
<li>修复了 <code>minio_cluster</code> 变量没有在全局配置中注释掉的问题</li>
<li>修复了 EL7 模板中的 <code>postgis34</code> 插件名称问题，应该使用 <code>postgis33</code></li>
<li>修复了 EL8 <code>python3.11-cryptography</code> 依赖名的问题，上游现在变更为 <code>python3-cryptography</code>。</li>
<li>修复了 <code>/pg/bin/pg-role</code> 无法在非交互式 Shell 模式下获取操作系统用户名的问题</li>
<li>修复了 <code>/pg/bin/pg-pitr</code> 无法正确提示 <code>-X</code> <code>-P</code> 选项的问题</li>
</ul>
<p><strong>API变更</strong></p>
<ul>
<li>新参数 <code>node_write_etc_hosts</code>，用于控制是否向目标节点的 <code>/etc/hosts</code> 文件写入静态 DNS 解析记录</li>
<li>新增了 <code>prometheus_sd_dir</code> 参数，用于指定 Prometheus 静态服务发现的目标文件目录</li>
<li>configure 脚本新增了 <code>-x|--proxy</code> 参数，用于将当前环境的代理信息写入配置文件 by @waitingsong in <a href="https://github.com/Vonng/pigsty/pull/405">https://github.com/Vonng/pigsty/pull/405</a></li>
<li>不再使用 Promtail &amp; Loki 解析 Infra 节点上的 Nginx 日志细节标签，因为这样会导致标签基数爆炸。</li>
<li>在 Prometheus 配置中使用 alertmanager API v2 替代 v1</li>
<li>在 PGSQL 模块中，使用 <code>/pg/cert/ca.crt</code> 代替 <code>/etc/pki/ca.crt</code>，降低对节点根证书的依赖。</li>
</ul>
<p><strong>新的贡献者</strong></p>
<ul>
<li>@NeroSong made their first contribution in <a href="https://github.com/Vonng/pigsty/pull/373">https://github.com/Vonng/pigsty/pull/373</a></li>
<li>@waitingsong made their first contribution in <a href="https://github.com/Vonng/pigsty/pull/405">https://github.com/Vonng/pigsty/pull/405</a></li>
</ul>
<p><strong>完整的变更日志</strong>: <a href="https://github.com/Vonng/pigsty/compar">https://github.com/Vonng/pigsty/compar</a></p>
<p><strong>离线软件包校验和</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ec271a1d34b2b1360f78bfa635986c3a  pigsty-pkg-v2.7.0.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>f3304bfd896b7e3234d81d8ff4b83577  pigsty-pkg-v2.7.0.debian12.x86_64.tgz
</span></span><span style="display:flex;"><span>5b071c2a651e8d1e68fc02e7e922f2b3  pigsty-pkg-v2.7.0.ubuntu22.x86_64.tgz
</span></span></code></pre></div><hr>
<h2 id="v260">v2.6.0</h2>
<p><strong>亮点特性</strong></p>
<ul>
<li>现已将 PostgreSQL 16 作为默认主要版本（16.2）</li>
<li>新增 <a href="https://www.paradedb.com/">ParadeDB</a> 扩展插件：<code>pg_analytics</code>, <code>pg_bm25</code>, and <code>pg_sparse</code></li>
<li>新增 <a href="https://duckdb.org/">DuckDB</a> 与 <code>duckdb_fdw</code> 插件支持</li>
<li>全球 Cloudflare CDN <a href="https://repo.pigsty.io">https://repo.pigsty.io</a> 与中国大陆CDN <a href="https://repo.pigsty.cc">https://repo.pigsty.cc</a></li>
</ul>
<p><strong>软件配置变更</strong></p>
<ul>
<li>使用 <code>node_repo_modules</code> 替换 <code>node_repo_method</code> 参数，并移除 <code>node_repo_local_urls</code> 参数。</li>
<li>暂时关闭 Grafana 统一告警功能，避免 &ldquo;Database Locked&rdquo; 错误。</li>
<li>新增 <code>node_repo_modules</code> 参数，用于指定在节点上添加的上游仓库源。</li>
<li>移除 <code>node_local_repo_urls</code>，其功能由 <code>node_repo_modules</code> &amp; <code>repo_upstream</code> 替代。</li>
<li>移除 <code>node_repo_method</code> 参数，其功能由 <code>node_repo_modules</code> 替代。</li>
<li>在 <code>repo_upstream</code> 添加新的 <code>local</code> 源，并通过 <code>node_repo_modules</code> 使用，替代 <code>node_local_repo_urls</code> 的功能</li>
<li>重排 <code>node_default_packages</code>，<code>infra_packages</code>，<code>pg_packages</code>，<code>pg_extensions</code> 参数默认值。</li>
<li>在 <code>repo_upstream</code> 中替换 <code>repo_upstream.baseurl</code> 时，如果 EL8/9 PGDG小版本特定的仓库可用，使用 <code>major.minor</code> 而不是 <code>major</code> 替换 $releasever，提高小版本兼容性。</li>
</ul>
<p><strong>软件版本升级</strong></p>
<ul>
<li>Grafana 10.3</li>
<li>Prometheus 2.47</li>
<li>node_exporter 1.7.0</li>
<li>HAProxy 2.9.5</li>
<li>Loki / Promtail 2.9.4</li>
<li>minio-20240216110548 / mcli-20240217011557</li>
<li>etcd 3.5.11</li>
<li>Redis 7.2.4</li>
<li>Bytebase 2.13.2</li>
<li>DuckDB 0.10.0</li>
<li>FerretDB 1.19</li>
<li>Metabase：新Docker应用模板</li>
</ul>
<p><strong>PostgreSQL扩展插件</strong></p>
<ul>
<li>PostgreSQL 小版本升级： 16.2, 15.6, 14.11, 13.14, 12.18</li>
<li>PostgreSQL 16： 现在被提升为默认主版本</li>
<li>pg_exporter 0.6.1：安全修复</li>
<li>Patroni 3.2.2</li>
<li>pgBadger 12.4</li>
<li>pgBackRest 2.50</li>
<li>vip-manager 2.3.0</li>
<li>PostGIS 3.4.2</li>
<li>TimescaleDB 2.14.1</li>
<li>向量扩展 PGVector 0.6.0：新增并行创建 HNSW 索引功能</li>
<li>新增扩展插件 <a href="https://github.com/alitrack/duckdb_fdw">duckdb_fdw</a> v1.1 ，支持读写 DuckDB 数据 v1.1</li>
<li>新增扩展插件 <a href="https://github.com/pramsey/pgsql-gzip">pgsql-gzip</a> ，用于支持 Gzip 压缩解压缩 v1.0.0</li>
<li>新增扩展插件 <a href="https://github.com/paradedb/paradedb/tree/dev/pg_sparse">pg_sparse</a>，高效处理稀疏向量（ParadeDB） v0.5.6</li>
<li>新增扩展插件 <a href="https://github.com/paradedb/paradedb/tree/dev/pg_bm25">pg_bm25</a>，用于支持高质量全文检索 BM25 算法的插件（ParadeDB） v0.5.6</li>
<li>新增扩展插件 <a href="https://github.com/paradedb/paradedb/tree/dev/pg_analytics">pg_analytics</a>，支持 SIMD 与列式存储的PG分析插件（ParadeDB） v0.5.6</li>
<li>升级AIML插件 <a href="https://github.com/postgresml/postgresml">pgml</a> 至 v2.8.1，新增 PG 16 支持。</li>
<li>升级列式存储插件 <a href="https://github.com/hydradatabase/">hydra</a> 版本至 v1.1.1，新增 PG 16 支持。</li>
<li>升级图扩展插件 <a href="https://github.com/apache/age">age</a> 至 v1.5.0，新增 PG 16 支持。</li>
<li>升级GraphQL插件 <a href="https://github.com/supabase/pg_graphql">pg_graphql</a> 版本至 v1.5.0 ，支持 Supabase。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>330e9bc16a2f65d57264965bf98174ff  pigsty-v2.6.0.tgz
</span></span><span style="display:flex;"><span>81abcd0ced798e1198740ab13317c29a  pigsty-pkg-v2.6.0.debian11.x86_64.tgz
</span></span><span style="display:flex;"><span>7304f4458c9abd3a14245eaf72f4eeb4  pigsty-pkg-v2.6.0.debian12.x86_64.tgz
</span></span><span style="display:flex;"><span>f914fbb12f90dffc4e29f183753736bb  pigsty-pkg-v2.6.0.el7.x86_64.tgz
</span></span><span style="display:flex;"><span>fc23d122d0743d1c1cb871ca686449c0  pigsty-pkg-v2.6.0.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>9d258dbcecefd232f3a18bcce512b75e  pigsty-pkg-v2.6.0.el9.x86_64.tgz
</span></span><span style="display:flex;"><span>901ee668621682f99799de8932fb716c  pigsty-pkg-v2.6.0.ubuntu20.x86_64.tgz
</span></span><span style="display:flex;"><span>39872cf774c1fe22697c428be2fc2c22  pigsty-pkg-v2.6.0.ubuntu22.x86_64.tgz
</span></span></code></pre></div><hr>
<h2 id="v251">v2.5.1</h2>
<p>跟进 PostgreSQL v16.1, v15.5, 14.10, 13.13, 12.17, 11.22 小版本例行更新。</p>
<p>现在 PostgreSQL 16 的所有重要扩展已经就位（新增 <code>pg_repack</code> 与 <code>timescaledb</code> 支持）</p>
<ul>
<li>软件更新：
<ul>
<li>PostgreSQL to v16.1, v15.5, 14.10, 13.13, 12.17, 11.22</li>
<li>Patroni v3.2.0</li>
<li>PgBackrest v2.49</li>
<li>Citus 12.1</li>
<li>TimescaleDB 2.13</li>
<li>Grafana v10.2.0</li>
<li>FerretDB 1.15</li>
<li>SealOS 4.3.7</li>
<li>Bytebase 2.11.1</li>
</ul>
</li>
</ul>
<ul>
<li>移除  PGCAT 监控面板中查询对 <code>monitor</code> 模式前缀（允许用户将 <code>pg_stat_statements</code> 扩展装到别的地方）</li>
<li>新的配置模板 <code>wool.yml</code>，为阿里云免费99 ECS 单机针对设计。</li>
<li>为 EL9 新增 <code>python3-jmespath</code> 软件包，解决 Ansible 依赖更新后 bootstrap 缺少 jmespath 的问题</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>31ee48df1007151009c060e0edbd74de  pigsty-pkg-v2.5.1.el7.x86_64.tgz
</span></span><span style="display:flex;"><span>a40f1b864ae8a19d9431bcd8e74fa116  pigsty-pkg-v2.5.1.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>c976cd4431fc70367124fda4e2eac0a7  pigsty-pkg-v2.5.1.el9.x86_64.tgz
</span></span><span style="display:flex;"><span>7fc1b5bdd3afa267a5fc1d7cb1f3c9a7  pigsty-pkg-v2.5.1.debian11.x86_64.tgz
</span></span><span style="display:flex;"><span>add0731dc7ed37f134d3cb5b6646624e  pigsty-pkg-v2.5.1.debian12.x86_64.tgz
</span></span><span style="display:flex;"><span>99048d09fa75ccb8db8e22e2a3b41f28  pigsty-pkg-v2.5.1.ubuntu20.x86_64.tgz
</span></span><span style="display:flex;"><span>431668425f8ce19388d38e5bfa3a948c  pigsty-pkg-v2.5.1.ubuntu22.x86_64.tgz
</span></span></code></pre></div><hr>
<h2 id="v250">v2.5.0</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl https://get.pigsty.cc/latest <span style="color:#000;font-weight:bold">|</span> bash
</span></span></code></pre></div><p><strong>亮点特性</strong></p>
<ul>
<li>
<p><a href="https://github.com/Vonng/pigsty/blob/main/files/pigsty/ubuntu.yml">Ubuntu</a> / <a href="https://github.com/Vonng/pigsty/blob/main/files/pigsty/debian.yml">Debian</a>  支持： bullseye, bookworm, jammy, focal</p>
</li>
<li>
<p>使用CDN <code>repo.pigsty.cc</code> 软件源，提供 rpm/deb 软件包下载。</p>
</li>
<li>
<p>Anolis 操作系统支持（ 兼容 EL 8.8 ）。</p>
</li>
<li>
<p>使用 PostgreSQL 16 替代 PostgreSQL 14 作为备选主要支持版本</p>
</li>
<li>
<p>新增了 PGSQL Exporter / PGSQL Patroni 监控面板，重做 PGSQL Query 面板</p>
</li>
<li>
<p>扩展更新：</p>
<ul>
<li>PostGIS 版本至 3.4（ EL8/EL9 ），EL7 仍使用 PostGIS 3.3</li>
<li>移除 <code>pg_embedding</code>，因为开发者不再对其进行维护，建议使用 <code>pgvector</code> 替换。</li>
<li>新扩展（EL）：点云插件 <code>pointcloud</code> 支持，Ubuntu原生带有此扩展。</li>
<li>新扩展（EL）： <code>imgsmlr</code>， <code>pg_similarity</code>，<code>pg_bigm</code> 用于搜索。</li>
<li>重新编译 <code>pg_filedump</code> 为 PG 大版本无关的软件包。。</li>
<li>新收纳 <code>hydra</code> 列存储扩展，不再默认安装 <code>citus</code> 扩展。</li>
</ul>
</li>
<li>
<p>软件更新：</p>
<ul>
<li>Grafana 更新至 v10.1.5</li>
<li>Prometheus 更新至 v2.47</li>
<li>Promtail/Loki 更新至 v2.9.1</li>
<li>Node Exporter 更新至 v1.6.1</li>
<li>Bytebase 更新至 v2.10.0</li>
<li>patroni 更新至 v3.1.2</li>
<li>pgbouncer 更新至 v1.21.0</li>
<li>pg_exporter 更新至 v0.6.0</li>
<li>pgbackrest 更新至 v2.48.0</li>
<li>pgbadger 更新至 v12.2</li>
<li>pg_graphql 更新至 v1.4.0</li>
<li>pg_net 更新至 v0.7.3</li>
<li>ferretdb 更新至 v0.12.1</li>
<li>sealos 更新至 4.3.5</li>
<li>Supabase 支持更新至 <code>20231013070755</code></li>
</ul>
</li>
</ul>
<p><strong>Ubuntu 支持说明</strong></p>
<p>Pigsty 支持了 Ubuntu 22.04 (jammy) 与 20.04 (focal) 两个 LTS 版本，并提供相应的离线软件安装包。</p>
<p>相比 EL 系操作系统，一些参数的默认值需要显式指定调整，详情请参考 <a href="https://github.com/Vonng/pigsty/blob/main/files/pigsty/ubuntu.yml"><code>ubuntu.yml</code></a></p>
<ul>
<li><code>repo_upstream</code>：按照 Ubuntu/Debian 的包名进行了调整</li>
<li><code>repo_packages</code>：按照 Ubuntu/Debian 的包名进行了调整</li>
<li><code>node_repo_local_urls</code>：默认值为 <code>['deb [trusted=yes] http://${admin_ip}/pigsty ./']</code></li>
<li><code>node_default_packages</code> ：
<ul>
<li><code>zlib</code> -&gt; <code>zlib1g</code>, <code>readline</code> -&gt; <code>libreadline-dev</code></li>
<li><code>vim-minimal</code> -&gt; <code>vim-tiny</code>, <code>bind-utils</code> -&gt; <code>dnsutils</code>, <code>perf</code> -&gt; <code>linux-tools-generic</code>,</li>
<li>新增软件包 <code>acl</code>，确保 Ansible 权限设置正常工作</li>
</ul>
</li>
<li><code>infra_packages</code>：所有含 <code>_</code> 的包要替换为 <code>-</code> 版本，此外 <code>postgresql-client-16</code> 用于替换 <code>postgresql16</code></li>
<li><code>pg_packages</code>：Ubuntu 下惯用 <code>-</code> 替代 <code>_</code>，不需要手工安装 <code>patroni-etcd</code> 包。</li>
<li><code>pg_extensions</code>：扩展名称与EL系不太一样，Ubuntu下缺少 <code>passwordcheck_cracklib</code> 扩展。</li>
<li><code>pg_dbsu_uid</code>： Ubuntu 下 Deb 包不显式指定uid，需要手动指定，Pigsty 默认分配为 <code>543</code></li>
</ul>
<p><strong>API变更</strong></p>
<p>默认值变化：</p>
<ul>
<li>
<p><code>repo_modules</code> 现在的默认值为 <code>infra,node,pgsql,redis,minio</code>，启用所有上游源</p>
</li>
<li>
<p><code>repo_upstream</code> 发生变化，现在添加了 Pigsty Infra/MinIO/Redis/PGSQL 模块化软件源</p>
</li>
<li>
<p><code>repo_packages</code> 发生变化，移除未使用的 <code>karma,mtail,dellhw_exporter</code>，移除了 PG14 主要扩展，新增了 PG16 主要扩展，添加了 virtualenv 包。</p>
</li>
<li>
<p><code>node_default_packages</code> 发生变化，默认安装 <code>python3-pip</code> 组件。</p>
</li>
<li>
<p><code>pg_libs</code>: <code>timescaledb</code> 从 shared_preload_libraries 中移除，现在默认不自动启用。</p>
</li>
<li>
<p><code>pg_extensions</code> 发生变化，不再默认安装 Citus 扩展，默认安装 <code>passwordcheck_cracklib</code> 扩展，EL8,9 PostGIS 默认版本升级至 3.4</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">pg_repack_${pg_version}* wal2json_${pg_version}* passwordcheck_cracklib_${pg_version}*</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">postgis34_${pg_version}* timescaledb-2-postgresql-${pg_version}* pgvector_${pg_version}*</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li>
<li>
<p>Patroni 所有模板默认移除 <code>wal_keep_size</code> 参数，避免触发 Patroni 3.1.1 的错误，其功能由 <code>min_wal_size</code> 覆盖。</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>87e0be2edc35b18709d7722976e305b0  pigsty-pkg-v2.5.0.el7.x86_64.tgz
</span></span><span style="display:flex;"><span>e71304d6f53ea6c0f8e2231f238e8204  pigsty-pkg-v2.5.0.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>39728496c134e4352436d69b02226ee8  pigsty-pkg-v2.5.0.el9.x86_64.tgz
</span></span><span style="display:flex;"><span>e3f548a6c7961af6107ffeee3eabc9a7  pigsty-pkg-v2.5.0.debian11.x86_64.tgz
</span></span><span style="display:flex;"><span>1e469cc86a19702e48d7c1a37e2f14f9  pigsty-pkg-v2.5.0.debian12.x86_64.tgz
</span></span><span style="display:flex;"><span>cc3af3b7c12f98969d3c6962f7c4bd8f  pigsty-pkg-v2.5.0.ubuntu20.x86_64.tgz
</span></span><span style="display:flex;"><span>c5b2b1a4867eee624e57aed58ac65a80  pigsty-pkg-v2.5.0.ubuntu22.x86_64.tgz
</span></span></code></pre></div><hr>
<h2 id="v241">v2.4.1</h2>
<ul>
<li><a href="https://supabase.com/">Supabase</a> 支持：开源的 Firebase 替代，现可使用 Pigsty 本地托管的 PostgreSQL 实例作为数据存储。</li>
<li><a href="https://postgresml.org/">PostgresML</a>支持：使用SQL完成经典机器学习算法，训练、微调、调用大语言模型（hugging face）。</li>
<li><a href="https://github.com/FerretDB/FerretDB">FerretDB</a> v1.10 支持，在 PostgreSQL 上提供 MongoDB API与协议兼容能力。</li>
<li>GraphQL扩展: <a href="https://github.com/supabase/pg_graphql"><code>pg_graphql</code></a>：从现有模式中反射出 GraphQL 模式，提供库内 GraphQL 查询能力。</li>
<li>JWT支持扩展：<a href="https://github.com/michelp/pgjwt"><code>pgjwt</code></a> 允许您使用 SQL 验证签发 JWT (JSON Web Tokens)。</li>
<li>密钥存储扩展: <a href="https://github.com/supabase/vault"><code>vault</code></a> 可以在提供一个安全存储加密密钥的保险柜。</li>
<li>数据恢复扩展：<a href="https://github.com/df7cb/pg_filedump"><code>pg_filedump</code></a>：可用于快速从PostgreSQL二进制文件中恢复数据</li>
<li>图数据库扩展：Apache <a href="https://age.apache.org/"><code>age</code></a>，为 PostgreSQL 添加 OpenCypher 查询支持，类似 Neo4J</li>
<li>中文分词扩展：<a href="https://github.com/amutu/zhparser"><code>zhparser</code></a>，为中文全文检索提供分词能力，类似 ElasticSearch。</li>
<li>高效位图扩展：<a href="https://github.com/ChenHuajun/pg_roaringbitmap"><code>pg_roaringbitmap</code></a>，在 PostgreSQL 中提供 roaring bitmap 的支持，高效计数聚合统计。</li>
<li>向量嵌入替代：<a href="https://github.com/neondatabase/pg_embedding"><code>pg_embedding</code></a>，提供了不同于 pgvector 的另一种 HNSW 替代实现。</li>
<li>可信语言扩展：<a href="https://github.com/aws/pg_tle"><code>pg_tle</code></a>，由 AWS 出品的，允许您打包分发管理由可信存储过程语言编写的函数。</li>
<li>HTTP客户端扩展：<a href="https://github.com/pramsey/pgsql-http"><code>pgsql-http</code></a>：使用 SQL 接口，curl API，发起 HTTP 请求，与各类系统交互。</li>
<li>异步HTTP扩展： <a href="https://github.com/supabase/pg_net"><code>pg_net</code></a> 允许您使用 SQL 发起非阻塞的 HTTP/HTTPS 请求。</li>
<li>列式存储引擎：<a href="https://www.hydra.so/"><code>hydra</code></a> 针对分析场景打造的向量化列存储引擎，原地替代 Citus 列存插件。</li>
<li>其他PGDG扩展：新收录8个由PGDG维护的扩展插件，Pigsty支持的插件总数达到 150+ 。</li>
<li>PostgreSQL 16 内核支持，监控云端 RDS / PolarDB for PostgreSQL。</li>
</ul>
<p><strong>亮点特性</strong></p>
<ul>
<li><a href="https://supabase.com/">Supabase</a> 支持：开源的 Firebase 替代，现可使用 Pigsty 托管的 PostgreSQL 实例存储数据。</li>
<li><a href="https://postgresml.org/">PostgresML</a>支持：在 PostgreSQL 运行各类模型（hugging face），向量操作，经典机器学习算法。</li>
<li>GraphQL支持扩展: <a href="https://github.com/supabase/pg_graphql"><code>pg_graphql</code></a>：从现有模式中反射出 GraphQL 模式，提供库内 GraphQL 查询能力。</li>
<li>异步HTTP客户端扩展： <a href="https://github.com/supabase/pg_net"><code>pg_net</code></a> 允许您使用 SQL 发起非阻塞的 HTTP/HTTPS 请求</li>
<li>JWT支持扩展：<a href="https://github.com/michelp/pgjwt"><code>pgjwt</code></a> 允许您使用 SQL 验证签发 JWT (JSON Web Tokens)</li>
<li>密钥存储扩展: <a href="https://github.com/supabase/vault"><code>vault</code></a> 可以在保险柜里存储加密密钥</li>
<li>将<a href="https://github.com/FerretDB/FerretDB">FerretDB</a> 版本升级至 v1.10</li>
<li>新增组件：<a href="https://github.com/df7cb/pg_filedump"><code>pg_filedump</code></a>：可用于快速从PostgreSQL二进制文件中恢复数据</li>
<li>减少 EL9 离线软件包的大小，移除非必须依赖项 <code>proj-data*</code></li>
<li>修复了 Patroni 3.1.1 的错误</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>efabe7632d8994f3fb58f9838b8f9d7d  pigsty-pkg-v2.5.0.el7.x86_64.tgz # 1.1G
</span></span><span style="display:flex;"><span>ea78957e8c8434b120d1c8c43d769b56  pigsty-pkg-v2.5.0.el8.x86_64.tgz # 1.4G
</span></span><span style="display:flex;"><span>4ef280a7d28872814e34521978b851bb  pigsty-pkg-v2.5.0.el9.x86_64.tgz # 1.3G
</span></span></code></pre></div><hr>
<h2 id="v240">v2.4.0</h2>
<p>使用 <code>bash -c &quot;$(curl -fsSL https://get.pigsty.cc/latest)&quot;</code> 快速上手。</p>
<p><strong>最新特性</strong></p>
<ul>
<li>PostgreSQL 16 正式发布，Pigsty提供支持。</li>
<li>可以监控云数据库，RDS for PostgreSQL，以及 PolarDB，提供全新的 PGRDS 监控面板</li>
<li>正式提供商业支持与咨询服务。并发布首个 LTS 版本，为订阅客户提供最长5年的支持。</li>
<li>新扩展插件: Apache AGE, openCypher graph query engine on PostgreSQL</li>
<li>新扩展插件: zhparser, full text search for Chinese language</li>
<li>新扩展插件: pg_roaringbitmap, roaring bitmap for PostgreSQL</li>
<li>新扩展插件: pg_embedding, hnsw alternative to pgvector</li>
<li>新扩展插件: pg_tle, admin / manage stored procedure extensions</li>
<li>新扩展插件: pgsql-http, issue http request with SQL interface</li>
<li>新增插件： pg_auth_mon pg_checksums pg_failover_slots pg_readonly postgresql-unit pg_store_plans pg_uuidv7 set_user</li>
<li>Redis改进：支持 Redis 哨兵监控，配置主从集群的自动高可用。</li>
</ul>
<p><strong>API变化</strong></p>
<ul>
<li>新增参数，<code>REDIS</code>.<code>redis_sentinel_monitor</code>，用于指定 Sentinel 集群监控的主库列表</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>修复 Grafana 10.1 注册数据源时缺少 <code>uid</code> 的问题</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.4.0.el7.x86_64.tgz) = 257443e3c171439914cbfad8e9f72b17
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.4.0.el8.x86_64.tgz) = 41ad8007ffbfe7d5e8ba5c4b51ff2adc
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.4.0.el9.x86_64.tgz) = 9a950aed77a6df90b0265a6fa6029250
</span></span></code></pre></div><hr>
<h2 id="v231">v2.3.1</h2>
<p>使用 <code>bash -c &quot;$(curl -fsSL https://get.pigsty.cc/latest)&quot;</code> 快速开始。</p>
<p><strong>最新特性</strong></p>
<ul>
<li><code>pgvector</code> 更新至 0.5，添加 hnsw 算法支持。</li>
<li>支持 PostgreSQL 16 RC1 (el8/el9)</li>
<li>默认包中添加了 SealOS 用于快速部署Kubernetes集群。</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>修复了 <code>infra</code>.<code>repo</code>.<code>repo_pkg</code> 任务：当 <code>repo_packages</code> 中包名包含 <code>*</code> 时，下载可能会受到 <code>/www/pigsty</code> 现有内容的影响。</li>
<li>将 <code>vip_dns_suffix</code> 的默认值由 <code>.vip</code> 调整为空字符串，即集群本身的名称将默认作为节点集群的 L2 VIP</li>
<li><code>modprobe watchdog</code> and <code>chown watchdog</code> if <code>patroni_watchdog_mode</code> is <code>required</code></li>
<li>当 <code>pg_dbsu_sudo</code> = <code>limit</code> and <code>patroni_watchdog_mode</code> = <code>required</code> 时，授予数据库 dbsu 以下命令的 sudo 执行权限
<ul>
<li><code>/usr/bin/sudo /sbin/modprobe softdog</code>：在启动 Patroni 服务时确保 softdog 内核模块启用</li>
<li><code>/usr/bin/sudo /bin/chown {{ pg_dbsu }} /dev/watchdog</code>: 在启动 Patroni 服务时，确保 watchdog 属主正确</li>
</ul>
</li>
</ul>
<p><strong>文档更新</strong></p>
<ul>
<li>向英文文档中添加了更新内容。</li>
<li>添加了简体中文版本的内置文档，修复了 pigsty.cc 文档站的中文文档。</li>
</ul>
<p><strong>软件更新</strong></p>
<ul>
<li>PostgreSQL 16 RC1 for EL8/EL9</li>
<li>PGVector 0.5.0，支持 hnsw 索引</li>
<li>TimescaleDB 2.11.2</li>
<li>grafana 10.1.0</li>
<li>loki &amp; promtail 2.8.4</li>
<li>redis-stack 7.2 on el7/8</li>
<li>mcli-20230829225506 / minio-20230829230735</li>
<li>ferretdb 1.9</li>
<li>sealos 4.3.3</li>
<li>pgbadger 1.12.2</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ce69791eb622fa87c543096cdf11f970  pigsty-pkg-v2.3.1.el7.x86_64.tgz
</span></span><span style="display:flex;"><span>495aba9d6d18ce1ebed6271e6c96b63a  pigsty-pkg-v2.3.1.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>38b45582cbc337ff363144980d0d7b64  pigsty-pkg-v2.3.1.el9.x86_64.tgz
</span></span></code></pre></div><hr>
<h2 id="v230">v2.3.0</h2>
<p>相关文章：《<a href="https://mp.weixin.qq.com/s/p5sP42xsAxKPhWb_T7DqSA">Pigsty v2.3 发布：应用生态丰富</a>》</p>
<p>发布注记：https://github.com/Vonng/pigsty/releases/tag/v2.3.0</p>
<p>使用 <code>bash -c &quot;$(curl -fsSL https://get.pigsty.cc/latest)&quot;</code> 快速开始。</p>
<p><strong>亮点特性</strong></p>
<ul>
<li>INFRA: 添加了对 NODE/PGSQL VIP 的监控支持</li>
<li>PGSQL: 通过小版本升级修复了 PostgreSQL <a href="https://www.postgresql.org/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/">CVE-2023-39417</a>： 15.4, 14.9, 13.12, 12.16，以及 Patroni v3.1.0</li>
<li>NODE:  允许用户使用 <code>keepalived</code> 为一个节点集群绑定 L2 VIP</li>
<li>REPO: Pigsty 专用 yum 源优化精简，全站默认使用 HTTPS： <a href="https://get.pigsty.cc"><code>get.pigsty.cc</code></a> 与 <a href="https://demo.pigsty.cc"><code>demo.pigsty.cc</code></a></li>
<li>APP:  升级 <code>app/bytebase</code> 版本至 v2.6.0， <code>app/ferretdb</code> 版本至 v1.8；添加新的应用模板：<a href="https://nocodb.com/">nocodb</a>，开源的 Airtable。</li>
<li>REDIS: 升级版本至 v7.2，并重制了 Redis 监控面板。</li>
<li>MONGO: 添加基于 <a href="https://www.ferretdb.io/">FerretDB</a> 1.8 实现的基本支持。</li>
<li>MYSQL: 添加了 Prometheus / Grafana / CA 中的代码存根，便于后续纳管。</li>
</ul>
<p><strong>API变化</strong></p>
<p>新增一个新的参数组 <code>NODE</code>.<code>NODE_VIP</code>：包含 8 个新参数</p>
<ul>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_enabled</code>：在此节点集群上启用 vip 吗？</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_address</code>：ipv4 格式的节点 vip 地址，如果启用了 vip，则必需</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_vrid</code>：必需，整数，1-255 在相同 VLAN 中应该是唯一的</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_role</code>：master/backup，默认为备份，用作初始角色</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_preempt</code>：可选，true/false，默认为 false，启用 vip 抢占</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_interface</code>：节点 vip 网络接口监听，eth0 默认</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_dns_suffix</code>：节点 vip dns 名称后缀，默认为空字符串</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_exporter_port</code>：keepalived 导出器监听端口，默认为 9650</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.3.0.el7.x86_64.tgz) = 81db95f1c591008725175d280ad23615
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.3.0.el8.x86_64.tgz) = 6f4d169b36f6ec4aa33bfd5901c9abbe
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.3.0.el9.x86_64.tgz) = 4bc9ae920e7de6dd8988ca7ee681459d
</span></span></code></pre></div><hr>
<h2 id="v220">v2.2.0</h2>
<p>相关文章：《<a href="https://mp.weixin.qq.com/s/NfQEL6fM8FA-ErijucXJ4g">Pigsty v2.2 发布 —— 监控系统大升级</a>》</p>
<p>发布注记：https://github.com/Vonng/pigsty/releases/tag/v2.2.0</p>
<p>快速开始： <code>bash -c &quot;$(curl -fsSL https://get.pigsty.cc/latest)&quot;</code></p>
<p><strong>亮点特性</strong></p>
<ul>
<li>监控面板重做: <a href="https://demo.pigsty.cc">https://demo.pigsty.cc</a></li>
<li>Vagrant沙箱重做: 支持 libvirt 与新的配置模板</li>
<li>Pigsty EL Yum 仓库: 统一收纳零碎 RPM，简化安装构建流程。</li>
<li>操作系统兼容性: 新增信创操作系统 UOS-v20-1050e 支持</li>
<li>新的配置模板：42 节点的生产仿真配置</li>
<li>统一使用官方 PGDG citus 软件包（el7）</li>
</ul>
<p><strong>软件升级</strong></p>
<ul>
<li>PostgreSQL 16 beta2</li>
<li>Citus 12 / PostGIS 3.3.3 / TimescaleDB 2.11.1 / PGVector 0.44</li>
<li>patroni 3.0.4 / pgbackrest 2.47 / pgbouncer 1.20</li>
<li>grafana 10.0.3 / loki/promtail/logcli 2.8.3</li>
<li>etcd 3.5.9 / haproxy v2.8.1 / redis v7.0.12</li>
<li>minio 20230711212934 / mcli 20230711233044</li>
</ul>
<p><strong>Bug修复</strong></p>
<ul>
<li>修复了 Docker 组权限的问题 <a href="https://github.com/Vonng/pigsty/commit/29434bdd39548d95d80a236de9099874ed564f9b">29434bd</a></li>
<li>将 <code>infra</code> 操作系统用户组作为额外的组，而不是首要用户组。</li>
<li>修复了 Redis Sentinel Systemd 服务的自动启用状态 <a href="https://github.com/Vonng/pigsty/commit/5c96feb598ad6e44daa7a595e34c87e67952777b">5c96feb</a></li>
<li>放宽了 <code>bootstrap</code> &amp; <code>configure</code> 的检查，特别是当 <code>/etc/redhat-release</code> 不存在的时候。</li>
<li>升级到 Grafana 10，修复了 Grafana 9.x <a href="https://grafana.com/blog/2023/03/22/grafana-security-release-new-versions-with-security-fixes-for-cve-2023-1410/">CVE-2023-1410</a></li>
<li>在 CMDB <code>pglog</code> 模式中添加了 PG 14 - 16 的 command tags 与 错误代码。</li>
</ul>
<p><strong>API变化</strong></p>
<p>新增1个变量</p>
<ul>
<li><code>INFRA</code>.<code>NGINX</code>.<code>nginx_exporter_enabled</code>: 现在用户可以通过设置这个参数来禁用 nginx_exporter 。</li>
</ul>
<p>默认值变化:</p>
<ul>
<li><code>repo_modules</code>: <code>node,pgsql,infra</code> : redis 现在由 pigsty-el 仓库提供，不再需要 <code>redis</code> 模块。</li>
<li><code>repo_upstream</code>:
<ul>
<li>新增 <code>pigsty-el</code>: 与具体EL版本无关的RPM: 例如 grafana, minio, pg_exporter, 等等……</li>
<li>新增 <code>pigsty-misc</code>: 与具体EL版本有关的RPM: 例如 redis, prometheus 全家桶，等等……</li>
<li>移除 <code>citus</code>: 现在 PGDG 中有完整的 EL7 - EL9 citus 12 支持</li>
<li>移除 <code>remi</code>: redis 现在由 pigsty-el 仓库提供，不再需要 <code>redis</code> 模块。</li>
</ul>
</li>
<li><code>repo_packages</code>:
<ul>
<li>ansible python3 python3-pip python3-requests python3-jmespath python3.11-jmespath dnf-utils modulemd-tools # el7: python36-requests python36-idna yum-utils</li>
<li>grafana loki logcli promtail prometheus2 alertmanager karma pushgateway node_exporter blackbox_exporter nginx_exporter redis_exporter</li>
<li>redis etcd minio mcli haproxy vip-manager pg_exporter nginx createrepo_c sshpass chrony dnsmasq docker-ce docker-compose-plugin flamegraph</li>
<li>lz4 unzip bzip2 zlib yum pv jq git ncdu make patch bash lsof wget uuid tuned perf nvme-cli numactl grubby sysstat iotop htop rsync tcpdump</li>
<li>netcat socat ftp lrzsz net-tools ipvsadm bind-utils telnet audit ca-certificates openssl openssh-clients readline vim-minimal</li>
<li>postgresql13* wal2json_13* pg_repack_13* passwordcheck_cracklib_13* postgresql12* wal2json_12* pg_repack_12* passwordcheck_cracklib_12* timescaledb-tools</li>
<li>postgresql15 postgresql15* citus_15* pglogical_15* wal2json_15* pg_repack_15* pgvector_15* timescaledb-2-postgresql-15* postgis33_15* passwordcheck_cracklib_15* pg_cron_15*</li>
<li>postgresql14 postgresql14* citus_14* pglogical_14* wal2json_14* pg_repack_14* pgvector_14* timescaledb-2-postgresql-14* postgis33_14* passwordcheck_cracklib_14* pg_cron_14*</li>
<li>postgresql16* wal2json_16* pgvector_16* pg_squeeze_16* postgis34_16* passwordcheck_cracklib_16* pg_cron_16*</li>
<li>patroni patroni-etcd pgbouncer pgbadger pgbackrest pgloader pg_activity pg_partman_15 pg_permissions_15 pgaudit17_15 pgexportdoc_15 pgimportdoc_15 pg_statement_rollback_15*</li>
<li>orafce_15* mysqlcompat_15 mongo_fdw_15* tds_fdw_15* mysql_fdw_15 hdfs_fdw_15 sqlite_fdw_15 pgbouncer_fdw_15 multicorn2_15* powa_15* pg_stat_kcache_15* pg_stat_monitor_15* pg_qualstats_15 pg_track_settings_15 pg_wait_sampling_15 system_stats_15</li>
<li>plprofiler_15* plproxy_15 plsh_15* pldebugger_15 plpgsql_check_15*  pgtt_15 pgq_15* pgsql_tweaks_15 count_distinct_15 hypopg_15 timestamp9_15* semver_15* prefix_15* rum_15 geoip_15 periods_15 ip4r_15 tdigest_15 hll_15 pgmp_15 extra_window_functions_15 topn_15</li>
<li>pg_background_15 e-maj_15 pg_catcheck_15 pg_prioritize_15 pgcopydb_15 pg_filedump_15 pgcryptokey_15 logerrors_15 pg_top_15 pg_comparator_15 pg_ivm_15* pgsodium_15* pgfincore_15* ddlx_15 credcheck_15 safeupdate_15 pg_squeeze_15* pg_fkpart_15 pg_jobmon_15</li>
</ul>
</li>
<li><code>repo_url_packages</code>:
<ul>
<li><a href="https://get.pigsty.cc/rpm/pev.html">https://get.pigsty.cc/rpm/pev.html</a></li>
<li><a href="https://get.pigsty.cc/rpm/chart.tgz">https://get.pigsty.cc/rpm/chart.tgz</a></li>
</ul>
</li>
<li><code>node_default_packages</code>:
<ul>
<li>lz4,unzip,bzip2,zlib,yum,pv,jq,git,ncdu,make,patch,bash,lsof,wget,uuid,tuned,nvme-cli,numactl,grubby,sysstat,iotop,htop,rsync,tcpdump</li>
<li>netcat,socat,ftp,lrzsz,net-tools,ipvsadm,bind-utils,telnet,audit,ca-certificates,openssl,readline,vim-minimal,node_exporter,etcd,haproxy,python3,python3-pip</li>
</ul>
</li>
<li><code>infra_packages</code>
<ul>
<li>grafana,loki,logcli,promtail,prometheus2,alertmanager,karma,pushgateway</li>
<li>node_exporter,blackbox_exporter,nginx_exporter,redis_exporter,pg_exporter</li>
<li>nginx,dnsmasq,ansible,postgresql15,redis,mcli,python3-requests</li>
</ul>
</li>
<li><code>PGSERVICE</code> in <code>.pigsty</code> 被移除了，取而代之的是 <code>PGDATABASE=postgres</code>，这用户只需 IP 地址就可以从管理节点访问特定实例。</li>
</ul>
<p>目录结构变化:</p>
<ul>
<li><code>bin/dns</code> and <code>bin/ssh</code> 现在被移动到 <code>vagrant/</code> 目录中。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.2.0.el7.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 5fb6a449a234e36c0d895a35c76add3c
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.2.0.el8.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> c7211730998d3b32671234e91f529fd0
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.2.0.el9.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 385432fe86ee0f8cbccbbc9454472fdd
</span></span></code></pre></div><hr>
<h2 id="v210">v2.1.0</h2>
<p>相关文章：<a href="https://mp.weixin.qq.com/s/Wu9kWEFSI3oGUr8t3hrz_w">Pigsty v2.1 发布：向量扩展 / PG12-16 支持</a></p>
<p>发布注记：https://github.com/Vonng/pigsty/releases/tag/v2.1.0</p>
<p><strong>Highlight</strong></p>
<ul>
<li>PostgreSQL 16 beta 支持, 以及 12 ~ 15 的支持.</li>
<li>为 PG 12 - 15 新增了 PGVector 扩展支持，用于存储 AI 嵌入。</li>
<li>为 Grafana 添加了额外6个默认的扩展面板/数据源插件。</li>
<li>添加 <code>bin/profile</code> 脚本用于执行远程 Profiling ，生成火焰图。</li>
<li>添加 <code>bin/validate</code> 用于校验 <code>pigsty.yml</code> 配置文件合法性。</li>
<li>添加 <code>bin/repo-add</code> 用于快速向节点添加软件源定义。</li>
<li>PostgreSQL 16 可观测性：添加了 <code>pg_stat_io</code> 支持与相关监控面板</li>
</ul>
<p><strong>软件升级</strong></p>
<ul>
<li>PostgreSQL 15.3 , 14.8, 13.11, 12.15, 11.20, and 16 beta1</li>
<li>pgBackRest 2.46 / pgbouncer 1.19</li>
<li>Redis 7.0.11</li>
<li>Grafana v9.5.3</li>
<li>Loki / Promtail / Logcli 2.8.2</li>
<li>Prometheus 2.44</li>
<li>TimescaleDB 2.11.0</li>
<li>minio-20230518000536 / mcli-20230518165900</li>
<li>Bytebase v2.2.0</li>
</ul>
<p><strong>改进增强</strong></p>
<ul>
<li>当添加本地用户的公钥时，所有的 <code>id*.pub</code> 都会被添加到远程机器上（例如椭圆曲线算法生成的密钥文件）</li>
</ul>
<hr>
<h2 id="v202">v2.0.2</h2>
<p><a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.2">https://github.com/Vonng/pigsty/releases/tag/v2.0.2</a></p>
<p><strong>亮点</strong></p>
<p>使用开箱即用的 <a href="https://github.com/pgvector/pgvector"><code>pgvector</code></a> 存储 AI Embedding、索引、检索向量。</p>
<ul>
<li>新扩展 <a href="https://github.com/Vonng/pigsty/issues/267"><code>pgvector</code></a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/265">MinIO CVE-2023-28432</a> 问题修复</li>
</ul>
<p><strong>变更</strong></p>
<ul>
<li>新扩展插件 <a href="https://github.com/Vonng/pigsty/issues/267"><code>pgvector</code></a> 用于存储 AI 嵌入，并执行向量相似度搜索。</li>
<li>修复 <a href="https://github.com/Vonng/pigsty/issues/265">MinIO CVE-2023-28432</a> ，使用 20230324 新提供的 policy API.</li>
<li>为 DNSMASQ systemd 服务添加动态重载命令</li>
<li>更新 PEV 版本至 v1.8</li>
<li>更新 grafana 版本至 v9.4.7</li>
<li>更新 MinIO 与 MCLI 版本至 20230324</li>
<li>更新 bytebase 版本至 v1.15.0</li>
<li>更新监控面板并修复死链接</li>
<li>更新了阿里云 Terraform 模板，默认使用 RockyLinux 9</li>
<li>使用 Grafana v9.4 的 Provisioning API</li>
<li>为众多管理任务添加了 asciinema 视频</li>
<li>修复了 EL8 PostgreSQL 的破损依赖：移除 anonymizer_15 faker_15 pgloader</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.2.el7.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> d46440a115d741386d29d6de646acfe2
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.2.el8.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 5fa268b5545ac96b40c444210157e1e1
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.2.el9.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> c8b113d57c769ee86a22579fc98e8345
</span></span></code></pre></div><hr>
<h2 id="v201">v2.0.1</h2>
<p><a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.1">https://github.com/Vonng/pigsty/releases/tag/v2.0.1</a></p>
<p>安全性改进，与对 <a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.0">v2.0.0</a> 的 BUG 修复。</p>
<p><strong>改进</strong></p>
<ul>
<li>更换猪头 logo 以符合 PostgreSQL 商标政策。</li>
<li>将 grafana 版本升级至 v9.4，界面更佳且修复了 bug。</li>
<li>将 patroni 版本升级至 v3.0.1，其中包含了一些 bug 修复。</li>
<li>修改：将 grafana systemd 服务文件回滚到 rpm 默认的版本。</li>
<li>使用缓慢的 <code>copy</code> 代替 <code>rsync</code> 来复制 grafana 仪表板，更加可靠。</li>
<li>增强：bootstrap 执行后会添加回默认 repo 文件。</li>
<li>添加 asciinema 视频，用于各种管理任务。</li>
<li>安全增强模式：限制监控用户权限。</li>
<li>新的配置模板：<code>dual.yml</code>，用于双节点部署。</li>
<li>在 <code>crit.yml</code> 模板中启用 <code>log_connections</code> 和 <code>log_disconnections</code>。</li>
<li>在 <code>crit.yml</code> 模板中的 <code>pg_libs</code> 中启用 <code>$lib/passwordcheck</code>。</li>
<li>明确授予 <code>pg_monitor</code> 角色监视视图权限。</li>
<li>从 <code>dbuser_monitor</code> 中移除默认的 <code>dbrole_readonly</code> 以限制监控用户的权限</li>
<li>现在 patroni 监听在 <code>{{ inventory_hostname }}</code> 而不是 <code>0.0.0.0</code></li>
<li>现在你可以使用 <code>pg_listen</code> 控制 postgres/pgbouncer 监听的地址</li>
<li>现在你可以在 <code>pg_listen</code> 中使用 <code>${ip}</code>, <code>${lo}</code>, <code>${vip}</code> 占位符</li>
<li>将 Aliyun terraform 镜像从 centos 7.9 提升到 rocky Linux 9</li>
<li>将 bytebase 版本升级到 v1.14.0</li>
</ul>
<p><strong>BUG修复</strong></p>
<ul>
<li>为 alertmanager 添加缺失的 advertise 地址。</li>
<li>解决使用 <code>bin/pgsql-user</code> 创建数据库用户时，<code>pg_mode</code> 变量缺失问题。</li>
<li>在 <code>redis.yml</code> 中为 Redis 集群加入任务添加 <code>-a password</code> 选项。</li>
<li>在 <code>infra-rm.yml</code>.<code>remove infra data</code> 任务中补充缺失的默认值。</li>
<li>修复 prometheus 监控对象定义文件的属主为 <code>prometheus</code> 用户。</li>
<li>使用 管理员用户 而不是 root 去删除 DCS 中的元数据。</li>
<li>修复了由 grafana 9.4 bug 导致的问题：Meta数据源缺失。</li>
</ul>
<p><strong>注意事项</strong></p>
<p>EL8 pgdg 上游官方源处于依赖破损状态，请小心使用。涉及到的软件包: <code>postgis33_15, pgloader, postgresql_anonymizer_15*, postgresql_faker_15</code></p>
<p><strong>如何升级？</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty<span style="color:#000;font-weight:bold">;</span> tar -zcf /tmp/files.tgz files<span style="color:#000;font-weight:bold">;</span> rm -rf ~/pigsty    <span style="color:#8f5902;font-style:italic"># backup files dir and remove</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~<span style="color:#000;font-weight:bold">;</span> bash -c <span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">$(</span>curl -fsSL https://get.pigsty.cc/latest<span style="color:#204a87;font-weight:bold">)</span><span style="color:#4e9a06">&#34;</span>      <span style="color:#8f5902;font-style:italic"># get latest pigsty source</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty<span style="color:#000;font-weight:bold">;</span> rm -rf files<span style="color:#000;font-weight:bold">;</span> tar -xf /tmp/files.tgz -C ~/pigsty  <span style="color:#8f5902;font-style:italic"># restore files dir</span>
</span></span></code></pre></div><p><strong>Checksums</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.1.el7.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 5cfbe98fd9706b9e0f15c1065971b3f6
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.1.el8.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> c34aa460925ae7548866bf51b8b8759c
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.1.el9.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 055057cebd93c473a67fb63bcde22d33
</span></span></code></pre></div><p>特别感谢 <a href="https://github.com/cocoonkid">@cocoonkid</a> 提供的反馈。</p>
<hr>
<h2 id="v200">v2.0.0</h2>
<p>相关文章：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/-E_-HZ7LvOze5lmzy3QbQA">更好的开源RDS替代：Pigsty</a></li>
<li><a href="https://mp.weixin.qq.com/s/WsR-c64OJfkMql7zX7XmDA">炮打 RDS，Pigsty v2.0 发布</a></li>
<li><a href="https://mp.weixin.qq.com/s/9lceZdyUZU9AzsqlAcpjTA">Pigsty v2 正式发布：更好的RDS PG开源替代</a></li>
<li><a href="https://mp.weixin.qq.com/s/g-ZPWqBwjzaxZKxyjVmFig">Pigsty 2.0 展望</a></li>
</ul>
<p>Pigsty <a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.0">v2.0.0</a> 正式发布！</p>
<p>从v2.0.0开始，PIGSTY 现在是 &ldquo;PostgreSQL In Great STYle&quot;的首字母缩写，即&quot;全盛状态的PostgreSQL&rdquo;。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL https://get.pigsty.cc/latest <span style="color:#000;font-weight:bold">|</span> bash
</span></span></code></pre></div><details><summary>Download directly from GitHub Release</summary>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bash -c <span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">$(</span>curl -fsSL https://raw.githubusercontent.com/Vonng/pigsty/master/bin/get<span style="color:#204a87;font-weight:bold">)</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># or download tarball directly with curl (EL9)</span>
</span></span><span style="display:flex;"><span>curl -L https://github.com/Vonng/pigsty/releases/download/v2.0.0/pigsty-v2.0.0.tgz -o ~/pigsty.tgz
</span></span><span style="display:flex;"><span>curl -L https://github.com/Vonng/pigsty/releases/download/v2.0.0/pigsty-pkg-v2.0.0.el9.x86_64.tgz  -o /tmp/pkg.tgz
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># EL7: https://github.com/Vonng/pigsty/releases/download/v2.0.0/pigsty-pkg-v2.0.0.el7.x86_64.tgz</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># EL8: https://github.com/Vonng/pigsty/releases/download/v2.0.0/pigsty-pkg-v2.0.0.el8.x86_64.tgz</span>
</span></span></code></pre></div></details>
<p><strong>亮点</strong></p>
<ul>
<li>完美整合 PostgreSQL 15, PostGIS 3.3, Citus 11.2, TimescaleDB 2.10，分布式地理时序超融合数据库。</li>
<li>OS兼容性大幅增强：支持 EL7，8，9，以及 RHEL, CentOS, Rocky, OracleLinux, AlmaLinux等兼容发行版。</li>
<li>安全性改进：自签名CA，全局网络流量SSL加密，密码scram-sha-256认证，备份采用AES加密，重制的HBA规则系统。</li>
<li>Patroni升级至3.0，提供原生的高可用 Citus 分布式集群支持，默认启用FailSafe模式，无惧DCS故障致全局主库瘫痪。</li>
<li>提供基于 pgBackRest 的开箱即用的时间点恢复 PITR 支持，默认支持本地文件系统与专用MinIO/S3集群备份。</li>
<li>新模块 <code>ETCD</code>，可独立部署，简易扩缩容，自带监控高可用，彻底取代 Consul 作为高可用 PG 的 DCS。</li>
<li>新模块 <code>MINIO</code>，可独立部署，支持多盘多节点部署，用作S3本地替代，亦用于集中式 PostgreSQL 备份仓库。</li>
<li>大幅精简配置文件参数，无需默认值即可使用；模板自动根据机器规格调整主机与PG参数，HBA/服务的定义更简洁泛用。</li>
<li>受 Grafana 与 MinIO 影响，软件协议由 Apache License 2.0 变更为 AGPL 3.0</li>
</ul>
<p><strong>兼容性</strong></p>
<ul>
<li>支持 EL7, EL8, EL9 三个大版本，并提供三个版本对应的离线软件包，默认开发测试环境由EL7升级至EL9。</li>
<li>支持更多EL兼容Linux发行版：RHEL, CentOS, RockyLinux, AlmaLinux, OracleLinux等…</li>
<li>源码包与离线软件包的命名规则发生改变，现在版本号，操作系统版本号，架构都会体现在包名中。</li>
<li><code>PGSQL</code>: PostgreSQL 15.2, PostGIS 3.3, Citus 11.2, TimescaleDB 2.10 现可同时使用，协同工作。</li>
<li><code>PGSQL</code>: Patroni 升级至 3.0 版本，作为 PGSQL 的高可用组件。
<ul>
<li>默认使用 ETCD 作为 DCS，取代 Consul，减少一个 Consul Agent 失效点。</li>
<li>因为 vip-manager 升级至 2.1 并使用 ETCDv3 API，彻底弃用 ETCDv2 API，Patroni同理</li>
<li>提供原生的高可用 Citus 分布式集群支持。使用完全开源所有功能的 Citus 11.2。</li>
<li>默认启用FailSafe模式，无惧DCS故障致全局主库瘫痪。</li>
</ul>
</li>
<li><code>PGSQL</code>: 引入 pgBackrest v2.44 提供开箱即用的 PostgreSQL 时间点恢复 PITR 功能
<ul>
<li>默认使用主库上的备份目录创建备份仓库，滚动保留两天的恢复窗口。</li>
<li>默认备选备份仓库为专用 MinIO/S3 集群，滚动保留两周的恢复窗口，本地使用需要启用 MinIO 模块。</li>
</ul>
</li>
<li><code>ETCD</code> 现在作为一个独立部署的模块，带有完整的扩容/缩容方案与监控。</li>
<li><code>MINIO</code> 现在成为一个独立部署的模块，支持多盘多节点部署，用作S3本地替代，亦可用作集中式备份仓库。</li>
<li><code>NODE</code> 模块现在包含 <code>haproxy</code>, <code>docker</code>, <code>node_exporter</code>, <code>promtail</code> 功能组件
<ul>
<li><code>chronyd</code> 现在取代 <code>ntpd</code> 成为所有节点默认的 NTP 服务。</li>
<li>HAPROXY 现从属于 <code>NODE</code> 的一部分，而不再是 <code>PGSQL</code> 专属，可以 NodePort 的方式对外暴露服务。</li>
<li>现在 <code>PGSQL</code> 模块可以使用专用的集中式 HAPROXY 集群统一对外提供服务。</li>
</ul>
</li>
<li><code>INFRA</code> 模块现在包含 <code>dnsmasq</code>, <code>nginx</code>, <code>prometheus</code>, <code>grafana</code>, <code>loki</code> 等组件
<ul>
<li>Infra 模块中的 DNSMASQ 服务器默认启用，并添加为所有节点的默认 DNS 服务器之一。</li>
<li>添加了 <code>blackbox_exporter</code> 用于主机 PING 探测，<code>pushgateway</code> 用于批处理任务指标。</li>
<li><code>loki</code> 与 <code>promtail</code> 现在使用 Grafana 默认的软件包，使用官方的 Grafana Echarts 面板插件</li>
<li>提供针对 PostgreSQL 15 的新增可观测性位点的监控支持，添加 Patroni 监控</li>
</ul>
</li>
<li>软件版本升级
<ul>
<li>PostgreSQL 15.2 / PostGIS 3.3 / TimescaleDB 2.10 / Citus 11.2</li>
<li>Patroni 3.0 / Pgbouncer 1.18 / pgBackRest 2.44 / vip-manager 2.1</li>
<li>HAProxy 2.7 / Etcd 3.5 / MinIO 20230131022419 / mcli 20230128202938</li>
<li>Prometheus 2.42 / Grafana 9.3 / Loki &amp; Promtail 2.7 / Node Exporter 1.5</li>
</ul>
</li>
</ul>
<p><strong>安全性</strong></p>
<ul>
<li>启用了一个完整的本地自签名CA：<code>pigsty-ca</code>，用于签发内网组件所使用的证书。</li>
<li>创建用户/修改密码的操作将不再会在日志文件中留下痕迹。</li>
<li>Nginx 默认启用 SSL 支持（如需HTTPS，您需要在系统中信任<code>pigsty-ca</code>，或使用Chrome <code>thisisunsafe</code>）</li>
<li>ETCD 全面启用 SSL 加密客户端与服务端对等通信</li>
<li>PostgreSQL 添加并默认启用了 SSL 支持，管理链接默认都使用SSL访问。</li>
<li>Pgbouncer 添加了 SSL 支持，出于性能考虑默认不启用。</li>
<li>Patroni 添加了 SSL 支持，并默认限制了管理 API 只能从本机与管理节点使用密码认证方可访问。</li>
<li>PostgreSQL 的默认密码认证方式由 <code>md5</code> 改为 <code>scram-sha-256</code>。</li>
<li>Pgbouncer添加了认证查询支持，可以动态管理连接池用户。</li>
<li>pgBackRest 使用远端集中备份存储仓库时，默认使用 <code>AES-256-CBC</code> 加密备份数据。</li>
<li>提供高安全等级配置模板：强制使用全局 SSL，并要求使用管理员证书登陆。</li>
<li>所有默认HBA规则现在全部在配置文件中显式定义。</li>
</ul>
<p><strong>可维护性</strong></p>
<ul>
<li>现有的配置模板可根据机器规格（CPU/内存/存储）自动调整优化。</li>
<li>现在可以动态配置 Postgres/Pgbouncer/Patroni/pgBackRest 的日志目录：默认为：<code>/pg/log/&lt;type&gt;/</code></li>
<li>原有的 IP 地址占位符 <code>10.10.10.10</code> 被替换为一个专用变量：<code>${admin_ip}</code>，可在多处引用，便于切换备用管理节点。</li>
<li>您可以指定 <code>region</code> 来使用不同地区的上游镜像源，以加快软件包的下载速度。</li>
<li>现在允许用户定义更细粒度的上游源地址，您可以根据不同的EL版本、架构，以及地区，使用不同的上游源。</li>
<li>提供了阿里云与AWS中国地区的 Terraform 模板，可用于一键拉起所需的 EC2 虚拟机。</li>
<li>提供了多种不同规格的 Vagrant 沙箱模板：<code>meta</code>, <code>full</code>, <code>el7/8/9</code>, <code>minio</code>, <code>build</code>, <code>citus</code></li>
<li>添加了新的专用剧本：<code>pgsql-monitor.yml</code> 用于监控现有的 Postgres 实例或 RDS。</li>
<li>添加了新的专用剧本：<code>pgsql-migration.yml</code> ，使用逻辑复制无缝迁移现有实例至 Pigsty管理的集群。</li>
<li>添加了一系列专用 Shell 实用命令，封装常见运维操作，方便用户使用。</li>
<li>优化了所有 Ansible Role 的实现，使其更加简洁、易读、易维护，无需默认参数即可使用。</li>
<li>允许在业务数据库/用户的层次上定义额外的 Pgbouncer 参数。</li>
</ul>
<p><strong>API变更</strong></p>
<p>Pigsty v2.0 进行了大量变更，新增64个参数，移除13个参数，重命名17个参数。</p>
<p><strong>新增的参数</strong></p>
<ul>
<li><code>INFRA</code>.<code>META</code>.<code>admin_ip</code> : 主元节点 IP 地址</li>
<li><code>INFRA</code>.<code>META</code>.<code>region</code> : 上游镜像区域：default|china|europe</li>
<li><code>INFRA</code>.<code>META</code>.<code>os_version</code> : 企业版 Linux 发行版本：7,8,9</li>
<li><code>INFRA</code>.<code>CA</code>.<code>ca_cn</code> : CA 通用名称，默认为 pigsty-ca</li>
<li><code>INFRA</code>.<code>CA</code>.<code>cert_validity</code> : 证书有效期，默认为 20 年</li>
<li><code>INFRA</code>.<code>REPO</code>.<code>repo_enabled</code> : 在 infra 节点上构建本地 yum 仓库吗？</li>
<li><code>INFRA</code>.<code>REPO</code>.<code>repo_upstream</code> : 上游 yum 仓库定义列表</li>
<li><code>INFRA</code>.<code>REPO</code>.<code>repo_home</code> : 本地 yum 仓库的主目录，通常与 nginx_home &lsquo;/www&rsquo; 相同</li>
<li><code>INFRA</code>.<code>NGINX</code>.<code>nginx_ssl_port</code> : https 监听端口</li>
<li><code>INFRA</code>.<code>NGINX</code>.<code>nginx_ssl_enabled</code> : 启用 nginx https 吗？</li>
<li><code>INFRA</code>.<code>PROMTETHEUS</code>.<code>alertmanager_endpoint</code> : altermanager 端点（ip|domain）：端口格式</li>
<li><code>NODE</code>.<code>NODE_TUNE</code>.<code>node_hugepage_ratio</code> : 内存 hugepage 比率，默认禁用，值为 0</li>
<li><code>NODE</code>.<code>HAPROXY</code>.<code>haproxy_service</code> : 要公开的 haproxy 服务列表</li>
<li><code>PGSQL</code>.<code>PG_ID</code>.<code>pg_mode</code> : pgsql 集群模式：pgsql,citus,gpsql</li>
<li><code>PGSQL</code>.<code>PG_BUSINESS</code>.<code>pg_dbsu_password</code> : dbsu 密码，默认为空字符串表示没有 dbsu 密码</li>
<li><code>PGSQL</code>.<code>PG_INSTALL</code>.<code>pg_log_dir</code> : postgres 日志目录，默认为 <code>/pg/data/log</code></li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_storage_type</code> : SSD|HDD，默认为 SSD</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_log_dir</code> : patroni 日志目录，默认为 <code>/pg/log</code></li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_ssl_enabled</code> : 使用 SSL 保护 patroni RestAPI 通信？</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_username</code> : patroni rest api 用户名</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_password</code> : patroni rest api 密码（重要：请更改此密码）</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_citus_db</code> : 由 patroni 管理的 citus 数据库，默认为 postgres</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_max_conn</code> : postgres 最大连接数，<code>auto</code> 将使用推荐值</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_shmem_ratio</code> : postgres 共享内存比率，默认为 0.25，范围 0.1~0.4</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_rto</code> : 恢复时间目标，故障转移的 ttl，默认为 30s</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_rpo</code> : 恢复点目标，默认最多丢失 1MB 数据</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_pwd_enc</code> : 密码加密算法：md5|scram-sha-256</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pgbouncer_log_dir</code> : pgbouncer 日志目录，默认为 <code>/var/log/pgbouncer</code></li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pgbouncer_auth_query</code> : 如果启用，查询 pg_authid 表以检索 biz 用户，而不是填充用户列表</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pgbouncer_sslmode</code> : pgbouncer 客户端的 SSL：disable|allow|prefer|require|verify-ca|verify-full</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_service_provider</code> : 专用的 haproxy 节点组名称，或者默认为本地节点的空字符串</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_default_service_dest</code> : 如果 svc.dest=&lsquo;default&rsquo;，则为默认服务目标</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_enabled</code> : 启用 pgbackrest 吗？</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_clean</code> : 初始化期间删除 pgbackrest 数据吗？</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_log_dir</code> : pgbackrest 日志目录，默认为 <code>/pg/log</code></li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_method</code> : pgbackrest 备份仓库方法，local 或 minio</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_repo</code> : pgbackrest 备份仓库配置</li>
<li><code>PGSQL</code>.<code>PG_DNS</code>.<code>pg_dns_suffix</code> : pgsql dns 后缀，默认为空字符串</li>
<li><code>PGSQL</code>.<code>PG_DNS</code>.<code>pg_dns_target</code> : auto, primary, vip, none 或 ad hoc ip</li>
<li><code>ETCD</code>.<code>etcd_seq</code> : etcd 实例标识符，必需</li>
<li><code>ETCD</code>.<code>etcd_cluster</code> : etcd 集群和组名称，默认为 etcd</li>
<li><code>ETCD</code>.<code>etcd_safeguard</code> : 防止清除正在运行的 etcd 实例吗？</li>
<li><code>ETCD</code>.<code>etcd_clean</code> : 在初始化期间清除现有的 etcd 吗？</li>
<li><code>ETCD</code>.<code>etcd_data</code> : etcd 数据目录，默认为 /data/etcd</li>
<li><code>ETCD</code>.<code>etcd_port</code> : etcd 客户端端口，默认为 2379</li>
<li><code>ETCD</code>.<code>etcd_peer_port</code> : etcd 对等端口，默认为 2380</li>
<li><code>ETCD</code>.<code>etcd_init</code> : etcd 初始集群状态，新建或已存在</li>
<li><code>ETCD</code>.<code>etcd_election_timeout</code> : etcd 选举超时，默认为 1000ms</li>
<li><code>ETCD</code>.<code>etcd_heartbeat_interval</code> : etcd 心跳间隔，默认为 100ms</li>
<li><code>MINIO</code>.<code>minio_seq</code> : minio 实例标识符，必须参数</li>
<li><code>MINIO</code>.<code>minio_cluster</code> : minio 集群名称，默认为 minio</li>
<li><code>MINIO</code>.<code>minio_clean</code> : 初始化时清理 minio 吗？默认为 false</li>
<li><code>MINIO</code>.<code>minio_user</code> : minio 操作系统用户，默认为 <code>minio</code></li>
<li><code>MINIO</code>.<code>minio_node</code> : minio 节点名模式</li>
<li><code>MINIO</code>.<code>minio_data</code> : minio 数据目录，使用 {x&hellip;y} 来指定多个驱动器</li>
<li><code>MINIO</code>.<code>minio_domain</code> : minio 外部域名，默认为 <code>sss.pigsty</code></li>
<li><code>MINIO</code>.<code>minio_port</code> : minio 服务端口，默认为 9000</li>
<li><code>MINIO</code>.<code>minio_admin_port</code> : minio 控制台端口，默认为 9001</li>
<li><code>MINIO</code>.<code>minio_access_key</code> : 根访问密钥，默认为 <code>minioadmin</code></li>
<li><code>MINIO</code>.<code>minio_secret_key</code> : 根秘密密钥，默认为 <code>minioadmin</code></li>
<li><code>MINIO</code>.<code>minio_extra_vars</code> : minio 服务器的额外环境变量</li>
<li><code>MINIO</code>.<code>minio_alias</code> : 本地 minio 部署的别名</li>
<li><code>MINIO</code>.<code>minio_buckets</code> : 待创建的 minio 存储桶列表</li>
<li><code>MINIO</code>.<code>minio_users</code> : 待创建的 minio 用户列表</li>
</ul>
<p><strong>移除的参数</strong></p>
<ul>
<li><code>INFRA</code>.<code>CA</code>.<code>ca_homedir</code> : CA 主目录，现在固定为 <code>/etc/pki/</code></li>
<li><code>INFRA</code>.<code>CA</code>.<code>ca_cert</code> : CA 证书文件名，现在固定为 <code>ca.key</code></li>
<li><code>INFRA</code>.<code>CA</code>.<code>ca_key</code> : CA 密钥文件名，现在固定为 <code>ca.key</code></li>
<li><code>INFRA</code>.<code>REPO</code>.<code>repo_upstreams</code> : 已被 <code>repo_upstream</code> 替代</li>
<li><code>PGSQL</code>.<code>PG_INSTALL</code>.<code>pgdg_repo</code> : 现在由节点 playbooks 负责</li>
<li><code>PGSQL</code>.<code>PG_INSTALL</code>.<code>pg_add_repo</code> : 现在由节点 playbooks 负责</li>
<li><code>PGSQL</code>.<code>PG_IDENTITY</code>.<code>pg_backup</code> : 未使用且与部分名称冲突</li>
<li><code>PGSQL</code>.<code>PG_IDENTITY</code>.<code>pg_preflight_skip</code> : 不再使用，由 <code>pg_id</code> 替代</li>
<li><code>DCS</code>.<code>dcs_name</code> : 由于使用 etcd 而被移除</li>
<li><code>DCS</code>.<code>dcs_servers</code> : 被 ad hoc 组 <code>etcd</code> 替代</li>
<li><code>DCS</code>.<code>dcs_registry</code> : 由于使用 etcd 而被移除</li>
<li><code>DCS</code>.<code>dcs_safeguard</code> : 被 <code>etcd_safeguard</code> 替代</li>
<li><code>DCS</code>.<code>dcs_clean</code> : 被 <code>etcd_clean</code> 替代</li>
</ul>
<p><strong>重命名的参数</strong></p>
<ul>
<li><code>nginx_upstream</code>            -&gt; <code>infra_portal</code></li>
<li><code>repo_address</code>              -&gt; <code>repo_endpoint</code></li>
<li><code>pg_hostname</code>               -&gt; <code>node_id_from_pg</code></li>
<li><code>pg_sindex</code>                 -&gt; <code>pg_group</code></li>
<li><code>pg_services</code>               -&gt; <code>pg_default_services</code></li>
<li><code>pg_services_extra</code>         -&gt; <code>pg_services</code></li>
<li><code>pg_hba_rules_extra</code>        -&gt; <code>pg_hba_rules</code></li>
<li><code>pg_hba_rules</code>              -&gt; <code>pg_default_hba_rules</code></li>
<li><code>pgbouncer_hba_rules_extra</code> -&gt; <code>pgb_hba_rules</code></li>
<li><code>pgbouncer_hba_rules</code>       -&gt; <code>pgb_default_hba_rules</code></li>
<li><code>vip_mode</code>                  -&gt; <code>pg_vip_enabled</code></li>
<li><code>vip_address</code>               -&gt; <code>pg_vip_address</code></li>
<li><code>vip_interface</code>             -&gt; <code>pg_vip_interface</code></li>
<li><code>node_packages_default</code>     -&gt; <code>node_default_packages</code></li>
<li><code>node_packages_meta</code>        -&gt; <code>infra_packages</code></li>
<li><code>node_packages_meta_pip</code>    -&gt; <code>infra_packages_pip</code></li>
<li><code>node_data_dir</code>             -&gt; <code>node_data</code></li>
</ul>
<p><strong>Checksums</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.0.0-rc1.el7.x86_64.tgz) = af4b5db9dc38c860de609956a8f1f0d3
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.0.0-rc1.el8.x86_64.tgz) = 5b7152e142df3e3cbc06de30bd70e433
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.0.0-rc1.el9.x86_64.tgz) = 1362e2a5680fc1a3a014cc4f304100bd
</span></span></code></pre></div><p>特别感谢意大利用户 @alemacci 在 SSL加密，备份，多操作系统发行版适配与自适应参数模版上的贡献！</p>
<hr>
<h2 id="v151">v1.5.1</h2>
<p><strong>亮点</strong></p>
<p>重要：修复了PG14.0-14.3中 <code>CREATE INDEX|REINDEX CONCURRENTLY</code> 可能导致索引数据损坏的问题。</p>
<p>Pigsty v1.5.1 升级默认PostgreSQL版本至 14.4 强烈建议尽快更新。</p>
<p><strong>软件升级</strong></p>
<ul>
<li>postgres 升级至 to 14.4</li>
<li>haproxy 升级至 to 2.6.0</li>
<li>grafana 升级至 to 9.0.0</li>
<li>prometheus 升级至 2.36.0</li>
<li>patroni 升级至 2.1.4</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>修复了<code>pgsql-migration.yml</code>中的TYPO</li>
<li>移除了HAProxy配置文件中的PID配置项</li>
<li>移除了默认软件包中的 i686 软件包</li>
<li>默认启用所有Systemd Redis Service</li>
<li>默认启用所有Systemd Patroni Service</li>
</ul>
<p><strong>API变更</strong></p>
<ul>
<li><code>grafana_database</code> 与 <code>grafana_pgurl</code> 被标记为过时API，将从后续版本移除</li>
</ul>
<p><strong>New Apps</strong></p>
<ul>
<li>wiki.js : 使用Postgres搭建本地维基百科</li>
<li>FerretDB ： 使用Postgres提供MongoDB API</li>
</ul>
<hr>
<h2 id="v150">v1.5.0</h2>
<p><strong>亮点概述</strong></p>
<ul>
<li>完善的Docker支持：在管理节点上默认启用并提供诸多开箱即用的软件模板：bytebase, pgadmin, pgweb, postgrest, minio等。</li>
<li>基础设施自我监控：Nginx， ETCD， Consul， Prometheus， Grafana， Loki 自我监控</li>
<li>CMDB升级：兼容性改善，支持Redis集群/Greenplum集群元数据，配置文件可视化。</li>
<li>服务发现改进：可以使用Consul自动发现所有待监控对象，并纳入Prometheus中。</li>
<li>更好的冷备份支持：默认定时备份任务，添加<code>pg_probackup</code>备份工具，一键创建延时从库。</li>
<li>ETCD现在可以用作PostgreSQL/Patroni的DCS服务，作为Consul的备选项。</li>
<li>Redis剧本/角色改善：现在允许对单个Redis实例，而非整个Redis节点进行初始化与移除。</li>
</ul>
<p><strong>详细变更列表</strong></p>
<p><strong>监控面板</strong></p>
<ul>
<li>CMDB Overview：可视化Pigsty CMDB Inventory。</li>
<li>DCS Overview：查阅Consul与ETCD集群的监控指标。</li>
<li>Nginx Overview：查阅Pigsty Web访问指标与访问日志。</li>
<li>Grafana Overview：Grafana自我监控</li>
<li>Prometheus Overview：Prometheus自我监控</li>
<li>INFRA Dashboard进行重制，反映基础设施整体状态</li>
</ul>
<p><strong>监控架构</strong></p>
<ul>
<li>现在允许使用 Consul 进行服务发现（当所有服务注册至Consul时）</li>
<li>现在所有的Infra组件会启用自我监控，并通过<code>infra_register</code>角色注册至Prometheus与Consul中。</li>
<li>指标收集器 pg_exporter 更新至 v0.5.0，添加新功能，<code>scale</code> 与 <code>default</code>，允许为指标指定一个倍乘因子，以及指定默认值。</li>
<li><code>pg_bgwriter</code>, <code>pg_wal</code>, <code>pg_query</code>, <code>pg_db</code>, <code>pgbouncer_stat</code> 关于时间的指标，单位由默认的毫秒或微秒统一缩放至秒。</li>
<li><code>pg_table</code> 中的相关计数器指标，现在配置有默认值 <code>0</code>，替代原有的<code>NaN</code>。</li>
<li><code>pg_class</code>指标收集器默认移除，相关指标添加至 <code>pg_table</code> 与 <code>pg_index</code> 收集器中。</li>
<li><code>pg_table_size</code> 指标收集器现在默认启用，默认设置有300秒的缓存时间。</li>
</ul>
<p><strong>部署方案</strong></p>
<ul>
<li>新增可选软件包 <code>docker.tgz</code>，带有常用应用镜像：Pgadmin, Pgweb, Postgrest, ByteBase, Kong, Minio等。</li>
<li>新增角色ETCD，可以在DCS Servers指定的节点上自动部署ETCD服务，并自动纳入监控。</li>
<li>允许通过 <code>pg_dcs_type</code> 指定PG高可用使用的DCS服务，Consul（默认），ETCD（备选）</li>
<li>允许通过 <code>node_crontab</code> 参数，为节点配置定时任务，例如数据库备份、VACUUM，统计收集等。</li>
<li>新增了 <code>pg_checksum</code>  选项，启用时，数据库集群将启用数据校验和（此前只有<code>crit</code>模板默认启用）</li>
<li>新增了<code>pg_delay</code>选项，当实例为Standby Cluster Leader时，此参数可以用于配置一个<strong>延迟从库</strong></li>
<li>新增了软件包 <code>pg_probackup</code>，默认角色<code>replicator</code>现在默认赋予了备份相关函数所需的权限。</li>
<li>Redis部署现在拆分为两个部分：Redis节点与Redis实例，通过<code>redis_port</code>参数可以精确控制一个具体实例。</li>
<li>Loki 与 Promtail 现在使用 <code>frpm</code> 制作的 RPM软件包进行安装。</li>
<li>DCS3配置模板现在使用一个3节点的<code>pg-meta</code>集群，与一个单节点的延迟从库。</li>
</ul>
<p><strong>软件升级</strong></p>
<ul>
<li>升级 PostgreSQL 至 14.3</li>
<li>升级 Redis 至 6.2.7</li>
<li>升级 PG Exporter 至 0.5.0</li>
<li>升级 Consul 至 1.12.0</li>
<li>升级 vip-manager 至 v1.0.2</li>
<li>升级 Grafana 至 v8.5.2</li>
<li>升级 Loki &amp; Promtail 至 v2.5.0，使用frpm打包。</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>修复了Loki 与 Promtail 默认配置文件名的问题</li>
<li>修复了Loki 与 Promtail 环境变量无法正确展开的问题</li>
<li>对英文文档进行了一次完整的翻译与修缮，文档依赖的JS资源现在直接从本地获取，无需互联网访问。</li>
</ul>
<p><strong>API变化</strong></p>
<p><strong>新参数</strong></p>
<ul>
<li><code>node_data_dir</code> : 主要的数据挂载路径，如果不存在会被创建。</li>
<li><code>node_crontab_overwrite</code> : 覆盖 <code>/etc/crontab</code> 而非追加内容。</li>
<li><code>node_crontab</code>: 要被追加或覆盖的 node crontab 内容。</li>
<li><code>nameserver_enabled</code>: 在这个基础设施节节点上启用 nameserver 吗？</li>
<li><code>prometheus_enabled</code>: 在这个基础设施节节点上启用 prometheus 吗？</li>
<li><code>grafana_enabled</code>: 在这个基础设施节节点上启用 grafana 吗？</li>
<li><code>loki_enabled</code>: 在这个基础设施节节点上启用 loki 吗？</li>
<li><code>docker_enable</code>: 在这个基础设施节点上启用 docker 吗？</li>
<li><code>consul_enable</code>: 启用 consul 服务器/代理吗？</li>
<li><code>etcd_enable</code>: 启用 etcd 服务器/客户端吗？</li>
<li><code>pg_checksum</code>: 启用 pg 集群数据校验和吗？</li>
<li><code>pg_delay</code>: 备份集群主库复制重放时的应用延迟。</li>
</ul>
<p><strong>参数重制</strong></p>
<p>现在 <code>*_clean</code> 是布尔类型的参数，用于在初始化期间清除现有实例。</p>
<p><code>*_safeguard</code> 也是布尔类型的参数，用于在执行任何剧本时，避免清除正在运行的实例。</p>
<ul>
<li><code>pg_exists_action</code> -&gt; <code>pg_clean</code></li>
<li><code>pg_disable_purge</code> -&gt; <code>pg_safeguard</code></li>
<li><code>dcs_exists_action</code> -&gt; <code>dcs_clean</code></li>
<li><code>dcs_disable_purge</code> -&gt; <code>dcs_safeguard</code></li>
</ul>
<p><strong>参数重命名</strong></p>
<ul>
<li><code>node_ntp_config</code> -&gt; <code>node_ntp_enabled</code></li>
<li><code>node_admin_setup</code> -&gt; <code>node_admin_enabled</code></li>
<li><code>node_admin_pks</code> -&gt; <code>node_admin_pk_list</code></li>
<li><code>node_dns_hosts</code> -&gt; <code>node_etc_hosts_default</code></li>
<li><code>node_dns_hosts_extra</code> -&gt; <code>node_etc_hosts</code></li>
<li><code>node_dns_server</code> -&gt; <code>node_dns_method</code></li>
<li><code>node_local_repo_url</code> -&gt; <code>node_repo_local_urls</code></li>
<li><code>node_packages</code> -&gt; <code>node_packages_default</code></li>
<li><code>node_extra_packages</code> -&gt; <code>node_packages</code></li>
<li><code>node_packages_meta</code> -&gt; <code>node_packages_meta</code></li>
<li><code>node_meta_pip_install</code> -&gt; <code>node_packages_meta_pip</code></li>
<li><code>node_sysctl_params</code> -&gt; <code>node_tune_params</code></li>
<li><code>app_list</code> -&gt; <code>nginx_indexes</code></li>
<li><code>grafana_plugin</code> -&gt; <code>grafana_plugin_method</code></li>
<li><code>grafana_cache</code> -&gt; <code>grafana_plugin_cache</code></li>
<li><code>grafana_plugins</code> -&gt; <code>grafana_plugin_list</code></li>
<li><code>grafana_git_plugin_git</code> -&gt; <code>grafana_plugin_git</code></li>
<li><code>haproxy_admin_auth_enabled</code> -&gt; <code>haproxy_auth_enabled</code></li>
<li><code>pg_shared_libraries</code> -&gt; <code>pg_libs</code></li>
<li><code>dcs_type</code> -&gt; <code>pg_dcs_type</code></li>
</ul>
<hr>
<h2 id="v141">v1.4.1</h2>
<p>日常错误修复 / Docker 支持 / 英文文档</p>
<p>现在，默认在元节点上启用 docker。您可以使用它启动海量的各类软件</p>
<p>现在提供英文文档。</p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/commit/68f8c8da0576e043686137aca47bad01dd4e82c0">将 docker 添加到默认包列表</a></li>
<li><a href="https://github.com/Vonng/pigsty/commit/765077744836d8600a8703dce8623182784d65a7">将 docker-compose 添加到默认包列表</a></li>
<li><a href="https://github.com/Vonng/pigsty/commit/9b8b7c5209d09049716318b624001de3b567452a">默认禁用 nameserver &amp; 默认启用 docker 角色</a></li>
</ul>
<p><strong>Bug 修复</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/commit/100f31842d473001f946200d9b8e2e3e89add35a">修复 promtail &amp; loki 配置变量问题</a></li>
<li>修复 grafana 旧版警报。</li>
<li>默认禁用 nameserver</li>
<li>为 patroni 快捷方式重命名 pg-alias.sh</li>
<li><a href="https://github.com/Vonng/pigsty/commit/62d74f15f8c164e5971d9d1d1215869359267b53">为所有仪表板禁用 exemplars 查询</a></li>
<li><a href="https://github.com/Vonng/pigsty/commit/b277f488b7ed0fd0a7eeeb995e2efd75a048e0ef">修复 loki 数据目录问题</a> <a href="https://github.com/Vonng/pigsty/issues/100">https://github.com/Vonng/pigsty/issues/100</a></li>
<li><a href="https://github.com/Vonng/pigsty/commit/1690b490205af24d5f0394aba99007c0d9ebc49d">将 autovacuum_freeze_max_age 从 100000000 更改为 1000000000</a></li>
</ul>
<hr>
<h2 id="v140">v1.4.0</h2>
<p><strong>架构</strong></p>
<ul>
<li>将系统解耦为4大类别：<code>INFRA</code>、<code>NODES</code>、<code>PGSQL</code>、<code>REDIS</code>，这使得pigsty更加清晰、更易于扩展。</li>
<li>单节点部署 = <code>INFRA</code> + <code>NODES</code> + <code>PGSQL</code></li>
<li>部署pgsql集群 = <code>NODES</code> + <code>PGSQL</code></li>
<li>部署redis集群 = <code>NODES</code> + <code>REDIS</code></li>
<li>部署其他数据库 = <code>NODES</code> + xxx（例如 <code>MONGO</code>、<code>KAFKA</code>&hellip;待定）</li>
</ul>
<p><strong>可访问性</strong></p>
<ul>
<li>为中国大陆提供CDN。</li>
<li>使用 <code>bash -c &quot;$(curl -fsSL http://get.pigsty.cc/latest)&quot;</code> 获取最新源代码。</li>
<li>使用新的 <code>download</code> 脚本下载并提取包。</li>
</ul>
<p><strong>监控增强</strong></p>
<ul>
<li>将监控系统分为5大类别：<code>INFRA</code>、<code>NODES</code>、<code>REDIS</code>、<code>PGSQL</code>、<code>APP</code></li>
<li>默认启用日志记录
<ul>
<li>现在默认启用<code>loki</code>和<code>promtail</code>，带有预构建的 <a href="https://github.com/Vonng/loki-rpm">loki-rpm</a>。</li>
</ul>
</li>
<li>模型和标签
<ul>
<li>为所有仪表板添加了一个隐藏的<code>ds</code> prometheus数据源变量，因此您只需选择一个新的数据源而不是修改Grafana数据源和仪表板。</li>
<li>为所有指标添加了一个<code>ip</code>标签，并将其用作数据库指标和节点指标之间的连接键。</li>
</ul>
</li>
<li>INFRA监控
<ul>
<li>Infra主仪表板：INFRA概览</li>
<li>添加日志仪表板：日志实例</li>
<li>PGLOG分析和PGLOG会话现在被视为一个示例Pigsty APP。</li>
</ul>
</li>
<li>NODES监控应用
<ul>
<li>如果您完全不关心数据库，现在可以单独使用Pigsty作为主机监控软件！</li>
<li>包括4个核心仪表板：节点概览 &amp; 节点集群 &amp; 节点实例 &amp; 节点警报</li>
<li>为节点引入新的身份变量：<code>node_cluster</code> 和 <code>nodename</code></li>
<li>变量<code>pg_hostname</code>现在意味着将主机名设置为与postgres实例名相同，以保持向后兼容性</li>
<li>变量<code>nodename_overwrite</code> 控制是否用nodename覆盖节点的主机名</li>
<li>变量<code>nodename_exchange</code> 将nodename写入彼此的<code>/etc/hosts</code></li>
<li>所有节点指标引用都经过修订，通过<code>ip</code>连接</li>
<li>节点监控目标在<code>/etc/prometheus/targets/nodes</code>下单独管理</li>
</ul>
</li>
<li>PGSQL监控增强
<ul>
<li>完全新的PGSQL集群，简化并专注于集群中的重要内容。</li>
<li>新仪表板PGSQL数据库是集群级对象监控。例如整个集群而不是单个实例的表和查询。</li>
<li>PGSQL警报仪表板现在只关注pgsql警报。</li>
<li>PGSQL Shard已添加到PGSQL中。</li>
</ul>
</li>
<li>Redis监控增强
<ul>
<li>为所有redis仪表板添加节点监控。</li>
</ul>
</li>
</ul>
<p><strong>MatrixDB支持</strong></p>
<ul>
<li>通过<code>pigsty-matrix.yml</code> playbook可以部署MatrixDB（Greenplum 7）</li>
<li>MatrixDB监控仪表板：PGSQL MatrixDB</li>
<li>添加示例配置：<code>pigsty-mxdb.yml</code></li>
</ul>
<p><strong>监控增强</strong></p>
<ul>
<li>将监控系统分为5大类别：<code>INFRA</code>、<code>NODES</code>、<code>REDIS</code>、<code>PGSQL</code>、<code>APP</code></li>
<li>默认启用日志记录
<ul>
<li>现在默认启用<code>loki</code>和<code>promtail</code>，带有预构建的 <a href="https://github.com/Vonng/loki-rpm">loki-rpm</a>。</li>
</ul>
</li>
<li>模型和标签
<ul>
<li>为所有仪表板添加了一个隐藏的<code>ds</code> prometheus数据源变量，因此您只需选择一个新的数据源而不是修改Grafana数据源和仪表板。</li>
<li>为所有指标添加了一个<code>ip</code>标签，并将其用作数据库指标和节点指标之间的连接键。</li>
</ul>
</li>
<li>INFRA监控
<ul>
<li>Infra主仪表板：INFRA概览</li>
<li>添加日志仪表板：日志实例</li>
<li>PGLOG分析和PGLOG会话现在被视为一个示例Pigsty APP。</li>
</ul>
</li>
<li>NODES监控应用
<ul>
<li>如果您完全不关心数据库，现在可以单独使用Pigsty作为主机监控软件！</li>
<li>包括4个核心仪表板：节点概览 &amp; 节点集群 &amp; 节点实例 &amp; 节点警报</li>
<li>为节点引入新的身份变量：<code>node_cluster</code> 和 <code>nodename</code></li>
<li>变量<code>pg_hostname</code>现在意味着将主机名设置为与postgres实例名相同，以保持向后兼容性</li>
<li>变量<code>nodename_overwrite</code> 控制是否用nodename覆盖节点的主机名</li>
<li>变量<code>nodename_exchange</code> 将nodename写入彼此的<code>/etc/hosts</code></li>
<li>所有节点指标引用都经过修订，通过<code>ip</code>连接</li>
<li>节点监控目标在<code>/etc/prometheus/targets/nodes</code>下单独管理</li>
</ul>
</li>
<li>PGSQL监控增强
<ul>
<li>完全新的PGSQL集群，简化并专注于集群中的重要内容。</li>
<li>新仪表板PGSQL数据库是集群级对象监控。例如整个集群而不是单个实例的表和查询。</li>
<li>PGSQL警报仪表板现在只关注pgsql警报。</li>
<li>PGSQL Shard已添加到PGSQL中。</li>
</ul>
</li>
<li>Redis监控增强
<ul>
<li>为所有redis仪表板添加节点监控。</li>
</ul>
</li>
</ul>
<p><strong>MatrixDB支持</strong></p>
<ul>
<li>通过<code>pigsty-matrix.yml</code> playbook可以部署MatrixDB（Greenplum 7）</li>
<li>MatrixDB监控仪表板：PGSQL MatrixDB</li>
<li>添加示例配置：<code>pigsty-mxdb.yml</code></li>
</ul>
<p><strong>置备改进</strong></p>
<p>现在 pigsty 的工作流如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span> <span style="color:#000">infra</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span> <span style="color:#ce5c00;font-weight:bold">---&gt;</span> <span style="color:#a40000">在单一的元节点上安装</span> <span style="color:#000">pigsty</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ce5c00;font-weight:bold">|</span>          <span style="color:#a40000">然后将更多节点加入</span> <span style="color:#000">pigsty</span> <span style="color:#a40000">的管理下</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ce5c00;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span> <span style="color:#000">nodes</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span> <span style="color:#ce5c00;font-weight:bold">---&gt;</span> <span style="color:#a40000">为</span> <span style="color:#000">pigsty</span> <span style="color:#a40000">准备节点（节点设置、</span><span style="color:#000">dcs</span><span style="color:#a40000">、</span><span style="color:#000">node_exporter</span><span style="color:#a40000">、</span><span style="color:#000">promtail</span><span style="color:#a40000">）</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ce5c00;font-weight:bold">|</span>          <span style="color:#a40000">然后选择一个</span> <span style="color:#000">playbook</span> <span style="color:#a40000">在这些节点上部署数据库集群</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ce5c00;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ce5c00;font-weight:bold">^--&gt;</span> <span style="color:#000">pgsql</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span>   <span style="color:#a40000">在已准备好的节点上安装</span> <span style="color:#000">postgres</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ce5c00;font-weight:bold">^--&gt;</span> <span style="color:#000">redis</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span>   <span style="color:#a40000">在已准备好的节点上安装</span> <span style="color:#000">redis</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">infra</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">demo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span> <span style="color:#ce5c00;font-weight:bold">=</span> 
</span></span><span style="display:flex;"><span>           <span style="color:#000">infra</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">l</span> <span style="color:#000">meta</span>     <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>           <span style="color:#000">nodes</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">l</span> <span style="color:#000">pg</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">test</span>  <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>           <span style="color:#000">pgsql</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">l</span> <span style="color:#000">pg</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">test</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>           <span style="color:#000">infra</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">loki</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">infra</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">jupyter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">infra</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">pgweb</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">yml</span>
</span></span></code></pre></div><ul>
<li><code>nodes.yml</code>：用于设置和准备 pigsty 的节点，</li>
<li>在节点上设置 node、node_exporter、consul agent</li>
<li><code>node-remove.yml</code> 用于节点注销</li>
<li><code>pgsql.yml</code>：现在只在已准备好的节点上工作</li>
<li><code>pgsql-remove</code> 现在只负责 postgres 本身（dcs 和节点监控由 <code>node.yml</code> 负责）</li>
<li>添加一系列新选项以在 greenplum/matrixdb 中重用 <code>postgres</code> 角色</li>
<li><code>redis.yml</code>：现在在已准备好的节点上工作</li>
<li>而 <code>redis-remove.yml</code> 现在从节点上移除 redis。</li>
<li><code>pgsql-matrix.yml</code> 现在在已准备好的节点上安装 matrixdb（Greenplum 7）。</li>
</ul>
<p><strong>软件升级</strong></p>
<ul>
<li>PostgreSQL 14.2</li>
<li>PostGIS 3.2</li>
<li>TimescaleDB 2.6</li>
<li>Patroni 2.1.3 (Prometheus 指标 + 故障转移插槽)</li>
<li>HAProxy 2.5.5 (修复统计错误，更多指标)</li>
<li>PG 导出器 0.4.1 (超时参数等)</li>
<li>Grafana 8.4.4</li>
<li>Prometheus 2.33.4</li>
<li>Greenplum 6.19.4 / MatrixDB 4.4.0</li>
<li>Loki 现在作为 rpm 包提供，而不是 zip 存档。</li>
</ul>
<p><strong>错误修复</strong></p>
<ul>
<li>删除 patroni 的 consul 依赖，这使其更容易迁移到新的 consul 集群</li>
<li>修复 prometheus bin/new 脚本的默认数据目录路径：从 <code>/export/prometheus</code> 更改为 <code>/data/prometheus</code></li>
<li>在 vip-manager systemd 服务中添加重新启动秒数</li>
<li>修复错别字和任务</li>
</ul>
<p><strong>API 变更</strong></p>
<p><strong>新增变量</strong></p>
<ul>
<li><code>node_cluster</code>：节点集群的身份变量</li>
<li><code>nodename_overwrite</code>：如果设置，则 nodename 将设置为节点的主机名</li>
<li><code>nodename_exchange</code>：交换 play 主机之间的节点主机名（在 <code>/etc/hosts</code> 中）</li>
<li><code>node_dns_hosts_extra</code>：可以通过单个实例/集群轻松覆盖的额外静态 dns 记录</li>
<li><code>patroni_enabled</code>：如果禁用，postgres &amp; patroni 的引导过程不会在 <code>postgres</code> 角色期间执行</li>
<li><code>pgbouncer_enabled</code>：如果禁用，pgbouncer 在 <code>postgres</code> 角色期间不会启动</li>
<li><code>pg_exporter_params</code>：生成监控目标 url 时为 pg_exporter 提供的额外 url 参数。</li>
<li><code>pg_provision</code>：布尔值变量，表示是否执行 <code>postgres</code> 角色的资源配置部分（模板，数据库，用户）</li>
<li><code>no_cmdb</code>：用于 <code>infra.yml</code> 和 <code>infra-demo.yml</code> 播放书，不会在元节点上创建 cmdb。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>MD5 (app.tgz) = f887313767982b31a2b094e5589a75ea
</span></span><span style="display:flex;"><span>MD5 (matrix.tgz) = 3d063437c482d94bd7e35df1a08bbc84
</span></span><span style="display:flex;"><span>MD5 (pigsty.tgz) = e143b88ebea1474f9ebaffddc6072c49
</span></span><span style="display:flex;"><span>MD5 (pkg.tgz) = 73e8f5ce995b1f1760cb63c1904fb91b
</span></span></code></pre></div><hr>
<h2 id="v131">v1.3.1</h2>
<p><strong>监控</strong></p>
<ul>
<li>PGSQL &amp; PGCAT 仪表盘改进</li>
<li>优化 pgcat 实例 &amp; pgcat 数据库的布局</li>
<li>在 pgsql 实例仪表盘中添加关键指标面板，与 pgsql 集群保持一致</li>
<li>在 pgcat 数据库中添加表/索引膨胀面板，移除 pgcat 膨胀仪表盘</li>
<li>在 pgcat 数据库仪表盘中添加索引信息</li>
<li>修复在 grafana 8.3 中的损坏面板</li>
<li>在 nginx 主页中添加 redis 索引</li>
</ul>
<p><strong>部署</strong></p>
<ul>
<li>新的 <code>infra-demo.yml</code> 剧本用于一次性引导</li>
<li>使用 <code>infra-jupyter.yml</code> 剧本部署可选的 jupyter lab 服务器</li>
<li>使用 <code>infra-pgweb.yml</code> 剧本部署可选的 pgweb 服务器</li>
<li>在 meta 节点上新的 <code>pg</code> 别名，可以从 admin 用户启动 postgres 集群（除了 postgres）</li>
<li>根据 <code>timescaledb-tune</code> 的建议调整所有 patroni 配置模板中的 <code>max_locks_per_transactions</code></li>
<li>在配置模板中添加 <code>citus.node_conninfo: 'sslmode=prefer'</code> 以便在没有 SSL 的情况下使用 citus</li>
<li>在 pgdg14 包列表中添加所有扩展（除了 pgrouting）</li>
<li>将 node_exporter 升级到 v1.3.1</li>
<li>将 PostgREST v9.0.0 添加到包列表。从 postgres 模式生成 API。</li>
</ul>
<p><strong>错误修复</strong></p>
<ul>
<li>Grafana 的安全漏洞（升级到 v8.3.1 <a href="https://grafana.com/blog/2021/12/07/grafana-8.3.1-8.2.7-8.1.8-and-8.0.7-released-with-high-severity-security-fix/">问题</a>)</li>
<li>修复 <code>pg_instance</code> &amp; <code>pg_service</code> 在 <code>register</code> 角色中从剧本的中间开始时的问题</li>
<li>修复在没有 <code>pg_cluster</code> 变量存在的主机上 nginx 主页渲染问题</li>
<li>在升级到 grafana 8.3.1 时修复样式问题</li>
</ul>
<hr>
<h2 id="v130">v1.3.0</h2>
<ul>
<li>【功能增强】Redis 部署（集群、哨兵、主从）</li>
<li>【功能增强】Redis 监控
<ul>
<li>Redis 总览仪表盘</li>
<li>Redis 集群仪表盘</li>
<li>Redis 实例仪表盘
-【功能增强】 监控：PGCAT 大修</li>
<li>新仪表盘：PGCAT 实例</li>
<li>新仪表盘：PGCAT 数据库仪表盘</li>
<li>重做仪表盘：PGCAT 表格</li>
</ul>
</li>
<li>【功能增强】 监控：PGSQL 增强
<ul>
<li>新面板：PGSQL 集群，添加 10 个关键指标面板（默认切换）</li>
<li>新面板：PGSQL 实例，添加 10 个关键指标面板（默认切换）</li>
<li>简化 &amp; 重新设计：PGSQL 服务</li>
<li>在 PGCAT &amp; PGSL 仪表盘之间添加交叉引用
-【功能增强】 监控部署</li>
<li>现在 grafana 数据源在仅监控部署期间自动注册
-【功能增强】 软件升级</li>
<li>将 PostgreSQL 13 添加到默认包列表</li>
<li>默认升级到 PostgreSQL 14.1</li>
<li>添加 greenplum rpm 和依赖项</li>
<li>添加 redis rpm &amp; 源代码包</li>
<li>将 perf 添加为默认包</li>
</ul>
</li>
</ul>
<hr>
<h2 id="v120">v1.2.0</h2>
<ul>
<li>【功能增强】默认使用 PostgreSQL 14 版本</li>
<li>【功能增强】默认使用 TimescaleDB 2.5 扩展
<ul>
<li>现在 timescaledb 和 postgis 默认在 cmdb 中启用</li>
</ul>
</li>
<li>【功能增强】 新增仅监控模式：
<ul>
<li>仅通过可连接的 URL，您可以使用 pigsty 监控现有的 pg 实例</li>
<li>pg_exporter 将在本地的 meta 节点上部署</li>
<li>新仪表板 PGSQL Cluster Monly 用于远程集群</li>
</ul>
</li>
<li>【功能增强】软件升级
<ul>
<li>grafana 升级到 8.2.2</li>
<li>pev2 升级到 v0.11.9</li>
<li>promscale 升级到 0.6.2</li>
<li>pgweb 升级到 0.11.9</li>
<li>新增扩展：pglogical、pg_stat_monitor、orafce
-【功能增强】自动检测机器规格并使用适当的 <code>node_tune</code> 和 <code>pg_conf</code> 模板
-【功能增强】重做与膨胀相关的视图，现在公开更多信息
-【功能增强】删除 timescale 和 citus 的内部监控
-【功能增强】新剧本 <code>pgsql-audit.yml</code> 用于创建审计报告
-【BUG修复】现在 pgbouncer_exporter 资源所有者是 {{ pg_dbsu }} 而不是 postgres
-【BUG修复】 修复在执行 <code>REINDEX TABLE CONCURRENTLY</code> 时 pg_exporter 在 pg_table pg_index 上的重复指标
-【功能增强】现在所有配置模板都减少到两个：auto 和 demo。(已删除：<code>pub4, pg14, demo4, tiny, oltp</code>)</li>
<li>如果 <code>vagrant</code> 是默认用户，则配置 <code>pigsty-demo</code>，否则使用 <code>pigsty-auto</code>。</li>
</ul>
</li>
</ul>
<p><strong>如何从 v1.1.1 升级</strong></p>
<p>在 1.2.0 中没有 API 变更。您仍然可以使用旧的 <code>pigsty.yml</code> 配置文件 (PG13)。
对于基础设施部分，重新执行 <code>repo</code> 将完成大部分工作。</p>
<p>至于数据库，您仍然可以使用现有的 PG13 实例。就地升级在涉及到像 PostGIS 和 Timescale 这样的扩展时非常棘手。我强烈推荐使用逻辑复制进行数据库迁移。
新的剧本 <code>pgsql-migration.yml</code> 将使这一过程变得容易得多。它将创建一系列的脚本，帮助您近乎零停机时间地迁移您的集群。</p>
<hr>
<h2 id="v111">v1.1.1</h2>
<ul>
<li>【功能增强】 用 <code>timescale</code> 版本替换 timescaledb 的 <code>apache</code> 版本</li>
<li>【功能增强】 升级 prometheus 到 2.30</li>
<li>【BUG修复】 现在 pg_exporter 配置目录的属主是 <code>{{ pg_dbsu }}</code>，而不再是 <code>prometheus</code></li>
</ul>
<p><strong>如何从v1.1.0升级？</strong></p>
<p>这个版本的主要变动是 TimescaleDB，使用 TimescaleDB License （TSL）的官方版本替代了 PGDG 仓库中的 Apache License v2 的版本。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>stop/pause postgres instance with timescaledb
</span></span><span style="display:flex;"><span>yum remove -y timescaledb_13
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>timescale_timescaledb<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">=</span>timescale_timescaledb
</span></span><span style="display:flex;"><span><span style="color:#000">baseurl</span><span style="color:#ce5c00;font-weight:bold">=</span>https://packagecloud.io/timescale/timescaledb/el/7/<span style="color:#000">$basearch</span>
</span></span><span style="display:flex;"><span><span style="color:#000">repo_gpgcheck</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gpgcheck</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span><span style="color:#000">enabled</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>yum install timescaledb-2-postgresql13 
</span></span></code></pre></div><hr>
<h2 id="v110">v1.1.0</h2>
<ul>
<li>【增强功能】 增加 <code>pg_dummy_filesize</code> 以创建文件系统空间占位符</li>
<li>【增强功能】 主页大改版</li>
<li>【增强功能】 增加 Jupyter Lab 整合</li>
<li>【增强功能】 增加 pgweb 控制台整合</li>
<li>【增强功能】 增加 pgbadger 支持</li>
<li>【增强功能】 增加 pev2 支持，解释可视化工具</li>
<li>【增强功能】 增加 pglog 工具</li>
<li>【增强功能】 更新默认的 pkg.tgz 软件版本：
<ul>
<li>PostgreSQL 升级至 v13.4（支持官方的 pg14）</li>
<li>pgbouncer 升级至 v1.16（指标定义更新）</li>
<li>Grafana 升级至 v8.1.4</li>
<li>Prometheus 升级至 v2.2.29</li>
<li>node_exporter 升级至 v1.2.2</li>
<li>haproxy 升级至 v2.1.1</li>
<li>consul 升级至 v1.10.2</li>
<li>vip-manager 升级至 v1.0.1</li>
</ul>
</li>
</ul>
<p><strong>API 变更</strong></p>
<ul>
<li><code>nginx_upstream</code> 现在持有不同的结构。（不兼容）</li>
<li>新的配置条目：<code>app_list</code>，渲染至主页的导航条目</li>
<li>新的配置条目：<code>docs_enabled</code>，在默认服务器上设置本地文档</li>
<li>新的配置条目：<code>pev2_enabled</code>，设置本地的 pev2 工具</li>
<li>新的配置条目：<code>pgbadger_enabled</code>，创建日志概要/报告目录</li>
<li>新的配置条目：<code>jupyter_enabled</code>，在元节点上启用 Jupyter Lab 服务器</li>
<li>新的配置条目：<code>jupyter_username</code>，指定运行 Jupyter Lab 的用户</li>
<li>新的配置条目：<code>jupyter_password</code>，指定 Jupyter Lab 的默认密码</li>
<li>新的配置条目：<code>pgweb_enabled</code>，在元节点上启用 pgweb 服务器</li>
<li>新的配置条目：<code>pgweb_username</code>，指定运行 pgweb 的用户</li>
<li>将内部标记 <code>repo_exist</code> 重命名为 <code>repo_exists</code></li>
<li>现在 <code>repo_address</code> 的默认值为 <code>pigsty</code> 而非 <code>yum.pigsty</code></li>
<li>现在 haproxy 的访问点为 <code>http://pigsty</code> 而非 <code>http://h.pigsty</code></li>
</ul>
<hr>
<h2 id="v101">v1.0.1</h2>
<p>2021-09-14</p>
<ul>
<li>文档更新
<ul>
<li>现已支持中文文档</li>
<li>现已支持机器翻译的英文文档</li>
</ul>
</li>
<li>错误修复：<code>pgsql-remove</code> 不会移除主实例</li>
<li>错误修复：用 pg_cluster + pg_seq 替换 pg_instance
<ul>
<li>Start-At-Task 可能因为 pg_instance 未定义而失败</li>
</ul>
</li>
<li>错误修复：从默认共享预加载库中移除 citus
<ul>
<li>citus 会强制 max_prepared_transaction 的值为非零</li>
</ul>
</li>
<li>错误修复：在 <code>configure</code> 中进行 ssh sudo 检查：
<ul>
<li>现在使用 <code>ssh -t sudo -n ls</code> 进行权限检查</li>
</ul>
</li>
<li>笔误修复：<code>pg-backup</code> 脚本的笔误</li>
<li>警报调整：移除 NTP 合理性检查警报（与 ClockSkew 重复）</li>
<li>导出器调整：移除 collector.systemd 以减少开销</li>
</ul>
<hr>
<h2 id="v100">v1.0.0</h2>
<p>v1 正式发布，监控系统全面改进</p>
<p><strong>亮点</strong></p>
<ul>
<li>监控系统全面改进
<ul>
<li>在 Grafana 8.0 上新增仪表盘</li>
<li>新的度量定义，增加 PG14 支持</li>
<li>简化的标签系统：静态标签集：(job, cls, ins)</li>
<li>新的警报规则与衍生度量</li>
<li>同时监控多个数据库</li>
<li>实时日志搜索 &amp; csvlog 分析</li>
<li>链接丰富的仪表盘，点击图形元素进行深入|汇总</li>
</ul>
</li>
<li>架构变更
<ul>
<li>将 citus 和 timescaledb 加入默认安装部分</li>
<li>增加对 PostgreSQL 14beta2 的支持</li>
<li>简化 haproxy 管理页面索引</li>
<li>通过添加新的角色 <code>register</code> 来解耦基础设施和 pgsql</li>
<li>添加新角色 <code>loki</code> 和 <code>promtail</code> 用于日志记录</li>
<li>为管理员节点上的管理员用户添加新角色 <code>environ</code> 以设置环境</li>
<li>默认使用 <code>static</code> 服务发现用于 prometheus（而不是 <code>consul</code>）</li>
<li>添加新角色 <code>remove</code> 以优雅地移除集群和实例</li>
<li>升级 prometheus 和 grafana 的配置逻辑</li>
<li>升级到 vip-manager 1.0，node_exporter 1.2，pg_exporter 0.4，grafana 8.0</li>
<li>现在，每个实例上的每个数据库都可以自动注册为 grafana 数据源</li>
<li>将 consul 注册任务移到 <code>register</code> 角色，更改 consul 服务标签</li>
<li>添加 cmdb.sql 作为 pg-meta 基线定义（CMDB &amp; PGLOG）</li>
</ul>
</li>
<li>应用框架
<ul>
<li>可扩展框架用于新功能</li>
<li>核心应用：PostgreSQL 监控系统：<code>pgsql</code></li>
<li>核心应用：PostgreSQL 目录浏览器：<code>pgcat</code></li>
<li>核心应用：PostgreSQL Csvlog 分析器：<code>pglog</code></li>
<li>添加示例应用 <code>covid</code> 用于可视化 covid-19 数据</li>
<li>添加示例应用 <code>isd</code> 用于可视化 isd 数据</li>
</ul>
</li>
<li>其他
<ul>
<li>添加 jupyterlab，为数据科学提供完整的 python 环境</li>
<li>添加 <code>vonng-echarts-panel</code> 以恢复对 Echarts 的支持</li>
<li>添加 wrap 脚本 <code>createpg</code>，<code>createdb</code>，<code>createuser</code></li>
<li>添加 cmdb 动态库存脚本：<code>load_conf.py</code>，<code>inventory_cmdb</code>，<code>inventory_conf</code></li>
<li>移除过时的剧本：<code>pgsql-monitor</code>，<code>pgsql-service</code>，<code>node-remove</code> 等&hellip;.</li>
</ul>
</li>
</ul>
<p><strong>API 变更</strong></p>
<ul>
<li>新变量: <code>node_meta_pip_install</code></li>
<li>新变量: <code>grafana_admin_username</code></li>
<li>新变量: <code>grafana_database</code></li>
<li>新变量: <code>grafana_pgurl</code></li>
<li>新变量: <code>pg_shared_libraries</code></li>
<li>新变量: <code>pg_exporter_auto_discovery</code></li>
<li>新变量: <code>pg_exporter_exclude_database</code></li>
<li>新变量: <code>pg_exporter_include_database</code></li>
<li>变量重命名: <code>grafana_url</code> 为 <a href="https://doc.pigsty.cc/#/zh-cn/v-meta?id=grafana_endpoint"><code>grafana_endpoint</code></a></li>
</ul>
<p><strong>Bug 修复</strong></p>
<ul>
<li>修复默认时区 Asia/Shanghai (CST) 问题</li>
<li>修复 pgbouncer &amp; patroni 的 nofile 限制</li>
<li>当执行标签 <code>pgbouncer</code> 时，pgbouncer 的用户列表和数据库列表将会被生成</li>
</ul>
<hr>
<h2 id="v090">v0.9.0</h2>
<p>v0.9极大简化了安装流程，进行了大量日志相关改进，开发了命令行工具（Beta），并修复了一系列问题。</p>
<details><br>
<p><strong>新功能</strong></p>
<ul>
<li>
<p>一键安装模式：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/bin/bash -c <span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">$(</span>curl -fsSL https://pigsty.cc/install<span style="color:#204a87;font-weight:bold">)</span><span style="color:#4e9a06">&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>开发命令行工具 <code>pigsty-cli</code>封装常用Ansible命令，目前pigsty-cli处于Beta状态</p>
</li>
<li>
<p>使用Loki与Promtail收集日志：</p>
<ul>
<li>默认收集Postgres，Pgbouncer，Patroni日志</li>
<li>新增部署脚本<code>infra-loki.yml</code> 与 <code>pgsql-promtail.yml</code></li>
<li>定义基于日志的监控指标</li>
<li>使用Grafana制作日志相关可视化面板。</li>
</ul>
</li>
<li>
<p>监控组件可以使用二进制安装，使用<code>files/get_bin.sh</code>下载监控二进制组件。</p>
</li>
<li>
<p>飞升模式：
当集群元节点初始化完成后，可以使用<code>bin/upgrade</code>升级为动态Inventory
使用pg-meta上的数据库代替YAML配置文件。</p>
</li>
</ul>
<p><strong>问题修复</strong></p>
<ul>
<li>集中修复日志相关问题：
<ul>
<li>修复了HAProxy健康检查造成PG日志中大量 <code>connection reset by peer</code>的问题。</li>
<li>修复了HAProxy健康检查造成Patroni日志中大量出现<code>Connect Reset</code> Exception的问题</li>
<li>修复了Patroni日志时间戳格式，去除毫秒时间戳，附加完整时区信息。</li>
<li>为<code>dbuser_monitor</code>配置1秒的<code>log_min_duration_statement</code>，避免监控查询出现在日志中。</li>
</ul>
</li>
<li>重构Grafana角色
<ul>
<li>在保持API不变的前提下重构Grafana角色。</li>
<li>使用CDN下载预打包的Grafana插件，加速插件下载</li>
</ul>
</li>
<li>其他问题修复
<ul>
<li>修复了<code>pgbouncer-create-user</code> 未能正确处理 md5 密码的问题。</li>
<li>完善了数据库与用户创建SQL模版中参数空置检查。</li>
<li>修复了 NODE DNS配置时如果手工中断执行，DNS配置可能出错的问题。</li>
<li>重构了Makefile快捷方式 Makefile 中的错别字</li>
</ul>
</li>
</ul>
<p><strong>参数变更</strong></p>
<ul>
<li><code>node_disable_swap</code> 默认为 False，默认不会关闭SWAP。</li>
<li><code>node_sysctl_params</code> 不再有默认修改的系统参数。</li>
<li><code>grafana_plugin</code> 的默认值<code>install</code> 现在意味着当插件缓存不存在时，从CDN下载。</li>
<li><code>repo_url_packages</code> 现在从 Pigsty CDN 下载额外的RPM包，解决墙内无法访问的问题。</li>
<li><code>proxy_env.no_proxy</code>现在将Pigsty CDN加入到NOPROXY列表中。</li>
<li><code>grafana_customize</code> 现在默认为<code>false</code>，启用意味着安装Pigsty Pro版UI（默认不开源所以不要启用）</li>
<li><code>node_admin_pk_current</code>，新增选项，启用后会将当前用户的<code>~/.ssh/id_rsa.pub</code>添加至管理员的Key中</li>
<li><code>loki_clean</code>：新增选项，安装Loki时是否清除现有数据</li>
<li><code>loki_data_dir</code>：新增选项，指明安装Loki时的数据目录</li>
<li><code>promtail_enabled</code> 是否启用Promtail日志收集服务？</li>
<li><code>promtail_clean</code> 是否在安装promtail时移除已有状态信息？</li>
<li><code>promtail_port</code> promtail使用的默认端口，默认为9080</li>
<li><code>promtail_status_file</code> 保存Promtail状态信息的文件位置</li>
<li><code>promtail_send_url</code> 用于接收日志的loki服务endpoint</li>
</ul>
</details>
<hr>
<h2 id="v080">v0.8.0</h2>
<p>v0.8 针对 <strong>服务（Service）</strong> 接入部分进行了彻底的重做。现在除了默认的<code>primary</code>, <code>replica</code>服务外，用户可以自行定义新的服务。服务的接口可以支持多种不同的实现，例如L4 DPKG VIP可作为Haproxy的替代品与Pigsty集成。同时，针对用户反馈的一些问题进行了集中处理与改进。</p>
<details><br>
<p><strong>改动内容</strong></p>
<p>v0.8是供给方案定稿版本，此后供给系统的API将保持稳定。</p>
<p><strong>API变更</strong></p>
<p>原有<code>vip</code>与<code>haproxy</code>角色的所有配置项，现在迁移至<code>service</code>角色中。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># SERVICE PROVISION</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_weight</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># default load balance weight (instance level)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - service - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                                  </span><span style="color:#8f5902;font-style:italic"># how to expose postgres service in cluster?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># primary service will route {ip|name}:5433 to primary pgbouncer (5433-&gt;6432 rw)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">primary          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service name {{ pg_cluster }}_primary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5433</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbouncer    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 5433 route to pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/primary    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># primary health check, success when instance is primary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># select all instance as primary service candidate</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># replica service will route {ip|name}:5434 to replica pgbouncer (5434-&gt;6432 ro)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service name {{ pg_cluster }}_replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5434</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/read-only  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># read-only health check. (including primary)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># select all instance as replica service candidate</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector_backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary`]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># primary are used as backup server in replica service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># default service will route {ip|name}:5436 to primary postgres (5436-&gt;5432 primary)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service&#39;s actual name is {{ pg_cluster }}-{{ service.name }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># service bind ip address, * for all, vip for cluster virtual ip address</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5436</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># bind port, mandatory</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port: postgres      # target port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres|pgbouncer|port_number , pgbouncer(6432) by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_method: http      # health check method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">only http is available for now</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_port: patroni     # health check port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">patroni|pg_exporter|port_number , patroni by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/primary    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># health check url path, / as default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_code</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">200</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># health check http code, 200 as default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># instance selector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">haproxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># haproxy specific fields</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">maxconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3000</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># default front-end connection</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">balance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">roundrobin  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># load balance algorithm (roundrobin by default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">default_server_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;inter 3s fastinter 1s downinter 5s rise 3 fall 3 on-marked-down shutdown-sessions slowstart 30s maxconn 3000 maxqueue 128 weight 100&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># offline service will route {ip|name}:5438 to offline postgres (5438-&gt;5432 offline)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">offline          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service name {{ pg_cluster }}_replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5438</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/replica    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># offline MUST be a replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `offline` || pg_offline_query ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># instances with pg_role == &#39;offline&#39; or instance marked with &#39;pg_offline_query == true&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector_backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `replica` &amp;&amp; !pg_offline_query]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># replica are used as backup server in offline service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_services_extra</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># extra services to be added</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - haproxy - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># enable haproxy among every cluster members</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># reload haproxy after config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">roundrobin                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># roundrobin, leastconn</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_auth_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># enable authentication for haproxy admin?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">admin                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default haproxy admin username</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">admin                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default haproxy admin password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9101</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># default admin/exporter port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_client_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">3h                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># client side connection timeout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_server_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">3h                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># server side connection timeout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - vip - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none                               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># none | l2 | l4</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                              </span><span style="color:#8f5902;font-style:italic"># whether reload service after config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_address: 127.0.0.1                      # virtual ip address ip (l2 or l4)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_cidrmask: 24                            # virtual ip address cidr mask (l2 only)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_interface: eth0                         # virtual ip network interface (l2 only)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>新增选项</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># - localization - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default to UTF8</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default to C</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_lc_collate</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default to C</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_lc_ctype</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">en_US.UTF8                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default to en_US.UTF8</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                               </span><span style="color:#8f5902;font-style:italic"># reload postgres after hba changes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none                               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># none | l2 | l4</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                              </span><span style="color:#8f5902;font-style:italic"># whether reload service after config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>移除选项</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>haproxy_check_port                            <span style="color:#8f5902;font-style:italic"># Haproxy相关参数已经被Service定义覆盖</span>
</span></span><span style="display:flex;"><span>haproxy_primary_port
</span></span><span style="display:flex;"><span>haproxy_replica_port
</span></span><span style="display:flex;"><span>haproxy_backend_port
</span></span><span style="display:flex;"><span>haproxy_weight
</span></span><span style="display:flex;"><span>haproxy_weight_fallback
</span></span><span style="display:flex;"><span>vip_enabled                                   <span style="color:#8f5902;font-style:italic"># vip_enabled参数被vip_mode覆盖</span>
</span></span></code></pre></div><p><strong>服务管理</strong></p>
<p><code>pg_services</code> 与 <code>pg_services_extra</code> 定义了集群中的<strong>服务</strong>，每一个服务的定义结构如下例所示：</p>
<p>一个服务必须指定以下内容：</p>
<ul>
<li>
<p><strong>名称</strong>：服务的完整名称以数据库集群名为前缀，以<code>service.name</code>为后缀，通过<code>-</code>连接。例如在<code>pg-test</code>集群中<code>name=primary</code>的服务，其完整服务名称为<code>pg-test-primary</code>。</p>
</li>
<li>
<p><strong>端口</strong>：在Pigsty中，服务默认采用NodePort的形式对外暴露，因此暴露端口为必选项。但如果使用外部负载均衡服务接入方案，您也可以通过其他的方式区分服务。</p>
</li>
<li>
<p><strong>选择器</strong>：选择器指定了服务的成员，采用JMESPath的形式，从所有集群实例成员中筛选变量。默认的<code>[]</code>选择器会选取所有的集群成员。</p>
<p>此外<code>selector_backup</code>会选择或标记用于backup的实例列表（当集群中所有其他成员失效时方才接管服务）</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># default service will route {ip|name}:5436 to primary postgres (5436-&gt;5432 primary)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service&#39;s actual name is {{ pg_cluster }}-{{ service.name }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># service bind ip address, * for all, vip for cluster virtual ip address</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5436</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># bind port, mandatory</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port: postgres      # target port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres|pgbouncer|port_number , pgbouncer(6432) by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_method: http      # health check method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">only http is available for now</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_port: patroni     # health check port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">patroni|pg_exporter|port_number , patroni by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/primary    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># health check url path, / as default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_code</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">200</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># health check http code, 200 as default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># instance selector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">haproxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># haproxy specific fields</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">maxconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3000</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># default front-end connection</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">balance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">roundrobin  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># load balance algorithm (roundrobin by default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">default_server_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;inter 3s fastinter 1s downinter 5s rise 3 fall 3 on-marked-down shutdown-sessions slowstart 30s maxconn 3000 maxqueue 128 weight 100&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>数据库管理</strong></p>
<p>数据库现在可以对locale的细分选项：<code>lc_ctype</code>与<code>lc_collate</code>分别进行指定。支持这一功能的主要原因是PG的扩展插件<code>pg_trgm</code>需要在<code>lc_ctype!=C</code>的环境中才能正常支持中文。</p>
<p><strong>旧接口定义</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># name is the only required field for a database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">owner</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database owner</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">template1            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, template1 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, UTF8 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, C by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">allowconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, true by default, false disable connect at all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">revokeconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># optional, false by default, true revoke connect from public # (only default user and owner have connect privilege on database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">tablespace</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_default         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, &#39;pg_default&#39; is the default tablespace</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, connection limit, -1 or none disable limit (default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extension name and where to create</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#204a87;font-weight:bold">name: postgis, schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extra parameters with ALTER DATABASE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable_partitionwise_join</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, add this database to pgbouncer list? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty meta database  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, comment string for database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>新的接口定义</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># name is the only required field for a database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># owner: postgres                 # optional, database owner</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># template: template1             # optional, template1 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># encoding: UTF8                # optional, UTF8 by default , must same as template database, leave blank to set to db default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># locale: C                     # optional, C by default , must same as template database, leave blank to set to db default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># lc_collate: C                 # optional, C by default , must same as template database, leave blank to set to db default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># lc_ctype: C                   # optional, C by default , must same as template database, leave blank to set to db default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">allowconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, true by default, false disable connect at all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">revokeconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># optional, false by default, true revoke connect from public # (only default user and owner have connect privilege on database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># tablespace: pg_default          # optional, &#39;pg_default&#39; is the default tablespace</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, connection limit, -1 or none disable limit (default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extension name and where to create</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#204a87;font-weight:bold">name: postgis, schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extra parameters with ALTER DATABASE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable_partitionwise_join</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, add this database to pgbouncer list? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty meta database  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, comment string for database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></details>
<hr>
<h2 id="v070">v0.7.0</h2>
<p>v0.7 针对<strong>接入已有数据库实例</strong>进行了改进，现在用户可以采用 <strong>仅监控部署（Monly Deployment）</strong> 模式使用Pigsty。同时新增了专用于管理数据库与用户、以及单独部署监控的剧本，并对数据库与用户的定义进行改进。</p>
<details><br>
<p><strong>Features</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/25">Monitor Only Deployment Support #25</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/36">Split monolith static monitor target file into per-cluster conf #36</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/29">Add create user playbook #29</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/28">Add create database playbook #28</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/33">Database provisioning interface enhancement #33</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/34">User provisioning interface enhancement #34</a></li>
</ul>
<p><strong>Bug Fix</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/32">Create extension with schema typo #32</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/35">pgbouncer reload with systemctl not work #35</a></li>
</ul>
<p><strong>API变更</strong></p>
<p><strong>新增选项</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">prometheus_sd_target</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">batch                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># batch|single    监控目标定义文件采用单体还是每个实例一个</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_install</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none                       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># none|yum|binary 监控Exporter的安装模式</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_repo_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># 如果设置，这里的REPO连接会加入目标的Yum源中</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--no-collector.softnet --collector.systemd --collector.ntp --collector.tcpstat --collector.processes&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># Node Exporter默认的命令行选项</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># 可选，PG Exporter监控对象的URL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># 可选，PGBOUNCER EXPORTER监控对象的URL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>移除选项</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">exporter_binary_install</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># 功能被 exporter_install 覆盖</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>定义结构变更</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">pg_default_roles                              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 变化细节参考 用户管理。</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">pg_users                                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 变化细节参考 用户管理。</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">pg_databases                                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 变化细节参考 数据库管理。</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>重命名选项</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#000">pg_default_privilegs -&gt; pg_default_privileges</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 很明显这是一个错别字</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>仅监控模式</strong></p>
<p>有时用户不希望使用Pigsty供给方案，只希望使用Pigsty监控系统管理现有PostgreSQL实例。</p>
<p>Pigsty提供了仅监控部署（monly, monitor-only模式，剥离供给方案部分，可用于监控现有PostgreSQL集群。</p>
<p>仅监控模式的部署流程与标准模式大体上保持一致，但省略了很多步骤</p>
<ul>
<li>在<strong>元节点</strong>上完成基础设施初始化的部分与标准流程保持一致，仍然通过<code>./infra.yml</code>完成。</li>
<li>不需要在<strong>数据库节点</strong>上完成 <strong>基础设施初始化</strong>。</li>
<li>不需要在<strong>数据库节点</strong>上执行数据库初始化的绝大多数任务，而是通过专用的<code>./pgsql-monitor.yml</code> 完成仅监控系统部署。</li>
<li>实际使用的配置项大大减少，只保留基础设施相关变量，与 监控系统相关的少量变量。</li>
</ul>
<p><strong>数据库管理</strong></p>
<p><a href="https://github.com/Vonng/pigsty/issues/33">Database provisioning interface enhancement #33</a></p>
<p><strong>旧接口定义</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># create a business database &#39;meta&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">meta]                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># create extra schema named &#39;meta&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span>{<span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgis}]  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># create extra extension postgis</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># overwrite database meta&#39;s default search_path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">search_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public, monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>新的接口定义</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># name is the only required field for a database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">owner</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database owner</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">template1            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, template1 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, UTF8 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, C by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">allowconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, true by default, false disable connect at all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">revokeconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># optional, false by default, true revoke connect from public # (only default user and owner have connect privilege on database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">tablespace</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_default         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, &#39;pg_default&#39; is the default tablespace</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, connection limit, -1 or none disable limit (default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extension name and where to create</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#204a87;font-weight:bold">name: postgis, schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extra parameters with ALTER DATABASE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable_partitionwise_join</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, add this database to pgbouncer list? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty meta database  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, comment string for database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>接口变更</strong></p>
<ul>
<li>Add new options: <code>template</code> , <code>encoding</code>, <code>locale</code>, <code>allowconn</code>, <code>tablespace</code>, <code>connlimit</code></li>
<li>Add new option <code>revokeconn</code>, which revoke connect privileges from public for this database</li>
<li>Add <code>comment</code> field for database</li>
</ul>
<p><strong>数据库变更</strong></p>
<p>在运行中集群中创建新数据库可以使用<code>pgsql-createdb.yml</code>剧本，在配置中定义完新数据库后，执行以下剧本。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./pgsql-createdb.yml -e <span style="color:#000">pg_database</span><span style="color:#ce5c00;font-weight:bold">=</span>&lt;your_new_database_name&gt;
</span></span></code></pre></div><p>通过<code>-e pg_datbase=</code>告知需要创建的数据库名称，则该数据库即会被创建（或修改）。具体执行的命令参见集群主库<code>/pg/tmp/pg-db-{{ database.name}}.sql</code>文件。</p>
<p><strong>用户管理</strong></p>
<p><a href="https://github.com/Vonng/pigsty/issues/34">User provisioning interface enhancement #34</a></p>
<p><strong>旧接口定义</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># example production user have read-write access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># example user&#39;s password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">LOGIN                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># extra options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_readwrite ]   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dborole_admin|dbrole_readwrite|dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default test user for production usage</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># add to pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>新接口定义</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># complete example of user/role definition for production user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_meta              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># example production user have read-write access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Meta          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># example user&#39;s password, can be encrypted</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">login</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># can login, true by default (should be false for role)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">superuser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># is superuser? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">createdb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># can create database? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># can create role? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">inherit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># can this role use inherited privileges?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">replication</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># can this role do replication? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">bypassrls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># can this role bypass row level security? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># connection limit, -1 disable limit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">expire_at</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;2030-12-31&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># &#39;timestamp&#39; when this role is expired</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">expire_in</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">365</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># now + n days when this role is expired (OVERWRITE expire_at)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_readwrite]      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dborole_admin|dbrole_readwrite|dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># add this user to pgbouncer? false by default (true for production user)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># user&#39;s default search path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">search_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>接口变更</strong></p>
<ul>
<li><code>username</code> field rename to <code>name</code></li>
<li><code>groups</code> field rename to <code>roles</code></li>
<li><code>options</code> now split into separated configration entries:
<code>login</code>, <code>superuser</code>, <code>createdb</code>, <code>createrole</code>, <code>inherit</code>, <code>replication</code>,<code>bypassrls</code>,<code>connlimit</code></li>
<li><code>expire_at</code> and <code>expire_in</code> options</li>
<li><code>pgbouncer</code> option for user is now <code>false</code> by default</li>
</ul>
<p><strong>用户管理</strong></p>
<p>在运行中集群中创建新数据库可以使用<code>pgsql-createuser.yml</code>剧本，在配置中定义完新数据库后，执行以下剧本。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./pgsql-createuser.yml -e <span style="color:#000">pg_user</span><span style="color:#ce5c00;font-weight:bold">=</span>&lt;your_new_user_name&gt;
</span></span></code></pre></div><p>通过<code>-e pg_user=</code>告知需要创建的数据库名称，则该数据库即会被创建（或修改）。具体执行的命令参见集群主库<code>/pg/tmp/pg-user-{{ user.name}}.sql</code>文件。</p>
</details>
<hr>
<h2 id="v060">v0.6.0</h2>
<p>v0.6 对数据库供给方案进行了修改与调整，根据用户的反馈添加了一系列实用功能与修正。针对监控系统的移植性进行优化，便于与其他外部数据库供给方案对接。</p>
<details><br>
<p><strong>BUG修复</strong></p>
<ul>
<li>修复了新版本Patroni重启后会重置PG HBA的问题</li>
<li>修复了PG Overview Dashboard标题中的别字</li>
<li>修复了沙箱集群<code>pg-test</code>的默认主库，原来为<code>pg-test-2</code>，应当为<code>pg-test-1</code></li>
<li>修复了过时代码注释</li>
</ul>
<p><strong>功能改进</strong></p>
<ul>
<li>改造Prometheus与监控供给方式
<ul>
<li>允许在无基础设施的情况下对已有PG集群进行监控部署，便于监控系统与其他供给方案集成。<a href="https://github.com/Vonng/pigsty/issues/11">#11</a></li>
<li>基于Inventory渲染所有监控对象的静态列表，用于静态服务发现。<a href="https://github.com/Vonng/pigsty/issues/11">#11</a></li>
<li>Prometheus添加了静态对象模式，用于替代动态服务发现，集中进行身份管理<a href="https://github.com/Vonng/pigsty/issues/11">#11</a></li>
<li>监控Exporter现在添加了<code>service_registry</code>选项，Consul服务注册变为可选项 <a href="https://github.com/Vonng/pigsty/issues/13">#13</a></li>
<li>Exporter现在可以通过拷贝二进制的方式直接安装：<code>exporter_binary_install</code>，<a href="https://github.com/Vonng/pigsty/issues">#14</a></li>
<li>Exporter现在具有<code>xxx_enabled</code>选项，控制是否启用该组件。</li>
</ul>
</li>
<li>Haproxy供给重构与改进  <a href="https://github.com/Vonng/pigsty/issues/8">#8</a>
<ul>
<li>新增了全局HAProxy管理界面导航，默认域名<code>h.pigsty</code></li>
<li>允许将主库加入只读服务集中，当集群中所有从库宕机时自动承接读流量。 <a href="https://github.com/Vonng/pigsty/issues/8">#8</a></li>
<li>允许位Haproxy实例管理界面启用认证 <code>haproxy_admin_auth_enabled</code></li>
<li>允许通过配置项调整每个服务对应后端的流量权重. <a href="https://github.com/Vonng/pigsty/issues/10">#10</a></li>
</ul>
</li>
<li>访问控制模型改进。<a href="https://github.com/Vonng/pigsty/issues/7">#7</a>
<ul>
<li>添加了默认角色<code>dbrole_offline</code>，用于慢查询，ETL，交互式查询场景。</li>
<li>修改默认HBA规则，允许<code>dbrole_offline</code>分组的用户访问<code>pg_role == 'offline'</code>及<code>pg_offline_query == true</code>的实例。</li>
</ul>
</li>
<li>软件更新 Release v0.6
<ul>
<li>PostgreSQL 13.2</li>
<li>Prometheus 2.25</li>
<li>PG Exporter 0.3.2</li>
<li>Node Exporter 1.1</li>
<li>Consul 1.9.3</li>
<li>更新默认PG源：PostgreSQL现在默认使用浙江大学的镜像，加速下载安装</li>
</ul>
</li>
</ul>
<p><strong>接口变更</strong></p>
<p><strong>新增选项</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">service_registry</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consul                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 服务注册机制：none | consul | etcd | both</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--storage.tsdb.retention=30d&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># prometheus命令行选项</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consul                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Prometheus使用的服务发现机制：static|consul</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">2s                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Prometheus服务发现刷新间隔</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_offline_query</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># 设置后将允许dbrole_offline角色连接与查询该实例</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># 设置后将安装配置Node Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># 设置后将安装配置PG Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># 设置后将安装配置Pgbouncer Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">dcs_disable_purge</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># 双保险，强制 dcs_exists_action = abort 避免误删除DCS实例</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_disable_purge</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># 双保险，强制 pg_exists_action = abort 避免误删除数据库实例</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_weight</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># 配置实例的相对负载均衡权重</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_weight_fallback</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># 配置集群主库在只读服务中的相对权重</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>移除选项</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">prometheus_metrics_path                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 与 exporter_metrics_path 重复</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">prometheus_retention                         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 功能被 prometheus_options 覆盖</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></details>
<hr>
<h2 id="v050">v0.5.0</h2>
<p>Pigsty 现在有了官方网站啦：<a href="https://pigsty.cc/">pigsty.cc</a> 🎉 !</p>
<details><br>
<p><strong>亮点特性</strong></p>
<ul>
<li>Pigsty官方<a href="http://pigsty.cc/">文档站</a>正式上线！</li>
<li>添加了数据库模板的定制支持，用户可以通过配置文件定制所需的数据库内部对象。</li>
<li>对默认<a href="/zh/docs/pgsql/acl">访问控制</a>模型进行了改进</li>
<li>重构了HBA管理的逻辑，现在将由Pigsty替代Patroni直接负责生成HBA</li>
<li>将Grafana监控系统的供给方案从sqlite改为JSON文件静态Provision</li>
<li>将<code>pg-cluster-replication</code>面板加入Pigsty开源免费套餐。</li>
<li>最新的经过测试的离线安装包：<a href="https://github.com/Vonng/pigsty/releases/download/v0.5.0/pkg.tgz">pkg.tgz</a> (v0.5)</li>
</ul>
<p><strong>定制数据库</strong></p>
<p>您是否烦恼过单实例多租户的问题？比如总有研发拿着PostgreSQL当MySQL使，明明是一个Schema就能解决的问题，非要创建一个新的数据库出来，在一个实例中创建出几十个不同的DB。
不要忧伤，不要心急。Pigsty已经提供数据库内部对象的Provision方案，您可以轻松地在配置文件中指定所需的数据库内对象，包括：</p>
<ul>
<li>角色
<ul>
<li>用户/角色名</li>
<li>密码</li>
<li>用户属性</li>
<li>用户备注</li>
<li>用户所属的权限组</li>
</ul>
</li>
<li>数据库
<ul>
<li>属主</li>
<li>额外的模式</li>
<li>额外的扩展插件</li>
<li>数据库级的自定义配置参数</li>
</ul>
</li>
<li>数据库
<ul>
<li>属主</li>
<li>额外的模式</li>
<li>额外的扩展插件</li>
<li>数据库级的自定义配置参数</li>
</ul>
</li>
<li>默认权限
<ul>
<li>默认情况下这里配置的权限会应用至所有由 超级用户 和 管理员用户创建的对象上。</li>
</ul>
</li>
<li>默认扩展
<ul>
<li>所有新创建的业务数据库都会安装有这些默认扩展</li>
</ul>
</li>
<li>默认模式
<ul>
<li>所有新创建的业务数据库都会创建有这些默认的模式</li>
</ul>
</li>
</ul>
<p>配置样例</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 通常是每个DB集群配置的变量</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default test user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_readwrite ]   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dborole_admin|dbrole_readwrite|dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># create a business database &#39;test&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span>{<span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgis}]  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># create extra extension postgis</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># overwrite database meta&#39;s default search_path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">search_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public,monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># 通常是整个环境统一配置的全局变量</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - system roles - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_replication_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replicator          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system replication user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_replication_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Replicator   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system replication password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_monitor_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_monitor          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system monitor user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_monitor_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Monitor          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system monitor password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_admin              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Admin              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system admin password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - default roles - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">dbrole_readonly                 # sample user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">NOLOGIN                         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># role can not login</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for readonly access        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># comment string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username: dbrole_readwrite                # sample user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">one object for each user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">NOLOGIN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for read-write access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_readonly ]              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># read-write includes read-only access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username: dbrole_admin                    # sample user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">one object for each user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">NOLOGIN BYPASSRLS               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># admin can bypass row level security</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for object creation</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_readwrite,pg_monitor,pg_signal_backend]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># NOTE: replicator, monitor, admin password are overwritten by separated config entry</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># reset dbsu password to NULL (if dbsu is not postgres)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SUPERUSER LOGIN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system superuser</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">REPLICATION LOGIN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">pg_monitor, dbrole_readonly]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">LOGIN CONNECTION LIMIT 10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system monitor user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">pg_monitor, dbrole_readonly]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">LOGIN BYPASSRLS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_admin]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_stats</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Stats</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">LOGIN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">business read-only user for statistics</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_readonly]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># object created by dbsu and admin will have their privileges properly set</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_privilegs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE                         ON SCHEMAS   TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT                        ON TABLES    TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT                        ON SEQUENCES TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE                       ON FUNCTIONS TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT INSERT, UPDATE, DELETE        ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE,  UPDATE                ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRUNCATE, REFERENCES, TRIGGER ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT CREATE                        ON SCHEMAS   TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE                         ON TYPES     TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># schemas</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">monitor]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># extension</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_stat_statements&#39;,  schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pgstattuple&#39;,         schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_qualstats&#39;,        schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_buffercache&#39;,      schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pageinspect&#39;,         schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_prewarm&#39;,          schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_visibility&#39;,       schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_freespacemap&#39;,     schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_repack&#39;,           schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres_fdw</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">file_fdw</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">btree_gist</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">btree_gin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_trgm</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">intagg</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">intarray</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># postgres host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow meta node password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     all                         10.10.10.10/32      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow intranet admin password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_admin               10.0.0.0/8          md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_admin               172.16.0.0/12       md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_admin               192.168.0.0/16      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow intranet password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all             all                 10.0.0.0/8          md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all             all                 172.16.0.0/12       md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all             all                 192.168.0.0/16      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow local read-write access (local production user via pgbouncer)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">local   all     +dbrole_readwrite                               md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_readwrite           127.0.0.1/32        md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow read-only user (stats, personal) password directly access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">local   all     +dbrole_readonly                               md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_readonly           127.0.0.1/32        md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_hba_rules_extra</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pgbouncer host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">local  all          all                                     md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host   all          all                     127.0.0.1/32    md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">intranet password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host   all          all                     10.0.0.0/8      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host   all          all                     172.16.0.0/12   md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host   all          all                     192.168.0.0/16  md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_hba_rules_extra</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>数据库模板</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/blob/main/roles/postgres/templates/pg-init-template.sql">pg-init-template.sql</a> 用于初始化<code>template1</code>数据的脚本模板</li>
<li><a href="https://github.com/Vonng/pigsty/blob/main/roles/postgres/templates/pg-init-business.sql">pg-init-business.sql</a> 用于初始化其他业务数据库的脚本模板</li>
</ul>
<p><strong>权限模型</strong></p>
<p>v0.5 改善了默认的权限模型，主要是针对单实例多租户的场景进行优化，并收紧权限控制。</p>
<ul>
<li>撤回了普通业务用户对非所属数据库的默认<code>CONNECT</code>权限</li>
<li>撤回了非管理员用户对所属数据库的默认<code>CREATE</code>权限</li>
<li>撤回了所有用户在<code>public</code>模式下的默认创建权限。</li>
</ul>
<p><strong>供给方式</strong></p>
<p>原先Pigsty采用直接拷贝Grafana自带的grafana.db的方式完成监控系统的初始化。
这种方式虽然简单粗暴管用，但不适合进行精细化的版本控制管理。在v0.5中，Pigsty采用了Grafana API完成了监控系统面板供给的工作。
您所需的就是在<code>grafana_url</code>中填入带有用户名密码的Grafana URL。
因此，监控系统可以背方便地添加至已有的Grafana中。</p>
</details>
<hr>
<h2 id="v040">v0.4.0</h2>
<p>第二个公开测试版v0.4现已正式发行！</p>
<details><br>
<p><strong>监控系统</strong></p>
<p>Pigsty v0.4对监控系统进行了整体升级改造，精心挑选了10个面板作为标准的Pigsty开源内容。同时，针对Grafana 7.3的不兼容升级进行了大量适配改造工作。使用升级的<code>pg_exporter v0.3.1</code>作为默认指标导出器，调整了监控报警规则的监控面板连接。</p>
<p><strong>Pigsty开源版</strong></p>
<p>Pigsty开源版选定了以下10个Dashboard作为开源内容。其他Dashboard作为可选的商业支持内容提供。</p>
<ul>
<li>PG Overview</li>
<li>PG Cluster</li>
<li>PG Service</li>
<li>PG Instance</li>
<li>PG Database</li>
<li>PG Query</li>
<li>PG Table</li>
<li>PG Table Catalog</li>
<li>PG Table Detail</li>
<li>Node</li>
</ul>
<p>尽管进行了少量阉割，这10个监控面板所涵盖的内容仍然可以吊打所有同类软件。</p>
<p><strong>软件升级</strong></p>
<p>Pigsty v0.4进行了大量软件适配工作，包括：</p>
<ul>
<li>Upgrade to PostgreSQL 13.1, Patroni 2.0.1-4, add citus to repo.</li>
<li>Upgrade to <a href="https://github.com/Vonng/pg_exporter/releases/tag/v0.3.1"><code>pg_exporter 0.3.1</code></a></li>
<li>Upgrade to Grafana 7.3, Ton&rsquo;s of compatibility work</li>
<li>Upgrade to prometheus 2.23, with new UI as default</li>
<li>Upgrade to consul 1.9</li>
</ul>
<p><strong>其他改进</strong></p>
<ul>
<li>Update prometheus alert rules</li>
<li>Fix alertmanager info links</li>
<li>Fix bugs and typos.</li>
<li>add a simple backup script</li>
</ul>
<p><strong>离线安装包</strong></p>
<ul>
<li>v0.4的离线安装包（CentOS 7.8）已经可以从Github下载：<a href="https://github.com/Vonng/pigsty/releases/download/v0.4.0/pkg.tgz">pkg.tgz</a></li>
</ul>
</details>
<hr>
<h2 id="v030">v0.3.0</h2>
<p>首个Pigsty公开测试版本现在已经释出！</p>
<details><br>
<p><strong>监控系统</strong></p>
<p>Pigsty v0.3 包含以下8个监控面板作为开源内容：</p>
<ul>
<li>PG Overview</li>
<li>PG Cluster</li>
<li>PG Service</li>
<li>PG Instance</li>
<li>PG Database</li>
<li>PG Table Overview</li>
<li>PG Table Catalog</li>
<li>Node</li>
</ul>
<p><strong>离线安装包</strong></p>
<ul>
<li>v0.3 离线安装包（CentOS 7.8）已经可以从Github下载：<a href="https://github.com/Vonng/pigsty/releases/download/v0.3.0/pkg.tgz">pkg.tgz</a></li>
</ul>
</details>
	<style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<div class="d-print-none">
<h2 class="feedback--title">Feedback</h2>
<p class="feedback--question">Was this page helpful?</p>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it! Please <a href="https://github.com/Vonng/pigsty/issues/new">tell us how we can improve</a>.
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that. Please <a href="https://github.com/Vonng/pigsty/issues/new">tell us how we can improve</a>.
</p>
</div>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof gtag !== 'function') return;
    gtag('event', 'page_helpful', {
      'event_category': 'Helpful',
      'event_label': window.location.pathname,
      'value': value
    });
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback( 100 );
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>
<br />
<div class="td-page-meta__lastmod">
  Last modified 2024-12-25: <a href="https://github.com/Vonng/pigsty.cc/commit/9b87df1bd01214b134b2afa56458c1f86ca2b3ce">bump to v3.2.0 (9b87df1b)</a>
</div>

</div>


          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Mail" aria-label="Mail">
    <a target="_blank" rel="noopener" href="mailto:rh@vonng.com" aria-label="Mail">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/Vonng/pigsty" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/GobeUncleWang" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="WeChat" aria-label="WeChat">
    <a target="_blank" rel="noopener" href="/img/pigsty/pigsty-cc.jpg" aria-label="WeChat">
      <i class="fa fa-comment"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Discord" aria-label="Discord">
    <a target="_blank" rel="noopener" href="https://discord.gg/wDzt5VyWEz" aria-label="Discord">
      <i class="fab fa-discord"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Telegram" aria-label="Telegram">
    <a target="_blank" rel="noopener" href="https://t.me/joinchat/gV9zfZraNPM3YjFh" aria-label="Telegram">
      <i class="fab fa-telegram"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2018&ndash;2024
    <span class="td-footer__authors">Ruohang Feng</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span></span><span class="ms-2"><a href="https://vonng.com/en/" target="_blank" rel="noopener">@Vonng</a></span>
<br><span>Pigsty® distributed under <a href="/docs/about/license" target="_blank" rel="noopener">AGPLv3</a></span>
<br><span class="ms-2"><a href="/docs/about/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
<span><a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">浙ICP备15016890号</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.248655eb216150e39da254c2f7aa5357805d0ec66bdb741b591cd35fb5f629ab.js" integrity="sha256-JIZV6yFhUOOdolTC96pTV4BdDsZr23QbWRzTX7X2Kas=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>