<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pigsty – ECS</title>
    <link>/zh/tags/ecs/</link>
    <description>Recent content in ECS on Pigsty</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Sun, 10 Mar 2024 00:00:00 +0000</lastBuildDate>
    
	  <atom:link href="/zh/tags/ecs/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Blog: 剖析阿里云服务器算力成本</title>
      <link>/zh/blog/cloud/ecs/</link>
      <pubDate>Sun, 10 Mar 2024 00:00:00 +0000</pubDate>
      
      <guid>/zh/blog/cloud/ecs/</guid>
      <description>
        
        
        
        <![CDATA[<img src="/zh/blog/cloud/ecs/featured_hu009db617ebbfc32e36fe2a280177ffb8_277554_640x0_resize_catmullrom_3.png" width="640" height="507"/>]]>
        
        &lt;p&gt;2024年2月29号疯狂星期四，阿里云搞了个&lt;a href=&#34;https://mp.weixin.qq.com/s/xO48vyZKwxLOZdQa5AD_gw&#34;&gt;&lt;strong&gt;大降价&lt;/strong&gt;&lt;/a&gt;，&lt;a href=&#34;https://mp.weixin.qq.com/s/CXkqD_d-pIpTl9sM_3iHoA&#34;&gt;&lt;strong&gt;软文&lt;/strong&gt;&lt;/a&gt;漫天飞舞，作为&lt;a href=&#34;/zh/blog/cloud/&#34;&gt;&lt;strong&gt;云计算泥石流&lt;/strong&gt;&lt;/a&gt;，不少朋友在后台留言让我点评一下。满屏的 20%，50% off 看上去好像降的很壮观，但外行看热闹，内行看门道：&lt;a href=&#34;/zh/blog/cloud/ebs&#34;&gt;&lt;strong&gt;云服务的成本大头在于存储&lt;/strong&gt;&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;云厂商真正的杀猪刀 —— ESSD 可是一毛钱都没降。而 EC2 和 OSS 降价降的也不是列表价，而是包年的最低折扣 —— 主力机型包一、三、五年可降价 10% 左右，所以也基本上降了个寂寞，对于已经享受低于此商务折扣的客户更是毫无卵用。&lt;/p&gt;
&lt;p&gt;我们之前有过分析：云上 &lt;a href=&#34;/zh/blog/cloud/bonus&#34;&gt;&lt;strong&gt;ECS 算力&lt;/strong&gt;&lt;/a&gt;单价可达本地自建的&lt;strong&gt;十倍&lt;/strong&gt;，云上 &lt;a href=&#34;/zh/blog/cloud/ebs/&#34;&gt;&lt;strong&gt;ESSD 存储&lt;/strong&gt;&lt;/a&gt;单价可以达到本地自建的&lt;strong&gt;百倍&lt;/strong&gt;。云数据库 &lt;a href=&#34;/zh/blog/cloud/rds&#34;&gt;&lt;strong&gt;RDS&lt;/strong&gt;&lt;/a&gt; 介于两者之间。算力降价 10%， 相对于这个溢价来说就跟挠痒痒一样。&lt;/p&gt;
&lt;p&gt;不过，既然阿里云号称大降价了，我就把云上基础资源的价格拎出来，用 2024 年的价格，再做一次成本对比。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;太长不看&#34;&gt;太长不看&lt;/h2&gt;
&lt;p&gt;算力的价格使用 &lt;strong&gt;人民币/核·月&lt;/strong&gt; 作为统一单位 ，云服务器的溢价为自建的 5 ～ 12 倍。&lt;/p&gt;
&lt;p&gt;作为自建的参照案例，DHH 与 探探自建大型计算/存储服务器的单价成本为 &lt;strong&gt;20 ¥&lt;/strong&gt;/(核·月)，算上64x 配比的本地 NVMe 存储后为 &lt;strong&gt;22.4 ¥&lt;/strong&gt;/(核·月)。我们考察阿里云国内一线可用区标准 c/g/r 实例族最近三代的算力均价，可以得出以下结论&lt;/p&gt;
&lt;p&gt;在不考虑存储的情况下，云上按量，包月，包年，预付五年的单价分别为 &lt;strong&gt;187¥，125¥，81¥，37¥&lt;/strong&gt;，相比自建的 &lt;strong&gt;20¥&lt;/strong&gt; 分别溢价了 &lt;strong&gt;8x, 5x, 3x, 1x&lt;/strong&gt;。在配置常用比例的块存储后（1核:64GB, ESSD PL3），单价分别为：&lt;strong&gt;571¥，381¥，298¥，165¥&lt;/strong&gt;，相比自建的 &lt;strong&gt;22.4¥&lt;/strong&gt; 溢价了 &lt;strong&gt;24x, 16x, 12x, 6x&lt;/strong&gt; 。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;关键数字&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;按需价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;包月价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;包年价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;预付三年&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;预付五年&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;配上64x存储价格&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;571 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;381 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;298 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;181 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;165 ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;是自建价格的几倍&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;25x&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;17x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;13x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;7x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;算力单位价格&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;187 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;125 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;81 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;53 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;37 ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;是自建价格的几倍&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;9x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;2x&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;随后，我们进一步定量分析阿里云服务器定价数据，发现了对单价影响最大的几项要素：附加存储，付费方式，可用区，实例族（芯片架构，实例代际，内存配比），并解释了上面的数字是如何计算得到的。&lt;/p&gt;
&lt;p&gt;作为结论：即使是在所谓的“大降价”后，公有云提供的算力也远远称不上 “便宜” 。实际上云服务器的成本极其高昂，尤其是大型计算与大型 NVMe 存储。如果您的业务需要较大的块存储或一台物理服务器以上的算力，您确实应当仔细计算一下这里的成本，并考虑一下其他的备选项。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;纯算力的价格&#34;&gt;纯算力的价格&lt;/h2&gt;
&lt;p&gt;我们取样了最具有代表性的国内可用区，最近三代 c/g/r 实例族纯算力部分的的价格，绘制为图表。&lt;/p&gt;
&lt;p&gt;如表所示，单位算力（1C4G）的标准价格是包月的价格，为 &lt;strong&gt;125 ¥&lt;/strong&gt;。在此基础上：按量付费需要额外支付 50% 溢价，为 &lt;strong&gt;187 ¥&lt;/strong&gt;；包年预付可以打 65折为 &lt;strong&gt;81 ¥&lt;/strong&gt;，包三年可以打 44 折为 &lt;strong&gt;53 ¥&lt;/strong&gt;，预付五年可以打三折为 &lt;strong&gt;37 ¥&lt;/strong&gt;。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;关键数字&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;按需价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;包月价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;包年价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;预付三年&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;预付五年&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;算力单位价格&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;187 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;125 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;81 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;53 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;37 ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;是自建价格的几倍&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;9x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;自建成本可降低%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;89%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;84%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;75%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;62%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;46%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;自建成本可降至 %&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;11%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;16%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;25%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;38%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;54%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a href=&#34;https://demo.pigsty.cc/d/ecs?viewPanel=63&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ecs/ecs-2.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;我们可以使用 DDH 2023 年下云自建的案例，以及我自己在探探亲身经历的云下 IDC 自建案例作为对比。
刨除 NVMe 存储部分后，DHH 自建的纯算力单价为 &lt;strong&gt;22 ¥&lt;/strong&gt;，探探自建的单价为 &lt;strong&gt;18 ¥&lt;/strong&gt;。&lt;/p&gt;


&lt;div class=&#34;alert alert-danger&#34; role=&#34;alert&#34;&gt;
&lt;h4 class=&#34;alert-heading&#34;&gt;自建价格已经算上人力/运维费用了！&lt;/h4&gt;

    &lt;strong&gt;请注意，此成本数字中已经包含了服务器费用，以及交换机/机柜/网/电/代维/运维人员均摊后的费用。DHH 的单位价格中有 50% 是服务器之外的成本，探探中则为 20% 。如果只算服务器成本，自建单位价格可以降至 10 ¥。如果再以容器平台 500% 超卖比率计算…&lt;/strong&gt;

&lt;/div&gt;

&lt;p&gt;因此不难看出，云上的纯算力的价格是自建的 2 ～ 9 倍！为了实现云厂商所鼓吹的 “极致弹性”，“按量付费”，您需要额外付出 &lt;strong&gt;8倍&lt;/strong&gt;的成本。假如您完全不在乎弹性，就跟正常采购服务器五年摊销一样使用，那么仍然需要额外付出&lt;strong&gt;1倍&lt;/strong&gt;的成本。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;杀猪盘的价格&#34;&gt;杀猪盘的价格&lt;/h2&gt;
&lt;p&gt;如果云上的算力溢价在预付多年的 Saving Plan 中，价格还能勉强让人接受，那么云上存储的溢价就属于离谱的杀猪盘了。&lt;/p&gt;
&lt;p&gt;大型算力往往要搭配高性能的本地存储使用 —— 例如业内经常使用的一种配比规格为 &lt;strong&gt;1核:64GB&lt;/strong&gt; NVMe 存储。探探和 DHH 的自建案例中都使用此配比。 探探的服务器案例中，64核配 3.2TB NVMe SSD，采购价 6000 元，当下市价 ¥2788。在 DHH的案例中，192 核配 12 TB NVMe SSD，采购价 $2390。以标准五年质保与财务摊销计算，单位价格 &lt;strong&gt;¥/(GB·月)&lt;/strong&gt; 约为 &lt;strong&gt;0.02&lt;/strong&gt;。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;单位价格：¥/GiB月&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;IOPS&lt;/th&gt;
&lt;th&gt;带宽&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;容量&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;按需价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;包月价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;包年价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;预付三年+&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ESSD 云盘 PL0&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;10K&lt;/td&gt;
&lt;td&gt;180 MB/s&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;40G-32T&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.76&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.50&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.43&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.25&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ESSD 云盘 PL1&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;50K&lt;/td&gt;
&lt;td&gt;350 MB/s&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;20G-32T&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.51&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.85&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ESSD 云盘 PL2&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;100K&lt;/td&gt;
&lt;td&gt;750 MB/s&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;461G-32T&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.02&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.70&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ESSD 云盘 PL3&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1M&lt;/td&gt;
&lt;td&gt;4 GB/s&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.2T-32T&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6.05&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.40&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;本地 NVMe SSD&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3M&lt;/td&gt;
&lt;td&gt;7 GB/s&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;最大单卡64T&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.02&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.02&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.02&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.02&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;抛开系统盘/HDD这种乞丐盘，在阿里云上提供了四种不同规格等级的块存储：ESSD PL0 ~ PL3。其单位价格分别为：&lt;strong&gt;0.5, 1, 2, 4&lt;/strong&gt;。ESSD PL3 的性能勉强接近本地 Gen3 NVMe SSD，但它 4 块钱的单价是本地自建的 200 倍！当然 ESSD 也有自己独立的折扣策略 —— 预付费三年以上，ESSD 可以打满顶折 5 折，但那也是 100 倍溢价了！&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;关键数字&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;按需价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;包月价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;包年价格&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;预付三年&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;预付五年&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;配上64x存储价格&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;571 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;381 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;298 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;181 ¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;165 ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;是自建价格的几倍&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;25x&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;17x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;13x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8x&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;7x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;自建成本可降低%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;96%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;94%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;92%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;88%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;86%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;自建成本可降至 %&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;12%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;14%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;在《&lt;a href=&#34;/zh/blog/cloud/ebs&#34;&gt;云盘是不是杀猪盘&lt;/a&gt;》中我们已经详细对比过云盘与本地盘的性能、可靠性与成本，因此这里主要使用与本地 NVMe SSD 最接近的 ESSD 云盘 PL3 作为对比。如果我们为每核 CPU 配置 64 GiB 的 PL3 块存储，则调整后的云服务器单价为：&lt;strong&gt;381 ¥&lt;/strong&gt;。在此基础上：按量付费需要额外支付 50% 溢价，为 &lt;strong&gt;571 ¥&lt;/strong&gt;；包年预付为 &lt;strong&gt;298 ¥&lt;/strong&gt;，包三年可以打 44 折为 &lt;strong&gt;181 ¥&lt;/strong&gt;，预付五年可以打三折为 &lt;strong&gt;165&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;与 DHH / 探探自建的含存储单价 &lt;strong&gt;22.4 ¥&lt;/strong&gt; 相比，云服务器单价达到了自建的 &lt;strong&gt;6 ～ 25&lt;/strong&gt; 倍！&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://demo.pigsty.cc/d/ecs?viewPanel=79&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ecs/ecs-1.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;图：带64x存储单价对比&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&#34;云存储对单价的影响&#34;&gt;云存储对单价的影响&lt;/h2&gt;
&lt;p&gt;在影响服务器价格的因素中，存储是变数最大的一个。&lt;/p&gt;
&lt;p&gt;例如，以上面的标准配置：&lt;strong&gt;1核:4x内存:64x存储&lt;/strong&gt;，在使用不同规格的 ESSD 的情况下，存储费用占服务器费用的比例差异非常之大。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://demo.pigsty.cc/d/ecs?viewPanel=69&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ecs/ecs-3.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;使用 PL3 ESSD 的情况下，&lt;strong&gt;存储费用占比&lt;/strong&gt;可以达到 &lt;strong&gt;67% ~ 77%&lt;/strong&gt;，我们也可以选择更烂的乞丐盘作为存储，以IOPS/带宽吞吐性能为代价 “降低成本”。例如，使用 PL2 以牺牲 &lt;strong&gt;90%&lt;/strong&gt; 的 IOPS 性能为代价，将这一比例降低至 51% ～ 63%，PL1/PL Auto 以牺牲 95% 的性能为代价，将此比例降低至 34% ～ 46%。PL0 则以 99% 的性能为代价，将此比例降低至 20% ～ 30% 。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;云盘规格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付五年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付四年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付三年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付二年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;包年价格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;包月价格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;按量付费&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;+PL3 ESSD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥165&lt;/td&gt;
&lt;td&gt;¥172&lt;/td&gt;
&lt;td&gt;¥181&lt;/td&gt;
&lt;td&gt;¥247&lt;/td&gt;
&lt;td&gt;¥298&lt;/td&gt;
&lt;td&gt;¥381&lt;/td&gt;
&lt;td&gt;¥571&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;+PL2 ESSD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥101&lt;/td&gt;
&lt;td&gt;¥108&lt;/td&gt;
&lt;td&gt;¥117&lt;/td&gt;
&lt;td&gt;¥158&lt;/td&gt;
&lt;td&gt;¥190&lt;/td&gt;
&lt;td&gt;¥253&lt;/td&gt;
&lt;td&gt;¥379&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;+PL1 ESSD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥69&lt;/td&gt;
&lt;td&gt;¥76&lt;/td&gt;
&lt;td&gt;¥85&lt;/td&gt;
&lt;td&gt;¥113&lt;/td&gt;
&lt;td&gt;¥135&lt;/td&gt;
&lt;td&gt;¥189&lt;/td&gt;
&lt;td&gt;¥283&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;+PL0 ESSD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥53&lt;/td&gt;
&lt;td&gt;¥60&lt;/td&gt;
&lt;td&gt;¥69&lt;/td&gt;
&lt;td&gt;¥91&lt;/td&gt;
&lt;td&gt;¥108&lt;/td&gt;
&lt;td&gt;¥157&lt;/td&gt;
&lt;td&gt;¥235&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;纯算力价格&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥37&lt;/td&gt;
&lt;td&gt;¥44&lt;/td&gt;
&lt;td&gt;¥53&lt;/td&gt;
&lt;td&gt;¥68&lt;/td&gt;
&lt;td&gt;¥81&lt;/td&gt;
&lt;td&gt;¥125&lt;/td&gt;
&lt;td&gt;¥187&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;请注意，ESSD 块存储和 ECS 算力的折扣力度是不同步的，由于 SSD 的顶配折扣（5折）比纯算力的顶配折扣（3折）要更弱，所以存储费用比例随着预付费时间增加会越来越高。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;云盘规格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付五年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付四年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付三年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付二年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;包年价格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;包月价格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;按量付费&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;+PL3 ESSD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;77%&lt;/td&gt;
&lt;td&gt;75%&lt;/td&gt;
&lt;td&gt;71%&lt;/td&gt;
&lt;td&gt;72%&lt;/td&gt;
&lt;td&gt;73%&lt;/td&gt;
&lt;td&gt;67%&lt;/td&gt;
&lt;td&gt;67%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;+PL2 ESSD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;63%&lt;/td&gt;
&lt;td&gt;60%&lt;/td&gt;
&lt;td&gt;55%&lt;/td&gt;
&lt;td&gt;57%&lt;/td&gt;
&lt;td&gt;57%&lt;/td&gt;
&lt;td&gt;51%&lt;/td&gt;
&lt;td&gt;51%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;+PL1 ESSD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;46%&lt;/td&gt;
&lt;td&gt;42%&lt;/td&gt;
&lt;td&gt;38%&lt;/td&gt;
&lt;td&gt;40%&lt;/td&gt;
&lt;td&gt;40%&lt;/td&gt;
&lt;td&gt;34%&lt;/td&gt;
&lt;td&gt;34%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;+PL0 ESSD&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;27%&lt;/td&gt;
&lt;td&gt;23%&lt;/td&gt;
&lt;td&gt;25%&lt;/td&gt;
&lt;td&gt;25%&lt;/td&gt;
&lt;td&gt;20%&lt;/td&gt;
&lt;td&gt;20%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;纯算力价格&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;0%&lt;/td&gt;
&lt;td&gt;0%&lt;/td&gt;
&lt;td&gt;0%&lt;/td&gt;
&lt;td&gt;0%&lt;/td&gt;
&lt;td&gt;0%&lt;/td&gt;
&lt;td&gt;0%&lt;/td&gt;
&lt;td&gt;0%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;有人主张说，云上的 ESSD 应该和 SAN 存储对比，本地 NVMe SSD 应该与实例存储进行对比。在《&lt;strong&gt;&lt;a href=&#34;/zh/blog/cloud/ebs&#34;&gt;云盘是不是杀猪盘&lt;/a&gt;&lt;/strong&gt;》中已经解释过这个问题。直接面向用户的数据库类服务使用的几乎都是 EBS 而非实例存储；此外，阿里云并非没有带本地 NVMe SSD 实例存储的机型，例如 &lt;code&gt;i&lt;/code&gt; 系列，但这里的单价也远远说不上便宜。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;预付费对单价的影响&#34;&gt;预付费对单价的影响&lt;/h2&gt;
&lt;p&gt;预付费方式对云服务器的价格有着显著影响：&lt;strong&gt;算力的价格以包月价格作为标准&lt;/strong&gt;，按需付费价格上浮 50%，包年打 65 折，包二、三、四、五年的折扣分别是55，44，35，30 折。存储的价格同样以包月价格作为基准，按需付费的价格上浮 51.25%，包年打85折，两年七折，三年以上五折。ECS 算力的单价（¥/核月）与块存储 ESSD 的单价（¥/GiB月）和折扣规则如下表所示：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;付费模式&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;算力折扣&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;算力单价&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ESSD折扣&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;PL3&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;PL2&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;PL1&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;PL0&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;按量付费&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;150%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;187&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;151.25%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6.05&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.02&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.51&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.76&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;包月付费&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;100%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;125&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;100%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;预付一年&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;65%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;81&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;85%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.40&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.70&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.85&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.43&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;预付二年&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;55%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;68&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;70%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.80&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.40&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.70&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.35&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;预付三年&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;44%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;53&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;50%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.50&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.25&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;预付四年&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;35%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;44&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;50%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.50&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.25&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;预付五年&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;30%&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;37&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;50%&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.50&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0.25&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;对于纯算力来说，最近三代主流实例族的价格与比例如下表所示，不难看出实际定价相当符合上面给出的模型：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;实例族单价&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付五年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付四年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付三年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付二年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;包年价格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;包月价格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;按量付费&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;c6&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥27&lt;/td&gt;
&lt;td&gt;¥31&lt;/td&gt;
&lt;td&gt;¥38&lt;/td&gt;
&lt;td&gt;¥49&lt;/td&gt;
&lt;td&gt;¥58&lt;/td&gt;
&lt;td&gt;¥88&lt;/td&gt;
&lt;td&gt;¥133&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;c7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥28&lt;/td&gt;
&lt;td&gt;¥33&lt;/td&gt;
&lt;td&gt;¥38&lt;/td&gt;
&lt;td&gt;¥52&lt;/td&gt;
&lt;td&gt;¥62&lt;/td&gt;
&lt;td&gt;¥96&lt;/td&gt;
&lt;td&gt;¥144&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;c8i&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥30&lt;/td&gt;
&lt;td&gt;¥35&lt;/td&gt;
&lt;td&gt;¥44&lt;/td&gt;
&lt;td&gt;¥56&lt;/td&gt;
&lt;td&gt;¥66&lt;/td&gt;
&lt;td&gt;¥101&lt;/td&gt;
&lt;td&gt;¥152&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;g6&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥34&lt;/td&gt;
&lt;td&gt;¥40&lt;/td&gt;
&lt;td&gt;¥49&lt;/td&gt;
&lt;td&gt;¥62&lt;/td&gt;
&lt;td&gt;¥74&lt;/td&gt;
&lt;td&gt;¥114&lt;/td&gt;
&lt;td&gt;¥170&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;g7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥37&lt;/td&gt;
&lt;td&gt;¥43&lt;/td&gt;
&lt;td&gt;¥52&lt;/td&gt;
&lt;td&gt;¥67&lt;/td&gt;
&lt;td&gt;¥79&lt;/td&gt;
&lt;td&gt;¥123&lt;/td&gt;
&lt;td&gt;¥185&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;g8i&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥39&lt;/td&gt;
&lt;td&gt;¥46&lt;/td&gt;
&lt;td&gt;¥56&lt;/td&gt;
&lt;td&gt;¥72&lt;/td&gt;
&lt;td&gt;¥85&lt;/td&gt;
&lt;td&gt;¥130&lt;/td&gt;
&lt;td&gt;¥195&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;r6&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥45&lt;/td&gt;
&lt;td&gt;¥53&lt;/td&gt;
&lt;td&gt;¥65&lt;/td&gt;
&lt;td&gt;¥83&lt;/td&gt;
&lt;td&gt;¥98&lt;/td&gt;
&lt;td&gt;¥150&lt;/td&gt;
&lt;td&gt;¥225&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;r7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥49&lt;/td&gt;
&lt;td&gt;¥57&lt;/td&gt;
&lt;td&gt;¥70&lt;/td&gt;
&lt;td&gt;¥89&lt;/td&gt;
&lt;td&gt;¥105&lt;/td&gt;
&lt;td&gt;¥164&lt;/td&gt;
&lt;td&gt;¥246&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;r8i&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;¥52&lt;/td&gt;
&lt;td&gt;¥61&lt;/td&gt;
&lt;td&gt;¥75&lt;/td&gt;
&lt;td&gt;¥95&lt;/td&gt;
&lt;td&gt;¥113&lt;/td&gt;
&lt;td&gt;¥173&lt;/td&gt;
&lt;td&gt;¥260&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;实例族折扣&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付五年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付四年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付三年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;预付二年&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;包年价格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;包月价格&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;按量付费&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;c6&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;43%&lt;/td&gt;
&lt;td&gt;55%&lt;/td&gt;
&lt;td&gt;65%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;c7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;40%&lt;/td&gt;
&lt;td&gt;54%&lt;/td&gt;
&lt;td&gt;64%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;c8i&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;43%&lt;/td&gt;
&lt;td&gt;55%&lt;/td&gt;
&lt;td&gt;65%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;g6&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;43%&lt;/td&gt;
&lt;td&gt;55%&lt;/td&gt;
&lt;td&gt;65%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;g7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;43%&lt;/td&gt;
&lt;td&gt;54%&lt;/td&gt;
&lt;td&gt;64%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;g8i&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;43%&lt;/td&gt;
&lt;td&gt;55%&lt;/td&gt;
&lt;td&gt;65%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;r6&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;43%&lt;/td&gt;
&lt;td&gt;55%&lt;/td&gt;
&lt;td&gt;65%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;r7&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;43%&lt;/td&gt;
&lt;td&gt;54%&lt;/td&gt;
&lt;td&gt;64%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;r8i&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;td&gt;35%&lt;/td&gt;
&lt;td&gt;43%&lt;/td&gt;
&lt;td&gt;55%&lt;/td&gt;
&lt;td&gt;65%&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;150%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;上图展示了不同实例族在不同付费模式下的价格对比。如果我们对所有实例价格取一个平均（大致相当于 1c4g 机型的标准价），不同付费模式下的算力均价如柱状图所示：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://demo.pigsty.cc/d/ecs?viewPanel=79&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ecs/ecs-5.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;实例族对价格的影响&#34;&gt;实例族对价格的影响&lt;/h2&gt;
&lt;p&gt;实例族对价格的影响主要取决于三点：&lt;strong&gt;内存配比&lt;/strong&gt;，&lt;strong&gt;芯片架构&lt;/strong&gt;，&lt;strong&gt;实例代际&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;首先，同一实例族内的 &lt;strong&gt;实例单价与CPU核数无关&lt;/strong&gt;，即最终算力部分的价格线性正比于 CPU 核数。因此不会出现规格越大，单价越便宜或越贵的现象（这意味着云服务器实例规格越大，性价比越低）。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://demo.pigsty.cc/d/ecs?viewPanel=16&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ecs/ecs-6.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;内存配比指的是一个 CPU 核配比多少倍的内存，内存的单位是 GiB。在阿里云上，通用型（g）实例的内存配比为1:4，标记为 &lt;code&gt;4x&lt;/code&gt; ，即一核CPU配 4 GiB 内存。计算型（c）实例内存配比为 1:2，内存型（r）实例内存配比为 1:8 。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;代际&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;c 计算型 2x&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;g 通用型 4x&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;r 内存型 8x&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;c / g&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;r / g&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 88&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 114&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 150&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;78%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;132%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;7&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 96&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 123&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 164&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;78%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;133%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 101&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 130&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 173&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;78%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;133%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;从统计上看，相比 &lt;code&gt;4x&lt;/code&gt; 通用型实例族，同核数的内存型实例 &lt;code&gt;8x&lt;/code&gt; 内存翻倍，价格是通用型实例的 &lt;strong&gt;132%&lt;/strong&gt; ；同核数的计算型实例 &lt;code&gt;2x&lt;/code&gt; 内存减半，价格是通用型实例的 &lt;strong&gt;78%&lt;/strong&gt;。
我们还可以根据这里的规律计算出阿里云上内存的定价约为 12 元/GiB月：也不算便宜，16G用俩个月就够买一条了。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://demo.pigsty.cc/d/ecs?viewPanel=45&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ecs/ecs-7.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;此外，实例/CPU 的代际也对价格有影响，例如以当下的八代实例为基准，上一代 Gen7 实例的价格会在本代基础上打 95 折，再上一代 Gen6 的实例会在本代基础上打 87 折。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;代际&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;Intel&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ARM&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ARM / Intel&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;倚天&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;倚天 / Intel&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 117&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 104&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;89%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;7&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 128&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 105&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;82%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 135&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 125&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;92%&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;¥ 96&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;71%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;从芯片架构上看，ARM 实例价格是标准 Intel 实例的九折，阿里自研倚天芯片实例的价格是标准 Intel 实例的七折。30% off 就想找小白鼠尝鲜，诚意有些不足了。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;可用区对价格的影响&#34;&gt;可用区对价格的影响&lt;/h2&gt;
&lt;p&gt;从大的层面上来说，阿里云的可用区可以分为国内/国际区域，两者的价格有着泾渭分明的区别。海外可用区（包括香港）的价格要比国内可用区高很多，最贵的可用区是香港，各实例族价格几乎是国内可用区的一倍。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://demo.pigsty.cc/d/ecs?viewPanel=52&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ecs/ecs-8.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;国内可用区价格上大体分为两类：中心城市（北上广深杭+宁汉蓉榕青）和犄角旮旯（乌兰察布，河源，呼和浩特，张家口）。中心城市可用区的实例定价保持高度一致（成都例外，有几个实例族稍微便宜点）。犄角旮旯地方的实例价格会便宜一些，相比中心城市最高可能有 30% 的折扣。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://demo.pigsty.cc/d/ecs?viewPanel=21&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ecs/ecs-9.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Blog: 薅阿里云羊毛，打造数字家园</title>
      <link>/zh/blog/cloud/cheap-ecs/</link>
      <pubDate>Wed, 08 Nov 2023 00:00:00 +0000</pubDate>
      
      <guid>/zh/blog/cloud/cheap-ecs/</guid>
      <description>
        
        
        
        <![CDATA[<img src="/zh/blog/cloud/cheap-ecs/featured_hu2b0bf836dd3f8e0450a86f3a83393d4c_420162_640x0_resize_q75_catmullrom.jpg" width="640" height="640"/>]]>
        
        &lt;p&gt;阿里云双十一提供了一个不错的福利，列表价 &lt;strong&gt;¥1500/年&lt;/strong&gt; 的 2C/2G/3M ECS服务器，一年 &lt;strong&gt;¥99&lt;/strong&gt; 给用三年（99¥ 每年可续费到2026），据说还要给中国所有大学生每人免费送一台。&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;ecs-price-1.jpg&#34; src=&#34;/zh/blog/cloud/cheap-ecs/aliyun-ecs-price-1.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;虽然我经常揶揄公有云是&lt;strong&gt;杀猪盘&lt;/strong&gt;，但那是针对我们这种体量的用户。对于个人开发者而言，这种价格真的可以说是很厚道的福利了。2C/2G 倒是不值几个钱，但这个 3M 带宽和公网IP 还是很给力的。新老用户都可以买，截止到双11，我建议所有开发者都薅了这个羊毛，用来建设一个 DevBox。&lt;/p&gt;
&lt;p&gt;弄了 ECS 可以干啥用呢？你可以把它当成跳板机，临时文件中转站，搭建一个静态网站，个人博客，运行一些定时脚本跑一些服务，搭个梯子，打造自己的 Git 仓库，软件源，Wiki站点，搭建私有部署的论坛/社交媒体站点。&lt;/p&gt;
&lt;p&gt;学生可以用来学习 Linux，构建一个软件编译环境，学习各种数据库：PostgreSQL，Redis，MinIO，用 SQL 和 Python 搞搞数据分析，用 Grafana 和 Echarts 玩玩数据可视化。&lt;/p&gt;
&lt;p&gt;Pigsty 为这些需求提供了一个一键安装，开箱即用的底座，让您立刻在 ECS 上拥有一个生产级的 DevBox。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s/Nh28VahZkQMdR8fDoi0_rQ&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/cheap-ecs/featured.jpg&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;然后呢&#34;&gt;然后呢？&lt;/h3&gt;
&lt;p&gt;Pigsty 提供了开箱即用的主机/数据库监控系统，开箱即用的 Nginx Web 服务器承用于对外服务，一个功能完备，插件齐全的 PostgreSQL 数据库可以用于支持各种上层软件。在 Pigsty 的基础上，你可以很轻松的搭建一个静态网站 / 动态服务。安装完 Pigsty 后，你可以自行探索一下监控系统（Demo： &lt;a href=&#34;https://demo.pigsty.cc&#34;&gt;https://demo.pigsty.cc&lt;/a&gt; ），它展示了你的主机详情和数据库的完整监控。&lt;/p&gt;
&lt;p&gt;我们也会在后续介绍一系列有趣的主题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://vonng.com/cn/blog/note/isd/&#34;&gt;样例应用：ISD，对全球天气数据进行分析与可视化&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;数据库101：快速上手数据库全能王：PostgreSQL&lt;/li&gt;
&lt;li&gt;可视化快速上手，用 Grafana 画图进行数据分析&lt;/li&gt;
&lt;li&gt;静态网站：使用 hugo 打造你自己的静态个人网站&lt;/li&gt;
&lt;li&gt;跳板机：如何将这台 ECS 作为跳板，访问家中的电脑？&lt;/li&gt;
&lt;li&gt;站点发布：如何让用户通过域名访问你的个人网站&lt;/li&gt;
&lt;li&gt;SSL证书：如何使用 Let&amp;rsquo;s Encrypt 免费证书加密&lt;/li&gt;
&lt;li&gt;Python环境：如何在 Pigsty 配置 Python 开发环境&lt;/li&gt;
&lt;li&gt;Docker环境：如何在 Pigsty 中启用 Docker 开发环境&lt;/li&gt;
&lt;li&gt;MinIO：如何将这台 ECS 作为你的文件中转站并与他人分享？&lt;/li&gt;
&lt;li&gt;Git仓库：如何使用 Gitea + PostgreSQL 搭建自己的 Git 仓库？&lt;/li&gt;
&lt;li&gt;Wiki站点：如何使用 Wiki.js + PostgreSQL 搭建自己的 Wiki 知识库？&lt;/li&gt;
&lt;li&gt;社交网络：如何使用快速搭建 Mastodon 与 Discourse？&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;购买配置ecs&#34;&gt;购买配置ECS&lt;/h2&gt;
&lt;p&gt;作为资深 IaC 用户，我早已习惯了&lt;a href=&#34;https://pigsty.io/zh/doc/provision&#34;&gt;一键拉起&lt;/a&gt;所需的云资源，置备好所有东西。在控制台上用鼠标点点点这种活儿对我已经非常陌生了。不过我相信也有不少读者其实还并不熟悉云上的操作，所以我们尽可能详尽的展示这里的操作。如果你已经是老司机了，请直接跳过这一部分，进入 Pigsty 配置部分。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;购买活动虚拟机&#34;&gt;购买活动虚拟机&lt;/h3&gt;
&lt;p&gt;没有阿里云账号可以用手机号注册一个，然后用支付宝扫码实名认证完事。进入活动页面，立即购买。地区选一个离你位置最近的，可用区可以选字母序大一点的。操作系统网络无所谓用默认的就行后面再改，选好之后勾选最下面的：我已阅读并同意&lt;a href=&#34;http://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201912232014_30443.html&#34;&gt;云服务器ECS-包年包月服务协议&lt;/a&gt;。点击“立即购买”，支付宝付钱，完工。&lt;/p&gt;
&lt;p&gt;不差钱的话我建议直接充个三百块，锁定 99¥ 续费一年先，剩下的零钱可以花个几十块钱买个域名，补充点零用的 OSS/ESSD/流量费啥的。毕竟如果你想使用按需付费的东西，还是需要一百块抵押在里面的。&lt;/p&gt;
&lt;p&gt;直接在实例页面点 “续费”，续费1年目前的价格是 &lt;strong&gt;99¥&lt;/strong&gt; ，可以直接续上锁定下一年的优惠。当然第三年阿里云只是说到时候你可以继续用 &lt;strong&gt;99¥&lt;/strong&gt; 的价格继续续费一年到 2026，现在还操作不了。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;重装系统与密钥&#34;&gt;重装系统与密钥&lt;/h3&gt;
&lt;p&gt;购买完云服务器后，点击控制台。或者左上角 Logo 边上的菜单图标进入 ECS 控制台，然后就能看到你买的实例已经运行了。我们可以在这里进一步配置网络、操作系统，以及密码密钥。&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;instance-summary.jpg&#34; src=&#34;/zh/blog/cloud/cheap-ecs/aliyun-instance-summary.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;直接点实例边上的  “停止”，点击实例名称链接进入详情页，选择“更换操作系统”。然后选择“公共镜像”，选择你想用的操作系统镜像就好了。Pigsty 支持 EL 7/8/9 以及兼容操作系统，Ubuntu 22.04/22.04 ，Debian 12/11。&lt;/p&gt;
&lt;p&gt;这里我们推荐使用 &lt;strong&gt;RockyLinux 8.8 64位&lt;/strong&gt;，这是目前主流的企业级操作系统，在稳定性和软件新鲜度上取得了一个均衡。 &lt;strong&gt;OpenAnolis 8.8 RHCK&lt;/strong&gt;， &lt;strong&gt;RockyLinux 9.2&lt;/strong&gt; ，或者 &lt;strong&gt;Ubuntu 22.04&lt;/strong&gt; 也是不错的选择，不过我们后面演示用的都是 &lt;strong&gt;Rocky 8.8&lt;/strong&gt;，初学者最好还是不要在这里过多折腾为妙。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;《EL系统兼容性哪家强？》&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在安全设置中，你可以设置 &lt;code&gt;root&lt;/code&gt; 用户密码/密钥。如果你没有 SSH 密钥，可以使用 &lt;code&gt;ssh-keygen&lt;/code&gt; 生成一对，或者直接填一个文本密码，这里我们方便起见随便设置一个。设置好了之后，你就可以使用 &lt;code&gt;ssh root@&amp;lt;ip&amp;gt;&lt;/code&gt; 的方式登陆该服务器了（SSH客户端这种问题就不在这儿展开了，iTerm, putty, xshell, secureCRT 都行）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh-keygen              &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 如果你没有 SSH 密钥对，生成一对。&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh-copy-id  root@&amp;lt;ip&amp;gt;  &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 将你的ssh密钥添加到服务器上（输入密码）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;配置域名与dns&#34;&gt;配置域名与DNS&lt;/h3&gt;
&lt;p&gt;域名现在非常便宜了，一年也就十几块钱。我非常建议整一个，能够带来很大的便利。主要是你可以用不同的子域名来区分不同的服务，让 Nginx 把流量转发到不同的上游去，一机多用。当然，喜欢用 IP 地址 + 端口号直接访问不同服务也无所谓。主要是一来比较土鳖，二来端口开的太多也会有更多安全隐患。&lt;/p&gt;
&lt;p&gt;比如这里，我花了十几块钱在阿里云上买了个 &lt;code&gt;pdata.cc&lt;/code&gt; 的域名，然后在阿里云DNS控制台上就可以去添加域名的解析了，指向刚申请服务器的 IP 地址。一条 &lt;code&gt;@&lt;/code&gt; 记录，一条 &lt;code&gt;*&lt;/code&gt; 通配记录，A 记录，指向 ECS 实例的&lt;strong&gt;公网IP地址&lt;/strong&gt;就行。&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;dns-resolv.jpg&#34; src=&#34;/zh/blog/cloud/cheap-ecs/aliyun-dns-resolv.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;有了域名之后，你就可以用 &lt;code&gt;ssh root@pdata.cc&lt;/code&gt; 的方式登陆，不用再记 IP 地址了。你也可以在这里配置更多的子域名，指向不同的地址。如果域名是拿来建站的，在中国大陆还需要申请备案，反正阿里云也有一条龙的服务。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;配置安全组规则&#34;&gt;配置安全组规则&lt;/h3&gt;
&lt;p&gt;新创建的云服务器带有默认的安全组规则，只允许 SSH 服务也就是 22 端口访问。所以为了访问这台服务器上的 Web 服务你还需要打开 80/443 端口。如果你懒得折腾域名想用 IP + 端口直接访问相应服务，而不是通过域名走 Nginx 的 80/443 端口，那么 Grafana 监控界面的 3000 端口也应该打开。最后，如果你想从本地访问 PostgreSQL 数据库，也可以考虑打开 &lt;code&gt;5432&lt;/code&gt; 端口。&lt;/p&gt;
&lt;p&gt;如果你想偷懒，确实可以添加一条开放所有端口的规则，但云服务器不比自己的笔记本，你也不想自己的 ECS 被人黑了拿去干坏事被封号吧。所以这里我们还是按规矩来。实例详情页里点击安全组，然后点击那个具体的安全组进入详情页进行配置：&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;security-group.jpg&#34; src=&#34;/zh/blog/cloud/cheap-ecs/aliyun-security-group.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;在默认的 “入方向” 上添加一条“允许”规则，协议选择 &lt;code&gt;TCP&lt;/code&gt;，端口范围填入 &lt;code&gt;80/443/3000/5432&lt;/code&gt;，从 &lt;code&gt;0.0.0.0/0&lt;/code&gt; 任意地址都可以访问这些端口。&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;security-group-rule.jpg&#34; src=&#34;/zh/blog/cloud/cheap-ecs/aliyun-security-group-rule.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;上面这些操作属于 Linux 101 基础知识老生常谈，对老司机来说，使用 Terraform 模板一行命令就完成了。但很多初学者确实不知道如何去弄。&lt;/p&gt;
&lt;p&gt;总之，折腾完上面的步骤之后，你就有一台准备就绪的云服务器了！你可以在任意有网络的地方使用域名登陆/访问这台服务器。接下来，我们就可以在开始建设数字家园了：安装 Pigsty。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;安装配置pigsty&#34;&gt;安装配置Pigsty&lt;/h2&gt;
&lt;p&gt;现在，你已经可以使用 root 用户，通过 SSH 登陆这台服务器了，接下来就可以下载、安装、配置 Pigsty 了。&lt;/p&gt;
&lt;p&gt;尽管使用 &lt;code&gt;root&lt;/code&gt; 用户并非生产最佳实践，但对于个人 DevBox 来说没啥关系，我们就不折腾新建管理用户这摊子事儿了。直接使用 &lt;code&gt;root&lt;/code&gt; 用户开干：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -fsSL https://repo.pigsty.io/get &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;|&lt;/span&gt; bash  &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 下载 Pigsty 并解压到 ~/pigsty 目录&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#204a87&#34;&gt;cd&lt;/span&gt; ~/pigsty      &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 进入 Pigsty 源码目录，完成后续 准备、配置、安装 三个步骤即可&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./bootstrap      &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 确保 Ansible 正常安装，如果存在 /tmp/pkg.tgz 离线软件包，便使用它。&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./configure      &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 执行环境检测，并生成相应的推荐配置文件，如果你知道如何配置 Pigsty 可以跳过&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./install.yml    &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 根据生成的配置文件开始在当前节点上执行安装，使用离线安装包大概需要10分钟完成&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Pigsty 官方文档提供了详细的安装配置教程：https://pigsty.cc/doc/#/zh/INSTALL&lt;/p&gt;
&lt;p&gt;安装完成后，您可以通过域名或&lt;code&gt;80/443&lt;/code&gt;端口通过 Nginx 访问 WEB 界面，通过 &lt;code&gt;5432&lt;/code&gt; 端口访问默认的 PostgreSQL 数据库服务，通过 &lt;code&gt;3000&lt;/code&gt; 端口登陆 Grafana。&lt;/p&gt;
&lt;p&gt;在浏览器中输入 &lt;code&gt;http://&amp;lt;公网IP&amp;gt;:3000&lt;/code&gt;，即可访问 Pigsty 的 Grafana 监控系统。 ECS 的 3M 带宽小水管会在初次加载 Grafana 时费点功夫。 您可以匿名访问，也可以使用默认的用户名密码 &lt;code&gt;admin&lt;/code&gt; / &lt;code&gt;pigsty&lt;/code&gt; 登陆。请务必修改这个默认密码，避免别人随便从这里进入搞破坏。&lt;/p&gt;
&lt;p&gt;上面这个教程看上去真的很简单对吧？对的。作为一台随时可以销毁重建的开发机，这么搞毫无问题。但如果你想把它作为一个承载个人数字家园的环境，请最好参考下面的 &lt;strong&gt;配置详情&lt;/strong&gt;  和 &lt;strong&gt;安全加固&lt;/strong&gt; 部分再进行动手。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;配置详情&#34;&gt;配置详情&lt;/h3&gt;
&lt;p&gt;当您安装 Pigsty 运行 &lt;code&gt;configure&lt;/code&gt; 这一步时，Pigsty 会根据您的机器环境，生成一个单机安装的配置文件：&lt;code&gt;pigsty.yml&lt;/code&gt;。默认的配置文件可以直接用，但你可以进一步进行定制修改，来增强其安全性与便利性。&lt;/p&gt;
&lt;p&gt;下面是一个推荐的配置文件样例，它应当默认在 &lt;code&gt;/root/pigsty/pigsty.yml&lt;/code&gt; 这里，描述你需要的数据库。Pigsty 提供了 280+ 定制参数，但你只需要关注几个进行微调即可。你的机器内网IP地址，可选的公网域名，以及各种密码。域名是可选的，但我们建议你最好用一个。其他的密码你懒得修改也就算了，&lt;code&gt;pg_admin_password&lt;/code&gt; 请务必修改一个。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#000&#34;&gt;---&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;all&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;children&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 这里的 10.10.10.10 都应该是你 ECS 的内网 IP 地址，用于安装 Infra/Etcd 模块&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;infra&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;hosts&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;10.10.10.10&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;infra_seq&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;etcd&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;hosts&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;10.10.10.10&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;etcd_seq: 1 } }, vars&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;etcd_cluster&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;etcd } }&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 定义一个单节点的 PostgreSQL 数据库实例&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg-meta&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;hosts&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;10.10.10.10&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_seq: 1, pg_role&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;primary } }&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;vars&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_cluster&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;pg-meta&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_databases&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;- {&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name: meta ,baseline: cmdb.sql ,schemas&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;pigsty ] }&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_users&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 最好把这里的两个样例用户的密码也修改一下&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;- {&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name: dbuser_meta ,password: DBUser.Meta   ,roles&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;dbrole_admin ] }&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;- {&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name: dbuser_view ,password: DBUser.Viewer ,roles&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;dbrole_readonly ] }&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_conf&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;tiny.yml  &lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 2C/2G 的云服务器，使用微型数据库配置模板&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;node_tune&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;tiny    &lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 2C/2G 的云服务器，使用微型主机节点参数优化模板&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pgbackrest_enabled&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 这么点磁盘空间，就别搞数据库物理备份了&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_default_version&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;13&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;   &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 用 PostgreSQL 13&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;vars&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;version&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v2.5.0&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;region&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;china&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;admin_ip&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;10.10.10.10&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 这个 IP 地址应该是你 ECS 的内网IP地址&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;infra_portal&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 如果你有自己的 DNS 域名，这里面的域名后缀 pigsty 换成你自己的 DNS 域名&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;home&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;h.pigsty }&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;grafana&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: g.pigsty ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;${admin_ip}:3000&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;, websocket&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;prometheus&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: p.pigsty ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;${admin_ip}:9090&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;alertmanager&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: a.pigsty ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;${admin_ip}:9093&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;minio&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: sss.pigsty  ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;${admin_ip}:9001&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;,scheme: https ,websocket&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;postgrest&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: api.pigsty  ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;127.0.0.1:8884&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pgadmin&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: adm.pigsty  ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;127.0.0.1:8885&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pgweb&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: cli.pigsty  ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;127.0.0.1:8886&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;bytebase&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: ddl.pigsty  ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;127.0.0.1:8887&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;gitea&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: git.pigsty  ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;127.0.0.1:8889&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;wiki&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: wiki.pigsty ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;127.0.0.1:9002&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;noco&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: noco.pigsty ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;127.0.0.1:9003&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;supa&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;domain: supa.pigsty ,endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;10.10.10.10:8000&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;, websocket&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;blackbox&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;${admin_ip}:9115&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;loki&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;endpoint&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;${admin_ip}:3100&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# 把这里的密码都改掉！你也不想别人随便来串门对吧！&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_admin_password&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;DBUser.DBA&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_monitor_password&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;DBUser.Monitor&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;pg_replication_password&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;DBUser.Replicator&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;patroni_password&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Patroni.API&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;haproxy_admin_password&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;pigsty&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;grafana_admin_password&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;pigsty&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;...&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;configure&lt;/code&gt; 生成的配置文件中，所有 &lt;code&gt;10.10.10.10&lt;/code&gt; 这个 IP 地址都会被替换为你的 ECS 实例的首要内网 IP 地址。注意：&lt;strong&gt;不要在这里使用公网 IP 地址&lt;/strong&gt;。在 &lt;code&gt;infra_portal&lt;/code&gt; 参数中，你可以把所有的 &lt;code&gt;.pigsty&lt;/code&gt;  域名后缀换成你新申请的域名，比如 &lt;code&gt;pdata.cc&lt;/code&gt; ，这样 Pigsty 会允许您通过 Nginx 使用不同域名来访问不同的上游服务。后面如果您希望添加几个个人网站，也可以在这个配置里直接修改并应用。&lt;/p&gt;
&lt;p&gt;修改好配置文件 &lt;code&gt;pigsty.yml&lt;/code&gt; 之后，运行 &lt;code&gt;./install.yml&lt;/code&gt; 即可开始安装。&lt;/p&gt;
&lt;h3 id=&#34;安全加固&#34;&gt;安全加固&lt;/h3&gt;
&lt;p&gt;大多数人可能都不在乎安全这个事，但我还是必须要说一下。只要你改了默认密码，ECS 和 Pigsty 的默认配置对大多数场景已经足够安全了。这里有一些安全加固的小建议：https://pigsty.cc/doc/#/zh/SECURITY&lt;/p&gt;
&lt;p&gt;第一个要点是，出于安全考虑：除非你真的很想偷懒从本地直接访问远程数据库，一般不建议对公网开放 5432 端口，很多数据库工具都提供了 SSH Tunel 功能 —— 先 SSH 到服务器再本地连接数据库。（顺带一提，Intellij 自带的 Database Tool 是我用过最好用的数据库客户端工具）&lt;/p&gt;
&lt;p&gt;如果你真的很想从本地直连远程数据库，Pigsty 默认规则也允许您使用默认的超级用户 &lt;code&gt;dbuser_dba&lt;/code&gt; 使用 SSL / 密码认证从任何地方访问，请确保你改了 &lt;code&gt;pg_admin_password&lt;/code&gt; 参数，并开放了 5432 端口。&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;ssh-tunel.jpg&#34; src=&#34;/zh/blog/cloud/cheap-ecs/aliyun-ssh-tunel.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;第二个要点是使用域名而非 IP 地址访问，就要求你做一些额外的工作：域名可以在云厂商那里买，也可以使用本地 &lt;code&gt;/etc/hosts&lt;/code&gt; 的静态解析记录作为下位替代。如果您实在懒得折腾，IP 地址 + 端口直连也不是不行。&lt;/p&gt;
&lt;p&gt;第三个要点是使用 HTTPS， SSL 可以使用各家云厂商或 Let&amp;rsquo;s Encrypt 提供的免费证书，使用 Pigsty 默认的自签名 CA 颁发的证书作为下位替代。&lt;/p&gt;
&lt;p&gt;Pigsty默认使用自动生成的自签名的CA证书为Nginx启用SSL，如果您希望使用 HTTPS 访问这些页面，而不弹窗提示&amp;quot;不安全&amp;quot;，通常有三个选择：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在您的浏览器或操作系统中信任Pigsty自签名的CA证书： &lt;code&gt;files/pki/ca/ca.crt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;如果您使用 Chrome，可以在提示不安全的窗口键入 &lt;code&gt;thisisunsafe&lt;/code&gt; 跳过提示&lt;/li&gt;
&lt;li&gt;您可以考虑使用 Let&amp;rsquo;s Encrypt 或其他免费的CA证书服务，为 Pigsty Nginx 生成正式的CA证书&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我们会在后面的教程中详细介绍这些细节，你也可以参考 Pigsty 的文档进行自行配置。&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
