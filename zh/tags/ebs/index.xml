<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pigsty – EBS</title>
    <link>/zh/tags/ebs/</link>
    <description>Recent content in EBS on Pigsty</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Wed, 22 May 2024 00:00:00 +0000</lastBuildDate>
    
	  <atom:link href="/zh/tags/ebs/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Blog: Ahrefs不上云，省下四亿美元</title>
      <link>/zh/blog/cloud/ahrefs-saving/</link>
      <pubDate>Wed, 22 May 2024 00:00:00 +0000</pubDate>
      
      <guid>/zh/blog/cloud/ahrefs-saving/</guid>
      <description>
        
        
        
        <![CDATA[<img src="/zh/blog/cloud/ahrefs-saving/featured_hu00302667d3701b11bccc08ee71ddf5da_303152_640x0_resize_q75_h2_catmullrom_2.webp" width="640" height="366"/>]]>
        
        &lt;blockquote&gt;
&lt;p&gt;原文：&lt;a href=&#34;https://tech.ahrefs.com/how-ahrefs-saved-us-400m-in-3-years-by-not-going-to-the-cloud-8939dd930af8&#34;&gt;How Ahrefs Saved US$400M in 3 Years by NOT Going to the Cloud&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;最近云计算在 IT 基础设施领域非常流行，上云成为一种趋势。基础设施即服务云（IaaS）确实有很多优点：灵活、部署敏捷、伸缩简便、在全球多地区都能即时上线，等等等等。&lt;/p&gt;
&lt;p&gt;云服务提供商已经成为专业的 IT 服务外包供应商，提供便捷且易用的服务 —— 通过出色的营销、会议、认证和精心挑选的使用案例，他们很容易让人以为，云计算是现代企业 IT 的唯一合理选择。&lt;/p&gt;
&lt;p&gt;但是，这些外包云计算服务的成本，有时高到离谱，高到我们担心如果基础设施 100% 依赖云计算，我们的业务是否还能存在。这促使我们基于事实，进行实际的比较。以下是比较结果：&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ahrefs-自有硬件概览&#34;&gt;Ahrefs 自有硬件概览&lt;/h2&gt;
&lt;p&gt;Ahrefs 在新加坡租用了一个托管数据中心 —— 高度同质化的标准基础设施。我们核算了这个数据中心的所有成本，并分摊到每台服务器上，然后与 Amazon Web Services (AWS) 云中进行类似的规格进行了成本对比（因为 AWS 是 IaaS 领导者，所以我们将其用作对比的标杆）&lt;/p&gt;
&lt;figure class=&#34;card rounded p-2 td-post-card mb-4 mt-4&#34; style=&#34;max-width: 276px&#34;&gt;
&lt;img class=&#34;card-img-top&#34; src=&#34;/zh/blog/cloud/ahrefs-saving/server1_hu0fc518b27bb3d90eb3dc4138277e8696_1073778_800x400_fit_q75_h2_catmullrom_2.webp&#34; width=&#34;266&#34; height=&#34;400&#34;&gt;
&lt;figcaption class=&#34;card-body px-0 pt-2 pb-0&#34;&gt;
&lt;p class=&#34;card-text&#34;&gt;
&lt;p&gt;Ahrefs 服务器&lt;/p&gt;
&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;我们的硬件相对较新。托管合同始于 2020 年中 —— 即 COVID-19 疫情高峰期。所有设备也都是从那时候起新买的。我们在该数据中心的服务器配置基本都是一致的，唯一的区别是 CPU 有两种代际，但核数相同。我们每台服务器都有很高的核数，2TB 内存和两个 100G 网口，硬盘的话，平均每台服务器有16块 15TB 的硬盘。&lt;/p&gt;
&lt;p&gt;为了计算每月成本，我们把所有硬件按五年摊销归零核算，超过五年后继续用算白赚。因此这些设备的 &lt;strong&gt;启动成本&lt;/strong&gt;，会摊销到 60 个月中进行核算。&lt;/p&gt;
&lt;p&gt;所有的 &lt;strong&gt;持续性成本&lt;/strong&gt;，例如租金和电费，均以 2022 年 10 月的价格计算。尽管通货膨胀也会有影响，但这里把通胀算上就太复杂了，所以我们先忽略通胀因素。&lt;/p&gt;
&lt;p&gt;我们的托管费用由两部分组成：&lt;strong&gt;租金&lt;/strong&gt;，以及 &lt;strong&gt;实际消耗的电费&lt;/strong&gt;。自 2022 年初以来，电价大幅上涨。我们计算的时候使用的是最新的高电价，而不是整个租赁周期的的平均电价，这样计算上会让 AWS 占些便宜。&lt;/p&gt;
&lt;p&gt;此外，我们还要支付 IP 网络传输费用，和数据中心与我们驻地之间的暗光纤费用（暗光纤：已经铺设但是没有投入使用的光缆）。&lt;/p&gt;
&lt;p&gt;下表显示了我们每台服务器的月度支出。服务器硬件占整体月度支出的 2/3，而数据中心租金和电费 (DC)、互联网服务提供商 (ISP) 的 IP 传输费用、暗光纤 (DF) 和内部网络硬件 (Network HW) 构成了剩余的三分之一。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;自建成本项&lt;/th&gt;
&lt;th&gt;每月成本（美元）&lt;/th&gt;
&lt;th&gt;每月成本（人民币）&lt;/th&gt;
&lt;th&gt;百分比&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;服务器&lt;/td&gt;
&lt;td&gt;$ 1,025&lt;/td&gt;
&lt;td&gt;¥ 7,380&lt;/td&gt;
&lt;td&gt;66%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;数据中心、ISP、DF、网络硬件&lt;/td&gt;
&lt;td&gt;$ 524&lt;/td&gt;
&lt;td&gt;¥ 3,772.8&lt;/td&gt;
&lt;td&gt;34%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;自建总成本&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;$ 1,550&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;¥ 11,160&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;我们的自有本地硬件成本结构&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&#34;aws-成本结构&#34;&gt;AWS 成本结构&lt;/h2&gt;
&lt;p&gt;由于我们托管的数据中心位于新加坡，所以我们使用 AWS 亚太地区（新加坡）区域的价格进行对比。&lt;/p&gt;
&lt;p&gt;AWS 的成本结构与托管中心不同。不幸的是，AWS 没有提供与我们服务器核数相匹配的 EC2 服务器实例。因此，我们找到了CPU &amp;amp; 内存正好是一半的相应 AWS 实例，然后将一台 Ahrefs 服务器的成本，与两台这种 EC2 实例的成本进行对比。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;译注：EC2 定价正比与核数与内存配比，这样成本对比没有问题&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;此外我们考虑了长期折扣，因此我们使用 EC2 实例的最低价格 —— 三年预留，与五年摊销的本地自建服务器进行对比。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;译注：AWS EC2 三年 Reserved All Upfront 即提供最好的折扣&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;除了 EC2 实例外，我们还添加了弹性块存储 (EBS) ，它并不是直接附加存储的精准替代品 —— 因为我们在服务器中使用的是大容量且快速的 NVMe 盘。为了简化计算，我们选择了更便宜的 gp3 EBS（尽管这种盘速度比我们的慢很多）。其成本由两部分组成：存储大小和 IOPS 费用。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;译注：EBS &lt;code&gt;gp3&lt;/code&gt; 延迟在 ms 量级，&lt;code&gt;io2&lt;/code&gt; 在百微秒量级，本地盘在 55/9µs 量级&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We keep two copies of a data chunk on our servers. But we only order usable space in EBS that takes care of the replication for us. So we should consider the price of the &lt;em&gt;gp3&lt;/em&gt; storage size equal to the size of our drives divided by 2: (1&lt;em&gt;1TB + 16&lt;/em&gt;15TB)/2 ≈ 120TB per server.&lt;/p&gt;
&lt;p&gt;因为我们自己用磁盘的时候会复制一份，但是买 EBS 的时候只买实际存储空间，EBS 替你处理数据复制。
所以在成本对比时，我们购买的 &lt;code&gt;gp3&lt;/code&gt; 存储大小是本地磁盘的一半：(1TB + 15TB 16块) / 2 ≈ 每台服务器 120TB。&lt;/p&gt;
&lt;p&gt;我们还没有把 IOPS 的成本算进来，也忽略了 EBS gp3 的各种限制；例如，gp3 云盘的最大吞吐量/实例为 &lt;strong&gt;10GB/s&lt;/strong&gt;。而单个 PCIe Gen 4 NVMe 驱动器的性能为 &lt;strong&gt;6-7GB/s&lt;/strong&gt;，而我们有 16 个并行工作的磁盘，总吞吐要大的多。因此，这完全不是一个维度上的公平比较。这种比较方法显著低估了 AWS 上的存储成本，并进一步让 AWS 在比较中占尽便宜。&lt;/p&gt;
&lt;p&gt;关于网络流量费用，AWS 与托管机房不同，AWS 不是按照带宽来计费的，而是按每GB下行流量来收费。因此，我们大致估算了每台服务器的平均下行流量，然后使用 AWS 网络计费方法进行估算。&lt;/p&gt;
&lt;p&gt;将所有三项成本组合起来，我们得到了 AWS 上的的成本分布，如下表所示&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;AWS 成本项&lt;/th&gt;
&lt;th&gt;每月成本（美元）&lt;/th&gt;
&lt;th&gt;每月成本（人民币）&lt;/th&gt;
&lt;th&gt;百分比&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;EBS 成本&lt;/td&gt;
&lt;td&gt;$ 11,486&lt;/td&gt;
&lt;td&gt;¥ 82,699.2&lt;/td&gt;
&lt;td&gt;65%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;EC2 成本&lt;/td&gt;
&lt;td&gt;$ 5,607&lt;/td&gt;
&lt;td&gt;¥ 40,370.4&lt;/td&gt;
&lt;td&gt;32%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;数据传输&lt;/td&gt;
&lt;td&gt;$ 464&lt;/td&gt;
&lt;td&gt;¥ 3,340.8&lt;/td&gt;
&lt;td&gt;3%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;AWS 总成本&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;$ 17,557&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;¥ 126,410.4&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;AWS成本结构&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&#34;自建与aws对比&#34;&gt;自建与AWS对比&lt;/h2&gt;
&lt;p&gt;综合以上两个表格不难看出，AWS 上的支出比想象中要高得多。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;自建成本项&lt;/th&gt;
&lt;th&gt;月成本 $&lt;/th&gt;
&lt;th&gt;占比&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;AWS 成本项目&lt;/th&gt;
&lt;th&gt;月消 $&lt;/th&gt;
&lt;th&gt;占比&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;服务器&lt;/td&gt;
&lt;td&gt;1,025&lt;/td&gt;
&lt;td&gt;66%&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;EBS 成本&lt;/td&gt;
&lt;td&gt;11,486&lt;/td&gt;
&lt;td&gt;65%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DC、ISP、DF、网络硬件&lt;/td&gt;
&lt;td&gt;524&lt;/td&gt;
&lt;td&gt;34%&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;EC2 成本&lt;/td&gt;
&lt;td&gt;5,607&lt;/td&gt;
&lt;td&gt;32%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;数据传输&lt;/td&gt;
&lt;td&gt;464&lt;/td&gt;
&lt;td&gt;3%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;本地总成本&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;1,550&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;AWS 总成本&lt;/td&gt;
&lt;td&gt;17,557&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;我们的自建成本与 AWS EC2 月消费对比：一台 AWS 服务器成本粗略等于 11.3 台 Ahrefs 自建服务器&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在 AWS 上一台具有相似可用 SSD 空间的替代 EC2 实例的成本，大致相当于托管数据中心中 &lt;strong&gt;11.3&lt;/strong&gt; 台服务器的成本。相应来说，如果上了云，我们这 20 台服务器的机架就只能剩下大约 2 台服务器了！&lt;/p&gt;
&lt;figure class=&#34;card rounded p-2 td-post-card mb-4 mt-4&#34; style=&#34;max-width: 276px&#34;&gt;
&lt;img class=&#34;card-img-top&#34; src=&#34;/zh/blog/cloud/ahrefs-saving/server2_hu47ced090e95deffa932625253b67d13c_612938_800x400_fit_q75_h2_catmullrom_2.webp&#34; width=&#34;266&#34; height=&#34;400&#34;&gt;
&lt;figcaption class=&#34;card-body px-0 pt-2 pb-0&#34;&gt;
&lt;p class=&#34;card-text&#34;&gt;
&lt;p&gt;20 台 Ahrefs 服务器的成本与 2 台 AWS 服务器相当&lt;/p&gt;
&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;那么用我们在自建数据中心里实际使用了两年半的这 850 台服务器来计算，算出总成本数字后，不难看到极其惊人的差异！&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;自建本地服务器&lt;/th&gt;
&lt;th&gt;每月成本 $&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;AWS EC2 实例&lt;/th&gt;
&lt;th&gt;每月成本 $&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;850台服务器每月成本&lt;/td&gt;
&lt;td&gt;1,317,301&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;850台服务器每月成本&lt;/td&gt;
&lt;td&gt;14,923,154&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;30个月总成本&lt;/td&gt;
&lt;td&gt;39,519,025&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;30个月总成本&lt;/td&gt;
&lt;td&gt;447,694,623&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;AWS成本 - 自建成本&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;$ 408,175,598&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;850 台服务器用30个月的成本：AWS vs 自建&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;假设我们在实际的 2.5 年数据中心使用期间运行 850 台服务器。计算后可以看到显著的差异。&lt;/p&gt;
&lt;p&gt;如果我们选择在 2020 年使用新加坡区域的 AWS，而不是自建，那我们需要向 AWS 支付 &lt;strong&gt;超过 4 亿美元&lt;/strong&gt; 这样一笔天文数字 ，才能让自己的基础设施跑起来！&lt;/p&gt;
&lt;p&gt;有人可能会想，“或许 Ahrefs 能付得起？”&lt;/p&gt;
&lt;p&gt;确实，Ahrefs 是一家盈利且自给自足可持续的公司，所以让我们来看一下它的营收，并算一算。尽管我们是一家私有公司，不必公布我们的财务数据。但在《海峡时报》关于 &lt;a href=&#34;https://www.straitstimes.com/fastest-growing-companies-2022&#34;&gt;2022&lt;/a&gt; 年和 &lt;a href=&#34;https://www.straitstimes.com/fastest-growing-companies-2023&#34;&gt;2023&lt;/a&gt; 年新加坡增长最快的公司的文章中可以找到一些 Ahrefs 的收入信息。这些文章提供了 Ahrefs 在 2020 年和 2021 年的收入数据。&lt;/p&gt;
&lt;p&gt;我们还可以线性外推出 2022 年的收入。这是一个粗略估计，但足以让我们得出一些结论了。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;年份&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;收入, 新币&lt;/th&gt;
&lt;th&gt;SGD/USD&lt;/th&gt;
&lt;th&gt;收入, 美元&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2020&lt;/td&gt;
&lt;td&gt;实际&lt;/td&gt;
&lt;td&gt;SGD 86,741,880&lt;/td&gt;
&lt;td&gt;0.7253&lt;/td&gt;
&lt;td&gt;USD 62,913,886&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2021&lt;/td&gt;
&lt;td&gt;实际&lt;/td&gt;
&lt;td&gt;SGD 115,335,291&lt;/td&gt;
&lt;td&gt;0.7442&lt;/td&gt;
&lt;td&gt;USD 85,832,524&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2022&lt;/td&gt;
&lt;td&gt;外推&lt;/td&gt;
&lt;td&gt;???&lt;/td&gt;
&lt;td&gt;0.7265&lt;/td&gt;
&lt;td&gt;USD 108,751,162&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;总计&lt;/td&gt;
&lt;td&gt;USD 257,497,571&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;Ahrefs 2020 - 2022 营收估计&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;从上表可以看出，Ahrefs 在过去三年的&lt;strong&gt;总收入&lt;/strong&gt;约为 2.57 亿美元。但我们也计算出，如果将&lt;strong&gt;这样一个&lt;/strong&gt;自建数据中心替换为 AWS，成本约为 4.48 亿美元。因此，公司收入甚至无法覆盖这 2.5 年的 AWS 使用成本。&lt;/p&gt;
&lt;p&gt;这是一个令人震惊的结果！&lt;/p&gt;
&lt;p&gt;但是我们的利润会去哪儿呢？&lt;/p&gt;
&lt;p&gt;正如波音公司 Dr. LJ Hart-Smith 在这份 &lt;a href=&#34;https://www.documentcloud.org/documents/69746-hart-smith-on-outsourcing.html&#34;&gt;已有 20 年历史的报告&lt;/a&gt;中所述：“如果原厂或总包商无法通过将工作外包来获利，那么谁会受益呢？当然是分包商。”&lt;/p&gt;
&lt;p&gt;需要记住的是，我们已经在计算时让 AWS 占尽便宜了 —— 自建数据中心算电费时使用高于平均水平的电价，算EBS 云盘存储价格时只算了空间部分没算 IOPS，并无视了 EBS 其实非常拉垮的慢。而且，这个数据中心并不是我们唯一的成本中心。我们在其他数据中心、服务器、服务、人员、办公室、营销活动上也有支出。&lt;/p&gt;
&lt;p&gt;因此，如果我们主要的基础设施放在云上，Ahrefs 几乎无法生存。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;其他考虑因素&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这篇文章没有考虑其他使比较更加复杂的方面。这些方面包括人员技能、财务控制、现金流、根据负载类型进行的容量规划等。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论&lt;/h2&gt;
&lt;p&gt;Ahrefs 省下了约 4 亿美元，因为在过去的两年半中，基础设施没有 100% 上云。这个数字还在增加，因为目前我们又在一个新地方，用新硬件搞了另一个大型托管数据中心。&lt;/p&gt;
&lt;p&gt;Ahrefs 利用 AWS 的优势，在世界各地托管我们的前端，但 Ahrefs 基础设施的绝大部分，隐藏在托管数据中心的自有硬件上。如果我们的产品完全依赖 AWS，Ahrefs 将无法盈利，甚至无法存在。&lt;/p&gt;
&lt;p&gt;如果我们采用只用云的方式，我们的基础设施成本将高出 10 倍以上。但正因为我们没有这样做，我们可以将节省下来的资金，用于实际的产品改进和开发。而且也带来了更快、更好的结果 —— 因为（考虑到云上的限制），我们的服务器比云计算能提供的速度更快。我们的报表也生成得更快且更全面，因为每份报告所需的时间更短。&lt;/p&gt;
&lt;p&gt;基于此，我建议那些对可持续增长感兴趣的 CFO、CEO 和企业主们，仔细考虑并定期重新评估云计算的优势与实际成本。虽然云计算是早期创业公司的自然选择，或者说 100% 吧。但随着公司及其基础设施的增长，完全依赖云计算可能会使公司陷入困境。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;而这里就出现了两难：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;一旦上了云，想要离开是很复杂的&lt;/strong&gt;。云计算很方便，但会带来供应商锁定。而且，仅仅是出于更高的成本而放弃云计算基础设施，可能并不是工程团队想要的。他们可能会正确地认为 —— 云计算比传统的砖瓦数据中心和物理服务器环境更容易、更灵活。&lt;/p&gt;
&lt;p&gt;对于更成熟阶段的公司，&lt;a href=&#34;https://world.hey.com/dhh/we-stand-to-save-7m-over-five-years-from-our-cloud-exit-53996caa&#34;&gt;下云迁移到自有基础设施是困难的&lt;/a&gt;。在迁移过程中保持公司生存也是一个挑战。但这种痛苦的转变可能是拯救公司的关键，因为它可以避免将收入越来越多的一部分不断支付给云厂商。&lt;/p&gt;
&lt;p&gt;大公司，尤其是 FAANG 多年来吸走了大量人才。他们一直在招聘工程师来运营他们庞大的数据中心和基础设施，给小公司留下的机会很少。但最近几个月大科技公司的大规模裁员，带来了重新评估云计算的机会 —— 确实可以考虑一下招聘数据中心领域资深专业人士，并从云上搬迁下来。&lt;/p&gt;
&lt;p&gt;如果你要创办一家新公司，考虑一下这种方案：买个机架和服务器，把它们放在你家的地下室。也许这样能从第一天起就提高你们公司的可持续性。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;下云老冯评论&#34;&gt;下云老冯评论&lt;/h2&gt;
&lt;p&gt;很高兴又看到一个难以忍受天价云租金的大客户站出来，发起对云厂商的控诉。 Ahrefs 的经验与我们一致 —— 云上服务器的综合持有成本在是本地自建的 10 倍左右 —— 即使考虑了最好的 Saving Plan 与深度折扣。37 Signal 的 DHH 则提供了&lt;a href=&#34;/zh/blog/cloud/odyssey&#34;&gt;&lt;strong&gt;另一个更有代表性的下云案例&lt;/strong&gt;&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;同时在 Ahrefs 成本核算中我们不难看出成本的结构化差异 —— 自建的存储成本是服务器成本的一半，而云上的存储成本却是服务器成本的一倍 —— 我有一篇文章专门聊过这个问题 —— &lt;a href=&#34;/zh/blog/cloud/ebs&#34;&gt;&lt;strong&gt;云盘是不是杀猪盘&lt;/strong&gt;&lt;/a&gt;？&lt;/p&gt;
&lt;p&gt;在几个关键例子上，云的成本都极其高昂 —— 无论是&lt;a href=&#34;/zh/blog/cloud/rds&#34;&gt;&lt;strong&gt;大型物理机数据库&lt;/strong&gt;&lt;/a&gt;、&lt;a href=&#34;/zh/blog/cloud/ebs&#34;&gt;&lt;strong&gt;大型 NVMe 存储&lt;/strong&gt;&lt;/a&gt;，或者只是&lt;a href=&#34;/zh/blog/cloud/ecs&#34;&gt;&lt;strong&gt;最新最快的算力&lt;/strong&gt;&lt;/a&gt;。在这些用例上，云上的客户不得不忍受高昂到荒诞的定价带来的羞辱 —— 租生产队的驴所花的钱是如此高昂，以至于几个月甚至几周的租金就能与直接购买它的价格持平。在这种情况下，你应该直接直接把这头驴买下来，而不是给赛博领主交租！&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Blog: 云盘是不是杀猪盘？</title>
      <link>/zh/blog/cloud/ebs/</link>
      <pubDate>Wed, 15 Mar 2023 00:00:00 +0000</pubDate>
      
      <guid>/zh/blog/cloud/ebs/</guid>
      <description>
        
        
        
        <![CDATA[<img src="/zh/blog/cloud/ebs/featured_hu18f662b7569a39819bc2dd9739d7776b_407025_640x0_resize_q75_catmullrom.jpg" width="640" height="640"/>]]>
        
        &lt;p&gt;我们已经用数据回答了《&lt;a href=&#34;/zh/blog/cloud/rds/&#34;&gt;云数据库是不是智商税&lt;/a&gt;》这个问题，但在&lt;strong&gt;公有云块存储的百倍溢价杀猪比率&lt;/strong&gt;前，云数据库只能说还差点意思。本文用实际数据揭示公有云真正的商业模式 —— 廉价EC2/S3获客，EBS/RDS杀猪。而这样的做法，也让公有云与其初心愿景渐行渐远。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;/zh/blog/cloud/ebs/#tldr-太长不看&#34;&gt;TLDR：太长不看&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/zh/blog/cloud/ebs/#what真正的杀猪盘&#34;&gt;WHAT：真正的杀猪盘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/zh/blog/cloud/ebs/#why为什么要这样定价&#34;&gt;WHY：为什么要这样定价&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/zh/blog/cloud/ebs/#how还原杀猪盘内幕&#34;&gt;HOW：还原杀猪盘内幕&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/zh/blog/cloud/ebs/#被遗忘的初心愿景&#34;&gt;被遗忘的初心愿景&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/zh/blog/cloud/ebs/#博弈将走向何方&#34;&gt;博弈将走向何方？&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/featured.jpg&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;tldr-太长不看&#34;&gt;TL;DR 太长不看&lt;/h2&gt;
&lt;p&gt;EC2 / S3 / EBS 是所有云服务的定价之锚。如果说 EC2/S3 定价还勉强能算合理，那么 EBS 的定价乃是故意杀猪。公有云厂商最好的块存储服务与自建可用的 PCI-E NVMe SSD 在性能规格上基本相同。然而相比直接采购硬件，&lt;strong&gt;AWS EBS 的成本高达 60 倍，而阿里云的 ESSD 则可高达 100 倍。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;即插即用的磁盘硬件，百倍溢价到底为何？云厂商无法解释如此的天价到底源于何处。结合其他云存储服务的设计思路与定价模型，只有一个合理的解释：&lt;strong&gt;EBS的高溢价倍率是故意设置的门槛，以便于云数据库杀猪&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;作为云数据库定价之锚的 EC2 与 EBS，溢价分别为几倍与几十倍，从而支撑起云数据库的杀猪高毛利。但这样的垄断利润必定无法持久：IDC 2.0/运营商/国资云冲击 IaaS；私有云/云原生/开源平替冲击 PaaS；科技行业大裁员、AI冲击与天朝的低人力成本冲击云服务（运维人力外包/共享专家）。&lt;strong&gt;公有云如果执着于目前的杀猪模式，背离“存算基础设施”的初心，那么必将在以上三者形成的合力下面临越来越严峻的竞争与挑战&lt;/strong&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;what真正的杀猪盘&#34;&gt;WHAT：真正的杀猪盘&lt;/h2&gt;
&lt;p&gt;你在家用微波炉加热黄焖鸡米饭料理包花费10元，餐馆老板替你用微波炉加热装碗上桌收费30元，你不会计较什么，房租水电人工服务也都是要钱的。但如果现在老板端出同样一碗饭跟你收费 1000 元并说：我们提供的不是黄焖鸡米饭，&lt;strong&gt;而是可靠质保的弹性餐饮服务&lt;/strong&gt;，大厨品控掌握火候，按量付费想吃多少有多少，按需付费吃多少盛多少，不吃黄焖鸡还有麻辣烫串串香可选，反正就值这个价，你会不会有打一顿这个老板的冲动？这样的事情就发生在块存储上！&lt;/p&gt;
&lt;p&gt;硬件技术日新月异，&lt;strong&gt;PCI-E NVMe SSD&lt;/strong&gt; 在各种指标上都达到了一个全新水平。一块常见的 3.2 TB 规格企业级 MLC颗粒 SSD 有着极为强悍的性能、可靠性与性价比，价格 ¥3000 元不到，全方位吊打老存储。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-1.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Aliyun ESSD PL3 和我们 IDC 自建采购 PCI-E NVMe SSD 【1】是同一家供应商。所以在最大容量和 IOPS 限制上都一模一样。AWS 最好的块存储 io2 Block Express 的规格和各类指标也基本类似。云厂商提供的最高端存储就是使用这种 32 TB 的单卡，所以才会有 32TB 最大容量的限制（AWS 64T），可以认为底下的实际硬件基本是高度一致的。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-2.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;然而相比直接采购硬件，&lt;strong&gt;AWS EBS io2 的成本高达 120 倍，而阿里云的 ESSD PL3 则高达 200 倍&lt;/strong&gt;。以 3.2TB 规格的企业级 PCI-E SSD 卡为参照基准，AWS 上按需售租比为 15 天，阿里云上不到 5 天，租用此时长即可买下整块磁盘。若在阿里云以采购三年预付最大优惠五折计算，三年租金够买下 120 多块同款硬盘。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-3.gif&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;你这 SSD 是金子做的 ？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;当然，云厂商会争论说块存储的对标物是 SAN&lt;/strong&gt;，而本地 DAS 在云上的对标物应当是&lt;strong&gt;实例存储（Host Storage）&lt;/strong&gt;。但是，公有云的实例存储基本都是临时性的（ Ephemeral Storage），实例一旦休眠/停止就会回收抹除数据【7，11】，难以用于严肃的生产数据库，云厂商自己也建议你不要把重要数据放在上面。因此唯一能用于数据库的存储就是 EBS 块存储 。类似于DBFS之类的产品指标与成本与 EBS 基本类似，也在此合并同类项。&lt;/p&gt;
&lt;p&gt;说到底，用户在意的不是设备块底下到底是 SAN，SSD，还是HDD；真正重要的永远是实打实的硬指标：&lt;strong&gt;延迟、IOPS，可靠性，成本&lt;/strong&gt;。拿本地与云上的最好选项对比，没有任何问题，更别提最好的云存储底下用的也是一样的本地盘了。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;有的“专家”又会说，云上的块存储稳定可靠，多副本冗余纠错&lt;/strong&gt;。在以前，Share Everything 的数据库要用 SAN 存储跑，然而现在很多数据库都是 Share Nothing 架构了。在数据库实例层面进行冗余，不需要存储层再搞个三副本，更何况企业级磁盘本身就有极强的自我纠错能力与安全冗余（ UBER &amp;lt; 1e-18 ）。&lt;strong&gt;在上层数据库本身已经有冗余的情况下，多副本块存储对数据库来说属于毫无意义的浪费&lt;/strong&gt;。退一万步讲，如果云厂商真的用了多余的两副本来做无谓的冗余，那也不过是溢价率从 200x 降到 66x ，杀猪逻辑依然没有质变。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;“专家”还会说，买“云服务”其实类似于买保险&lt;/strong&gt;：“年化 0.02% 的故障看起来大部分人一次都遇不到，但是遇到一次就毁灭性的打击，而云厂商来为你兜底”。听上去好像很有吸引力。但翻开各家云厂商 EBS 的 SLA，你会发现压根没有为可靠性兜底的条款。ESSD 云盘介绍上是写了 9个9 的数据可靠性，但他也不敢把这句话写到 SLA 里。&lt;strong&gt;云厂商敢兜的只有可用性，而且还是相当逊的可用性&lt;/strong&gt;，以 AWS EBS SLA 【9】为例：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;ebs4.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;《&lt;a href=&#34;/zh/blog/cloud/sla/&#34;&gt;云SLA是不是安慰剂&lt;/a&gt;》&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;翻译成大白话就是：如果一个月里挂一天半（95%），本月此项服务费补偿100%代金券，挂了7个小时（99%）补偿 30% 代金券，挂了几十分钟 （99.9%单盘，99.99%区域）补偿10%代金券。云厂商收了百倍费用，这么大的重大冲击就补偿点代金券？挂几分钟都受不了的应用，谁会稀罕这几毛钱代金券？莫过于前几年那篇《腾讯云给一家创业公司带来的灾难》&lt;/p&gt;
&lt;p&gt;顺丰快递保价 1% ，搞丢了人家真的赔你。每年几万块的商业医保，出问题真能兜底几百万。不要侮辱“保险”这个行业，起码人家也是一分钱一分货的。&lt;strong&gt;所以，SLA 对用户来说不是兜底损失的保险单。在最坏的情况下，它是吃不了兜着走的哑巴亏。在最好的情况下，它才是提供情绪价值的安慰剂。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;云数据库服务的溢价还可以用 “专家人力” 来解释，但这一点对于服务器插上就能用的磁盘完全说不通，&lt;strong&gt;云厂商自己也讲不出这里几十倍的价格到底溢在哪里&lt;/strong&gt;。你去问他们的工程师，大概逼急了也只能告诉你：&lt;/p&gt;
&lt;p&gt;“&lt;strong&gt;我们抄 AWS ，人家就是这么设计的&lt;/strong&gt;”&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;why为什么要这样定价&#34;&gt;WHY：为什么要这样定价&lt;/h2&gt;
&lt;p&gt;即使是公有云自己的工程师可能也搞不清楚这样定价的意义，明白的人也不太可能会告诉你。但是这并不妨碍我们从&lt;strong&gt;产品的设计&lt;/strong&gt;中推断出这样做背后的道理。&lt;/p&gt;
&lt;p&gt;存储是有事实标准的：&lt;strong&gt;POSIX 文件系统 + 块存储&lt;/strong&gt;。无论是数据库文件，图片音视频都使用同样的文件系统接口存储在磁盘上。但是 AWS 的“神之一手” 将其切分为两种不同的服务：&lt;strong&gt;S3&lt;/strong&gt; （简单对象存储）与 &lt;strong&gt;EBS&lt;/strong&gt; （弹性块存储）。很多“追随者”模仿了AWS 的产品设计与定价模型，却说不清这样做的逻辑与原理。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-5.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;阿里云官网对 EBS 和 OSS 的定位&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;S3&lt;/strong&gt; 的全称 是 &lt;strong&gt;Simple Storage Service ，简单存储服务&lt;/strong&gt;。它是文件系统/存储的一种简化替代：牺牲了强一致性、目录管理，访问时延等功能属性，以换取廉价的成本与海量伸缩的能力。它提供了一个简单的、高延迟、高吞吐扁平 KV 存储服务，从标准的存储服务中剥离出来。这个部分物美价廉，是公有云用来吸引用户上云的一大杀手锏：因此成为了可能是唯一一个，&lt;strong&gt;在各家公有云通行的云计算事实标准&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;而数据库需要的是低延迟，强一致、高质量、高性能、可随机读写的块存储&lt;/strong&gt;，这一部分被包装为 EBS 服务：Elastic Block Store ，弹性块存储服务，这个部分成为了公有云厂商的 禁脔 ：不愿为用户染指。&lt;strong&gt;因为EBS是 RDS 的定价之锚 —— 也就是云数据库的壁垒与护城河&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;卖资源吃饭的 IaaS 定价没有太大水分空间，可以对着 BOM 一笔一笔精算。但是像云数据库这样的 PaaS， 里面包含的“服务”，人力 / 研发成本就包含大量水分，难以厘定，就可以名正言顺的&lt;strong&gt;卖出天价&lt;/strong&gt;，攫取高额利润。尽管国内公有云 IaaS 层存储、计算、网络三大件的收入能占营收一半的比例，但其毛利率只有 &lt;strong&gt;15% ～ 20%&lt;/strong&gt;，而以云数据库为代表的公有云 PaaS 毛利率可以达到 &lt;strong&gt;50%&lt;/strong&gt; 或更高，完爆卖资源吃饭的 IaaS。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如果用户选择使用 IaaS 资源（EC2 / EBS）自行搭建数据库，对云厂商而言是一笔巨大的利润损失。所以公有云厂商会竭尽全力避免这样的情况出现，而怎样设计产品才能实现这个需求呢？&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;首先，最适合用于自建数据库的&lt;strong&gt;实例存储&lt;/strong&gt;必须添加各种限制：实例一旦休眠/停止就会回收并抹除数据，让你没法用 EC2 自带的盘跑严肃的生产数据库服务。其次尽管 EBS 相比本地 NVMe SSD 存储性能可靠性稍显拉胯，但用来跑数据库也是可以的，所以这里也要限制：但也不能不给用户，那么就&lt;strong&gt;设置一个天价&lt;/strong&gt;！作为补偿，次一级的廉价海量存储 S3 就可以卖便宜一些来钓鱼获客。&lt;/p&gt;
&lt;p&gt;当然要想客户买单，也需要一些云计算 KOL 来鼓吹配套 “公有云云原生” 哲学理念：“EC2 不适合放状态哟，请把状态放到 S3 或者 RDS 以及其他托管服务，这才是使用我们公有云的‘&lt;strong&gt;最佳实践&lt;/strong&gt;’ ”。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;/zh/&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-7.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这四条总结的很到位，但公有云绝对不会告诉你“最佳实践”的代价是什么。用白话解释一下&lt;a href=&#34;https://github.com/lipingtababa/cloud-native-best-practices/blob/main/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%8E%8B%E5%9B%9B%E6%9D%A1.md&#34;&gt;这四条&lt;/a&gt;的意思，这是一个为客户&lt;strong&gt;精心设计的连环杀猪套&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;普通文件丢S3&lt;/strong&gt;！（这么物美价廉的S3，还要啥 EBS？）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;不要自建数据库&lt;/strong&gt;！（别想着用实例存储折腾开源替代）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;请深度使用厂商专有的身份认证系统&lt;/strong&gt;（供应商锁定）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;乖乖给云数据库上贡&lt;/strong&gt;！（锁死用户后，杀猪时刻）&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;how还原杀猪盘内幕&#34;&gt;HOW：还原杀猪盘内幕&lt;/h2&gt;
&lt;p&gt;公有云的商业模式可以概括为：&lt;strong&gt;廉价EC2/S3获客，EBS/RDS杀猪&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;要想杀猪，先要养猪，舍不着孩子套不着狼。所以对于新用户、初创企业，小微用户，公用云都不吝于提供一些甜头，甚至赔本赚吆喝。新用户首单骨折，初创企业免费/半价 Credit，以及微妙的定价策略。&lt;/p&gt;
&lt;p&gt;以 AWS RDS &lt;a href=&#34;https://instances.vantage.sh/&#34;&gt;报价&lt;/a&gt;为例可以看出，1核2核的迷你机型，单价也就是 &lt;strong&gt;几$/核·月&lt;/strong&gt;，折合三四百块人民币一年，可以说是非常便宜实惠（不含存储）：如果你需要一个低频使用的小微数据库放点东西，这也许就是最简单便宜的选择【10】。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://instances.vantage.sh/&#34;&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-8.png&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;然而，&lt;strong&gt;只要你稍微把配置往上抬哪怕一丁点儿，核月单价就出现了数量级的变化&lt;/strong&gt;，干到了二三十～一百来刀，最高可以翻到几十倍 —— &lt;strong&gt;算上惊悚的 EBS 价格还要再翻番&lt;/strong&gt;。用户只有在看到突然出现的天价账单时，才会意识到到底发生了什么。&lt;/p&gt;
&lt;p&gt;以 RDS for PostgreSQL 为例， AWS 上 64C / 256GB 的 db.m5.16xlarge RDS用一个月价格 $25,817 / 月，折合每月 18 万元人民币，一个月的租金够你把两台性能比这还要好的多得多的服务器直接买下来自建了。&lt;strong&gt;租售比甚至都不到一个月，租十来天就够你买下来整台服务器自建&lt;/strong&gt;。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;付费模式&lt;/th&gt;
&lt;th&gt;价格&lt;/th&gt;
&lt;th&gt;折合每年（万¥）&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;IDC自建（单物理机）&lt;/td&gt;
&lt;td&gt;¥7.5w / 5年&lt;/td&gt;
&lt;td&gt;1.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IDC自建（2～3台组HA）&lt;/td&gt;
&lt;td&gt;¥15w / 5年&lt;/td&gt;
&lt;td&gt;3.0 ~ 4.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;阿里云 RDS 按需&lt;/td&gt;
&lt;td&gt;¥87.36/时&lt;/td&gt;
&lt;td&gt;76.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;阿里云 RDS 月付（基准）&lt;/td&gt;
&lt;td&gt;¥4.2w / 月&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;阿里云 RDS 年付（85折）&lt;/td&gt;
&lt;td&gt;¥425095 / 年&lt;/td&gt;
&lt;td&gt;42.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;阿里云 RDS 3年付（5折）&lt;/td&gt;
&lt;td&gt;¥750168 / 3年&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS 按需&lt;/td&gt;
&lt;td&gt;$25,817 / 月&lt;/td&gt;
&lt;td&gt;217&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS 1年不预付&lt;/td&gt;
&lt;td&gt;$22,827 / 月&lt;/td&gt;
&lt;td&gt;191.7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS 3年全预付&lt;/td&gt;
&lt;td&gt;12w$ + 17.5k$/月&lt;/td&gt;
&lt;td&gt;175&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS 中国/宁夏按需&lt;/td&gt;
&lt;td&gt;¥197,489 / 月&lt;/td&gt;
&lt;td&gt;237&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS 中国/宁夏1年不预付&lt;/td&gt;
&lt;td&gt;¥143,176 / 月&lt;/td&gt;
&lt;td&gt;171&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS 中国/宁夏3年全预付&lt;/td&gt;
&lt;td&gt;¥647k + 116k/月&lt;/td&gt;
&lt;td&gt;160.6&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;我们可以对比一下自建与云数据库的成本差异：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;方式&lt;/th&gt;
&lt;th&gt;折合每年（万元）&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;IDC托管服务器 64C / 384G / 3.2TB NVME SSD 660K IOPS (2～3台)&lt;/td&gt;
&lt;td&gt;3.0 ~ 4.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;阿里云 RDS PG 高可用版 pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3&lt;/td&gt;
&lt;td&gt;25 ～ 50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS RDS PG 高可用版 db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS&lt;/td&gt;
&lt;td&gt;160 ～ 217&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;RDS&lt;/strong&gt; 定价与自建对比，详见《&lt;a href=&#34;/zh/blog/cloud/rds/&#34;&gt;云数据库是不是智商税&lt;/a&gt;》&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;任何理智的企业用户都看得明白这里面的道理：&lt;strong&gt;如果采购这种服务不是为了短期的，临时性的需求，那么绝对算得上是&lt;strong&gt;&lt;strong&gt;重大的财务失当&lt;/strong&gt;&lt;/strong&gt;行为&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;不仅仅是 关系型数据库服务 / RDS 是这样，各种云数据库都在杀猪。MongoDB， ClickHouse，Cassandra，用 EC2 / EBS的有一个算一个。以流行的 NoSQL 文档数据库 MongoDB 为例：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-10.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这种报价没有十年脑血栓的产品经理真的想不出来&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;五年时间正好是常见服务器折旧年限&lt;/strong&gt;，最大折扣，12节点（64C 512G），报价两千三百万。这个报价的零头就可以轻松把五年硬件代维轻松搞定，再加一个 MongoDB 专家天团为您按需定制随意自建了。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;高级餐厅加收菜品 15% 的服务费，而用户也可以理解并支持这种合理范围内的利润需求&lt;/strong&gt;。云数据库如果在硬件资源的基础上加收百分之几十的服务费与弹性溢价（白嫖开源的云服务就不要提软件费用了），可以解释为生产性要素的定价，解决的问题与提供的服务确实值这个钱。&lt;/p&gt;
&lt;p&gt;然而加收百分之几百甚至几千的溢价，那就完全属于&lt;strong&gt;破坏性要素参与分配&lt;/strong&gt;了：云厂商吃死了用户上来之后没有备选项，以及迁移会产生伤筋动骨的大成本，所以大可以放心杀猪！在这种意义下，用户掏的钱，买的不是服务，而是在被强制征收 “无专家税” 与 “保护费”。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;被遗忘的初心愿景&#34;&gt;被遗忘的初心愿景&lt;/h2&gt;
&lt;p&gt;因而面对杀猪的指责，云厂商也会辩解说：“&lt;em&gt;&lt;strong&gt;哎呀，你们看到的都是列表价啦，说是最低 5折，但大客户打起折来，可是没有底线的哦&lt;/strong&gt;&lt;/em&gt;“。作为一条经验法则：&lt;strong&gt;自建成本差不多在目前云服务列表价的零点五到一折上下浮动&lt;/strong&gt;，如果能长期保有此折扣，云服务就会比自建更有竞争力。&lt;/p&gt;
&lt;p&gt;专业懂行的大客户，特别是那种随时有能力迁移横跳的甲方去和公有云搞商务谈判，确实有可能获取两折的骨折折扣，而小客户天然在议价方面没有能力，通常不太可能有这种机会。&lt;/p&gt;
&lt;p&gt;然而，&lt;strong&gt;云计算不应成为云算计&lt;/strong&gt;：云厂商如果只能在大企业那边疯狂打折促销，而面对中小客户和开发者进行薅羊毛的方式进行杀猪，那实际上是&lt;strong&gt;损不足以奉有余 —— 吸中小客户的血补贴大客户&lt;/strong&gt;。这种方式已经完全违背了云计算本身的初心与愿景，必然难以持续长久。&lt;/p&gt;
&lt;p&gt;在云刚出现的时候，关注的焦点是 &lt;strong&gt;云硬件 /  IaaS 层&lt;/strong&gt; ：算力、存储、带宽。云硬件 是云厂商的初心故事：让计算和存储资源像水电一样，而自己扮演基础设施的提供者的角色。这是一个很有吸引力的愿景：公有云厂商可以通过规模效应，压低硬件成本并均摊人力成本；理想情况下，在给自己留下足够利润的前提下，还可以向公众提供比 IDC 价格更有优势，更有弹性的存储算力。&lt;/p&gt;
&lt;p&gt;而 &lt;strong&gt;云软件（ PaaS / SaaS ）&lt;/strong&gt;，则是与云硬件有着迥然不同的商业逻辑：云硬件靠的是规模效应，优化整体效率赚取资源池化超卖的钱，总体来说算是一种效率进步。而云软件则是靠共享专家，提供运维外包来收取服务费。公有云上大量的服务，本质是对免费的开源软件进行封装，依靠的是垄断专家，利用信息不对称收取天价保险费，是一种价值的攫取转移。&lt;/p&gt;
&lt;p&gt;不幸的是，出于混淆视线的目的，云软件与云硬件都使用了“云”这个 Title。因而在云的故事中，混杂着打破资源垄断与建立能力垄断的叙事：&lt;strong&gt;同时混掺着将算力普及到千家万户的理想主义光辉&lt;/strong&gt;，&lt;strong&gt;与达成垄断攫取不义利润杀猪的贪婪&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;抛弃平台中立性与做基础设施的初心，沉沦在 PaaS / SaaS / 甚至应用层恰烂钱的公有云供应商，将在没有底线的竞争中沉沦。&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;博弈将走向何方&#34;&gt;博弈将走向何方？&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;垄断利润将随着竞争出现而消失，公有云厂商被卷入了一场苦战之中。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在基础设施层面，运营商，国资云，IDC 1.5/2.0 都进入了赛道，并提供了非常有竞争力的 IaaS 服务，一条龙包网包电托管代维，高端服务器既可以自购托管，也完全可以用实价弹性直接租赁，论起弹性来一点不怵。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-11.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;IDC 2.0 服务器租赁新模式：实价租赁，满年限归用户&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在软件层面，曾经作为公有云技术门槛的各类管控软件 / &lt;strong&gt;PaaS&lt;/strong&gt; 已经出现了相当优秀的开源平替，OpenStack / Kubernetes 取代 EC2，MinIO / Ceph 取代 S3，RDS 上也出现了诸如 &lt;strong&gt;Pigsty&lt;/strong&gt; 【5】与各种 K8S Operator 这样的开源替代品。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;整个“云原生”运动，说白了就是开源生态对公有云白嫖挑战的回应&lt;/strong&gt;：&lt;strong&gt;用户与开发者们为了避免被公有云杀猪，打造了一套本地优先的完整公有云开源替代&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-12.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“CloudNative” 这个名字起的好，一中各表，公有云觉得是“公有云上出生”的，私有云想的是“在本地跑和云一样的东西”。推 Kubernetes 最狠的竟然还是公有云本身，就和销售绞死自己的绳索一样。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;经济衰退的大环境下，降本增效成为主旋律。十几万规模的科技行业大裁员，以及未来AI对智力行业的大规模冲击将释放出大量相关人才，再加上本朝的低工资优势，&lt;strong&gt;自建人才稀缺与昂贵的情状将大为缓解&lt;/strong&gt;。人力成本相比云服务成本要有优势的多。&lt;/p&gt;
&lt;p&gt;结合以上三方面的趋势，IDC2.0 + 开源自建的组合越来越有竞争力：对于稍微有点规模和人才储备的组织来说，&lt;strong&gt;短路掉公有云这个中间商，直接与 IDC 合作显然是一个更经济实惠的选择&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;不忘初心，方得始终。公有云在云硬件 / IaaS 层上做的确实不错，除了&lt;strong&gt;贵到离谱&lt;/strong&gt;，没有太大问题，东西确实是不错的。如果能回归最初的愿景初心，真正做好水与电一样的基础设施提供者，&lt;strong&gt;卖资源虽毛利虽不高，但可以站着把钱挣了。如果继续执迷不悟沉迷于杀猪，最终用户将用脚给出自己的选择&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/zh/blog/cloud/ebs/ebs-13.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;《&lt;a href=&#34;/zh/blog/cloud/profit/&#34;&gt;云计算为啥还没挖沙子挣钱？&lt;/a&gt;》&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;
&lt;p&gt;【1】&lt;a href=&#34;https://mp.weixin.qq.com/s/w5XKsXf_NLWnKB6G-sbZaw&#34;&gt;撤离 AWS：3年省下27.5亿元&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【2】&lt;a href=&#34;/zh/blog/cloud/rds/&#34;&gt;云数据库是不是智商税&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【3】&lt;a href=&#34;/zh/blog/cloud/paradigm/&#34;&gt;范式转移：从云到本地优先&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【4】&lt;a href=&#34;https://mp.weixin.qq.com/s/ANFnbDXwuhKI99fgYRZ9ug&#34;&gt;腾讯云CDN：从入门到放弃&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【5】&lt;a href=&#34;https://mp.weixin.qq.com/s/WsR-c64OJfkMql7zX7XmDA&#34;&gt;炮打 RDS，Pigsty v2.0 发布&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【6】&lt;a href=&#34;https://en.shannon-sys.com/product.html?name=gen_4&#34;&gt;Shannon NVMe Gen4 Series&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【7】&lt;a href=&#34;https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html&#34;&gt;AWS实例存储&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【8】&lt;a href=&#34;https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/&#34;&gt;AWS io2 gp3 存储性能与定价&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【9】&lt;a href=&#34;https://aws.amazon.com/cn/ebs/sla/&#34;&gt;AWS EBS SLA&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【10】&lt;a href=&#34;https://instances.vantage.sh/&#34;&gt;AWS EC2 / RDS 报价查询&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【11】&lt;a href=&#34;https://help.aliyun.com/document_detail/63138.html&#34;&gt;阿里云：本地盘&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【12】&lt;a href=&#34;https://help.aliyun.com/document_detail/25383.html&#34;&gt;阿里云：云盘概述&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【13】&lt;a href=&#34;https://help.aliyun.com/document_detail/445806.html&#34;&gt;图说块存储与云盘&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【14】&lt;a href=&#34;https://news.futunn.com/post/24656633&#34;&gt;从狂飙到集体失速，云计算换挡寻出路&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;【15】&lt;a href=&#34;https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA&#34;&gt;云计算为啥还没挖沙子赚钱？&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
