<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="/docs/applet/">
<link rel="alternate" type="application/rss&#43;xml" href="/docs/applet/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Visualization Applet | Pigsty</title>
<meta name="description" content="Run data analysis &amp; visualization, data app demo with Pigsty">
<meta property="og:title" content="Visualization Applet" />
<meta property="og:description" content="Run data analysis &amp; visualization, data app demo with Pigsty" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/applet/" />

<meta itemprop="name" content="Visualization Applet">
<meta itemprop="description" content="Run data analysis &amp; visualization, data app demo with Pigsty"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Visualization Applet"/>
<meta name="twitter:description" content="Run data analysis &amp; visualization, data app demo with Pigsty"/>




<link rel="preload" href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" as="style">
<link href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" rel="stylesheet" integrity="">

<script
  src="/js/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="/js/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-LG1V9WTKGE');
}
</script>
  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class="navbar-brand__name">Pigsty</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/docs/"><i class='fa-solid fa-book'></i><span>Docs</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/blog/"><i class="fas fa-blog"></i><span>Blog</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/Vonng/pigsty/" target="_blank" rel="noopener"><i class='fab fa-github'></i><span>GitHub</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Link</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/docs/">v3 Docs</a></li>
    <li><a class="dropdown-item" href="https://demo.pigsty.cc">Public Demo</a></li>
    <li><a class="dropdown-item" href="https://ext.pigsty.io">Extension Repo</a></li>
    <li><a class="dropdown-item" href="https://pigsty.cc/zh/docs">pigsty.cc</a></li>
    <li><a class="dropdown-item" href="https://pigsty.cc/zh/blog">ZH Blog</a></li>
    </ul>
</div></li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <i class="fa-solid fa-language"></i>English</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/zh/docs/applet/">中文</a></li>
    </ul>
</div>
</li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.d3d182a46fdf5ab84d5dabf891f27f54.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/applet/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Visualization Applet</h1>
<div class="lead">Run data analysis &amp; visualization, data app demo with Pigsty</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-773dbfb78878cb9a683806f66a75122e">Analyse CSVLOG Sample with the built-in PGLOG</a></li>


    
  
    
    
	
<li>2: <a href="#pg-bc312ae3da72ac75c0fd469378e2fdf1">NOAA ISD Station</a></li>


    
  
    
    
	
<li>3: <a href="#pg-8e9936e3e240dd7ededdff359a36e883">WHO COVID-19 Data Analysis</a></li>


    
  

    </ul>


<div class="content">
      <p><a href="https://github.com/Vonng/pigsty/tree/master/app"><img alt="pigsty-app.jpg" src="/img/pigsty/app.jpg"></a></p>
<p>An Applet is a self-contained, data-driven mini-application that runs within the Pigsty infrastructure.</p>
<p>A typical Pigsty application includes at least one or all of the following components:</p>
<ul>
<li><strong>Graphical Interface (Grafana Dashboard definitions)</strong> located in the <code>ui</code> directory</li>
<li><strong>Data Definitions (PostgreSQL DDL Files)</strong> located in the <code>sql</code> directory</li>
<li><strong>Data Files (various resources that need to be downloaded)</strong> located in the <code>data</code> directory</li>
<li><strong>Logic Scripts (scripts for executing various logic)</strong> located in the <code>bin</code> directory</li>
</ul>
<p>Pigsty comes with several sample applications by default:</p>
<ul>
<li><a href="/docs/applet/pglog/"><code>pglog</code></a>: Analyzes PostgreSQL CSV log samples.</li>
<li><a href="/docs/applet/covid/"><code>covid</code></a>: Visualizes WHO COVID-19 data and allows you to check pandemic data by country.</li>
<li><a href="/docs/applet/isd/"><code>isd</code></a>: NOAA ISD, which provides access to meteorological observation records from 30,000 surface weather stations worldwide since 1901.</li>
</ul>
<hr>
<h2 id="structure">Structure</h2>
<p>A Pigsty applet provides an installation script in its root directory: <code>install</code> or a related shortcut. You need to run this script as an admin user on the <a href="/docs/node/#admin-node"><strong>admin node</strong></a> to execute the installation. The installation script will detect the current environment (fetching <code>METADB_URL</code>, <code>PIGSTY_HOME</code>, <code>GRAFANA_ENDPOINT</code>, etc.) to complete the installation.</p>
<p>Typically, dashboards with the <code>APP</code> tag will be listed in the Pigsty Grafana homepage navigation under the Apps dropdown menu, and dashboards with both <code>APP</code> and <code>OVERVIEW</code> tags will be listed in the homepage panel navigation.</p>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-773dbfb78878cb9a683806f66a75122e">1 - Analyse CSVLOG Sample with the built-in PGLOG</h1>
    <div class="lead">Analyse CSVLOG Sample with the built-in PGLOG</div>
	<p>PGLOG is a sample application included with Pigsty that uses the <code>pglog.sample</code> table in MetaDB as the data source.
Simply populate this table with logs and access the corresponding Dashboard.</p>
<p>Pigsty provides some handy commands to fetch CSV logs and load them into the sample table. The following shortcut commands are available on the master node by default:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>catlog  <span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">=</span>localhost<span style="color:#ce5c00;font-weight:bold">]</span>  <span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">date</span><span style="color:#ce5c00;font-weight:bold">=</span>today<span style="color:#ce5c00;font-weight:bold">]</span>   <span style="color:#8f5902;font-style:italic"># Print CSV logs to standard output</span>
</span></span><span style="display:flex;"><span>pglog                                    <span style="color:#8f5902;font-style:italic"># Load CSVLOG from standard input</span>
</span></span><span style="display:flex;"><span>pglog12                                  <span style="color:#8f5902;font-style:italic"># Load CSVLOG in PG12 format</span>
</span></span><span style="display:flex;"><span>pglog13                                  <span style="color:#8f5902;font-style:italic"># Load CSVLOG in PG13 format</span>
</span></span><span style="display:flex;"><span>pglog14                                  <span style="color:#8f5902;font-style:italic"># Load CSVLOG in PG14 format (=pglog)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>catlog <span style="color:#000;font-weight:bold">|</span> pglog                       <span style="color:#8f5902;font-style:italic"># Analyze logs of the current node for today</span>
</span></span><span style="display:flex;"><span>catlog node-1 <span style="color:#4e9a06">&#39;2021-07-15&#39;</span> <span style="color:#000;font-weight:bold">|</span> pglog   <span style="color:#8f5902;font-style:italic"># Analyze CSV logs of node-1 for 2021-07-15</span>
</span></span></code></pre></div><p>Next, you can visit the following links to view sample log analysis dashboards:</p>
<p><a href="https://demo.pigsty.cc/d/pglog-overview"><img alt="pglog-overview.jpg" src="/img/dashboard/pglog-overview.jpg"></a></p>
<p><a href="https://demo.pigsty.cc/d/pglog-session"><img alt="pglog-session.jpg" src="/img/dashboard/pglog-session.jpg"></a></p>
<p>The <code>catlog</code> command fetches CSV database logs from a specific node for a specific date and writes them to <code>stdout</code>.</p>
<p>By default, <code>catlog</code> fetches logs of the current node for today, but you can specify the node and date via parameters.</p>
<p>By combining <code>pglog</code> and <code>catlog</code>, you can quickly fetch and analyze database CSV logs.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>catlog <span style="color:#000;font-weight:bold">|</span> pglog                       <span style="color:#8f5902;font-style:italic"># Analyze logs of the current node for today</span>
</span></span><span style="display:flex;"><span>catlog node-1 <span style="color:#4e9a06">&#39;2021-07-15&#39;</span> <span style="color:#000;font-weight:bold">|</span> pglog   <span style="color:#8f5902;font-style:italic"># Analyze CSV logs of node-1 for 2021-07-15</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bc312ae3da72ac75c0fd469378e2fdf1">2 - NOAA ISD Station</h1>
    <div class="lead">Fetch, Parse, Analyze, and Visualize Integrated Surface Weather Station Dataset</div>
	<p>Including 30000 meteorology station, daily, sub-hourly observation records, from 1900-2023. <a href="https://github.com/Vonng/isd">https://github.com/Vonng/isd</a></p>
<p><a href="https://demo.pigsty.cc/d/isd-overview"><img alt="ISD Overview" src="https://github.com/Vonng/isd/assets/8587410/827c1961-6426-46c6-9fb1-25cd93507924"></a></p>
<p>It is recommended to use with <a href="https://github.com/Vonng/pigsty">Pigsty</a>, the battery-included PostgreSQL distribution with Grafana &amp; echarts for visualization. It will setup everything for your with <code>make all</code>;</p>
<p>Otherwise, you&rsquo;ll have to provide your own PostgreSQL instance, and setup grafana dashboards manually.</p>
<hr>
<h2 id="quick-start">Quick Start</h2>
<p><strong>Clone this repo</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/Vonng/isd.git<span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87">cd</span> isd<span style="color:#000;font-weight:bold">;</span>
</span></span></code></pre></div><p><strong>Prepare a PostgreSQL Instance</strong></p>
<p>Export <code>PGURL</code> in your environment to specify the target postgres database:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># the default PGURL for pigsty&#39;s meta database, change that accordingly</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PGURL</span><span style="color:#ce5c00;font-weight:bold">=</span>postgres://dbuser_dba:DBUser.DBA@127.0.0.1:5432/meta?sslmode<span style="color:#ce5c00;font-weight:bold">=</span>disable
</span></span><span style="display:flex;"><span>psql <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">PGURL</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> -c <span style="color:#4e9a06">&#39;SELECT 1&#39;</span>  <span style="color:#8f5902;font-style:italic"># check if connection is ok</span>
</span></span></code></pre></div><p>then init database <a href="sql/">schema</a> with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make sql              <span style="color:#8f5902;font-style:italic"># setup postgres schema on target database</span>
</span></span></code></pre></div><p><strong>Get isd station metadata</strong></p>
<p>The basic station metadata can be downloaded and loaded with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make reload-station   <span style="color:#8f5902;font-style:italic"># equivalent to get-station + load-station</span>
</span></span></code></pre></div><p><strong>Fetch and load <code>isd.daily</code></strong></p>
<p>To load <code>isd.daily</code> dataset, which is organized by yearly tarball files.
You can download the raw data from noaa and parse with isd parser</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make get-parser       <span style="color:#8f5902;font-style:italic"># download parser binary from github, you can just build with: make build</span>
</span></span><span style="display:flex;"><span>make reload-daily     <span style="color:#8f5902;font-style:italic"># download and reload latest daily data and re-calculates monthly/yearly data</span>
</span></span></code></pre></div><p><strong>Load Parsed Stable CSV Data</strong></p>
<p>Or just load the pre-parsed stable part from GitHub.
Which is well-formatted CSV that does not require an isd parser.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make get-stable       <span style="color:#8f5902;font-style:italic"># download stable isd.daily dataset from Github</span>
</span></span><span style="display:flex;"><span>make load-stable      <span style="color:#8f5902;font-style:italic"># load downloaded stable isd.daily dataset into database</span>
</span></span></code></pre></div><h2 id="more-data">More Data</h2>
<p>There are two parts of isd datasets needs to be regularly updated: station metadata &amp; <code>isd.daily</code> of the latest year, you can reload them with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make reload           <span style="color:#8f5902;font-style:italic"># reload-station + reload-daily</span>
</span></span></code></pre></div><p>You can download and load <code>isd.daily</code> in a specific year with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bin/get-daily  <span style="color:#0000cf;font-weight:bold">2022</span>                   <span style="color:#8f5902;font-style:italic"># get daily observation summary of a specific year (1900-2023)</span>
</span></span><span style="display:flex;"><span>bin/load-daily <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">PGURL</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> <span style="color:#0000cf;font-weight:bold">2022</span>    <span style="color:#8f5902;font-style:italic"># load daily data of a specific year </span>
</span></span></code></pre></div><p>You can also download and load <code>isd.hourly</code> in a specific year with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bin/get-hourly  <span style="color:#0000cf;font-weight:bold">2022</span>                  <span style="color:#8f5902;font-style:italic"># get hourly observation record of a specific year (1900-2023)</span>
</span></span><span style="display:flex;"><span>bin/load-hourly <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">PGURL</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> <span style="color:#0000cf;font-weight:bold">2022</span>   <span style="color:#8f5902;font-style:italic"># load hourly data of a specific year </span>
</span></span></code></pre></div><h2 id="data">Data</h2>
<h3 id="dataset">Dataset</h3>
<p>There are four official datasets</p>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>Sample</th>
<th>Document</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>ISD Hourly</td>
<td><a href="doc/isd-hourly-sample.csv">isd-hourly-sample.csv</a></td>
<td><a href="doc/isd-hourly-document.pdf">isd-hourly-document.pdf</a></td>
<td>(Sub)Hour observation records</td>
</tr>
<tr>
<td>ISD Daily</td>
<td><a href="doc/isd-daily-sample.csv">isd-daily-sample.csv</a></td>
<td><a href="doc/isd-daily-format.txt">isd-daily-format.txt</a></td>
<td>Daily summary</td>
</tr>
<tr>
<td>ISD Monthly</td>
<td>N/A</td>
<td><a href="doc/isd-gsom-document.pdf">isd-gsom-document.pdf</a></td>
<td>Not used, Generate from <code>isd.daily</code></td>
</tr>
<tr>
<td>ISD Yearly</td>
<td>N/A</td>
<td><a href="doc/isd-gsoy-document.pdf">isd-gsoy-document.pdf</a></td>
<td>Not used, Generate from <code>isd.daily</code></td>
</tr>
</tbody>
</table>
<p><strong>Daily Dataset</strong></p>
<ul>
<li>Tarball size 2.8GB (until 2023-06-24)</li>
<li>Table size 24GB, Index size 6GB, Total size in PostgreSQL = 30GB</li>
<li>If timescaledb compression is used, it will be compressed to around 4.5GB</li>
</ul>
<p><strong>Hourly dataset</strong></p>
<ul>
<li>Tarball size 117GB</li>
<li>Table size 1TB+ , Index size 600GB+</li>
</ul>
<h3 id="schema">Schema</h3>
<ul>
<li><a href="sql/1_schema.sql">sql/1_schema.sql</a> : isd schema</li>
<li><a href="sql/2_record.sql">sql/2_record.sql</a> : daily, monthly, yearly table schema</li>
<li><a href="sql/3_hourly.sql">sql/3_hourly.sql</a> : optional hourly data schema</li>
<li><a href="sql/4_data.sql">sql/4_data.sql</a> : dict, map, country data</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">CREATE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">TABLE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">isd</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">station</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:bold">(</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">station</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">12</span><span style="color:#000;font-weight:bold">)</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">PRIMARY</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">KEY</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">usaf</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">)</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">GENERATED</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ALWAYS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">AS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">substring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">station</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">))</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">STORED</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">wban</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">)</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">GENERATED</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ALWAYS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">AS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">substring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">station</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">))</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">STORED</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">name</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">country</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">province</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">icao</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">location</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#000">GEOMETRY</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">POINT</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">longitude</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">NUMERIC</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">GENERATED</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ALWAYS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">AS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Round</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ST_X</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">location</span><span style="color:#000;font-weight:bold">)::</span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">))</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">STORED</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">latitude</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">NUMERIC</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">GENERATED</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ALWAYS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">AS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Round</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ST_Y</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">location</span><span style="color:#000;font-weight:bold">)::</span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">))</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">STORED</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">elevation</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">period</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#000">daterange</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">begin_date</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87">DATE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">GENERATED</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ALWAYS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">AS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">lower</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">period</span><span style="color:#000;font-weight:bold">))</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">STORED</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">end_date</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">DATE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">GENERATED</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ALWAYS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">AS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">upper</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">period</span><span style="color:#000;font-weight:bold">))</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">STORED</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:bold">);</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">CREATE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">TABLE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">IF</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NOT</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">EXISTS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">isd</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">daily</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:bold">(</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">station</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">12</span><span style="color:#000;font-weight:bold">)</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NOT</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NULL</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">-- station number 6USAF+5WBAN
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">ts</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87">DATE</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">NOT</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NULL</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">-- observation date
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- temperature &amp; dew point
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">temp_mean</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- mean temperature ℃
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">temp_min</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- min temperature ℃
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">temp_max</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- max temperature ℃
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">dewp_mean</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- mean dew point ℃
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- pressure
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">slp_mean</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- sea level pressure (hPa)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">stp_mean</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- station pressure (hPa)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- visible distance
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">vis_mean</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- visible distance (m)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- wind speed
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">wdsp_mean</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- average wind speed (m/s)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">wdsp_max</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- max wind speed (m/s)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">gust</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- max wind gust (m/s) 
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- precipitation / snow depth
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">prcp_mean</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- precipitation (mm)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">prcp</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- rectified precipitation (mm)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">sndp</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87">NuMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- snow depth (mm)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- FRSHTT (Fog/Rain/Snow/Hail/Thunder/Tornado)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">is_foggy</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">BOOLEAN</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic">-- (F)og
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">is_rainy</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">BOOLEAN</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic">-- (R)ain or Drizzle
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">is_snowy</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">BOOLEAN</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic">-- (S)now or pellets
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">is_hail</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#204a87">BOOLEAN</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic">-- (H)ail
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">is_thunder</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">BOOLEAN</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic">-- (T)hunder
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">is_tornado</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">BOOLEAN</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic">-- (T)ornado or Funnel Cloud
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- record count
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">temp_count</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">SMALLINT</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic">-- record count for temp
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">dewp_count</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">SMALLINT</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic">-- record count for dew point
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">slp_count</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">SMALLINT</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic">-- record count for sea level pressure
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">stp_count</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">SMALLINT</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic">-- record count for station pressure
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">wdsp_count</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">SMALLINT</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic">-- record count for wind speed
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">visib_count</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87">SMALLINT</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic">-- record count for visible distance
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- temp marks
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">temp_min_f</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">BOOLEAN</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic">-- aggregate min temperature
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">temp_max_f</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">BOOLEAN</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic">-- aggregate max temperature
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">prcp_flag</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">CHAR</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic">-- precipitation flag: ABCDEFGHI
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">PRIMARY</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">KEY</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">station</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ts</span><span style="color:#000;font-weight:bold">)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:bold">);</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">-- PARTITION BY RANGE (ts);
</span></span></span></code></pre></div><details><summary>ISD Hourly</summary>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">CREATE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">TABLE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">IF</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NOT</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">EXISTS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">isd</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">hourly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:bold">(</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">station</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">12</span><span style="color:#000;font-weight:bold">)</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NOT</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NULL</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">-- station id
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">ts</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#204a87;font-weight:bold">TIMESTAMP</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">NOT</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NULL</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">-- timestamp
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- air
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">temp</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- [-93.2,+61.8]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">dewp</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- [-98.2,+36.8]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">slp</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- [8600,10900]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">stp</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- [4500,10900]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">vis</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- [0,160000]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- wind
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">wd_angle</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- [1,360]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">wd_speed</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- [0,90]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">wd_gust</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- [0,110]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">wd_code</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- code that denotes the character of the WIND-OBSERVATION.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- cloud
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">cld_height</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- [0,22000]
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">cld_code</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- cloud code
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- water
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">sndp</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- mm snow
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">prcp</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">-- mm precipitation
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">prcp_hour</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- precipitation duration in hour
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">prcp_code</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- precipitation type code
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- sky
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">mw_code</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- manual weather observation code
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">aw_code</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- auto weather observation code
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">pw_code</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">VARCHAR</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- weather code of past period of time
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">pw_hour</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87">NUMERIC</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic">-- duration of pw_code period
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- misc
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- remark     TEXT,
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">-- eqd        TEXT,
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">data</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#000">JSONB</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic">-- extra data
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">)</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">PARTITION</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">BY</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">RANGE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ts</span><span style="color:#000;font-weight:bold">);</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></details>
<h2 id="parser">Parser</h2>
<p>There are two parsers: <a href="parser/isdd/isdd.go"><code>isdd</code></a> and <a href="parser/isdh/isdh.go"><code>isdh</code></a>, which takes noaa original yearly tarball as input, generate CSV as output (which could be directly consumed by PostgreSQL <code>COPY</code> command).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>NAME
</span></span><span style="display:flex;"><span>        isd -- Intergrated Surface Dataset Parser
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SYNOPSIS
</span></span><span style="display:flex;"><span>        isd daily   <span style="color:#ce5c00;font-weight:bold">[</span>-i &lt;input<span style="color:#000;font-weight:bold">|</span>stdin&gt;<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o &lt;output<span style="color:#000;font-weight:bold">|</span>stout&gt;<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-v<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>        isd hourly  <span style="color:#ce5c00;font-weight:bold">[</span>-i &lt;input<span style="color:#000;font-weight:bold">|</span>stdin&gt;<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o &lt;output<span style="color:#000;font-weight:bold">|</span>stout&gt;<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-v<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-d raw<span style="color:#000;font-weight:bold">|</span>ts-first<span style="color:#000;font-weight:bold">|</span>hour-first<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DESCRIPTION
</span></span><span style="display:flex;"><span>        The isd program takes noaa isd daily/hourly raw tarball data as input.
</span></span><span style="display:flex;"><span>        and generate parsed data in csv format as output. Works in pipe mode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        cat data/daily/2023.tar.gz <span style="color:#000;font-weight:bold">|</span> bin/isd daily -v <span style="color:#000;font-weight:bold">|</span> psql <span style="color:#4e9a06">${</span><span style="color:#000">PGURL</span><span style="color:#4e9a06">}</span> -AXtwqc <span style="color:#4e9a06">&#34;COPY isd.daily FROM STDIN CSV;&#34;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        isd daily  -v -i data/daily/2023.tar.gz  <span style="color:#000;font-weight:bold">|</span> psql <span style="color:#4e9a06">${</span><span style="color:#000">PGURL</span><span style="color:#4e9a06">}</span> -AXtwqc <span style="color:#4e9a06">&#34;COPY isd.daily FROM STDIN CSV;&#34;</span>
</span></span><span style="display:flex;"><span>        isd hourly -v -i data/hourly/2023.tar.gz <span style="color:#000;font-weight:bold">|</span> psql <span style="color:#4e9a06">${</span><span style="color:#000">PGURL</span><span style="color:#4e9a06">}</span> -AXtwqc <span style="color:#4e9a06">&#34;COPY isd.hourly FROM STDIN CSV;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OPTIONS
</span></span><span style="display:flex;"><span>        -i  &lt;input&gt;     input file, stdin by default
</span></span><span style="display:flex;"><span>        -o  &lt;output&gt;    output file, stdout by default
</span></span><span style="display:flex;"><span>        -p  &lt;profpath&gt;  pprof file path, <span style="color:#204a87">enable</span> <span style="color:#204a87;font-weight:bold">if</span> specified
</span></span><span style="display:flex;"><span>        -d              de-duplicate rows <span style="color:#204a87;font-weight:bold">for</span> hourly dataset <span style="color:#ce5c00;font-weight:bold">(</span>raw, ts-first, hour-first<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        -v              verbose mode
</span></span><span style="display:flex;"><span>        -h              print <span style="color:#204a87">help</span>
</span></span></code></pre></div><h2 id="ui">UI</h2>
<p><strong>ISD Overview</strong></p>
<p>Show all stations on a world map.</p>
<p><a href="https://demo.pigsty.cc/d/isd-overview"><img alt="isd-overview.jpg" src="/img/docs/app/isd-overview.jpg"></a></p>
<p><strong>ISD Country</strong></p>
<p>Show all stations among a country.</p>
<p><a href="https://demo.pigsty.cc/d/isd-country"><img alt="isd-country.jpg" src="/img/docs/app/isd-country.jpg"></a></p>
<p><strong>ISD Station</strong></p>
<p>Visualize station metadata and daily/monthly/yearly summary</p>
<details><summary>ISD Station Dashboard</summary>
<p><a href="https://demo.pigsty.cc/d/isd-station"><img alt="isd-station.jpg" src="/img/docs/app/isd-station.jpg"></a></p>
</details>
<p><strong>ISD Detail</strong></p>
<p>Visualize hourly observation raw metrics.</p>
<details><summary>ISD Station Dashboard</summary>
<p><a href="https://demo.pigsty.cc/d/isd-detail"><img alt="isd-detail.jpg" src="/img/docs/app/isd-detail.jpg"></a></p>
</details>
<h2 id="license">License</h2>
<p><a href="LICENSE">MIT License</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8e9936e3e240dd7ededdff359a36e883">3 - WHO COVID-19 Data Analysis</h1>
    <div class="lead">Pigsty built-in application which visualize WHO covid-19 data</div>
	<p>The on-line demo: <a href="https://demo.pigsty.cc/d/covid-overview">https://demo.pigsty.cc/d/covid-overview</a></p>
<p><a href="https://demo.pigsty.cc/d/covid-overview"><img src="/img/docs/app/covid-overview.jpeg"></a></p>
<p><a href="https://demo.pigsty.cc/d/covid-country"><img src="/img/docs/app/covid-country.jpeg"></a></p>
<p><a href="https://demo.pigsty.cc/d/covid-timeline-map?var-data_type=new_cases"><img src="/img/docs/app/covid-map.jpeg"></a></p>
<h2 id="installation">Installation</h2>
<p>Enter the app folder and run <code>make</code> to perform the installation:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make            <span style="color:#8f5902;font-style:italic"># if local data is viable</span>
</span></span><span style="display:flex;"><span>make all        <span style="color:#8f5902;font-style:italic"># download data from WHO</span>
</span></span><span style="display:flex;"><span>makd reload     <span style="color:#8f5902;font-style:italic"># re-download the latest data</span>
</span></span></code></pre></div><p>Other subtasks:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make reload     <span style="color:#8f5902;font-style:italic"># download latest data and pour it again</span>
</span></span><span style="display:flex;"><span>make ui         <span style="color:#8f5902;font-style:italic"># install grafana dashboards</span>
</span></span><span style="display:flex;"><span>make sql        <span style="color:#8f5902;font-style:italic"># install database schemas</span>
</span></span><span style="display:flex;"><span>make download   <span style="color:#8f5902;font-style:italic"># download latest data</span>
</span></span><span style="display:flex;"><span>make load       <span style="color:#8f5902;font-style:italic"># load downloaded data into database</span>
</span></span><span style="display:flex;"><span>make reload     <span style="color:#8f5902;font-style:italic"># download latest data and pour it into database</span>
</span></span></code></pre></div><h2 id="dashboards">Dashboards</h2>
<ul>
<li><a href="https://demo.pigsty.cc/d/covid-overview">Covid Overview</a></li>
<li><a href="https://demo.pigsty.cc/d/covid-country">Covid Country</a></li>
<li><a href="https://demo.pigsty.cc/d/covid-timeline-map?var-data_type=new_cases">Covid Timeline</a></li>
</ul>

</div>



    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Mail" aria-label="Mail">
    <a target="_blank" rel="noopener" href="mailto:rh@vonng.com" aria-label="Mail">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/Vonng/pigsty" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/GobeUncleWang" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="WeChat" aria-label="WeChat">
    <a target="_blank" rel="noopener" href="/img/pigsty/pigsty-cc.jpg" aria-label="WeChat">
      <i class="fa fa-comment"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Discord" aria-label="Discord">
    <a target="_blank" rel="noopener" href="https://discord.gg/wDzt5VyWEz" aria-label="Discord">
      <i class="fab fa-discord"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Telegram" aria-label="Telegram">
    <a target="_blank" rel="noopener" href="https://t.me/joinchat/gV9zfZraNPM3YjFh" aria-label="Telegram">
      <i class="fab fa-telegram"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2018&ndash;2024
    <span class="td-footer__authors">Ruohang Feng</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span></span><span class="ms-2"><a href="https://vonng.com/en/" target="_blank" rel="noopener">@Vonng</a></span>
<br><span>Pigsty® distributed under <a href="/docs/about/license" target="_blank" rel="noopener">AGPLv3</a></span>
<br><span class="ms-2"><a href="/docs/about/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
<span><a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">浙ICP备15016890号</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.248655eb216150e39da254c2f7aa5357805d0ec66bdb741b591cd35fb5f629ab.js" integrity="sha256-JIZV6yFhUOOdolTC96pTV4BdDsZr23QbWRzTX7X2Kas=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
