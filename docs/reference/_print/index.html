<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="/docs/reference/">
<link rel="alternate" type="application/rss&#43;xml" href="/docs/reference/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>References | Pigsty</title>
<meta name="description" content="Detailed information and list: supported OS distros, available modules, monitor metrics, extensions, cost compare &amp; analysis, glossary
">
<meta property="og:title" content="References" />
<meta property="og:description" content="Detailed information and list: supported OS distros, available modules, monitor metrics, extensions, cost compare &amp; analysis, glossary
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/reference/" />

<meta itemprop="name" content="References">
<meta itemprop="description" content="Detailed information and list: supported OS distros, available modules, monitor metrics, extensions, cost compare &amp; analysis, glossary
"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="References"/>
<meta name="twitter:description" content="Detailed information and list: supported OS distros, available modules, monitor metrics, extensions, cost compare &amp; analysis, glossary
"/>




<link rel="preload" href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" as="style">
<link href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" rel="stylesheet" integrity="">

<script
  src="/js/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="/js/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-LG1V9WTKGE');
}
</script>
  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class="navbar-brand__name">Pigsty</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/docs/"><i class='fa-solid fa-book'></i><span>Docs</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/blog/"><i class="fas fa-blog"></i><span>Blog</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/Vonng/pigsty/" target="_blank" rel="noopener"><i class='fab fa-github'></i><span>GitHub</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <i class="fa-solid fa-language"></i>English</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/zh/docs/reference/">中文</a></li>
    </ul>
</div>
</li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.dc22ffb9b868686ed6973aefbe6630db.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/reference/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">References</h1>
<div class="lead">Detailed information and list: supported OS distros, available modules, monitor metrics, extensions, cost compare &amp; analysis, glossary</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-d1a5b117e7245bf2c0440d8ef0d4582a">Compatibility</a></li>


    
  
    
    
	
<li>2: <a href="#pg-edd87fdd8acaabad7b8183cbb20b2318">Parameters</a></li>


    
  
    
    
	
<li>3: <a href="#pg-e702b44e01d91c35371415f67a25ac19">Extension List</a></li>


    
  
    
    
	
<li>4: <a href="#pg-eccd19a576ee933ff16667af4533c033">File Hierarchy</a></li>


    
  
    
    
	
<li>5: <a href="#pg-84ae7ee461c44a3c65150c096169dfc2">Comparison</a></li>


    
  
    
    
	
<li>6: <a href="#pg-724a9899719548b393b18b25ed0323cb">Cost Analysis</a></li>


    
  
    
    
	
<li>7: <a href="#pg-dbab37f93e145eb07dbd2362106ccd61">Glossary</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-d1a5b117e7245bf2c0440d8ef0d4582a">1 - Compatibility</h1>
    <div class="lead">Supported operating systems, kernels &amp; arch, PostgreSQL major versions and feature sets.</div>
	<hr>
<h2 id="overview">Overview</h2>
<p>Pigsty recommends using <strong>Linux</strong> kernel, <strong>amd64</strong> arch, and <strong>RockyLinux 8.9</strong>, <strong>Debian 12</strong> or <strong>Ubuntu 22.04</strong> as base OS.</p>
<p><a href="/docs/reference/compatibility/#kernel--arch-support"><strong>Kernel Architecture Compatibility</strong></a>: <code>Linux</code> kernel, <code>amd64</code> architecture (<code>x86_64</code>)</p>
<p><a href="/docs/reference/compatibility/#el-distribution-support"><strong>EL Distribution Support</strong></a>: <strong>EL7</strong>, <strong>EL8</strong>, <strong>EL9</strong>; (RHEL, Rocky, CentOS, Alma, Oracle, Anolis,&hellip;)</p>
<p><a href="/docs/reference/compatibility/#debian-distribution-support"><strong>Debian Distribution Support</strong></a>: <strong>Ubuntu</strong> <strong>24.04</strong> <code>noble</code>, <strong>22.04</strong> <code>jammy</code>, <strong>20.04</strong> <code>focal</code>; <strong>Debian 12</strong> <code>bookworm</code> and <strong>11</strong> <code>bullseye</code>.</p>
<p>Pigsty does not use any virtualization or containerization technologies, running directly on the bare OS. Supported operating systems include EL 7/8/9 (RHEL, Rocky, CentOS, Alma, Oracle, Anolis,&hellip;),
Ubuntu 24.04 / 20.04 / 22.04 &amp; Debian 11/12. <strong>EL</strong> is our long-term supported OS, while support for Ubuntu/Debian systems was introduced in the recent v2.5 version.
The main difference between EL and Debian distributions is the significant variation in package names, as well as the default availability of PostgreSQL <a href="https://ext.pigsty.io/#/list"><strong>extensions</strong></a>.</p>
<p>If you have advanced compatibility requirements, such as using specific operating system distributions, major versions, or minor versions, we offer advance <a href="/docs/about/service/"><strong>compatibility support</strong></a> options.</p>
<hr>
<h2 id="kernel--arch-support">Kernel &amp; Arch Support</h2>
<p>Currently, Pigsty supports the <strong>Linux</strong> kernel and the <code>x86_64</code> / <code>amd64</code> chip architecture.</p>
<p>MacOS and Windows operating systems can install Pigsty via Linux virtual machines/containers. We provide <a href="/docs/setup/provision/"><strong>Vagrant</strong></a> local sandbox support, allowing you to use virtualization software like Vagrant and Virtualbox to effortlessly bring up the deployment environment required by Pigsty on other operating systems.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">ARM64 Support</h4>

    We have partial support for <code>arm64</code> architecture with our <a href="/docs/about/service/"><strong>pro service</strong></a>, (EL9 &amp; Debian12 &amp; Ubuntu 22.04)

</div>

<hr>
<h2 id="el-distribution-support">EL Distribution Support</h2>
<p>The <strong>EL</strong> series operating systems are Pigsty&rsquo;s primary support target, including compatible distributions such as Red Hat Enterprise Linux, RockyLinux, CentOS, AlmaLinux, OracleLinux, Anolis, etc. Pigsty supports the latest three major versions: <strong>7</strong>, <strong>8</strong>, <strong>9</strong></p>
<ul>
<li><strong>EL9</strong>: RHEL, RockyLinux, AlmaLinux (<i class="fas fa-star text-secondary"></i>Rocky 9.3 recommended)</li>
<li><strong>EL8</strong>: RHEL, RockyLinux, AlmaLinux, Anolis (Rocky 8.9 recommended)</li>
<li><strong>EL7</strong>: RHEL, CentOS 7.9 (CentOS 7.9 recommended)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">Code</th>
<th>EL Distros</th>
<th>Minor</th>
<th style="text-align:right">PG17</th>
<th style="text-align:right">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
<th>Limitation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>EL9</strong></td>
<td>RHEL 9 / Rocky9 / Alma9</td>
<td>9.3</td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:right"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td><i class="fas fa-star text-secondary"></i> <strong>Standard Feature Set</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>EL8</strong></td>
<td>RHEL 8 / Rocky8 / Alma8 / Anolis8</td>
<td>8.9</td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:right"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td>Missing <code>pljava</code> extension</td>
</tr>
<tr>
<td style="text-align:center"><strong>EL7</strong></td>
<td>RHEL7 / CentOS7</td>
<td>7.9</td>
<td style="text-align:right"><i class="fas fa-triangle-exclamation text-danger"></i></td>
<td style="text-align:right"><i class="fas fa-triangle-exclamation text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td>EOLed OS, PG16/17, Rust and many other extensions unavailable</td>
</tr>
</tbody>
</table>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">RockyLinux 8.9 Recommended</h4>

    <i class="fas fa-star text-secondary"></i>
Rocky 8.9 achieves a good balance between system reliability/stability and the novelty/comprehensiveness of software versions. It&rsquo;s recommended for EL series users to default to this system version.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">EL7 End of Life!</h4>

    <i class="fas fa-triangle-exclamation text-danger"></i>
Red Hat Enterprise Linux 7 is <a href="https://www.redhat.com/en/blog/end-maintenance-red-hat-enterprise-linux-7-almost-here">end of maintenance</a>, Pigsty will no longer have official EL7 support in the open-source version. We have EL7 legacy support in our <a href="/docs/about/service/"><strong>pro service</strong></a>.

</div>

<hr>
<h2 id="debian-distribution-support">Debian Distribution Support</h2>
<p>Pigsty supports <strong>Ubuntu</strong> / <strong>Debian</strong> series operating systems and their compatible distributions, currently supporting the two most recent LTS major versions, namely:</p>
<ul>
<li><strong>U22</strong>: Ubuntu 22.04 LTS jammy (24.04.1)</li>
<li><strong>U22</strong>: Ubuntu 22.04 LTS jammy (22.04.3 Recommended)</li>
<li><strong>U20</strong>: Ubuntu 20.04 LTS focal (20.04.6)</li>
<li><strong>D12</strong>: Debian 12 bookworm (12.4)</li>
<li><strong>D11</strong>: Debian 11 bullseye (11.8)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">Code</th>
<th>Debian Distros</th>
<th>Minor</th>
<th style="text-align:right">PG17</th>
<th style="text-align:right">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
<th>Limitations</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>U24</strong></td>
<td>Ubuntu 24.04 (noble)</td>
<td>24.04.1</td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:right"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td><i class="fas fa-triangle-exclamation text-secondary"></i>   Missing PGML, citus, topn, timescale_toolkit</td>
</tr>
<tr>
<td style="text-align:center"><strong>U22</strong></td>
<td>Ubuntu 22.04 (jammy)</td>
<td>22.04.5</td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:right"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td><i class="fas fa-star text-secondary"></i>  Standard Debian series feature set</td>
</tr>
<tr>
<td style="text-align:center"><strong>U20</strong></td>
<td>Ubuntu 20.04 (focal)</td>
<td>20.04.6</td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:right"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td><i class="fas fa-triangle-exclamation text-danger"></i> EOL, Some extensions require online installation</td>
</tr>
<tr>
<td style="text-align:center"><strong>D12</strong></td>
<td>Debian 12 (bookworm)</td>
<td>12.4</td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:right"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td><i class="fas fa-triangle-exclamation text-secondary"></i> Missing polardb, wiltondb/babelfish, and official PGML support</td>
</tr>
<tr>
<td style="text-align:center"><strong>D11</strong></td>
<td>Debian 11 (bullseye)</td>
<td>11.8</td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:right"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-check text-primary"></i></td>
<td><i class="fas fa-triangle-exclamation text-danger"></i> EOL</td>
</tr>
</tbody>
</table>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Ubuntu 22.04 LTS Recommended</h4>

    <i class="fas fa-star text-secondary"></i>
Ubuntu 22.04 comes with the most comp
PostgresML has official support for the AL/ML extension <code>pgml</code> for Ubuntu 22.04, so users with related needs are advised to use Ubuntu 22.04.3.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Ubuntu 20.04 nearing EOL</h4>

    <p><i class="fas fa-triangle-exclamation text-secondary"></i>
Ubuntu 20.04 focal is not recommended, it will end of standard support @ Apr 2025, Check <a href="https://ubuntu.com/about/release-cycle">Ubuntu Release Cycle</a> for details</p>
<p>Besides, Ubuntu 20.04 has missing dependencies for the <code>postgresql-16-postgis</code> and <code>postgresql-server-dev-16</code> packages, requiring online installation in a connected environment.
If your environment does not have internet access, and you need to use the PostGIS extension, please use this operating system with caution.</p>


</div>

<hr>
<h2 id="vagrant-boxes">Vagrant Boxes</h2>
<p>When deploying Pigsty on cloud servers, you might consider using the following operating system images in Vagrant, which are also the images used for Pigsty&rsquo;s development, testing, and building.</p>
<ul>
<li><a href="https://app.vagrantup.com/generic/boxes/centos7"><code>generic/centos7</code></a>:  CentOS 7.9</li>
<li><a href="https://app.vagrantup.com/generic/boxes/rocky8"><code>generic/rocky8</code></a>:  Rocky 8.9</li>
<li><a href="https://app.vagrantup.com/generic/boxes/rocky9"><code>generic/rocky9</code></a>:  Rocky 9.3</li>
<li><a href="https://app.vagrantup.com/generic/boxes/debian11"><code>generic/debian11</code></a>:  Debian 11.8</li>
<li><a href="https://app.vagrantup.com/generic/boxes/debian12"><code>generic/debian12</code></a>:  Debian 12.4</li>
<li><a href="https://app.vagrantup.com/generic/boxes/ubuntu2004"><code>generic/ubuntu2004</code></a>:  Ubuntu 20.04.6</li>
<li><a href="https://app.vagrantup.com/generic/boxes/ubuntu2204"><code>generic/ubuntu2204</code></a>:  Ubuntu 22.04.3</li>
<li><a href="https://portal.cloud.hashicorp.com/vagrant/discover/bento/ubuntu-24.04"><code>bento/ubuntu-24.04</code></a>:  Ubuntu 24.04</li>
</ul>
<hr>
<h2 id="terraform-images">Terraform Images</h2>
<p>When deploying Pigsty on cloud servers, you might consider using the following operating system base images in Terraform, using Alibaba Cloud as an example:</p>
<ul>
<li>CentOS 7.9     :  <code>centos_7_9_x64_20G_alibase_20240628.vhd</code></li>
<li>Rocky 8.10     :  <code>rockylinux_8_10_x64_20G_alibase_20240923.vhd</code></li>
<li>Rocky 9.4      :  <code>rockylinux_9_4_x64_20G_alibase_20240925.vhd</code></li>
<li>Ubuntu 20.04   :  <code>ubuntu_20_04_x64_20G_alibase_20240925.vhd</code></li>
<li>Ubuntu 22.04   :  <code>ubuntu_22_04_x64_20G_alibase_20240926.vhd</code></li>
<li>Ubuntu 24.04   :  <code>ubuntu_24_04_x64_20G_alibase_20240923.vhd</code></li>
<li>Debian 11.11   :  <code>debian_11_11_x64_20G_alibase_20240923.vhd</code></li>
<li>Debian 12.7    :  <code>debian_12_7_x64_20G_alibase_20240927.vhd</code></li>
<li>Anolis 8.8     :  <code>anolisos_8_9_x64_20G_rhck_alibase_20240724.vhd</code></li>
</ul>
<hr>
<h2 id="references">References</h2>
<ul>
<li><a href="/zh/blog/db/rhel-compatibility/">Which EL Series Operating System Has the Best Compatibility?</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-edd87fdd8acaabad7b8183cbb20b2318">2 - Parameters</h1>
    <div class="lead">Pigsty has 280+ parameters to describe every aspect of the environment &amp; various modules</div>
	<blockquote>
<p>There are 280+ parameters in Pigsty describing all aspect of the deployment.</p>
</blockquote>
<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Module</th>
<th>Section</th>
<th>Type</th>
<th>Level</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>101</td>
<td><a href="/docs/reference/param/#version"><code>version</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#meta"><code>META</code></a></td>
<td>string</td>
<td>G</td>
<td>pigsty version string</td>
</tr>
<tr>
<td>102</td>
<td><a href="/docs/reference/param/#admin_ip"><code>admin_ip</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#meta"><code>META</code></a></td>
<td>ip</td>
<td>G</td>
<td>admin node ip address</td>
</tr>
<tr>
<td>103</td>
<td><a href="/docs/reference/param/#region"><code>region</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#meta"><code>META</code></a></td>
<td>enum</td>
<td>G</td>
<td>upstream mirror region: default,china,europe</td>
</tr>
<tr>
<td>104</td>
<td><a href="/docs/reference/param/#proxy_env"><code>proxy_env</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#meta"><code>META</code></a></td>
<td>dict</td>
<td>G</td>
<td>global proxy env when downloading packages</td>
</tr>
<tr>
<td>105</td>
<td><a href="/docs/reference/param/#ca_method"><code>ca_method</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#ca"><code>CA</code></a></td>
<td>enum</td>
<td>G</td>
<td>create,recreate,copy, create by default</td>
</tr>
<tr>
<td>106</td>
<td><a href="/docs/reference/param/#ca_cn"><code>ca_cn</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#ca"><code>CA</code></a></td>
<td>string</td>
<td>G</td>
<td>ca common name, fixed as pigsty-ca</td>
</tr>
<tr>
<td>107</td>
<td><a href="/docs/reference/param/#cert_validity"><code>cert_validity</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#ca"><code>CA</code></a></td>
<td>interval</td>
<td>G</td>
<td>cert validity, 20 years by default</td>
</tr>
<tr>
<td>108</td>
<td><a href="/docs/reference/param/#infra_seq"><code>infra_seq</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#infra_id"><code>INFRA_ID</code></a></td>
<td>int</td>
<td>I</td>
<td>infra node identity, REQUIRED</td>
</tr>
<tr>
<td>109</td>
<td><a href="/docs/reference/param/#infra_portal"><code>infra_portal</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#infra_id"><code>INFRA_ID</code></a></td>
<td>dict</td>
<td>G</td>
<td>infra services exposed via portal</td>
</tr>
<tr>
<td>110</td>
<td><a href="/docs/reference/param/#repo_enabled"><code>repo_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>create a yum repo on this infra node?</td>
</tr>
<tr>
<td>111</td>
<td><a href="/docs/reference/param/#repo_home"><code>repo_home</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>path</td>
<td>G</td>
<td>repo home dir, <code>/www</code> by default</td>
</tr>
<tr>
<td>112</td>
<td><a href="/docs/reference/param/#repo_name"><code>repo_name</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string</td>
<td>G</td>
<td>repo name, pigsty by default</td>
</tr>
<tr>
<td>113</td>
<td><a href="/docs/reference/param/#repo_endpoint"><code>repo_endpoint</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>url</td>
<td>G</td>
<td>access point to this repo by domain or ip:port</td>
</tr>
<tr>
<td>114</td>
<td><a href="/docs/reference/param/#repo_remove"><code>repo_remove</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>remove existing upstream repo</td>
</tr>
<tr>
<td>115</td>
<td><a href="/docs/reference/param/#repo_modules"><code>repo_modules</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string</td>
<td>G/A</td>
<td>which repo modules are installed in repo_upstream</td>
</tr>
<tr>
<td>116</td>
<td><a href="/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>upstream[]</td>
<td>G</td>
<td>where to download upstream packages</td>
</tr>
<tr>
<td>117</td>
<td><a href="/docs/reference/param/#repo_packages"><code>repo_packages</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string[]</td>
<td>G</td>
<td>which packages to be included</td>
</tr>
<tr>
<td>118</td>
<td><a href="/docs/reference/param/#repo_extra_packages"><code>repo_extra_packages</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string[]</td>
<td>G/C/I</td>
<td>extra packages to be included</td>
</tr>
<tr>
<td>119</td>
<td><a href="/docs/reference/param/#repo_url_packages"><code>repo_url_packages</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#repo"><code>REPO</code></a></td>
<td>string[]</td>
<td>G</td>
<td>extra packages from url</td>
</tr>
<tr>
<td>120</td>
<td><a href="/docs/reference/param/#infra_packages"><code>infra_packages</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#infra_package"><code>INFRA_PACKAGE</code></a></td>
<td>string[]</td>
<td>G</td>
<td>packages to be installed on infra nodes</td>
</tr>
<tr>
<td>121</td>
<td><a href="/docs/reference/param/#infra_packages_pip"><code>infra_packages_pip</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#infra_package"><code>INFRA_PACKAGE</code></a></td>
<td>string</td>
<td>G</td>
<td>pip installed packages for infra nodes</td>
</tr>
<tr>
<td>130</td>
<td><a href="/docs/reference/param/#nginx_enabled"><code>nginx_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>enable nginx on this infra node?</td>
</tr>
<tr>
<td>131</td>
<td><a href="/docs/reference/param/#nginx_enabled"><code>nginx_exporter_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>enable nginx_exporter on this infra node?</td>
</tr>
<tr>
<td>132</td>
<td><a href="/docs/reference/param/#nginx_sslmode"><code>nginx_sslmode</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>enum</td>
<td>G</td>
<td>nginx ssl mode? disable,enable,enforce</td>
</tr>
<tr>
<td>133</td>
<td><a href="/docs/reference/param/#nginx_home"><code>nginx_home</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>path</td>
<td>G</td>
<td>nginx content dir, <code>/www</code> by default</td>
</tr>
<tr>
<td>134</td>
<td><a href="/docs/reference/param/#nginx_port"><code>nginx_port</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>port</td>
<td>G</td>
<td>nginx listen port, 80 by default</td>
</tr>
<tr>
<td>135</td>
<td><a href="/docs/reference/param/#nginx_ssl_port"><code>nginx_ssl_port</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>port</td>
<td>G</td>
<td>nginx ssl listen port, 443 by default</td>
</tr>
<tr>
<td>136</td>
<td><a href="/docs/reference/param/#nginx_navbar"><code>nginx_navbar</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#nginx"><code>NGINX</code></a></td>
<td>index[]</td>
<td>G</td>
<td>nginx index page navigation links</td>
</tr>
<tr>
<td>140</td>
<td><a href="/docs/reference/param/#dns_enabled"><code>dns_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#dns"><code>DNS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>setup dnsmasq on this infra node?</td>
</tr>
<tr>
<td>141</td>
<td><a href="/docs/reference/param/#dns_port"><code>dns_port</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#dns"><code>DNS</code></a></td>
<td>port</td>
<td>G</td>
<td>dns server listen port, 53 by default</td>
</tr>
<tr>
<td>142</td>
<td><a href="/docs/reference/param/#dns_records"><code>dns_records</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#dns"><code>DNS</code></a></td>
<td>string[]</td>
<td>G</td>
<td>dynamic dns records resolved by dnsmasq</td>
</tr>
<tr>
<td>150</td>
<td><a href="/docs/reference/param/#prometheus_enabled"><code>prometheus_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>enable prometheus on this infra node?</td>
</tr>
<tr>
<td>151</td>
<td><a href="/docs/reference/param/#prometheus_clean"><code>prometheus_clean</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>clean prometheus data during init?</td>
</tr>
<tr>
<td>152</td>
<td><a href="/docs/reference/param/#prometheus_data"><code>prometheus_data</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>path</td>
<td>G</td>
<td>prometheus data dir, <code>/data/prometheus</code> by default</td>
</tr>
<tr>
<td>153</td>
<td><a href="/docs/reference/param/#prometheus_sd_dir"><code>prometheus_sd_dir</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>path</td>
<td>G</td>
<td>prometheus file service discovery directory</td>
</tr>
<tr>
<td>154</td>
<td><a href="/docs/reference/param/#prometheus_sd_interval"><code>prometheus_sd_interval</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>interval</td>
<td>G</td>
<td>prometheus target refresh interval, 5s by default</td>
</tr>
<tr>
<td>155</td>
<td><a href="/docs/reference/param/#prometheus_scrape_interval"><code>prometheus_scrape_interval</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>interval</td>
<td>G</td>
<td>prometheus scrape &amp; eval interval, 10s by default</td>
</tr>
<tr>
<td>156</td>
<td><a href="/docs/reference/param/#prometheus_scrape_timeout"><code>prometheus_scrape_timeout</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>interval</td>
<td>G</td>
<td>prometheus global scrape timeout, 8s by default</td>
</tr>
<tr>
<td>157</td>
<td><a href="/docs/reference/param/#prometheus_options"><code>prometheus_options</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>arg</td>
<td>G</td>
<td>prometheus extra server options</td>
</tr>
<tr>
<td>158</td>
<td><a href="/docs/reference/param/#pushgateway_enabled"><code>pushgateway_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>setup pushgateway on this infra node?</td>
</tr>
<tr>
<td>159</td>
<td><a href="/docs/reference/param/#pushgateway_options"><code>pushgateway_options</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>arg</td>
<td>G</td>
<td>pushgateway extra server options</td>
</tr>
<tr>
<td>160</td>
<td><a href="/docs/reference/param/#blackbox_enabled"><code>blackbox_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>setup blackbox_exporter on this infra node?</td>
</tr>
<tr>
<td>161</td>
<td><a href="/docs/reference/param/#blackbox_options"><code>blackbox_options</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>arg</td>
<td>G</td>
<td>blackbox_exporter extra server options</td>
</tr>
<tr>
<td>162</td>
<td><a href="/docs/reference/param/#alertmanager_enabled"><code>alertmanager_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>setup alertmanager on this infra node?</td>
</tr>
<tr>
<td>163</td>
<td><a href="/docs/reference/param/#alertmanager_options"><code>alertmanager_options</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>arg</td>
<td>G</td>
<td>alertmanager extra server options</td>
</tr>
<tr>
<td>164</td>
<td><a href="/docs/reference/param/#exporter_metrics_path"><code>exporter_metrics_path</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>path</td>
<td>G</td>
<td>exporter metric path, <code>/metrics</code> by default</td>
</tr>
<tr>
<td>165</td>
<td><a href="/docs/reference/param/#exporter_install"><code>exporter_install</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>enum</td>
<td>G</td>
<td>how to install exporter? none,yum,binary</td>
</tr>
<tr>
<td>166</td>
<td><a href="/docs/reference/param/#exporter_repo_url"><code>exporter_repo_url</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#prometheus"><code>PROMETHEUS</code></a></td>
<td>url</td>
<td>G</td>
<td>exporter repo file url if install exporter via yum</td>
</tr>
<tr>
<td>170</td>
<td><a href="/docs/reference/param/#grafana_enabled"><code>grafana_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>enable grafana on this infra node?</td>
</tr>
<tr>
<td>171</td>
<td><a href="/docs/reference/param/#grafana_clean"><code>grafana_clean</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>clean grafana data during init?</td>
</tr>
<tr>
<td>172</td>
<td><a href="/docs/reference/param/#grafana_admin_username"><code>grafana_admin_username</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>username</td>
<td>G</td>
<td>grafana admin username, <code>admin</code> by default</td>
</tr>
<tr>
<td>173</td>
<td><a href="/docs/reference/param/#grafana_admin_password"><code>grafana_admin_password</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#grafana"><code>GRAFANA</code></a></td>
<td>password</td>
<td>G</td>
<td>grafana admin password, <code>pigsty</code> by default</td>
</tr>
<tr>
<td>176</td>
<td><a href="/docs/reference/param/#loki_enabled"><code>loki_enabled</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#loki"><code>LOKI</code></a></td>
<td>bool</td>
<td>G/I</td>
<td>enable loki on this infra node?</td>
</tr>
<tr>
<td>177</td>
<td><a href="/docs/reference/param/#loki_clean"><code>loki_clean</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#loki"><code>LOKI</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>whether remove existing loki data?</td>
</tr>
<tr>
<td>178</td>
<td><a href="/docs/reference/param/#loki_data"><code>loki_data</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#loki"><code>LOKI</code></a></td>
<td>path</td>
<td>G</td>
<td>loki data dir, <code>/data/loki</code> by default</td>
</tr>
<tr>
<td>179</td>
<td><a href="/docs/reference/param/#loki_retention"><code>loki_retention</code></a></td>
<td><a href="/docs/reference/param/#infra"><code>INFRA</code></a></td>
<td><a href="/docs/reference/param/#loki"><code>LOKI</code></a></td>
<td>interval</td>
<td>G</td>
<td>loki log retention period, 15d by default</td>
</tr>
<tr>
<td>201</td>
<td><a href="/docs/reference/param/#nodename"><code>nodename</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>string</td>
<td>I</td>
<td>node instance identity, use hostname if missing, optional</td>
</tr>
<tr>
<td>202</td>
<td><a href="/docs/reference/param/#node_cluster"><code>node_cluster</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>string</td>
<td>C</td>
<td>node cluster identity, use &rsquo;nodes&rsquo; if missing, optional</td>
</tr>
<tr>
<td>203</td>
<td><a href="/docs/reference/param/#nodename_overwrite"><code>nodename_overwrite</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>bool</td>
<td>C</td>
<td>overwrite node&rsquo;s hostname with nodename?</td>
</tr>
<tr>
<td>204</td>
<td><a href="/docs/reference/param/#nodename_exchange"><code>nodename_exchange</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>bool</td>
<td>C</td>
<td>exchange nodename among play hosts?</td>
</tr>
<tr>
<td>205</td>
<td><a href="/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_id"><code>NODE_ID</code></a></td>
<td>bool</td>
<td>C</td>
<td>use postgres identity as node identity if applicable?</td>
</tr>
<tr>
<td>210</td>
<td><a href="/docs/reference/param/#node_write_etc_hosts"><code>node_write_etc_hosts</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>bool</td>
<td>G/C/I</td>
<td>modify <code>/etc/hosts</code> on target node?</td>
</tr>
<tr>
<td>211</td>
<td><a href="/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>string[]</td>
<td>G</td>
<td>static dns records in <code>/etc/hosts</code></td>
</tr>
<tr>
<td>212</td>
<td><a href="/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>string[]</td>
<td>C</td>
<td>extra static dns records in <code>/etc/hosts</code></td>
</tr>
<tr>
<td>213</td>
<td><a href="/docs/reference/param/#node_dns_method"><code>node_dns_method</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>enum</td>
<td>C</td>
<td>how to handle dns servers: add,none,overwrite</td>
</tr>
<tr>
<td>214</td>
<td><a href="/docs/reference/param/#node_dns_servers"><code>node_dns_servers</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>string[]</td>
<td>C</td>
<td>dynamic nameserver in <code>/etc/resolv.conf</code></td>
</tr>
<tr>
<td>215</td>
<td><a href="/docs/reference/param/#node_dns_options"><code>node_dns_options</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_dns"><code>NODE_DNS</code></a></td>
<td>string[]</td>
<td>C</td>
<td>dns resolv options in <code>/etc/resolv.conf</code></td>
</tr>
<tr>
<td>220</td>
<td><a href="/docs/reference/param/#node_repo_modules"><code>node_repo_modules</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_package"><code>NODE_PACKAGE</code></a></td>
<td>string</td>
<td>C</td>
<td>upstream repo to be added on node, local by default</td>
</tr>
<tr>
<td>221</td>
<td><a href="/docs/reference/param/#node_repo_remove"><code>node_repo_remove</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_package"><code>NODE_PACKAGE</code></a></td>
<td>bool</td>
<td>C</td>
<td>remove existing repo on node?</td>
</tr>
<tr>
<td>223</td>
<td><a href="/docs/reference/param/#node_packages"><code>node_packages</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_package"><code>NODE_PACKAGE</code></a></td>
<td>string[]</td>
<td>C</td>
<td>packages to be installed current nodes</td>
</tr>
<tr>
<td>224</td>
<td><a href="/docs/reference/param/#node_default_packages"><code>node_default_packages</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_package"><code>NODE_PACKAGE</code></a></td>
<td>string[]</td>
<td>G</td>
<td>default packages to be installed on all nodes</td>
</tr>
<tr>
<td>230</td>
<td><a href="/docs/reference/param/#node_disable_firewall"><code>node_disable_firewall</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>disable node firewall? true by default</td>
</tr>
<tr>
<td>231</td>
<td><a href="/docs/reference/param/#node_disable_selinux"><code>node_disable_selinux</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>disable node selinux? true by default</td>
</tr>
<tr>
<td>232</td>
<td><a href="/docs/reference/param/#node_disable_numa"><code>node_disable_numa</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>disable node numa, reboot required</td>
</tr>
<tr>
<td>233</td>
<td><a href="/docs/reference/param/#node_disable_swap"><code>node_disable_swap</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>disable node swap, use with caution</td>
</tr>
<tr>
<td>234</td>
<td><a href="/docs/reference/param/#node_static_network"><code>node_static_network</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>preserve dns resolver settings after reboot</td>
</tr>
<tr>
<td>235</td>
<td><a href="/docs/reference/param/#node_disk_prefetch"><code>node_disk_prefetch</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>bool</td>
<td>C</td>
<td>setup disk prefetch on HDD to increase performance</td>
</tr>
<tr>
<td>236</td>
<td><a href="/docs/reference/param/#node_kernel_modules"><code>node_kernel_modules</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>string[]</td>
<td>C</td>
<td>kernel modules to be enabled on this node</td>
</tr>
<tr>
<td>237</td>
<td><a href="/docs/reference/param/#node_hugepage_count"><code>node_hugepage_count</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>int</td>
<td>C</td>
<td>number of 2MB hugepage, take precedence over ratio</td>
</tr>
<tr>
<td>238</td>
<td><a href="/docs/reference/param/#node_hugepage_ratio"><code>node_hugepage_ratio</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>float</td>
<td>C</td>
<td>node mem hugepage ratio, 0 disable it by default</td>
</tr>
<tr>
<td>239</td>
<td><a href="/docs/reference/param/#node_overcommit_ratio"><code>node_overcommit_ratio</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>float</td>
<td>C</td>
<td>node mem overcommit ratio, 0 disable it by default</td>
</tr>
<tr>
<td>240</td>
<td><a href="/docs/reference/param/#node_tune"><code>node_tune</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>enum</td>
<td>C</td>
<td>node tuned profile: none,oltp,olap,crit,tiny</td>
</tr>
<tr>
<td>241</td>
<td><a href="/docs/reference/param/#node_sysctl_params"><code>node_sysctl_params</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_tune"><code>NODE_TUNE</code></a></td>
<td>dict</td>
<td>C</td>
<td>sysctl parameters in k:v format in addition to tuned</td>
</tr>
<tr>
<td>250</td>
<td><a href="/docs/reference/param/#node_data"><code>node_data</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>path</td>
<td>C</td>
<td>node main data directory, <code>/data</code> by default</td>
</tr>
<tr>
<td>251</td>
<td><a href="/docs/reference/param/#node_admin_enabled"><code>node_admin_enabled</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>bool</td>
<td>C</td>
<td>create a admin user on target node?</td>
</tr>
<tr>
<td>252</td>
<td><a href="/docs/reference/param/#node_admin_uid"><code>node_admin_uid</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>int</td>
<td>C</td>
<td>uid and gid for node admin user</td>
</tr>
<tr>
<td>253</td>
<td><a href="/docs/reference/param/#node_admin_username"><code>node_admin_username</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>username</td>
<td>C</td>
<td>name of node admin user, <code>dba</code> by default</td>
</tr>
<tr>
<td>254</td>
<td><a href="/docs/reference/param/#node_admin_ssh_exchange"><code>node_admin_ssh_exchange</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>bool</td>
<td>C</td>
<td>exchange admin ssh key among node cluster</td>
</tr>
<tr>
<td>255</td>
<td><a href="/docs/reference/param/#node_admin_pk_current"><code>node_admin_pk_current</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>bool</td>
<td>C</td>
<td>add current user&rsquo;s ssh pk to admin authorized_keys</td>
</tr>
<tr>
<td>256</td>
<td><a href="/docs/reference/param/#node_admin_pk_list"><code>node_admin_pk_list</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_admin"><code>NODE_ADMIN</code></a></td>
<td>string[]</td>
<td>C</td>
<td>ssh public keys to be added to admin user</td>
</tr>
<tr>
<td>260</td>
<td><a href="/docs/reference/param/#node_timezone"><code>node_timezone</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>string</td>
<td>C</td>
<td>setup node timezone, empty string to skip</td>
</tr>
<tr>
<td>261</td>
<td><a href="/docs/reference/param/#node_ntp_enabled"><code>node_ntp_enabled</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable chronyd time sync service?</td>
</tr>
<tr>
<td>262</td>
<td><a href="/docs/reference/param/#node_ntp_servers"><code>node_ntp_servers</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>string[]</td>
<td>C</td>
<td>ntp servers in <code>/etc/chrony.conf</code></td>
</tr>
<tr>
<td>263</td>
<td><a href="/docs/reference/param/#node_crontab_overwrite"><code>node_crontab_overwrite</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>bool</td>
<td>C</td>
<td>overwrite or append to <code>/etc/crontab</code>?</td>
</tr>
<tr>
<td>264</td>
<td><a href="/docs/reference/param/#node_crontab"><code>node_crontab</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_time"><code>NODE_TIME</code></a></td>
<td>string[]</td>
<td>C</td>
<td>crontab entries in <code>/etc/crontab</code></td>
</tr>
<tr>
<td>270</td>
<td><a href="/docs/reference/param/#vip_enabled"><code>vip_enabled</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable vip on this node cluster?</td>
</tr>
<tr>
<td>271</td>
<td><a href="/docs/reference/param/#vip_address"><code>vip_address</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>ip</td>
<td>C</td>
<td>node vip address in ipv4 format, required if vip is enabled</td>
</tr>
<tr>
<td>272</td>
<td><a href="/docs/reference/param/#vip_vrid"><code>vip_vrid</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>int</td>
<td>C</td>
<td>required, integer, 1-254, should be unique among same VLAN</td>
</tr>
<tr>
<td>273</td>
<td><a href="/docs/reference/param/#vip_role"><code>vip_role</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>enum</td>
<td>I</td>
<td>optional, <code>master/backup</code>, backup by default, use as init role</td>
</tr>
<tr>
<td>274</td>
<td><a href="/docs/reference/param/#vip_preempt"><code>vip_preempt</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>bool</td>
<td>C/I</td>
<td>optional, <code>true/false</code>, false by default, enable vip preemption</td>
</tr>
<tr>
<td>275</td>
<td><a href="/docs/reference/param/#vip_interface"><code>vip_interface</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>string</td>
<td>C/I</td>
<td>node vip network interface to listen, <code>eth0</code> by default</td>
</tr>
<tr>
<td>276</td>
<td><a href="/docs/reference/param/#vip_dns_suffix"><code>vip_dns_suffix</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>string</td>
<td>C</td>
<td>node vip dns name suffix, empty string by default</td>
</tr>
<tr>
<td>277</td>
<td><a href="/docs/reference/param/#vip_exporter_port"><code>vip_exporter_port</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_vip"><code>NODE_VIP</code></a></td>
<td>port</td>
<td>C</td>
<td>keepalived exporter listen port, 9650 by default</td>
</tr>
<tr>
<td>280</td>
<td><a href="/docs/reference/param/#haproxy_enabled"><code>haproxy_enabled</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable haproxy on this node?</td>
</tr>
<tr>
<td>281</td>
<td><a href="/docs/reference/param/#haproxy_clean"><code>haproxy_clean</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>cleanup all existing haproxy config?</td>
</tr>
<tr>
<td>282</td>
<td><a href="/docs/reference/param/#haproxy_reload"><code>haproxy_reload</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>bool</td>
<td>A</td>
<td>reload haproxy after config?</td>
</tr>
<tr>
<td>283</td>
<td><a href="/docs/reference/param/#haproxy_auth_enabled"><code>haproxy_auth_enabled</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>bool</td>
<td>G</td>
<td>enable authentication for haproxy admin page</td>
</tr>
<tr>
<td>284</td>
<td><a href="/docs/reference/param/#haproxy_admin_username"><code>haproxy_admin_username</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>username</td>
<td>G</td>
<td>haproxy admin username, <code>admin</code> by default</td>
</tr>
<tr>
<td>285</td>
<td><a href="/docs/reference/param/#haproxy_admin_password"><code>haproxy_admin_password</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>password</td>
<td>G</td>
<td>haproxy admin password, <code>pigsty</code> by default</td>
</tr>
<tr>
<td>286</td>
<td><a href="/docs/reference/param/#haproxy_exporter_port"><code>haproxy_exporter_port</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>port</td>
<td>C</td>
<td>haproxy admin/exporter port, 9101 by default</td>
</tr>
<tr>
<td>287</td>
<td><a href="/docs/reference/param/#haproxy_client_timeout"><code>haproxy_client_timeout</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>interval</td>
<td>C</td>
<td>client side connection timeout, 24h by default</td>
</tr>
<tr>
<td>288</td>
<td><a href="/docs/reference/param/#haproxy_server_timeout"><code>haproxy_server_timeout</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>interval</td>
<td>C</td>
<td>server side connection timeout, 24h by default</td>
</tr>
<tr>
<td>289</td>
<td><a href="/docs/reference/param/#haproxy_services"><code>haproxy_services</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#haproxy"><code>HAPROXY</code></a></td>
<td>service[]</td>
<td>C</td>
<td>list of haproxy service to be exposed on node</td>
</tr>
<tr>
<td>290</td>
<td><a href="/docs/reference/param/#node_exporter_enabled"><code>node_exporter_enabled</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_exporter"><code>NODE_EXPORTER</code></a></td>
<td>bool</td>
<td>C</td>
<td>setup node_exporter on this node?</td>
</tr>
<tr>
<td>291</td>
<td><a href="/docs/reference/param/#node_exporter_port"><code>node_exporter_port</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_exporter"><code>NODE_EXPORTER</code></a></td>
<td>port</td>
<td>C</td>
<td>node exporter listen port, 9100 by default</td>
</tr>
<tr>
<td>292</td>
<td><a href="/docs/reference/param/#node_exporter_options"><code>node_exporter_options</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#node_exporter"><code>NODE_EXPORTER</code></a></td>
<td>arg</td>
<td>C</td>
<td>extra server options for node_exporter</td>
</tr>
<tr>
<td>293</td>
<td><a href="/docs/reference/param/#promtail_enabled"><code>promtail_enabled</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#promtail"><code>PROMTAIL</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable promtail logging collector?</td>
</tr>
<tr>
<td>294</td>
<td><a href="/docs/reference/param/#promtail_clean"><code>promtail_clean</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#promtail"><code>PROMTAIL</code></a></td>
<td>bool</td>
<td>G/A</td>
<td>purge existing promtail status file during init?</td>
</tr>
<tr>
<td>295</td>
<td><a href="/docs/reference/param/#promtail_port"><code>promtail_port</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#promtail"><code>PROMTAIL</code></a></td>
<td>port</td>
<td>C</td>
<td>promtail listen port, 9080 by default</td>
</tr>
<tr>
<td>296</td>
<td><a href="/docs/reference/param/#promtail_positions"><code>promtail_positions</code></a></td>
<td><a href="/docs/reference/param/#node"><code>NODE</code></a></td>
<td><a href="/docs/reference/param/#promtail"><code>PROMTAIL</code></a></td>
<td>path</td>
<td>C</td>
<td>promtail position status file path</td>
</tr>
<tr>
<td>401</td>
<td><a href="/docs/reference/param/#docker_enabled"><code>docker_enabled</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>bool</td>
<td>G/C/I</td>
<td>enable docker on this node?</td>
</tr>
<tr>
<td>402</td>
<td><a href="/docs/reference/param/#docker_cgroups_driver"><code>docker_cgroups_driver</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>enum</td>
<td>G/C/I</td>
<td>docker cgroup fs driver: cgroupfs,systemd</td>
</tr>
<tr>
<td>403</td>
<td><a href="/docs/reference/param/#docker_registry_mirrors"><code>docker_registry_mirrors</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>string[]</td>
<td>G/C/I</td>
<td>docker registry mirror list</td>
</tr>
<tr>
<td>404</td>
<td><a href="/docs/reference/param/#docker_image"><code>docker_image</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>path[]</td>
<td>G/C/I</td>
<td>docker image to be pulled, [] by default</td>
</tr>
<tr>
<td>405</td>
<td><a href="/docs/reference/param/#docker_image_cache"><code>docker_image_cache</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td><a href="/docs/reference/param/#docker"><code>DOCKER</code></a></td>
<td>path</td>
<td>G/C/I</td>
<td>docker image cache tarball glob, <code>/tmp/docker</code> by default</td>
</tr>
<tr>
<td>501</td>
<td><a href="/docs/reference/param/#etcd_seq"><code>etcd_seq</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>int</td>
<td>I</td>
<td>etcd instance identifier, REQUIRED</td>
</tr>
<tr>
<td>502</td>
<td><a href="/docs/reference/param/#etcd_cluster"><code>etcd_cluster</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>string</td>
<td>C</td>
<td>etcd cluster &amp; group name, etcd by default</td>
</tr>
<tr>
<td>503</td>
<td><a href="/docs/reference/param/#etcd_safeguard"><code>etcd_safeguard</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>prevent purging running etcd instance?</td>
</tr>
<tr>
<td>504</td>
<td><a href="/docs/reference/param/#etcd_clean"><code>etcd_clean</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>purging existing etcd during initialization?</td>
</tr>
<tr>
<td>505</td>
<td><a href="/docs/reference/param/#etcd_data"><code>etcd_data</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>path</td>
<td>C</td>
<td>etcd data directory, /data/etcd by default</td>
</tr>
<tr>
<td>506</td>
<td><a href="/docs/reference/param/#etcd_port"><code>etcd_port</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>port</td>
<td>C</td>
<td>etcd client port, 2379 by default</td>
</tr>
<tr>
<td>507</td>
<td><a href="/docs/reference/param/#etcd_peer_port"><code>etcd_peer_port</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>port</td>
<td>C</td>
<td>etcd peer port, 2380 by default</td>
</tr>
<tr>
<td>508</td>
<td><a href="/docs/reference/param/#etcd_init"><code>etcd_init</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>enum</td>
<td>C</td>
<td>etcd initial cluster state, new or existing</td>
</tr>
<tr>
<td>509</td>
<td><a href="/docs/reference/param/#etcd_election_timeout"><code>etcd_election_timeout</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>int</td>
<td>C</td>
<td>etcd election timeout, 1000ms by default</td>
</tr>
<tr>
<td>510</td>
<td><a href="/docs/reference/param/#etcd_heartbeat_interval"><code>etcd_heartbeat_interval</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td><a href="/docs/reference/param/#etcd"><code>ETCD</code></a></td>
<td>int</td>
<td>C</td>
<td>etcd heartbeat interval, 100ms by default</td>
</tr>
<tr>
<td>601</td>
<td><a href="/docs/reference/param/#minio_seq"><code>minio_seq</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>int</td>
<td>I</td>
<td>minio instance identifier, REQUIRED</td>
</tr>
<tr>
<td>602</td>
<td><a href="/docs/reference/param/#minio_cluster"><code>minio_cluster</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>C</td>
<td>minio cluster name, minio by default</td>
</tr>
<tr>
<td>603</td>
<td><a href="/docs/reference/param/#minio_clean"><code>minio_clean</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>cleanup minio during init?, false by default</td>
</tr>
<tr>
<td>604</td>
<td><a href="/docs/reference/param/#minio_user"><code>minio_user</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>username</td>
<td>C</td>
<td>minio os user, <code>minio</code> by default</td>
</tr>
<tr>
<td>605</td>
<td><a href="/docs/reference/param/#minio_node"><code>minio_node</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>C</td>
<td>minio node name pattern</td>
</tr>
<tr>
<td>606</td>
<td><a href="/docs/reference/param/#minio_data"><code>minio_data</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>path</td>
<td>C</td>
<td>minio data dir(s), use {x&hellip;y} to specify multi drivers</td>
</tr>
<tr>
<td>607</td>
<td><a href="/docs/reference/param/#minio_domain"><code>minio_domain</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>G</td>
<td>minio service domain name, <code>sss.pigsty</code> by default</td>
</tr>
<tr>
<td>608</td>
<td><a href="/docs/reference/param/#minio_port"><code>minio_port</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>port</td>
<td>C</td>
<td>minio service port, 9000 by default</td>
</tr>
<tr>
<td>609</td>
<td><a href="/docs/reference/param/#minio_admin_port"><code>minio_admin_port</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>port</td>
<td>C</td>
<td>minio console port, 9001 by default</td>
</tr>
<tr>
<td>610</td>
<td><a href="/docs/reference/param/#minio_access_key"><code>minio_access_key</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>username</td>
<td>C</td>
<td>root access key, <code>minioadmin</code> by default</td>
</tr>
<tr>
<td>611</td>
<td><a href="/docs/reference/param/#minio_secret_key"><code>minio_secret_key</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>password</td>
<td>C</td>
<td>root secret key, <code>minioadmin</code> by default</td>
</tr>
<tr>
<td>612</td>
<td><a href="/docs/reference/param/#minio_extra_vars"><code>minio_extra_vars</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>C</td>
<td>extra environment variables for minio server</td>
</tr>
<tr>
<td>613</td>
<td><a href="/docs/reference/param/#minio_alias"><code>minio_alias</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>string</td>
<td>G</td>
<td>alias name for local minio deployment</td>
</tr>
<tr>
<td>614</td>
<td><a href="/docs/reference/param/#minio_buckets"><code>minio_buckets</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>bucket[]</td>
<td>C</td>
<td>list of minio bucket to be created</td>
</tr>
<tr>
<td>615</td>
<td><a href="/docs/reference/param/#minio_users"><code>minio_users</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td><a href="/docs/reference/param/#minio"><code>MINIO</code></a></td>
<td>user[]</td>
<td>C</td>
<td>list of minio user to be created</td>
</tr>
<tr>
<td>701</td>
<td><a href="/docs/reference/param/#redis_cluster"><code>redis_cluster</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>string</td>
<td>C</td>
<td>redis cluster name, required identity parameter</td>
</tr>
<tr>
<td>702</td>
<td><a href="/docs/reference/param/#redis_instances"><code>redis_instances</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>dict</td>
<td>I</td>
<td>redis instances definition on this redis node</td>
</tr>
<tr>
<td>703</td>
<td><a href="/docs/reference/param/#redis_node"><code>redis_node</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>int</td>
<td>I</td>
<td>redis node sequence number, node int id required</td>
</tr>
<tr>
<td>710</td>
<td><a href="/docs/reference/param/#redis_fs_main"><code>redis_fs_main</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>path</td>
<td>C</td>
<td>redis main data mountpoint, <code>/data</code> by default</td>
</tr>
<tr>
<td>711</td>
<td><a href="/docs/reference/param/#redis_exporter_enabled"><code>redis_exporter_enabled</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>C</td>
<td>install redis exporter on redis nodes?</td>
</tr>
<tr>
<td>712</td>
<td><a href="/docs/reference/param/#redis_exporter_port"><code>redis_exporter_port</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>port</td>
<td>C</td>
<td>redis exporter listen port, 9121 by default</td>
</tr>
<tr>
<td>713</td>
<td><a href="/docs/reference/param/#redis_exporter_options"><code>redis_exporter_options</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>string</td>
<td>C/I</td>
<td>cli args and extra options for redis exporter</td>
</tr>
<tr>
<td>720</td>
<td><a href="/docs/reference/param/#redis_safeguard"><code>redis_safeguard</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>prevent purging running redis instance?</td>
</tr>
<tr>
<td>721</td>
<td><a href="/docs/reference/param/#redis_clean"><code>redis_clean</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>purging existing redis during init?</td>
</tr>
<tr>
<td>722</td>
<td><a href="/docs/reference/param/#redis_rmdata"><code>redis_rmdata</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>remove redis data when purging redis server?</td>
</tr>
<tr>
<td>723</td>
<td><a href="/docs/reference/param/#redis_mode"><code>redis_mode</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>enum</td>
<td>C</td>
<td>redis mode: standalone,cluster,sentinel</td>
</tr>
<tr>
<td>724</td>
<td><a href="/docs/reference/param/#redis_conf"><code>redis_conf</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>string</td>
<td>C</td>
<td>redis config template path, except sentinel</td>
</tr>
<tr>
<td>725</td>
<td><a href="/docs/reference/param/#redis_bind_address"><code>redis_bind_address</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>ip</td>
<td>C</td>
<td>redis bind address, empty string will use host ip</td>
</tr>
<tr>
<td>726</td>
<td><a href="/docs/reference/param/#redis_max_memory"><code>redis_max_memory</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>size</td>
<td>C/I</td>
<td>max memory used by each redis instance</td>
</tr>
<tr>
<td>727</td>
<td><a href="/docs/reference/param/#redis_mem_policy"><code>redis_mem_policy</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>enum</td>
<td>C</td>
<td>redis memory eviction policy</td>
</tr>
<tr>
<td>728</td>
<td><a href="/docs/reference/param/#redis_password"><code>redis_password</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>password</td>
<td>C</td>
<td>redis password, empty string will disable password</td>
</tr>
<tr>
<td>729</td>
<td><a href="/docs/reference/param/#redis_rdb_save"><code>redis_rdb_save</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>string[]</td>
<td>C</td>
<td>redis rdb save directives, disable with empty list</td>
</tr>
<tr>
<td>730</td>
<td><a href="/docs/reference/param/#redis_aof_enabled"><code>redis_aof_enabled</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable redis append only file?</td>
</tr>
<tr>
<td>731</td>
<td><a href="/docs/reference/param/#redis_rename_commands"><code>redis_rename_commands</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>dict</td>
<td>C</td>
<td>rename redis dangerous commands</td>
</tr>
<tr>
<td>732</td>
<td><a href="/docs/reference/param/#redis_cluster_replicas"><code>redis_cluster_replicas</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>int</td>
<td>C</td>
<td>replica number for one master in redis cluster</td>
</tr>
<tr>
<td>733</td>
<td><a href="/docs/reference/param/#redis_sentinel_monitor"><code>redis_sentinel_monitor</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td><a href="/docs/reference/param/#redis"><code>REDIS</code></a></td>
<td>master[]</td>
<td>C</td>
<td>sentinel master list, works on sentinel cluster only</td>
</tr>
<tr>
<td>801</td>
<td><a href="/docs/reference/param/#pg_mode"><code>pg_mode</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>enum</td>
<td>C</td>
<td>pgsql cluster mode: pgsql,citus,mssql,polar,ivory,oracle,gpsql</td>
</tr>
<tr>
<td>802</td>
<td><a href="/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>string</td>
<td>C</td>
<td>pgsql cluster name, REQUIRED identity parameter</td>
</tr>
<tr>
<td>803</td>
<td><a href="/docs/reference/param/#pg_seq"><code>pg_seq</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>int</td>
<td>I</td>
<td>pgsql instance seq number, REQUIRED identity parameter</td>
</tr>
<tr>
<td>804</td>
<td><a href="/docs/reference/param/#pg_role"><code>pg_role</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>enum</td>
<td>I</td>
<td>pgsql role, REQUIRED, could be primary,replica,offline</td>
</tr>
<tr>
<td>805</td>
<td><a href="/docs/reference/param/#pg_instances"><code>pg_instances</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>dict</td>
<td>I</td>
<td>define multiple pg instances on node in <code>{port:ins_vars}</code> format</td>
</tr>
<tr>
<td>806</td>
<td><a href="/docs/reference/param/#pg_upstream"><code>pg_upstream</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>ip</td>
<td>I</td>
<td>repl upstream ip addr for standby cluster or cascade replica</td>
</tr>
<tr>
<td>807</td>
<td><a href="/docs/reference/param/#pg_shard"><code>pg_shard</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>string</td>
<td>C</td>
<td>pgsql shard name, optional identity for sharding clusters</td>
</tr>
<tr>
<td>808</td>
<td><a href="/docs/reference/param/#pg_group"><code>pg_group</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>int</td>
<td>C</td>
<td>pgsql shard index number, optional identity for sharding clusters</td>
</tr>
<tr>
<td>809</td>
<td><a href="/docs/reference/param/#gp_role"><code>gp_role</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>enum</td>
<td>C</td>
<td>greenplum role of this cluster, could be master or segment</td>
</tr>
<tr>
<td>810</td>
<td><a href="/docs/reference/param/#pg_exporters"><code>pg_exporters</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>dict</td>
<td>C</td>
<td>additional pg_exporters to monitor remote postgres instances</td>
</tr>
<tr>
<td>811</td>
<td><a href="/docs/reference/param/#pg_offline_query"><code>pg_offline_query</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_id"><code>PG_ID</code></a></td>
<td>bool</td>
<td>I</td>
<td>set to true to enable offline query on this instance</td>
</tr>
<tr>
<td>820</td>
<td><a href="/docs/reference/param/#pg_users"><code>pg_users</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>user[]</td>
<td>C</td>
<td>postgres business users</td>
</tr>
<tr>
<td>821</td>
<td><a href="/docs/reference/param/#pg_databases"><code>pg_databases</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>database[]</td>
<td>C</td>
<td>postgres business databases</td>
</tr>
<tr>
<td>822</td>
<td><a href="/docs/reference/param/#pg_services"><code>pg_services</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>service[]</td>
<td>C</td>
<td>postgres business services</td>
</tr>
<tr>
<td>823</td>
<td><a href="/docs/reference/param/#pg_hba_rules"><code>pg_hba_rules</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>hba[]</td>
<td>C</td>
<td>business hba rules for postgres</td>
</tr>
<tr>
<td>824</td>
<td><a href="/docs/reference/param/#pgb_hba_rules"><code>pgb_hba_rules</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>hba[]</td>
<td>C</td>
<td>business hba rules for pgbouncer</td>
</tr>
<tr>
<td>831</td>
<td><a href="/docs/reference/param/#pg_replication_username"><code>pg_replication_username</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>username</td>
<td>G</td>
<td>postgres replication username, <code>replicator</code> by default</td>
</tr>
<tr>
<td>832</td>
<td><a href="/docs/reference/param/#pg_replication_password"><code>pg_replication_password</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>password</td>
<td>G</td>
<td>postgres replication password, <code>DBUser.Replicator</code> by default</td>
</tr>
<tr>
<td>833</td>
<td><a href="/docs/reference/param/#pg_admin_username"><code>pg_admin_username</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>username</td>
<td>G</td>
<td>postgres admin username, <code>dbuser_dba</code> by default</td>
</tr>
<tr>
<td>834</td>
<td><a href="/docs/reference/param/#pg_admin_password"><code>pg_admin_password</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>password</td>
<td>G</td>
<td>postgres admin password in plain text, <code>DBUser.DBA</code> by default</td>
</tr>
<tr>
<td>835</td>
<td><a href="/docs/reference/param/#pg_monitor_username"><code>pg_monitor_username</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>username</td>
<td>G</td>
<td>postgres monitor username, <code>dbuser_monitor</code> by default</td>
</tr>
<tr>
<td>836</td>
<td><a href="/docs/reference/param/#pg_monitor_password"><code>pg_monitor_password</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>password</td>
<td>G</td>
<td>postgres monitor password, <code>DBUser.Monitor</code> by default</td>
</tr>
<tr>
<td>837</td>
<td><a href="/docs/reference/param/#pg_dbsu_password"><code>pg_dbsu_password</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_business"><code>PG_BUSINESS</code></a></td>
<td>password</td>
<td>G/C</td>
<td>postgres dbsu password, empty string disable it by default</td>
</tr>
<tr>
<td>840</td>
<td><a href="/docs/reference/param/#pg_dbsu"><code>pg_dbsu</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>username</td>
<td>C</td>
<td>os dbsu name, postgres by default, better not change it</td>
</tr>
<tr>
<td>841</td>
<td><a href="/docs/reference/param/#pg_dbsu_uid"><code>pg_dbsu_uid</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>int</td>
<td>C</td>
<td>os dbsu uid and gid, 26 for default postgres users and groups</td>
</tr>
<tr>
<td>842</td>
<td><a href="/docs/reference/param/#pg_dbsu_sudo"><code>pg_dbsu_sudo</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>enum</td>
<td>C</td>
<td>dbsu sudo privilege, none,limit,all,nopass. limit by default</td>
</tr>
<tr>
<td>843</td>
<td><a href="/docs/reference/param/#pg_dbsu_home"><code>pg_dbsu_home</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>path</td>
<td>C</td>
<td>postgresql home directory, <code>/var/lib/pgsql</code> by default</td>
</tr>
<tr>
<td>844</td>
<td><a href="/docs/reference/param/#pg_dbsu_ssh_exchange"><code>pg_dbsu_ssh_exchange</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>bool</td>
<td>C</td>
<td>exchange postgres dbsu ssh key among same pgsql cluster</td>
</tr>
<tr>
<td>845</td>
<td><a href="/docs/reference/param/#pg_version"><code>pg_version</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>enum</td>
<td>C</td>
<td>postgres major version to be installed, 16 by default</td>
</tr>
<tr>
<td>846</td>
<td><a href="/docs/reference/param/#pg_bin_dir"><code>pg_bin_dir</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres binary dir, <code>/usr/pgsql/bin</code> by default</td>
</tr>
<tr>
<td>847</td>
<td><a href="/docs/reference/param/#pg_log_dir"><code>pg_log_dir</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres log dir, <code>/pg/log/postgres</code> by default</td>
</tr>
<tr>
<td>848</td>
<td><a href="/docs/reference/param/#pg_packages"><code>pg_packages</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>string[]</td>
<td>C</td>
<td>pg packages to be installed, <code>${pg_version}</code> will be replaced</td>
</tr>
<tr>
<td>849</td>
<td><a href="/docs/reference/param/#pg_extensions"><code>pg_extensions</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_install"><code>PG_INSTALL</code></a></td>
<td>string[]</td>
<td>C</td>
<td>pg extensions to be installed, <code>${pg_version}</code> will be replaced</td>
</tr>
<tr>
<td>850</td>
<td><a href="/docs/reference/param/#pg_safeguard"><code>pg_safeguard</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>prevent purging running postgres instance? false by default</td>
</tr>
<tr>
<td>851</td>
<td><a href="/docs/reference/param/#pg_clean"><code>pg_clean</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>G/C/A</td>
<td>purging existing postgres during pgsql init? true by default</td>
</tr>
<tr>
<td>852</td>
<td><a href="/docs/reference/param/#pg_data"><code>pg_data</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres data directory, <code>/pg/data</code> by default</td>
</tr>
<tr>
<td>853</td>
<td><a href="/docs/reference/param/#pg_fs_main"><code>pg_fs_main</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>mountpoint/path for postgres main data, <code>/data</code> by default</td>
</tr>
<tr>
<td>854</td>
<td><a href="/docs/reference/param/#pg_fs_bkup"><code>pg_fs_bkup</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>mountpoint/path for pg backup data, <code>/data/backup</code> by default</td>
</tr>
<tr>
<td>855</td>
<td><a href="/docs/reference/param/#pg_storage_type"><code>pg_storage_type</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>storage type for pg main data, SSD,HDD, SSD by default</td>
</tr>
<tr>
<td>856</td>
<td><a href="/docs/reference/param/#pg_dummy_filesize"><code>pg_dummy_filesize</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>size</td>
<td>C</td>
<td>size of <code>/pg/dummy</code>, hold 64MB disk space for emergency use</td>
</tr>
<tr>
<td>857</td>
<td><a href="/docs/reference/param/#pg_listen"><code>pg_listen</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>ip(s)</td>
<td>C/I</td>
<td>postgres/pgbouncer listen addresses, comma separated list</td>
</tr>
<tr>
<td>858</td>
<td><a href="/docs/reference/param/#pg_port"><code>pg_port</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>port</td>
<td>C</td>
<td>postgres listen port, 5432 by default</td>
</tr>
<tr>
<td>859</td>
<td><a href="/docs/reference/param/#pg_localhost"><code>pg_localhost</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>postgres unix socket dir for localhost connection</td>
</tr>
<tr>
<td>860</td>
<td><a href="/docs/reference/param/#pg_namespace"><code>pg_namespace</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>top level key namespace in etcd, used by patroni &amp; vip</td>
</tr>
<tr>
<td>861</td>
<td><a href="/docs/reference/param/#patroni_enabled"><code>patroni_enabled</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>C</td>
<td>if disabled, no postgres cluster will be created during init</td>
</tr>
<tr>
<td>862</td>
<td><a href="/docs/reference/param/#patroni_mode"><code>patroni_mode</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>patroni working mode: default,pause,remove</td>
</tr>
<tr>
<td>863</td>
<td><a href="/docs/reference/param/#patroni_port"><code>patroni_port</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>port</td>
<td>C</td>
<td>patroni listen port, 8008 by default</td>
</tr>
<tr>
<td>864</td>
<td><a href="/docs/reference/param/#patroni_log_dir"><code>patroni_log_dir</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>patroni log dir, <code>/pg/log/patroni</code> by default</td>
</tr>
<tr>
<td>865</td>
<td><a href="/docs/reference/param/#patroni_ssl_enabled"><code>patroni_ssl_enabled</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>G</td>
<td>secure patroni RestAPI communications with SSL?</td>
</tr>
<tr>
<td>866</td>
<td><a href="/docs/reference/param/#patroni_watchdog_mode"><code>patroni_watchdog_mode</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>patroni watchdog mode: automatic,required,off. off by default</td>
</tr>
<tr>
<td>867</td>
<td><a href="/docs/reference/param/#patroni_username"><code>patroni_username</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>username</td>
<td>C</td>
<td>patroni restapi username, <code>postgres</code> by default</td>
</tr>
<tr>
<td>868</td>
<td><a href="/docs/reference/param/#patroni_password"><code>patroni_password</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>password</td>
<td>C</td>
<td>patroni restapi password, <code>Patroni.API</code> by default</td>
</tr>
<tr>
<td>869</td>
<td><a href="/docs/reference/param/#pg_primary_db"><code>pg_primary_db</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>string</td>
<td>C</td>
<td>primary database name, used by citus,etc&hellip; ,postgres by default</td>
</tr>
<tr>
<td>870</td>
<td><a href="/docs/reference/param/#pg_parameters"><code>pg_parameters</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>dict</td>
<td>C</td>
<td>extra parameters in postgresql.auto.conf</td>
</tr>
<tr>
<td>871</td>
<td><a href="/docs/reference/param/#pg_files"><code>pg_files</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path[]</td>
<td>C</td>
<td>extra files to be copied to postgres data directory (e.g. license)</td>
</tr>
<tr>
<td>872</td>
<td><a href="/docs/reference/param/#pg_conf"><code>pg_conf</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>config template: oltp,olap,crit,tiny. <code>oltp.yml</code> by default</td>
</tr>
<tr>
<td>873</td>
<td><a href="/docs/reference/param/#pg_max_conn"><code>pg_max_conn</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>int</td>
<td>C</td>
<td>postgres max connections, <code>auto</code> will use recommended value</td>
</tr>
<tr>
<td>874</td>
<td><a href="/docs/reference/param/#pg_shared_buffer_ratio"><code>pg_shared_buffer_ratio</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>float</td>
<td>C</td>
<td>postgres shared buffer memory ratio, 0.25 by default, 0.1~0.4</td>
</tr>
<tr>
<td>875</td>
<td><a href="/docs/reference/param/#pg_rto"><code>pg_rto</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>int</td>
<td>C</td>
<td>recovery time objective in seconds,  <code>30s</code> by default</td>
</tr>
<tr>
<td>876</td>
<td><a href="/docs/reference/param/#pg_rpo"><code>pg_rpo</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>int</td>
<td>C</td>
<td>recovery point objective in bytes, <code>1MiB</code> at most by default</td>
</tr>
<tr>
<td>877</td>
<td><a href="/docs/reference/param/#pg_libs"><code>pg_libs</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>string</td>
<td>C</td>
<td>preloaded libraries, <code>timescaledb,pg_stat_statements,auto_explain</code> by default</td>
</tr>
<tr>
<td>878</td>
<td><a href="/docs/reference/param/#pg_delay"><code>pg_delay</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>interval</td>
<td>I</td>
<td>replication apply delay for standby cluster leader</td>
</tr>
<tr>
<td>879</td>
<td><a href="/docs/reference/param/#pg_checksum"><code>pg_checksum</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable data checksum for postgres cluster?</td>
</tr>
<tr>
<td>880</td>
<td><a href="/docs/reference/param/#pg_pwd_enc"><code>pg_pwd_enc</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>passwords encryption algorithm: md5,scram-sha-256</td>
</tr>
<tr>
<td>881</td>
<td><a href="/docs/reference/param/#pg_encoding"><code>pg_encoding</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>database cluster encoding, <code>UTF8</code> by default</td>
</tr>
<tr>
<td>882</td>
<td><a href="/docs/reference/param/#pg_locale"><code>pg_locale</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>database cluster local, <code>C</code> by default</td>
</tr>
<tr>
<td>883</td>
<td><a href="/docs/reference/param/#pg_lc_collate"><code>pg_lc_collate</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>database cluster collate, <code>C</code> by default</td>
</tr>
<tr>
<td>884</td>
<td><a href="/docs/reference/param/#pg_lc_ctype"><code>pg_lc_ctype</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>database character type, <code>en_US.UTF8</code> by default</td>
</tr>
<tr>
<td>890</td>
<td><a href="/docs/reference/param/#pgbouncer_enabled"><code>pgbouncer_enabled</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>C</td>
<td>if disabled, pgbouncer will not be launched on pgsql host</td>
</tr>
<tr>
<td>891</td>
<td><a href="/docs/reference/param/#pgbouncer_port"><code>pgbouncer_port</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>port</td>
<td>C</td>
<td>pgbouncer listen port, 6432 by default</td>
</tr>
<tr>
<td>892</td>
<td><a href="/docs/reference/param/#pgbouncer_log_dir"><code>pgbouncer_log_dir</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>path</td>
<td>C</td>
<td>pgbouncer log dir, <code>/pg/log/pgbouncer</code> by default</td>
</tr>
<tr>
<td>893</td>
<td><a href="/docs/reference/param/#pgbouncer_auth_query"><code>pgbouncer_auth_query</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>bool</td>
<td>C</td>
<td>query postgres to retrieve unlisted business users?</td>
</tr>
<tr>
<td>894</td>
<td><a href="/docs/reference/param/#pgbouncer_poolmode"><code>pgbouncer_poolmode</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>pooling mode: transaction,session,statement, transaction by default</td>
</tr>
<tr>
<td>895</td>
<td><a href="/docs/reference/param/#pgbouncer_sslmode"><code>pgbouncer_sslmode</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_bootstrap"><code>PG_BOOTSTRAP</code></a></td>
<td>enum</td>
<td>C</td>
<td>pgbouncer client ssl mode, disable by default</td>
</tr>
<tr>
<td>900</td>
<td><a href="/docs/reference/param/#pg_provision"><code>pg_provision</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>bool</td>
<td>C</td>
<td>provision postgres cluster after bootstrap</td>
</tr>
<tr>
<td>901</td>
<td><a href="/docs/reference/param/#pg_init"><code>pg_init</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>string</td>
<td>G/C</td>
<td>provision init script for cluster template, <code>pg-init</code> by default</td>
</tr>
<tr>
<td>902</td>
<td><a href="/docs/reference/param/#pg_default_roles"><code>pg_default_roles</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>role[]</td>
<td>G/C</td>
<td>default roles and users in postgres cluster</td>
</tr>
<tr>
<td>903</td>
<td><a href="/docs/reference/param/#pg_default_privileges"><code>pg_default_privileges</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>string[]</td>
<td>G/C</td>
<td>default privileges when created by admin user</td>
</tr>
<tr>
<td>904</td>
<td><a href="/docs/reference/param/#pg_default_schemas"><code>pg_default_schemas</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>string[]</td>
<td>G/C</td>
<td>default schemas to be created</td>
</tr>
<tr>
<td>905</td>
<td><a href="/docs/reference/param/#pg_default_extensions"><code>pg_default_extensions</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>extension[]</td>
<td>G/C</td>
<td>default extensions to be created</td>
</tr>
<tr>
<td>906</td>
<td><a href="/docs/reference/param/#pg_reload"><code>pg_reload</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>bool</td>
<td>A</td>
<td>reload postgres after hba changes</td>
</tr>
<tr>
<td>907</td>
<td><a href="/docs/reference/param/#pg_default_hba_rules"><code>pg_default_hba_rules</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>hba[]</td>
<td>G/C</td>
<td>postgres default host-based authentication rules</td>
</tr>
<tr>
<td>908</td>
<td><a href="/docs/reference/param/#pgb_default_hba_rules"><code>pgb_default_hba_rules</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></td>
<td>hba[]</td>
<td>G/C</td>
<td>pgbouncer default host-based authentication rules</td>
</tr>
<tr>
<td>910</td>
<td><a href="/docs/reference/param/#pgbackrest_enabled"><code>pgbackrest_enabled</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable pgbackrest on pgsql host?</td>
</tr>
<tr>
<td>911</td>
<td><a href="/docs/reference/param/#pgbackrest_clean"><code>pgbackrest_clean</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>bool</td>
<td>C</td>
<td>remove pg backup data during init?</td>
</tr>
<tr>
<td>912</td>
<td><a href="/docs/reference/param/#pgbackrest_log_dir"><code>pgbackrest_log_dir</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>path</td>
<td>C</td>
<td>pgbackrest log dir, <code>/pg/log/pgbackrest</code> by default</td>
</tr>
<tr>
<td>913</td>
<td><a href="/docs/reference/param/#pgbackrest_method"><code>pgbackrest_method</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>enum</td>
<td>C</td>
<td>pgbackrest repo method: local,minio,etc&hellip;</td>
</tr>
<tr>
<td>914</td>
<td><a href="/docs/reference/param/#pgbackrest_repo"><code>pgbackrest_repo</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_backup"><code>PG_BACKUP</code></a></td>
<td>dict</td>
<td>G/C</td>
<td>pgbackrest repo: <a href="https://pgbackrest.org/configuration.html#section-repository">https://pgbackrest.org/configuration.html#section-repository</a></td>
</tr>
<tr>
<td>921</td>
<td><a href="/docs/reference/param/#pg_weight"><code>pg_weight</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>int</td>
<td>I</td>
<td>relative load balance weight in service, 100 by default, 0-255</td>
</tr>
<tr>
<td>922</td>
<td><a href="/docs/reference/param/#pg_service_provider"><code>pg_service_provider</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>string</td>
<td>G/C</td>
<td>dedicate haproxy node group name, or empty string for local nodes by default</td>
</tr>
<tr>
<td>923</td>
<td><a href="/docs/reference/param/#pg_default_service_dest"><code>pg_default_service_dest</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>enum</td>
<td>G/C</td>
<td>default service destination if svc.dest=&lsquo;default&rsquo;</td>
</tr>
<tr>
<td>924</td>
<td><a href="/docs/reference/param/#pg_default_services"><code>pg_default_services</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>service[]</td>
<td>G/C</td>
<td>postgres default service definitions</td>
</tr>
<tr>
<td>931</td>
<td><a href="/docs/reference/param/#pg_vip_enabled"><code>pg_vip_enabled</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable a l2 vip for pgsql primary? false by default</td>
</tr>
<tr>
<td>932</td>
<td><a href="/docs/reference/param/#pg_vip_address"><code>pg_vip_address</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>cidr4</td>
<td>C</td>
<td>vip address in <code>&lt;ipv4&gt;/&lt;mask&gt;</code> format, require if vip is enabled</td>
</tr>
<tr>
<td>933</td>
<td><a href="/docs/reference/param/#pg_vip_interface"><code>pg_vip_interface</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>string</td>
<td>C/I</td>
<td>vip network interface to listen, eth0 by default</td>
</tr>
<tr>
<td>934</td>
<td><a href="/docs/reference/param/#pg_dns_suffix"><code>pg_dns_suffix</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>string</td>
<td>C</td>
<td>pgsql dns suffix, &rsquo;&rsquo; by default</td>
</tr>
<tr>
<td>935</td>
<td><a href="/docs/reference/param/#pg_dns_target"><code>pg_dns_target</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_service"><code>PG_SERVICE</code></a></td>
<td>enum</td>
<td>C</td>
<td>auto, primary, vip, none, or ad hoc ip</td>
</tr>
<tr>
<td>940</td>
<td><a href="/docs/reference/param/#pg_exporter_enabled"><code>pg_exporter_enabled</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable pg_exporter on pgsql hosts?</td>
</tr>
<tr>
<td>941</td>
<td><a href="/docs/reference/param/#pg_exporter_config"><code>pg_exporter_config</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>pg_exporter configuration file name</td>
</tr>
<tr>
<td>942</td>
<td><a href="/docs/reference/param/#pg_exporter_cache_ttls"><code>pg_exporter_cache_ttls</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>pg_exporter collector ttl stage in seconds, &lsquo;1,10,60,300&rsquo; by default</td>
</tr>
<tr>
<td>943</td>
<td><a href="/docs/reference/param/#pg_exporter_port"><code>pg_exporter_port</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>port</td>
<td>C</td>
<td>pg_exporter listen port, 9630 by default</td>
</tr>
<tr>
<td>944</td>
<td><a href="/docs/reference/param/#pg_exporter_params"><code>pg_exporter_params</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>extra url parameters for pg_exporter dsn</td>
</tr>
<tr>
<td>945</td>
<td><a href="/docs/reference/param/#pg_exporter_url"><code>pg_exporter_url</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>pgurl</td>
<td>C</td>
<td>overwrite auto-generate pg dsn if specified</td>
</tr>
<tr>
<td>946</td>
<td><a href="/docs/reference/param/#pg_exporter_auto_discovery"><code>pg_exporter_auto_discovery</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable auto database discovery? enabled by default</td>
</tr>
<tr>
<td>947</td>
<td><a href="/docs/reference/param/#pg_exporter_exclude_database"><code>pg_exporter_exclude_database</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>csv of database that WILL NOT be monitored during auto-discovery</td>
</tr>
<tr>
<td>948</td>
<td><a href="/docs/reference/param/#pg_exporter_include_database"><code>pg_exporter_include_database</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>string</td>
<td>C</td>
<td>csv of database that WILL BE monitored during auto-discovery</td>
</tr>
<tr>
<td>949</td>
<td><a href="/docs/reference/param/#pg_exporter_connect_timeout"><code>pg_exporter_connect_timeout</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>int</td>
<td>C</td>
<td>pg_exporter connect timeout in ms, 200 by default</td>
</tr>
<tr>
<td>950</td>
<td><a href="/docs/reference/param/#pg_exporter_options"><code>pg_exporter_options</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>arg</td>
<td>C</td>
<td>overwrite extra options for pg_exporter</td>
</tr>
<tr>
<td>951</td>
<td><a href="/docs/reference/param/#pgbouncer_exporter_enabled"><code>pgbouncer_exporter_enabled</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>bool</td>
<td>C</td>
<td>enable pgbouncer_exporter on pgsql hosts?</td>
</tr>
<tr>
<td>952</td>
<td><a href="/docs/reference/param/#pgbouncer_exporter_port"><code>pgbouncer_exporter_port</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>port</td>
<td>C</td>
<td>pgbouncer_exporter listen port, 9631 by default</td>
</tr>
<tr>
<td>953</td>
<td><a href="/docs/reference/param/#pgbouncer_exporter_url"><code>pgbouncer_exporter_url</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>pgurl</td>
<td>C</td>
<td>overwrite auto-generate pgbouncer dsn if specified</td>
</tr>
<tr>
<td>954</td>
<td><a href="/docs/reference/param/#pgbouncer_exporter_options"><code>pgbouncer_exporter_options</code></a></td>
<td><a href="/docs/reference/param/#pgsql"><code>PGSQL</code></a></td>
<td><a href="/docs/reference/param/#pg_exporter"><code>PG_EXPORTER</code></a></td>
<td>arg</td>
<td>C</td>
<td>overwrite extra options for pgbouncer_exporter</td>
</tr>
</tbody>
</table>
<hr>
<h1 id="infra"><code>INFRA</code></h1>
<p>Parameters about pigsty infrastructure components: local yum repo, nginx, dnsmasq, prometheus, grafana, loki, alertmanager, pushgateway, blackbox_exporter, etc&hellip;</p>
<hr>
<h2 id="meta"><code>META</code></h2>
<p>This section contains some metadata of current pigsty deployments, such as version string, admin node IP address, repo mirror <a href="/docs/reference/param/#region"><code>region</code></a> and http(s) proxy when downloading pacakges.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v2.6.0                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pigsty version string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">admin_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.10</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># admin node ip address</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">region: default                   # upstream mirror region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default,china,europe</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">proxy_env</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># global proxy env when downloading packages</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">no_proxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16,*.pigsty,*.aliyun.com,mirrors.*,*.myqcloud.com,*.tsinghua.edu.cn&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># http_proxy:  # set your proxy here: e.g http://user:pass@proxy.xxx.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># https_proxy: # set your proxy here: e.g http://user:pass@proxy.xxx.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># all_proxy:   # set your proxy here: e.g http://user:pass@proxy.xxx.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="version"><code>version</code></h3>
<p>name: <code>version</code>, type: <code>string</code>, level: <code>G</code></p>
<p>pigsty version string</p>
<p>default value:<code>v2.6.0</code></p>
<p>It will be used for pigsty introspection &amp; content rendering.</p>
<h3 id="admin_ip"><code>admin_ip</code></h3>
<p>name: <code>admin_ip</code>, type: <code>ip</code>, level: <code>G</code></p>
<p>admin node ip address</p>
<p>default value:<code>10.10.10.10</code></p>
<p>Node with this ip address will be treated as admin node, usually point to the first node that install Pigsty.</p>
<p>The default value <code>10.10.10.10</code> is a placeholder which will be replaced during <a href="/docs/setup/install/#configure">configure</a></p>
<p>This parameter is referenced by many other parameters, such as:</p>
<ul>
<li><a href="/docs/reference/param/#infra_portal"><code>infra_portal</code></a></li>
<li><a href="/docs/reference/param/#repo_endpoint"><code>repo_endpoint</code></a></li>
<li><a href="/docs/reference/param/#dns_records"><code>dns_records</code></a></li>
<li><a href="/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a></li>
<li><a href="/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a></li>
<li><a href="/docs/reference/param/#node_repo_modules"><code>node_repo_modules</code></a></li>
</ul>
<p>The exact string <code>${admin_ip}</code> will be replaced with the actual <code>admin_ip</code> for above parameters.</p>
<h3 id="region"><code>region</code></h3>
<p>name: <code>region</code>, type: <code>enum</code>, level: <code>G</code></p>
<p>upstream mirror region: default,china,europe</p>
<p>default value: <code>default</code></p>
<p>If a region other than <code>default</code> is set, and there&rsquo;s a corresponding entry in <code>repo_upstream.[repo].baseurl</code>, it will be used instead of <code>default</code>.</p>
<p>For example, if <code>china</code> is used,  pigsty will use China mirrors designated in <a href="/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> if applicable.</p>
<h3 id="proxy_env"><code>proxy_env</code></h3>
<p>name: <code>proxy_env</code>, type: <code>dict</code>, level: <code>G</code></p>
<p>global proxy env when downloading packages</p>
<p>default value:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">proxy_env</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># global proxy env when downloading packages</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">http_proxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://username:password@proxy.address.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">https_proxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://username:password@proxy.address.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">all_proxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://username:password@proxy.address.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">no_proxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16,*.pigsty,*.aliyun.com,mirrors.aliyuncs.com,mirrors.tuna.tsinghua.edu.cn,mirrors.zju.edu.cn&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>It&rsquo;s quite important to use http proxy in restricted production environment, or your Internet access is blocked (e.g. Mainland China)</p>
<hr>
<h2 id="ca"><code>CA</code></h2>
<p>Self-Signed CA used by pigsty. It is required to support advanced security features.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">ca_method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">create                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># create,recreate,copy, create by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ca_cn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty-ca                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># ca common name, fixed as pigsty-ca</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">cert_validity</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">7300d             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># cert validity, 20 years by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="ca_method"><code>ca_method</code></h3>
<p>name: <code>ca_method</code>, type: <code>enum</code>, level: <code>G</code></p>
<p>available options: create,recreate,copy</p>
<p>default value: <code>create</code></p>
<ul>
<li><code>create</code>: Create a new CA public-private key pair if not exists, use if exists</li>
<li><code>recreate</code>: Always re-create a new CA public-private key pair</li>
<li><code>copy</code>: Copy the existing CA public and private keys from local <code>files/pki/ca</code>, abort if missing</li>
</ul>
<p>If you already have a pair of <code>ca.crt</code> and <code>ca.key</code>, put them under <code>files/pki/ca</code> and set <code>ca_method</code> to <code>copy</code>.</p>
<h3 id="ca_cn"><code>ca_cn</code></h3>
<p>name: <code>ca_cn</code>, type: <code>string</code>, level: <code>G</code></p>
<p>ca common name, not recommending to change it.</p>
<p>default value: <code>pigsty-ca</code></p>
<p>you can check that with  <code>openssl x509 -text -in /etc/pki/ca.crt</code></p>
<h3 id="cert_validity"><code>cert_validity</code></h3>
<p>name: <code>cert_validity</code>, type: <code>interval</code>, level: <code>G</code></p>
<p>cert validity, 20 years by default, which is enough for most scenarios</p>
<p>default value: <code>7300d</code></p>
<hr>
<h2 id="infra_id"><code>INFRA_ID</code></h2>
<p>Infrastructure identity and portal definition.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#infra_seq: 1                     # infra node identity, explicitly required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra_portal</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># infra services exposed via portal</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">home         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">h.pigsty }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">grafana      </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: g.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3000&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">prometheus   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: p.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9090&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">alertmanager </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: a.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9093&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">blackbox     </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9115&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">loki         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3100&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="infra_seq"><code>infra_seq</code></h3>
<p>name: <code>infra_seq</code>, type: <code>int</code>, level: <code>I</code></p>
<p>infra node identity, REQUIRED, no default value, you have to assign it explicitly.</p>
<h3 id="infra_portal"><code>infra_portal</code></h3>
<p>name: <code>infra_portal</code>, type: <code>dict</code>, level: <code>G</code></p>
<p>infra services exposed via portal.</p>
<p>default value will expose home, grafana, prometheus, alertmanager via nginx with corresponding domain names.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">infra_portal</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># infra services exposed via portal</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">home         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">h.pigsty }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">grafana      </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: g.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3000&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">prometheus   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: p.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9090&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">alertmanager </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: a.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9093&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">blackbox     </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9115&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">loki         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3100&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Each record consists of a key-value dictionary, with <code>name</code> as the key representing the component name,
and the value containing the <strong>REQUIRED</strong> <code>domain</code> field representing the domain name.</p>
<ul>
<li><code>domain</code> is the domain name used for external access. It will be added to the Nginx SSL cert SAN field.
<ul>
<li>The <code>name</code> of the default record is fixed and referenced by other modules, so <strong>DO NOT</strong> modify the default entry names.</li>
</ul>
</li>
<li><code>endpoint</code> is a TCP socket that can be reached internally. If specified, Nginx will forward requests to the address specified by <code>endpoint</code>.
<ul>
<li>If the <code>${admin_ip}</code> is included in the <code>endpoint</code>, it will be replaced with the actual <a href="/docs/reference/param/#admin_ip"><code>admin_ip</code></a> at runtime.</li>
</ul>
</li>
<li><code>path</code> is a path that can be accessed locally. If specified, it will be used as the root of the local web server, and Nginx will forward requests local files.
<ul>
<li><code>endpoint</code> and <code>path</code> are mutually exclusive, you can choose between being an upstream proxy or a local web server in one entry.</li>
</ul>
</li>
<li><code>websocket</code> is set to <code>true</code>, http protocol will be auto upgraded for ws connections.
<ul>
<li>When the upstream uses WebSocket, you can enable this option (e.g. Grafana/Jupyter)</li>
</ul>
</li>
<li><code>schema</code> is given (<code>http</code> or <code>https</code>), it will be used as part of the proxy_pass URL.
<ul>
<li>When upstream require https instead of http for proxy, use this option (e.g. MinIO )</li>
</ul>
</li>
</ul>
<hr>
<h2 id="repo"><code>REPO</code></h2>
<p>This section is about local software repo. Pigsty will create a local software repo (APT/YUM) when init an infra node.</p>
<p>In the initialization process, Pigsty will download all packages and their dependencies (specified by <a href="/docs/reference/param/#repo_packages"><code>repo_packages</code></a>) from the Internet upstream repo (specified by <a href="/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a>) to <a href="/docs/reference/param/#nginx_home"><code>{{ nginx_home }}</code></a> / <a href="/docs/reference/param/#repo_name"><code>{{ repo_name }}</code></a>  (default is <code>/www/pigsty</code>), and the total size of all dependent software is about 1GB or so.</p>
<p>When creating a local repo, Pigsty will skip the software download phase if the directory already exists and if there is a marker file named <code>repo_complete</code> in the dir.</p>
<p>If the download speed of some packages is too slow, you can set the download proxy to complete the first download by using the <a href="/docs/reference/param/#proxy_env"><code>proxy_env</code></a> config entry or directly download the pre-packaged <a href="/docs/setup/offline/">offline package</a>, which is essentially a local software source built on the same operating system.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">repo_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># create a yum repo on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_home</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/www                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># repo home dir, `/www` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># repo name, pigsty by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://${admin_ip}:80</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># access point to this repo by domain or ip:port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_remove</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># remove existing upstream repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">infra,node,pgsql   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># install upstream repo during repo bootstrap</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#repo_upstream: []                # where to download</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#repo_packages: []                # which packages to download</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#repo_extra_packages: []          # extra packages to download</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">repo_url_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># extra packages from url</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="repo_enabled"><code>repo_enabled</code></h3>
<p>name: <code>repo_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>create a yum repo on this infra node? default value: <code>true</code></p>
<p>If you have multiple infra nodes, you can disable yum repo on other standby nodes to reduce Internet traffic.</p>
<h3 id="repo_home"><code>repo_home</code></h3>
<p>name: <code>repo_home</code>, type: <code>path</code>, level: <code>G</code></p>
<p>repo home dir, <code>/www</code> by default</p>
<h3 id="repo_name"><code>repo_name</code></h3>
<p>name: <code>repo_name</code>, type: <code>string</code>, level: <code>G</code></p>
<p>repo name, <code>pigsty</code> by default, it is not wise to change this value</p>
<h3 id="repo_endpoint"><code>repo_endpoint</code></h3>
<p>name: <code>repo_endpoint</code>, type: <code>url</code>, level: <code>G</code></p>
<p>access point to this repo by domain or ip:port, default value: <code>http://${admin_ip}:80</code></p>
<p>If you have changed the <a href="/docs/reference/param/#nginx_port"><code>nginx_port</code></a> or <a href="/docs/reference/param/#nginx_ssl_port"><code>nginx_ssl_port</code></a>, or use a different infra node from admin node, please adjust this parameter accordingly.</p>
<p>The <code>${admin_ip}</code> will be replaced with actual <a href="/docs/reference/param/#admin_ip"><code>admin_ip</code></a> during runtime.</p>
<h3 id="repo_remove"><code>repo_remove</code></h3>
<p>name: <code>repo_remove</code>, type: <code>bool</code>, level: <code>G/A</code></p>
<p>remove existing upstream repo, default value: <code>true</code></p>
<p>If you want to keep existing upstream repo, set this value to <code>false</code>.</p>
<h3 id="repo_modules"><code>repo_modules</code></h3>
<p>name: <code>repo_modules</code>, type: <code>string</code>, level: <code>G/A</code></p>
<p>which repo modules are installed in repo_upstream, default value: <code>infra,node,pgsql</code></p>
<p>This is a comma separated value string, it is used to filter entries in <a href="/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> with corresponding <code>module</code> field.</p>
<p>For Ubuntu / Debian users, you can add redis to the list: <code>infra,node,pgsql,redis</code></p>
<h3 id="repo_upstream"><code>repo_upstream</code></h3>
<p>name: <code>repo_upstream</code>, type: <code>upstream[]</code>, level: <code>G</code></p>
<p>This param defines the upstream software repo for Pigsty. It <strong>DOES NOT</strong> have default values, you can specify it explicitly, or leaving it empty if you want to use the default values.</p>
<p>When leaving it empty, Pigsty will use the default values from the <code>repo_upstream_default</code> defined in <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> according to you OS.</p>
<p>For EL (7, 8, 9 ) system, the default values are:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-local   ,description: &#39;Pigsty Local&#39;      ,module: local   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://${admin_ip}/pigsty&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># used by intranet nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-infra   ,description: &#39;Pigsty INFRA&#39;      ,module: infra   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.pigsty.io/yum/infra/$basearch&#39; ,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/yum/infra/$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-pgsql   ,description: &#39;Pigsty PGSQL&#39;      ,module: pgsql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.pigsty.io/yum/pgsql/el$releasever.$basearch&#39; ,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/yum/pgsql/el$releasever.$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: nginx          ,description: &#39;Nginx Repo&#39;        ,module: infra   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://nginx.org/packages/rhel/$releasever/$basearch/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: baseos         ,description: &#39;EL 8+ BaseOS&#39;      ,module: node    ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/BaseOS/$basearch/os/&#39;     ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/BaseOS/$basearch/os/&#39;          ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/BaseOS/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: appstream      ,description: &#39;EL 8+ AppStream&#39;   ,module: node    ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/AppStream/$basearch/os/&#39;  ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/AppStream/$basearch/os/&#39;       ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/AppStream/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: extras         ,description: &#39;EL 8+ Extras&#39;      ,module: node    ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/extras/$basearch/os/&#39;     ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/extras/$basearch/os/&#39;          ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/extras/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: powertools     ,description: &#39;EL 8 PowerTools&#39;   ,module: node    ,releases: [  8  ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/PowerTools/$basearch/os/&#39; ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/PowerTools/$basearch/os/&#39;      ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/PowerTools/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: crb            ,description: &#39;EL 9 CRB&#39;          ,module: node    ,releases: [    9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://dl.rockylinux.org/pub/rocky/$releasever/CRB/$basearch/os/&#39;        ,china: &#39;https://mirrors.aliyun.com/rockylinux/$releasever/CRB/$basearch/os/&#39;             ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/rocky/$releasever/CRB/$basearch/os/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">        </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: epel           ,description: &#39;EL 8+ EPEL&#39;        ,module: node    ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;http://download.fedoraproject.org/pub/epel/$releasever/Everything/$basearch/&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/epel/$releasever/Everything/$basearch/&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/epel/$releasever/Everything/$basearch/&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg-common    ,description: &#39;PostgreSQL Common&#39; ,module: pgsql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/common/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/common/redhat/rhel-$releasever-$basearch&#39; , europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/common/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg-extras    ,description: &#39;PostgreSQL Extra&#39;  ,module: pgsql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/common/pgdg-rhel$releasever-extras/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/common/pgdg-rhel$releasever-extras/redhat/rhel-$releasever-$basearch&#39; , europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/common/pgdg-rhel$releasever-extras/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg-el8fix    ,description: &#39;PostgreSQL EL8FIX&#39; ,module: pgsql   ,releases: [  8  ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/common/pgdg-centos8-sysupdates/redhat/rhel-8-x86_64/&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/common/pgdg-centos8-sysupdates/redhat/rhel-8-x86_64/&#39; , europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/common/pgdg-centos8-sysupdates/redhat/rhel-8-x86_64/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg-el9fix    ,description: &#39;PostgreSQL EL9FIX&#39; ,module: pgsql   ,releases: [    9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/common/pgdg-rocky9-sysupdates/redhat/rhel-9-x86_64/&#39;  ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/common/pgdg-rocky9-sysupdates/redhat/rhel-9-x86_64/&#39; , europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/common/pgdg-rocky9-sysupdates/redhat/rhel-9-x86_64/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg17         ,description: &#39;PostgreSQL 17&#39;     ,module: pgsql   ,releases: [  8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/17/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/17/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/17/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg17-nonfree ,description: &#39;PostgreSQL 17+&#39;    ,module: pgsql   ,releases: [  8,9] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: timescaledb    ,description: &#39;TimescaleDB&#39;       ,module: pgsql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://packagecloud.io/timescale/timescaledb/el/$releasever/$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># these repos are not used by default, but can be enabled by setting repo_modules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg12         ,description: &#39;PostgreSQL 12&#39;     ,module: pg12    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/12/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/12/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/12/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg12-nonfree ,description: &#39;PostgreSQL 12+&#39;    ,module: pg12    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/12/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/12/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/12/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg13         ,description: &#39;PostgreSQL 13&#39;     ,module: pg13    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/13/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/13/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/13/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg13-nonfree ,description: &#39;PostgreSQL 13+&#39;    ,module: pg13    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/13/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/13/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/13/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg14         ,description: &#39;PostgreSQL 14&#39;     ,module: pg14    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/14/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/14/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/14/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg14-nonfree ,description: &#39;PostgreSQL 14+&#39;    ,module: pg14    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/14/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/14/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/14/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg15         ,description: &#39;PostgreSQL 15&#39;     ,module: pg15    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/15/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/15/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/15/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg15-nonfree ,description: &#39;PostgreSQL 15+&#39;    ,module: pg15    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/15/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/15/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/15/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg16         ,description: &#39;PostgreSQL 16&#39;     ,module: pg16    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/16/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/16/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/16/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg16-nonfree ,description: &#39;PostgreSQL 16+&#39;    ,module: pg16    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/16/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/16/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/16/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg17         ,description: &#39;PostgreSQL 17&#39;     ,module: pg17    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/17/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/17/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/17/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg17-nonfree ,description: &#39;PostgreSQL 17+&#39;    ,module: pg17    ,releases: [7,8,9] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.postgresql.org/pub/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39; ,china: &#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39; ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/postgresql/repos/yum/non-free/17/redhat/rhel-$releasever-$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: docker-ce      ,description: &#39;Docker CE&#39;         ,module: docker  ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.docker.com/linux/centos/$releasever/$basearch/stable&#39;    ,china: &#39;https://mirrors.aliyun.com/docker-ce/linux/centos/$releasever/$basearch/stable&#39;  ,europe</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.xtom.de/docker-ce/linux/centos/$releasever/$basearch/stable&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: kubernetes     ,description: &#39;Kubernetes&#39;        ,module: kube    ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://pkgs.k8s.io/core:/stable:/v1.31/rpm/&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/kubernetes-new/core/stable/v1.31/rpm/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: wiltondb       ,description: &#39;WiltonDB&#39;          ,module: mssql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://download.copr.fedorainfracloud.org/results/wiltondb/wiltondb/epel-$releasever-$basearch/&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/yum/mssql/el$releasever.$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: ivorysql       ,description: &#39;IvorySQL&#39;          ,module: ivory   ,releases: [7,8,9] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.pigsty.io/yum/ivory/el$releasever.$basearch&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/yum/ivory/el$releasever.$basearch&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: mysql          ,description: &#39;MySQL&#39;             ,module: mysql   ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.mysql.com/yum/mysql-8.0-community/el/$releasever/$basearch/&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/mysql/yum/mysql-8.0-community-el7-$basearch/&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: grafana        ,description: &#39;Grafana&#39;           ,module: grafana ,releases: [7,8,9] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://rpm.grafana.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For Debian (11,12) or Ubuntu (22.04, 22.04) systems, the default values are:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-local  ,description: &#39;Pigsty Local&#39;     ,module: local     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://${admin_ip}/pigsty ./&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-pgsql  ,description: &#39;Pigsty PgSQL&#39;     ,module: pgsql     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.io/apt/pgsql/${distro_codename} ${distro_codename} main&#39;</span><span style="color:#204a87;font-weight:bold">, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/apt/pgsql/${distro_codename} ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pigsty-infra  ,description: &#39;Pigsty Infra&#39;     ,module: infra     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://repo.pigsty.io/apt/infra/ generic main&#39; ,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/apt/infra/ generic main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: nginx         ,description: &#39;Nginx&#39;            ,module: infra     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://nginx.org/packages/${distro_name} ${distro_codename} nginx&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: base          ,description: &#39;Debian Basic&#39;     ,module: node      ,releases: [11,12         ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://deb.debian.org/debian/ ${distro_codename} main non-free-firmware&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/debian/ ${distro_codename} main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: updates       ,description: &#39;Debian Updates&#39;   ,module: node      ,releases: [11,12         ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://deb.debian.org/debian/ ${distro_codename}-updates main non-free-firmware&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/debian/ ${distro_codename}-updates main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: security      ,description: &#39;Debian Security&#39;  ,module: node      ,releases: [11,12         ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://security.debian.org/debian-security ${distro_codename}-security main non-free-firmware&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: base          ,description: &#39;Ubuntu Basic&#39;     ,module: node      ,releases: [      20,22,24] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.edge.kernel.org/ubuntu/ ${distro_codename}           main universe multiverse restricted&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu/ ${distro_codename}           main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: updates       ,description: &#39;Ubuntu Updates&#39;   ,module: node      ,releases: [      20,22,24] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.edge.kernel.org/ubuntu/ ${distro_codename}-backports main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu/ ${distro_codename}-updates   main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: backports     ,description: &#39;Ubuntu Backports&#39; ,module: node      ,releases: [      20,22,24] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.edge.kernel.org/ubuntu/ ${distro_codename}-security  main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu/ ${distro_codename}-backports main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: security      ,description: &#39;Ubuntu Security&#39;  ,module: node      ,releases: [      20,22,24] ,arch: [x86_64         ] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.edge.kernel.org/ubuntu/ ${distro_codename}-updates   main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu/ ${distro_codename}-security  main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: base          ,description: &#39;Ubuntu Basic&#39;     ,module: node      ,releases: [      20,22,24] ,arch: [        aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://ports.ubuntu.com/ubuntu-ports/ ${distro_codename}           main universe multiverse restricted&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu-ports/ ${distro_codename}           main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: updates       ,description: &#39;Ubuntu Updates&#39;   ,module: node      ,releases: [      20,22,24] ,arch: [        aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://ports.ubuntu.com/ubuntu-ports/ ${distro_codename}-backports main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu-ports/ ${distro_codename}-updates   main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: backports     ,description: &#39;Ubuntu Backports&#39; ,module: node      ,releases: [      20,22,24] ,arch: [        aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://ports.ubuntu.com/ubuntu-ports/ ${distro_codename}-security  main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu-ports/ ${distro_codename}-backports main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: security      ,description: &#39;Ubuntu Security&#39;  ,module: node      ,releases: [      20,22,24] ,arch: [        aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://ports.ubuntu.com/ubuntu-ports/ ${distro_codename}-updates   main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/ubuntu-ports/ ${distro_codename}-security  main restricted universe multiverse&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgdg          ,description: &#39;PGDG&#39;             ,module: pgsql     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;http://apt.postgresql.org/pub/repos/apt/ ${distro_codename}-pgdg main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/postgresql/repos/apt/ ${distro_codename}-pgdg main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: citus         ,description: &#39;Citus&#39;            ,module: pgsql     ,releases: [11,12,20,22   ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://packagecloud.io/citusdata/community/${distro_name}/ ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: timescaledb   ,description: &#39;Timescaledb&#39;      ,module: pgsql     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://packagecloud.io/timescale/timescaledb/${distro_name}/ ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># these repos are not used by default, but can be enabled by setting repo_modules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: grafana      ,description: &#39;Grafana&#39;           ,module: grafana   ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://apt.grafana.com stable main&#39; ,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/grafana/apt/ stable main&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgml         ,description: &#39;PostgresML&#39;        ,module: pgml      ,releases: [         22   ] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://apt.postgresml.org ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: wiltondb     ,description: &#39;WiltonDB&#39;          ,module: mssql     ,releases: [      20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://ppa.launchpadcontent.net/wiltondb/wiltondb/ubuntu/ ${distro_codename} main&#39;</span><span style="color:#204a87;font-weight:bold">, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.pigsty.cc/apt/mssql/ ${distro_codename} main&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: mysql        ,description: &#39;MySQL&#39;             ,module: mysql     ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://repo.mysql.com/apt/${distro_name} ${distro_codename} mysql-8.0 mysql-tools&#39;</span><span style="color:#204a87;font-weight:bold">, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/mysql/apt/${distro_name} ${distro_codename} mysql-8.0 mysql-tools&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: docker-ce    ,description: &#39;Docker&#39;            ,module: docker    ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://download.docker.com/linux/${distro_name} ${distro_codename} stable&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux//${distro_name} ${distro_codename} stable&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: kubernetes   ,description: &#39;Kubernetes&#39;        ,module: kube      ,releases: [11,12,20,22,24] ,arch: [x86_64, aarch64] ,baseurl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">default: &#39;https://pkgs.k8s.io/core:/stable:/v1.31/deb/ /&#39;, china</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;https://mirrors.aliyun.com/kubernetes-new/core/stable/v1.31/deb/ /&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Pigsty Building template <a href="https://github.com/Vonng/pigsty/blob/main/conf/build/oss.yml"><code>oss.yml</code></a> has default values for different OS distros.</p>
<h3 id="repo_packages"><code>repo_packages</code></h3>
<p>name: <code>repo_packages</code>, type: <code>string[]</code>, level: <code>G</code></p>
<p>This param is an array os strings, each string is a list of software packages separated by space, specifying which packages to be included &amp; downloaded.</p>
<p>This param <strong>DOES NOT</strong> have a default value, you can specify it explicitly, or leaving it empty if you want to use the default values.</p>
<p>When leaving it empty, Pigsty will use the default values from the <code>repo_packages_default</code> defined in <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> according to you OS.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node-bootstrap, infra-package, infra-addons, node-package1, node-package2, pgsql-utility ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Each element in <code>repo_packages</code> will be translated into a list of package names according to the <code>package_map</code> defined in the above file, for specific OS distro version.</p>
<p>For example, on EL systems, it will be translated into:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node-bootstrap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#4e9a06">&#34;ansible python3 python3-pip python3-virtualenv python3-requests python3-jmespath python3-cryptography dnf-utils modulemd-tools createrepo_c sshpass&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra-package</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;nginx dnsmasq etcd haproxy vip-manager pg_exporter pgbackrest_exporter redis_exporter redis minio mcli ferretdb duckdb&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra-addons</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#4e9a06">&#34;grafana loki logcli promtail prometheus2 alertmanager pushgateway node_exporter blackbox_exporter nginx_exporter keepalived_exporter&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node-package1</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;lz4 unzip bzip2 zlib yum pv jq git ncdu make patch bash lsof wget uuid tuned nvme-cli numactl grubby sysstat iotop htop rsync tcpdump perf flamegraph chkconfig&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node-package2</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;netcat socat ftp lrzsz net-tools ipvsadm bind-utils telnet audit ca-certificates readline vim-minimal keepalived chrony openssl openssh-server openssh-clients&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgsql-utility</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;patroni patroni-etcd pgbouncer pgbackrest pgbadger pg_activity pg_timetable pgFormatter pg_filedump pgxnclient timescaledb-tools pgcopydb pgloader&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>And on Debian/Ubuntu systems, it will be translated into:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node-bootstrap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#4e9a06">&#34;ansible python3 python3-pip python3-venv python3-jmespath dpkg-dev sshpass ftp linux-tools-generic&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra-package</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;nginx dnsmasq etcd haproxy vip-manager pg-exporter pgbackrest-exporter redis-exporter redis minio mcli ferretdb duckdb&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">infra-addons</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#4e9a06">&#34;grafana loki logcli promtail prometheus2 alertmanager pushgateway node-exporter blackbox-exporter nginx-exporter keepalived-exporter&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node-package1</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;lz4 unzip bzip2 zlib1g pv jq git ncdu make patch bash lsof wget uuid tuned nvme-cli numactl sysstat iotop htop rsync tcpdump acl chrony&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node-package2</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;netcat-openbsd socat lrzsz net-tools ipvsadm dnsutils telnet ca-certificates libreadline-dev vim-tiny keepalived openssl openssh-server openssh-client&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgsql-utility</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#4e9a06">&#34;patroni pgbouncer pgbackrest pgbadger pg-activity pg-timetable pgformatter postgresql-filedump pgxnclient timescaledb-tools pgcopydb pgloader&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>As a convention, <code>repo_packages</code> usually includes software packages that are not related to the major version of PostgreSQL (such as Infra, Node, and PGDG Common),
while software packages related to the major version of PostgreSQL (kernel, extensions) are usually specified in <code>repo_extra_packages</code> to facilitate switching between PG major versions.</p>
<h3 id="repo_extra_packages"><code>repo_extra_packages</code></h3>
<p>name: <code>repo_extra_packages</code>, type: <code>string[]</code>, level: <code>G/C/I</code></p>
<p>This parameter is same as <a href="/docs/reference/param/#repo_packages"><code>repo_packages</code></a>, but it is used for the additional software packages that need to be downloaded. (Usually PG version ad hoc packages)</p>
<p>The default value is an empty list. You can override it at the cluster &amp; instance level to specify additional software packages that need to be downloaded.</p>
<p>If this parameter is not explicitly defined, Pigsty will load the default value from the <code>repo_extra_packages_default</code> defined in <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a>, which is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql-main ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Each element in <code>repo_packages</code> will be translated into a list of package names according to the <code>package_map</code> defined in the above file, for specific OS distro version.</p>
<p>For example, on EL systems, it will be translated into:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">postgresql$v* pg_repack_$v* wal2json_$v* pgvector_$v*</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>And on Debian/Ubuntu systems, it will be translated into:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">postgresql-$v postgresql-client-$v postgresql-plpython3-$v postgresql-plperl-$v postgresql-pltcl-$v postgresql-server-dev-$v postgresql-$v-repack postgresql-$v-wal2json postgresql-$v-pgvector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Here <code>$v</code> will be replaced with the actual PostgreSQL major version number <a href="/docs/reference/param/#pg_version"><code>pg_version</code></a>, So you can add any PG version related packages here, and Pigsty will download them for you.</p>
<h3 id="repo_url_packages"><code>repo_url_packages</code></h3>
<p>name: <code>repo_url_packages</code>, type: <code>object[] | string[]</code>, level: <code>G</code></p>
<p>extra packages from url, default values: <code>[]</code></p>
<p>You can use object list or string list in this parameter, in the latter case, Pigsty will use the url basename as the filename.</p>
<p>Beware that if the <a href="/docs/reference/param/#region"><code>region</code></a> is set to <code>china</code>, the <code>pigsty.io</code> will be replaced with <code>pigsty.cc</code> automatically.</p>
<hr>
<h2 id="infra_package"><code>INFRA_PACKAGE</code></h2>
<p>These packages are installed on infra nodes only, including common rpm/deb/pip packages.</p>
<h3 id="infra_packages"><code>infra_packages</code></h3>
<p>name: <code>infra_packages</code>, type: <code>string[]</code>, level: <code>G</code></p>
<p>This param is an array os strings, each string is a list of common software packages separated by space, specifying which packages to be installed on INFRA nodes.</p>
<p>This param <strong>DOES NOT</strong> have a default value, you can specify it explicitly, or leaving it empty if you want to use the default values.</p>
<p>When leaving it empty, Pigsty will use the default values from the <code>repo_packages_default</code> defined in <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> according to you OS.</p>
<p>For EL (7/8/9) system, the default values are:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">infra_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># packages to be installed on infra nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">grafana,loki,logcli,promtail,prometheus2,alertmanager,pushgateway</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">node_exporter,blackbox_exporter,nginx_exporter,pg_exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">nginx,dnsmasq,ansible,etcd,python3-requests,redis,mcli</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For Debian (11,12) or Ubuntu (22.04, 22.04) systems, the default values are:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">infra_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># packages to be installed on infra nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">grafana,loki,logcli,promtail,prometheus2,alertmanager,pushgateway</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">node-exporter,blackbox-exporter,nginx-exporter,pg-exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">nginx,dnsmasq,ansible,etcd,python3-requests,redis,mcli</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="infra_packages_pip"><code>infra_packages_pip</code></h3>
<p>name: <code>infra_packages_pip</code>, type: <code>string</code>, level: <code>G</code></p>
<p>pip installed packages for infra nodes, default value is empty string</p>
<hr>
<h2 id="nginx"><code>NGINX</code></h2>
<p>Pigsty exposes all Web services through Nginx: Home Page, Grafana, Prometheus, AlertManager, etc&hellip;,
and other optional tools such as PGWe, Jupyter Lab, Pgadmin, Bytebase ,and other static resource &amp; report such as <code>pev</code>, <code>schemaspy</code> &amp; <code>pgbadger</code></p>
<p>This nginx also serves as a local yum/apt repo.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">nginx_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># enable nginx on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># enable nginx_exporter on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_sslmode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">enable            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># nginx ssl mode? disable,enable,enforce</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_home</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/www                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># nginx content dir, `/www` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">80</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># nginx listen port, 80 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_ssl_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">443</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># nginx ssl listen port, 443 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">nginx_navbar</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># nginx index page navigation links</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: CA Cert ,url: &#39;/ca.crt&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pigsty self-signed ca.crt&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Package ,url: &#39;/pigsty&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;local yum repo packages&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: PG Logs ,url: &#39;/logs&#39;     ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;postgres raw csv logs&#39;</span><span style="color:#f8f8f8;text-decoration:underline">       </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Reports ,url: &#39;/report&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pgbadger summary report&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Explain ,url: &#39;/pigsty/pev.html&#39; ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;postgres explain visualizer&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="nginx_enabled"><code>nginx_enabled</code></h3>
<p>name: <code>nginx_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>enable nginx on this infra node? default value: <code>true</code></p>
<h3 id="nginx_exporter_enabled"><code>nginx_exporter_enabled</code></h3>
<p>name: <code>nginx_exporter_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>enable nginx_exporter on this infra node? default value: <code>true</code>.</p>
<p>set to false will disable <code>/nginx</code> health check stub too: If your nginx does not support <code>/nginx</code> stub, you can set this value to <code>false</code> to disable it.</p>
<h3 id="nginx_sslmode"><code>nginx_sslmode</code></h3>
<p>name: <code>nginx_sslmode</code>, type: <code>enum</code>, level: <code>G</code></p>
<p>nginx ssl mode? which could be: <code>disable</code>, <code>enable</code>, <code>enforce</code>, the default value: <code>enable</code></p>
<ul>
<li><code>disable</code>: listen on <a href="/docs/reference/param/#nginx_port"><code>nginx_port</code></a> and serve plain HTTP only</li>
<li><code>enable</code>: also listen on <a href="/docs/reference/param/#nginx_ssl_port"><code>nginx_ssl_port</code></a> and serve HTTPS</li>
<li><code>enforce</code>: all links will be rendered as <code>https://</code> by default</li>
</ul>
<h3 id="nginx_home"><code>nginx_home</code></h3>
<p>name: <code>nginx_home</code>, type: <code>path</code>, level: <code>G</code></p>
<p>nginx web server static content dir, <code>/www</code> by default</p>
<p>Nginx root directory which contains static resource and repo resource. It&rsquo;s wise to set this value same as <a href="/docs/reference/param/#repo_home"><code>repo_home</code></a> so that local repo content is automatically served.</p>
<h3 id="nginx_port"><code>nginx_port</code></h3>
<p>name: <code>nginx_port</code>, type: <code>port</code>, level: <code>G</code></p>
<p>nginx listen port which serves the HTTP requests, <code>80</code> by default.</p>
<p>If your default 80 port is occupied or unavailable, you can consider using another port, and change <a href="/docs/reference/param/#repo_endpoint"><code>repo_endpoint</code></a> and <a href="/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> (the <code>local</code> entry) accordingly.</p>
<h3 id="nginx_ssl_port"><code>nginx_ssl_port</code></h3>
<p>name: <code>nginx_ssl_port</code>, type: <code>port</code>, level: <code>G</code></p>
<p>nginx ssl listen port, <code>443</code> by default</p>
<h3 id="nginx_navbar"><code>nginx_navbar</code></h3>
<p>name: <code>nginx_navbar</code>, type: <code>index[]</code>, level: <code>G</code></p>
<p>nginx index page navigation links</p>
<p>default value:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">nginx_navbar</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># nginx index page navigation links</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: CA Cert ,url: &#39;/ca.crt&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pigsty self-signed ca.crt&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Package ,url: &#39;/pigsty&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;local yum repo packages&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: PG Logs ,url: &#39;/logs&#39;     ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;postgres raw csv logs&#39;</span><span style="color:#f8f8f8;text-decoration:underline">       </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Reports ,url: &#39;/report&#39;   ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pgbadger summary report&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: Explain ,url: &#39;/pigsty/pev.html&#39; ,desc</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;postgres explain visualizer&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Each record is rendered as a navigation link to the Pigsty home page App drop-down menu, and the apps are all optional, mounted by default on the Pigsty default server under <code>http://pigsty/</code>.</p>
<p>The <code>url</code> parameter specifies the URL PATH for the app, with the exception that if the <code>${grafana}</code> string is present in the URL, it will be automatically replaced with the Grafana domain name defined in <a href="/docs/reference/param/#infra_portal"><code>infra_portal</code></a>.</p>
<hr>
<h2 id="dns"><code>DNS</code></h2>
<p>Pigsty will launch a default DNSMASQ server on infra nodes to serve DNS inquiry. such as  <code>h.pigsty</code> <code>a.pigsty</code> <code>p.pigsty</code> <code>g.pigsty</code> and <code>sss.pigsty</code> for optional MinIO service.</p>
<p>All records will be added to infra node&rsquo;s <code>/etc/hosts.d/*</code>.</p>
<p>You have to add <code>nameserver {{ admin_ip }}</code> to your <code>/etc/resolv</code> to use this dns server, and <a href="/docs/reference/param/#node_dns_servers"><code>node_dns_servers</code></a> will do the trick.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">dns_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># setup dnsmasq on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">dns_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">53</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># dns server listen port, 53 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">dns_records</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># dynamic dns records resolved by dnsmasq</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} h.pigsty a.pigsty p.pigsty g.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} api.pigsty adm.pigsty cli.pigsty ddl.pigsty lab.pigsty git.pigsty sss.pigsty wiki.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="dns_enabled"><code>dns_enabled</code></h3>
<p>name: <code>dns_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>setup dnsmasq on this infra node? default value: <code>true</code></p>
<p>If you don&rsquo;t want to use the default DNS server, you can set this value to <code>false</code> to disable it.
And use <a href="/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a> and <a href="/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a> instead.</p>
<h3 id="dns_port"><code>dns_port</code></h3>
<p>name: <code>dns_port</code>, type: <code>port</code>, level: <code>G</code></p>
<p>dns server listen port, <code>53</code> by default</p>
<h3 id="dns_records"><code>dns_records</code></h3>
<p>name: <code>dns_records</code>, type: <code>string[]</code>, level: <code>G</code></p>
<p>dynamic dns records resolved by dnsmasq, Some auxiliary domain names will be written to <code>/etc/hosts.d/default</code> on infra nodes by default</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">dns_records</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># dynamic dns records resolved by dnsmasq</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} h.pigsty a.pigsty p.pigsty g.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} api.pigsty adm.pigsty cli.pigsty ddl.pigsty lab.pigsty git.pigsty sss.pigsty wiki.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><hr>
<h2 id="prometheus"><code>PROMETHEUS</code></h2>
<p>Prometheus is used as time-series database for metrics scrape, storage &amp; analysis.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">prometheus_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># enable prometheus on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># clean prometheus data during init?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/prometheus</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus data dir, `/data/prometheus` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/etc/prometheus/targets</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus file service discovery directory</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">5s       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus target refresh interval, 5s by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_scrape_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10s  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus scrape &amp; eval interval, 10s by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_scrape_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">8s    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus global scrape timeout, 8s by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--storage.tsdb.retention.time=15d&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># prometheus extra server options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pushgateway_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># setup pushgateway on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pushgateway_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--persistence.interval=1m&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pushgateway extra server options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">blackbox_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># setup blackbox_exporter on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">blackbox_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># blackbox_exporter extra server options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">alertmanager_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># setup alertmanager on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">alertmanager_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># alertmanager extra server options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_metrics_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/metrics  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># exporter metric path, `/metrics` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_install</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># how to install exporter? none,yum,binary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_repo_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># exporter repo file url if install exporter via yum</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="prometheus_enabled"><code>prometheus_enabled</code></h3>
<p>name: <code>prometheus_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>enable prometheus on this infra node?</p>
<p>default value: <code>true</code></p>
<h3 id="prometheus_clean"><code>prometheus_clean</code></h3>
<p>name: <code>prometheus_clean</code>, type: <code>bool</code>, level: <code>G/A</code></p>
<p>clean prometheus data during init? default value: <code>true</code></p>
<h3 id="prometheus_data"><code>prometheus_data</code></h3>
<p>name: <code>prometheus_data</code>, type: <code>path</code>, level: <code>G</code></p>
<p>prometheus data dir, <code>/data/prometheus</code> by default</p>
<h3 id="prometheus_sd_dir"><code>prometheus_sd_dir</code></h3>
<p>name: <code>prometheus_sd_dir</code>, type: <code>path</code>, level: <code>G</code>, default value: <code>/etc/prometheus/targets</code></p>
<p>prometheus static file service discovery target dir, prometheus will find dynamic monitoring targets from this directory.</p>
<h3 id="prometheus_sd_interval"><code>prometheus_sd_interval</code></h3>
<p>name: <code>prometheus_sd_interval</code>, type: <code>interval</code>, level: <code>G</code>, default value: <code>5s</code></p>
<p>Prometheus will check <a href="/docs/reference/param/#prometheus_sd_interval"><code>prometheus_sd_interval</code></a> dir per 5s by default to find out new monitoring targets.</p>
<h3 id="prometheus_scrape_interval"><code>prometheus_scrape_interval</code></h3>
<p>name: <code>prometheus_scrape_interval</code>, type: <code>interval</code>, level: <code>G</code></p>
<p>prometheus scrape &amp; eval interval, <code>10s</code> by default</p>
<h3 id="prometheus_scrape_timeout"><code>prometheus_scrape_timeout</code></h3>
<p>name: <code>prometheus_scrape_timeout</code>, type: <code>interval</code>, level: <code>G</code></p>
<p>prometheus global scrape timeout, <code>8s</code> by default</p>
<p>DO NOT set this larger than <a href="/docs/reference/param/#prometheus_scrape_interval"><code>prometheus_scrape_interval</code></a></p>
<h3 id="prometheus_options"><code>prometheus_options</code></h3>
<p>name: <code>prometheus_options</code>, type: <code>arg</code>, level: <code>G</code></p>
<p>prometheus extra server options</p>
<p>default value: <code>--storage.tsdb.retention.time=15d</code></p>
<p>Extra cli args for prometheus server, the default value will set up a 15-day data retention to limit disk usage.</p>
<h3 id="pushgateway_enabled"><code>pushgateway_enabled</code></h3>
<p>name: <code>pushgateway_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>setup pushgateway on this infra node? default value: <code>true</code></p>
<h3 id="pushgateway_options"><code>pushgateway_options</code></h3>
<p>name: <code>pushgateway_options</code>, type: <code>arg</code>, level: <code>G</code></p>
<p>pushgateway extra server options, default value: <code>--persistence.interval=1m</code></p>
<h3 id="blackbox_enabled"><code>blackbox_enabled</code></h3>
<p>name: <code>blackbox_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>setup blackbox_exporter on this infra node? default value: <code>true</code></p>
<h3 id="blackbox_options"><code>blackbox_options</code></h3>
<p>name: <code>blackbox_options</code>, type: <code>arg</code>, level: <code>G</code></p>
<p>blackbox_exporter extra server options, default value is empty string</p>
<h3 id="alertmanager_enabled"><code>alertmanager_enabled</code></h3>
<p>name: <code>alertmanager_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>setup alertmanager on this infra node? default value: <code>true</code></p>
<h3 id="alertmanager_options"><code>alertmanager_options</code></h3>
<p>name: <code>alertmanager_options</code>, type: <code>arg</code>, level: <code>G</code></p>
<p>alertmanager extra server options, default value is empty string</p>
<h3 id="exporter_metrics_path"><code>exporter_metrics_path</code></h3>
<p>name: <code>exporter_metrics_path</code>, type: <code>path</code>, level: <code>G</code></p>
<p>exporter metric path, <code>/metrics</code> by default</p>
<h3 id="exporter_install"><code>exporter_install</code></h3>
<p>name: <code>exporter_install</code>, type: <code>enum</code>, level: <code>G</code></p>
<p>(<strong>OBSOLETE</strong>) how to install exporter? none,yum,binary</p>
<p>default value: <code>none</code></p>
<p>Specify how to install Exporter:</p>
<ul>
<li><code>none</code>: No installation, (by default, the Exporter has been previously installed by the <a href="/docs/reference/param/#node_default_packages"><code>node_pkg</code></a> task)</li>
<li><code>yum</code>: Install using yum (if yum installation is enabled, run yum to install <a href="/docs/reference/param/#node_exporter"><code>node_exporter</code></a> and <a href="/docs/reference/param/#pg_exporter"><code>pg_exporter</code></a> before deploying Exporter)</li>
<li><code>binary</code>: Install using a copy binary (copy <a href="/docs/reference/param/#node_exporter"><code>node_exporter</code></a> and <a href="/docs/reference/param/#pg_exporter"><code>pg_exporter</code></a> binary directly from the meta node, not recommended)</li>
</ul>
<p>When installing with <code>yum</code>, if <code>exporter_repo_url</code> is specified (not empty), the installation will first install the REPO file under that URL into <code>/etc/yum.repos.d</code>. This feature allows you to install Exporter directly without initializing the node infrastructure.
It is not recommended for regular users to use <code>binary</code> installation. This mode is usually used for emergency troubleshooting and temporary problem fixes.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&lt;meta&gt;:&lt;pigsty&gt;/files/node_exporter -&gt;  &lt;target&gt;:/usr/bin/node_exporter
</span></span><span style="display:flex;"><span>&lt;meta&gt;:&lt;pigsty&gt;/files/pg_exporter   -&gt;  &lt;target&gt;:/usr/bin/pg_exporter
</span></span></code></pre></div><h3 id="exporter_repo_url"><code>exporter_repo_url</code></h3>
<p>name: <code>exporter_repo_url</code>, type: <code>url</code>, level: <code>G</code></p>
<p>(<strong>OBSOLETE</strong>) exporter repo file url if install exporter via yum</p>
<p>default value is empty string</p>
<p>Default is empty; when <a href="/docs/reference/param/#exporter_install"><code>exporter_install</code></a> is <code>yum</code>, the repo specified by this parameter will be added to the node source list.</p>
<hr>
<h2 id="grafana"><code>GRAFANA</code></h2>
<p>Grafana is the visualization platform for Pigsty&rsquo;s monitoring system.</p>
<p>It can also be used as a low code data visualization environment</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">grafana_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># enable grafana on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">grafana_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># clean grafana data during init?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">grafana_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">admin    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># grafana admin username, `admin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">grafana_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># grafana admin password, `pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loki_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># enable loki on this infra node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loki_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># whether remove existing loki data?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loki_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/loki            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># loki data dir, `/data/loki` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loki_retention</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">15d              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># loki log retention period, 15d by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="grafana_enabled"><code>grafana_enabled</code></h3>
<p>name: <code>grafana_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>enable grafana on this infra node? default value: <code>true</code></p>
<h3 id="grafana_clean"><code>grafana_clean</code></h3>
<p>name: <code>grafana_clean</code>, type: <code>bool</code>, level: <code>G/A</code></p>
<p>clean grafana data during init? default value: <code>true</code></p>
<h3 id="grafana_admin_username"><code>grafana_admin_username</code></h3>
<p>name: <code>grafana_admin_username</code>, type: <code>username</code>, level: <code>G</code></p>
<p>grafana admin username, <code>admin</code> by default</p>
<h3 id="grafana_admin_password"><code>grafana_admin_password</code></h3>
<p>name: <code>grafana_admin_password</code>, type: <code>password</code>, level: <code>G</code></p>
<p>grafana admin password, <code>pigsty</code> by default</p>
<p>default value: <code>pigsty</code></p>
<blockquote>
<p>WARNING: Change this to a strong password before deploying to production environment</p>
</blockquote>
<hr>
<h2 id="loki"><code>LOKI</code></h2>
<h3 id="loki_enabled"><code>loki_enabled</code></h3>
<p>name: <code>loki_enabled</code>, type: <code>bool</code>, level: <code>G/I</code></p>
<p>enable loki on this infra node? default value: <code>true</code></p>
<h3 id="loki_clean"><code>loki_clean</code></h3>
<p>name: <code>loki_clean</code>, type: <code>bool</code>, level: <code>G/A</code></p>
<p>whether remove existing loki data? default value: <code>false</code></p>
<h3 id="loki_data"><code>loki_data</code></h3>
<p>name: <code>loki_data</code>, type: <code>path</code>, level: <code>G</code></p>
<p>loki data dir, default value: <code>/data/loki</code></p>
<h3 id="loki_retention"><code>loki_retention</code></h3>
<p>name: <code>loki_retention</code>, type: <code>interval</code>, level: <code>G</code></p>
<p>loki log retention period, <code>15d</code> by default</p>
<hr>
<h1 id="node"><code>NODE</code></h1>
<p>Node module are tuning target nodes into desired state and take it into the Pigsty monitor system.</p>
<hr>
<h2 id="node_id"><code>NODE_ID</code></h2>
<p>Each node has <strong>identity parameters</strong> that are configured through the parameters in <code>&lt;cluster&gt;.hosts</code> and <code>&lt;cluster&gt;.vars</code>. Check <a href="/docs/node/#configuration">NODE Identity</a> for details.</p>
<h3 id="nodename"><code>nodename</code></h3>
<p>name: <code>nodename</code>, type: <code>string</code>, level: <code>I</code></p>
<p>node instance identity, use hostname if missing, optional</p>
<p>no default value, Null or empty string means <code>nodename</code> will be set to node&rsquo;s current hostname.</p>
<p>If <a href="/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a> is <code>true</code> (by default) and <code>nodename</code> is not explicitly defined, <a href="/docs/reference/param/#nodename"><code>nodename</code></a> will try to use <code>${pg_cluster}-${pg_seq}</code> first, if PGSQL is not defined on this node, it will fall back to default <code>HOSTNAME</code>.</p>
<p>If <a href="/docs/reference/param/#nodename_overwrite"><code>nodename_overwrite</code></a> is <code>true</code>, the node name will also be used as the HOSTNAME.</p>
<h3 id="node_cluster"><code>node_cluster</code></h3>
<p>name: <code>node_cluster</code>, type: <code>string</code>, level: <code>C</code></p>
<p>node cluster identity, use &rsquo;nodes&rsquo; if missing, optional</p>
<p>default values: <code>nodes</code></p>
<p>If <a href="/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a> is <code>true</code> (by default) and <code>node_cluster</code> is not explicitly defined, <a href="/docs/reference/param/#node_cluster"><code>node_cluster</code></a> will try to use <code>${pg_cluster}</code> first, if PGSQL is not defined on this node, it will fall back to default <code>HOSTNAME</code>.</p>
<h3 id="nodename_overwrite"><code>nodename_overwrite</code></h3>
<p>name: <code>nodename_overwrite</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>overwrite node&rsquo;s hostname with nodename?</p>
<p>default value is <code>true</code>, a non-empty node name <a href="/docs/reference/param/#nodename"><code>nodename</code></a> will override the hostname of the current node.</p>
<p>When the <a href="/docs/reference/param/#nodename"><code>nodename</code></a> parameter is undefined or an empty string, but <a href="/docs/reference/param/#node_id_from_pg"><code>node_id_from_pg</code></a> is <code>true</code>,
the node name will try to use <code>{{ pg_cluster }}-{{ pg_seq }}</code>, borrow identity from the 1:1 PostgreSQL Instance&rsquo;s ins name.</p>
<p>No changes are made to the hostname if the <code>nodename</code> is undefined, empty, or an empty string and <code>node_id_from_pg</code> is <code>false</code>.</p>
<h3 id="nodename_exchange"><code>nodename_exchange</code></h3>
<p>name: <code>nodename_exchange</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>exchange nodename among play hosts?</p>
<p>default value is <code>false</code></p>
<p>When this parameter is enabled, node names are exchanged between the same group of nodes executing the <a href="/docs/node/#nodeyml"><code>node.yml</code></a> playbook, written to <code>/etc/hosts</code>.</p>
<h3 id="node_id_from_pg"><code>node_id_from_pg</code></h3>
<p>name: <code>node_id_from_pg</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>use postgres identity as node identity if applicable?</p>
<p>default value is <code>true</code></p>
<p>Boworrow PostgreSQL cluster &amp; instance identity if application.</p>
<p>It&rsquo;s useful to use same identity for postgres &amp; node if there&rsquo;s a 1:1 relationship</p>
<hr>
<h2 id="node_dns"><code>NODE_DNS</code></h2>
<p>Pigsty configs static DNS records and dynamic DNS resolver for nodes.</p>
<p>If you already have a DNS server, set <a href="/docs/reference/param/#node_dns_method"><code>node_dns_method</code></a> to <code>none</code> to disable dynamic DNS setup.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_write_etc_hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># modify `/etc/hosts` on target node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_default_etc_hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># static dns records in `/etc/hosts`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;${admin_ip} h.pigsty a.pigsty p.pigsty g.pigsty&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_etc_hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># extra static dns records in `/etc/hosts`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_dns_method: add              # how to handle dns servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">add,none,overwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_dns_servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;${admin_ip}&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dynamic nameserver in `/etc/resolv.conf`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_dns_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># dns resolv options in `/etc/resolv.conf`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">options single-request-reopen timeout:1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_write_etc_hosts">node_write_etc_hosts</h3>
<p>name: <code>node_write_etc_hosts</code>, type: &lsquo;bool&rsquo;, level: <code>G|C|I</code></p>
<p>modify <code>/etc/hosts</code> on target node?</p>
<p>For example, the docker VM can not modify <code>/etc/hosts</code> by default, so you can set this value to <code>false</code> to disable the modification.</p>
<h3 id="node_default_etc_hosts"><code>node_default_etc_hosts</code></h3>
<p>name: <code>node_default_etc_hosts</code>, type: <code>string[]</code>, level: <code>G</code></p>
<p>static dns records in <code>/etc/hosts</code></p>
<p>default value:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;${admin_ip} h.pigsty a.pigsty p.pigsty g.pigsty&#34;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><a href="/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a> is an array. Each element is a DNS record with format <code>&lt;ip&gt; &lt;name&gt;</code>.</p>
<p>It is used for global static DNS records. You can use <a href="/docs/reference/param/#node_etc_hosts"><code>node_etc_hosts</code></a> for ad hoc records for each cluster.</p>
<p>Make sure to write a DNS record like <code>10.10.10.10 h.pigsty a.pigsty p.pigsty g.pigsty</code> to <code>/etc/hosts</code> to ensure that the local yum repo can be accessed using the domain name before the DNS Nameserver starts.</p>
<h3 id="node_etc_hosts"><code>node_etc_hosts</code></h3>
<p>name: <code>node_etc_hosts</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>extra static dns records in <code>/etc/hosts</code></p>
<p>default values: <code>[]</code></p>
<p>Same as <a href="/docs/reference/param/#node_default_etc_hosts"><code>node_default_etc_hosts</code></a>, but in addition to it.</p>
<h3 id="node_dns_method"><code>node_dns_method</code></h3>
<p>name: <code>node_dns_method</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>how to handle dns servers: add,none,overwrite</p>
<p>default values: <code>add</code></p>
<ul>
<li><code>add</code>: Append the records in <a href="/docs/reference/param/#node_dns_servers"><code>node_dns_servers</code></a> to <code>/etc/resolv.conf</code> and keep the existing DNS servers. (default)</li>
<li><code>overwrite</code>: Overwrite <code>/etc/resolv.conf</code> with the record in <a href="/docs/reference/param/#node_dns_servers"><code>node_dns_servers</code></a></li>
<li><code>none</code>: If a DNS server is provided in the production env, the DNS server config can be skipped.</li>
</ul>
<h3 id="node_dns_servers"><code>node_dns_servers</code></h3>
<p>name: <code>node_dns_servers</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>dynamic nameserver in <code>/etc/resolv.conf</code></p>
<p>default values: <code>[&quot;${admin_ip}&quot;]</code> , the default nameserver on admin node will be added to <code>/etc/resolv.conf</code> as the first nameserver.</p>
<h3 id="node_dns_options"><code>node_dns_options</code></h3>
<p>name: <code>node_dns_options</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>dns resolv options in <code>/etc/resolv.conf</code>, default value:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">options single-request-reopen timeout:1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><hr>
<h2 id="node_package"><code>NODE_PACKAGE</code></h2>
<p>This section is about upstream yum repos &amp; packages to be installed.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_repo_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># upstream repo to be added on node, local by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_repo_remove</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># remove existing repo on node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">openssh-server]  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># packages to be installed current nodes with latest version</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#node_default_packages: []        # default packages to be installed on infra nodes, (defaults are load from node_id/vars)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_repo_modules"><code>node_repo_modules</code></h3>
<p>name: <code>node_repo_modules</code>, type: <code>string</code>, level: <code>C/A</code></p>
<p>upstream repo to be added on node, default value: <code>local</code></p>
<p>This parameter specifies the upstream repo to be added to the node. It is used to filter the <a href="/docs/reference/param/#repo_upstream"><code>repo_upstream</code></a> entries
and only the entries with the same <code>module</code> value will be added to the node&rsquo;s software source. Which is similar to the <a href="/docs/reference/param/#repo_modules"><code>repo_modules</code></a> parameter.</p>
<h3 id="node_repo_remove"><code>node_repo_remove</code></h3>
<p>name: <code>node_repo_remove</code>, type: <code>bool</code>, level: <code>C/A</code></p>
<p>remove existing repo on node?</p>
<p>default value is <code>true</code>, and thus Pigsty will move existing repo file in <code>/etc/yum.repos.d</code> to a backup dir: <code>/etc/yum.repos.d/backup</code> before adding upstream repos
On Debian/Ubuntu, Pigsty will backup &amp; move <code>/etc/apt/sources.list(.d)</code> to <code>/etc/apt/backup</code>.</p>
<h3 id="node_packages"><code>node_packages</code></h3>
<p>name: <code>node_packages</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>packages to be installed current nodes, default values: <code>[openssh-server]</code>.</p>
<p>Each element is a comma-separated list of package names, which will be installed on the current node in addition to <a href="/docs/reference/param/#node_default_packages"><code>node_default_packages</code></a></p>
<p>Packages specified in this parameter will be <strong>upgraded</strong> to the latest version, and the default value is <code>[openssh-server]</code>, which will upgrade <code>sshd</code> by default to avoid SSH CVE.</p>
<p>This parameters is usually used to install additional software packages that is ad hoc for the current node/cluster.</p>
<h3 id="node_default_packages"><code>node_default_packages</code></h3>
<p>name: <code>node_default_packages</code>, type: <code>string[]</code>, level: <code>G</code></p>
<p>default packages to be installed on all nodes, the default values is not defined.</p>
<p>This param is an array os strings, each string is a comma-separated list of package names, which will be installed on all nodes by default.</p>
<p>This param <strong>DOES NOT</strong> have a default value, you can specify it explicitly, or leaving it empty if you want to use the default values.</p>
<p>When leaving it empty, Pigsty will use the default values from the <code>node_packages_default</code> defined in <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> according to you OS.</p>
<p>For EL system, the default values are:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">lz4,unzip,bzip2,pv,jq,git,ncdu,make,patch,bash,lsof,wget,uuid,tuned,nvme-cli,numactl,sysstat,iotop,htop,rsync,tcpdump</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">python3,python3-pip,socat,lrzsz,net-tools,ipvsadm,telnet,ca-certificates,openssl,keepalived,etcd,haproxy,chrony</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">zlib,yum,audit,bind-utils,readline,vim-minimal,node_exporter,grubby,openssh-server,openssh-clients</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For debian / ubuntu nodes, use this default value explicitly:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">lz4,unzip,bzip2,pv,jq,git,ncdu,make,patch,bash,lsof,wget,uuid,tuned,nvme-cli,numactl,sysstat,iotop,htop,rsync,tcpdump</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">python3,python3-pip,socat,lrzsz,net-tools,ipvsadm,telnet,ca-certificates,openssl,keepalived,etcd,haproxy,chrony</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">zlib1g,acl,dnsutils,libreadline-dev,vim-tiny,node-exporter,openssh-server,openssh-client</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><hr>
<h2 id="node_tune"><code>NODE_TUNE</code></h2>
<p>Configure tuned templates, features, kernel modules, sysctl params on node.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_disable_firewall</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># disable node firewall? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_disable_selinux</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># disable node selinux? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_disable_numa</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># disable node numa, reboot required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_disable_swap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># disable node swap, use with caution</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_static_network</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># preserve dns resolver settings after reboot</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_disk_prefetch</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># setup disk prefetch on HDD to increase performance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_kernel_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">softdog, br_netfilter, ip_vs, ip_vs_rr, ip_vs_wrr, ip_vs_sh ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_hugepage_count</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># number of 2MB hugepage, take precedence over ratio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_hugepage_ratio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># node mem hugepage ratio, 0 disable it by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_overcommit_ratio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># node mem overcommit ratio, 0 disable it by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_tune: oltp                   # node tuned profile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none,oltp,olap,crit,tiny</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_sysctl_params</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># sysctl parameters in k:v format in addition to tuned</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_disable_firewall"><code>node_disable_firewall</code></h3>
<p>name: <code>node_disable_firewall</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>disable node firewall? true by default</p>
<p>default value is <code>true</code></p>
<h3 id="node_disable_selinux"><code>node_disable_selinux</code></h3>
<p>name: <code>node_disable_selinux</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>disable node selinux? true by default</p>
<p>default value is <code>true</code></p>
<h3 id="node_disable_numa"><code>node_disable_numa</code></h3>
<p>name: <code>node_disable_numa</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>disable node numa, reboot required</p>
<p>default value is <code>false</code></p>
<p>Boolean flag, default is not off. Note that turning off NUMA requires a reboot of the machine before it can take effect!</p>
<p>If you don&rsquo;t know how to set the CPU affinity, it is recommended to turn off NUMA.</p>
<h3 id="node_disable_swap"><code>node_disable_swap</code></h3>
<p>name: <code>node_disable_swap</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>disable node swap, use with caution</p>
<p>default value is <code>false</code></p>
<p>But turning off SWAP is not recommended. But SWAP should be disabled when your node is used for a Kubernetes deployment.</p>
<p>If there is enough memory and the database is deployed exclusively. it may slightly improve performance</p>
<h3 id="node_static_network"><code>node_static_network</code></h3>
<p>name: <code>node_static_network</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>preserve dns resolver settings after reboot, default value is <code>true</code></p>
<p>Enabling static networking means that machine reboots will not overwrite your DNS Resolv config with NIC changes. It is recommended to enable it in production environment.</p>
<h3 id="node_disk_prefetch"><code>node_disk_prefetch</code></h3>
<p>name: <code>node_disk_prefetch</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>setup disk prefetch on HDD to increase performance</p>
<p>default value is <code>false</code>, Consider enable this when using HDD.</p>
<h3 id="node_kernel_modules"><code>node_kernel_modules</code></h3>
<p>name: <code>node_kernel_modules</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>kernel modules to be enabled on this node</p>
<p>default value:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_kernel_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">softdog, br_netfilter, ip_vs, ip_vs_rr, ip_vs_wrr, ip_vs_sh ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>An array consisting of kernel module names declaring the kernel modules that need to be installed on the node.</p>
<h3 id="node_hugepage_count"><code>node_hugepage_count</code></h3>
<p>name: <code>node_hugepage_count</code>, type: <code>int</code>, level: <code>C</code></p>
<p>number of 2MB hugepage, take precedence over ratio, 0 by default</p>
<p>Take precedence over <a href="/docs/reference/param/#node_hugepage_ratio"><code>node_hugepage_ratio</code></a>. If a non-zero value is given, it will be written to <code>/etc/sysctl.d/hugepage.conf</code></p>
<p>If <code>node_hugepage_count</code> and <code>node_hugepage_ratio</code> are both <code>0</code> (default), hugepage will be disabled at all.</p>
<p>Negative value will not work, and number higher than 90% node mem will be ceil to 90% of node mem.</p>
<p>It should slightly larger than <a href="/docs/reference/param/#pg_shared_buffer_ratio"><code>pg_shared_buffer_ratio</code></a>, if not zero.</p>
<h3 id="node_hugepage_ratio"><code>node_hugepage_ratio</code></h3>
<p>name: <code>node_hugepage_ratio</code>, type: <code>float</code>, level: <code>C</code></p>
<p>node mem hugepage ratio, 0 disable it by default, valid range: 0 ~ 0.40</p>
<p>default values: <code>0</code>, which will set <code>vm.nr_hugepages=0</code> and not use HugePage at all.</p>
<p>Percent of this memory will be allocated as HugePage, and reserved for PostgreSQL.</p>
<p>It should be equal or slightly larger than <a href="/docs/reference/param/#pg_shared_buffer_ratio"><code>pg_shared_buffer_ratio</code></a>, if not zero.</p>
<p>For example, if you have default 25% mem for postgres shard buffers, you can set this value to 0.27 ~ 0.30,  Wasted hugepage can be reclaimed later with <code>/pg/bin/pg-tune-hugepage</code></p>
<h3 id="node_overcommit_ratio"><code>node_overcommit_ratio</code></h3>
<p>name: <code>node_overcommit_ratio</code>, type: <code>int</code>, level: <code>C</code></p>
<p>node mem overcommit ratio, 0 disable it by default. this is an integer from 0 to 100+ .</p>
<p>default values: <code>0</code>, which will set <code>vm.overcommit_memory=0</code>, otherwise <code>vm.overcommit_memory=2</code> will be used,
and this value will be used as <code>vm.overcommit_ratio</code>.</p>
<p>It is recommended to set use a <code>vm.overcommit_ratio</code> on dedicated pgsql nodes. e.g. 50 ~ 100.</p>
<h3 id="node_tune-1"><code>node_tune</code></h3>
<p>name: <code>node_tune</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>node tuned profile: none,oltp,olap,crit,tiny</p>
<p>default values: <code>oltp</code></p>
<ul>
<li><code>tiny</code>: Micro Virtual Machine (1 ~ 3 Core, 1 ~ 8 GB Mem)</li>
<li><code>oltp</code>: Regular OLTP templates with optimized latency</li>
<li><code>olap </code>: Regular OLAP templates to optimize throughput</li>
<li><code>crit</code>: Core financial business templates, optimizing the number of dirty pages</li>
</ul>
<p>Usually, the database tuning template <a href="/docs/reference/param/#pg_conf"><code>pg_conf</code></a> should be paired with the node tuning template: <a href="/docs/reference/param/#node_tune"><code>node_tune</code></a></p>
<h3 id="node_sysctl_params"><code>node_sysctl_params</code></h3>
<p>name: <code>node_sysctl_params</code>, type: <code>dict</code>, level: <code>C</code></p>
<p>sysctl parameters in k:v format in addition to tuned</p>
<p>default values: <code>{}</code></p>
<p>Dictionary K-V structure, Key is kernel <code>sysctl</code> parameter name, Value is the parameter value.</p>
<p>You can also define sysctl parameters with tuned profile</p>
<hr>
<h2 id="node_admin"><code>NODE_ADMIN</code></h2>
<p>This section is about admin users and it&rsquo;s credentials.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># node main data directory, `/data` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># create a admin user on target node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_uid</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">88</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># uid and gid for node admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dba         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># name of node admin user, `dba` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_ssh_exchange</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#8f5902;font-style:italic"># exchange admin ssh key among node cluster</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_pk_current</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># add current user&#39;s ssh pk to admin authorized_keys</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_admin_pk_list</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># ssh public keys to be added to admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_data"><code>node_data</code></h3>
<p>name: <code>node_data</code>, type: <code>path</code>, level: <code>C</code></p>
<p>node main data directory, <code>/data</code> by default</p>
<p>default values: <code>/data</code></p>
<p>If specified, this path will be used as major data disk mountpoint. And a dir will be created and throwing a warning if path not exists.</p>
<p>The data dir is owned by root with mode <code>0777</code>.</p>
<h3 id="node_admin_enabled"><code>node_admin_enabled</code></h3>
<p>name: <code>node_admin_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>create a admin user on target node?</p>
<p>default value is <code>true</code></p>
<p>Create an admin user on each node (password-free sudo and ssh), an admin user named <code>dba (uid=88)</code> will be created by default,
which can access other nodes in the env and perform sudo from the meta node via SSH password-free.</p>
<h3 id="node_admin_uid"><code>node_admin_uid</code></h3>
<p>name: <code>node_admin_uid</code>, type: <code>int</code>, level: <code>C</code></p>
<p>uid and gid for node admin user</p>
<p>default values: <code>88</code></p>
<h3 id="node_admin_username"><code>node_admin_username</code></h3>
<p>name: <code>node_admin_username</code>, type: <code>username</code>, level: <code>C</code></p>
<p>name of node admin user, <code>dba</code> by default</p>
<p>default values: <code>dba</code></p>
<h3 id="node_admin_ssh_exchange"><code>node_admin_ssh_exchange</code></h3>
<p>name: <code>node_admin_ssh_exchange</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>exchange admin ssh key among node cluster</p>
<p>default value is <code>true</code></p>
<p>When enabled, Pigsty will exchange SSH public keys between members during playbook execution, allowing admins <a href="/docs/reference/param/#node_admin_username"><code>node_admin_username</code></a> to access each other from different nodes.</p>
<h3 id="node_admin_pk_current"><code>node_admin_pk_current</code></h3>
<p>name: <code>node_admin_pk_current</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>add current user&rsquo;s ssh pk to admin authorized_keys</p>
<p>default value is <code>true</code></p>
<p>When enabled, on the current node, the SSH public key (<code>~/.ssh/id_rsa.pub</code>) of the current user is copied to the <code>authorized_keys</code> of the target node admin user.</p>
<p>When deploying in a production env, be sure to pay attention to this parameter, which installs the default public key of the user currently executing the command to the admin user of all machines.</p>
<h3 id="node_admin_pk_list"><code>node_admin_pk_list</code></h3>
<p>name: <code>node_admin_pk_list</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>ssh public keys to be added to admin user</p>
<p>default values: <code>[]</code></p>
<p>Each element of the array is a string containing the key written to the admin user <code>~/.ssh/authorized_keys</code>, and the user with the corresponding private key can log in as an admin user.</p>
<p>When deploying in production envs, be sure to note this parameter and add only trusted keys to this list.</p>
<hr>
<h2 id="node_time"><code>NODE_TIME</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_timezone</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># setup node timezone, empty string to skip</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_ntp_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># enable chronyd time sync service?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_ntp_servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># ntp servers in `/etc/chrony.conf`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">pool pool.ntp.org iburst</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_crontab_overwrite</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># overwrite or append to `/etc/crontab`?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_crontab</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># crontab entries in `/etc/crontab`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_timezone"><code>node_timezone</code></h3>
<p>name: <code>node_timezone</code>, type: <code>string</code>, level: <code>C</code></p>
<p>setup node timezone, empty string to skip</p>
<p>default value is empty string, which will not change the default timezone (usually UTC)</p>
<h3 id="node_ntp_enabled"><code>node_ntp_enabled</code></h3>
<p>name: <code>node_ntp_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable chronyd time sync service?</p>
<p>default value is <code>true</code>, and thus Pigsty will override the node&rsquo;s <code>/etc/chrony.conf</code> by with <a href="/docs/reference/param/#node_ntp_servers"><code>node_ntp_servers</code></a>.</p>
<p>If you already a NTP server configured, just set to <code>false</code> to leave it be.</p>
<h3 id="node_ntp_servers"><code>node_ntp_servers</code></h3>
<p>name: <code>node_ntp_servers</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>ntp servers in <code>/etc/chrony.conf</code>, default value:  <code>[&quot;pool pool.ntp.org iburst&quot;]</code></p>
<p>It only takes effect if <a href="/docs/reference/param/#node_ntp_enabled"><code>node_ntp_enabled</code></a> is true.</p>
<p>You can use <code>${admin_ip}</code> to sync time with ntp server on admin node rather than public ntp server.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_ntp_servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pool ${admin_ip} iburst&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_crontab_overwrite"><code>node_crontab_overwrite</code></h3>
<p>name: <code>node_crontab_overwrite</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>overwrite or append to <code>/etc/crontab</code>?</p>
<p>default value is <code>true</code>, and pigsty will render records in <a href="/docs/reference/param/#node_crontab"><code>node_crontab</code></a> in overwrite mode rather than appending to it.</p>
<h3 id="node_crontab"><code>node_crontab</code></h3>
<p>name: <code>node_crontab</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>crontab entries in <code>/etc/crontab</code></p>
<p>default values: <code>[]</code></p>
<hr>
<h2 id="node_vip"><code>NODE_VIP</code></h2>
<p>You can bind an optional L2 VIP among one node cluster, which is disabled by default.</p>
<p>L2 VIP can only be used in same L2 LAN, which may incurs extra restrictions on your network topology.</p>
<p>If enabled, You have to manually assign the <a href="/docs/reference/param/#vip_address"><code>vip_address</code></a> and <a href="/docs/reference/param/#vip_vrid"><code>vip_vrid</code></a> for each node cluster.</p>
<p>It is user&rsquo;s responsibility to ensure that the address / vrid is <strong>unique</strong> among the same LAN.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">vip_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># enable vip on this node cluster?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_address:         [IDENTITY] # node vip address in ipv4 format, required if vip is enabled</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_vrid:            [IDENTITY] # required, integer, 1-254, should be unique among same VLAN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">backup                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, `master/backup`, backup by default, use as init role</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_preempt</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># optional, `true/false`, false by default, enable vip preemption</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth0              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># node vip network interface to listen, `eth0` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_dns_suffix</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># node vip dns name suffix, empty string by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9650</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># keepalived exporter listen port, 9650 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="vip_enabled"><code>vip_enabled</code></h3>
<p>name: <code>vip_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable vip on this node cluster? default value is <code>false</code>, means no L2 VIP is created for this node cluster.</p>
<p>L2 VIP can only be used in same L2 LAN, which may incurs extra restrictions on your network topology.</p>
<h3 id="vip_address"><code>vip_address</code></h3>
<p>name: <code>vip_address</code>, type: <code>ip</code>, level: <code>C</code></p>
<p>node vip address in IPv4 format, <strong>required</strong> if node <a href="/docs/reference/param/#vip_enabled"><code>vip_enabled</code></a>.</p>
<p>no default value. This parameter must be explicitly assigned and unique in your LAN.</p>
<h3 id="vip_vrid"><code>vip_vrid</code></h3>
<p>name: <code>vip_vrid</code>, type: <code>int</code>, level: <code>C</code></p>
<p>integer, 1-254, should be unique in same VLAN, <strong>required</strong> if node <a href="/docs/reference/param/#vip_enabled"><code>vip_enabled</code></a>.</p>
<p>no default value. This parameter must be explicitly assigned and unique in your LAN.</p>
<h3 id="vip_role"><code>vip_role</code></h3>
<p>name: <code>vip_role</code>, type: <code>enum</code>, level: <code>I</code></p>
<p>node vip role, could be <code>master</code> or <code>backup</code>, will be used as initial keepalived state.</p>
<h3 id="vip_preempt"><code>vip_preempt</code></h3>
<p>name: <code>vip_preempt</code>, type: <code>bool</code>, level: <code>C/I</code></p>
<p>optional, <code>true/false</code>, false by default, enable vip preemption</p>
<p>default value is <code>false</code>, means no preempt is happening when a backup have higher priority than living master.</p>
<h3 id="vip_interface"><code>vip_interface</code></h3>
<p>name: <code>vip_interface</code>, type: <code>string</code>, level: <code>C/I</code></p>
<p>node vip network interface to listen, <code>eth0</code> by default.</p>
<p>It should be the same primary intranet interface of your node, which is the IP address you used in the inventory file.</p>
<p>If your node have different interface, you can override it on instance vars</p>
<h3 id="vip_dns_suffix"><code>vip_dns_suffix</code></h3>
<p>name: <code>vip_dns_suffix</code>, type: <code>string</code>, level: <code>C/I</code></p>
<p>node vip dns name suffix, empty string by default. It will be used as the DNS name of the node VIP.</p>
<h3 id="vip_exporter_port"><code>vip_exporter_port</code></h3>
<p>name: <code>vip_exporter_port</code>, type: <code>port</code>, level: <code>C/I</code></p>
<p>keepalived exporter listen port, 9650 by default.</p>
<hr>
<h2 id="haproxy"><code>HAPROXY</code></h2>
<p>HAProxy is installed on every node by default, exposing services in a NodePort manner.</p>
<p>It is used by <a href="/docs/pgsql/"><code>PGSQL</code></a> <a href="/docs/concept/svc/">Service</a>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">haproxy_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># enable haproxy on this node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># cleanup all existing haproxy config?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># reload haproxy after config?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_auth_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># enable authentication for haproxy admin page</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">admin    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># haproxy admin username, `admin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># haproxy admin password, `pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9101</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># haproxy admin/exporter port, 9101 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_client_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">24h      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># client side connection timeout, 24h by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_server_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">24h      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># server side connection timeout, 24h by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># list of haproxy service to be exposed on node</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="haproxy_enabled"><code>haproxy_enabled</code></h3>
<p>name: <code>haproxy_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable haproxy on this node?</p>
<p>default value is <code>true</code></p>
<h3 id="haproxy_clean"><code>haproxy_clean</code></h3>
<p>name: <code>haproxy_clean</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>cleanup all existing haproxy config?</p>
<p>default value is <code>false</code></p>
<h3 id="haproxy_reload"><code>haproxy_reload</code></h3>
<p>name: <code>haproxy_reload</code>, type: <code>bool</code>, level: <code>A</code></p>
<p>reload haproxy after config?</p>
<p>default value is <code>true</code>, it will reload haproxy after config change.</p>
<p>If you wish to check before apply, you can turn off this with cli args and check it.</p>
<h3 id="haproxy_auth_enabled"><code>haproxy_auth_enabled</code></h3>
<p>name: <code>haproxy_auth_enabled</code>, type: <code>bool</code>, level: <code>G</code></p>
<p>enable authentication for haproxy admin page</p>
<p>default value is <code>true</code>, which will require a http basic auth for admin page.</p>
<p>disable it is not recommended, since your traffic control will be exposed</p>
<h3 id="haproxy_admin_username"><code>haproxy_admin_username</code></h3>
<p>name: <code>haproxy_admin_username</code>, type: <code>username</code>, level: <code>G</code></p>
<p>haproxy admin username, <code>admin</code> by default</p>
<h3 id="haproxy_admin_password"><code>haproxy_admin_password</code></h3>
<p>name: <code>haproxy_admin_password</code>, type: <code>password</code>, level: <code>G</code></p>
<p>haproxy admin password, <code>pigsty</code> by default</p>
<blockquote>
<p>PLEASE CHANGE IT IN YOUR PRODUCTION ENVIRONMENT!</p>
</blockquote>
<h3 id="haproxy_exporter_port"><code>haproxy_exporter_port</code></h3>
<p>name: <code>haproxy_exporter_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>haproxy admin/exporter port, <code>9101</code> by default</p>
<h3 id="haproxy_client_timeout"><code>haproxy_client_timeout</code></h3>
<p>name: <code>haproxy_client_timeout</code>, type: <code>interval</code>, level: <code>C</code></p>
<p>client side connection timeout, <code>24h</code> by default</p>
<h3 id="haproxy_server_timeout"><code>haproxy_server_timeout</code></h3>
<p>name: <code>haproxy_server_timeout</code>, type: <code>interval</code>, level: <code>C</code></p>
<p>server side connection timeout, <code>24h</code> by default</p>
<h3 id="haproxy_services"><code>haproxy_services</code></h3>
<p>name: <code>haproxy_services</code>, type: <code>service[]</code>, level: <code>C</code></p>
<p>list of haproxy service to be exposed on node, default values: <code>[]</code></p>
<p>Each element is a service definition, here is an ad hoc haproxy service example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">haproxy_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># list of haproxy service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># expose pg-test read only replicas</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-test-ro               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># [REQUIRED] service name, unique</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5440</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># [REQUIRED] service port, unique</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] service listen addr, &#34;*&#34; by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">protocol</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tcp                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] service protocol, &#39;tcp&#39; by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">balance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">leastconn             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] load balance algorithm, roundrobin by default (or leastconn)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">maxconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">20000</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] max allowed front-end connection, 20000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;inter 3s fastinter 1s downinter 5s rise 3 fall 3 on-marked-down shutdown-sessions slowstart 30s maxconn 3000 maxqueue 128 weight 100&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">option httpchk</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">option http-keep-alive</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">http-check send meth OPTIONS uri /read-only</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">http-check expect status 200</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg-test-1 ,ip: 10.10.10.11 , port: 5432 , options: check port 8008 , backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg-test-2 ,ip: 10.10.10.12 , port: 5432 , options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">check port 8008 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg-test-3 ,ip: 10.10.10.13 , port: 5432 , options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">check port 8008 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>It will be rendered to <code>/etc/haproxy/&lt;service.name&gt;.cfg</code> and take effect after reload.</p>
<hr>
<h2 id="node_exporter"><code>NODE_EXPORTER</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">node_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># setup node_exporter on this node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9100</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># node exporter listen port, 9100 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--no-collector.softnet --no-collector.nvme --collector.tcpstat --collector.processes&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="node_exporter_enabled"><code>node_exporter_enabled</code></h3>
<p>name: <code>node_exporter_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>setup node_exporter on this node? default value is <code>true</code></p>
<h3 id="node_exporter_port"><code>node_exporter_port</code></h3>
<p>name: <code>node_exporter_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>node exporter listen port, <code>9100</code> by default</p>
<h3 id="node_exporter_options"><code>node_exporter_options</code></h3>
<p>name: <code>node_exporter_options</code>, type: <code>arg</code>, level: <code>C</code></p>
<p>extra server options for node_exporter, default value: <code>--no-collector.softnet --no-collector.nvme --collector.tcpstat --collector.processes</code></p>
<p>Pigsty enables <code>tcpstat</code>, <code>processes</code> collectors and and disable  <code>nvme</code>, <code>softnet</code> metrics collectors by default.</p>
<hr>
<h2 id="promtail"><code>PROMTAIL</code></h2>
<p>Promtail will collect logs from other modules, and send them to <a href="/docs/reference/param/#loki"><code>LOKI</code></a></p>
<ul>
<li>
<p><code>INFRA</code>: Infra logs, collected only on infra nodes.</p>
<ul>
<li><code>nginx-access</code>: <code>/var/log/nginx/access.log</code></li>
<li><code>nginx-error</code>: <code>/var/log/nginx/error.log</code></li>
<li><code>grafana</code>: <code>/var/log/grafana/grafana.log</code></li>
</ul>
</li>
<li>
<p><code>NODES</code>: Host node logs, collected on all nodes.</p>
<ul>
<li><code>syslog</code>: <code>/var/log/messages</code></li>
<li><code>dmesg</code>: <code>/var/log/dmesg</code></li>
<li><code>cron</code>: <code>/var/log/cron</code></li>
</ul>
</li>
<li>
<p><code>PGSQL</code>: PostgreSQL logs, collected when a node is defined with <code>pg_cluster</code>.</p>
<ul>
<li><code>postgres</code>: <code>/pg/log/postgres/*</code></li>
<li><code>patroni</code>: <code>/pg/log/patroni.log</code></li>
<li><code>pgbouncer</code>: <code>/pg/log/pgbouncer/pgbouncer.log</code></li>
<li><code>pgbackrest</code>: <code>/pg/log/pgbackrest/*.log</code></li>
</ul>
</li>
<li>
<p><code>REDIS</code>: Redis logs, collected when a node is defined with <code>redis_cluster</code>.</p>
<ul>
<li><code>redis</code>: <code>/var/log/redis/*.log</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>Log directory are customizable according to <a href="/docs/reference/param/#pg_log_dir"><code>pg_log_dir</code></a>, <a href="/docs/reference/param/#patroni_log_dir"><code>patroni_log_dir</code></a>, <a href="/docs/reference/param/#pgbouncer_log_dir"><code>pgbouncer_log_dir</code></a>, <a href="/docs/reference/param/#pgbackrest_log_dir"><code>pgbackrest_log_dir</code></a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">promtail_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># enable promtail logging collector?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">promtail_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># purge existing promtail status file during init?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">promtail_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9080</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># promtail listen port, 9080 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">promtail_positions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/var/log/positions.yaml</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># promtail position status file path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="promtail_enabled"><code>promtail_enabled</code></h3>
<p>name: <code>promtail_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable promtail logging collector?</p>
<p>default value is <code>true</code></p>
<h3 id="promtail_clean"><code>promtail_clean</code></h3>
<p>name: <code>promtail_clean</code>, type: <code>bool</code>, level: <code>G/A</code></p>
<p>purge existing promtail status file during init?</p>
<p>default value is <code>false</code>, if you choose to clean, Pigsty will remove the existing state file defined by <a href="/docs/reference/param/#promtail_positions"><code>promtail_positions</code></a>
which means that Promtail will recollect all logs on the current node and send them to Loki again.</p>
<h3 id="promtail_port"><code>promtail_port</code></h3>
<p>name: <code>promtail_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>promtail listen port, 9080 by default</p>
<p>default values: <code>9080</code></p>
<h3 id="promtail_positions"><code>promtail_positions</code></h3>
<p>name: <code>promtail_positions</code>, type: <code>path</code>, level: <code>C</code></p>
<p>promtail position status file path</p>
<p>default values: <code>/var/log/positions.yaml</code></p>
<p>Promtail records the consumption offsets of all logs, which are periodically written to the file specified by <a href="/docs/reference/param/#promtail_positions"><code>promtail_positions</code></a>.</p>
<hr>
<h1 id="docker"><code>DOCKER</code></h1>
<p>You can install docker on nodes with <a href="https://github.com/Vonng/pigsty/blob/main/docker.yml"><code>docker.yml</code></a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">docker_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># enable docker on this node?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">docker_cgroups_driver: systemd    # docker cgroup fs driver</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cgroupfs,systemd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">docker_registry_mirrors</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># docker registry mirror list</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">docker_image</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># docker image to be pulled after bootstrap</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">docker_image_cache</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/tmp/docker/*.tgz</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># docker image cache file/glob, `/tmp/docker/*.tgz` by default </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="docker_enabled"><code>docker_enabled</code></h3>
<p>name: <code>docker_enabled</code>, type: <code>bool</code>, level: <code>G/C/I</code></p>
<p>enable docker on this node? default value is <code>false</code></p>
<h3 id="docker_cgroups_driver"><code>docker_cgroups_driver</code></h3>
<p>name: <code>docker_cgroups_driver</code>, type: <code>enum</code>, level: <code>G/C/I</code></p>
<p>docker cgroup fs driver, could be <code>cgroupfs</code> or <code>systemd</code>, default values: <code>systemd</code></p>
<h3 id="docker_registry_mirrors"><code>docker_registry_mirrors</code></h3>
<p>name: <code>docker_registry_mirrors</code>, type: <code>string[]</code>, level: <code>G/C/I</code></p>
<p>docker registry mirror list, default values: <code>[]</code>, Example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://mirror.ccs.tencentyun.com&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># tencent cloud mirror, intranet only</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;https://registry.cn-hangzhou.aliyuncs.com&#34;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># aliyun cloud mirror, login required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="docker_image"><code>docker_image</code></h3>
<p>name: <code>docker_image</code>, type: <code>string[]</code>, level: <code>G/C/I</code></p>
<p>docker image to be pulled, <code>[]</code> by default</p>
<p>Image listed here will be pulled during docker provisioning.</p>
<h3 id="docker_image_cache"><code>docker_image_cache</code></h3>
<p>name: <code>docker_image_cache</code>, type: <code>path</code>, level: <code>G/C/I</code></p>
<p>docker image cache tarball glob list, <code>&quot;/tmp/docker/*.tgz&quot;</code> by default.</p>
<p>The local docker image cache with <code>.tgz</code> suffix match this glob list will be loaded into docker one by one:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat *.tgz <span style="color:#000;font-weight:bold">|</span> gzip -d -c - <span style="color:#000;font-weight:bold">|</span> docker load
</span></span></code></pre></div><hr>
<h1 id="etcd"><code>ETCD</code></h1>
<p><a href="/docs/etcd/"><strong><code>ETCD</code></strong></a> is a distributed, reliable key-value store for the most critical data of a distributed system,
and pigsty use <strong>etcd</strong> as <strong>DCS</strong>, Which is critical to PostgreSQL High-Availability.</p>
<p>Pigsty has a hard coded group name <code>etcd</code> for etcd cluster, it can be an existing &amp; external etcd cluster, or a new etcd cluster created by Pigsty with  <a href="/docs/etcd/#etcdyml">etcd.yml</a>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#etcd_seq: 1                      # etcd instance identifier, explicitly required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#etcd_cluster: etcd               # etcd cluster &amp; group name, etcd by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># prevent purging running etcd instance?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># purging existing etcd during initialization?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/etcd            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># etcd data directory, /data/etcd by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2379</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># etcd client port, 2379 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_peer_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2380</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># etcd peer port, 2380 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_init</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">new                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># etcd initial cluster state, new or existing</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_election_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1000</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># etcd election timeout, 1000ms by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">etcd_heartbeat_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># etcd heartbeat interval, 100ms by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="etcd_seq"><code>etcd_seq</code></h3>
<p>name: <code>etcd_seq</code>, type: <code>int</code>, level: <code>I</code></p>
<p>etcd instance identifier, REQUIRED</p>
<p>no default value, you have to specify it explicitly. Here is a 3-node etcd cluster example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">etcd</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dcs service for postgres/patroni ha consensus</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># 1 node for testing, 3 or 5 for production</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># etcd_seq required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># assign from 1 ~ n</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># odd number please</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># cluster level parameter override roles/etcd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">etcd_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">etcd </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># mark etcd cluster name etcd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">etcd_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># safeguard against purging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">etcd_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># purge etcd during init process</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="etcd_cluster"><code>etcd_cluster</code></h3>
<p>name: <code>etcd_cluster</code>, type: <code>string</code>, level: <code>C</code></p>
<p>etcd cluster &amp; group name, etcd by default</p>
<p>default values: <code>etcd</code>, which is a fixed group name, can be useful when you want to use deployed some extra etcd clusters</p>
<h3 id="etcd_safeguard"><code>etcd_safeguard</code></h3>
<p>name: <code>etcd_safeguard</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>prevent purging running etcd instance? default value is <code>false</code></p>
<p>If enabled, running etcd instance will not be purged by <a href="/docs/etcd/#etcdyml">etcd.yml</a> playbook.</p>
<h3 id="etcd_clean"><code>etcd_clean</code></h3>
<p>name: <code>etcd_clean</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>purging existing etcd during initialization? default value is <code>true</code></p>
<p>If enabled, running etcd instance will be purged by <a href="/docs/etcd/#etcdyml">etcd.yml</a> playbook, which makes the playbook fully idempotent.</p>
<p>But if <a href="/docs/reference/param/#etcd_safeguard"><code>etcd_safeguard</code></a> is enabled, it will still abort on any running etcd instance.</p>
<h3 id="etcd_data"><code>etcd_data</code></h3>
<p>name: <code>etcd_data</code>, type: <code>path</code>, level: <code>C</code></p>
<p>etcd data directory, <code>/data/etcd</code> by default</p>
<h3 id="etcd_port"><code>etcd_port</code></h3>
<p>name: <code>etcd_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>etcd client port, <code>2379</code> by default</p>
<h3 id="etcd_peer_port"><code>etcd_peer_port</code></h3>
<p>name: <code>etcd_peer_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>etcd peer port, <code>2380</code> by default</p>
<h3 id="etcd_init"><code>etcd_init</code></h3>
<p>name: <code>etcd_init</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>etcd initial cluster state, <code>new</code> or <code>existing</code></p>
<p>default values: <code>new</code>, which will create a standalone new etcd cluster.</p>
<p>The value <code>existing</code> is used when trying to <a href="/docs/etcd/#add-member">add new member</a> to existing etcd cluster.</p>
<h3 id="etcd_election_timeout"><code>etcd_election_timeout</code></h3>
<p>name: <code>etcd_election_timeout</code>, type: <code>int</code>, level: <code>C</code></p>
<p>etcd election timeout, <code>1000</code> (ms) by default</p>
<h3 id="etcd_heartbeat_interval"><code>etcd_heartbeat_interval</code></h3>
<p>name: <code>etcd_heartbeat_interval</code>, type: <code>int</code>, level: <code>C</code></p>
<p>etcd heartbeat interval, <code>100</code> (ms) by default</p>
<hr>
<h1 id="minio"><code>MINIO</code></h1>
<p>Minio is a S3 compatible object storage service. Which is used as an optional central backup storage repo for PostgreSQL.</p>
<p>But you can use it for other purpose, such as storing large files, document, pictures &amp; videos.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#minio_seq: 1                     # minio instance identifier, REQUIRED</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio cluster name, minio by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># cleanup minio during init?, false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio os user, `minio` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_node</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${minio_cluster}-${minio_seq}.pigsty&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio node name pattern</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;/data/minio&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># minio data dir(s), use {x...y} to specify multi drivers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss.pigsty         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio external domain name, `sss.pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9000</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># minio service port, 9000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_admin_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9001</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio console port, 9001 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_access_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minioadmin     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># root access key, `minioadmin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_secret_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minioadmin     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># root secret key, `minioadmin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_extra_vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># extra environment variables</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_alias</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># alias name for local minio deployment</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_buckets</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql }, { name: infra },  { name: redis } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">minio_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: dba , secret_key: S3User.DBA, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consoleAdmin }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: pgbackrest , secret_key: S3User.Backup, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="minio_seq"><code>minio_seq</code></h3>
<p>name: <code>minio_seq</code>, type: <code>int</code>, level: <code>I</code></p>
<p>minio instance identifier, REQUIRED identity parameters. no default value, you have to assign it manually</p>
<h3 id="minio_cluster"><code>minio_cluster</code></h3>
<p>name: <code>minio_cluster</code>, type: <code>string</code>, level: <code>C</code></p>
<p>minio cluster name, <code>minio</code> by default. This is useful when deploying multiple MinIO clusters</p>
<h3 id="minio_clean"><code>minio_clean</code></h3>
<p>name: <code>minio_clean</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>cleanup minio during init?, <code>false</code> by default</p>
<h3 id="minio_user"><code>minio_user</code></h3>
<p>name: <code>minio_user</code>, type: <code>username</code>, level: <code>C</code></p>
<p>minio os user name, <code>minio</code> by default</p>
<h3 id="minio_node"><code>minio_node</code></h3>
<p>name: <code>minio_node</code>, type: <code>string</code>, level: <code>C</code></p>
<p>minio node name pattern, this is used for <a href="/docs/minio/#multi-node-multi-drive">multi-node</a> deployment</p>
<p>default values: <code>${minio_cluster}-${minio_seq}.pigsty</code></p>
<h3 id="minio_data"><code>minio_data</code></h3>
<p>name: <code>minio_data</code>, type: <code>path</code>, level: <code>C</code></p>
<p>minio data dir(s)</p>
<p>default values: <code>/data/minio</code>, which is a common dir for <a href="/docs/minio/#single-node-single-drive">single-node</a> deployment.</p>
<p>For a <a href="/docs/minio/#single-node-multi-drive">multi-drive</a> deployment, you can use <code>{x...y}</code> notion to specify multi drivers.</p>
<h3 id="minio_domain"><code>minio_domain</code></h3>
<p>name: <code>minio_domain</code>, type: <code>string</code>, level: <code>G</code></p>
<p>minio service domain name, <code>sss.pigsty</code> by default.</p>
<p>The client can access minio S3 service via this domain name. This name will be registered to local DNSMASQ and included in SSL certs.</p>
<h3 id="minio_port"><code>minio_port</code></h3>
<p>name: <code>minio_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>minio service port, <code>9000</code> by default</p>
<h3 id="minio_admin_port"><code>minio_admin_port</code></h3>
<p>name: <code>minio_admin_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>minio console port, <code>9001</code> by default</p>
<h3 id="minio_access_key"><code>minio_access_key</code></h3>
<p>name: <code>minio_access_key</code>, type: <code>username</code>, level: <code>C</code></p>
<p>root access key, <code>minioadmin</code> by default</p>
<h3 id="minio_secret_key"><code>minio_secret_key</code></h3>
<p>name: <code>minio_secret_key</code>, type: <code>password</code>, level: <code>C</code></p>
<p>root secret key, <code>minioadmin</code> by default</p>
<p>default values: <code>minioadmin</code></p>
<blockquote>
<p><strong>PLEASE CHANGE THIS IN YOUR DEPLOYMENT</strong></p>
</blockquote>
<h3 id="minio_extra_vars"><code>minio_extra_vars</code></h3>
<p>name: <code>minio_extra_vars</code>, type: <code>string</code>, level: <code>C</code></p>
<p>extra environment variables for minio server. Check <a href="https://min.io/docs/minio/linux/reference/minio-server/minio-server.html">Minio Server</a> for the complete list.</p>
<p>default value is empty string, you can use multiline string to passing multiple environment variables.</p>
<h3 id="minio_alias"><code>minio_alias</code></h3>
<p>name: <code>minio_alias</code>, type: <code>string</code>, level: <code>G</code></p>
<p>MinIO alias name for the local MinIO cluster</p>
<p>default values: <code>sss</code>, which will be written to infra nodes&rsquo; / admin users&rsquo; client alias profile.</p>
<h3 id="minio_buckets"><code>minio_buckets</code></h3>
<p>name: <code>minio_buckets</code>, type: <code>bucket[]</code>, level: <code>C</code></p>
<p>list of minio bucket to be created by default:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">minio_buckets</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql }, { name: infra },  { name: redis } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Three default buckets are created for module <a href="/docs/pgsql/"><code>PGSQL</code></a>, <a href="/docs/infra/"><code>INFRA</code></a>, and <a href="/docs/redis/"><code>REDIS</code></a></p>
<h3 id="minio_users"><code>minio_users</code></h3>
<p>name: <code>minio_users</code>, type: <code>user[]</code>, level: <code>C</code></p>
<p>list of minio user to be created, default value:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">minio_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: dba , secret_key: S3User.DBA, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consoleAdmin }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: pgbackrest , secret_key: S3User.Backup, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Two default users are created for PostgreSQL DBA and pgBackREST.</p>
<blockquote>
<p>PLEASE ADJUST THESE USERS &amp; CREDENTIALS IN YOUR DEPLOYMENT!</p>
</blockquote>
<hr>
<h1 id="redis"><code>REDIS</code></h1>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#redis_cluster:        &lt;CLUSTER&gt; # redis cluster name, required identity parameter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#redis_node: 1            &lt;NODE&gt; # redis node sequence number, node int id required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#redis_instances: {}      &lt;NODE&gt; # redis instances definition on this redis node</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_fs_main</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># redis main data mountpoint, `/data` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># install redis exporter on redis nodes?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9121</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># redis exporter listen port, 9121 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># cli args and extra options for redis exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># prevent purging running redis instance?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># purging existing redis during init?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_rmdata</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># remove redis data when purging redis server?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_mode: standalone            # redis mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">standalone,cluster,sentinel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_conf</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">redis.conf           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># redis config template path, except sentinel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_bind_address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;0.0.0.0&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#8f5902;font-style:italic"># redis bind address, empty string will use host ip</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_max_memory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1GB            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># max memory used by each redis instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_mem_policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allkeys-lru    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># redis memory eviction policy</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># redis password, empty string will disable password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_rdb_save</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;1200 1&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># redis rdb save directives, disable with empty list</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_aof_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># enable redis append only file?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_rename_commands</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># rename redis dangerous commands</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_cluster_replicas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># replica number for one master in redis cluster</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis_sentinel_monitor</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># sentinel master list, works on sentinel cluster only</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="redis_cluster"><code>redis_cluster</code></h3>
<p>name: <code>redis_cluster</code>, type: <code>string</code>, level: <code>C</code></p>
<p>redis cluster name, required identity parameter.</p>
<p>no default value, you have to define it explicitly.</p>
<p>Comply with regexp <code>[a-z][a-z0-9-]*</code>, it is recommended to use the same name as the group name and start with <code>redis-</code></p>
<h3 id="redis_node"><code>redis_node</code></h3>
<p>name: <code>redis_node</code>, type: <code>int</code>, level: <code>I</code></p>
<p>redis node sequence number,  unique integer among redis cluster is required</p>
<p>You have to explicitly define the node id for each redis node. integer start from 0 or 1.</p>
<h3 id="redis_instances"><code>redis_instances</code></h3>
<p>name: <code>redis_instances</code>, type: <code>dict</code>, level: <code>I</code></p>
<p>redis instances definition on this redis node</p>
<p>no default value, you have to define redis instances on each redis node using this parameter explicitly.</p>
<p>Here is an example for a native redis cluster definition</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">redis-test: # redis native cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">3m x 3s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">redis_node: 1 ,redis_instances</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">6379</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">} ,6380</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">} ,6381</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">redis_node: 2 ,redis_instances</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">6379</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">} ,6380</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">} ,6381</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">redis_cluster: redis-test ,redis_password: &#39;redis.test&#39; ,redis_mode: cluster, redis_max_memory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">32MB }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>The port number should be unique among the <strong>node</strong>, and the <code>replica_of</code> in <code>value</code> should be instance member of the same redis <strong>cluster</strong>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">redis_instances</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">6379</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">6380</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">replica_of</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;10.10.10.13 6379&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">6381</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">replica_of</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;10.10.10.13 6379&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="redis_fs_main"><code>redis_fs_main</code></h3>
<p>name: <code>redis_fs_main</code>, type: <code>path</code>, level: <code>C</code></p>
<p>redis main data mountpoint, <code>/data</code> by default</p>
<p>default values: <code>/data</code>, and <code>/data/redis</code> will be used as the redis data directory.</p>
<h3 id="redis_exporter_enabled"><code>redis_exporter_enabled</code></h3>
<p>name: <code>redis_exporter_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>install redis exporter on redis nodes?</p>
<p>default value is <code>true</code>, which will launch a redis_exporter on this redis_node</p>
<h3 id="redis_exporter_port"><code>redis_exporter_port</code></h3>
<p>name: <code>redis_exporter_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>redis exporter listen port, 9121 by default</p>
<p>default values: <code>9121</code></p>
<h3 id="redis_exporter_options"><code>redis_exporter_options</code></h3>
<p>name: <code>redis_exporter_options</code>, type: <code>string</code>, level: <code>C/I</code></p>
<p>cli args and extra options for redis exporter, will be added to <code>/etc/defaut/redis_exporter</code>.</p>
<p>default value is empty string</p>
<h3 id="redis_safeguard"><code>redis_safeguard</code></h3>
<p>name: <code>redis_safeguard</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>prevent purging running redis instance?</p>
<p>default value is <code>false</code>, if set to <code>true</code>, and redis instance is running, init / remove playbook will abort immediately.</p>
<h3 id="redis_clean"><code>redis_clean</code></h3>
<p>name: <code>redis_clean</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>purging existing redis during init?</p>
<p>default value is <code>true</code>, which will remove redis server during redis init or remove.</p>
<h3 id="redis_rmdata"><code>redis_rmdata</code></h3>
<p>name: <code>redis_rmdata</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>remove redis data when purging redis server?</p>
<p>default value is <code>true</code>, which will remove redis rdb / aof along with redis instance.</p>
<h3 id="redis_mode"><code>redis_mode</code></h3>
<p>name: <code>redis_mode</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>redis mode: standalone,cluster,sentinel</p>
<p>default values: <code>standalone</code></p>
<ul>
<li><code>standalone</code>: setup redis as standalone (master-slave) mode</li>
<li><code>cluster</code>: setup this redis cluster as a redis native cluster</li>
<li><code>sentinel</code>: setup redis as sentinel for standalone redis HA</li>
</ul>
<h3 id="redis_conf"><code>redis_conf</code></h3>
<p>name: <code>redis_conf</code>, type: <code>string</code>, level: <code>C</code></p>
<p>redis config template path, except sentinel</p>
<p>default values: <code>redis.conf</code>, which is a template file in <a href="https://github.com/Vonng/pigsty/blob/main/roles/redis/templates/redis.conf"><code>roles/redis/templates/redis.conf</code></a>.</p>
<p>If you want to use your own redis config template, you can put it in <code>templates/</code> directory and set this parameter to the template file name.</p>
<p>Note that redis sentinel are using a different template file, which is <a href="https://github.com/Vonng/pigsty/blob/main/roles/redis/templates/redis-sentinel.conf"><code>roles/redis/templates/redis-sentinel.conf</code></a></p>
<h3 id="redis_bind_address"><code>redis_bind_address</code></h3>
<p>name: <code>redis_bind_address</code>, type: <code>ip</code>, level: <code>C</code></p>
<p>redis bind address, empty string will use inventory hostname</p>
<p>default values: <code>0.0.0.0</code>, which will bind to all available IPv4 address on this host</p>
<blockquote>
<p>PLEASE bind to intranet IP only in production environment, i.e. set this value to <code>''</code></p>
</blockquote>
<h3 id="redis_max_memory"><code>redis_max_memory</code></h3>
<p>name: <code>redis_max_memory</code>, type: <code>size</code>, level: <code>C/I</code></p>
<p>max memory used by each redis instance, default values: <code>1GB</code></p>
<h3 id="redis_mem_policy"><code>redis_mem_policy</code></h3>
<p>name: <code>redis_mem_policy</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>redis memory eviction policy</p>
<p>default values: <code>allkeys-lru</code>, check redis <a href="https://redis.io/docs/reference/eviction/">eviction policy</a> for more details</p>
<ul>
<li><code>noeviction</code>: New values aren’t saved when memory limit is reached. When a database uses replication, this applies to the primary database</li>
<li><code>allkeys-lru</code>: Keeps most recently used keys; removes least recently used (LRU) keys</li>
<li><code>allkeys-lfu</code>: Keeps frequently used keys; removes least frequently used (LFU) keys</li>
<li><code>volatile-lru</code>: Removes least recently used keys with the expire field set to true.</li>
<li><code>volatile-lfu</code>: Removes least frequently used keys with the expire field set to true.</li>
<li><code>allkeys-random</code>: Randomly removes keys to make space for the new data added.</li>
<li><code>volatile-random</code>: Randomly removes keys with expire field set to true.</li>
<li><code>volatile-ttl</code>: Removes keys with expire field set to true and the shortest remaining time-to-live (TTL) value.</li>
</ul>
<h3 id="redis_password"><code>redis_password</code></h3>
<p>name: <code>redis_password</code>, type: <code>password</code>, level: <code>C/N</code></p>
<p>redis password, empty string will disable password, which is the default behavior</p>
<p>Note that due to the implementation limitation of redis_exporter, you can only set one <code>redis_password</code> per node.
This is usually not a problem, because pigsty does not allow deploying two different redis cluster on the same node.</p>
<blockquote>
<p>PLEASE use a strong password in production environment</p>
</blockquote>
<h3 id="redis_rdb_save"><code>redis_rdb_save</code></h3>
<p>name: <code>redis_rdb_save</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>redis rdb save directives, disable with empty list, check redis <a href="https://redis.io/docs/management/persistence/">persist</a> for details.</p>
<p>the default value is  <code>[&quot;1200 1&quot;]</code>: dump the dataset to disk every 20 minutes if at least 1 key changed:</p>
<h3 id="redis_aof_enabled"><code>redis_aof_enabled</code></h3>
<p>name: <code>redis_aof_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable redis append only file? default value is <code>false</code>.</p>
<h3 id="redis_rename_commands"><code>redis_rename_commands</code></h3>
<p>name: <code>redis_rename_commands</code>, type: <code>dict</code>, level: <code>C</code></p>
<p>rename redis dangerous commands, which is a dict of k:v <code>old: new</code></p>
<p>default values: <code>{}</code>, you can hide dangerous commands like <code>FLUSHDB</code> and <code>FLUSHALL</code> by setting this value, here&rsquo;s an example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>{<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">&#34;keys&#34;: </span><span style="color:#4e9a06">&#34;op_keys&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">&#34;flushdb&#34;: </span><span style="color:#4e9a06">&#34;op_flushdb&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">&#34;flushall&#34;: </span><span style="color:#4e9a06">&#34;op_flushall&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">&#34;config&#34;: </span><span style="color:#4e9a06">&#34;op_config&#34;</span><span style="color:#f8f8f8;text-decoration:underline">  
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="redis_cluster_replicas"><code>redis_cluster_replicas</code></h3>
<p>name: <code>redis_cluster_replicas</code>, type: <code>int</code>, level: <code>C</code></p>
<p>replica number for one master/primary in redis cluster, default values: <code>1</code></p>
<h3 id="redis_sentinel_monitor"><code>redis_sentinel_monitor</code></h3>
<p>name: <code>redis_sentinel_monitor</code>, type: <code>master[]</code>, level: <code>C</code></p>
<p>This can only be used when <a href="/docs/reference/param/#redis_mode"><code>redis_mode</code></a> is set to <code>sentinel</code>.</p>
<p>List of redis master to be monitored by this sentinel cluster. each master is defined as a dict with <code>name</code>, <code>host</code>, <code>port</code>, <code>password</code>, <code>quorum</code> keys.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">redis_sentinel_monitor</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># primary list for redis sentinel, use cls as name, primary ip:port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: redis-src, host: 10.10.10.45, port: 6379 ,password: redis.src, quorum</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: redis-dst, host: 10.10.10.48, port: 6379 ,password: redis.dst, quorum</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>The <code>name</code> and <code>host</code> are mandatory, <code>port</code>, <code>password</code>, <code>quorum</code> are optional, <code>quorum</code> is used to set the quorum for this master, usually large than half of the sentinel instances.</p>
<hr>
<h1 id="pgsql"><code>PGSQL</code></h1>
<p><a href="/docs/pgsql/"><code>PGSQL</code></a> module requires <a href="/docs/node/"><code>NODE</code></a> module to be installed, and you also need a viable <a href="/docs/etcd/"><code>ETCD</code></a> cluster to store cluster meta data.</p>
<p>Install <code>PGSQL</code> module on a single node will create a <a href="/docs/pgsql/config/#primary">primary</a> instance which a standalone PGSQL server/instance.
Install it on additional nodes will create <a href="/docs/pgsql/config/#replica">replicas</a>, which can be used for serving read-only traffics, or use as standby backup.
You can also create <a href="/docs/pgsql/config/#offline">offline</a> instance of ETL/OLAP/Interactive queries,
use <a href="/docs/pgsql/config/#sync-standby">Sync Standby</a> and <a href="/docs/pgsql/config/#quorum-commit">Quorum Commit</a> to increase data consistency,
or even form a <a href="/docs/pgsql/config/#standby-cluster">standby cluster</a> and <a href="/docs/pgsql/config/#delayed-cluster">delayed standby cluster</a> for disaster recovery.</p>
<p>You can define multiple PGSQL clusters and form a horizontal sharding cluster, which is a group of PGSQL clusters running on different nodes.
Pigsty has native <a href="/docs/pgsql/config/#citus-cluster">citus cluster group</a> support, which can extend your PGSQL cluster to a distributed database sharding cluster.</p>
<hr>
<h2 id="pg_id"><code>PG_ID</code></h2>
<p>Here are some common parameters used to identify PGSQL <a href="/docs/concept/model/er-diagram">entities</a>: instance, service, etc&hellip;</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># pg_cluster:           #CLUSTER  # pgsql cluster name, required identity parameter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_seq: 0             #INSTANCE # pgsql instance seq number, required identity parameter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_role: replica      #INSTANCE # pgsql role, required, could be primary,replica,offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_instances: {}      #INSTANCE # define multiple pg instances on node in `{port:ins_vars}` format</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_upstream:          #INSTANCE # repl upstream ip addr for standby cluster or cascade replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_shard:             #CLUSTER  # pgsql shard name, optional identity for sharding clusters</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pg_group: 0           #CLUSTER  # pgsql shard index number, optional identity for sharding clusters</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># gp_role: master       #CLUSTER  # greenplum role of this cluster, could be master or segment</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_offline_query</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#INSTANCE # set to true to enable offline query on this instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>You have to assign these <strong>identity parameters</strong> explicitly, there&rsquo;s no default value for them.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Name</th>
<th style="text-align:center">Type</th>
<th style="text-align:center">Level</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a></td>
<td style="text-align:center"><code>string</code></td>
<td style="text-align:center"><strong>C</strong></td>
<td><strong>PG database cluster name</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/docs/reference/param/#pg_seq"><code>pg_seq</code></a></td>
<td style="text-align:center"><code>number</code></td>
<td style="text-align:center"><strong>I</strong></td>
<td><strong>PG database instance id</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/docs/reference/param/#pg_role"><code>pg_role</code></a></td>
<td style="text-align:center"><code>enum</code></td>
<td style="text-align:center"><strong>I</strong></td>
<td><strong>PG database instance role</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/docs/reference/param/#pg_shard"><code>pg_shard</code></a></td>
<td style="text-align:center"><code>string</code></td>
<td style="text-align:center"><strong>C</strong></td>
<td><strong>PG database shard name of cluster</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="/docs/reference/param/#pg_group"><code>pg_group</code></a></td>
<td style="text-align:center"><code>number</code></td>
<td style="text-align:center"><strong>C</strong></td>
<td><strong>PG database shard index of cluster</strong></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a>: It identifies the name of the cluster, which is configured at the cluster level.</li>
<li><a href="/docs/reference/param/#pg_role"><code>pg_role</code></a>: Configured at the instance level, identifies the role of the ins. Only the <code>primary</code> role will be handled specially. If not filled in, the default is the <code>replica</code> role and the special <code>delayed</code> and <code>offline</code> roles.</li>
<li><a href="/docs/reference/param/#pg_seq"><code>pg_seq</code></a>: Used to identify the ins within the cluster, usually with an integer number incremented from 0 or 1, which is not changed once it is assigned.</li>
<li><code>{{ pg_cluster }}-{{ pg_seq }}</code> is used to uniquely identify the ins, i.e. <code>pg_instance</code>.</li>
<li><code>{{ pg_cluster }}-{{ pg_role }}</code> is used to identify the services within the cluster, i.e. <code>pg_service</code>.</li>
<li><a href="/docs/reference/param/#pg_shard"><code>pg_shard</code></a> and <a href="/docs/reference/param/#pg_group"><code>pg_group</code></a> are used for horizontally sharding clusters, for citus, greenplum, and matrixdb only.</li>
</ul>
<p><a href="/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a>, <a href="/docs/reference/param/#pg_role"><code>pg_role</code></a>, <a href="/docs/reference/param/#pg_seq"><code>pg_seq</code></a> are core <strong>identity params</strong>, which are <strong>required</strong> for any Postgres cluster, and must be explicitly specified. Here&rsquo;s an example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg-test</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 2, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">primary}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 3, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>All other params can be inherited from the global config or the default config, but the identity params must be <strong>explicitly specified</strong> and <strong>manually assigned</strong>.</p>
<h3 id="pg_mode"><code>pg_mode</code></h3>
<p>name: <code>pg_mode</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>pgsql cluster mode, <code>pgsql</code> by default, i.e. standard PostgreSQL cluster.</p>
<ul>
<li><code>pgsql</code>: Standard PostgreSQL cluster, default value.</li>
<li><code>citus</code>: Horizontal sharding cluster with citus extension.</li>
<li><code>mssql</code>: Babelfish MSSQL wire protocol compatible kernel.</li>
<li><code>ivory</code>: IvorySQL Oracle compatible kernel.</li>
<li><code>polar</code>: PolarDB for PostgreSQL kernel.</li>
<li><code>oracle</code>: PolarDB for Oracle kernel.</li>
<li><code>gpsql</code>: Greenplum / Cloudberry</li>
</ul>
<p>If <code>pg_mode</code> is set to <code>citus</code> or <code>gpsql</code>, <a href="/docs/reference/param/#pg_shard"><code>pg_shard</code></a> and <a href="/docs/reference/param/#pg_group"><code>pg_group</code></a> will be required for horizontal sharding clusters.</p>
<h3 id="pg_cluster"><code>pg_cluster</code></h3>
<p>name: <code>pg_cluster</code>, type: <code>string</code>, level: <code>C</code></p>
<p>pgsql cluster name, REQUIRED identity parameter</p>
<p>The cluster name will be used as the namespace for PGSQL related resources within that cluster.</p>
<p>The naming needs to follow the specific naming pattern: <code>[a-z][a-z0-9-]*</code> to be compatible with the requirements of different constraints on the identity.</p>
<h3 id="pg_seq"><code>pg_seq</code></h3>
<p>name: <code>pg_seq</code>, type: <code>int</code>, level: <code>I</code></p>
<p>pgsql instance seq number, REQUIRED identity parameter</p>
<p>A serial number of this instance, unique within its <strong>cluster</strong>, starting from 0 or 1.</p>
<h3 id="pg_role"><code>pg_role</code></h3>
<p>name: <code>pg_role</code>, type: <code>enum</code>, level: <code>I</code></p>
<p>pgsql role, REQUIRED, could be primary,replica,offline</p>
<p>Roles for PGSQL instance, can be: <code>primary</code>, <code>replica</code>, <code>standby</code> or <code>offline</code>.</p>
<ul>
<li><code>primary</code>: Primary, there is one and only one primary in a cluster.</li>
<li><code>replica</code>: Replica for carrying online read-only traffic, there may be a slight replication delay through (10ms~100ms, 100KB).</li>
<li><code>standby</code>: Special replica that is always synced with primary, there&rsquo;s no replication delay &amp; data loss on this replica. (currently same as <code>replica</code>)</li>
<li><code>offline</code>: Offline replica for taking on offline read-only traffic, such as statistical analysis/ETL/personal queries, etc.</li>
</ul>
<p><strong>Identity params, required params, and instance-level params.</strong></p>
<h3 id="pg_instances"><code>pg_instances</code></h3>
<p>name: <code>pg_instances</code>, type: <code>dict</code>, level: <code>I</code></p>
<p>define multiple pg instances on node in <code>{port:ins_vars}</code> format.</p>
<p>This parameter is reserved for multi-instance deployment on a single node which is not implemented in Pigsty yet.</p>
<h3 id="pg_upstream"><code>pg_upstream</code></h3>
<p>name: <code>pg_upstream</code>, type: <code>ip</code>, level: <code>I</code></p>
<p>Upstream ip address for standby cluster or cascade replica</p>
<p>Setting <code>pg_upstream</code> is set on <code>primary</code> instance indicate that this cluster is a <a href="/docs/pgsql/conf#standby-cluster"><strong>Standby Cluster</strong></a>, and will receiving changes from upstream instance, thus the <code>primary</code> is actually a <code>standby leader</code>.</p>
<p>Setting <code>pg_upstream</code> for a non-primary instance will explicitly set a replication upstream instance, if it is different from the primary ip addr, this instance will become a <strong>cascade replica</strong>. And it&rsquo;s user&rsquo;s responsibility to ensure that the upstream IP addr is another instance in the same cluster.</p>
<h3 id="pg_shard"><code>pg_shard</code></h3>
<p>name: <code>pg_shard</code>, type: <code>string</code>, level: <code>C</code></p>
<p>pgsql shard name, required identity parameter for sharding clusters (e.g. citus cluster), optional for common pgsql clusters.</p>
<p>When multiple pgsql clusters serve the same business together in a horizontally sharding style, Pigsty will mark this group of clusters as a <strong>Sharding Group</strong>.</p>
<p><a href="/docs/reference/param/#pg_shard"><code>pg_shard</code></a> is the name of the shard group name. It&rsquo;s usually the prefix of <a href="/docs/reference/param/#pg_cluster"><code>pg_cluster</code></a>.</p>
<p>For example, if we have a sharding group <code>pg-citus</code>, and 4 clusters in it, there identity params will be:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>cls pg_shard: pg-citus
</span></span><span style="display:flex;"><span>cls pg_group = 0:   pg-citus0
</span></span><span style="display:flex;"><span>cls pg_group = 1:   pg-citus1
</span></span><span style="display:flex;"><span>cls pg_group = 2:   pg-citus2
</span></span><span style="display:flex;"><span>cls pg_group = 3:   pg-citus3
</span></span></code></pre></div><h3 id="pg_group"><code>pg_group</code></h3>
<p>name: <code>pg_group</code>, type: <code>int</code>, level: <code>C</code></p>
<p>pgsql shard index number, required identity for sharding clusters, optional for common pgsql clusters.</p>
<p>Sharding cluster index of sharding group, used in pair with <a href="/docs/reference/param/#pg_shard">pg_shard</a>. You can use any non-negative integer as the index number.</p>
<h3 id="gp_role"><code>gp_role</code></h3>
<p>name: <code>gp_role</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>greenplum/matrixdb role of this cluster, could be <code>master</code> or <code>segment</code></p>
<ul>
<li><code>master</code>:  mark the postgres cluster as greenplum master, which is the default value</li>
<li><code>segment</code>  mark the postgres cluster as greenplum segment</li>
</ul>
<p>This parameter is only used for greenplum/matrixdb database, and is ignored for common pgsql cluster.</p>
<h3 id="pg_exporters"><code>pg_exporters</code></h3>
<p>name: <code>pg_exporters</code>, type: <code>dict</code>, level: <code>C</code></p>
<p>additional pg_exporters to monitor remote postgres instances, default values: <code>{}</code></p>
<p>If you wish to monitoring remote postgres instances, define them in <code>pg_exporters</code> and load them with <a href="/docs/pgsql/playbook/#pgsql-monitoryml"><code>pgsql-monitor.yml</code></a> playbook.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_exporters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># list all remote instances here, alloc a unique unused local port as k</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">20001</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_cluster: pg-foo, pg_seq: 1, pg_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.10</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">20004</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_cluster: pg-foo, pg_seq: 2, pg_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.11</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">20002</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_cluster: pg-bar, pg_seq: 1, pg_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.12</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">20003</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_cluster: pg-bar, pg_seq: 1, pg_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.13</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Check <a href="/docs/pgsql/monitor/">PGSQL Monitoring</a> for details.</p>
<h3 id="pg_offline_query"><code>pg_offline_query</code></h3>
<p>name: <code>pg_offline_query</code>, type: <code>bool</code>, level: <code>I</code></p>
<p>set to true to enable offline query on this instance</p>
<p>default value is <code>false</code></p>
<p>When set to <code>true</code>, the user group <code>dbrole_offline</code> can connect to the ins and perform offline queries, regardless of the role of the current instance, just like a <code>offline</code> instance.</p>
<p>If you just have one replica or even one primary in your postgres cluster, adding this could mark it for accepting ETL, slow queries with interactive access.</p>
<hr>
<h2 id="pg_business"><code>PG_BUSINESS</code></h2>
<p>Database credentials, In-Database Objects that need to be taken care of by Users.</p>
<ul>
<li>Define Business Users: <a href="/docs/reference/param/#pg_users"><code>pg_users</code></a></li>
<li>Define Business Databases: <a href="/docs/reference/param/#pg_databases"><code>pg_databases</code></a></li>
<li>Define Cluster Services:  <a href="/docs/reference/param/#pg_services"><code>pg_services</code></a> (Global Definition: <a href="/docs/reference/param/#pg_default_services"><code>pg_default_services</code></a>)</li>
<li>Ad-Hoc PostgreSQL HBA Rules: <a href="/docs/reference/param/#pg_default_services"><code>pg_default_services</code></a></li>
<li>Ad-Hoc Pgbouncer HBA Rules: <a href="/docs/reference/param/#pgb_hba_rules"><code>pgb_hba_rules</code></a></li>
</ul>
<p><a href="/docs/pgsql/acl/#default-users">Default Database Users</a>:</p>
<ul>
<li>Administrator: <a href="/docs/reference/param/#pg_admin_username"><code>pg_admin_username</code></a> / <a href="/docs/reference/param/#pg_admin_password"><code>pg_admin_password</code></a></li>
<li>Replication User: <a href="/docs/reference/param/#pg_replication_username"><code>pg_replication_username</code></a> / <a href="/docs/reference/param/#pg_replication_password"><code>pg_replication_password</code></a></li>
<li>Monitor User: <a href="/docs/reference/param/#pg_monitor_username"><code>pg_monitor_username</code></a> / <a href="/docs/reference/param/#pg_monitor_password"><code>pg_monitor_password</code></a></li>
</ul>
<blockquote>
<p>WARNING: YOU HAVE TO CHANGE THESE DEFAULT <strong>PASSWORD</strong>s in production environment.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># postgres business object definition, overwrite in group vars</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># postgres business users</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># postgres business databases</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># postgres business services</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># business hba rules for postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgb_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># business hba rules for pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># global credentials, overwrite in global vars</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># dbsu password, empty string means no dbsu password by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_replication_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_replication_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_dba</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.DBA</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_monitor_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_monitor_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_users"><code>pg_users</code></h3>
<p>name: <code>pg_users</code>, type: <code>user[]</code>, level: <code>C</code></p>
<p>postgres business users, has to be defined at cluster level.</p>
<p>default values: <code>[]</code>, each object in the array defines a <a href="/docs/pgsql/user/">User/Role</a>. Examples:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_meta              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># REQUIRED, `name` is the only mandatory field of a user definition</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Meta          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, password, can be a scram-sha-256 hash string or plain text</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">login</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, can log in, true by default  (new biz ROLE should be false)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">superuser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># optional, is superuser? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">createdb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, can create database? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># optional, can create role? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">inherit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, can this role use inherited privileges? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">replication</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># optional, can this role do replication? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">bypassrls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># optional, can this role bypass row level security? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, add this user to pgbouncer user-list? false by default (production user should be true explicitly)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, user connection limit, default -1 disable limit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">expire_in</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3650</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, now + n days when this role is expired (OVERWRITE expire_at)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">expire_at</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;2030-12-31&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># optional, YYYY-MM-DD &#39;timestamp&#39; when this role is expired  (OVERWRITTEN by expire_in)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty admin user     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, comment string for this user/role</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">roles: [dbrole_admin]           # optional, belonged roles. default roles are</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_{admin,readonly,readwrite,offline}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># optional, role level parameters with `ALTER ROLE SET`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">transaction         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, pgbouncer pool mode at user level, transaction by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># optional, max database connections at user level, default -1 disable limit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">search_path: public             # key value config parameters according to postgresql documentation (e.g</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">use pigsty as default search_path)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>The only mandatory field of a user definition is <code>name</code>, and the rest are optional.</p>
<h3 id="pg_databases"><code>pg_databases</code></h3>
<p>name: <code>pg_databases</code>, type: <code>database[]</code>, level: <code>C</code></p>
<p>postgres business databases, has to be defined at cluster level.</p>
<p>default values: <code>[]</code>, each object in the array defines a <a href="/docs/pgsql/db/">Database</a>. Examples:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># REQUIRED, `name` is the only mandatory field of a database definition</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">baseline</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cmdb.sql             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database sql baseline path, (relative path among ansible search path, e.g files/)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, add this database to pgbouncer database list? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">pigsty]              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, additional schemas to be created, array of schema names</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">extensions:                     # optional, additional extensions to be installed</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">array of `{name[,schema]}`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgis , schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">timescaledb }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty meta database  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, comment string for this database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">owner</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database owner, postgres by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">template1            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, which template to use, template1 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database encoding, UTF8 by default. (MUST same as template database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database locale, C by default.  (MUST same as template database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">lc_collate</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database collate, C by default. (MUST same as template database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">lc_ctype</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database ctype, C by default.   (MUST same as template database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">tablespace</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_default         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, default tablespace, &#39;pg_default&#39; by default.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">allowconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, allow connection, true by default. false will disable connect at all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">revokeconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># optional, revoke public connection privilege. false by default. (leave connect with grant option to owner)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">register_datasource</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># optional, register this database to grafana datasources? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, database connection limit, default -1 disable limit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_auth_user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_meta    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, all connection to this pgbouncer database will be authenticated by this user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">transaction         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, pgbouncer pool mode at database level, default transaction</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_size</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">64</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, pgbouncer pool size at database level, default 64</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_size_reserve</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">32</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># optional, pgbouncer pool size reserve at database level, default 32</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_size_min</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># optional, pgbouncer pool size min at database level, default 0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">pool_max_db_conn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># optional, max database connections at database level, default 100</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>In each database definition, the DB  <code>name</code> is mandatory and the rest are optional.</p>
<h3 id="pg_services"><code>pg_services</code></h3>
<p>name: <code>pg_services</code>, type: <code>service[]</code>, level: <code>C</code></p>
<p>postgres business services exposed via haproxy, has to be defined at cluster level.</p>
<p>You can define ad hoc services with <a href="/docs/reference/param/#pg_services"><code>pg_services</code></a> in additional to default <a href="/docs/reference/param/#pg_default_services"><code>pg_default_services</code></a></p>
<p>default values: <code>[]</code>, each object in the array defines a <a href="/docs/pgsql/svc/#define-service"><strong>Service</strong></a>. Examples:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">name: standby                   # required, service name, the actual svc name will be prefixed with `pg_cluster`, e.g</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-meta-standby</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5435</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># required, service exposed port (work as kubernetes service node port mode)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># optional, service bind ip address, `*` for all ip by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># required, service member selector, use JMESPath to filter inventory</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">dest</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, destination port, default|postgres|pgbouncer|&lt;port_number&gt;, &#39;default&#39; by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">check</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/sync                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, health check url path, / by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary`]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># backup server selector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">maxconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3000</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, max allowed front-end connection</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">balance: roundrobin             # optional, haproxy load balance algorithm (roundrobin by default, other</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">leastconn)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;inter 3s fastinter 1s downinter 5s rise 3 fall 3 on-marked-down shutdown-sessions slowstart 30s maxconn 3000 maxqueue 128 weight 100&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_hba_rules"><code>pg_hba_rules</code></h3>
<p>name: <code>pg_hba_rules</code>, type: <code>hba[]</code>, level: <code>C</code></p>
<p>business hba rules for postgres</p>
<p>default values: <code>[]</code>, each object in array is an <strong>HBA Rule</strong> definition:</p>
<p>Which are array of <a href="/docs/pgsql/hba/#define-hba">hba</a> object, each hba object may look like</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># RAW HBA RULES</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow intranet password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">host   all  all  10.0.0.0/8      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">host   all  all  172.16.0.0/12   md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">host   all  all  192.168.0.0/16  md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><ul>
<li><code>title</code>: Rule Title, transform into comment in hba file</li>
<li><code>rules</code>: Array of strings, each string is a raw hba rule record</li>
<li><code>role</code>:  Applied roles, where to install these hba rules
<ul>
<li><code>common</code>: apply for all instances</li>
<li><code>primary</code>, <code>replica</code>,<code>standby</code>, <code>offline</code>: apply on corresponding instances with that <a href="/docs/reference/param/#pg_role"><code>pg_role</code></a>.</li>
<li>special case: HBA rule with <code>role == 'offline'</code> will be installed on instance with <a href="/docs/reference/param/#pg_offline_query"><code>pg_offline_query</code></a> flag</li>
</ul>
</li>
</ul>
<p>or you can use another alias form</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#204a87;font-weight:bold">addr</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;intra&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># world|intra|infra|admin|local|localhost|cluster|&lt;cidr&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">auth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># trust|pwd|ssl|cert|deny|&lt;official auth method&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;all&#39;</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># all|${dbsu}|${repl}|${admin}|${monitor}|&lt;user&gt;|&lt;group&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">db</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;all&#39;</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># all|replication|....</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># raw hba string precedence over above all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow intranet password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><a href="/docs/reference/param/#pg_default_hba_rules"><code>pg_default_hba_rules</code></a> is similar to this, but is used for global HBA rule settings</p>
<h3 id="pgb_hba_rules"><code>pgb_hba_rules</code></h3>
<p>name: <code>pgb_hba_rules</code>, type: <code>hba[]</code>, level: <code>C</code></p>
<p>business hba rules for pgbouncer, default values: <code>[]</code></p>
<p>Similar to <a href="/docs/reference/param/#pg_hba_rules"><code>pg_hba_rules</code></a>, array of <a href="/docs/pgsql/hba/#define-hba">hba</a> rule object, except this is for pgbouncer.</p>
<h3 id="pg_replication_username"><code>pg_replication_username</code></h3>
<p>name: <code>pg_replication_username</code>, type: <code>username</code>, level: <code>G</code></p>
<p>postgres replication username, <code>replicator</code> by default</p>
<p>This parameter is globally used, it not wise to change it.</p>
<h3 id="pg_replication_password"><code>pg_replication_password</code></h3>
<p>name: <code>pg_replication_password</code>, type: <code>password</code>, level: <code>G</code></p>
<p>postgres replication password, <code>DBUser.Replicator</code> by default</p>
<blockquote>
<p>WARNING: CHANGE THIS IN PRODUCTION ENVIRONMENT!!!!</p>
</blockquote>
<h3 id="pg_admin_username"><code>pg_admin_username</code></h3>
<p>name: <code>pg_admin_username</code>, type: <code>username</code>, level: <code>G</code></p>
<p>postgres admin username, <code>dbuser_dba</code> by default, which is a global postgres superuser.</p>
<p>default values: <code>dbuser_dba</code></p>
<h3 id="pg_admin_password"><code>pg_admin_password</code></h3>
<p>name: <code>pg_admin_password</code>, type: <code>password</code>, level: <code>G</code></p>
<p>postgres admin password in plain text, <code>DBUser.DBA</code> by default</p>
<blockquote>
<p>WARNING: CHANGE THIS IN PRODUCTION ENVIRONMENT!!!!</p>
</blockquote>
<h3 id="pg_monitor_username"><code>pg_monitor_username</code></h3>
<p>name: <code>pg_monitor_username</code>, type: <code>username</code>, level: <code>G</code></p>
<p>postgres monitor username, <code>dbuser_monitor</code> by default, which is a global monitoring user.</p>
<h3 id="pg_monitor_password"><code>pg_monitor_password</code></h3>
<p>name: <code>pg_monitor_password</code>, type: <code>password</code>, level: <code>G</code></p>
<p>postgres monitor password, <code>DBUser.Monitor</code> by default.</p>
<p>Try not using the <code>@:/</code> character in the password to avoid problems with PGURL string.</p>
<blockquote>
<p>WARNING: CHANGE THIS IN PRODUCTION ENVIRONMENT!!!!</p>
</blockquote>
<h3 id="pg_dbsu_password"><code>pg_dbsu_password</code></h3>
<p>name: <code>pg_dbsu_password</code>, type: <code>password</code>, level: <code>G/C</code></p>
<p>PostgreSQL dbsu password for <a href="/docs/reference/param/#pg_dbsu"><code>pg_dbsu</code></a>, empty string means no dbsu password, which is the default behavior.</p>
<blockquote>
<p>WARNING: It&rsquo;s not recommend to set a dbsu password for common PGSQL clusters, except for <a href="/docs/reference/param/#pg_mode"><code>pg_mode</code></a> = <code>citus</code>.</p>
</blockquote>
<hr>
<h2 id="pg_install"><code>PG_INSTALL</code></h2>
<p>This section is responsible for installing PostgreSQL &amp; Extensions.</p>
<p>If you wish to install a different major version, just make sure repo packages exists and overwrite <a href="/docs/reference/param/#pg_version"><code>pg_version</code></a> on cluster level.</p>
<p>To install extra extensions, overwrite <a href="/docs/reference/param/#pg_extensions"><code>pg_extensions</code></a> on cluster level. Beware that not all extensions are available with other major versions.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_dbsu</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># os dbsu name, postgres by default, better not change it</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_uid</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">26</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># os dbsu uid and gid, 26 for default postgres users and groups</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_sudo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">limit              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dbsu sudo privilege, none,limit,all,nopass. limit by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_home</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/var/lib/pgsql     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgresql home directory, `/var/lib/pgsql` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dbsu_ssh_exchange</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># exchange postgres dbsu ssh key among same pgsql cluster</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">16</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># postgres major version to be installed, 16 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_bin_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/usr/pgsql/bin       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres binary dir, `/usr/pgsql/bin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_log_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/log/postgres     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres log dir, `/pg/log/postgres` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># pg packages to be installed, alias can be used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">postgresql</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager wal2json pg_repack</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># pg extensions to be installed, alias can be used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">postgis timescaledb pgvector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_dbsu"><code>pg_dbsu</code></h3>
<p>name: <code>pg_dbsu</code>, type: <code>username</code>, level: <code>C</code></p>
<p>os dbsu name, <code>postgres</code> by default, it&rsquo;s not wise to change it.</p>
<p>When installing Greenplum / MatrixDB, set this parameter to the corresponding default value: <code>gpadmin|mxadmin</code>.</p>
<h3 id="pg_dbsu_uid"><code>pg_dbsu_uid</code></h3>
<p>name: <code>pg_dbsu_uid</code>, type: <code>int</code>, level: <code>C</code></p>
<p>os dbsu uid and gid, <code>26</code> for default postgres users and groups, which is consistent with the official pgdg RPM.</p>
<p>For Ubuntu/Debian, there&rsquo;s no default postgres UID/GID, consider using another ad hoc value, such as <code>543</code> instead.</p>
<h3 id="pg_dbsu_sudo"><code>pg_dbsu_sudo</code></h3>
<p>name: <code>pg_dbsu_sudo</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>dbsu sudo privilege, coud be <code>none</code>, <code>limit</code> ,<code>all</code> ,<code>nopass</code>. <code>limit</code> by default</p>
<ul>
<li><code>none</code>: No Sudo privilege</li>
<li><code>limit</code>: Limited sudo privilege to execute systemctl commands for database-related components, default.</li>
<li><code>all</code>: Full <code>sudo</code> privilege, password required.</li>
<li><code>nopass</code>: Full <code>sudo</code> privileges without a password (not recommended).</li>
</ul>
<p>default values: <code>limit</code>, which only allow <code>sudo systemctl &lt;start|stop|reload&gt; &lt;postgres|patroni|pgbouncer|...&gt; </code></p>
<h3 id="pg_dbsu_home"><code>pg_dbsu_home</code></h3>
<p>name: <code>pg_dbsu_home</code>, type: <code>path</code>, level: <code>C</code></p>
<p>postgresql home directory, <code>/var/lib/pgsql</code> by default, which is consistent with the official pgdg RPM.</p>
<h3 id="pg_dbsu_ssh_exchange"><code>pg_dbsu_ssh_exchange</code></h3>
<p>name: <code>pg_dbsu_ssh_exchange</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>exchange postgres dbsu ssh key among same pgsql cluster?</p>
<p>default value is <code>true</code>, means the dbsu can ssh to each other among the same cluster.</p>
<h3 id="pg_version"><code>pg_version</code></h3>
<p>name: <code>pg_version</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>postgres major version to be installed, <code>15</code> by default</p>
<p>Note that PostgreSQL physical stream replication cannot cross major versions, so do not configure this on instance level.</p>
<p>You can use the parameters in <a href="/docs/reference/param/#pg_packages"><code>pg_packages</code></a> and <a href="/docs/reference/param/#pg_extensions"><code>pg_extensions</code></a> to install rpms for the specific pg major version.</p>
<h3 id="pg_bin_dir"><code>pg_bin_dir</code></h3>
<p>name: <code>pg_bin_dir</code>, type: <code>path</code>, level: <code>C</code></p>
<p>postgres binary dir, <code>/usr/pgsql/bin</code> by default</p>
<p>The default value is a soft link created manually during the installation process, pointing to the specific Postgres version dir installed.</p>
<p>For example <code>/usr/pgsql -&gt; /usr/pgsql-15</code>. For more details, check <a href="/docs/reference/fhs/#postgres-fhs">PGSQL File Structure</a> for details.</p>
<h3 id="pg_log_dir"><code>pg_log_dir</code></h3>
<p>name: <code>pg_log_dir</code>, type: <code>path</code>, level: <code>C</code></p>
<p>postgres log dir, <code>/pg/log/postgres</code> by default.</p>
<blockquote>
<p>caveat: if <code>pg_log_dir</code> is prefixed with <code>pg_data</code> it will not be created explicit (it will be created by postgres itself then).</p>
</blockquote>
<h3 id="pg_packages"><code>pg_packages</code></h3>
<p>name: <code>pg_packages</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>PG packages to be installed (rpm/deb), this is an array of software package names, each element is a comma or space separated PG software package name.</p>
<p>The default value is the PostgreSQL kernel, as well as patroni, pgbouncer, pg_exporter, &hellip; and two important extension <code>pg_repack</code> and <code>wal2json</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># pg packages to be installed, alias can be used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">postgresql</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager wal2json pg_repack</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Starting from Pigsty v3, you can use package aliases specified by <code>pg_package_map</code> in <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a> to perform an alias mapping.</p>
<p>The benefit of using package aliases is that you don&rsquo;t have to worry about the package names, architectures, and major version of PostgreSQL-related packages on different OS platforms, thus sealing off the differences between different OSs.</p>
<p>You can also use the raw package name directly, the <code>${pg_version}</code> or <code>$v</code> version placeholder in the package name will be replaced with the actual PG major version <a href="/docs/reference/param/#pg_version"><code>pg_version</code></a>.</p>
<h3 id="pg_extensions"><code>pg_extensions</code></h3>
<p>name: <code>pg_extensions</code>, type: <code>string[]</code>, level: <code>C</code></p>
<p>PG extensions to be installed (rpm/deb), this is an array of software package names, each element is a comma or space separated PG extension package name.</p>
<p>This parameter is similar to <a href="/docs/reference/param/#pg_packages"><code>pg_packages</code></a>, but is usually used to specify the extension to be installed @ global | cluster level, and the software packages specified here will be <strong>upgraded</strong> to the latest available version.</p>
<p>The default value of this parameter is the three most important extension plugins in the PG extension ecosystem: <code>postgis</code>, <code>timescaledb</code>, <code>pgvector</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># pg extensions to be installed, alias can be used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">postgis timescaledb pgvector </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># replace postgis with postgis33 when using el7</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>The complete list of extensions can be found in <a href="https://github.com/Vonng/pigsty/tree/main/roles/node_id/vars">auto generated</a> config, there are EL9 extension list:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pg_extensions: <span style="color:#8f5902;font-style:italic"># extensions to be installed on this cluster</span>
</span></span><span style="display:flex;"><span>  - timescaledb periods temporal_tables emaj table_version pg_cron pg_later pg_background pg_timetable
</span></span><span style="display:flex;"><span>  - postgis pgrouting pointcloud pg_h3 q3c ogr_fdw geoip <span style="color:#8f5902;font-style:italic">#pg_geohash #mobilitydb</span>
</span></span><span style="display:flex;"><span>  - pgvector pgvectorscale pg_vectorize pg_similarity pg_tiktoken pgml <span style="color:#8f5902;font-style:italic">#smlar</span>
</span></span><span style="display:flex;"><span>  - pg_search pg_bigm zhparser hunspell
</span></span><span style="display:flex;"><span>  - hydra pg_analytics pg_lakehouse pg_duckdb duckdb_fdw pg_fkpart pg_partman plproxy <span style="color:#8f5902;font-style:italic">#pg_strom citus</span>
</span></span><span style="display:flex;"><span>  - pg_hint_plan age hll rum pg_graphql pg_jsonschema jsquery index_advisor hypopg imgsmlr pg_ivm pgmq pgq <span style="color:#8f5902;font-style:italic">#rdkit</span>
</span></span><span style="display:flex;"><span>  - pg_tle plv8 pllua plprql pldebugger plpgsql_check plprofiler plsh <span style="color:#8f5902;font-style:italic">#pljava plr pgtap faker dbt2</span>
</span></span><span style="display:flex;"><span>  - prefix semver pgunit md5hash asn1oid roaringbitmap pgfaceting pgsphere pg_country pg_currency pgmp numeral pg_rational pguint ip4r timestamp9 chkpass <span style="color:#8f5902;font-style:italic">#pg_uri #pgemailaddr #acl #debversion #pg_rrule</span>
</span></span><span style="display:flex;"><span>  - topn pg_gzip pg_http pg_net pg_html5_email_address pgsql_tweaks pg_extra_time pg_timeit count_distinct extra_window_functions first_last_agg tdigest aggs_for_arrays pg_arraymath pg_idkit pg_uuidv7 permuteseq pg_hashids
</span></span><span style="display:flex;"><span>  - sequential_uuids pg_math pg_random pg_base36 pg_base62 floatvec pg_financial pgjwt pg_hashlib shacrypt cryptint pg_ecdsa pgpcre icu_ext envvar url_encode <span style="color:#8f5902;font-style:italic">#pg_zstd #aggs_for_vecs #quantile #lower_quantile #pgqr #pg_protobuf</span>
</span></span><span style="display:flex;"><span>  - pg_repack pg_squeeze pg_dirtyread pgfincore pgdd ddlx pg_prioritize pg_checksums pg_readonly safeupdate pg_permissions pgautofailover pg_catcheck preprepare pgcozy pg_orphaned pg_crash pg_cheat_funcs pg_savior table_log pg_fio <span style="color:#8f5902;font-style:italic">#pgpool pgagent</span>
</span></span><span style="display:flex;"><span>  - pg_profile pg_show_plans pg_stat_kcache pg_stat_monitor pg_qualstats pg_store_plans pg_track_settings pg_wait_sampling system_stats pg_meta pgnodemx pg_sqlog bgw_replstatus pgmeminfo toastinfo pagevis powa pg_top <span style="color:#8f5902;font-style:italic">#pg_statviz #pgexporter_ext #pg_mon</span>
</span></span><span style="display:flex;"><span>  - passwordcheck supautils pgsodium pg_vault anonymizer pg_tde pgsmcrypto pgaudit pgauditlogtofile pg_auth_mon credcheck pgcryptokey pg_jobmon logerrors login_hook set_user pg_snakeoil pgextwlist pg_auditor noset <span style="color:#8f5902;font-style:italic">#sslutils</span>
</span></span><span style="display:flex;"><span>  - wrappers multicorn odbc_fdw mysql_fdw tds_fdw sqlite_fdw pgbouncer_fdw mongo_fdw redis_fdw pg_redis_pubsub kafka_fdw hdfs_fdw firebird_fdw aws_s3 log_fdw <span style="color:#8f5902;font-style:italic">#oracle_fdw #db2_fdw #jdbc_fdw</span>
</span></span><span style="display:flex;"><span>  - orafce pgtt session_variable pg_statement_rollback pg_dbms_metadata pg_dbms_lock pgmemcache <span style="color:#8f5902;font-style:italic">#pg_dbms_job #wiltondb</span>
</span></span><span style="display:flex;"><span>  - pglogical pgl_ddl_deploy pg_failover_slots wal2json wal2mongo decoderbufs decoder_raw mimeo pgcopydb pgloader pg_fact_loader pg_bulkload pg_comparator pgimportdoc pgexportdoc <span style="color:#8f5902;font-style:italic">#repmgr #slony</span>
</span></span><span style="display:flex;"><span>  - gis-stack rag-stack fdw-stack fts-stack etl-stack feat-stack olap-stack supa-stack stat-stack json-stack
</span></span></code></pre></div><p>The full extension list can be found in <a href="https://github.com/Vonng/pigsty/blob/main/roles/node_id/vars/"><code>roles/node_id/vars</code></a></p>
<hr>
<h2 id="pg_bootstrap"><code>PG_BOOTSTRAP</code></h2>
<p>Bootstrap a postgres cluster with patroni, and setup pgbouncer connection pool along with it.</p>
<p>It also init cluster template databases with default roles, schemas &amp; extensions &amp; default privileges specified in <a href="/docs/reference/param/#pg_provision"><code>PG_PROVISION</code></a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># prevent purging running postgres instance? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># purging existing postgres during pgsql init? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/data                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres data directory, `/pg/data` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_fs_main</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># mountpoint/path for postgres main data, `/data` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_fs_bkup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/backups        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># mountpoint/path for pg backup data, `/data/backup` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_storage_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SSD             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># storage type for pg main data, SSD,HDD, SSD by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dummy_filesize</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">64MiB         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># size of `/pg/dummy`, hold 64MB disk space for emergency use</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_listen</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;0.0.0.0&#39;</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># postgres/pgbouncer listen addresses, comma separated list</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5432</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># postgres listen port, 5432 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_localhost</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/var/run/postgresql</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres unix socket dir for localhost connection</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># if disabled, no postgres cluster will be created during init</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_mode: default             # patroni working mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default,pause,remove</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_namespace</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># top level key namespace in etcd, used by patroni &amp; vip</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8008</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># patroni listen port, 8008 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_log_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/log/patroni </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># patroni log dir, `/pg/log/patroni` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_ssl_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># secure patroni RestAPI communications with SSL?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_watchdog_mode: off        # patroni watchdog mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">automatic,required,off. off by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># patroni restapi username, `postgres` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">patroni_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Patroni.API    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># patroni restapi password, `Patroni.API` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_primary_db</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># primary database name, used by citus,etc... ,postgres by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># extra parameters in postgresql.auto.conf</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_files</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># extra files to be copied to postgres data directory (e.g. license)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_conf: oltp.yml                 # config template</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">oltp,olap,crit,tiny. `oltp.yml` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_max_conn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">auto                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># postgres max connections, `auto` will use recommended value</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_shared_buffer_ratio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0.25</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># postgres shared buffers ratio, 0.25 by default, 0.1~0.4</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_rto</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">30</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># recovery time objective in seconds,  `30s` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_rpo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1048576</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># recovery point objective in bytes, `1MiB` at most by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_libs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pg_stat_statements, auto_explain&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># preloaded libraries, `pg_stat_statements,auto_explain` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_delay</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># replication apply delay for standby cluster leader</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_checksum</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># enable data checksum for postgres cluster?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_pwd_enc: scram-sha-256         # passwords encryption algorithm</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">md5,scram-sha-256</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># database cluster encoding, `UTF8` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># database cluster local, `C` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_lc_collate</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># database cluster collate, `C` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_lc_ctype</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">en_US.UTF8          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># database character type, `en_US.UTF8` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># if disabled, pgbouncer will not be launched on pgsql host</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">6432</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># pgbouncer listen port, 6432 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_log_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/log/pgbouncer </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbouncer log dir, `/pg/log/pgbouncer` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_auth_query</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># query postgres to retrieve unlisted business users?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_poolmode: transaction   # pooling mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">transaction,session,statement, transaction by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_sslmode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">disable       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbouncer client ssl mode, disable by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_safeguard"><code>pg_safeguard</code></h3>
<p>name: <code>pg_safeguard</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>prevent purging running postgres instance? false by default</p>
<p>If enabled, <a href="/docs/pgsql/playbook/#pgsqlyml"><code>pgsql.yml</code></a> &amp; <a href="/docs/pgsql/playbook/#pgsql-rmyml"><code>pgsql-rm.yml</code></a> will abort immediately if any postgres instance is running.</p>
<h3 id="pg_clean"><code>pg_clean</code></h3>
<p>name: <code>pg_clean</code>, type: <code>bool</code>, level: <code>G/C/A</code></p>
<p>purging existing postgres during pgsql init? true by default</p>
<p>default value is <code>true</code>, it will purge existing postgres instance during <a href="/docs/pgsql/playbook/#pgsqlyml"><code>pgsql.yml</code></a> init. which makes the playbook idempotent.</p>
<p>if set to <code>false</code>, <a href="/docs/pgsql/playbook/#pgsqlyml"><code>pgsql.yml</code></a> will abort if there&rsquo;s already a running postgres instance. and <a href="/docs/pgsql/playbook/#pgsql-rmyml"><code>pgsql-rm.yml</code></a> will NOT remove postgres data (only stop the server).</p>
<h3 id="pg_data"><code>pg_data</code></h3>
<p>name: <code>pg_data</code>, type: <code>path</code>, level: <code>C</code></p>
<p>postgres data directory, <code>/pg/data</code> by default</p>
<p>default values: <code>/pg/data</code>, DO NOT CHANGE IT.</p>
<p>It&rsquo;s a soft link that point to underlying data directory.</p>
<p>Check <a href="/docs/reference/fhs/">PGSQL File Structure</a> for details.</p>
<h3 id="pg_fs_main"><code>pg_fs_main</code></h3>
<p>name: <code>pg_fs_main</code>, type: <code>path</code>, level: <code>C</code></p>
<p>mountpoint/path for postgres main data, <code>/data</code> by default</p>
<p>default values: <code>/data</code>, which will be used as parent dir of postgres main data directory: <code>/data/postgres</code>.</p>
<p>It&rsquo;s recommended to use NVME SSD for postgres main data storage, Pigsty is optimized for SSD storage by default.
But HDD is also supported, you can change <a href="/docs/reference/param/#pg_storage_type"><code>pg_storage_type</code></a> to <code>HDD</code> to optimize for HDD storage.</p>
<h3 id="pg_fs_bkup"><code>pg_fs_bkup</code></h3>
<p>name: <code>pg_fs_bkup</code>, type: <code>path</code>, level: <code>C</code></p>
<p>mountpoint/path for pg backup data, <code>/data/backup</code> by default</p>
<p>If you are using the default <a href="/docs/reference/param/#pgbackrest_method"><code>pgbackrest_method</code></a> = <code>local</code>, it is recommended to have a separate disk for backup storage.</p>
<p>The backup disk should be large enough to hold all your backups, at least enough for 3 basebackups + 2 days WAL archive.
This is usually not a problem since you can use cheap &amp; large HDD for that.</p>
<p>It&rsquo;s recommended to use a separate disk for backup storage, otherwise pigsty will fall back to the main data disk.</p>
<h3 id="pg_storage_type"><code>pg_storage_type</code></h3>
<p>name: <code>pg_storage_type</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>storage type for pg main data, <code>SSD</code>,<code>HDD</code>, <code>SSD</code> by default</p>
<p>default values: <code>SSD</code>, it will affect some tuning parameters, such as <code>random_page_cost</code> &amp; <code>effective_io_concurrency</code></p>
<h3 id="pg_dummy_filesize"><code>pg_dummy_filesize</code></h3>
<p>name: <code>pg_dummy_filesize</code>, type: <code>size</code>, level: <code>C</code></p>
<p>size of <code>/pg/dummy</code>, default values: <code>64MiB</code>, which hold 64MB disk space for emergency use</p>
<p>When the disk is full, removing the placeholder file can free up some space for emergency use, it is recommended to use at least <code>8GiB</code> for production use.</p>
<h3 id="pg_listen"><code>pg_listen</code></h3>
<p>name: <code>pg_listen</code>, type: <code>ip</code>, level: <code>C</code></p>
<p>postgres/pgbouncer listen address, <code>0.0.0.0</code> (all ipv4 addr) by default</p>
<p>You can use placeholder in this variable:</p>
<ul>
<li><code>${ip}</code>: translate to inventory_hostname, which is primary private IP address in the inventory</li>
<li><code>${vip}</code>: if <a href="/docs/reference/param/#pg_vip_enabled"><code>pg_vip_enabled</code></a>, this will translate to host part of <a href="/docs/reference/param/#pg_vip_address"><code>pg_vip_address</code></a></li>
<li><code>${lo}</code>: will translate to <code>127.0.0.1</code></li>
</ul>
<p>For example: <code>'${ip},${lo}'</code> or <code>'${ip},${vip},${lo}'</code>.</p>
<h3 id="pg_port"><code>pg_port</code></h3>
<p>name: <code>pg_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>postgres listen port, <code>5432</code> by default.</p>
<h3 id="pg_localhost"><code>pg_localhost</code></h3>
<p>name: <code>pg_localhost</code>, type: <code>path</code>, level: <code>C</code></p>
<p>postgres unix socket dir for localhost connection, default values: <code>/var/run/postgresql</code></p>
<p>The Unix socket dir for PostgreSQL and Pgbouncer local connection, which is used by <a href="/docs/reference/param/#pg_exporter"><code>pg_exporter</code></a> and patroni.</p>
<h3 id="pg_namespace"><code>pg_namespace</code></h3>
<p>name: <code>pg_namespace</code>, type: <code>path</code>, level: <code>C</code></p>
<p>top level key namespace in etcd, used by patroni &amp; vip, default values is: <code>/pg</code> , and it&rsquo;s not recommended to change it.</p>
<h3 id="patroni_enabled"><code>patroni_enabled</code></h3>
<p>name: <code>patroni_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>if disabled, no postgres cluster will be created during init</p>
<p>default value is <code>true</code>, If disabled, Pigsty will skip pulling up patroni (thus postgres).</p>
<p>This option is useful when trying to add some components to an existing postgres instance.</p>
<h3 id="patroni_mode"><code>patroni_mode</code></h3>
<p>name: <code>patroni_mode</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>patroni working mode: <code>default</code>, <code>pause</code>, <code>remove</code></p>
<p>default values: <code>default</code></p>
<ul>
<li><code>default</code>: Bootstrap PostgreSQL cluster with Patroni</li>
<li><code>pause</code>: Just like <code>default</code>, but entering maintenance mode after bootstrap</li>
<li><code>remove</code>: Init the cluster with Patroni, them remove Patroni and use raw PostgreSQL instead.</li>
</ul>
<h3 id="patroni_port"><code>patroni_port</code></h3>
<p>name: <code>patroni_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>patroni listen port, <code>8008</code> by default, changing it is not recommended.</p>
<p>The Patroni API server listens on this port for health checking &amp; API requests.</p>
<h3 id="patroni_log_dir"><code>patroni_log_dir</code></h3>
<p>name: <code>patroni_log_dir</code>, type: <code>path</code>, level: <code>C</code></p>
<p>patroni log dir, <code>/pg/log/patroni</code> by default, which will be collected by <a href="/docs/reference/param/#promtail"><code>promtail</code></a>.</p>
<h3 id="patroni_ssl_enabled"><code>patroni_ssl_enabled</code></h3>
<p>name: <code>patroni_ssl_enabled</code>, type: <code>bool</code>, level: <code>G</code></p>
<p>Secure patroni RestAPI communications with SSL? default value is <code>false</code></p>
<p>This parameter is a global flag that can only be set before deployment.</p>
<p>Since if SSL is enabled for patroni, you&rsquo;ll have to perform healthcheck, metrics scrape and API call with HTTPS instead of HTTP.</p>
<h3 id="patroni_watchdog_mode"><code>patroni_watchdog_mode</code></h3>
<p>name: <code>patroni_watchdog_mode</code>, type: <code>string</code>, level: <code>C</code></p>
<p>In case of primary failure, patroni can use <a href="https://patroni.readthedocs.io/en/latest/watchdog.html">watchdog</a> to fencing the old primary node to avoid split-brain.</p>
<p>patroni watchdog mode: <code>automatic</code>, <code>required</code>, <code>off</code>:</p>
<ul>
<li><code>off</code>: not using <code>watchdog</code>. avoid fencing at all. This is the default value.</li>
<li><code>automatic</code>: Enable <code>watchdog</code> if the kernel has <code>softdog</code> module enabled and watchdog is owned by dbsu</li>
<li><code>required</code>: Force <code>watchdog</code>, refuse to start if <code>softdog</code> is not available</li>
</ul>
<p>default value is <code>off</code>, you should not enable watchdog on infra nodes to avoid fencing.</p>
<p>For those critical systems where data consistency prevails over availability, it is recommended to enable watchdog.</p>
<p>Beware that if all your traffic is <a href="/docs/pgsql/svc/#access-service">accessed</a> via haproxy, there is no risk of brain split at all.</p>
<h3 id="patroni_username"><code>patroni_username</code></h3>
<p>name: <code>patroni_username</code>, type: <code>username</code>, level: <code>C</code></p>
<p>patroni restapi username, <code>postgres</code> by default, used in pair with <a href="/docs/reference/param/#patroni_password"><code>patroni_password</code></a></p>
<p>Patroni unsafe RESTAPI is protected by username/password by default, check <a href="/docs/pgsql/admin/#config-cluster">Config Cluster</a> and <a href="https://patroni.readthedocs.io/en/latest/rest_api.html">Patroni RESTAPI</a> for details.</p>
<h3 id="patroni_password"><code>patroni_password</code></h3>
<p>name: <code>patroni_password</code>, type: <code>password</code>, level: <code>C</code></p>
<p>patroni restapi password, <code>Patroni.API</code> by default</p>
<blockquote>
<p>WARNING: CHANGE THIS IN PRODUCTION ENVIRONMENT!!!!</p>
</blockquote>
<h3 id="pg_primary_db"><code>pg_primary_db</code></h3>
<p>name: <code>pg_primary_db</code>, type: <code>string</code>, level: <code>C</code></p>
<p>primary database name, used by citus,etc&hellip; , <code>postgres</code> by default</p>
<p>Patroni 3.0&rsquo;s native citus will specify a managed database for citus. which is created by patroni itself.</p>
<h3 id="pg_parameters"><code>pg_parameters</code></h3>
<p>Parameter Name: <code>pg_parameters</code>, Type: <code>dict</code>, Level: <code>G/C/I</code></p>
<p>This parameter is used to specify and manage configuration parameters in <code>postgresql.auto.conf</code>.</p>
<p>After all instances in the cluster have completed initialization, the <code>pg_param</code> task will sequentially overwrite the key/value pairs in this dictionary to <code>/pg/data/postgresql.auto.conf</code>.</p>
<blockquote>
<p>Note: Please do not manually modify this configuration file, or use <code>ALTER SYSTEM</code> to change cluster configuration parameters. Any changes will be overwritten during the next configuration sync.</p>
</blockquote>
<p>This variable has a higher priority than the cluster configuration in Patroni/DCS (i.e., it has a higher priority than the cluster configuration edited by Patroni <code>edit-config</code>). Therefore, it can typically override the cluster default parameters at the instance level.</p>
<p>When your cluster members have different specifications (not recommended!), you can fine-tune the configuration of each instance using this parameter.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg-test</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role: primary , pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">shared_buffers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;5GB&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 2, pg_role: replica , pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">shared_buffers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;4GB&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 3, pg_role: replica , pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">shared_buffers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;3GB&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Please note that some important cluster parameters (which have requirements for primary and replica parameter values) are managed directly by Patroni through command-line parameters and have the highest priority. These cannot be overridden by this method. For these parameters, you must use Patroni <code>edit-config</code> for management and configuration.</p>
<p>PostgreSQL parameters that <a href="https://patroni.readthedocs.io/en/latest/patroni_configuration.html#important-rules">must remain consistent</a> across primary and replicas (inconsistency will prevent the replica from starting!):</p>
<ul>
<li><code>wal_level</code></li>
<li><code>max_connections</code></li>
<li><code>max_locks_per_transaction</code></li>
<li><code>max_worker_processes</code></li>
<li><code>max_prepared_transactions</code></li>
<li><code>track_commit_timestamp</code></li>
</ul>
<p>Parameters that should ideally remain consistent across primary and replicas (considering the possibility of primary-replica switch):</p>
<ul>
<li><code>listen_addresses</code></li>
<li><code>port</code></li>
<li><code>cluster_name</code></li>
<li><code>hot_standby</code></li>
<li><code>wal_log_hints</code></li>
<li><code>max_wal_senders</code></li>
<li><code>max_replication_slots</code></li>
<li><code>wal_keep_segments</code></li>
<li><code>wal_keep_size</code></li>
</ul>
<p>You can set non-existent parameters (such as GUCs from extensions), but changing existing configurations to illegal values may prevent PostgreSQL from starting. Please configure with caution!</p>
<h3 id="pg_files"><code>pg_files</code></h3>
<p>Parameter Name: <code>pg_files</code>, Type: <code>path[]</code>, Level: <code>C</code></p>
<p>Designates a list of files to be copied to the <code>{{ pg_data }}</code> directory. The default value is an empty array: <code>[]</code>.</p>
<p>Files specified in this parameter will be copied to the <code>{{ pg_data }}</code> directory. This is mainly used to distribute license files required by special commercial versions of the PostgreSQL kernel.</p>
<p>Currently, only the PolarDB (Oracle-compatible) kernel requires a license file. For example, you can place the <code>license.lic</code> file in the <code>files/</code> directory and specify it in <code>pg_files</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_files</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">license.lic ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_conf"><code>pg_conf</code></h3>
<p>name: <code>pg_conf</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>config template: <code>{oltp,olap,crit,tiny}.yml</code>, <code>oltp.yml</code> by default</p>
<ul>
<li><code>tiny.yml</code>: optimize for tiny nodes, virtual machines, small demo, (1~8Core, 1~16GB)</li>
<li><code>oltp.yml</code>: optimize for OLTP workloads and latency sensitive applications, (4C8GB+), which is the default template</li>
<li><code>olap.yml</code>: optimize for OLAP workloads and throughput (4C8G+)</li>
<li><code>crit.yml</code>: optimize for data consistency and critical applications (4C8G+)</li>
</ul>
<p>default values: <code>oltp.yml</code>, but <a href="/docs/setup/install/#configure">configure</a> procedure will set this value to <code>tiny.yml</code> if current node is a tiny node.</p>
<p>You can have your own template, just put it under <code>templates/&lt;mode&gt;.yml</code> and set this value to the template name.</p>
<h3 id="pg_max_conn"><code>pg_max_conn</code></h3>
<p>name: <code>pg_max_conn</code>, type: <code>int</code>, level: <code>C</code></p>
<p>postgres max connections, You can specify a value between 50 and 5000, or use <code>auto</code> to use recommended value.</p>
<p>default value is <code>auto</code>, which will set max connections according to the <a href="/docs/reference/param/#pg_conf"><code>pg_conf</code></a> and <a href="/docs/reference/param/#pg_default_service_dest"><code>pg_default_service_dest</code></a>.</p>
<ul>
<li>tiny: 100</li>
<li>olap: 200</li>
<li>oltp: 200 (pgbouncer) / 1000 (postgres)
<ul>
<li>pg_default_service_dest = pgbouncer : 200</li>
<li>pg_default_service_dest = postgres : 1000</li>
</ul>
</li>
<li>crit: 200 (pgbouncer) / 1000 (postgres)
<ul>
<li>pg_default_service_dest = pgbouncer : 200</li>
<li>pg_default_service_dest = postgres : 1000</li>
</ul>
</li>
</ul>
<p>It&rsquo;s not recommended to set this value greater than 5000, otherwise you have to increase the haproxy service connection limit manually as well.</p>
<p>Pgbouncer&rsquo;s transaction pooling can alleviate the problem of too many OLTP connections, but it&rsquo;s not recommended to use it in OLAP scenarios.</p>
<h3 id="pg_shared_buffer_ratio"><code>pg_shared_buffer_ratio</code></h3>
<p>name: <code>pg_shared_buffer_ratio</code>, type: <code>float</code>, level: <code>C</code></p>
<p>postgres shared buffer memory ratio, 0.25 by default, 0.1~0.4</p>
<p>default values: <code>0.25</code>, means 25% of node memory will be used as PostgreSQL shard buffers.</p>
<p>Setting this value greater than 0.4 (40%) is usually not a good idea.</p>
<p>Note that shared buffer is only part of shared memory in PostgreSQL, to calculate the total shared memory, use <code>show shared_memory_size_in_huge_pages;</code>.</p>
<h3 id="pg_rto"><code>pg_rto</code></h3>
<p>name: <code>pg_rto</code>, type: <code>int</code>, level: <code>C</code></p>
<p>recovery time objective in seconds, This will be used as Patroni TTL value, <code>30</code>s by default.</p>
<p>If a primary instance is missing for such a long time, a new leader election will be triggered.</p>
<p>Decrease the value can reduce the unavailable time (unable to write) of the cluster during failover,
but it will make the cluster more sensitive to network jitter, thus increase the chance of false-positive failover.</p>
<p>Config this according to your network condition and expectation to <strong>trade-off between chance and impact</strong>,
the default value is 30s, and it will be populated to the following patroni parameters:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># the TTL to acquire the leader lock (in seconds). Think of it as the length of time before initiation of the automatic failover process. Default value: 30</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ttl</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_rto }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># the number of seconds the loop will sleep. Default value: 10 , this is patroni check loop interval</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">loop_wait</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">(pg_rto / 3)|round(0, &#39;ceil&#39;)|int }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># timeout for DCS and PostgreSQL operation retries (in seconds). DCS or network issues shorter than this will not cause Patroni to demote the leader. Default value: 10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">retry_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">(pg_rto / 3)|round(0, &#39;ceil&#39;)|int }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># the amount of time a primary is allowed to recover from failures before failover is triggered (in seconds), Max RTO: 2 loop wait + primary_start_timeout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">primary_start_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">(pg_rto / 3)|round(0, &#39;ceil&#39;)|int }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_rpo"><code>pg_rpo</code></h3>
<p>name: <code>pg_rpo</code>, type: <code>int</code>, level: <code>C</code></p>
<p>recovery point objective in bytes, <code>1MiB</code> at most by default</p>
<p>default values: <code>1048576</code>, which will tolerate at most 1MiB data loss during failover.</p>
<p>when the primary is down and all replicas are lagged, you have to make a tough choice to <strong>trade off between Availability and Consistency</strong>:</p>
<ul>
<li>Promote a replica to be the new primary and bring system back online ASAP, with the price of an acceptable data loss (e.g. less than 1MB).</li>
<li>Wait for the primary to come back (which may never be) or human intervention to avoid any data loss.</li>
</ul>
<p>You can use <code>crit.yml</code> <a href="/docs/reference/param/#pg_conf">conf</a> template to ensure no data loss during failover, but it will sacrifice some performance.</p>
<h3 id="pg_libs"><code>pg_libs</code></h3>
<p>name: <code>pg_libs</code>, type: <code>string</code>, level: <code>C</code></p>
<p>shared preloaded libraries, <code>pg_stat_statements,auto_explain</code> by default.</p>
<p>They are two extensions that come with PostgreSQL, and it is strongly recommended to enable them.</p>
<p>For existing clusters, you can <a href="/docs/pgsql/admin/#config-cluster">configure</a> the <code>shared_preload_libraries</code> parameter of the cluster and apply it.</p>
<p>If you want to use TimescaleDB or Citus extensions, you need to add <code>timescaledb</code> or <code>citus</code> to this list. <code>timescaledb</code> and <code>citus</code> should be placed at the top of this list, for example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>citus,timescaledb,pg_stat_statements,auto_explain
</span></span></code></pre></div><p>Other extensions that need to be loaded can also be added to this list, such as <code>pg_cron</code>, <code>pgml</code>, etc.</p>
<p>Generally, <code>citus</code> and <code>timescaledb</code> have the highest priority and should be added to the top of the list.</p>
<h3 id="pg_delay"><code>pg_delay</code></h3>
<p>name: <code>pg_delay</code>, type: <code>interval</code>, level: <code>I</code></p>
<p>replication apply delay for standby cluster leader , default values: <code>0</code>.</p>
<p>if this value is set to a positive value, the standby cluster leader will be delayed for this time before apply WAL changes.</p>
<p>Check <a href="/docs/pgsql/conf#delayed-cluster">delayed standby cluster</a> for details.</p>
<h3 id="pg_checksum"><code>pg_checksum</code></h3>
<p>name: <code>pg_checksum</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable data checksum for postgres cluster?, default value is <code>false</code>.</p>
<p>This parameter can only be set before PGSQL deployment. (but you can enable it manually later)</p>
<p>If <a href="/docs/reference/param/#pg_conf"><code>pg_conf</code></a> <code>crit.yml</code> template is used, data checksum is always enabled regardless of this parameter to ensure data integrity.</p>
<h3 id="pg_pwd_enc"><code>pg_pwd_enc</code></h3>
<p>name: <code>pg_pwd_enc</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>passwords encryption algorithm: md5,scram-sha-256</p>
<p>default values: <code>scram-sha-256</code>, if you have compatibility issues with old clients, you can set it to <code>md5</code> instead.</p>
<h3 id="pg_encoding"><code>pg_encoding</code></h3>
<p>name: <code>pg_encoding</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>database cluster encoding, <code>UTF8</code> by default</p>
<h3 id="pg_locale"><code>pg_locale</code></h3>
<p>name: <code>pg_locale</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>database cluster local, <code>C</code> by default</p>
<h3 id="pg_lc_collate"><code>pg_lc_collate</code></h3>
<p>name: <code>pg_lc_collate</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>database cluster collate, <code>C</code> by default, It&rsquo;s not recommended to change this value unless you know what you are doing.</p>
<h3 id="pg_lc_ctype"><code>pg_lc_ctype</code></h3>
<p>name: <code>pg_lc_ctype</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>database character type, <code>en_US.UTF8</code> by default</p>
<h3 id="pgbouncer_enabled"><code>pgbouncer_enabled</code></h3>
<p>name: <code>pgbouncer_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>default value is <code>true</code>, if disabled, pgbouncer will not be launched on pgsql host</p>
<h3 id="pgbouncer_port"><code>pgbouncer_port</code></h3>
<p>name: <code>pgbouncer_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>pgbouncer listen port, <code>6432</code> by default</p>
<h3 id="pgbouncer_log_dir"><code>pgbouncer_log_dir</code></h3>
<p>name: <code>pgbouncer_log_dir</code>, type: <code>path</code>, level: <code>C</code></p>
<p>pgbouncer log dir, <code>/pg/log/pgbouncer</code> by default, referenced by promtail the logging agent.</p>
<h3 id="pgbouncer_auth_query"><code>pgbouncer_auth_query</code></h3>
<p>name: <code>pgbouncer_auth_query</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>query postgres to retrieve unlisted business users? default value is <code>false</code></p>
<p>If enabled, pgbouncer user will be authenticated against postgres database with <code>SELECT username, password FROM monitor.pgbouncer_auth($1)</code>, otherwise, only the users with <code>pgbouncer: true</code> will be allowed to connect to pgbouncer.</p>
<h3 id="pgbouncer_poolmode"><code>pgbouncer_poolmode</code></h3>
<p>name: <code>pgbouncer_poolmode</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>Pgbouncer pooling mode: <code>transaction</code>, <code>session</code>, <code>statement</code>, <code>transaction</code> by default</p>
<ul>
<li><code>session</code>: Session-level pooling with the best compatibility.</li>
<li><code>transaction</code>: Transaction-level pooling with better performance (lots of small conns), could break some session level features such as notify/listen, etc&hellip;</li>
<li><code>statements</code>: Statement-level pooling which is used for simple read-only queries.</li>
</ul>
<p>If you application has some compatibility issues with pgbouncer, you can try to change this value to <code>session</code> instead.</p>
<h3 id="pgbouncer_sslmode"><code>pgbouncer_sslmode</code></h3>
<p>name: <code>pgbouncer_sslmode</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>pgbouncer client ssl mode, <code>disable</code> by default</p>
<p>default values: <code>disable</code>, beware that this may have a huge performance impact on your pgbouncer.</p>
<ul>
<li><code>disable</code>: Plain TCP. If client requests TLS, it’s ignored. Default.</li>
<li><code>allow</code>: If client requests TLS, it is used. If not, plain TCP is used. If the client presents a client certificate, it is not validated.</li>
<li><code>prefer</code>: Same as allow.</li>
<li><code>require</code>: Client must use TLS. If not, the client connection is rejected. If the client presents a client certificate, it is not validated.</li>
<li><code>verify-ca</code>: Client must use TLS with valid client certificate.</li>
<li><code>verify-full</code>: Same as verify-ca.</li>
</ul>
<hr>
<h2 id="pg_provision"><code>PG_PROVISION</code></h2>
<p>PG_BOOTSTRAP will bootstrap a new postgres cluster with patroni, while PG_PROVISION will create default objects in the cluster, including:</p>
<ul>
<li><a href="/docs/pgsql/acl/#default-roles">Default Roles</a></li>
<li><a href="/docs/pgsql/acl/#default-users">Default Users</a></li>
<li><a href="/docs/pgsql/acl/#privileges">Default Privileges</a></li>
<li><a href="/docs/pgsql/hba/#default-hba">Default HBA Rules</a></li>
<li>Default Schemas</li>
<li>Default Extensions</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_provision</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># provision postgres cluster after bootstrap</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_init</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-init                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># provision init script for cluster template, `pg-init` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># default roles and users in postgres cluster</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_readonly  ,login: false ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for global read-only access     }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_offline   ,login: false ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for restricted read-only access }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_readwrite ,login: false ,roles: [dbrole_readonly] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for global read-write access }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_admin     ,login: false ,roles: [pg_monitor, dbrole_readwrite] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for object creation }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgres     ,superuser: true  ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system superuser }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replicator ,replication: true  ,roles: [pg_monitor, dbrole_readonly] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system replicator }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_dba   ,superuser: true  ,roles: [dbrole_admin]  ,pgbouncer: true ,pool_mode: session, pool_connlimit: 16 ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql admin user }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_monitor ,roles: [pg_monitor] ,pgbouncer: true ,parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">log_min_duration_statement: 1000 } ,pool_mode: session ,pool_connlimit: 8 ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql monitor user }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_privileges</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># default privileges when created by admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SCHEMAS   TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON TABLES    TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON SEQUENCES TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE    ON FUNCTIONS TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SCHEMAS   TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON TABLES    TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON SEQUENCES TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE    ON FUNCTIONS TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT INSERT     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT UPDATE     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT DELETE     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT UPDATE     ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRUNCATE   ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT REFERENCES ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRIGGER    ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT CREATE     ON SCHEMAS   TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor ]  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default schemas to be created</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># default extensions to be created</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: adminpack          ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_catalog }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_stat_statements ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgstattuple        ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_buffercache     ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pageinspect        ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_prewarm         ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_visibility      ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_freespacemap    ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgres_fdw       ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: file_fdw           ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: btree_gist         ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: btree_gin          ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_trgm            ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: intagg             ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: intarray           ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_repack }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># reload postgres after hba changes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># postgres default host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: local     ,auth: ident ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu access via local os user ident&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: local     ,auth: ident ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu replication from local os ident&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator replication from localhost&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator replication from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: postgres    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator postgres db from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor from localhost with password&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: infra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor from infra host with password&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: infra     ,auth: ssl   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin @ infra nodes with pwd &amp; ssl&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: ssl   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin @ everywhere with ssl &amp; pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_readonly&#39;,db: all    ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pgbouncer read/write via local socket&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_readonly&#39;,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;read/write biz user via password&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_offline&#39; ,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow etl offline tasks from intranet&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgb_default_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># pgbouncer default host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: pgbouncer   ,addr: local     ,auth: peer  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu local admin access with os ident&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;all&#39;        ,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow all user local access with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: pgbouncer   ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor access via intranet with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: deny  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;reject all other monitor access addr&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin access via intranet with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: deny  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;reject all other admin access addr&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;all&#39;        ,db: all         ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow all user intra access with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_provision-1"><code>pg_provision</code></h3>
<p>name: <code>pg_provision</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>provision postgres cluster after bootstrap, default value is <code>true</code>.</p>
<p>If disabled, postgres cluster will not be provisioned after bootstrap.</p>
<h3 id="pg_init"><code>pg_init</code></h3>
<p>name: <code>pg_init</code>, type: <code>string</code>, level: <code>G/C</code></p>
<p>Provision init script for cluster template, <code>pg-init</code> by default, which is located in <a href="https://github.com/Vonng/pigsty/blob/main/roles/pgsql/templates/pg-init"><code>roles/pgsql/templates/pg-init</code></a></p>
<p>You can add your own logic in the init script, or provide a new one in <code>templates/</code> and set <code>pg_init</code> to the new script name.</p>
<h3 id="pg_default_roles"><code>pg_default_roles</code></h3>
<p>name: <code>pg_default_roles</code>, type: <code>role[]</code>, level: <code>G/C</code></p>
<p>default roles and users in postgres cluster.</p>
<p>Pigsty has a built-in role system, check <a href="/docs/pgsql/acl/#role-system">PGSQL Access Control</a> for details.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># default roles and users in postgres cluster</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_readonly  ,login: false ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for global read-only access     }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_offline   ,login: false ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for restricted read-only access }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_readwrite ,login: false ,roles: [dbrole_readonly] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for global read-write access }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbrole_admin     ,login: false ,roles: [pg_monitor, dbrole_readwrite] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for object creation }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgres     ,superuser: true  ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system superuser }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replicator ,replication: true  ,roles: [pg_monitor, dbrole_readonly] ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system replicator }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_dba   ,superuser: true  ,roles: [dbrole_admin]  ,pgbouncer: true ,pool_mode: session, pool_connlimit: 16 ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql admin user }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_monitor ,roles: [pg_monitor] ,pgbouncer: true ,parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">log_min_duration_statement: 1000 } ,pool_mode: session ,pool_connlimit: 8 ,comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql monitor user }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_default_privileges"><code>pg_default_privileges</code></h3>
<p>name: <code>pg_default_privileges</code>, type: <code>string[]</code>, level: <code>G/C</code></p>
<p>default privileges for each databases:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_privileges</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># default privileges when created by admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SCHEMAS   TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON TABLES    TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON SEQUENCES TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE    ON FUNCTIONS TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SCHEMAS   TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON TABLES    TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT     ON SEQUENCES TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE    ON FUNCTIONS TO dbrole_offline</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT INSERT     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT UPDATE     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT DELETE     ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE      ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT UPDATE     ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRUNCATE   ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT REFERENCES ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRIGGER    ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT CREATE     ON SCHEMAS   TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Pigsty has a built-in privileges base on default role system, check <a href="/docs/pgsql/acl/#privileges">PGSQL Privileges</a> for details.</p>
<h3 id="pg_default_schemas"><code>pg_default_schemas</code></h3>
<p>name: <code>pg_default_schemas</code>, type: <code>string[]</code>, level: <code>G/C</code></p>
<p>default schemas to be created, default values is: <code>[ monitor ]</code>, which will create a <code>monitor</code> schema on all databases.</p>
<h3 id="pg_default_extensions"><code>pg_default_extensions</code></h3>
<p>name: <code>pg_default_extensions</code>, type: <code>extension[]</code>, level: <code>G/C</code></p>
<p>default extensions to be created, default value:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default extensions to be created</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: adminpack          ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_catalog }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_stat_statements ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgstattuple        ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_buffercache     ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pageinspect        ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_prewarm         ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_visibility      ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_freespacemap    ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitor }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: postgres_fdw       ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: file_fdw           ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: btree_gist         ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: btree_gin          ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_trgm            ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: intagg             ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: intarray           ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_repack }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>The only 3rd party extension is <code>pg_repack</code>, which is important for database maintenance, all other extensions are built-in postgres contrib extensions.</p>
<p>Monitor related extensions are installed in <code>monitor</code> schema, which is created by <a href="/docs/reference/param/#pg_default_schemas"><code>pg_default_schemas</code></a>.</p>
<h3 id="pg_reload"><code>pg_reload</code></h3>
<p>name: <code>pg_reload</code>, type: <code>bool</code>, level: <code>A</code></p>
<p>reload postgres after hba changes, default value is <code>true</code></p>
<p>This is useful when you want to check before applying HBA changes, set it to <code>false</code> to disable reload.</p>
<h3 id="pg_default_hba_rules"><code>pg_default_hba_rules</code></h3>
<p>name: <code>pg_default_hba_rules</code>, type: <code>hba[]</code>, level: <code>G/C</code></p>
<p>postgres default host-based authentication rules, array of <a href="/docs/pgsql/hba/#define-hba">hba</a> rule object.</p>
<p>default value provides a fair enough security level for common scenarios, check <a href="/docs/pgsql/hba/">PGSQL Authentication</a> for details.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># postgres default host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: local     ,auth: ident ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu access via local os user ident&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: local     ,auth: ident ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu replication from local os ident&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator replication from localhost&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: replication ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator replication from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${repl}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: postgres    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;replicator postgres db from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor from localhost with password&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: infra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor from infra host with password&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: infra     ,auth: ssl   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin @ infra nodes with pwd &amp; ssl&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: ssl   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin @ everywhere with ssl &amp; pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_readonly&#39;,db: all    ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pgbouncer read/write via local socket&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_readonly&#39;,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;read/write biz user via password&#39;</span><span style="color:#f8f8f8;text-decoration:underline">     </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;+dbrole_offline&#39; ,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow etl offline tasks from intranet&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pgb_default_hba_rules"><code>pgb_default_hba_rules</code></h3>
<p>name: <code>pgb_default_hba_rules</code>, type: <code>hba[]</code>, level: <code>G/C</code></p>
<p>pgbouncer default host-based authentication rules, array or <a href="/docs/pgsql/hba/#define-hba">hba</a> rule object.</p>
<p>default value provides a fair enough security level for common scenarios, check <a href="/docs/pgsql/hba/">PGSQL Authentication</a> for details.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pgb_default_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># pgbouncer default host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${dbsu}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">,db: pgbouncer   ,addr: local     ,auth: peer  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;dbsu local admin access with os ident&#39;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;all&#39;        ,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow all user local access with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: pgbouncer   ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor access via intranet with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${monitor}&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: deny  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;reject all other monitor access addr&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;admin access via intranet with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;${admin}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:bold">,db: all         ,addr: world     ,auth: deny  ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;reject all other admin access addr&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#204a87;font-weight:bold">user: &#39;all&#39;        ,db: all         ,addr: intra     ,auth: pwd   ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow all user intra access with pwd&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><hr>
<h2 id="pg_backup"><code>PG_BACKUP</code></h2>
<p>This section defines variables for <a href="https://pgbackrest.org/">pgBackRest</a>, which is used for PGSQL PITR (Point-In-Time-Recovery).</p>
<p>Check <a href="/docs/pgsql/pitr/">PGSQL Backup &amp; PITR</a> for details.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pgbackrest_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># enable pgbackrest on pgsql host?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbackrest_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># remove pg backup data during init?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbackrest_log_dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/log/pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pgbackrest log dir, `/pg/log/pgbackrest` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbackrest_method: local          # pgbackrest repo method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local,minio,[user-defined...]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbackrest_repo:                  # pgbackrest repo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://pgbackrest.org/configuration.html#section-repository</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">local</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># default pgbackrest repo with local posix fs</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/backup             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># local backup directory, `/pg/backup` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">count   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backups by count</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># keep 2, at most 3 full backup when using local fs repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># optional minio repo for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio is s3-compatible, so s3 is used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss.pigsty      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio endpoint domain name, `sss.pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio region, us-east-1 by default, useless for minio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio bucket name, `pgsql` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbackrest           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio user access key for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_key_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">S3User.Backup </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio user secret key for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_uri_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># use path style uri for minio rather than host style</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pgbackrest            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio backup path, default is `/pgbackrest`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storage_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9000</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio port, 9000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storage_ca_file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/etc/pki/ca.crt </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio ca file path, `/etc/pki/ca.crt` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">bundle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">y</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># bundle small files into a single file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">cipher_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aes-256-cbc     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># enable AES encryption for remote backup repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">cipher_pass</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgBackRest      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># AES encryption password, default is &#39;pgBackRest&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">time    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backup by time on minio repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">14</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># keep full backup for last 14 days</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pgbackrest_enabled"><code>pgbackrest_enabled</code></h3>
<p>name: <code>pgbackrest_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable pgBackRest on pgsql host? default value is <code>true</code></p>
<h3 id="pgbackrest_clean"><code>pgbackrest_clean</code></h3>
<p>name: <code>pgbackrest_clean</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>remove pg backup data during init?  default value is <code>true</code></p>
<h3 id="pgbackrest_log_dir"><code>pgbackrest_log_dir</code></h3>
<p>name: <code>pgbackrest_log_dir</code>, type: <code>path</code>, level: <code>C</code></p>
<p>pgBackRest log dir, <code>/pg/log/pgbackrest</code> by default, which is referenced by <a href="/docs/reference/param/#promtail"><code>promtail</code></a> the logging agent.</p>
<h3 id="pgbackrest_method"><code>pgbackrest_method</code></h3>
<p>name: <code>pgbackrest_method</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>pgBackRest repo method: <code>local</code>, <code>minio</code>, or other user-defined methods, <code>local</code> by default</p>
<p>This parameter is used to determine which repo to use for pgBackRest, all available repo methods are defined in <a href="/docs/reference/param/#pgbackrest_repo"><code>pgbackrest_repo</code></a>.</p>
<p>Pigsty will use <code>local</code> backup repo by default, which will create a backup repo on primary instance&rsquo;s <code>/pg/backup</code> directory. The underlying storage is specified by <a href="/docs/reference/param/#pg_fs_bkup"><code>pg_fs_bkup</code></a>.</p>
<h3 id="pgbackrest_repo"><code>pgbackrest_repo</code></h3>
<p>name: <code>pgbackrest_repo</code>, type: <code>dict</code>, level: <code>G/C</code></p>
<p>pgBackRest repo document: <a href="https://pgbackrest.org/configuration.html#section-repository">https://pgbackrest.org/configuration.html#section-repository</a></p>
<p>default value includes two repo methods: <code>local</code> and <code>minio</code>, which are defined as follows:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pgbackrest_repo:                  # pgbackrest repo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://pgbackrest.org/configuration.html#section-repository</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">local</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># default pgbackrest repo with local posix fs</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/backup             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># local backup directory, `/pg/backup` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">count   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backups by count</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># keep 2, at most 3 full backup when using local fs repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># optional minio repo for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio is s3-compatible, so s3 is used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss.pigsty      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio endpoint domain name, `sss.pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio region, us-east-1 by default, useless for minio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio bucket name, `pgsql` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbackrest           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio user access key for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_key_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">S3User.Backup </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio user secret key for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">s3_uri_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># use path style uri for minio rather than host style</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pgbackrest            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio backup path, default is `/pgbackrest`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storage_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9000</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio port, 9000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storage_ca_file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/etc/pki/ca.crt </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio ca file path, `/etc/pki/ca.crt` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">bundle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">y</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># bundle small files into a single file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">cipher_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aes-256-cbc     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># enable AES encryption for remote backup repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">cipher_pass</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgBackRest      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># AES encryption password, default is &#39;pgBackRest&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">time    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backup by time on minio repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">14</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># keep full backup for last 14 days</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><hr>
<h2 id="pg_service"><code>PG_SERVICE</code></h2>
<p>This section is about exposing PostgreSQL service to outside world: including:</p>
<ul>
<li>Exposing different PostgreSQL services on different ports with <code>haproxy</code></li>
<li>Bind an optional L2 VIP to the primary instance with <code>vip-manager</code></li>
<li>Register cluster/instance DNS records with to <code>dnsmasq</code> on infra nodes</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_weight</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#INSTANCE # relative load balance weight in service, 100 by default, 0-255</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_service_dest</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default service destination if svc.dest=&#39;default&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># postgres default service definitions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: primary ,port: 5433 ,dest: default  ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replica ,port: 5434 ,dest: default  ,check: /read-only ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary` || pg_role == `offline` ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: default ,port: 5436 ,dest: postgres ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: offline ,port: 5438 ,dest: postgres ,check: /replica   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `offline` || pg_offline_query ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `replica` &amp;&amp; !pg_offline_query]&#34;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_vip_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># enable a l2 vip for pgsql primary? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_vip_address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">127.0.0.1</span><span style="color:#000">/24     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># vip address in `&lt;ipv4&gt;/&lt;mask&gt;` format, require if vip is enabled</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth0           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># vip network interface to listen, eth0 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dns_suffix</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># pgsql dns suffix, &#39;&#39; by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_dns_target</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">auto              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># auto, primary, vip, none, or ad hoc ip</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_weight"><code>pg_weight</code></h3>
<p>name: <code>pg_weight</code>, type: <code>int</code>, level: <code>G</code></p>
<p>relative load balance weight in service, 100 by default, 0-255</p>
<p>default values: <code>100</code>. you have to define it at instance vars, and <a href="/docs/pgsql/admin/#reload-service">reload-service</a> to take effect.</p>
<h3 id="pg_service_provider"><code>pg_service_provider</code></h3>
<p>name: <code>pg_service_provider</code>, type: <code>string</code>, level: <code>G/C</code></p>
<p>dedicate haproxy node group name, or empty string for local nodes by default.</p>
<p>If specified, PostgreSQL Services will be registered to the dedicated haproxy node group instead of this pgsql cluster nodes.</p>
<p>Do remember to allocate <strong>unique</strong> ports on dedicate haproxy nodes for each service!</p>
<p>For example, if we define following parameters on 3-node <code>pg-test</code> cluster:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_service_provider</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">infra      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># use load balancer on group `infra`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># alloc port 10001 and 10002 for pg-test primary/replica service  </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: primary ,port: 10001 ,dest: postgres  ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replica ,port: 10002 ,dest: postgres  ,check: /read-only ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary` || pg_role == `offline` ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_default_service_dest"><code>pg_default_service_dest</code></h3>
<p>name: <code>pg_default_service_dest</code>, type: <code>enum</code>, level: <code>G/C</code></p>
<p>When defining a <a href="/docs/pgsql/svc/#define-service">service</a>, if svc.dest=&lsquo;default&rsquo;, this parameter will be used as the default value.</p>
<p>default values: <code>pgbouncer</code>, means 5433 primary service and 5434 replica service will route traffic to pgbouncer by default.</p>
<p>If you don&rsquo;t want to use pgbouncer, set it to <code>postgres</code> instead. traffic will be route to postgres directly.</p>
<h3 id="pg_default_services"><code>pg_default_services</code></h3>
<p>name: <code>pg_default_services</code>, type: <code>service[]</code>, level: <code>G/C</code></p>
<p>postgres default service definitions</p>
<p>default value is four default services definition, which is explained in <a href="/docs/pgsql/svc/#service">PGSQL Service</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_default_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># postgres default service definitions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: primary ,port: 5433 ,dest: default  ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: replica ,port: 5434 ,dest: default  ,check: /read-only ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary` || pg_role == `offline` ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: default ,port: 5436 ,dest: postgres ,check: /primary   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: offline ,port: 5438 ,dest: postgres ,check: /replica   ,selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `offline` || pg_offline_query ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `replica` &amp;&amp; !pg_offline_query]&#34;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_vip_enabled"><code>pg_vip_enabled</code></h3>
<p>name: <code>pg_vip_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable a l2 vip for pgsql primary?</p>
<p>default value is <code>false</code>, means no L2 VIP is created for this cluster.</p>
<p>L2 VIP can only be used in same L2 network, which may incurs extra restrictions on your network topology.</p>
<h3 id="pg_vip_address"><code>pg_vip_address</code></h3>
<p>name: <code>pg_vip_address</code>, type: <code>cidr4</code>, level: <code>C</code></p>
<p>vip address in <code>&lt;ipv4&gt;/&lt;mask&gt;</code> format, if vip is enabled, this parameter is required.</p>
<p>default values: <code>127.0.0.1/24</code>. This value is consist of two parts: <code>ipv4</code> and <code>mask</code>, separated by <code>/</code>.</p>
<h3 id="pg_vip_interface"><code>pg_vip_interface</code></h3>
<p>name: <code>pg_vip_interface</code>, type: <code>string</code>, level: <code>C/I</code></p>
<p>vip network interface to listen, <code>eth0</code> by default.</p>
<p>It should be the same primary intranet interface of your node, which is the IP address you used in the inventory file.</p>
<p>If your node have different interface, you can override it on instance vars:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg-test</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role: replica ,pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth0 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 2, pg_role: primary ,pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth1 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.13</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:bold">pg_seq: 3, pg_role: replica ,pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth2 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_vip_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># enable L2 VIP for this cluster, bind to primary instance by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_vip_address: 10.10.10.3/24 # the L2 network CIDR: 10.10.10.0/24, the vip address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># pg_vip_interface: eth1      # if your node have non-uniform interface, you can define it here</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_dns_suffix"><code>pg_dns_suffix</code></h3>
<p>name: <code>pg_dns_suffix</code>, type: <code>string</code>, level: <code>C</code></p>
<p>pgsql dns suffix, &rsquo;&rsquo; by default, cluster DNS name is defined as <code>{{ pg_cluster }}{{ pg_dns_suffix }}</code></p>
<p>For example, if you set <code>pg_dns_suffix</code> to <code>.db.vip.company.tld</code> for cluster <code>pg-test</code>, then the cluster DNS name will be <code>pg-test.db.vip.company.tld</code></p>
<h3 id="pg_dns_target"><code>pg_dns_target</code></h3>
<p>name: <code>pg_dns_target</code>, type: <code>enum</code>, level: <code>C</code></p>
<p>Could be: <code>auto</code>, <code>primary</code>, <code>vip</code>, <code>none</code>, or an ad hoc ip address, which will be the target IP address of cluster DNS record.</p>
<p>default values: <code>auto</code> , which will bind to <code>pg_vip_address</code> if <code>pg_vip_enabled</code>, or fallback to cluster primary instance ip address.</p>
<ul>
<li><code>vip</code>: bind to <code>pg_vip_address</code></li>
<li><code>primary</code>: resolve to cluster primary instance ip address</li>
<li><code>auto</code>: resolve to <code>pg_vip_address</code> if <code>pg_vip_enabled</code>, or fallback to cluster primary instance ip address.</li>
<li><code>none</code>: do not bind to any ip address</li>
<li><code>&lt;ipv4&gt;</code>: bind to the given IP address</li>
</ul>
<hr>
<h2 id="pg_exporter"><code>PG_EXPORTER</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># enable pg_exporter on pgsql hosts?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_config</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_exporter.yml   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pg_exporter configuration file name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_cache_ttls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;1,10,60,300&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># pg_exporter collector ttl stage in seconds, &#39;1,10,60,300&#39; by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9630</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># pg_exporter listen port, 9630 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_params</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;sslmode=disable&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># extra url parameters for pg_exporter dsn</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># overwrite auto-generate pg dsn if specified</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_auto_discovery</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># enable auto database discovery? enabled by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_exclude_database</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;template0,template1,postgres&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># csv of database that WILL NOT be monitored during auto-discovery</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_include_database</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># csv of database that WILL BE monitored during auto-discovery</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_connect_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">200</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># pg_exporter connect timeout in ms, 200 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># overwrite extra options for pg_exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># enable pgbouncer_exporter on pgsql hosts?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9631</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># pgbouncer_exporter listen port, 9631 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># overwrite auto-generate pgbouncer dsn if specified</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># overwrite extra options for pgbouncer_exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_exporter_enabled"><code>pg_exporter_enabled</code></h3>
<p>name: <code>pg_exporter_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable pg_exporter on pgsql hosts?</p>
<p>default value is <code>true</code>, if you don&rsquo;t want to install pg_exporter, set it to <code>false</code>.</p>
<h3 id="pg_exporter_config"><code>pg_exporter_config</code></h3>
<p>name: <code>pg_exporter_config</code>, type: <code>string</code>, level: <code>C</code></p>
<p>pg_exporter configuration file name, used by <code>pg_exporter</code> &amp; <code>pgbouncer_exporter</code></p>
<p>default values: <code>pg_exporter.yml</code>, if you want to use a custom configuration file, you can specify its relative path here.</p>
<p>Your config file should be placed in <code>files/&lt;filename&gt;.yml</code>. For example, if you want to monitor a remote PolarDB instance, you can use the sample config: <code>files/polar_exporter.yml</code>.</p>
<h3 id="pg_exporter_cache_ttls"><code>pg_exporter_cache_ttls</code></h3>
<p>name: <code>pg_exporter_cache_ttls</code>, type: <code>string</code>, level: <code>C</code></p>
<p>pg_exporter collector ttl stage in seconds, &lsquo;1,10,60,300&rsquo; by default</p>
<p>default values: <code>1,10,60,300</code>, which will use 1s, 10s, 60s, 300s for different metric collectors.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">ttl_fast</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ pg_exporter_cache_ttls.split(&#39;,&#39;)[0]|int }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># critical queries</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ttl_norm</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ pg_exporter_cache_ttls.split(&#39;,&#39;)[1]|int }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># common queries</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ttl_slow</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ pg_exporter_cache_ttls.split(&#39;,&#39;)[2]|int }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># slow queries (e.g table size)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ttl_slowest</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ pg_exporter_cache_ttls.split(&#39;,&#39;)[3]|int }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># ver slow queries (e.g bloat)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="pg_exporter_port"><code>pg_exporter_port</code></h3>
<p>name: <code>pg_exporter_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>pg_exporter listen port, 9630 by default</p>
<h3 id="pg_exporter_params"><code>pg_exporter_params</code></h3>
<p>name: <code>pg_exporter_params</code>, type: <code>string</code>, level: <code>C</code></p>
<p>extra url parameters for pg_exporter dsn</p>
<p>default values: <code>sslmode=disable</code>, which will disable SSL for monitoring connection (since it&rsquo;s local unix socket by default)</p>
<h3 id="pg_exporter_url"><code>pg_exporter_url</code></h3>
<p>name: <code>pg_exporter_url</code>, type: <code>pgurl</code>, level: <code>C</code></p>
<p>overwrite auto-generate pg dsn if specified</p>
<p>default value is empty string, If specified, it will be used as the pg_exporter dsn instead of constructing from other parameters:</p>
<p>This could be useful if you want to monitor a remote pgsql instance, or you want to use a different user/password for monitoring.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#4e9a06">&#39;postgres://{{ pg_monitor_username }}:{{ pg_monitor_password }}@{{ pg_host }}:{{ pg_port }}/postgres{% if pg_exporter_params != &#39;&#39; %}?{{ pg_exporter_params }}{% endif %}&#39;</span>
</span></span></code></pre></div><h3 id="pg_exporter_auto_discovery"><code>pg_exporter_auto_discovery</code></h3>
<p>name: <code>pg_exporter_auto_discovery</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable auto database discovery? enabled by default</p>
<p>default value is <code>true</code>, which will auto-discover all databases on the postgres server and spawn a new pg_exporter connection for each database.</p>
<h3 id="pg_exporter_exclude_database"><code>pg_exporter_exclude_database</code></h3>
<p>name: <code>pg_exporter_exclude_database</code>, type: <code>string</code>, level: <code>C</code></p>
<p>csv of database that WILL NOT be monitored during auto-discovery</p>
<p>default values: <code>template0,template1,postgres</code>, which will be excluded for database auto discovery.</p>
<h3 id="pg_exporter_include_database"><code>pg_exporter_include_database</code></h3>
<p>name: <code>pg_exporter_include_database</code>, type: <code>string</code>, level: <code>C</code></p>
<p>csv of database that WILL BE monitored during auto-discovery</p>
<p>default value is empty string. If this value is set, only the databases in this list will be monitored during auto discovery.</p>
<h3 id="pg_exporter_connect_timeout"><code>pg_exporter_connect_timeout</code></h3>
<p>name: <code>pg_exporter_connect_timeout</code>, type: <code>int</code>, level: <code>C</code></p>
<p>pg_exporter connect timeout in ms, 200 by default</p>
<p>default values: <code>200</code>ms , which is enough for most cases.</p>
<p>If your remote pgsql server is in another continent, you may want to increase this value to avoid connection timeout.</p>
<h3 id="pg_exporter_options"><code>pg_exporter_options</code></h3>
<p>name: <code>pg_exporter_options</code>, type: <code>arg</code>, level: <code>C</code></p>
<p>overwrite extra options for pg_exporter</p>
<p>default value is empty string, which will fall back the following default options:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>--log.level=info
</span></span></code></pre></div><p>If you want to customize logging options or other pg_exporter options, you can set it here.</p>
<h3 id="pgbouncer_exporter_enabled"><code>pgbouncer_exporter_enabled</code></h3>
<p>name: <code>pgbouncer_exporter_enabled</code>, type: <code>bool</code>, level: <code>C</code></p>
<p>enable pgbouncer_exporter on pgsql hosts?</p>
<p>default value is <code>true</code>, which will enable pg_exporter for pgbouncer connection pooler.</p>
<h3 id="pgbouncer_exporter_port"><code>pgbouncer_exporter_port</code></h3>
<p>name: <code>pgbouncer_exporter_port</code>, type: <code>port</code>, level: <code>C</code></p>
<p>pgbouncer_exporter listen port, 9631 by default</p>
<p>default values: <code>9631</code></p>
<h3 id="pgbouncer_exporter_url"><code>pgbouncer_exporter_url</code></h3>
<p>name: <code>pgbouncer_exporter_url</code>, type: <code>pgurl</code>, level: <code>C</code></p>
<p>overwrite auto-generate pgbouncer dsn if specified</p>
<p>default value is empty string,  If specified, it will be used as the pgbouncer_exporter dsn instead of constructing from other parameters:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#4e9a06">&#39;postgres://{{ pg_monitor_username }}:{{ pg_monitor_password }}@:{{ pgbouncer_port }}/pgbouncer?host={{ pg_localhost }}&amp;sslmode=disable&#39;</span>
</span></span></code></pre></div><p>This could be useful if you want to monitor a remote pgbouncer instance, or you want to use a different user/password for monitoring.</p>
<h3 id="pgbouncer_exporter_options"><code>pgbouncer_exporter_options</code></h3>
<p>name: <code>pgbouncer_exporter_options</code>, type: <code>arg</code>, level: <code>C</code></p>
<p>overwrite extra options for pgbouncer_exporter, default value is empty string.</p>
<p><code>--log.level=info</code></p>
<p>default value is empty string, which will fall back the following default options:</p>
<p>If you want to customize logging options or other pgbouncer_exporter options, you can set it here.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e702b44e01d91c35371415f67a25ac19">3 - Extension List</h1>
    <div class="lead">List of PostgreSQL extensions supported by Pigsty, and their compatibility on different OS distros.</div>
	<p>Pigsty has rich support for PostgreSQL <a href="/docs/pgext/list/">extensions</a>, including <em>390</em>* <a href="/docs/pgext/list/rpm/"><strong>RPM extensions</strong></a> and <strong>189</strong> <a href="/docs/pgext/list/deb/"><strong>DEB extensions</strong></a>.</p>
<p><a href="/docs/pgext/list/"><img alt="pigsty-ecosystem.jpg" src="/img/pigsty/ecosystem.jpg"></a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-eccd19a576ee933ff16667af4533c033">4 - File Hierarchy</h1>
    <div class="lead">How files are organized in Pigsty, and directories structure used by modules</div>
	<hr>
<h2 id="pigsty-fhs">Pigsty FHS</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># pigsty</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@app                    # extra demo application resources</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@bin                    # bin scripts</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@docs                   # document (can be docsified)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@files                  # ansible file resources </span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@pigsty       # pigsty config template files</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@prometheus   # prometheus rules definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@grafana      # grafana dashboards</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@postgres     # /pg/bin/ scripts</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@migration    # pgsql migration task definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@pki          # self-signed CA &amp; certs</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@roles                  # ansible business logic</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@templates              # ansible templates</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@vagrant                # vagrant local VM template</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@terraform              # terraform cloud VM template</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----configure               # configure wizard script</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----ansible.cfg             # default ansible config file</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----pigsty.yml              # default config file</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----*.yml                   # ansible playbooks</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># /etc/pigsty/</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@targets                # file based service discovery targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@dashboards             # static grafana dashboards</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@datasources            # static grafana datasource</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@playbooks              # extra ansible playbooks</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span>
</span></span></code></pre></div><hr>
<h2 id="ca-fhs">CA FHS</h2>
<p>Pigsty&rsquo;s self-signed CA is located on <code>files/pki/</code> directory under pigsty home.</p>
<p><strong>YOU HAVE TO SECURE THE CA KEY PROPERLY</strong>: <code>files/pki/ca/ca.key</code>,
which is generated by the <a href="https://github.com/Vonng/pigsty/tree/master/roles/ca"><code>ca</code></a> role during <code>install.yml</code> or <code>infra.yml</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># pigsty/files/pki</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@ca                      # self-signed CA key &amp; cert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#         ^-----@ca.key           # VERY IMPORTANT: keep it secret</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#         ^-----@ca.crt           # VERY IMPORTANT: trusted everywhere</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@csr                     # signing request csr</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@misc                    # misc certs, issued certs</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@etcd                    # etcd server certs</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@minio                   # minio server certs</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@nginx                   # nginx SSL certs</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@infra                   # infra client certs</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@pgsql                   # pgsql server certs</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@mongo                   # mongodb/ferretdb server certs</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@mysql                   # mysql server certs</span>
</span></span></code></pre></div><p>The managed nodes will have the following files installed:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>/etc/pki/ca.crt                             # all nodes
</span></span><span style="display:flex;"><span>/etc/pki/ca-trust/source/anchors/ca.crt     # soft link and trusted anchor
</span></span></code></pre></div><p>All infra nodes will have the following certs:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>/etc/pki/infra.crt                          # infra nodes cert
</span></span><span style="display:flex;"><span>/etc/pki/infra.key                          # infra nodes key
</span></span></code></pre></div><p>In case of admin node failure, you have to keep <code>files/pki</code> and <code>pigsty.yml</code> safe.
You can <code>rsync</code> them to another admin node to make a backup admin node.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># run on meta-1, rsync to meta2</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>rsync -avz ./ meta-2:~/pigsty  
</span></span></code></pre></div><hr>
<h2 id="node-fhs">NODE FHS</h2>
<p>Node main data dir is specified by <a href="/docs/reference/param/#node_data"><code>node_data</code></a> parameter, which is <code>/data</code> by default.</p>
<p>The data dir is owned by root with mode <code>0777</code>. All modules&rsquo; local data will be stored under this directory by default.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/data
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@postgres                   # postgres main data dir</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@backups                    # postgres backup data dir (if no dedicated backup disk)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@redis                      # redis data dir (shared by multiple redis instances)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@minio                      # minio data dir (default when in single node single disk mode)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@etcd                       # etcd main data dir</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@prometheus                 # prometheus time series data dir</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@loki                       # Loki data dir for logs</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@docker                     # Docker data dir</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@...                        # other modules</span>
</span></span></code></pre></div><hr>
<h2 id="prometheus-fhs">Prometheus FHS</h2>
<p>The prometheus bin / rules are located on <a href="https://github.com/Vonng/pigsty/tree/master/files/prometheus"><code>files/prometheus/</code></a> directory under pigsty home.</p>
<p>While the main config file is located on <a href="https://github.com/Vonng/pigsty/blob/main/roles/infra/templates/prometheus/prometheus.yml.j2"><code>roles/infra/templates/prometheus/prometheus.yml.j2</code></a> and rendered to <code>/etc/prometheus/prometheus.yml</code> on infra nodes.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># /etc/prometheus/</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----prometheus.yml              # prometheus main config file</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@bin                        # util scripts: check,reload,status,new</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@rules                      # record &amp; alerting rules definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----agent.yml         # agent rules &amp; alert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----infra.yml         # infra rules &amp; alert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----node.yml          # node  rules &amp; alert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----pgsql.yml         # pgsql rules &amp; alert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----redis.yml         # redis rules &amp; alert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----minio.yml         # minio rules &amp; alert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----etcd.yml          # etcd  rules &amp; alert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----mongo.yml         # mongo rules &amp; alert</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----mysql.yml         # mysql rules &amp; alert (placeholder)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#  ^-----@targets                    # file based service discovery targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@infra            # infra static targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@node             # nodes static targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@etcd             # etcd static targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@minio            # minio static targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@ping             # blackbox ping targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@pgsql            # pgsql static targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@pgrds            # pgsql remote rds static targets</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@redis            # redis static targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@mongo            # mongo static targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@mysql            # mysql static targets definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@ping             # ping  static target definition</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@patroni          # patroni static target defintion (when ssl enabled)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#            ^-----@.....            # other targets</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># /etc/alertmanager.yml              # alertmanager main config file</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># /etc/blackbox.yml                  # blackbox exporter main config file</span>
</span></span></code></pre></div><hr>
<h2 id="postgres-fhs">Postgres FHS</h2>
<p>The following parameters are related to the PostgreSQL database dir:</p>
<ul>
<li><a href="/docs/reference/param/#pg_dbsu_home">pg_dbsu_home</a>: Postgres default user&rsquo;s home dir, default is <code>/var/lib/pgsql</code>.</li>
<li><a href="/docs/reference/param/#pg_bin_dir">pg_bin_dir</a>: Postgres binary dir, defaults to <code>/usr/pgsql/bin/</code>.</li>
<li><a href="/docs/reference/param/#pg_data">pg_data</a>: Postgres database dir, default is <code>/pg/data</code>.</li>
<li><a href="/docs/reference/param/#pg_fs_main">pg_fs_main</a>: Postgres main data disk mount point, default is <code>/data</code>.</li>
<li><a href="/docs/reference/param/#pg_fs_bkup">pg_fs_bkup</a>: Postgres backup disk mount point, default is <code>/data/backups</code> (used when using local backup repo).</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#--------------------------------------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># Create Directory</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#--------------------------------------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># assumption:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#   {{ pg_fs_main }} for main data   , default: `/data`              [fast ssd]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#   {{ pg_fs_bkup }} for backup data , default: `/data/backups`     [cheap hdd]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#--------------------------------------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># default variable:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#     pg_fs_main = /data             fast ssd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#     pg_fs_bkup = /data/backups     cheap hdd (optional)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#     /pg      -&gt; /data/postgres/pg-test-15    (soft link)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#     /pg/data -&gt; /data/postgres/pg-test-15/data</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#--------------------------------------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">create postgresql directories</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">tags</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_dir</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">become</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">yes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">block</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">make main and backup data dir</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path={{ item }} state=directory owner=root mode=0777</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">with_items</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_fs_main }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_fs_bkup }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># pg_cluster_dir:    &#34;{{ pg_fs_main }}/postgres/{{ pg_cluster }}-{{ pg_version }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">create postgres directories</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path={{ item }} state=directory owner={{ pg_dbsu }} group=postgres mode=0700</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">with_items</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_fs_main }}/postgres&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/bin&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/log&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/tmp&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/cert&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/conf&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/data&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/meta&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/stat&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_cluster_dir }}/change&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;{{ pg_backup_dir }}/backup&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>Data FHS</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># real dirs</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{{</span> pg_fs_main <span style="color:#ce5c00;font-weight:bold">}}</span>     /data                      <span style="color:#8f5902;font-style:italic"># top level data directory, usually a SSD mountpoint</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{{</span> pg_dir_main <span style="color:#ce5c00;font-weight:bold">}}</span>    /data/postgres             <span style="color:#8f5902;font-style:italic"># contains postgres data</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{{</span> pg_cluster_dir <span style="color:#ce5c00;font-weight:bold">}}</span> /data/postgres/pg-test-15  <span style="color:#8f5902;font-style:italic"># contains cluster `pg-test` data (of version 15)</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/bin            <span style="color:#8f5902;font-style:italic"># bin scripts</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/log            <span style="color:#8f5902;font-style:italic"># logs: postgres/pgbouncer/patroni/pgbackrest</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/tmp            <span style="color:#8f5902;font-style:italic"># tmp, sql files, rendered results</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/cert           <span style="color:#8f5902;font-style:italic"># postgres server certificates</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/conf           <span style="color:#8f5902;font-style:italic"># patroni config, links to related config</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/data           <span style="color:#8f5902;font-style:italic"># main data directory</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/meta           <span style="color:#8f5902;font-style:italic"># identity information</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/stat           <span style="color:#8f5902;font-style:italic"># stats information, summary, log report</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/change         <span style="color:#8f5902;font-style:italic"># changing records</span>
</span></span><span style="display:flex;"><span>                     /data/postgres/pg-test-15/backup         <span style="color:#8f5902;font-style:italic"># soft link to backup dir</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{{</span> pg_fs_bkup <span style="color:#ce5c00;font-weight:bold">}}</span>     /data/backups                            <span style="color:#8f5902;font-style:italic"># could be a cheap &amp; large HDD mountpoint</span>
</span></span><span style="display:flex;"><span>                     /data/backups/postgres/pg-test-15/backup <span style="color:#8f5902;font-style:italic"># local backup repo path</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># soft links</span>
</span></span><span style="display:flex;"><span>/pg             -&gt;   /data/postgres/pg-test-15                <span style="color:#8f5902;font-style:italic"># pg root link</span>
</span></span><span style="display:flex;"><span>/pg/data        -&gt;   /data/postgres/pg-test-15/data           <span style="color:#8f5902;font-style:italic"># real data dir</span>
</span></span><span style="display:flex;"><span>/pg/backup      -&gt;   /var/backups/postgres/pg-test-15/backup  <span style="color:#8f5902;font-style:italic"># base backup</span>
</span></span></code></pre></div><p><strong>Binary FHS</strong></p>
<p>On EL releases, the default path for PostgreSQL binaries is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/pgsql-<span style="color:#4e9a06">${</span><span style="color:#000">pg_version</span><span style="color:#4e9a06">}</span>/
</span></span></code></pre></div><p>Pigsty will create a softlink <code>/usr/pgsql</code> to the currently installed version specified by <a href="/docs/reference/param/#pg_version"><code>pg_version</code></a>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/pgsql -&gt; /usr/pgsql-15
</span></span></code></pre></div><p>Therefore, the default <a href="/docs/reference/param/#pg_bin_dir"><code>pg_bin_dir</code></a> will be <code>/usr/pgsql/bin/</code>, and this path is added to the <code>PATH</code> environment via <code>/etc/profile.d/pgsql.sh</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PATH</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;/usr/pgsql/bin:/pg/bin:</span><span style="color:#000">$PATH</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PGHOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/usr/pgsql
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PGDATA</span><span style="color:#ce5c00;font-weight:bold">=</span>/pg/data
</span></span></code></pre></div><p>For Ubuntu / Debian, the default path for PostgreSQL binaries is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/lib/postgresql/<span style="color:#4e9a06">${</span><span style="color:#000">pg_version</span><span style="color:#4e9a06">}</span>/bin
</span></span></code></pre></div><hr>
<h2 id="pgbouncer-fhs">Pgbouncer FHS</h2>
<p>Pgbouncer is run using the Postgres user, and the config file is located in <code>/etc/pgbouncer</code>. The config file includes.</p>
<ul>
<li><code>pgbouncer.ini</code>: pgbouncer main config</li>
<li><code>database.txt</code>: pgbouncer database list</li>
<li><code>userlist.txt</code>: pgbouncer user list</li>
<li><code>useropts.txt</code>: pgbouncer user options (user-level parameter overrides)</li>
<li><code>pgb_hba.conf</code>: lists the access privileges of the connection pool users</li>
</ul>
<hr>
<h2 id="redis-fhs">Redis FHS</h2>
<p>Pigsty provides essential support for Redis deployment and monitoring.</p>
<p>Redis binaries are installed in <code>/bin/</code> using RPM-packages or copied binaries, including:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>redis-server    
</span></span><span style="display:flex;"><span>redis-server    
</span></span><span style="display:flex;"><span>redis-cli       
</span></span><span style="display:flex;"><span>redis-sentinel  
</span></span><span style="display:flex;"><span>redis-check-rdb 
</span></span><span style="display:flex;"><span>redis-check-aof 
</span></span><span style="display:flex;"><span>redis-benchmark 
</span></span><span style="display:flex;"><span>/usr/libexec/redis-shutdown
</span></span></code></pre></div><p>For a Redis instance named <code>redis-test-1-6379</code>, the resources associated with it are shown below:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/lib/systemd/system/redis-test-1-6379.service               <span style="color:#8f5902;font-style:italic"># Services (&#39;/lib/systemd&#39; in debian)</span>
</span></span><span style="display:flex;"><span>/etc/redis/redis-test-1-6379.conf                               <span style="color:#8f5902;font-style:italic"># Config </span>
</span></span><span style="display:flex;"><span>/data/redis/redis-test-1-6379                                   <span style="color:#8f5902;font-style:italic"># Database Catalog</span>
</span></span><span style="display:flex;"><span>/data/redis/redis-test-1-6379/redis-test-1-6379.rdb             <span style="color:#8f5902;font-style:italic"># RDB File</span>
</span></span><span style="display:flex;"><span>/data/redis/redis-test-1-6379/redis-test-1-6379.aof             <span style="color:#8f5902;font-style:italic"># AOF file</span>
</span></span><span style="display:flex;"><span>/var/log/redis/redis-test-1-6379.log                            <span style="color:#8f5902;font-style:italic"># Log</span>
</span></span><span style="display:flex;"><span>/var/run/redis/redis-test-1-6379.pid                            <span style="color:#8f5902;font-style:italic"># PID</span>
</span></span></code></pre></div><p>For Ubuntu / Debian, the default systemd service dir is <code>/lib/systemd/system/</code> instead of <code>/usr/lib/systemd/system/</code>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-84ae7ee461c44a3c65150c096169dfc2">5 - Comparison</h1>
    <div class="lead">Comparing products such as RDS and projects that has feature overlap with Pigsty</div>
	<hr>
<h2 id="comparing-to-rds">Comparing to RDS</h2>
<p><a href="https://pigsty.io/">
Pigsty</a> is an AGPLv3-licensed, local-first RDS alternative that can be deployed on your own physical machines/virtual machines, or on cloud servers.</p>
<p>Therefore, we chose the world&rsquo;s leading Amazon Cloud <a href="https://aws.amazon.com/cn/rds/postgresql/">AWS RDS for PostgreSQL</a> and China&rsquo;s market leader Alibaba Cloud <a href="https://www.alibabacloud.com/zh/product/apsaradb-for-rds-postgresql">RDS for PostgreSQL</a> as benchmarks.</p>
<p>Both Alibaba Cloud RDS and AWS RDS are proprietary cloud database services, offered only on the public cloud through a leasing model. The following comparison is based on the latest PostgreSQL 16 main branch version, with the comparison cut-off date being February 2024.</p>
<hr>
<h3 id="features">Features</h3>
<table>
<thead>
<tr>
<th><strong>Item</strong></th>
<th><strong>Pigsty</strong></th>
<th><strong>Aliyun RDS</strong></th>
<th><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Major Version</td>
<td>12 - 17</td>
<td>12 - 17</td>
<td>12 - 17</td>
</tr>
<tr>
<td>Read on Standby</td>
<td><i class="fas fa-circle-check text-success"></i> Of course</td>
<td><i class="fas fa-circle-xmark text-danger"></i> Not Readable</td>
<td><i class="fas fa-circle-xmark text-danger"></i> Not Readable</td>
</tr>
<tr>
<td>Separate R &amp; W</td>
<td><i class="fas fa-circle-check text-success"></i> By Port</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> Paid Proxy</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> Paid Proxy</td>
</tr>
<tr>
<td>Offline Instance</td>
<td><i class="fas fa-circle-check text-success"></i> Yes</td>
<td><i class="fas fa-circle-xmark text-danger"></i> Not Available</td>
<td><i class="fas fa-circle-xmark text-danger"></i> Not Available</td>
</tr>
<tr>
<td>Standby Cluster</td>
<td><i class="fas fa-circle-check text-success"></i> Yes</td>
<td><i class="fas fa-circle-check text-success"></i> Multi-AZ</td>
<td><i class="fas fa-circle-check text-success"></i> Multi-AZ</td>
</tr>
<tr>
<td>Delayed Instance</td>
<td><i class="fas fa-circle-check text-success"></i> Yes</td>
<td><i class="fas fa-circle-xmark text-danger"></i> Not Available</td>
<td><i class="fas fa-circle-xmark text-danger"></i> Not Available</td>
</tr>
<tr>
<td>Load Balancer</td>
<td><i class="fas fa-circle-check text-success"></i> HAProxy / LVS</td>
<td><i class="fas fa-circle-check text-secondary"></i> Paid ELB</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> Paid ELB</td>
</tr>
<tr>
<td>Connection Pooling</td>
<td><i class="fas fa-circle-check text-success"></i> Pgbouncer</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i>Paid Proxy</td>
<td><i class="fa-solid fa-triangle-exclamation text-secondary"></i> Paid RDS Proxy</td>
</tr>
<tr>
<td>High Availability</td>
<td><i class="fas fa-circle-check text-success"></i> Patroni / etcd</td>
<td><i class="fas fa-circle-check text-success"></i> HA Version Only</td>
<td><i class="fas fa-circle-check text-success"></i> HA Version Only</td>
</tr>
<tr>
<td>Point-in-Time Recovery</td>
<td><i class="fas fa-circle-check text-success"></i> pgBackRest / MinIO</td>
<td><i class="fas fa-circle-check text-success"></i> Yes</td>
<td><i class="fas fa-circle-check text-success"></i> Yes</td>
</tr>
<tr>
<td>Monitoring Metrics</td>
<td><i class="fas fa-circle-check text-success"></i> Prometheus / Exporter</td>
<td><i class="fas fa-circle-check text-secondary"></i> About 9 Metrics</td>
<td><i class="fas fa-circle-check text-secondary"></i> About 99 Metrics</td>
</tr>
<tr>
<td>Logging Collector</td>
<td><i class="fas fa-circle-check text-success"></i> Loki / Promtail</td>
<td><i class="fas fa-circle-check text-success"></i> Yes</td>
<td><i class="fas fa-circle-check text-success"></i> Yes</td>
</tr>
<tr>
<td>Dashboards</td>
<td><i class="fas fa-circle-check text-success"></i> Grafana / Echarts</td>
<td><i class="fas fa-circle-check text-secondary"></i> Basic Support</td>
<td><i class="fas fa-circle-check text-secondary"></i> Basic Support</td>
</tr>
<tr>
<td>Alerts</td>
<td><i class="fas fa-circle-check text-success"></i> AlterManager</td>
<td><i class="fas fa-circle-check text-success"></i> Basic Support</td>
<td><i class="fas fa-circle-check text-success"></i> Basic Support</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="extensions">Extensions</h3>
<p>Here are some important extensions in the PostgreSQL ecosystem. The comparison is base on PostgreSQL 16 and complete on 2024-02-29:</p>
<ul>
<li><a href="/docs/reference/extension/"><strong>Pigsty Extension List</strong></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/PostgreSQLReleaseNotes/postgresql-extensions.html"><strong>AWS RDS for PostgreSQL Extensions</strong></a>:</li>
<li><a href="https://help.aliyun.com/zh/rds/apsaradb-rds-for-postgresql/extensions-supported-by-apsaradb-rds-for-postgresql"><strong>Aliyun RDS for PostgreSQL Extensions</strong></a></li>
</ul>
<table>
<thead>
<tr>
<th><strong>Category</strong></th>
<th><strong>Pigsty</strong></th>
<th style="text-align:center"><strong>Aliyun RDS PG</strong></th>
<th style="text-align:center"><strong>AWS RDS PG</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Add Extension</td>
<td><i class="fas fa-circle-check text-success"></i> Free to Install</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i> Not Allowed</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i> Not Allowed</td>
</tr>
<tr>
<td>Geo Spatial</td>
<td><i class="fas fa-circle-check text-success"></i> PostGIS 3.4.2</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PostGIS 3.3.4</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PostGIS 3.4.1</td>
</tr>
<tr>
<td>Time Series</td>
<td><i class="fas fa-circle-check text-success"></i> TimescaleDB 2.14.2</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Distributive</td>
<td><i class="fas fa-circle-check text-success"></i> Citus 12.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>AI / ML</td>
<td><i class="fas fa-circle-check text-success"></i> PostgresML 2.8.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Columnar</td>
<td><i class="fas fa-circle-check text-success"></i> Hydra 1.1.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Vector</td>
<td><i class="fas fa-circle-check text-success"></i> PGVector 0.6</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pase 0.0.1</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PGVector 0.6</td>
</tr>
<tr>
<td>Sparse Vector</td>
<td><i class="fas fa-circle-check text-success"></i> PG Sparse 0.5.6</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Full-Text Search</td>
<td><i class="fas fa-circle-check text-success"></i> pg_bm25 0.5.6<br /></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Graph</td>
<td><i class="fas fa-circle-check text-success"></i> Apache AGE 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>GraphQL</td>
<td><i class="fas fa-circle-check text-success"></i> PG GraphQL 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Message Queue</td>
<td><i class="fas fa-circle-check text-success"></i> pgq 3.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>OLAP</td>
<td><i class="fas fa-circle-check text-success"></i> pg_analytics 0.5.6</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>DuckDB</td>
<td><i class="fas fa-circle-check text-success"></i> duckdb_fdw 1.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>CDC</td>
<td><i class="fas fa-circle-check text-success"></i> wal2json 2.5.3</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> wal2json 2.5</td>
</tr>
<tr>
<td>Bloat Control</td>
<td><i class="fas fa-circle-check text-success"></i> pg_repack 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pg_repack 1.4.8</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pg_repack 1.5.0</td>
</tr>
<tr>
<td>Point Cloud</td>
<td><i class="fas fa-circle-check text-success"></i> PG PointCloud 1.2.5</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> Ganos PointCloud 6.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
</tbody>
</table>
<details><summary>AWS RDS 扩展</summary>
<p>AWS RDS for PostgreSQL 16 可用扩展(已刨除PG自带扩展)</p>
<table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">pg16</th>
<th style="text-align:left">pg15</th>
<th style="text-align:left">pg14</th>
<th style="text-align:left">pg13</th>
<th style="text-align:left">pg12</th>
<th style="text-align:left">pg11</th>
<th style="text-align:left">pg10</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">amcheck</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">auto_explain</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
</tr>
<tr>
<td style="text-align:left">autoinc</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">bloom</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">bool_plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">btree_gin</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">btree_gist</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
</tr>
<tr>
<td style="text-align:left">citext</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
</tr>
<tr>
<td style="text-align:left">cube</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">dblink</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">dict_int</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">dict_xsyn</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">earthdistance</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">fuzzystrmatch</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">hstore</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
</tr>
<tr>
<td style="text-align:left">hstore_plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">insert_username</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">intagg</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">intarray</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">isn</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">jsonb_plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">lo</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">ltree</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">moddatetime</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">old_snapshot</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">pageinspect</td>
<td style="text-align:left">1.12</td>
<td style="text-align:left">1.11</td>
<td style="text-align:left">1.9</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
</tr>
<tr>
<td style="text-align:left">pg_buffercache</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pg_freespacemap</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">pg_prewarm</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">pg_stat_statements</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.9</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
</tr>
<tr>
<td style="text-align:left">pg_trgm</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pg_visibility</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">pg_walinspect</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">pgcrypto</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pgrowlocks</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">pgstattuple</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
</tr>
<tr>
<td style="text-align:left">plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">plpgsql</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">pltcl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">postgres_fdw</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">refint</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">seg</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">sslinfo</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">tablefunc</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">tcn</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">tsm_system_rows</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">tsm_system_time</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">unaccent</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">uuid-ossp</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
</tbody>
</table>
</details>
<details><summary>Aliyun Extensions</summary>
<p>阿里云 RDS for PostgreSQL 16 可用扩展(已刨除PG自带扩展)</p>
<table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">pg16</th>
<th style="text-align:left">pg15</th>
<th style="text-align:left">pg14</th>
<th style="text-align:left">pg13</th>
<th style="text-align:left">pg12</th>
<th style="text-align:left">pg11</th>
<th style="text-align:left">pg10</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">bloom</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">btree_gin</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">btree_gist</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
</tr>
<tr>
<td style="text-align:left">citext</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
</tr>
<tr>
<td style="text-align:left">cube</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">dblink</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">dict_int</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">earthdistance</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">fuzzystrmatch</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">hstore</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
</tr>
<tr>
<td style="text-align:left">intagg</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">intarray</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">isn</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">ltree</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">pg_buffercache</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pg_freespacemap</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">pg_prewarm</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">pg_stat_statements</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.9</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
</tr>
<tr>
<td style="text-align:left">pg_trgm</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.6</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.4</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pgcrypto</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
<td style="text-align:left">1.3</td>
</tr>
<tr>
<td style="text-align:left">pgrowlocks</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">pgstattuple</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
<td style="text-align:left">1.5</td>
</tr>
<tr>
<td style="text-align:left">plperl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">plpgsql</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">pltcl</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">postgres_fdw</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">sslinfo</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
<td style="text-align:left">1.2</td>
</tr>
<tr>
<td style="text-align:left">tablefunc</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">tsm_system_rows</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">tsm_system_time</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">unaccent</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">uuid-ossp</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">xml2</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
<td style="text-align:left">1.1</td>
</tr>
</tbody>
</table>
</details>
<hr>
<h3 id="performance">Performance</h3>
<table>
<thead>
<tr>
<th><strong>Metric</strong></th>
<th><strong>Pigsty</strong></th>
<th><strong>Aliyun RDS</strong></th>
<th><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Best Performance</td>
<td><a href="https://github.com/Vonng/pgtpc/tree/master/sysbench">PGTPC on NVME SSD evaluation</a> sysbench oltp_rw</td>
<td><a href="https://help.aliyun.com/document_detail/101470.html">RDS PG Performance Whitepaper</a> sysbench oltp scenario per-core QPS 4000 ~ 8000</td>
<td></td>
</tr>
<tr>
<td>Storage Specs: Maximum Capacity</td>
<td>32TB / <a href="https://en.shannon-sys.com/product.html?name=gen_4">NVME SSD</a></td>
<td>32 TB / <strong>ESSD PL3</strong></td>
<td>64 TB / <strong>io2</strong> <a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">EBS</a> Block Express</td>
</tr>
<tr>
<td>Storage Specs: Maximum IOPS</td>
<td>4K random read: up to 3M, random write 2000~350K</td>
<td>4K random read: up to 1M</td>
<td>16K random IOPS: 256K</td>
</tr>
<tr>
<td>Storage Specs: Maximum Latency</td>
<td>4K random read: 75µs, random write 15µs</td>
<td>4K random read: 200µs</td>
<td>500µs / inferred for 16K random IO</td>
</tr>
<tr>
<td>Storage Specs: Maximum Reliability</td>
<td>UBER &lt; 1e-18, equivalent to 18 nines MTBF: 2 million hours 5DWPD, for three years</td>
<td>Reliability 9 nines, equivalent to UBER 1e-9 <a href="https://help.aliyun.com/document_detail/476273.html">Storage and Data Reliability</a></td>
<td><strong>Durability</strong>: 99.999%, five nines (0.001% annual failure rate) <a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">io2 details</a></td>
</tr>
<tr>
<td>Storage Specs: Maximum Cost</td>
<td>31.5 ¥/TB·month ( 5-year warranty amortized / 3.2T / enterprise-grade / MLC )</td>
<td>3200¥/TB·month (List price 6400¥, monthly package 4000¥) 3-year prepay total 50% off for this price</td>
<td>1900 ¥/TB·month for using the maximum specs 65536GB / 256K IOPS maximum discount</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="observability">Observability</h3>
<p>Pigsty offers nearly 3000 monitoring metrics, providing over 50 monitoring dashboards, covering database monitoring, host monitoring, connection pool monitoring, load balancing monitoring, etc., offering users an unparalleled observability experience.</p>
<p><img src="/img/pigsty/dashboard.jpg"></p>
<p>Pigsty offers 638 PostgreSQL-related monitoring metrics, while AWS RDS only has 99, and Aliyun RDS has merely single-digit metrics:</p>
<p><img src="/img/docs/compare/aliyun.png"></p>
<p>Additionally, there are some projects that offer the capability to monitor PostgreSQL, but they are relatively basic and simplistic:</p>
<ul>
<li><a href="https://pgwatch.com/">pgwatch</a>:  123 Metrics</li>
<li><a href="https://github.com/CrunchyData/pgmonitor">pgmonitor</a> :  156 Metrics</li>
<li><a href="https://docs.datadoghq.com/integrations/postgres">datadog</a> :  69 Metrics</li>
<li><a href="https://pgdash.io/">pgDash</a></li>
<li><a href="https://severalnines.com/product/clustercontrol">ClusterControl</a></li>
<li><a href="https://pganalyze.com/">pganalyze</a></li>
<li><a href="https://help.aliyun.com/document_detail/102748.html">Aliyun RDS</a> :  8 Metrics</li>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html">AWS RDS</a> :  99 Metrics</li>
<li><a href="https://docs.microsoft.com/en-us/azure/postgresql/">Azure RDS</a></li>
</ul>
<hr>
<h3 id="maintainability">Maintainability</h3>
<table>
<thead>
<tr>
<th>** Metric**</th>
<th><strong>Pigsty</strong></th>
<th><strong>Aliyun RDS</strong></th>
<th><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>System Usability</td>
<td>Simple</td>
<td>Simple</td>
<td>Simple</td>
</tr>
<tr>
<td>Configuration Management</td>
<td>Configuration file / CMDB based on Ansible Inventory</td>
<td>Can use Terraform</td>
<td>Can use Terraform</td>
</tr>
<tr>
<td>Change Method</td>
<td>Idempotent playbooks based on Ansible Playbook</td>
<td>Operations via console</td>
<td>Operations via console</td>
</tr>
<tr>
<td>Parameter Tuning</td>
<td>Automatically adapts based on node with four preset templates: OLTP, OLAP, TINY, CRIT</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Infra as Code</td>
<td>Native support</td>
<td>Can use Terraform</td>
<td>Can use Terraform</td>
</tr>
<tr>
<td>Customizable Parameters</td>
<td><a href="/docs/about/param/">Pigsty Parameters</a> 283 items</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Service and Support</td>
<td>Commercial subscription support available</td>
<td>After-sales ticket support provided</td>
<td>After-sales ticket support provided</td>
</tr>
<tr>
<td>No Internet Deployment</td>
<td>Possible offline installation and deployment</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>Database Migration</td>
<td>playbooks for zero-downtime migration from existing Postgres into Pigsty</td>
<td>Provides cloud migration assistance <a href="https://help.aliyun.com/document_detail/322179.html?spm=a2c4g.11186623.0.0.5fb374c9OOi4Dm">Aliyun RDS Data Synchronization</a></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<h3 id="cost">Cost</h3>
<p>Experience shows that the per-unit cost of hardware and software resources for RDS is 5 to 15 times that of self-built solutions, with the rent-to-own ratio typically being one month. For more details, please refer to <a href="/docs/reference/cost/">Cost Analysis</a>.</p>
<table>
<thead>
<tr>
<th>Factor</th>
<th><strong>Metric</strong></th>
<th><strong>Pigsty</strong></th>
<th><strong>Aliyun RDS</strong></th>
<th><strong>AWS RDS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Cost</td>
<td>Software License/Service Fees</td>
<td>Free, hardware about 20 - 40 ¥/core·month</td>
<td>200 ～ 400 ¥/core·month</td>
<td>400 ~ 1300 ¥/core·month</td>
</tr>
<tr>
<td></td>
<td>Service Support Fees</td>
<td>Service about 100 ¥/ core·month</td>
<td>Included in RDS costs</td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<h2 id="other-vendors">Other Vendors</h2>
<ul>
<li><a href="https://aiven.io/">Aiven</a></li>
<li><a href="https://www.percona.com/software/postgresql-distribution">Percona</a></li>
<li><a href="https://docs.severalnines.com/docs/clustercontrol/">ClusterControl</a></li>
<li>……</li>
</ul>
<hr>
<h2 id="kubernetes-operators">Kubernetes Operators</h2>
<p>Pigsty refuse to run database inside kubernetes, but if you wish to do so, there are other options:</p>
<ul>
<li>PGO</li>
<li>StackGres</li>
<li>CloudNativePG</li>
<li>TemboOperator</li>
<li>PostgresOperator</li>
<li>PerconaOperator</li>
<li>Kubegres</li>
<li>KubeDB</li>
<li>KubeBlocks</li>
</ul>
<p><strong>Reference</strong>:</p>
<ul>
<li>《<a href="/blog/db/db-in-k8s/">DB in K8S: Pros &amp; Cons?</a>》</li>
<li>《<a href="/blog/db/pg-in-docker/">PG in Docker: Good or Bad?？</a>》</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-724a9899719548b393b18b25ed0323cb">6 - Cost Analysis</h1>
    <div class="lead">RDS / DBA Cost reference to help you evaluate the costs of self-hosting database</div>
	<hr>
<h2 id="cost-reference">Cost Reference</h2>
<table>
<thead>
<tr>
<th style="text-align:center">EC2</th>
<th style="text-align:center">vCPU-Month</th>
<th style="text-align:center">RDS</th>
<th style="text-align:center">vCPU-Month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">DHH&rsquo;s self-hosted core-month price (192C 384G)</td>
<td style="text-align:center"><strong>25.32</strong></td>
<td style="text-align:center">Junior open-source DBA reference salary</td>
<td style="text-align:center">15K/person-month</td>
</tr>
<tr>
<td style="text-align:center">IDC self-hosted data center (exclusive physical machine: 64C384G)</td>
<td style="text-align:center"><strong>19.53</strong></td>
<td style="text-align:center">Intermediate open-source DBA reference salary</td>
<td style="text-align:center">30K/person-month</td>
</tr>
<tr>
<td style="text-align:center">IDC self-hosted data center (container, oversold 500%)</td>
<td style="text-align:center">7</td>
<td style="text-align:center">Senior open-source DBA reference salary</td>
<td style="text-align:center">60K/person-month</td>
</tr>
<tr>
<td style="text-align:center">UCloud Elastic Virtual Machine (8C16G, oversold)</td>
<td style="text-align:center">25</td>
<td style="text-align:center">ORACLE database license</td>
<td style="text-align:center">10000</td>
</tr>
<tr>
<td style="text-align:center">Alibaba Cloud Elastic Server 2x memory (exclusive without overselling)</td>
<td style="text-align:center">107</td>
<td style="text-align:center">Alibaba Cloud RDS PG 2x memory (exclusive)</td>
<td style="text-align:center">260</td>
</tr>
<tr>
<td style="text-align:center">Alibaba Cloud Elastic Server 4x memory (exclusive without overselling)</td>
<td style="text-align:center">138</td>
<td style="text-align:center">Alibaba Cloud RDS PG 4x memory (exclusive)</td>
<td style="text-align:center">320</td>
</tr>
<tr>
<td style="text-align:center">Alibaba Cloud Elastic Server 8x memory (exclusive without overselling)</td>
<td style="text-align:center">180</td>
<td style="text-align:center">Alibaba Cloud RDS PG 8x memory (exclusive)</td>
<td style="text-align:center">410</td>
</tr>
<tr>
<td style="text-align:center">AWS C5D.METAL 96C 200G (monthly without upfront)</td>
<td style="text-align:center">100</td>
<td style="text-align:center">AWS RDS PostgreSQL db.T2 (2x)</td>
<td style="text-align:center">440</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>For instance, using RDS for PostgreSQL on AWS, the price for a 64C / 256GB db.m5.16xlarge RDS for one month is $25,817, which is equivalent to about 180,000 yuan per month. The monthly rent is enough for you to buy two servers with even better performance and set them up on your own. <strong>The rent-to-buy ratio doesn&rsquo;t even last a month; renting for just over ten days is enough to buy the whole server for yourself</strong>.</p>
<table>
<thead>
<tr>
<th>Payment Model</th>
<th>Price</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted IDC (Single Physical Server)</td>
<td>¥75k / 5 years</td>
<td>1.5</td>
</tr>
<tr>
<td>Self-hosted IDC (2-3 Server HA Cluster)</td>
<td>¥150k / 5 years</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (On-demand)</td>
<td>¥87.36/hour</td>
<td>76.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Monthly)</td>
<td>¥42k / month</td>
<td>50</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Yearly, 15% off)</td>
<td>¥425,095 / year</td>
<td>42.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (3-year, 50% off)</td>
<td>¥750,168 / 3 years</td>
<td>25</td>
</tr>
<tr>
<td>AWS (On-demand)</td>
<td>$25,817 / month</td>
<td>217</td>
</tr>
<tr>
<td>AWS (1-year, no upfront)</td>
<td>$22,827 / month</td>
<td>191.7</td>
</tr>
<tr>
<td>AWS (3-year, full upfront)</td>
<td>$120k + $17.5k/month</td>
<td>175</td>
</tr>
<tr>
<td>AWS China/Ningxia (On-demand)</td>
<td>¥197,489 / month</td>
<td>237</td>
</tr>
<tr>
<td>AWS China/Ningxia (1-year, no upfront)</td>
<td>¥143,176 / month</td>
<td>171</td>
</tr>
<tr>
<td>AWS China/Ningxia (3-year, full upfront)</td>
<td>¥647k + ¥116k/month</td>
<td>160.6</td>
</tr>
</tbody>
</table>
<p>Comparing the costs of self-hosting versus using a cloud database:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted Servers 64C / 384G / 3.2TB NVME SSD 660K IOPS (2-3 servers)</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS PG High-Availability pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3</td>
<td>25 ~ 50</td>
</tr>
<tr>
<td>AWS RDS PG High-Availability db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS</td>
<td>160 ~ 217</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="cloud-exit-column">Cloud Exit Column</h2>
<ul>
<li><a href="/blog/cloud/rds/">RDS: The Idiot Tax</a></li>
<li><a href="/blog/cloud/ebs/">EBS: Pig Slaughter Scam</a></li>
<li><a href="/blog/cloud/s3/">S3: Elite to Mediocre</a></li>
<li><a href="/blog/cloud/bonus/">EC2: Reclaim Hardware Bonus</a></li>
<li><a href="/blog/cloud/sla/">SLA: Placebo or Insurance</a></li>
<li><a href="/blog/cloud/finops/">Cloud-Exit, the Final FinOps</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dbab37f93e145eb07dbd2362106ccd61">7 - Glossary</h1>
    <div class="lead">technical terms used in the documentation, along with their definitions and explanations.</div>
	
</div>



    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Mail" aria-label="Mail">
    <a target="_blank" rel="noopener" href="mailto:rh@vonng.com" aria-label="Mail">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/Vonng/pigsty" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/GobeUncleWang" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="WeChat" aria-label="WeChat">
    <a target="_blank" rel="noopener" href="/img/pigsty/pigsty-cc.jpg" aria-label="WeChat">
      <i class="fa fa-comment"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Discord" aria-label="Discord">
    <a target="_blank" rel="noopener" href="https://discord.gg/wDzt5VyWEz" aria-label="Discord">
      <i class="fab fa-discord"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Telegram" aria-label="Telegram">
    <a target="_blank" rel="noopener" href="https://t.me/joinchat/gV9zfZraNPM3YjFh" aria-label="Telegram">
      <i class="fab fa-telegram"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2018&ndash;2025
    <span class="td-footer__authors">Ruohang Feng</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span></span><span class="ms-2"><a href="https://vonng.com/en/" target="_blank" rel="noopener">@Vonng</a></span>
<br><span>Pigsty® distributed under <a href="/docs/about/license" target="_blank" rel="noopener">AGPLv3</a></span>
<br><span class="ms-2"><a href="/docs/about/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
<span><a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">浙ICP备15016890号</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.248655eb216150e39da254c2f7aa5357805d0ec66bdb741b591cd35fb5f629ab.js" integrity="sha256-JIZV6yFhUOOdolTC96pTV4BdDsZr23QbWRzTX7X2Kas=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
