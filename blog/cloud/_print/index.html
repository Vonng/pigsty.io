<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="/blog/cloud/">
<link rel="alternate" type="application/rss&#43;xml" href="/blog/cloud/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Cloud Exit | Pigsty</title>
<meta name="description" content="Pigsty is a free PostgreSQL Distribution and local-first RDS Alternative, with battery-include HA, PITR, IaC, Monitoring infra, and 280 extensions in PG Ecosystem.">
<meta property="og:title" content="Cloud Exit" />
<meta property="og:description" content="Pigsty is a free PostgreSQL Distribution and local-first RDS Alternative, with battery-include HA, PITR, IaC, Monitoring infra, and 280 extensions in PG Ecosystem." />
<meta property="og:type" content="website" />
<meta property="og:url" content="/blog/cloud/" />

<meta itemprop="name" content="Cloud Exit">
<meta itemprop="description" content="Pigsty is a free PostgreSQL Distribution and local-first RDS Alternative, with battery-include HA, PITR, IaC, Monitoring infra, and 280 extensions in PG Ecosystem."><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Cloud Exit"/>
<meta name="twitter:description" content="Pigsty is a free PostgreSQL Distribution and local-first RDS Alternative, with battery-include HA, PITR, IaC, Monitoring infra, and 280 extensions in PG Ecosystem."/>




<link rel="preload" href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" as="style">
<link href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" rel="stylesheet" integrity="">

<script
  src="/js/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="/js/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-LG1V9WTKGE');
}
</script>
  </head>
  <body class="td-section td-blog">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class="navbar-brand__name">Pigsty</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/docs/"><i class='fa-solid fa-book'></i><span>Docs</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/blog/"><i class="fas fa-blog"></i><span>Blog</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/Vonng/pigsty/" target="_blank" rel="noopener"><i class='fab fa-github'></i><span>GitHub</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <i class="fa-solid fa-language"></i>English</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/zh/blog/cloud/">中文</a></li>
    </ul>
</div>
</li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.950327bee4cc242f0f17520341fce2c9.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5 pe-md-4" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/blog/cloud/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Cloud Exit</h1>





    <ul>
    
  
  
  
  

  
    
    
	

    <li><a href="#pg-7f57c973bb7756d9b0ca9b96892a6d2d">S3: Elite to Mediocre</a></li>



    
  
    
    
	

    <li><a href="#pg-80ebd4282641b01facdbdf7ef86ea752">Reclaim Hardware Bonus from the Cloud</a></li>



    
  
    
    
	

    <li><a href="#pg-c0e49b0e5d0a3d0c994910d0cc773519">FinOps: Endgame Cloud-Exit</a></li>



    
  
    
    
	

    <li><a href="#pg-fb2b56bca82f7d919a808b2f73758318">SLA: Placebo or Insurance?</a></li>



    
  
    
    
	

    <li><a href="#pg-9acfe4d5f6e1972f749837119d2bab4b">EBS: Pig Slaughter Scam</a></li>



    
  
    
    
	

    <li><a href="#pg-2f6739426df63d5dd62ead985e471dc9">RDS: The Idiot Tax</a></li>



    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-7f57c973bb7756d9b0ca9b96892a6d2d">S3: Elite to Mediocre</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/HathxpQ_KUuqxyrtyCDzWw">WeChat</a></b> |
        
		<time datetime="2023-12-26" class="text-muted">2023-12-26</time>
        
	</div>
	<p>Object storage (S3) has been a defining service of cloud computing, once hailed as a paragon of cost reduction in the cloud era. Unfortunately, with the evolution of hardware and the emergence of resources cloud (Cloudflare R2) and open-source alternatives (MinIO), the once &ldquo;cost-effective&rdquo; object storage services have lost their value for money, becoming as much a &ldquo;cash cow&rdquo; as EBS. In our &ldquo;Mudslide of Cloud Computing&rdquo; series, we&rsquo;ve already delved into the cost structure of cloud-based EC2 compute power, EBS disks, and RDS databases. Today, let&rsquo;s examine the anchor of cloud services—object storage.</p>
<p><a href="https://mp.weixin.qq.com/s/HathxpQ_KUuqxyrtyCDzWw"><img src="/zh/blog/cloud/s3/featured.webp"></a></p>
<hr>
<h2 id="from-cost-reduction-to-cash-cow">From Cost Reduction to Cash Cow</h2>
<p><strong>Object Storage</strong>, also known as Simple Storage Service (abbreviated as <strong>S3</strong>, hereafter referred to as S3), was once the flagship product for its cost-effectiveness in the cloud.</p>
<p>A decade ago, hardware was expensive; managing to use a bunch of several hundred GB mechanical hard drives to build a reliable storage service and design an elegant HTTP API was a significant barrier. Therefore, compared to those &ldquo;enterprise IT&rdquo; storage solutions, the cost-effective S3 seemed very attractive.</p>
<p>However, the field of computer hardware is quite unique—with a Moore&rsquo;s Law that sees prices halve every two years. AWS S3 has indeed seen several price reductions in its history. The table below organizes the main post-reduction prices for S3 standard tier storage, along with the reference unit prices for enterprise-grade HDD/SSD in the corresponding years.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Date</th>
<th style="text-align:center">$/GB·Month</th>
<th style="text-align:center">¥/TB·5年</th>
<th style="text-align:center">HDD ¥/TB</th>
<th style="text-align:center">SSD ¥/TB</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/cn/blogs/aws/amazon_s3/">2006</a>.03</td>
<td style="text-align:center">0.150</td>
<td style="text-align:center">63000</td>
<td style="text-align:center">2800</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2010/11/what-can-i-say-another-amazon-s3-price-reduction.html">2010</a>.11</td>
<td style="text-align:center">0.140</td>
<td style="text-align:center">58800</td>
<td style="text-align:center">1680</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2012/11/amazon-s3-price-reduction-december-1-2012.html">2012</a>.12</td>
<td style="text-align:center">0.095</td>
<td style="text-align:center">39900</td>
<td style="text-align:center">420</td>
<td style="text-align:center">15400</td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2014/03/aws-price-reduction-42-ec2-s3-rds-elasticache-and-elastic-mapreduce.html">2014</a>.04</td>
<td style="text-align:center">0.030</td>
<td style="text-align:center">12600</td>
<td style="text-align:center">371</td>
<td style="text-align:center">9051</td>
</tr>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/ru/blogs/aws/aws-storage-update-s3-glacier-price-reductions/">2016</a>.12</td>
<td style="text-align:center">0.023</td>
<td style="text-align:center">9660</td>
<td style="text-align:center">245</td>
<td style="text-align:center">3766</td>
</tr>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/cn/s3/pricing">2023</a>.12</td>
<td style="text-align:center">0.023</td>
<td style="text-align:center">9660</td>
<td style="text-align:center">105</td>
<td style="text-align:center">280</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Price Ref</strong></th>
<th style="text-align:center"><strong>EBS</strong></th>
<th style="text-align:center"><strong>All Upfront</strong></th>
<th style="text-align:center"><strong>Buy NVMe SSD</strong></th>
<th style="text-align:center"><strong>Price Ref</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S3 Express</td>
<td style="text-align:center">0.160</td>
<td style="text-align:center">67200</td>
<td style="text-align:center">DHH 12T</td>
<td style="text-align:center">1400</td>
</tr>
<tr>
<td style="text-align:center">EBS io2</td>
<td style="text-align:center">0.125 + IOPS</td>
<td style="text-align:center">114000</td>
<td style="text-align:center">Shannon 3.2T</td>
<td style="text-align:center">900</td>
</tr>
</tbody>
</table>
<p>It&rsquo;s not hard to see that the unit price of S3&rsquo;s standard tier dropped from <strong>$0.15/GB·month</strong> in 2006 to <strong>$0.023/GB·month</strong> in 2023, a reduction to <strong>15%</strong> of the original or a <strong>6-fold</strong> decrease, which sounds good. However, when you consider that the price of the underlying HDDs for S3 dropped to <strong>3.7%</strong> of their original, a whopping <strong>26-fold</strong> decrease, the trickery becomes apparent.</p>
<p><strong>The resource premium multiple of S3 increased from 7 times in 2006 to 30 times today!</strong></p>
<p>In 2023, when we re-calculate the costs, it&rsquo;s clear that the value for money of storage services like S3/EBS has changed dramatically—cloud computing power EC2 compared to building one&rsquo;s own servers has a 5 – 10 times premium, while cloud block storage EBS has a several dozen to a hundred times premium compared to local SSDs. Cloud-based S3 compared to ordinary HDDs also has about a thirty times resource premium. And as the anchor of cloud services, the prices of S3/EBS/EC2 are passed on to almost all cloud services—completely stripping cloud services of their cost-effectiveness.</p>
<p>The core issue here is: <strong>The price of hardware resources drops exponentially according to Moore&rsquo;s Law, but the savings are not passed through the cloud providers&rsquo; intermediary layer to the end-user service prices.</strong> <strong>To not advance is to go back; failing to reduce prices at the pace of Moore&rsquo;s Law is effectively a price increase</strong>. Taking S3 as an example, over the past decade, cloud providers&rsquo; S3 has nominally reduced prices by 6-fold, but hardware resources have become 26 times cheaper, so how should we view this pricing now?</p>
<hr>
<h2 id="cost-performance-throughput">Cost, Performance, Throughput</h2>
<p>Despite the high premiums of cloud services, if it represents an irreplaceable <strong>best choice</strong>, the use by high-value, price-insensitive top-tier customers is not affected even with a high premium and low cost-effectiveness. However, it&rsquo;s not just about cost; the performance of storage hardware also follows Moore&rsquo;s Law. Over time, building one&rsquo;s own S3 has started to show a significant advantage in performance.</p>
<p>The performance of S3 is mainly reflected in its <strong>throughput</strong>. AWS S3&rsquo;s 100 Gb/s network provides up to 12.5 GB/s of access bandwidth, which is indeed commendable. Such throughput was undoubtedly impressive a decade ago. However, today, an enterprise-level 12 TB NVMe SSD, costing less than $20,000, can achieve 14 GB/s of read/write bandwidth. 100Gb switches and network cards have also become very common, making such performance readily achievable.</p>
<p>In another key performance indicator, &ldquo;latency,&rdquo; S3 is significantly outperformed by local disks. The first-byte latency of the S3 standard tier is quite poor, ranging between <strong>100-200ms</strong> according to the documentation. Of course, AWS has just launched &ldquo;High-Performance S3&rdquo; — <strong>S3 Express One Zone</strong> at 2023 Re:Invent, which can achieve millisecond-level latency, addressing this shortcoming. However, it still falls far short of the NVMe&rsquo;s 4K random read/write latency of <strong>55µs/9µs</strong>.</p>
<p>S3 Express&rsquo;s millisecond-level latency sounds good, but when we compare it to a self-built NVMe SSD + MinIO setup, this &ldquo;millisecond-level&rdquo; performance is embarrassingly inadequate. Modern NVMe SSDs achieve 4K random read/write latencies of 55µs/9µs. With a thin layer of MinIO forwarding, the first-byte output latency is at least an order of magnitude better than S3 Express. If standard tier S3 is used for comparison, the performance gap widens to three orders of magnitude.</p>
<p>The gap in performance is just one aspect; the cost is even more crucial. The price of standard tier S3 has remained unchanged since 2016 at $0.023/GB·month, equating to <strong>161 RMB/TB·month</strong>. The higher-tier S3 Express One Zone is an order of magnitude more expensive, at <strong>$0.16/GB·month</strong>, equating to <strong>1120 RMB/TB·month</strong>. For reference, we can compare the data from <a href="https://mp.weixin.qq.com/s/1OSRcBfd58s0tgZTUZHB9g">&ldquo;Reclaiming the Dividends of Computer Hardware&rdquo;</a> and <a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">&ldquo;Is Cloud Storage a Cash Cow?&rdquo;</a>:</p>
<table>
<thead>
<tr>
<th><strong>Factor</strong></th>
<th><strong>Local PCI-E NVME SSD</strong></th>
<th><strong>Aliyun ESSD PL3</strong></th>
<th><strong>AWS io2 Block Express</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Cost</td>
<td><strong>14.5 RMB/TB·month</strong> (5-year amortization / 3.2T MLC) 5-year warranty, ¥3000 retail</td>
<td><strong>3200 RMB/TB·month</strong> (Original price 6400 RMB, monthly package 4000 RMB) 50% discount for 3-year upfront payment</td>
<td><strong>1900 RMB/TB·month</strong> Best discount for the largest specification 65536GB 256K IOPS</td>
</tr>
<tr>
<td>Capacity</td>
<td>32TB</td>
<td>32 TB</td>
<td>64 TB</td>
</tr>
<tr>
<td>IOPS</td>
<td>4K random read: 600K ~ 1.1M 4K random write 200K ~ 350K</td>
<td>Max 4K random read: 1M</td>
<td>16K random IOPS: 256K</td>
</tr>
<tr>
<td>Latency</td>
<td>4K random read: 75µs 4K random write: 15µs</td>
<td>4K random read: 200µs</td>
<td>Random IO: 500µs (assumed 16K)</td>
</tr>
<tr>
<td>Reliability</td>
<td>UBER &lt; 1e-18, equivalent to 18 nines MTBF: 2 million hours 5DWPD, over three years</td>
<td>Data reliability: 9 nines <a href="https://help.aliyun.com/document_detail/476273.html">Storage and Data Reliability</a></td>
<td><strong>Durability</strong>: 99.999%, 5 nines (0.001% annual failure rate) <a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">io2 details</a></td>
</tr>
<tr>
<td>SLA</td>
<td>5-year warranty, direct replacement for issues</td>
<td><a href="https://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201910310944_35008.html?spm=a2c4g.11186623.0.0.270e6e37n8Exh5">Aliyun RDS SLA</a> Availability 99.99%: 15% monthly fee 99%: 30% monthly fee 95%: 100% monthly fee</td>
<td><a href="https://d1.awsstatic.com/legal/amazonrdsservice/Amazon-RDS-Service-Level-Agreement-Chinese.pdf">Amazon RDS SLA</a> Availability 99.95%: 15% monthly fee 99%: 25% monthly fee 95%: 100% monthly fee</td>
</tr>
</tbody>
</table>
<p>e local NVMe SSD example used here is the Shannon DirectIO G5i 3.2TB MLC particle enterprise-level SSD, extensively used by us. Brand new, disassembled retail pieces are priced at ¥2788 (available on Xianyu!), translating to a monthly cost per TB of 14.5 RMB over 60 months (5 years). Even if we calculate using the Inspur list price of ¥4388, the cost per TB·month is only 22.8. If this example is not convincing enough, we can refer to the 12 TB Gen4 NVMe enterprise-level SSDs purchased by DHH in <a href="https://mp.weixin.qq.com/s/CicctyvV1xk5B-AsKfzPjw">&ldquo;Is It Time to Give Up on Cloud Computing?&rdquo;</a>, priced at $2390 each, with a cost per TB·month of exactly <strong>23</strong> RMB.</p>
<p>So, why are NVMe SSDs, which outperform by several orders of magnitude, priced an order of magnitude cheaper than standard tier S3 (161 vs 23) and two orders of magnitude cheaper than S3 Express (1120 vs 23 x3)? If I were to use such hardware (even accounting for triple replication) + open-source software to build an object storage service, could I achieve a three orders of magnitude improvement in cost-effectiveness? (This doesn&rsquo;t even account for the reliability advantages of SSDs over HDDs.)</p>
<p>It&rsquo;s worth noting that the comparison above focuses solely on the cost of storage space. The cost of data transfer in and out of object storage is also a significant expense, with some tiers charging not for storage but for retrieval traffic. Additionally, there are issues of SSD reliability compared to HDD, data sovereignty in the cloud, etc., which will not be elaborated further here.</p>
<p>Of course, cloud providers might argue that their S3 service is not just about storage hardware resources but an out-of-the-box <strong>service</strong>. This includes software intellectual property and maintenance labor costs. They may claim that self-hosting has a higher failure rate, is riskier, and incurs significant operational labor costs. Unfortunately, these arguments might have been valid in 2006 or 2013, but they seem rather ludicrous today.</p>
<hr>
<h2 id="self-hosted-oss-s3">Self-Hosted OSS S3</h2>
<p>A decade and a half ago, the vast majority of users lacked the IT capabilities to self-host, and there were no mature open-source alternatives to S3. Users could tolerate the premium for this high technology. However, as various cloud providers and IDCs began offering object storage, and even open-source free object storage solutions like MinIO emerged, the market shifted from a seller&rsquo;s to a buyer&rsquo;s market. The logic of value pricing turned into cost pricing, and the unyielding premium on resources naturally faced scrutiny — what extra value does it actually provide to justify such significant costs?</p>
<p>Proponents of cloud storage claim that moving to the cloud is cheaper, simpler, and faster than self-hosting. For individual webmasters and small to medium-sized internet companies within the cloud&rsquo;s suitable spectrum, this claim certainly holds. If your data scale is only a few dozen GBs, or you have some medium-scale overseas business and CDN needs, I would not recommend jumping on the bandwagon to self-host object storage. You should instead turn to Cloudflare and use R2 — perhaps the best solution.</p>
<p>However, for the truly high-value, medium-to-large scale customers who contribute the majority of revenue, these value propositions do not necessarily hold. If you are primarily using local storage for TB/PB scale data, then you should seriously consider the cost and benefits of self-hosting object storage services — which has become very simple, stable, and mature with open-source software. Storage service reliability mainly depends on disk redundancy: apart from occasional hard drive failures (HDD AFR 1%, SSD 0.2-0.3%), requiring you (or a maintenance service provider) to replace parts, there isn&rsquo;t much additional burden.</p>
<p>If the open-source Ceph, which mixes EBS/S3 capabilities, is considered somewhat operationally complex and not fully feature-complete; then the fully S3-compatible object storage service MinIO can be considered truly plug-and-play — a standalone binary without external dependencies, requiring only a few configuration parameters to quickly set up, transforming server disk arrays into a standard local S3-compatible service, even integrating AWS&rsquo;s AK/SK/IAM compatible implementations!</p>
<p>From an operational management perspective, the operational complexity of Redis is an order of magnitude lower than PostgreSQL, and MinIO&rsquo;s operational complexity is another order of magnitude lower than Redis. It&rsquo;s so simple that I could spend less than a week to integrate MinIO deployment/monitoring as an add-on into our open-source PostgreSQL RDS solution, serving as an optional central backup storage repository.</p>
<p>At Tantan, several MinIO clusters were built and maintained this way: holding 25PB of data, possibly the largest scale of MinIO deployment in China at the time. How many people were needed for maintenance? Just a fraction of one operations engineer&rsquo;s working time was enough, and the overall self-hosting cost was about half of the cloud list price. Practice proves the point, if anyone tells you that self-hosting object storage is difficult and expensive, you can try it yourself — in just a few hours, these sales FUD tactics will fall apart.</p>
<p>For object storage services, the cloud&rsquo;s three core value propositions: &ldquo;cheaper, simpler, faster&rdquo;, the &ldquo;simpler&rdquo; part may not hold up, &ldquo;cheaper&rdquo; has turned the other way, probably only leaving &ldquo;faster&rdquo; — indeed, no one can beat the cloud on this point. You can apply for PB-level storage services across all regions of the world in less than a minute on the cloud, which is amazing! However, you also have to pay a high premium, several times to dozens of times over for this privilege.</p>
<p>Therefore, for object storage services, among the cloud&rsquo;s three core value propositions: &ldquo;cheaper, simpler, faster&rdquo;, the &ldquo;simpler&rdquo; part may not hold, and &ldquo;cheaper&rdquo; has gone in the opposite direction, probably only leaving &ldquo;faster&rdquo; — indeed, no one can beat the cloud on this point. You can indeed apply for PB-level storage services across all regions of the world in less than a minute on the cloud, which is amazing! However, you also have to pay a high premium for this privilege, several to dozens of times over. For enterprises of a certain scale, compared to the cost of operations increasing several times, waiting a couple of weeks or making a one-time capital investment is not a big deal.</p>
<hr>
<h2 id="summary">Summary</h2>
<p>The exponential decline in hardware costs has not been fully reflected in the service prices of cloud providers, turning public clouds from universally beneficial infrastructure into monopolistic profit centers.</p>
<p>However, the tide is turning. Hardware is becoming interesting again, and cloud providers can no longer indefinitely hide this advantage. The savvy are starting to crunch the numbers, and the bold have already taken action. Pioneers like Elon Musk and DHH have fully realized this, moving away from the cloud to reap millions in financial benefits, enjoy performance gains, and gain more operational independence. More and more people are beginning to notice this, following in the footsteps of these pioneers to make the wise choice and reclaim their hardware dividends.</p>
<h3 id="references">References</h3>
<p><code>[1]</code> 2006: <em><a href="https://aws.amazon.com/cn/blogs/aws/amazon_s3/">https://aws.amazon.com/cn/blogs/aws/amazon_s3/</a></em></p>
<p><code>[2]</code> 2010: <em><a href="http://aws.typepad.com/aws/2010/11/what-can-i-say-another-amazon-s3-price-reduction.html">http://aws.typepad.com/aws/2010/11/what-can-i-say-another-amazon-s3-price-reduction.html</a></em></p>
<p><code>[3]</code> 2012: <em><a href="http://aws.typepad.com/aws/2012/11/amazon-s3-price-reduction-december-1-2012.html">http://aws.typepad.com/aws/2012/11/amazon-s3-price-reduction-december-1-2012.html</a></em></p>
<p><code>[4]</code> 2014: <em><a href="http://aws.typepad.com/aws/2014/03/aws-price-reduction-42-ec2-s3-rds-elasticache-and-elastic-mapreduce.html">http://aws.typepad.com/aws/2014/03/aws-price-reduction-42-ec2-s3-rds-elasticache-and-elastic-mapreduce.html</a></em></p>
<p><code>[5]</code> 2016: <em><a href="https://aws.amazon.com/ru/blogs/aws/aws-storage-update-s3-glacier-price-reductions/">https://aws.amazon.com/ru/blogs/aws/aws-storage-update-s3-glacier-price-reductions/</a></em></p>
<p><code>[6]</code> 2023: <em><a href="https://aws.amazon.com/cn/s3/pricing">https://aws.amazon.com/cn/s3/pricing</a></em></p>
<p><code>[7]</code> First-byte Latency: <em><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/optimizing-performance.html">https://docs.aws.amazon.com/AmazonS3/latest/userguide/optimizing-performance.html</a></em></p>
<p><code>[8]</code> Storage &amp; Reliability: <em><a href="https://help.aliyun.com/document_detail/476273.html">https://help.aliyun.com/document_detail/476273.html</a></em></p>
<p><code>[9]</code> EBS io2 Spec: <em><a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/</a></em></p>
<p><code>[10]</code> Aliyun RDS SLA: <em><a href="https://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201910310944_35008.html?spm=a2c4g.11186623.0.0.270e6e37n8Exh5">https://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201910310944_35008.html?spm=a2c4g.11186623.0.0.270e6e37n8Exh5</a></em></p>
<p><code>[11]</code> Amazon RDS SLA: <em><a href="https://d1.awsstatic.com/legal/amazonrdsservice/Amazon-RDS-Service-Level-Agreement-Chinese.pdf">https://d1.awsstatic.com/legal/amazonrdsservice/Amazon-RDS-Service-Level-Agreement-Chinese.pdf</a></em></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-80ebd4282641b01facdbdf7ef86ea752">Reclaim Hardware Bonus from the Cloud</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/1OSRcBfd58s0tgZTUZHB9g">WeChat</a></b> |
        
		<time datetime="2023-11-16" class="text-muted">2023-11-16</time>
        
	</div>
	<p>Hardware is interesting again, with the AI wave fueling a GPU frenzy. However, the intrigue isn’t limited to GPUs —— developments in CPUs and SSDs remain largely unnoticed by the majority of devs. A whole generation of developers is obscured by cloud hype and marketing noise.</p>
<p>Hardware performance is skyrocketing, and costs are plummeting, turning the public cloud from a decent service into a cash cow. These shifts necessitate a reevaluation of technology and software. It&rsquo;s time to get back to basics and reclaim the hardware dividend that belongs to users.</p>
<p><a href="https://mp.weixin.qq.com/s/1OSRcBfd58s0tgZTUZHB9g"><img src="/zh/blog/cloud/bonus/featured.jpg"></a></p>
<hr>
<h2 id="revolutionary-new-hardware">Revolutionary New Hardware</h2>
<p>If you&rsquo;ve been unaware of computer hardware for a while, the specs of the latest gear might shock you.</p>
<p>Once, Intel’s CPUs saw marginal gains each generation, allowing old PCs to remain viable year after year. However, CPU evolution has recently accelerated, with significant leaps in core counts and regular 20-30% improvements in <a href="https://www.tomshardware.com/pc-components/cpus/core-i9-14900ks-overclocked-to-91-ghz-breaking-numerous-world-records">single-core performance</a>.</p>
<p>For instance, AMD&rsquo;s recently released desktop CPU, the <a href="https://www.amd.com/en/products/cpu/amd-ryzen-threadripper-pro-7995wx">Threadripper 7995WX</a>, is a performance beast with 96 cores and 192 threads at speeds ranging from 2.5 to 5.1 GHz, retailing on Amazon for $5600. The server CPU series, EPYC, includes the previous generation <a href="https://www.amd.com/en/products/cpu/amd-epyc-9654">EPYC Genoa 9654</a>, with 96 cores and 192 threads at speeds ranging from 2.4 to 3.55 GHz, priced at $3940 on Amazon. This year&rsquo;s new <a href="https://www.amd.com/zh-hans/products/cpu/amd-epyc-9754">EPYC 9754</a> goes even further, offering a single CPU with 128 cores and 256 threads. This means a standard dual-socket server could have an astonishing 512 threads! If we consider cloud computing/container platforms&rsquo; 500% overselling rate, this could virtualize more than two thousand five hundred 1-core virtual machines.</p>
<p>Take AMD&rsquo;s new <a href="https://www.amd.com/en/products/cpu/amd-ryzen-threadripper-pro-7995wx">Threadripper 7995WX</a>, a 96-core, 192-thread behemoth clocked at 2.5 to 5.1 GHz, retailing at $5600 on Amazon. On the server side, the previous-gen <a href="https://www.amd.com/en/products/cpu/amd-epyc-9654">EPYC Genoa 9654</a> offered 96 cores and 192 threads at 2.4 to 3.55 GHz, priced at $3940. The latest <a href="https://www.amd.com/en/products/cpu/amd-epyc-9754">EPYC 9754</a> pushes boundaries further with 128 cores and 256 threads, enabling a dual-socket server to boast a staggering 512 vCPUs — enough to oversubscribe and virtualize over 2500+ 1c VMs at 500% oversell rates.</p>
<p><img alt="epyc-list.png" src="/zh/blog/cloud/bonus/bonus-epyc-list.png"></p>
<hr>
<p>SSD/NVMe storage has seen even more dramatic generational jumps. Speeds have escalated from Gen2’s 500MB/s to Gen3’s 2.5GB/s, and now Gen4’s mainstream 7GB/s, with Gen5 at 14GB/s emerging. Gen6 is released, with Gen7 on the horizon, as I/O bandwidth doubles exponentially.</p>
<p><img alt="io-bandwidth.png" src="/zh/blog/cloud/bonus/bonus-io-bandwidth.png"></p>
<p>Consider the Gen5 NVMe SSD: <a href="https://www.storagereview.com/review/kioxia-cm7-gen5-enterprise-ssd-review">KIOXIA CM7</a>, which offers 128K sequential read bandwidth of 14GB/s and write bandwidth of 7GB/s, with 4K random IOPS of 2.7M for reads and 600K for writes. It&rsquo;s doubtful that many database software packages can fully utilize this insane read/write bandwidth and IOPS. For context, HDD generally fluctuates around a read/write bandwidth of a few hundred MB/s, with 7200 RPM drives achieving IOPS in the tens and 15000 RPM drives in the low hundreds. <strong>NVMe SSDs&rsquo; I/O bandwidth rates are already four orders of magnitude better than HDD — 10,000x better.</strong></p>
<p>In terms of 4K RankRW response times, which are of utmost concern for databases, NVMe SSDs have achieved 55/9 µs for reads &amp; writes since several generations ago. Meanwhile, HDD seek time usually measures around 10ms, with an average rotational latency depending on speed between 2ms and 4ms, meaning a single I/O operation typically takes over a dozen milliseconds. Comparing dozens of milliseconds to 55/9µs, <strong>NVMe SSDs are three orders of magnitude faster than mechanical disks — 1000x faster!</strong></p>
<hr>
<p>Besides computing and storage, network hardware has also improved significantly. 40GbE and 100GbE are now commonplace — a 100GbE optical module network card costs just about several hundred dollars, offering a network transfer speed of 12 GB/s, <strong>a hundred times faster</strong> than the gigabit network cards familiar to older programmers.</p>
<p><img alt="Ethernet Speeds: chart" src="/zh/blog/cloud/bonus/bonus-ethernet.png"></p>
<blockquote>
<p><a href="https://www.synopsys.com/blogs/chip-design/1-6t-ethernet-specification-ip.html">1.6T Ethernet</a> is already on the radar.</p>
</blockquote>
<p>As computing, storage, and networking hardware evolve exponentially following Moore&rsquo;s Law, hardware becomes fascinating again. But the real intrigue lies in how these technological leaps will impact the world.</p>
<hr>
<h2 id="distributed-losing-favor">Distributed Losing Favor</h2>
<p>The landscape of hardware has undergone monumental changes over the past decade, rendering many assumptions in the software realm obsolete, such as those concerning <a href="/blog/db/distributive-bullshit/">distributed databases</a>.</p>
<p>Today, the capabilities of a standard x86 server have reached astonishing levels. An intriguing <a href="https://thume.ca/2023/01/02/one-machine-twitter/">draft calculation</a> roughly demonstrates the feasibility of running the entirety of Twitter on a modern server (Dell PowerEdge R740xd, with 32 cores, 768GB RAM, 6TB NVMe, 360TB HDD, GPU slots, and 4x40Gbe networking). While you wouldn&rsquo;t do this for production redundancy (using two or three servers might be safer), this calculation indeed raises an interesting question — <strong>Is scalability still a real issue?</strong></p>
<p>At the turn of the century, an Apache server could barely handle a few hundred concurrent requests. The best software struggled with tens of thousands of concurrent connections — the industry&rsquo;s notorious C10K problem, where handling several thousand connections was seen as a feat. However, with the advent of Epoll and Nginx in 2003/2004, &ldquo;high concurrency&rdquo; ceased to be a challenge — any novice who learned to configure Nginx could achieve what masters only dreamed of a few years earlier. &ldquo;Customers in the Eyes of Cloud Providers: Poor, Idle, and Lacking Love&rdquo; details this evolution.</p>
<p>As of 2023, the impact of hardware has once again revolutionized distributed databases: <strong>Scalability, much like the C10K problem two decades ago, has become a solved issue of the past</strong>. If a service like Twitter can run on a single server, then 99.xxxx+% of services will not exceed the scalability needs that such a server can provide throughout their entire lifecycle. This means the once-prized &ldquo;distributed&rdquo; technology boasted by big tech companies has become redundant with the advent of new hardware — <strong>Anyone still discussing partitioning, distributed databases, and high concurrency on a massive scale is living in the past, having ceased to learn and grow over the past decade.</strong></p>
<p>The foundational assumption of distributed databases — that a single machine&rsquo;s processing power is insufficient to support the load — has been shattered by contemporary hardware. Centralized databases don&rsquo;t even need to lift a finger; their capacity automatically scales to meet demands that most services will never reach in their lifetime. Some might argue that services like WeChat or Alipay require distributed databases, but setting aside whether distributed databases are the only solution, assuming these rare extreme cases can sustain a couple of distributed TP kernels, distributed OLTP databases will no longer be the main direction for database development as network hardware becomes more cost-effective than disk storage. Alibaba&rsquo;s choice of a distributed path for its database progeny, OceanBase, versus its current preference for centralized architectures with PolarDB, serves as a telling example.</p>
<p>In the realm of big data analytics (OLAP), distributed systems might have been essential, but now even this is questionable — for the majority of companies, their entire database volume could potentially be processed on a single server. Scenarios that previously demanded &ldquo;distributed data warehouses&rdquo; might now be addressed by running PostgreSQL or DuckDB on a modern server. True, large internet companies may have PB/ZB-level data scenarios, but even for core internet services, it&rsquo;s rare for a single service&rsquo;s data volume to exceed a single machine&rsquo;s processing limits. For instance, BreachForums&rsquo; recent leak of 5 years of Taobao shopping records (2015-2020, 8.2 billion records) compressed to 600GB, and similarly, the data sizes for JD.com&rsquo;s billions and Pinduoduo&rsquo;s 14.5 billion records are on par. Moreover, companies like Dell or Inspur offer <strong>PB-level</strong> NVMe all-flash storage cabinets, capable of housing the entire U.S. insurance industry&rsquo;s historical data and analysis tasks in a single box for less than $200,000.</p>
<p>The core trade-off of distributed databases is &ldquo;quality for quantity,&rdquo; sacrificing functionality, performance, complexity, and reliability in exchange for greater data capacity and throughput. However, &ldquo;premature optimization is the root of all evil,&rdquo; and designing for unnecessary scale is futile. If scale is no longer an issue, then sacrificing other attributes for unneeded capacity, incurring extra complexity and costs, becomes utterly pointless.</p>
<hr>
<h2 id="cost-of-owning-servers">Cost of Owning Servers</h2>
<p>With new hardware boasting such powerful performance, what about the cost? Moore&rsquo;s Law states that <strong>every 18 to 24 months, processor performance doubles while the cost halves</strong>. Compared to a decade ago, new hardware is not only more powerful but also cheaper.</p>
<p>In &ldquo;<a href="/blog/cloud/odyssey">DHH: The Cloud-Exit Odyssey</a>&rdquo;, we have a fresh example of a public procurement. DHH and 37 Signals purchased a batch of physical machines for their move away from the cloud in 2023: they bought 20 servers from Dell, totaling 4,000-core vCPUs, 7,680GB of memory, and 384TB of NVMe storage, among other things, for a total expenditure of $500,000.</p>
<p>The specific configuration of each server was as follows: Dell R7625 server, 192 vCPU / 384 GB memory: two AMD EPYC 9454 processors (48 cores/96 threads, 2.75 GHz), equipped with 2x vCPU memory (16 x 32GB memory), a 12 TB NVMe Gen4 SSD, plus other components, <strong>at a cost of $20,000 per server ($\19,980), amortized over five years is $333 per month</strong>.</p>
<p>To verify the validity of this quote, we can directly refer to the retail market prices of the core components: the CPU is the EPYC 9654, with a current retail price of $3,725 each, totaling $7,450 for two. 32GB DDR5 ECC server memory, retailing at $128 per stick, 16 sticks total $2,048. Enterprise-grade NVMe SSD 12TB, priced at $2,390. 100G optical module 100GbE QSFP28 priced at $1,804, adding up to around $13,692, plus the server barebone, power supply, system disk, RAID card, fans, etc., the total price of $20,000 is reasonable.</p>
<p>Of course, a server is not just made up of CPUs, memory, hard drives, and network cards; we also need to consider the total cost of ownership. Data centers need to provide these machines with electricity, rack space, and networking, maintenance fees, and reserve redundancy (prices in the US). After accounting for these costs, they are basically on par with the monthly hardware amortization cost, so the comprehensive monthly cost of a server with 192C / 384G / 12T NVMe storage is <strong>$666, which is about $3.5 / vCPU·month</strong>.</p>
<p>I believe DHH&rsquo;s figures are accurate, as at Tantan, from day one, we chose to build our IDC / resource cloud, and after several rounds of cost optimization, we achieved a similar price — our database server model (Dell R730, 64 vCPU / 512GB / 3.2 TB NVMe SSD) plus the cost of manpower, maintenance, electricity, and internet, the <strong>TCO was about $10,400 , with a core-month cost of $2.71 / vCPU·month</strong>. Here is a table for reference on the price per unit of computing power:</p>
<table>
<thead>
<tr>
<th style="text-align:center">BM / EC2 / ECS Specs</th>
<th style="text-align:center">$ / vCPU·Month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">DHH&rsquo;s self-hosted vCPU·Month Price (192C 384G)</td>
<td style="text-align:center"><strong>3.5</strong></td>
</tr>
<tr>
<td style="text-align:center">TanTan IDC self-hosted DC (64C 384G)</td>
<td style="text-align:center"><strong>2.7</strong></td>
</tr>
<tr>
<td style="text-align:center">TanTan container platform (container, oversold 500%)</td>
<td style="text-align:center">1.0</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), hourly</td>
<td style="text-align:center">23.8</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), monthly</td>
<td style="text-align:center">18.2</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), yearly</td>
<td style="text-align:center">15.6</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), 3-year upfront</td>
<td style="text-align:center">10.0</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), 5-year upfront</td>
<td style="text-align:center">6.9</td>
</tr>
<tr>
<td style="text-align:center">AWS C5N.METAL 96C (On Demand)</td>
<td style="text-align:center">35.0</td>
</tr>
<tr>
<td style="text-align:center">AWS C5N.METAL 96C (1y Reserve, All Upfront)</td>
<td style="text-align:center">20.6</td>
</tr>
<tr>
<td style="text-align:center">AWS C5N.METAL 96C (3y Reserve, All Upfront)</td>
<td style="text-align:center">12.8</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="cloud-rental-price">Cloud Rental Price</h2>
<p>For reference, we can compare the cost to leasing compute power from AWS EC2. A monthly expense of $666 can get you the best specification without storage, the <a href="https://instances.vantage.sh/aws/ec2/c6in.4xlarge">c6in.4xlarge</a> on-demand instance (16 cores, 32G x 3.5GHz); while the on-demand cost for a <a href="https://instances.vantage.sh/aws/ec2/c6a.metal">c7a.metal</a> instance, which has similar compute and memory specification (192C/384G) but excludes EBS storage, is $7,200 per month, which is 10.8 times the comprehensive local build cost; the lowest monthly cost for a 3-year reserved instance can go down to $2,756, which is still 4.1 times the cost of building your own server. If we calculate the cost per core-month, the price for the majority of AWS EC2 instances ranges between $10 ~ $30, which is roughly a hundred to a few hundred dollars, leading us to a rough conclusion: <strong>the unit price of cloud compute is 5 to 10 times that of self-built solutions</strong>.</p>
<p>Note that these prices do not include the hundredfold premium for EBS cloud storage. In &ldquo;<a href="/blog/cloud/ebs/">Is Cloud Disk a Rip-off?</a>&rdquo;, we&rsquo;ve already detailed the cost comparison between enterprise SSDs and equivalent cloud disks. Here, we can provide two updated reference values: the cost per TB-month for the 12TB enterprise NVMe SSD purchased by DHH (with a five-year warranty) is 24 CNY, while the cost per TB-month for a retail Samsung consumer SSD 990Pro on GameStop can reach an astonishing 6.6 CNY&hellip; Meanwhile, the corresponding block storage TB-month cost on AWS and Alibaba Cloud, even after full discounts, is respectively 1,900 and 3,200 CNY. In the most outrageous scenarios (6400 vs 6.6), the premium can even reach a thousandfold. However, a more apples-to-apples comparison results in: <strong>the unit price of cloud block storage is 100 to 200 times that of self-built solutions</strong> (and the performance is not as good as local disks).</p>
<p>EC2 and EBS prices can be considered the anchor of cloud service pricing, for example, the premium rate of cloud databases RDS that mainly use EC2 and EBS compared to local self-built solutions fluctuates between the two, depending on your storage usage: <strong>the unit price of cloud databases is dozens of times that of self-built solutions</strong>. For more details, refer to &ldquo;<a href="/blog/cloud/rds/">Is Cloud Database a Dumb Tax?</a>&rdquo;.</p>
<p>Of course, we can&rsquo;t deny the cost advantages of public clouds for micro instances and startups — for example, the nano instances on public clouds used to patch together 1<del>2C, 0.5</del>2G configurations really can be offered to users at a core-month cost of a few dollars. In &ldquo;<a href="/blog/cloud/cheap-ecs/">Exploiting Alibaba Cloud ECS for a Digital Homestead</a>,&rdquo; I recommended exploiting Alibaba Cloud&rsquo;s Double 11 virtual machine deals for this reason. For instance, a 2C 2G server&rsquo;s compute cost, calculated with a 500% overselling, is 84 CNY per year, and the cost for 40G cloud disk storage, calculated with triple replication, is about 20 CNY per year, making the annual cost for these two parts over a hundred CNY. This doesn&rsquo;t include the cost of a public IP or the more valuable 3M bandwidth (for example, if you could fully utilize 3M bandwidth 24 hours a day, that would mean 32G of data per day, costing about 25 CNY). The list price for such cloud servers is ¥1500 per year, so the 99¥ price allowing for a low-cost renewal for four years indeed can be considered a loss-leading benefit.</p>
<p>However, when your business can no longer be covered by a bunch of micro instances, you really should do the math again carefully: in several key examples, the cost of cloud services is extremely high — whether for large physical machine databases, large NVMe storage, or just the latest and fastest compute. The rental price for such production-grade resources is so high — that a few months&rsquo; rent could equal the cost of buying it outright. In such cases, you really should just buy the donkey!</p>
<hr>
<h2 id="reclaim-hardware-bonus-from-cloud">Reclaim Hardware Bonus from Cloud</h2>
<p>I still remember on April 1, 2019, when the domestic value-added tax in China was officially reduced from 16% to 13%, Apple&rsquo;s official website immediately <a href="https://www.lifeweek.com.cn/article/71403">implemented a price reduction</a> across the board, with the maximum discount reaching 8% — several iconic iPhone models were reduced by 500 yuan, effectively passing the tax cut benefits to the users. However, many manufacturers chose to turn a deaf ear and maintain their original prices, pocketing the benefits for themselves — why would they want to distribute this newfound wealth to the less fortunate? A similar situation has occurred in the cloud computing domain — the exponential decrease in hardware costs has not been fully reflected in the service prices of cloud providers, gradually turning public cloud from a universally accessible infrastructure into a monopolistic cash cow.</p>
<p>In the old days, developers had to deeply understand hardware to write code. However, the older generation of engineers and programmers, who had a keen sense of hardware, have mostly retired, changed positions, moved into management, or stopped learning. Subsequently, as operating systems and compiler technologies advanced and various VM programming languages emerged, software no longer needed to concern itself with how hardware executed instructions. Then came services like EC2, which encapsulated computing power, and S3/EBS, which encapsulated storage, leading applications to interact with HTTP APIs rather than system calls. Software and hardware diverged into two separate realms, each going its own way. An entire new generation of engineers grew up in the cloud environment, shielded from an understanding of computer hardware.</p>
<p>However, things are beginning to change, with hardware becoming interesting again, and cloud providers are unable to perpetually hide this dividend — <strong>the wise are starting to crunch the numbers, and the brave have already taken action</strong>. Pioneers like Musk and DHH have fully recognized this, moving off the cloud and onto solid ground — directly generating tens of millions of dollars in financial benefits, with returns in performance, and gaining more independence in operations. More and more people will come to the same realization, following in the footsteps of these trailblazers to make the wise choice of reclaiming their hardware bonus from the cloud.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-c0e49b0e5d0a3d0c994910d0cc773519">FinOps: Endgame Cloud-Exit</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/Yp_PU8nmyK-NVq0clD98RQ">WeChat</a></b> |
        
		<time datetime="2023-07-06" class="text-muted">2023-07-06</time>
        
	</div>
	<p>At the SACC 2023 FinOps session, I fiercely criticized cloud vendors. This is a transcript of my speech, introducing the ultimate FinOps concept — <strong>cloud-exit</strong> and its best practice.</p>
<hr>
<h2 id="tl-dr">TL; DR</h2>
<p><strong>Misaligned FinOps Focus</strong>: <strong>Total Cost = Unit Price x Quantity</strong>. FinOps efforts are centered around reducing the <strong>quantity</strong> of wasted resources, deliberately ignoring the elephant in the room — <strong>cloud resource unit price</strong>.</p>
<p><strong>Public Cloud as a Slaughterhouse</strong>: Attract customers with cheap EC2/S3, then slaughter them with EBS/RDS. The cost of cloud compute is five times that of in-house, while block storage costs can be over a hundred times more, making it the ultimate cost assassin.</p>
<p><strong>The Endgame of FinOps is Going Off-Cloud</strong>: For enterprises of a certain scale, the cost of in-house IDC is around 10% of the list price of cloud services. Going off-cloud is both the endgame of orthodox FinOps and the starting point of true FinOps.</p>
<p><strong>In-house Capabilities Determine Bargaining Power</strong>: Users with in-house capabilities can negotiate extremely low discounts even without going off-cloud, while companies without in-house capabilities can only pay a high &ldquo;no-expert tax&rdquo; to public cloud vendors.</p>
<p><strong>Databases are Key to In-House Transition</strong>: Migrating stateless applications on K8S and data warehouses is relatively easy. The real challenge is building databases in-house without compromising <strong>quality and security</strong>.</p>
<p><a href="https://mp.weixin.qq.com/s/Yp_PU8nmyK-NVq0clD98RQ"><img src="/img/blog/hero/finops.jpg"></a></p>
<hr>
<h2 id="misaligned-finops-focus">Misaligned FinOps Focus</h2>
<blockquote>
<p>Compared to the amount of waste, the unit price of resources is the key point.</p>
</blockquote>
<p>The FinOps Foundation states that FinOps focuses on &ldquo;<strong>cloud cost optimization</strong>&rdquo;. However, we believe that emphasizing only <strong>public clouds</strong> deliberately narrows this concept — the focus should be on the cost control and optimization of <strong>all</strong> resources, not just those on public clouds — including &ldquo;hybrid clouds&rdquo; and &ldquo;private clouds&rdquo;. Even without using public clouds, some FinOps methodologies can still be applied to the entire K8S cloud-native ecosystem. Because of this, many involved in FinOps are led astray — their focus is limited to <strong>reducing the quantity of cloud resource waste</strong>, neglecting a very important issue: <strong>unit price</strong>.</p>
<p><strong>Total cost</strong> depends on two factors: <strong>Quantity ✖️ Unit Price</strong>. Compared to quantity, <strong>unit price might be the key to cost reduction and efficiency improvement</strong>. Previous speakers mentioned that about 1/3 of cloud resources are wasted on average, which is the optimization space for FinOps. However, if you use non-elastic services on public clouds, the <strong>unit price of the resources</strong> you use is already several to dozens of times higher, making the wasted portion negligible in comparison.</p>
<p>In the first stop of my career, I experienced a FinOps movement firsthand. Our BU was among the first internal users of Alibaba Cloud and also where the &ldquo;<strong>data middle platform</strong>&rdquo; concept originated. Alibaba Cloud sent over a dozen engineers to help us migrate to the cloud. After migrating to ODPS, our annual storage and computing costs were <strong>70 million</strong>, and through FinOps methods like health scoring, we did optimize and save tens of millions. However, running the same services with an in-house Hadoop suite in our data center cost <strong>less than 10 million annually</strong> — <strong>savings are good, but they&rsquo;re nothing compared to the multiplied resource costs</strong>.</p>
<p>As cost reduction and efficiency become the main theme, cloud repatriation is becoming a trend. Alibaba, the inventor of the middle platform concept, has already started dismantling its own middle platform. Yet, many companies are still falling into the trap of the slaughterhouse, repeating the old path of cloud migration - cloud repatriation.</p>
<hr>
<h2 id="public-clouds-a-slaughterhouse-in-disguise">Public Clouds: A Slaughterhouse in Disguise</h2>
<blockquote>
<p>Attract customers with cheap EC2/S3, then slaughter them with EBS/RDS pricing.</p>
</blockquote>
<p>The elasticity touted by public clouds is designed for their business model: <strong>low startup costs, exorbitant maintenance costs</strong>. Low initial costs lure users onto the cloud, and its good elasticity can adapt to business growth at any time. However, once the business stabilizes, vendor lock-in occurs, making it difficult to switch providers without incurring high costs, turning maintenance into a financial nightmare for users. This model is colloquially known as a <a href="/blog/cloud/ebs/"><strong>pig slaughterhouse</strong></a>.</p>
<p><strong>To slaughter pigs, one must first raise them</strong>. You can&rsquo;t catch a wolf without putting your child at risk. Hence, for new users, startups, and small businesses, public clouds offer sweet deals, even at a loss, to make noise and attract business. New users get first-time discounts, startups receive free or half-price credits, and there&rsquo;s a sophisticated pricing strategy. Taking AWS RDS pricing as an example, the mini models with 1 or 2 cores are priced at just <strong>a few dollars per core per month</strong>, translating to a few hundred yuan per year (excluding storage). This is an affordable option for those needing a low-usage database for small data storage.</p>
<p><img src="/img/blog/cloud/finops-1.png"></p>
<p>However, even a slight increase in configuration leads to a <strong>magnitude</strong> increase in the price per core month, skyrocketing to twenty or thirty to a hundred dollars, sometimes even more — not to mention the shocking EBS prices. Users may only realize what has happened when they see the exorbitant bill suddenly appearing.</p>
<p>Compared to in-house solutions, <strong>the price of cloud resources is generally several to more than ten times higher, with a rent-to-buy ratio ranging from a few days to several months</strong>. For example, the cost of a physical server core month in an IDC, including all costs for network, electricity, maintenance, and IT staff, is about 19 yuan. Using a K8S container private cloud, the cost of a virtual core month is only 7 yuan.</p>
<p>In contrast, the price per core month for Alibaba Cloud&rsquo;s ECS is a couple of hundred yuan, and for AWS EC2, it&rsquo;s two to three hundred yuan. If you &ldquo;don&rsquo;t care about elasticity&rdquo; and prepay for three years, you can usually get a discount of about 50-60%. But no matter how you calculate it, the price difference between cloud computing power and local in-house computing power is there and significant.</p>
<p><img src="/img/blog/cloud/finops-2.png"></p>
<p>The pricing of <strong>cloud storage</strong> resources is even more outrageous. A common 3.2 TB enterprise-grade NVMe SSD, with its formidable performance, reliability, and cost-effectiveness, has a wholesale price of just over <strong>¥3000</strong>, significantly outperforming older storage solutions. However, for the same storage on the cloud, providers dare to charge 100 times the price. Compared to direct hardware procurement, <strong>the cost of AWS EBS io2 is 120 times higher, while Alibaba Cloud&rsquo;s ESSD PL3 is 200 times higher</strong>.</p>
<p>Using a 3.2TB enterprise-grade PCI-E SSD card as a benchmark, <strong>the rent-to-buy ratio on AWS is 15 days, while on Alibaba Cloud it&rsquo;s less than 5 days</strong>, meaning renting for this period allows you to purchase the entire disk outright. If you opt for a three-year prepaid purchase on Alibaba Cloud with the maximum discount of 50%, <strong>the three-year rental fee could buy over 120 similar disks</strong>.</p>
<p><img src="/img/blog/cloud/finops-3.png"></p>
<blockquote>
<p>《<a href="/blog/cloud/ebs/">EBS: a real Scam</a>》</p>
</blockquote>
<p>The price markup ratio of cloud databases (RDS) falls between that of cloud disks and cloud servers. For example, using RDS for PostgreSQL on AWS, a 64C / 256GB RDS costs $25,817 per month, equivalent to 180,000 yuan per month. One month&rsquo;s rent is enough to purchase two servers with much better performance for in-house use. <strong>The rent-to-buy ratio is not even a month</strong>; renting for just over ten days would be enough to purchase an entire server.</p>
<p>Any rational enterprise user can see the folly in this: <strong>If the procurement of such services is not for short-term, temporary needs, then it definitely qualifies as a significant financial misjudgment.</strong></p>
<table>
<thead>
<tr>
<th>Payment Model</th>
<th>Price</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted IDC (Single Physical Server)</td>
<td>¥75k / 5 years</td>
<td>1.5</td>
</tr>
<tr>
<td>Self-hosted IDC (2-3 Server HA Cluster)</td>
<td>¥150k / 5 years</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (On-demand)</td>
<td>¥87.36/hour</td>
<td>76.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Monthly)</td>
<td>¥42k / month</td>
<td>50</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Yearly, 15% off)</td>
<td>¥425,095 / year</td>
<td>42.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (3-year, 50% off)</td>
<td>¥750,168 / 3 years</td>
<td>25</td>
</tr>
<tr>
<td>AWS (On-demand)</td>
<td>$25,817 / month</td>
<td>217</td>
</tr>
<tr>
<td>AWS (1-year, no upfront)</td>
<td>$22,827 / month</td>
<td>191.7</td>
</tr>
<tr>
<td>AWS (3-year, full upfront)</td>
<td>$120k + $17.5k/month</td>
<td>175</td>
</tr>
<tr>
<td>AWS China/Ningxia (On-demand)</td>
<td>¥197,489 / month</td>
<td>237</td>
</tr>
<tr>
<td>AWS China/Ningxia (1-year, no upfront)</td>
<td>¥143,176 / month</td>
<td>171</td>
</tr>
<tr>
<td>AWS China/Ningxia (3-year, full upfront)</td>
<td>¥647k + ¥116k/month</td>
<td>160.6</td>
</tr>
</tbody>
</table>
<p>Comparing the costs of self-hosting versus using a cloud database:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted Servers 64C / 384G / 3.2TB NVME SSD 660K IOPS (2-3 servers)</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS PG High-Availability pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3</td>
<td>25 ~ 50</td>
</tr>
<tr>
<td>AWS RDS PG High-Availability db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS</td>
<td>160 ~ 217</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>RDS</strong> pricing compared to self-hosting, see &ldquo;<a href="/blog/cloud/rds/">Is Cloud Database an idiot Tax?</a>&rdquo;</p>
</blockquote>
<p>Any meaningful cost reduction and efficiency increase initiative cannot ignore this issue: if there&rsquo;s potential to slash resource prices by 50% to 200%, then focusing on a 30% reduction in waste is not a priority. As long as your main business is on the cloud, traditional FinOps is like scratching an itch through a boot — <strong>migrating off the cloud is the focal point of FinOps</strong>.</p>
<hr>
<h2 id="the-endgame-of-finops-is-exiting-from-the-cloud">The Endgame of FinOps is Exiting from the Cloud</h2>
<blockquote>
<p>The well-fed do not understand the pangs of hunger, human joys and sorrows are not universally shared.</p>
</blockquote>
<p>I spent five years at Tantan — a Nordic-style internet startup founded by a Swede. Nordic engineers have a characteristic pragmatism. When it comes to choosing between cloud and on-premise solutions, they are not swayed by hype or marketing but rather make decisions based on quantitative analysis of pros and cons. We meticulously calculated the costs of building our own infrastructure versus using the cloud — the straightforward conclusion was that <strong>the total cost of on-premise solutions (including labor) generally fluctuates between 10% to 100% of the list price for cloud services</strong>.</p>
<p>Thus, from its inception, Tantan chose to build its own infrastructure. Apart from overseas compliance businesses, CDN, and a very small amount of elastic services using public clouds, the main part of our operations was entirely hosted in IDC-managed data centers. Our database was not small, with 13K cores for PostgreSQL and 12K cores for Redis, 4.5 million QPS, and 300TB of unique transactional data. The annual cost for these two parts was less than 10 million yuan: including salaries for two DBAs, one network engineer, network and electricity, managed hosting fees, and hardware amortized over five years. However, for such a scale, if we were to use cloud databases, even with significant discounts, the starting cost would be between 50 to 60 million yuan, not to mention the even more expensive big data sector.</p>
<p>However, digitalization in enterprises is phased, and different companies are at different stages. For many internet companies, they have reached the stage where they are fully engaged with building cloud-native K8S ecosystems. At this stage, focusing on resource utilization, mixed online and offline deployments, and reducing waste are reasonable demands and directions where FinOps should concentrate its efforts. Yet, for the vast majority of enterprises outside the digital realm, the urgent need is not reducing waste but <strong>lowering the unit cost of resources</strong> — Dell servers can be discounted by 50%, IDC virtual machines by 50%, and even cloud services can be heavily discounted. Are these companies still paying the list price, or even facing several times the markup in rebates? <strong>A great many companies are still being severely exploited due to information asymmetry and lack of capability</strong>.</p>
<p>Enterprises should evaluate their scale and stage, assess their business, and weigh the pros and cons accordingly. For small-scale startups, the cloud can indeed save a lot of manpower costs, which is very attractive — <strong>but please be cautious not to be locked in by vendors due to the convenience offered</strong>. If your annual cloud expenditure has already exceeded 1 million yuan, it&rsquo;s time to seriously consider <strong>the benefits of descending from the cloud</strong> — many businesses do not require the elasticity for massive concurrent spikes or training AI models. Paying a premium for temporary/sudden needs or overseas compliance is reasonable, but paying several times to tens of times more for <strong>unnecessary elasticity</strong> is wasteful. You can keep the truly elastic parts of your operations on the public cloud and transfer those parts that do not require elasticity to IDCs. Just by doing this, the cost savings could be astonishing.</p>
<p><strong>Descending from the cloud is the ultimate goal of traditional FinOps and the starting point of true FinOps.</strong></p>
<hr>
<h2 id="self-hosting-matters">Self-Hosting Matters</h2>
<blockquote>
<p>&ldquo;To seek peace through struggle is to preserve peace; to seek peace through compromise is to lose peace.&rdquo;</p>
</blockquote>
<p>When the times are favorable, the world joins forces; when fortune fades, even heroes lose their freedom: During the bubble phase, it was easy to disregard spending heavily in the cloud. However, in an economic downturn, cost reduction and efficiency become central themes. An increasing number of companies are realizing that using cloud services is essentially paying a &ldquo;no-expert tax&rdquo; and &ldquo;protection money&rdquo;. Consequently, a trend of &ldquo;cloud repatriation&rdquo; has emerged, with 37Signals&rsquo; DHH being one of the most notable proponents. Correspondingly, the revenue growth rate of major cloud providers worldwide has been experiencing a continuous decline, with Alibaba Cloud&rsquo;s revenue even starting to shrink in the first quarter of 2023.</p>
<p><img src="/img/blog/cloud/finops-5.png"></p>
<blockquote>
<p>《<a href="/blog/cloud/profit/">&ldquo;Why Cloud Computing Hasn&rsquo;t Yet Hit Its Stride in Earning Profits&rdquo;</a>》</p>
</blockquote>
<p>The underlying trend is the emergence of <strong>open-source alternatives</strong>, breaking down the <strong>technical barriers</strong> of public clouds; the advent of resource clouds/IDC2.0, offering a cost-effective alternative to public cloud resources; and the release of technical talents from large layoffs, along with the future of AI models, giving every industry the opportunity to possess the expert knowledge and capability required for self-hosting. Combining these trends, <strong>the combination of IDC2.0 + open-source self-hosting is becoming increasingly competitive</strong>: <strong>Bypassing the public cloud intermediaries and working directly with IDCs is clearly a more economical choice</strong>.</p>
<p>Public cloud providers are not incapable of engaging in the business of selling IDC resources profitably. Given their higher level of expertise compared to IDCs, they should, in theory, leverage their technological advantages and economies of scale to offer cheaper resources than IDC self-hosting. However, the harsh reality is that resource clouds can offer users virtual machines at a 80% discount, while public clouds cannot. Even considering the exponential growth law of Moore&rsquo;s Law in the storage and computing industry, public clouds are actually <strong>increasing their prices</strong> every year!</p>
<p>Well-informed major clients, especially those capable of migrating at will, can indeed negotiate for <strong>80% off</strong> the list prices with public clouds, a feat unlikely for smaller clients — in this sense, <strong>clouds are essentially subsidizing large clients by bleeding small and medium-sized clients dry</strong>. <strong>Cloud vendors offer massive discounts to large clients while fleecing small and medium-sized clients and developers</strong>, completely contradicting the original intention and vision of cloud computing.</p>
<p>Clouds lure in users with low initial prices, but once users are deeply locked in, the slaughter begins — the previously discussed discounts and benefits disappear at each renewal. Escaping the cloud entails a significant cost, leaving users in a dilemma between a rock and a hard place, forced to continue paying protection money.</p>
<p>However, for users with the capability to self-host, capable of flexibly moving between multi-cloud and on-premises hybrid clouds, this is not an issue: <strong>The trump card in negotiations is the ability to go off-cloud or migrate to another cloud at any time</strong>. This is more effective than any argument — as the saying goes, &ldquo;<strong>To seek peace through struggle is to preserve peace; to seek peace through compromise is to lose peace</strong>.&rdquo; <strong>The extent of cost reduction depends on your bargaining power, which in turn depends on your ability to self-host</strong>.</p>
<p><strong>Self-hosting might seem daunting, but it is not difficult for those who know how</strong>. The key is addressing the core issues of <strong>resources</strong> and <strong>capabilities</strong>. In 2023, due to the emergence of resource clouds and open-source alternatives, these issues have become much simpler than before.</p>
<p><strong>In terms of resources, IDC and resource clouds have solved the problem adequately</strong>. The aforementioned IDC self-hosting doesn&rsquo;t mean buying land and building data centers from scratch but directly using the hosting services of resource clouds/IDCs — you might only need a network engineer to plan the network, with other maintenance tasks managed by the provider.</p>
<p>If you prefer not to hassle, IDCs can directly sell you virtual machines at 20% of the list price, or you can rent a physical server with 64C/256G for a couple thousand a month; whether renting an entire data center or just a single colocation space, it&rsquo;s all feasible. A retail colocation space with comprehensive services can be settled for about five thousand a year, running a K8S or virtualization on a couple of hundred-core physical servers, why bother with flexible ECS?</p>
<hr>
<h2 id="finops-leads-to-cloud-exit">FinOps Leads to CLoud-Exit</h2>
<p>Building your own infrastructure comes with the added perk of extreme FinOps—utilizing out-of-warranty or even second-hand servers. Servers are typically depreciated over three to five years, yet it&rsquo;s not rare to see them operational for eight to ten years. This contrasts with cloud services, where you&rsquo;re just consuming resources; owning your server translates to tangible assets, making any extended use essentially a gain.</p>
<p>For instance, a new 64-core, 256GB server could cost around $7,000, but after a year or two, the price for such &ldquo;electronic waste&rdquo; drops to merely $400.
By replacing the most failure-prone components with brand new enterprise-grade 3.2TB NVMe SSDs (costing $390), you could secure the entire setup for just $800.</p>
<p>In such scenarios, your vCPU·Month price could plummet to less than $0.15, a figure legendary in the gaming industry, where server costs can dip to mere cents.
With Kubernetes (K8S) orchestration and database high-availability switching, reliability can be assured through parallel operation of multiple such servers, achieving an astonishing cost-efficiency ratio.</p>
<p>In terms of capability, with the emergence of sufficiently robust open-source alternatives, the difficulty of self-hosting has dramatically decreased compared to a few years ago.</p>
<p>For example, Kubernetes/OpenStack/SealOS are open-source alternatives to cloud providers&rsquo; EC2/ECS/VPS management software; MinIO/Ceph aim to replace S3/OSS; while Pigsty and various database operators serve as open-source substitutes for RDS cloud database management. There&rsquo;s a plethora of open-source software available for effectively utilizing these resources, along with numerous commercial entities offering transparently priced support services.</p>
<p>Your operations should ideally converge to using just virtual machines and object storage, the lowest common denominator across all cloud providers. Ideally, all applications should run on Kubernetes, which can operate in any environment—be it a cloud-hosted K8S, ECS, dedicated servers, or your own data center. External states like database backups and big data warehouses should be managed with compute-storage separation, using MinIO/S3 storage.</p>
<p>Such a CloudNative tech stack theoretically enables operation and flexible migration across any resource environment, thus avoiding vendor lock-in and maintaining control. This allows you to either significantly cut costs by moving off the cloud or leverage it to negotiate discounts with public cloud providers.</p>
<p>However, self-hosting isn&rsquo;t without risks, with RDS representing a major potential vulnerability.</p>
<hr>
<h3 id="database-the-biggest-risk-factor">Database: The Biggest Risk Factor</h3>
<blockquote>
<p><strong>Cloud databases</strong> may not be the most expensive line item, but they are definitely the most deeply locked-in and challenging to migrate.</p>
</blockquote>
<p>Quality, security, efficiency, and cost represent different levels of a hierarchical pyramid of needs. The goal of FinOps is to reduce costs and increase efficiency <strong>without compromising quality and security</strong>.</p>
<p>Stateless apps on K8S or offline big data platforms pose little fatal risk when migrating. Especially if you have already achieved <strong>big data compute-storage separation</strong> and <strong>stateless app cloud-native</strong> transformation, moving these components is generally not too troublesome. The former can afford a few hours of downtime, while the latter can be updated through blue-green deployments and canary releases. <strong>The database, serving as the working memory, is prone to major issues when migrated.</strong></p>
<p>Most IT system architectures are centered around the database, making it the key risk point in cloud migration, particularly with OLTP databases/RDS. Many users hesitate to move off the cloud and self-host due to the lack of reliable database services — traditional Kubernetes Operators don’t fully replicate the cloud database experience: hosting OLTP databases on K8S/containers with EBS is not yet a mature practice.</p>
<p><strong>There&rsquo;s a growing demand for a viable open-source alternative to RDS</strong>, and that&rsquo;s precisely what we aim to address: enabling users to establish a local RDS service in any environment that matches or exceeds cloud databases — <strong>Pigsty</strong>, a free open-source alternative to RDS PG. It empowers users to effectively utilize <a href="/zh/blog//db/pg-is-best/">PostgreSQL, the world’s most advanced and successful database</a>.</p>
<p>Pigsty is a non-profit, open-source software powered by community love. It offers a ready-to-use, feature-rich PostgreSQL distribution with automatic high availability, PITR, top-tier monitoring systems, Infrastructure as Code, cloud-based Terraform templates, local Vagrant sandbox for one-click installation, and SOP manuals for various operations, enabling quick RDS self-setup without needing a professional DBA.</p>
<p>Although Pigsty is a database distribution, it enables users to practice ultimate FinOps—running production-level PostgreSQL RDS services anywhere (ECS, resource clouds, data center servers, or even local laptop VMs) at almost pure resource cost. <strong>It turns the cost of cloud database capabilities from being proportional to marginal resource costs to nearly zero in fixed learning costs</strong>.</p>
<p><img src="/img/blog/cloud/finops-7.png"></p>
<p>Perhaps it&rsquo;s the socialist ethos of Nordic companies that nurtures such pure free software. Our goal isn’t profit but to promote a philosophy: to democratize the expertise of using the advanced open-source database PostgreSQL for everyone, not just cloud monopolies. Cloud providers monopolize open-source expertise and roles, exploiting free open-source software, and we aim to break this monopoly—<strong>Freedom is not free. You shouldn&rsquo;t concede the world to those you despise but rather overturn their table</strong>.</p>
<p><strong>This is the essence of FinOps—empowering users with viable alternatives and the ability to self-host, thus negotiating with cloud providers from a position of strength</strong>.</p>
<hr>
<h2 id="references">References</h2>
<p>[1] <a href="https://mp.weixin.qq.com/s/JU4lznF6-5Q4LaJTnG8SSQ">云计算为啥还没挖沙子赚钱？</a></p>
<p>[2] <a href="https://mp.weixin.qq.com/s/c8bpK4o3H7-EyRqVdNDndQ">云数据库是不是智商税？</a></p>
<p>[3] <a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA">云SLA是不是安慰剂？</a></p>
<p>[4] <a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">云盘是不是杀猪盘？</a></p>
<p>[5] <a href="https://mp.weixin.qq.com/s/Yp6L0hh4b4HuJQRPD3aJYw">范式转移：从云到本地优先</a></p>
<p>[6] <a href="https://mp.weixin.qq.com/s/TksQ108v_nGaW11-87Es3A">杀猪盘真的降价了吗？</a></p>
<p>[7] <a href="https://mp.weixin.qq.com/s/WsR-c64OJfkMql7zX7XmDA">炮打 RDS，Pigsty v2.0 发布</a></p>
<p>[8] <a href="https://mp.weixin.qq.com/s/ANFnbDXwuhKI99fgYRZ9ug">垃圾腾讯云CDN：从入门到放弃</a></p>
<p>[9] <a href="https://mp.weixin.qq.com/s/AGEW1iHQkQy4NQyYC2GonQ">云RDS：从删库到跑路</a></p>
<p>[10] <a href="https://mp.weixin.qq.com/s/-eaCoZR9Z5srQ-1YZm1QJA">分布式数据库是伪需求吗？</a></p>
<p>[11] <a href="https://mp.weixin.qq.com/s/mEmz8pviahEAWy1-SA8vcg">微服务是不是个蠢主意？</a></p>
<p>[12] <a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485518&idx=1&sn=3d5f3c753facc829b2300a15df50d237&chksm=fe4b3d95c93cb4833b8e80433cff46a893f939154be60a2a24ee96598f96b32271301abfda1f&scene=21#wechat_redirect">更好的开源RDS替代：Pigsty</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-fb2b56bca82f7d919a808b2f73758318">SLA: Placebo or Insurance?</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA">WeChat</a></b> |
        
		<time datetime="2023-06-12" class="text-muted">2023-06-12</time>
        
	</div>
	<p>In the world of cloud computing, Service Level Agreements (SLAs) are seen as a cloud provider&rsquo;s commitment to the quality of its services. However, a closer examination of these SLAs reveals that they might not offer the safety net one might expect: you might think you&rsquo;ve insured your database for peace of mind, but in reality, you&rsquo;ve bought a placebo that provides emotional comfort rather than actual coverage.</p>
<p><a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA"><img src="/img/blog/hero/sla.jpg"></a></p>
<hr>
<h2 id="insurance-policy-or-placebo">Insurance Policy or Placebo?</h2>
<p>One of the reasons many users opt for cloud services is for the &ldquo;safety net&rdquo; they supposedly provide, often referring to the <strong>SLA</strong> when asked what this &ldquo;safety net&rdquo; entails. Cloud experts liken purchasing cloud services to buying insurance: certain failures might never occur throughout many companies&rsquo; lifespans, but should they happen, the consequences could be catastrophic. In such cases, a cloud service provider&rsquo;s SLA is supposed to act as this safety net. Yet, when we actually review these SLAs, we find that this &ldquo;policy&rdquo; isn&rsquo;t as useful as one might think.</p>
<p>Data is the lifeline of many businesses, and cloud storage serves as the foundation for nearly all data storage on the public cloud. Let&rsquo;s take cloud storage services as an example. Many cloud service providers boast of their cloud storage services having nine nines of <strong>data reliability</strong> [1]. However, upon examining their SLAs, we find that these crucial promises are conspicuously absent from the SLAs [2].</p>
<p>What is typically included in the SLAs is the service&rsquo;s <strong>availability</strong>. Even this promised availability is superficial, paling in comparison to the core business reliability metrics in the real world, with compensation schemes that are practically negligible in the face of common downtime losses. <strong>Compared to an insurance policy, SLAs more closely resemble placebos that offer emotional value.</strong></p>
<hr>
<h2 id="subpar-availability">Subpar Availability</h2>
<p>The key metric used in cloud SLAs is availability. Cloud service availability is typically represented as the proportion of time a resource can be accessed from the outside, usually over a one-month period. If a user cannot access the resource over the Internet due to a problem on the cloud provider&rsquo;s end, the resource is considered unavailable/down.</p>
<p>Taking the industry benchmark AWS as an example, most of its services use a similar SLA template [3]. The SLA for a single virtual machine on AWS is as follows [4]. This means that in the best-case scenario, if an EC2 instance on AWS is unavailable for less than 21 minutes in a month (99.9% availability), AWS compensates nothing. In the worst-case scenario, only when the unavailability exceeds 36 hours (95% availability) can you receive a 100% credit return.</p>
<blockquote>
<p><strong>Instance-Level SLA</strong></p>
<p>For each individual Amazon EC2 instance (“Single EC2 Instance”), AWS will use commercially reasonable efforts to make the Single EC2 Instance available with an Instance-Level Uptime Percentage of at least 99.5%, in each case during any monthly billing cycle (the “Instance-Level SLA”). In the event any Single EC2 Instance does not meet the Instance-Level SLA, you will be eligible to receive a Service Credit as described below.</p>
<table>
<thead>
<tr>
<th><strong>Instance-Level Uptime Percentage</strong></th>
<th><strong>Service Credit Percentage</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Less than 99.5% but equal to or greater than 99.0%</td>
<td>10%</td>
</tr>
<tr>
<td>Less than 99.0% but equal to or greater than 95.0%</td>
<td>30%</td>
</tr>
<tr>
<td>Less than 95.0%</td>
<td>100%</td>
</tr>
</tbody>
</table>
<p>Note: In addition to the Instance-Level SLA, AWS will not charge you for any Single EC2 Instance that is Unavailable for more than six minutes of a clockhour. This applies automatically and you do not need to request credit for any such hour with more than six minutes of Unavailability.</p>
</blockquote>
<blockquote>
<p><a href="https://aws.amazon.com/compute/sla/">https://aws.amazon.com/compute/sla/</a></p>
</blockquote>
<p>For some internet companies, a 15-minute service outage is enough to jeopardize bonuses, and a 30-minute outage is sufficient for leadership changes. The actual availability of core systems running most of the time might have five nines, six nines, or even infinite nines. Cloud providers, incubated from major internet companies, using such inferior availability metrics is indeed disappointing.</p>
<p>What&rsquo;s more outrageous is that these compensations are not automatically provided to you after a failure occurs. Users are required to measure downtime themselves, submit evidence for claims within a specific timeframe (<strong>usually two months</strong>), and request compensation to receive any. This requires users to collect monitoring metrics and log evidence to negotiate with cloud providers, and the compensation returned is not in cash but in vouchers/duration compensations — <strong>meaning virtually no real loss for the cloud providers and no actual value for the users, with almost no chance of compensating for the actual losses incurred during service interruptions.</strong></p>
<hr>
<h2 id="is-the-safety-net-meaningful">Is the &ldquo;Safety Net&rdquo; Meaningful?</h2>
<p>For businesses, a &ldquo;safety net&rdquo; means minimizing losses as much as possible when failures occur. Unfortunately, SLAs are of little help in this regard.</p>
<p>The impact of service unavailability on business varies by industry, time, and duration. A brief outage of a few seconds to minutes might not significantly affect general industries, <strong>however, long-term outages (several hours to several days) can severely affect revenue and reputation</strong>.</p>
<p>In the Uptime Institute&rsquo;s 2021 data center survey [5], several of the most severe outages cost respondents an average of nearly $1 million, not including the worst 2% of cases, which suffered losses exceeding $40 million.</p>
<p><img src="/zh/blog/cloud/sla/sla-2.png"></p>
<p>However, SLA compensations are a drop in the ocean compared to these business losses. Taking the <code>t4g.nano</code> virtual machine instance in the <code>us-east-1</code> region as an example, priced at about $3 per month. If the unavailability is less than 7 hours and 18 minutes (99% monthly availability), AWS will pay 10% of the monthly cost of that virtual machine, a total compensation of 30 cents. If the virtual machine is unavailable for less than 36 hours (95% availability within a month), the compensation is only 30% — less than $1. <strong>Only if the unavailability exceeds a day and a half, can users receive a full refund for the month — $3</strong>. Even if compensating for thousands of instances, this is virtually negligible compared to the losses.</p>
<p>In contrast, the traditional insurance industry genuinely provides coverage for its customers. For instance, SF Express charges 1% of the item&rsquo;s value for insurance, but if the item is lost, they compensate the full amount. Similarly, commercial health insurance costing tens of thousands yearly can cover millions in medical expenses. &ldquo;Insurance&rdquo; in this industry truly means you get what you pay for.</p>
<p>Cloud service providers charge far more than the BOM for their expensive services (see: &ldquo;Are Public Clouds a Pig Butchering Scam?&rdquo; [7]), but when service issues arise, their so-called &ldquo;safety net&rdquo; compensation is merely vouchers, which is clearly unfair.</p>
<hr>
<h2 id="vanished-reliability">Vanished Reliability</h2>
<p>Some people use cloud services to &ldquo;pass the buck,&rdquo; absolving themselves of responsibility. However, some critical responsibilities cannot be shifted to external IT suppliers, such as <strong>data security</strong>. Users might tolerate temporary service unavailability, but the damage caused by lost or corrupted data is often unacceptable. <strong>Blindly trusting exaggerated promises can have severe consequences, potentially a matter of life and death for a startup.</strong></p>
<p>In storage products offered by various cloud providers, it&rsquo;s common to see promises of nine nines of reliability [1], implying a one in a billion chance of data loss when using cloud disks. Examining actual reports on cloud provider disk failure rates [6] casts doubt on these figures. However, as long as providers are bold enough to make, stand by, and honor such claims, there shouldn&rsquo;t be an issue.</p>
<p><img src="/zh/blog/cloud/sla/sla-3.png"></p>
<p>Yet, upon examining the SLAs of various cloud providers, this promise disappears! [2]</p>
<p>In the 2018 sensational case &ldquo;The Disaster Tencent Cloud Brought to a Startup Company!&rdquo; [8], the startup believed the cloud provider&rsquo;s promises and stored data on server hard drives, only to encounter what was termed &ldquo;silent disk errors&rdquo;: &ldquo;Years of accumulated data were lost, causing nearly ten million yuan in losses.&rdquo; Tencent Cloud expressed apologies to the company, willing to compensate the actual expenses incurred on Tencent Cloud totaling 3,569 yuan and, with the aim of helping the business quickly recover, promised an additional compensation of 132,900 yuan</p>
<hr>
<h2 id="what-exactly-is-an-sla">What Exactly is an SLA</h2>
<p>Having discussed this far, proponents of cloud services might play their last card: although the post-failure &ldquo;safety net&rdquo; is a facade, what users need is to avoid failures as much as possible. According to the SLA promises, there is a 99.99% probability of avoiding failures, which is of the most value to users.</p>
<p>However, SLAs are deliberately confused with the actual reliability of the service: Users should not consider SLAs as reliable indicators of service availability — not even as accurate records of past availability levels. For providers, an SLA is not a real commitment to reliability or a track record but a marketing tool designed to convince buyers that the cloud provider can host critical business applications.</p>
<p>The UPTIME INSTITUTE&rsquo;s annual data center failure analysis report shows that many cloud services perform below their published SLAs. The analysis of failures in 2022 found that efforts to contain the frequency of failures have failed, and the cost and consequences of failures are worsening [9].</p>
<blockquote>
<p><strong>Key Findings Include</strong>:</p>
<ul>
<li><strong>High outage rates haven’t changed significantly.</strong> One in five organizations report experiencing a “serious” or “severe” outage (involving significant financial losses, reputational damage, compliance breaches and in some severe cases, loss of life) in the past three years, marking a slight upward trend in the prevalence of major outages. According to Uptime’s 2022 Data Center Resiliency Survey, 80% of data center managers and operators have experienced some type of outage in the past three years – a marginal increase over the norm, which has fluctuated between 70% and 80%.</li>
<li><strong>The proportion of outages costing over $100,000 has soared in recent years.</strong> Over 60% of failures result in at least $100,000 in total losses, up substantially from 39% in 2019. The share of outages that cost upwards of $1 million increased from 11% to 15% over that same period.</li>
<li><strong>Power-related problems continue to dog data center operators.</strong> Power-related outages account for 43% of outages that are classified as significant (causing downtime and financial loss). The single biggest cause of power incidents is uninterruptible power supply (UPS) failures.</li>
<li><strong>Networking issues are causing a large portion of IT outages.</strong> According to Uptime’s 2022 Data Center Resiliency Survey, networking-related problems have been the single biggest cause of all IT service downtime incidents – regardless of severity – over the past three years. Outages attributed to software, network and systems issues are on the rise due to complexities from the increasing use of cloud technologies, software-defined architectures and hybrid, distributed architectures.</li>
<li><strong>The overwhelming majority of human error-related outages involve ignored or inadequate procedures.</strong> Nearly 40% of organizations have suffered a major outage caused by human error over the past three years. Of these incidents, 85% stem from staff failing to follow procedures or from flaws in the processes and procedures themselves.</li>
<li><strong>External IT providers cause most major public outages.</strong> The more workloads that are outsourced to external providers, the more these operators account for high-profile, public outages. Third-party, commercial IT operators (including cloud, hosting, colocation, telecommunication providers, etc.) account for 63% of all publicly reported outages that Uptime has tracked since 2016. In 2021, commercial operators caused 70% of all outages.</li>
<li><strong>Prolonged downtime is becoming more common in publicly reported outages.</strong> The gap between the beginning of a major public outage and full recovery has stretched significantly over the last five years. Nearly 30% of these outages in 2021 lasted more than 24 hours, a disturbing increase from just 8% in 2017.</li>
<li><strong>Public outage trends suggest there will be at least 20 serious, high-profile IT outages worldwide each year.</strong> Of the 108 publicly reported outages in 2021, 27 were serious or severe. This ratio has been fairly consistent since the Uptime Intelligence team began cataloging major outages in 2016, indicating that roughly one-fourth of publicly recorded outages each year are likely to be serious or severe.</li>
</ul>
</blockquote>
<p>Rather than compensating users, SLAs are more of a &ldquo;punishment&rdquo; for cloud providers when their service quality fails to meet standards. The deterrent effect of the punishment depends on the certainty and severity of the punishment. Monthly duration/voucher compensations impose virtually no real cost on cloud providers, making the severity of the punishment nearly zero; compensation also requires users to submit evidence and get approval from the cloud provider, meaning the certainty is not high either.</p>
<p>Compared to experts and engineers who might lose bonuses and jobs due to failures, the punishment of SLAs for cloud providers is akin to a slap on the wrist. If the punishment is meaningless, then cloud providers have no incentive to improve service quality. When users encounter problems, they can only wait and die, and the service attitude towards small customers, in particular, is arrogantly dismissive compared to self-built/third-party service companies.</p>
<p>More subtly, cloud providers have absolute power over the SLA agreement: they reserve the right to unilaterally adjust and revise SLAs and inform users of their effectiveness, leaving users with only the right to choose not to use the service, without any participation or choice. As a default &ldquo;take-it-or-leave-it&rdquo; clause, it blocks any possibility for users to seek meaningful compensation.</p>
<p>Thus, SLAs are not an insurance policy against losses for users. In the worst-case scenario, it&rsquo;s an unavoidable loss; at best, it provides emotional comfort. Therefore, when choosing cloud services, we need to be vigilant and fully understand the contents of their SLAs to make informed decisions.</p>
<hr>
<h2 id="reference">Reference</h2>
<p>【1】<a href="https://help.aliyun.com/document_detail/122389.html">阿里云 ESSD云盘</a></p>
<p>【2】<a href="https://help.aliyun.com/document_detail/56773.htm">阿里云 SLA 汇总页</a></p>
<p>【3】<a href="https://aws.amazon.com/cn/legal/service-level-agreements/">AWS SLA 汇总页</a></p>
<p>【4】<a href="https://d1.awsstatic.com/legal/AmazonComputeServiceLevelAgreement/Amazon_Compute_Service_Level_Agreement_Chinese_Simplfied_(CN)2022-05-25.pdf">AWS EC2 SLA 样例</a></p>
<p>【5】<a href="https://journal.uptimeinstitute.com/cloud-slas-punish-not-compensate/">云SLA更像是惩罚用户而不是补偿用户</a></p>
<p>【6】<a href="https://www.usenix.org/system/files/atc22-lu.pdf">NVMe SSD失效率统计</a></p>
<p>【7】<a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">公有云是不是杀猪盘</a></p>
<p>【8】<a href="https://www.doit.com.cn/p/312087.html">腾讯云给一家创业公司带来的灾难！</a></p>
<p>【9】<a href="https://www.businesswire.com/news/home/20220608005265/en/Uptime-Institute%E2%80%99s-2022-Outage-Analysis-Finds-Downtime-Costs-and-Consequences-Worsening-as-Industry-Efforts-to-Curb-Outage-Frequency-Fall-Short">Uptime Institute 2022 故障分析</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-9acfe4d5f6e1972f749837119d2bab4b">EBS: Pig Slaughter Scam</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">WeChat</a></b> |
        
		<time datetime="2023-03-15" class="text-muted">2023-03-15</time>
        
	</div>
	<p>We already answer the question: <a href="/blog/cloud/rds/">Is RDS an Idiot Tax?</a>.
But when compared to the <strong>hundredfold markup of public cloud block storage</strong>, cloud databases seem almost reasonable. This article uses real data to reveal the true business model of public cloud: <strong>&ldquo;Cheap&rdquo; EC2/S3 to attract customers, and fleece with &ldquo;Expensive&rdquo; EBS/RDS</strong>. Such practices have led public clouds to diverge from their original mission and vision.</p>
<ul>
<li><a href="/blog/cloud/ebs/#tl-dr">TLDR</a></li>
<li><a href="/blog/cloud/ebs/#what-a-scam">WHAT a Scam</a></li>
<li><a href="/blog/cloud/ebs/#why-so-pricing">WHY so pricing</a></li>
<li><a href="/blog/cloud/ebs/#how-to-do-that">HOW to do that</a></li>
<li><a href="/blog/cloud/ebs/#the-forgotten-vision">The Forgotten Vision</a></li>
<li><a href="/blog/cloud/ebs/#where-to-go">Where to Go</a></li>
<li><a href="/blog/cloud/ebs/#references">References</a></li>
</ul>
<p><a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag"><img src="/zh/blog/cloud/ebs/featured.jpg"></a></p>
<hr>
<h2 id="tl-dr">TL; DR</h2>
<p>EC2/S3/EBS pricing serves as the anchor for all cloud services pricing. While the pricing for EC2/S3 might still be considered reasonable, EBS pricing is outright extortionate. The best block storage services offered by public cloud providers are essentially on par with off-the-shelf PCI-E NVMe SSDs in terms of performance specifications. Yet, compared to direct hardware purchases, <strong>the cost of AWS EBS can be up to 60 times higher, and Alibaba Cloud&rsquo;s ESSD can reach up to 100 times higher.</strong></p>
<p>Why is there such a staggering markup for plug-and-play disk hardware? Cloud providers fail to justify the exorbitant prices. When considering the design and pricing models of other cloud storage services, there&rsquo;s only one plausible explanation: <strong>The high markup on EBS is a deliberately set barrier, intended to fleece cloud database customers</strong>.</p>
<p>With EC2 and EBS serving as the pricing anchors for cloud databases, their markups are several and several dozen times higher, respectively, thus supporting the exorbitant profit margins of cloud databases. However, such monopolistic profits are unsustainable: the impact of IDC 2.0/telecom/national cloud on IaaS; private cloud/cloud-native/open source as alternatives to PaaS; and the tech industry&rsquo;s massive layoffs, AI disruption, and the impact of China&rsquo;s low labor costs on cloud services (through IT outsourcing/shared expertise). <strong>If public clouds continue to adhere to their current fleecing model, diverging from their original mission of providing fundamental compute and storage infrastructure, they will inevitably face increasingly severe competition and challenges from the aforementioned forces.</strong></p>
<hr>
<h2 id="what-a-scam">WHAT a Scam!</h2>
<p>When you use a microwave at home to heat up a ready-to-eat braised chicken rice meal costing 10 yuan, you wouldn&rsquo;t mind if a restaurant charges you 30 yuan for microwaving the same meal and serving it to you, considering the costs of rent, utilities, labor, and service. But what if the restaurant charges you 1000 yuan for the same dish, claiming: <strong>&ldquo;What we offer is not just braised chicken rice, but a reliable and flexible dining service&rdquo;</strong>, with the chef controlling the quality and cooking time, pay-per-portion so you get exactly as much as you want, pay-per-need so you get as much as you eat, with options to switch to hot and spicy soup or skewers if you don&rsquo;t feel like chicken, claiming it&rsquo;s all worth the price. Wouldn&rsquo;t you feel the urge to give the owner a piece of your mind? This is exactly what&rsquo;s happening with block storage!</p>
<p>With hardware technology evolving rapidly, <strong>PCI-E NVMe SSDs</strong> have reached a new level of performance across various metrics. A common 3.2 TB enterprise-grade MLC SSD offers incredible performance, reliability, and value for money, costing less than ¥3000, significantly outperforming older storage solutions.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-1.png"></p>
<p>Aliyun ESSD PL3 and our own IDC&rsquo;s procured PCI-E NVMe SSDs come from the same supplier. Hence, their maximum capacity and IOPS limitations are identical. AWS&rsquo;s top-tier block storage solution, io2 Block Express, also shares similar specifications and metrics. Cloud providers&rsquo; highest-end storage solutions utilize these 32TB single cards, leading to a maximum capacity limit of 32TB (64TB for AWS), which suggests a high degree of hardware consistency underneath.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-2.png"></p>
<p>However, compared to direct hardware procurement, <strong>the cost of AWS EBS io2 is up to 120 times higher, while Aliyun&rsquo;s ESSD PL3 is up to 200 times higher</strong>. Taking a 3.2TB enterprise-grade PCI-E SSD card as a reference, the ratio of on-demand rental to purchase price is 15 days on AWS and less than 5 days on Aliyun, meaning you could own the entire disk after renting it for this duration. If you opt for a three-year prepaid purchase on Aliyun, taking advantage of the maximum 50% discount, the rental fees over three years could buy over 120 disks of the same model.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-3.gif"></p>
<blockquote>
<p>Is that SSD made of gold ?</p>
</blockquote>
<p><strong>Cloud providers argue that block storage should be compared to SAN</strong> rather than local DAS, which should be compared to <strong>instance storage (Host Storage)</strong> on the cloud. However, public cloud instance storage is generally ephemeral (Ephemeral Storage), with data being wiped once the instance is paused/stopped【7,11】, making it unsuitable for serious production databases. Cloud providers themselves advise against storing critical data on it. Therefore, the only viable option for database storage is EBS block storage. Products like DBFS, which have similar performance and cost metrics to EBS, are also included in this category.</p>
<p>Ultimately, users care not about whether the underlying hardware is SAN, SSD, or HDD; the real priorities are tangible metrics: <strong>latency, IOPS, reliability, and cost</strong>. Comparing local options with the best cloud solutions poses no issue, especially when the top-tier cloud storage uses the same local disks.</p>
<p>Some &ldquo;experts&rdquo; claim that cloud block storage is stable and reliable, offering multi-replica redundancy and error correction. In the past, Share Everything databases required SAN storage, but many databases now operate on a Share Nothing architecture. Redundancy is managed at the database instance level, eliminating the need for triple-replica storage redundancy, especially since enterprise-grade disks already possess strong self-correction capabilities and safety redundancy (UBER &lt; 1e-18). <strong>With redundancy already in place at the database level, multi-replica block storage becomes an unnecessary waste for databases</strong>. Even if cloud providers did use two additional replicas for redundancy, it would only reduce the markup from 200x to 66x, without fundamentally changing the situation.</p>
<p><strong>&ldquo;Experts&rdquo; also liken purchasing &ldquo;cloud services&rdquo; to buying insurance</strong>: &ldquo;An annual failure rate of 0.02% may seem negligible to most, but a single incident can be devastating, with the cloud provider offering a safety net.&rdquo; This sounds appealing, but a closer look at cloud providers&rsquo; EBS SLAs reveals no guarantees for reliability. ESSD cloud disk promotions mention 9 nines of data reliability, but such claims are conspicuously absent from the SLAs. <strong>Cloud providers only guarantee availability, and even then, the guarantees are modest</strong>, as illustrated by the AWS EBS SLA:</p>
<p><img src="/zh/blog/cloud/ebs/ebs-4.png"></p>
<blockquote>
<p>《<a href="/blog/cloud/sla/">Is the Cloud SLA Just a Placebo?</a>》</p>
</blockquote>
<p>In plain language: if the service is down for a day and a half in a month (95% availability), you get a 100% coupon for that month&rsquo;s service fee; seven hours of downtime (99%) yields a 30% coupon; and a few minutes of downtime (99.9% for a single disk, 99.99% for a region) earns a 10% coupon. Cloud providers charge a hundredfold more, yet offer mere coupons as compensation for significant outages. Applications that can&rsquo;t tolerate even a few minutes of downtime wouldn&rsquo;t benefit from these meager coupons, reminiscent of the past incident, &ldquo;The Disaster Tencent Cloud Brought to a Startup Company.&rdquo;</p>
<p>SF Express offers 1% insurance for parcels, compensating for losses with real money. Annual commercial health insurance plans costing tens of thousands can cover millions in expenses when issues arise. The insurance industry should not be insulted; it operates on a principle of value for money. <strong>Thus, an SLA is not an insurance policy against losses for users. At worst, it&rsquo;s a bitter pill to swallow without recourse; at best, it provides emotional comfort.</strong></p>
<p>The premium charged for cloud database services might be justified by &ldquo;expert manpower,&rdquo; but this rationale falls flat for plug-and-play disks, <strong>with cloud providers unable to explain the exorbitant price markup</strong>. When pressed, their engineers might only say:</p>
<p>&ldquo;We&rsquo;re just following AWS; that&rsquo;s how they designed it.&rdquo;</p>
<hr>
<h2 id="why-so-pricing">WHY so Pricing?</h2>
<p>Even engineers within public cloud services may not fully grasp the rationale behind their pricing strategies, and those who do are unlikely to share. However, this does not prevent us from deducing the reasoning behind such decisions from the <strong>design of the product</strong> itself.</p>
<p>Storage follows a de facto standard: <strong>POSIX file system + block storage</strong>. Whether it&rsquo;s database files, images, audio, or video, they all use the same file system interface to store data on disks. But AWS&rsquo;s &ldquo;divine intervention&rdquo; splits this into two distinct services: <strong>S3</strong> (Simple Storage Service) and <strong>EBS</strong> (Elastic Block Store). Many &ldquo;followers&rdquo; have imitated AWS&rsquo;s product design and pricing model, yet the logic and principles behind such actions remain elusive.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-5.png"></p>
<blockquote>
<p>Aliyun EBS OSS Compare</p>
</blockquote>
<p><strong>S3</strong>, standing for <strong>Simple Storage Service</strong>, is a simplified alternative to file system/storage: sacrificing strong consistency, directory management, and access latency for the sake of low cost and massive scalability. It offers a simple, high-latency, high-throughput flat KV storage service, detached from standard storage services. This aspect, being cost-effective, serves as a major allure for users to migrate to the cloud, thus becoming possibly the only <strong>de facto cloud computing standard across all public cloud providers</strong>.</p>
<p><strong>Databases, on the other hand, require low latency, strong consistency, high quality, high performance, and random read/write block storage</strong>, which is encapsulated in the EBS service: Elastic Block Store. This segment becomes the forbidden fruit for cloud providers: reluctant to let users dabble. <strong>Because EBS serves as the pricing anchor for RDS — the barrier and moat for cloud databases</strong>.</p>
<p>For IaaS providers, who make their living by selling resources, there&rsquo;s not much room for price inflation, as costs can be precisely calculated against the BOM. However, for PaaS services like cloud databases, which include &ldquo;services,&rdquo; labor/development costs are significantly marked up, allowing for <strong>astronomical pricing</strong> and high profits. Despite storage, computing, and networking making up half of the revenue for domestic public cloud IaaS, their gross margin stands only at <strong>15% to 20%</strong>. In contrast, public cloud PaaS, represented by cloud databases, can achieve gross margins of <strong>50%</strong> or higher, vastly outperforming the IaaS model.</p>
<p><strong>If users opt to use IaaS resources (EC2/EBS) to build their own databases, it represents a significant loss of profit for cloud providers. Thus, cloud providers go to great lengths to prevent this scenario. But how is such a product designed to meet this need?</strong></p>
<p>Firstly, <strong>instance storage</strong>, which is best suited for self-hosted databases, must come with various restrictions: instances that are hibernated/stopped are reclaimed and wiped, preventing serious production database services from running on EC2&rsquo;s built-in disks. Although EBS&rsquo;s performance and reliability might slightly lag behind local NVMe SSD storage, it&rsquo;s still viable for database operations, hence the restrictions: but not without giving users an option, hence the <strong>exorbitant pricing</strong>! As compensation, the secondary, cheaper, and massive storage option, S3, can be priced more affordably to lure customers.</p>
<p>Of course, to make customers bite, some cloud computing KOLs promote the accompanying &ldquo;public cloud-native&rdquo; philosophy: &ldquo;EC2 is not suitable for stateful applications. Please store state in S3 or RDS and other managed services, as these are the &lsquo;best practices&rsquo; for using our cloud.&rdquo;</p>
<p><img src="/zh/blog/cloud/ebs/ebs-7.png"></p>
<p>These four points are well summarized, but what public clouds will not disclose is the cost of these &ldquo;best practices.&rdquo; To put <a href="https://github.com/lipingtababa/cloud-native-best-practices/blob/main/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%8E%8B%E5%9B%9B%E6%9D%A1.md">these four points</a> in layman&rsquo;s terms, they form a carefully designed trap for customers:</p>
<p><strong>Dump ordinary files in S3!</strong> (With such cost-effective S3, who needs EBS?)</p>
<p><strong>Don&rsquo;t build your own database!</strong> (Forget about tinkering with open-source alternatives using instance storage)</p>
<p><strong>Please deeply use the vendor&rsquo;s proprietary identity system</strong> (vendor lock-in)</p>
<p><strong>Faithfully contribute to the cloud database!</strong> (Once users are locked in, the time to &ldquo;slaughter&rdquo; arrives)</p>
<hr>
<h2 id="how-to-do-that">HOW to Do that</h2>
<p>The business model of public clouds can be summarized as: <strong>Attract customers with cheap EC2/S3, make a killing with EBS/RDS</strong>.</p>
<p>To slaughter the pig, you first need to raise it. No pains, no gains. Thus, for new users, startups, and small-to-medium enterprises, public clouds spare no effort in offering sweeteners, even at a loss, to drum up business. New users enjoy a significant discount on their first order, startups receive free or half-price credits, and the pricing strategy is subtly crafted.</p>
<p>Taking AWS RDS <a href="https://instances.vantage.sh/">pricing</a> as an example, the unit price for mini models with 1 to 2 cores is only <strong>a few dollars per core per month</strong>, which translates to three to four hundred yuan per year (excluding storage): If you need a low-usage database for minor storage, this might be the most straightforward and affordable choice.</p>
<p><a href="https://instances.vantage.sh/"><img src="/zh/blog/cloud/ebs/ebs-8.png"></a></p>
<p>However, <strong>as soon as you slightly increase the configuration, even by just a little, the price per core per month jumps by orders of magnitude</strong>, reaching twenty to a hundred dollars, with the potential to skyrocket by dozens of times — <strong>and that&rsquo;s before the doubling effect of the astonishing EBS prices</strong>. Users only realize what has happened when they are faced with a suddenly astronomical bill.</p>
<p>For instance, using RDS for PostgreSQL on AWS, the price for a 64C / 256GB db.m5.16xlarge RDS for one month is $25,817, which is equivalent to about 180,000 yuan per month. The monthly rent is enough for you to buy two servers with even better performance and set them up on your own. <strong>The rent-to-buy ratio doesn&rsquo;t even last a month; renting for just over ten days is enough to buy the whole server for yourself</strong>.</p>
<table>
<thead>
<tr>
<th>Payment Model</th>
<th>Price</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted IDC (Single Physical Server)</td>
<td>¥75k / 5 years</td>
<td>1.5</td>
</tr>
<tr>
<td>Self-hosted IDC (2-3 Server HA Cluster)</td>
<td>¥150k / 5 years</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (On-demand)</td>
<td>¥87.36/hour</td>
<td>76.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Monthly)</td>
<td>¥42k / month</td>
<td>50</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Yearly, 15% off)</td>
<td>¥425,095 / year</td>
<td>42.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (3-year, 50% off)</td>
<td>¥750,168 / 3 years</td>
<td>25</td>
</tr>
<tr>
<td>AWS (On-demand)</td>
<td>$25,817 / month</td>
<td>217</td>
</tr>
<tr>
<td>AWS (1-year, no upfront)</td>
<td>$22,827 / month</td>
<td>191.7</td>
</tr>
<tr>
<td>AWS (3-year, full upfront)</td>
<td>$120k + $17.5k/month</td>
<td>175</td>
</tr>
<tr>
<td>AWS China/Ningxia (On-demand)</td>
<td>¥197,489 / month</td>
<td>237</td>
</tr>
<tr>
<td>AWS China/Ningxia (1-year, no upfront)</td>
<td>¥143,176 / month</td>
<td>171</td>
</tr>
<tr>
<td>AWS China/Ningxia (3-year, full upfront)</td>
<td>¥647k + ¥116k/month</td>
<td>160.6</td>
</tr>
</tbody>
</table>
<p>Comparing the costs of self-hosting versus using a cloud database:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted Servers 64C / 384G / 3.2TB NVME SSD 660K IOPS (2-3 servers)</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS PG High-Availability pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3</td>
<td>25 ~ 50</td>
</tr>
<tr>
<td>AWS RDS PG High-Availability db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS</td>
<td>160 ~ 217</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>RDS</strong> pricing compared to self-hosting, see &ldquo;<a href="/blog/cloud/rds/">Is Cloud Database an idiot Tax?</a>&rdquo;</p>
</blockquote>
<p>Any rational business user can see the logic here: **If the purchase of such a service is not for short-term, temporary needs, then it is definitely considered a <strong>major financial misstep</strong>.</p>
<p>This is not just the case with Relational Database Services / RDS, but with all sorts of cloud databases. MongoDB, ClickHouse, Cassandra, if it uses EC2 / EBS, they are all doing the same. Take the popular NoSQL document database MongoDB as an example:</p>
<blockquote>
<p>This kind of pricing could only come from a product manager without a decade-long cerebral thrombosis</p>
</blockquote>
<p><strong>Five years is the typical depreciation period for servers</strong>, and with the maximum discount, a 12-node (64C 512G) configuration is priced at twenty-three million. The minor part of this quote alone could easily cover the five-year hardware maintenance, plus you could afford a team of MongoDB experts to customize and set up as you wish.</p>
<p><strong>Fine dining restaurants charge a 15% service fee on dishes, and users can understand and support this reasonable profit margin</strong>. If cloud databases charge a few tens of percent on top of hardware resources for service fees and elasticity premiums (let&rsquo;s not even start on software costs for cloud services that piggyback on open-source), it can be justified as pricing for productive elements, with the problems solved and services provided being worth the money.</p>
<p>However, charging several hundred or even thousands of percent as a premium falls into the category of <strong>destructive element distribution</strong>: cloud providers bank on the fact that once users are onboard, they have no alternatives, and migration would incur significant costs, so they can confidently proceed with the slaughter! In this sense, the money users pay is not for the service, but rather a compulsory levy of a &ldquo;no-expert tax&rdquo; and &ldquo;protection money&rdquo;.</p>
<hr>
<h2 id="the-forgotten-vision">The Forgotten Vision</h2>
<p>Facing accusations of &ldquo;slaughtering the pig,&rdquo; cloud vendors often defend themselves by saying: &ldquo;Oh, what you&rsquo;re seeing is the list price. Sure, it&rsquo;s said to be a minimum of 50% off, but for major customers, there are no limits to the discounts.&rdquo; As a rule of thumb: <strong>the cost of self-hosting fluctuates around 5% to 10% of the current cloud service list prices</strong>. If such discounts can be maintained long-term, cloud services become more competitive than self-hosting.</p>
<p>Professional and knowledgeable large customers, especially those capable of migrating at any time, can indeed negotiate steep discounts of up to 80% with public clouds, while smaller customers naturally lack bargaining power and are unlikely to secure such deals.</p>
<p>However, <strong>cloud computing should not turn into &lsquo;calculating clouds&rsquo;</strong>: if cloud providers can only offer massive discounts to large enterprises while &ldquo;shearing the sheep&rdquo; and &ldquo;slaughtering the pig&rdquo; when dealing with small and medium-sized customers and developers, they are essentially <strong>robbing the poor to subsidize the rich</strong>. This practice completely contradicts the original intent and vision of cloud computing and is unsustainable in the long run.</p>
<p>When cloud computing first emerged, the focus was on the <strong>cloud hardware / IaaS layer</strong>: computing power, storage, bandwidth. Cloud hardware represents the founding story of cloud vendors: to make computing and storage resources as accessible as utilities, with themselves playing the role of infrastructure providers. This is a compelling vision: public cloud vendors can reduce hardware costs and spread labor costs through economies of scale; ideally, while keeping a profit for themselves, they can offer storage and computing power that is more cost-effective and flexible than IDC prices.</p>
<p>On the other hand, <strong>cloud software (PaaS / SaaS)</strong> follows a fundamentally different business logic: cloud hardware relies on economies of scale to optimize overall efficiency and earn money through resource pooling and overselling, which represents a progress in efficiency. Cloud software, however, relies on sharing expertise and charging service fees for outsourced operations and maintenance. Many services on the public cloud are essentially wrappers around free open-source software, relying on monopolizing expertise and exploiting information asymmetry to charge exorbitant insurance fees, which constitutes a transfer of value.</p>
<p>Unfortunately, for the sake of obfuscation, both cloud software and cloud hardware are branded under the &ldquo;cloud&rdquo; title. Thus, the narrative of cloud computing mixes breaking resource monopolies with establishing expertise monopolies: <strong>it combines the idealistic glow of democratizing computing power across millions of households</strong> with <strong>the greed of monopolizing and unethically profiting from it</strong>.</p>
<p><strong>Public cloud providers that abandon platform neutrality and their original intent of being infrastructure providers, indulging in PaaS / SaaS / and even application layer profiteering, will sink in a bottomless competition.</strong></p>
<hr>
<h2 id="where-to-go">Where to Go</h2>
<p><strong>Monopolistic profits vanish as competition emerges, plunging public cloud providers into a grueling battle.</strong></p>
<p>At the infrastructure level, telecom operators, state-owned clouds, and IDC 1.5/2.0 have entered the fray, offering highly competitive IaaS services. These services include turnkey network and electricity hosting and maintenance, with high-end servers available for either purchase and hosting or direct rental at actual prices, showing no fear in terms of flexibility.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-11.png"></p>
<blockquote>
<p>IDC 2.0&rsquo;s new server rental model: Actual price rental, ownership transfers to the user after a full term</p>
</blockquote>
<p>On the software front, what once were the technical barriers of public clouds, various management software / <strong>PaaS</strong> solutions, have seen excellent open-source alternatives emerge. OpenStack / Kubernetes have replaced EC2, MinIO / Ceph have taken the place of S3, and on RDS, open-source alternatives like <strong>Pigsty</strong> and various K8S Operators have appeared.</p>
<p>The whole &ldquo;cloud-native&rdquo; movement, in essence, is the open-source ecosystem&rsquo;s response to the challenge of public cloud &ldquo;freeloading&rdquo;: <strong>users and developers have created a complete set of local-priority public cloud open-source alternatives to avoid being exploited by public cloud providers</strong>.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-12.png"></p>
<blockquote>
<p>The term &ldquo;CloudNative&rdquo; is aptly named, reflecting different perspectives: public clouds see it as being &ldquo;born on the public cloud,&rdquo; while private clouds think of it as &ldquo;running cloud-like services locally.&rdquo; Ironically, the biggest proponents of Kubernetes are the public clouds themselves, akin to a salesman crafting his own noose.</p>
</blockquote>
<p>In the context of economic downturn, cost reduction and efficiency gains have become the main theme. Massive layoffs in the tech sector, coupled with the future large-scale impact of AI on intellectual industries, will release a large amount of related talent. Additionally, the low-wage advantage in our era will significantly alleviate the scarcity and high cost of building one&rsquo;s own talent pool. Labor costs, in comparison to cloud service costs, offer much more advantage.</p>
<p>Considering these trends, the combination of IDC2.0 and open-source self-building is becoming increasingly competitive: for organizations with a bit of scale and talent reserves, bypassing public clouds as middlemen and directly collaborating with IDCs is clearly a more economical choice.</p>
<p>Staying true to the original mission is essential. Public clouds do an admirable job at the cloud hardware / IaaS level, except for being outrageously expensive, there aren’t many issues, and the offerings are indeed solid. If they could return to their original vision and truly excel as providers of basic infrastructure, akin to utilities, selling resources might not offer high margins, but it would allow them to earn money standing up. Continuing down the path of exploitation, however, will ultimately lead customers to vote with their feet.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-13.png"></p>
<h2 id="references">References</h2>
<p>【1】<a href="https://mp.weixin.qq.com/s/w5XKsXf_NLWnKB6G-sbZaw">撤离 AWS：3年省下27.5亿元</a></p>
<p>【2】<a href="/blog/cloud/rds/">云数据库是不是智商税</a></p>
<p>【3】<a href="/blog/cloud/paradigm/">范式转移：从云到本地优先</a></p>
<p>【4】<a href="https://mp.weixin.qq.com/s/ANFnbDXwuhKI99fgYRZ9ug">腾讯云CDN：从入门到放弃</a></p>
<p>【5】<a href="https://mp.weixin.qq.com/s/WsR-c64OJfkMql7zX7XmDA">炮打 RDS，Pigsty v2.0 发布</a></p>
<p>【6】<a href="https://en.shannon-sys.com/product.html?name=gen_4">Shannon NVMe Gen4 Series</a></p>
<p>【7】<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html">AWS实例存储</a></p>
<p>【8】<a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">AWS io2 gp3 存储性能与定价</a></p>
<p>【9】<a href="https://aws.amazon.com/cn/ebs/sla/">AWS EBS SLA</a></p>
<p>【10】<a href="https://instances.vantage.sh/">AWS EC2 / RDS 报价查询</a></p>
<p>【11】<a href="https://help.aliyun.com/document_detail/63138.html">Aliyun：Host Storage</a></p>
<p>【12】<a href="https://help.aliyun.com/document_detail/25383.html">阿里云：云盘概述</a></p>
<p>【13】<a href="https://help.aliyun.com/document_detail/445806.html">图说块存储与云盘</a></p>
<p>【14】<a href="https://news.futunn.com/post/24656633">从狂飙到集体失速，云计算换挡寻出路</a></p>
<p>【15】<a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA">云计算为啥还没挖沙子赚钱？</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-2f6739426df63d5dd62ead985e471dc9">RDS: The Idiot Tax</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/LefEAXTcBH-KBJNhXNoc7A">WeChat</a></b> |
        
		<time datetime="2023-01-30" class="text-muted">2023-01-30</time>
        
	</div>
	<p>As the season of layoffs hits big tech companies, cost-cutting and efficiency are top of mind. Public cloud databases, often referred to as the &ldquo;slaughterhouse knives&rdquo; of the cloud, are under increasing scrutiny. The question now is: <em>Can their dominance continue?</em></p>
<p>Recently, DHH (David Heinemeier Hansson), co-founder of Basecamp and HEY, published a thought-provoking piece that has sparked a lot of debate. His core message is succinct:</p>
<blockquote>
<p>&ldquo;We spend $500,000 a year on cloud databases (RDS/ES). Do you know how many powerful servers that kind of money could buy?</p>
<p><strong>We’re off the cloud. Goodbye!</strong>&rdquo;</p>
</blockquote>
<p><strong>So, How Many Powerful Servers Could $500,000 Buy?</strong></p>
<p><a href="https://mp.weixin.qq.com/s/YKqH324Qtg0mj6WfSMb66w"><img src="/zh/blog/cloud/rds/featured.jpg"></a></p>
<hr>
<h2 id="absurd-pricing">Absurd Pricing</h2>
<blockquote>
<p>Sharpening the knives for the sheep and pigs</p>
</blockquote>
<p><strong>Let&rsquo;s rephrase the question: how much do servers and RDS (Relational Database Service) cost?</strong></p>
<p>Taking the physical server model we heavily use as an example: Dell R730, 64 cores, 384GB of memory, equipped with a 3.2 TB MLC NVME SSD. A server like this, running a standard production-level PostgreSQL, can handle up to hundreds of thousands of TPS (Transactions Per Second), and read-only queries can reach four to five hundred thousand. How much does it cost? Including electricity, internet, IDC (Internet Data Center) hosting, and maintenance fees, and amortizing the cost over a 5-year depreciation period, the total lifecycle cost is around seventy-five thousand, or fifteen thousand per year. Of course, for production use, high availability is a must, so a typical database cluster would need two to three physical servers, amounting to an annual cost of thirty to forty-five thousand dollars.</p>
<p>This calculation does not include the cost of DBA (Database Administrator) salaries: managing tens of thousands of cores with just two or three people is not that expensive.</p>
<p>If you directly purchase a cloud database of this specification, what would the cost be? Let&rsquo;s look at the pricing from Alibaba Cloud in China. Since the basic version is practically unusable for production (for reference, see: &ldquo;Cloud Database: From Deletion to Desertion&rdquo;), we&rsquo;ll choose the high-availability version, which usually involves two to three instances. Opting for a yearly or monthly subscription, for an exclusive use of a 64-core, 256GB instance with PostgreSQL 15 on x86 in East China 1 availability zone, and adding a 3.2TB ESSD PL3 cloud disk, the annual cost ranges from 250,000 (for a 3-year contract) to 750,000 (on-demand), with storage costs accounting for about a third.</p>
<p><img src="/zh/blog/cloud/rds/rds-1.png"></p>
<p>Let&rsquo;s also consider AWS, the leading public cloud provider. The closest equivalent on AWS is the db.m5.16xlarge, also with 64 cores and 256GB across multiple availability zones. Similarly, we add a 3.2TB io1 SSD disk with up to 80,000 IOPS, and review the global and China-specific pricing from AWS. The overall cost ranges from 1.6 million to 2.17 million yuan per year, with storage costs accounting for about half. The table below summarizes the costs:</p>
<table>
<thead>
<tr>
<th>Payment Model</th>
<th>Price</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted IDC (Single Physical Server)</td>
<td>¥75k / 5 years</td>
<td>1.5</td>
</tr>
<tr>
<td>Self-hosted IDC (2-3 Server HA Cluster)</td>
<td>¥150k / 5 years</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>AWS (On-demand)</td>
<td>$25,817 / month</td>
<td>217</td>
</tr>
<tr>
<td>AWS (1-year, no upfront)</td>
<td>$22,827 / month</td>
<td>191.7</td>
</tr>
<tr>
<td>AWS (3-year, full upfront)</td>
<td>$120k + $17.5k/month</td>
<td>175</td>
</tr>
<tr>
<td>AWS China/Ningxia (On-demand)</td>
<td>¥197,489 / month</td>
<td>237</td>
</tr>
<tr>
<td>AWS China/Ningxia (1-year, no upfront)</td>
<td>¥143,176 / month</td>
<td>171</td>
</tr>
<tr>
<td>AWS China/Ningxia (3-year, full upfront)</td>
<td>¥647k + ¥116k/month</td>
<td>160.6</td>
</tr>
</tbody>
</table>
<p>Comparing the costs of self-hosting versus using a cloud database:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted Servers 64C / 384G / 3.2TB NVME SSD 660K IOPS (2-3 servers)</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS PG High-Availability pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3</td>
<td>25 ~ 50</td>
</tr>
<tr>
<td>AWS RDS PG High-Availability db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS</td>
<td>160 ~ 217</td>
</tr>
</tbody>
</table>
<p>So, the question arises, <strong>if the cost of using a cloud database for one year is enough to buy several or even more than a dozen better-performing servers, what then is the real benefit of using a cloud database?</strong> Of course, large public cloud customers can usually receive business discounts, but even with discounts, the magnitude of the cost difference is hard to ignore.</p>
<p><strong>Is using a cloud database essentially paying a &ldquo;tax&rdquo; for lack of better judgment?</strong></p>
<hr>
<h2 id="comfort-zone">Comfort Zone</h2>
<blockquote>
<p>No Silver Bullet</p>
</blockquote>
<p><strong>Databases are the heart of data-intensive applications</strong>, and since applications follow the lead of databases, choosing the right database requires great care. Evaluating a database involves many dimensions: reliability, security, simplicity, scalability, extensibility, observability, maintainability, cost-effectiveness, and more. What clients truly care about are these attributes, not the fluffy tech hype: decoupling of compute and storage, Serverless, HTAP, cloud-native, hyper-converged&hellip; These must be translated into the language of engineering: <strong>what is sacrificed for what is gained</strong> to be meaningful.</p>
<p>Public cloud proponents like to gild it: cost-saving, flexible elasticity, reliable security, a panacea for enterprise digital transformation, a revolution from horse-drawn carriage to automobile, good, fast, and cheap, and so on. Unfortunately, few of these claims are realistic. Cutting through the fluff, the only real advantage of cloud databases over professional database services is <strong>elasticity</strong>, specifically in two aspects: <strong>low startup costs and strong scalability</strong>.</p>
<p><strong>Low startup costs</strong> mean that users don&rsquo;t need to build data centers, hire and train personnel, or purchase servers to get started; <strong>strong scalability</strong> refers to the ease of upgrading or downgrading configurations and scaling capacity. Thus, the core scenarios where public cloud truly fits are these two:</p>
<ol>
<li><strong>Initial stages, simple applications with minimal traffic</strong></li>
<li><strong>Workloads with no predictable pattern, experiencing drastic fluctuations</strong></li>
</ol>
<p>The former mainly includes simple websites, personal blogs, small apps and tools, demos/PoC, and the latter includes low-frequency data analysis/model training, sudden spike sales or ticket grabs, celebrity concurrent affairs, and other special scenarios.</p>
<p><strong>The business model of the public cloud is essentially renting</strong>: renting servers, bandwidth, storage, experts. It&rsquo;s fundamentally no different from renting houses, cars, or power banks. Of course, renting servers and outsourcing operations doesn&rsquo;t sound very appealing, hence the term &ldquo;cloud&rdquo; sounds more like a cyber landlord. The characteristic of the renting model is its elasticity.</p>
<p><strong>The renting model has its benefits</strong>, for example, shared power banks can meet the temporary, small-scale charging needs when out and about. However, for many people who travel daily between home and work, using shared power banks to charge phones and computers every day is undoubtedly absurd, especially when renting a power bank for an hour costs about the same as buying one outright after just a few hours. Renting a car can perfectly meet temporary, emergency, or one-off transportation needs: traveling or hauling goods on short notice. But if your travel needs are frequent and local, purchasing an autonomous car might be the most convenient and cost-effective choice.</p>
<p><strong>The key issue is the rent-to-own ratio</strong>, with houses taking decades, cars a few years, but public cloud servers usually only a few months. If your business can sustain for more than a few months, why rent instead of buying outright?</p>
<p>Thus, the money cloud vendors make comes either from VC-funded tech startups seeking explosive growth, from entities in gray areas where the rent-seeking space exceeds the cloud premium, from the foolishly wealthy, or from a mishmash of webmasters, students, VPN individual users. Smart, high-net-worth enterprise customers, who could enjoy a comfortable, affordable big house, why would they choose to squeeze into rental cube apartments?</p>
<p><strong>If your business fits within the suitable spectrum for the public cloud, that&rsquo;s fantastic; but paying several times or even more than a tenfold premium for unnecessary flexibility and elasticity is purely a tax on lack of intelligence</strong>.</p>
<hr>
<h2 id="the-cost-assassin">The Cost Assassin</h2>
<blockquote>
<p>Profit margins lie in information asymmetry, but you can&rsquo;t fool everyone forever.</p>
</blockquote>
<p>The elasticity of public clouds is designed for their business model: <strong>low startup costs, high maintenance costs</strong>. Low startup costs lure users to the cloud, and the excellent elasticity adapts to business growth at any time. However, once the business stabilizes, vendor lock-in occurs, making it difficult to switch providers, and the high maintenance costs become unbearable for users. This model is colloquially known as the <strong>pig slaughtering scam</strong>.</p>
<p><img src="/zh/blog/cloud/rds/rds-2.gif"></p>
<p>In the first stop of my career, I had such a pig slaughtering experience that remains vivid in my memory. As one of the first internal BUs forced onto A Cloud, A Cloud directly sent engineers to handhold us through the cloud migration process. We replaced our self-built big data/database suite with ODPS. The service was indeed decent, but the annual cost of storage and computing soared from tens of millions to nearly a hundred million, almost transferring all profits to A Cloud, making it the ultimate cost assassin.</p>
<p><img src="/zh/blog/cloud/rds/rds-3.jpeg"></p>
<p>At my next stop, the situation was entirely different. We managed a PostgreSQL and Redis database cluster with 25,000 cores and 4.5 million QPS. For databases of this size, if charged by AWS RCU/WCU, the cost would be billions annually; even with a long-term, yearly subscription and a substantial business discount, it would still cost at least fifty to sixty million. Yet, we had only two or three DBAs and a few hundred servers, with a total annual cost of manpower and assets of less than ten million.</p>
<p><img src="/zh/blog/cloud/rds/rds-31.png"></p>
<p>Here, we can calculate the unit cost in a simple way: the comprehensive cost of using one core (including memory/disk) for a month, termed as <strong>core·month</strong>. We have calculated the costs of self-built server types and compared them with the quotes from cloud providers, with the following rough results:</p>
<table>
<thead>
<tr>
<th style="text-align:center">硬件算力</th>
<th style="text-align:center">单价</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">IDC自建机房(独占物理机 A1: 64C384G)</td>
<td style="text-align:center">19</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房(独占物理机 B1: 40C64G)</td>
<td style="text-align:center">26</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房(独占物理机 C2: 8C16G)</td>
<td style="text-align:center">38</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房(容器，超卖200%)</td>
<td style="text-align:center">17</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房(容器，超卖500%)</td>
<td style="text-align:center">7</td>
</tr>
<tr>
<td style="text-align:center">UCloud 弹性虚拟机(8C16G，有超卖)</td>
<td style="text-align:center">25</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 2x内存(独占无超卖)</td>
<td style="text-align:center">107</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 4x内存(独占无超卖)</td>
<td style="text-align:center">138</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 8x内存(独占无超卖)</td>
<td style="text-align:center">180</td>
</tr>
<tr>
<td style="text-align:center">AWS C5D.METAL 96C 200G (按月无预付)</td>
<td style="text-align:center">100</td>
</tr>
<tr>
<td style="text-align:center">AWS C5D.METAL 96C 200G(预付3年)</td>
<td style="text-align:center">80</td>
</tr>
<tr>
<td style="text-align:center"><strong>数据库</strong></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">AWS RDS PostgreSQL db.T2 (4x)</td>
<td style="text-align:center">440</td>
</tr>
<tr>
<td style="text-align:center">AWS RDS PostgreSQL db.M5 (4x)</td>
<td style="text-align:center">611</td>
</tr>
<tr>
<td style="text-align:center">AWS RDS PostgreSQL db.R6G (8x)</td>
<td style="text-align:center">786</td>
</tr>
<tr>
<td style="text-align:center">AWS RDS PostgreSQL db.M5 24xlarge</td>
<td style="text-align:center">1328</td>
</tr>
<tr>
<td style="text-align:center">阿里云 RDS PG 2x内存(独占)</td>
<td style="text-align:center">260</td>
</tr>
<tr>
<td style="text-align:center">阿里云 RDS PG 4x内存(独占)</td>
<td style="text-align:center">320</td>
</tr>
<tr>
<td style="text-align:center">阿里云 RDS PG 8x内存(独占)</td>
<td style="text-align:center">410</td>
</tr>
<tr>
<td style="text-align:center">ORACLE数据库授权</td>
<td style="text-align:center">10000</td>
</tr>
</tbody>
</table>
<p>So, the question arises, why can server hardware priced at twenty units be sold for hundreds, and why does installing cloud database software on it multiply the price? <strong>Is it because the operations are made of gold, or is the server made of gold?</strong></p>
<p>A common response is: <em><strong>Databases are the crown jewels of foundational software, embodying countless intangible intellectual properties BlahBlah</strong></em>. Thus, it&rsquo;s reasonable for the software to be priced much higher than the hardware. This reasoning might be acceptable for top-tier commercial databases like Oracle, or console games from Sony and Nintendo.</p>
<p>But for cloud databases (RDS for PostgreSQL/MySQL/&hellip;) on public clouds, which are essentially rebranded and modified open-source database kernels with added control software and shared DBA services, this markup is absurd: the database kernel is free. <strong>Is your control software made of gold, or are your DBAs made of gold?</strong></p>
<p>The secret of public clouds lies here: <strong>they acquire customers with &lsquo;cheap&rsquo; S3 and EC2, then &ldquo;slaughter the pig&rdquo; with RDS</strong>.</p>
<p>Although nearly half of the revenue of domestic public cloud IaaS (storage, computing, network) comes with only a 15% to 20% gross margin, the revenue from public cloud PaaS may be lower, but its gross margin can reach 50%, utterly outperforming the resource-selling IaaS. <strong>And the most representative of PaaS services is the cloud database</strong>.</p>
<p>Normally, if you&rsquo;re not using public cloud as just an IDC 2.0 or CDN provider, the most expensive service would be the database. Are the storage, computing, and networking resources on the public cloud expensive? Strictly speaking, not outrageously so. The cost of hosting and maintaining a physical machine in an IDC is about twenty to thirty units per core·month, while the price of using one CPU core for a month on the public cloud ranges from seventy to two hundred units, considering various discounts and activities, as well as the premium for elasticity, it&rsquo;s barely within an acceptable range.</p>
<p>However, cloud databases are outrageously expensive, with the price for the same computing power per month being several times to over ten times higher than the corresponding hardware. For the cheaper Alibaba Cloud, the price per core·month ranges from two hundred to four hundred units, and for the more expensive AWS, it can reach seven to eight hundred or even more than a thousand.</p>
<p>If you&rsquo;re only using one or two cores of RDS, then it might not be worth the hassle to switch, just consider it a tax. But if your business scales up and you&rsquo;re still not moving away from the cloud, then you&rsquo;re really paying a tax on intelligence.</p>
<hr>
<h2 id="good-enough">Good Enough?</h2>
<blockquote>
<p>Make no mistake, RDS are just mediocre solutions.</p>
</blockquote>
<p>When it comes to the cost of cloud databases/cloud servers, if you manage to bring this up with a sales representative, their pitch usually shifts to: Yes, we are expensive, but we are good!</p>
<p><strong>But, is RDS really that good?</strong></p>
<p>It could be argued that for toy applications, small websites, personal hosting, and self-built databases by those without technical knowledge, RDS might be good enough. However, from the perspective of high-value clients and database experts, RDS is seen as nothing more than a barely passable, communal pot meal.</p>
<p>At its core, the public cloud stems from the operational capabilities that overflowed from major tech companies. People within these companies are well aware of their own technological capabilities, so there’s no need for any undue idolization. (Google might be an exception).</p>
<p><img src="/zh/blog/cloud/rds/rds-4.png"></p>
<p>Take <strong>performance</strong> as an example, where the core metric is <strong>latency/response time</strong>, especially tail latency, which directly impacts user experience: nobody wants to wait several seconds for a screen swipe to register. Here, <strong>disks</strong> play a crucial role.</p>
<p>In our production environment, we use local NVME SSDs, with a typical 4K write latency of 15µs and read latency of 94µs. Consequently, the response time for a simple query on PostgreSQL is usually between 100 ~ 300µs, and the response time on the application side typically ranges from 200 ~ 600µs; for simple queries, our SLO is to achieve within 1ms for hits, and within 10ms for misses, with anything over 10ms considered a slow query that needs optimization.</p>
<p><img src="/zh/blog/cloud/rds/rds-41.png"></p>
<p>AWS&rsquo;s EBS service, when tested with fio, shows disastrously poor performance【6】, with default gp3 read/write latencies at 40ms and io1 at 10ms, a difference of nearly three orders of magnitude. Moreover, the maximum IOPS is only eighty thousand. RDS uses EBS for storage, and if even a single disk access takes 10ms, it’s just not workable. io2 does use the same kind of NVMe SSDs as we do, but remote block storage has double the latency compared to local disks.</p>
<p><img src="/zh/blog/cloud/rds/rds-5.png"></p>
<p>Indeed, sometimes cloud providers do offer sufficiently good local NVMe SSDs, but they cunningly impose various restrictions to prevent users from using EC2 to build their own databases. AWS restricts this by offering NVMe SSD Ephemeral Storage, which is wiped clean upon EC2 restart, rendering it unusable. Alibaba Cloud, on the other hand, sells at exorbitant prices, with <strong>Alibaba Cloud&rsquo;s ESSD PL3 being 200 times more expensive</strong> compared to direct hardware purchases. For a reference, a 3.2TB enterprise-grade PCI-E SSD card, AWS’s rental ratio is one month, while Alibaba Cloud’s is nine days, meaning the cost of renting for this period is equivalent to purchasing the entire disk. If purchasing on Alibaba Cloud with a three-year maximum discount at 50% off, the cost of three years of rent could buy 123 of the same disks, nearly 400TB in total ownership.</p>
<p><strong>Observability is another example where no RDS monitoring can be considered &ldquo;good&rdquo;</strong>. Just looking at the number of monitoring metrics, while knowing whether a service is dead or alive may require only a few metrics, fault root cause analysis benefits from as many monitoring metrics as possible to build a good context. Most RDS services only provide basic monitoring metrics and rudimentary dashboards. For example, Alibaba Cloud RDS PG【7】&rsquo;s so-called &ldquo;enhanced monitoring&rdquo; includes only a few pitiful metrics. AWS and PG database-related metrics are also less than 100, while our own monitoring system includes over 800 types of host metrics, 610 types for PGSQL database, 257 types for REDIS, totaling around three thousand metrics, dwarfing those of RDS.</p>
<p><img src="/zh/blog/cloud/rds/rds-6.png"></p>
<p><img src="/img/pigsty/dashboard.jpg"></p>
<blockquote>
<p>Public <a href="https://demo.pigsty.cc">Demo</a>: <a href="https://demo.pigsty.cc">https://demo.pigsty.cc</a></p>
</blockquote>
<p>As for <strong>reliability</strong>, I used to have basic trust in the reliability of RDS, until the scandal in A Cloud&rsquo;s Hong Kong data center a month ago. The rented data center had a fire suppression incident with water spraying, OSS malfunction, and numerous RDS services became unusable and could not be switched over; then, A Cloud&rsquo;s entire Region&rsquo;s control services crashed due to a single AZ failure, <strong>making a mockery of the idea of remote disaster recovery for cloud databases</strong>.</p>
<p>Of course, this is not to say that self-hosting would not have these issues, but a somewhat reliable IDC hosting would not commit such egregious errors. Security needs no further discussion; recent high-profile incidents, such as the infamous SHGA; hardcoding AK/SK in a bunch of sample codes, is cloud RDS more secure? Don’t make me laugh. At least traditional architecture has a VPN bastion as a layer of protection, while databases exposed on the public network with weak passwords are all too common, undeniably increasing the attack surface.</p>
<p><strong>Another widespread criticism of cloud databases is their extensibility</strong>. RDS does not grant users dbsu permissions, meaning users cannot install extension plugins in the database. PostgreSQL&rsquo;s charm lies in its extensions; without extensions, PostgreSQL is like cola without ice, yogurt without sugar. A more severe issue is that <strong>in some failure scenarios, users even lose the ability to help themselves</strong>, as seen in the real case of &ldquo;<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485093&idx=1&sn=5815f71f1d832101d35a75f5aa4acd3c&chksm=fe4b337ec93cba68fbf30eb0ed50d052c6e8972d42cf506051b5016668f4555edaa0756688dc&scene=21#wechat_redirect">Cloud Database: From Deleting Databases to Running Away</a>&rdquo;: WAL archiving and PITR, basic functionalities, are charged features in RDS. Regarding maintainability, some say cloud databases are convenient as they can be created and destroyed with just a few clicks, but those people have likely never experienced the ordeal of receiving SMS verification codes for restarting each database. <strong>With Database as Code style management tools, true engineers would never resort to such &ldquo;ClickOps&rdquo;</strong>.</p>
<p>However, everything has its rationale for existence, and cloud databases are not entirely without merit. In terms of <strong>scalability</strong>, cloud databases have indeed reached new heights, such as various Serverless offerings, but this is more about saving money and overselling for cloud providers, offering little real benefit to users.</p>
<hr>
<h2 id="the-obsolescence-of-dbas">The Obsolescence of DBAs?</h2>
<blockquote>
<p>Dominated by cloud vendors, hard to hire, and now obsolete?</p>
</blockquote>
<p><strong>Another pitch from cloud databases is that with RDS, you don&rsquo;t need a DBA anymore!</strong></p>
<p>For instance, this infamous article, <a href="https://mp.weixin.qq.com/s/DtRFnh8LgtfesCNMNl3eNw">&ldquo;Why Are You Still Hiring DBAs?&rdquo;</a>, argues: We have autonomous database services! RDS and DAS can solve these database-related issues for you, making DBAs redundant, haha. I believe anyone who seriously reviews these so-called &ldquo;autonomous services&rdquo; or &ldquo;AI4DB&rdquo; official documents will not buy into this nonsense: <strong>Can a module, hardly a decent monitoring system, truly autonomize database management? This is simply a pipe dream.</strong></p>
<p>DBA, Database Administrator, historically also known as database coordinators or database programmers, is a role that spans across development and operations teams, covering responsibilities related to DA, SA, Dev, Ops, and SRE. They manage everything related to data and databases: setting management policies and operational standards, planning hardware and software architecture, coordinating database management, verifying table schema designs, optimizing SQL queries, analyzing execution plans, and even handling emergencies and data recovery.</p>
<p><strong>The first value of a DBA is in security fallback</strong>: <strong>They are the guardians of a company&rsquo;s core data assets and can potentially inflict fatal damage on the company</strong>. There&rsquo;s a joke at Ant Financial that besides regulatory bodies, DBAs could bring Alipay down. Executives often fail to recognize the importance of DBAs until a database incident occurs, and a group of CXOs anxiously watches the DBA firefighting and fixing&hellip; Compared to the cost of avoiding a database failure, such as a nationwide flight halt, Youtube downtime, or a factory&rsquo;s day-long shutdown, hiring a DBA seems trivial.</p>
<p><strong>The second value of a DBA is in model design and optimization</strong>. Many companies do not care if their queries perform poorly, thinking &ldquo;hardware is cheap,&rdquo; and solve problems by throwing money at hardware. However, improperly tuned queries/SQL or poorly designed data models and table structures can degrade performance by orders of magnitude. At some scale, the cost of stacking hardware becomes prohibitively expensive compared to hiring a competent DBA. Frankly, <strong>I believe the largest IT expenditure in most companies is due to developers not using databases correctly</strong>.</p>
<p><strong>A DBA&rsquo;s basic skill is managing DBs, but their essence lies in Administration</strong>: managing the entropy created by developers requires more than just technical skills. &ldquo;Autonomous databases&rdquo; might help analyze loads and create indexes, but they cannot understand business needs or push for table structure optimization, and this is something unlikely to be replaced by cloud services in the next two to three decades.</p>
<p>Whether it&rsquo;s public cloud vendors, cloud-native/private clouds represented by Kubernetes, or local open-source RDS alternatives like Pigsty, <strong>their core value is to use software as much as possible, not manpower, to deal with system complexity</strong>. So, <strong>will cloud software revolutionize operations and DBA roles</strong>?</p>
<p><strong>Cloud is not a maintenance-free outsourcing magic</strong>. According to the law of complexity conservation, the only way for the roles of system administrators or database administrators to disappear is for them to be rebranded as &ldquo;DevOps Engineers&rdquo; or SREs. <strong>Good cloud software can shield you from mundane operational tasks and solve 70% of routine issues, but there will always be complex problems that only humans can handle</strong>. You might need fewer people to manage these cloud services, but you still need people【12】. After all, <strong>you need knowledgeable individuals to coordinate and manage, so you don&rsquo;t get exploited by cloud vendors</strong>.</p>
<p><strong>In large organizations, a good DBA is crucial</strong>. However, excellent DBAs are quite rare and in high demand, leading to this role being outsourced in most organizations: either to professional database service companies or to cloud database RDS service teams. Organizations unable to find DBA providers must internally assign this responsibility to their development/operations staff, until the company grows large enough or suffers enough setbacks for some Dev/Ops to develop the necessary skills.</p>
<p><strong>DBAs won&rsquo;t become obsolete; they will just be monopolized by cloud vendors to provide services.</strong></p>
<hr>
<h2 id="the-shadow-of-monopoly">The Shadow of Monopoly</h2>
<blockquote>
<p>In 2020, the adversary of computing freedom was cloud computing software.</p>
</blockquote>
<p><strong>Beyond the &ldquo;obsolescence of DBAs,&rdquo; the emergence of the cloud harbors a larger threat</strong>. We should be concerned about a scenario where public clouds (or &ldquo;Fruit Clouds&rdquo;) grow dominant, controlling both hardware and operators up and down the stream, monopolizing computation, storage, networking, and top-tier expert resources to become the de facto standards. If all top-tier DBAs are poached by cloud vendors to provide centralized shared expert services, ordinary business organizations will completely lose the capability to utilize databases effectively, eventually left with no choice but to be &ldquo;taxed&rdquo; by public clouds. Ultimately, all IT resources would be concentrated in the hands of cloud vendors, who, by controlling a critical few, could control the entire internet. This is undeniably contrary to the original intent behind the creation of the internet.</p>
<p>Let me reference Martin Kelppmann:</p>
<p><strong>In the 2020s, the enemy of freedom in computing is cloud software</strong></p>
<blockquote>
<p>i.e. software that runs primarily on the vendor’s servers, with all your data also stored on those servers. This cloud software may have a client-side component (a mobile app, or the JavaScript running in your web browser), but it only works in conjunction with the vendor’s server. And there are lots of problems with cloud software:</p>
<ul>
<li>If the company providing the cloud software goes out of business or decides to discontinue a product, the software stops working, and you are locked out of the documents and data you created with that software. This is an especially common problem with software made by a startup, which may get acquired by a bigger company that has no interest in continuing to maintain the startup’s product.</li>
<li>Google and other cloud services may suddenly suspend your account with no warning and no recourse, for example if an automated system thinks you have violated its terms of service. Even if your own behaviour has been faultless, someone else may have hacked into your account and used it to send malware or phishing emails without your knowledge, triggering a terms of service violation. Thus, you could suddenly find yourself permanently locked out of every document you ever created on Google Docs or another app.</li>
<li>With software that runs on your own computer, even if the software vendor goes bust, you can continue running it forever (in a VM/emulator if it’s no longer compatible with your OS, and assuming it doesn’t need to contact a server to check for a license check). For example, the Internet Archive has a collection of over 100,000 historical software titles that you can run in an emulator inside your web browser! In contrast, if cloud software gets shut down, there is no way for you to preserve it, because you never had a copy of the server-side software, neither as source code nor in compiled form.</li>
<li>The 1990s problem of not being able to customise or extend software you use is aggravated further in cloud software. With closed-source software that runs on your own computer, at least someone could reverse-engineer the file format it uses to store its data, so that you could load it into alternative software (think pre-OOXML Microsoft Office file formats, or Photoshop files before the spec was published). With cloud software, not even that is possible, since the data is only stored in the cloud, not in files on your own computer.</li>
</ul>
<p>If all software was free and open source, these problems would all be solved. However, making the source code available is not actually necessary to solve the problems with cloud software; even closed-source software avoids the aforementioned problems, as long as it is running on your own computer rather than the vendor’s cloud server. Note that the Internet Archive is able to keep historical software working without ever having its source code: for purposes of preservation, running the compiled machine code in an emulator is just fine. Maybe having the source code would make it a little easier, but it’s not crucial. The important thing is having a copy of the software at all.</p>
<p>My collaborators and I have previously argued for <strong>local-first software</strong>, which is a response to these problems with cloud software. Local-first software runs on your own computer, and stores its data on your local hard drive, while also retaining the convenience of cloud software, such as real-time collaboration and syncing your data across all of your devices. It is nice for local-first software to also be open source, but this is not necessary: 90% of its benefits apply equally to closed-source local-first software.</p>
<p>Cloud software, not closed-source software, is the real threat to software freedom, because the harm from being suddenly locked out of all of your data at the whim of a cloud provider is much greater than the harm from not being able to view and modify the source code of your software. For that reason, it is much more important and pressing that we make local-first software ubiquitous. If, in that process, we can also make more software open-source, then that would be nice, but that is less critical. Focus on the biggest and most urgent challenges first.</p>
</blockquote>
<p>However, where there is action, there is reaction; local-first software began to emerge as a countermeasure to cloud software. For instance, the Cloud Native movement, represented by Kubernetes, is a prime example. &ldquo;Cloud Native,&rdquo; as interpreted by cloud vendors, means &ldquo;software that is natively developed in a public cloud environment&rdquo;; but its real significance should be &ldquo;local,&rdquo; as in the opposite of &ldquo;Cloud&rdquo; — &ldquo;Local&rdquo; cloud / private cloud / proprietary cloud / native cloud, the name doesn&rsquo;t matter. What matters is that it can run anywhere the user desires (including on cloud servers), not just exclusively in public clouds!</p>
<p>Open-source projects, like Kubernetes, have democratized resource scheduling/smart operations capabilities previously unique to public clouds, enabling enterprises to run &lsquo;cloud&rsquo;-like capabilities locally. For stateless applications, it already serves as a sufficiently robust &ldquo;cloud operating system&rdquo; kernel. Open-source alternatives like Ceph/Minio offer S3 object storage solutions, leaving only one question unanswered: how to manage and deploy stateful, production-grade database services?</p>
<p>The era is calling for an open-source alternative to RDS.</p>
<hr>
<h2 id="answer--solution">Answer &amp; Solution</h2>
<blockquote>
<p>Pigsty —— Battery-Included, Local-First <strong>PostgreSQL</strong> Distribution as an Open-Source <strong>RDS</strong> Alternative</p>
</blockquote>
<p>I envision a future where everyone has the factual right to freely use superior services, not confined within the pens (Pigsty) provided by a few public cloud vendors, feeding on subpar offerings. This is why I created Pigsty — <strong>a better, open-source, free alternative to PostgreSQL RDS</strong>. It enables users to launch a database service better than cloud RDS with just one click, anywhere (including on cloud servers).</p>
<p>Pigsty is a comprehensive complement to PostgreSQL, <strong>and a spicy critique of cloud databases</strong>. Its name signifies &ldquo;pigpen,&rdquo; but it also stands for Postgres In Great STYle, symbolizing PostgreSQL at its peak. It is a solution distilled from best practices in managing and using PostgreSQL, entirely based on open source software and capable of running anywhere. Born from real-world, high-standard PostgreSQL clusters, it was developed to fulfill the database management needs of Tantan, performing valuable work across eight dimensions:</p>
<p><img src="/zh/blog/cloud/rds/rds-7.png"></p>
<p><strong>Observability is akin to heaven; as heaven maintains vigor through movement, a gentleman should constantly strive for self-improvement</strong>; Pigsty utilizes a modern observability tech stack to create an unparalleled monitoring system for PostgreSQL, offering a comprehensive overview from global dashboards to granular historical metrics for individual tables/indexes/functions, enabling users to see through the system and control everything. Additionally, Pigsty&rsquo;s monitoring system can operate independently to monitor third-party database instances.</p>
<p><strong>Controllability is akin to earth; as earth&rsquo;s nature is broad and bearing, a gentleman should carry the world with broad virtue</strong>; Pigsty provides Database as Code capabilities: describing the state of database clusters through expressive declarative interfaces and employing idempotent scripts for deployment and adjustments. This allows users to customize finely without worrying about implementation details, freeing their mental capacity and lowering the barrier from expert to novice level in database operations and management.</p>
<p><strong>Scalability is like water; as water flows and encompasses all, a gentleman should maintain virtue consistently</strong>; Pigsty offers pre-configured tuning templates (OLTP / OLAP / CRIT / TINY), automatically optimizes system parameters, and can infinitely scale read capabilities through cascading replication. It also utilizes Pgbouncer for connection pool optimization to handle massive concurrent connections; Pigsty ensures PostgreSQL&rsquo;s performance is maximized under modern hardware conditions: achieving tens of thousands of concurrent connections, million-level single-point query QPS, and hundred thousand-level single transaction TPS.</p>
<p><strong>Maintainability is like fire; as fire illuminates, a great person should illuminate the surroundings</strong>; Pigsty allows for online instance addition or removal for scaling, Switchover/rolling upgrades for scaling up or down, and offers a downtime-free migration solution based on logical replication, minimizing maintenance windows to sub-second levels, thus enhancing the system&rsquo;s evolvability, availability, and maintainability to a new standard.</p>
<p><strong>Security is like thunder; as thunder signifies awe, a gentleman should reflect and be cautious</strong>; Pigsty offers an access control model following the principle of least privilege, along with various security features: synchronous commit for replication to prevent data loss, data directory checksums to prevent corruption, SSL encryption for network traffic to prevent eavesdropping, and AES-256 for remote backups to prevent data leaks. As long as physical hardware and passwords are secure, users need not worry about database security.</p>
<p><strong>Simplicity is like wind; as wind follows its path, a gentleman should decree and act accordingly</strong>; Using Pigsty is no more difficult than any cloud database. It aims to deliver complete RDS functionality with the least complexity, allowing users to choose and combine modules as needed. Pigsty offers a Vagrant-based local development testing sandbox and Terraform cloud IaC for one-click deployment templates, enabling offline installation on any new EL node and complete environment replication.</p>
<p><strong>Reliability is like a mountain; as a mountain stands firm, a gentleman should be steadfast in thought</strong>; Pigsty provides a high-availability architecture with self-healing capabilities to address hardware issues and offers out-of-the-box PITR for recovery from accidental data deletion and software flaws, verified through long-term, large-scale production environment operation and high-availability drills.</p>
<p><strong>Extensibility is like a lake; as a lake reflects beauty, a gentleman should discuss and practice with friends</strong>; Pigsty deeply integrates core PostgreSQL ecosystem extensions like PostGIS, TimescaleDB, Citus, PGVector, and numerous extension plugins. It offers a modular design of the Prometheus/Grafana observability tech stack, and high-availability deployment of MINIO, ETCD, Redis, Greenplum, etc., in combination with PostgreSQL.</p>
<p><img src="/zh/blog/cloud/rds/rds-8.png"></p>
<p><strong>More importantly, Pigsty is entirely open-source and free software</strong>, licensed under AGPL v3.0. Powered by passion, you can run a fully functional, even superior RDS service at the cost of mere hardware expenses per month. Whether you are a beginner or a seasoned DBA, managing a massive cluster or a small setup, whether you&rsquo;re already using RDS or have set up databases locally, if you are a PostgreSQL user, Pigsty will be beneficial to you, completely free. <strong>You can focus on the most interesting or valuable parts of your business and leave the routine tasks to the software</strong>.</p>
<p><img src="/zh/blog/cloud/rds/rds-9.png"></p>
<blockquote>
<p>RDS Cost and Scale Cost Curve</p>
</blockquote>
<p>Pigsty allows you to practice the ultimate FinOps principle — running production-level PostgreSQL RDS database services anywhere (ECS, resource cloud, data center servers, even local notebook virtual machines) at prices close to pure resource costs. <strong>Turning the cost capability of cloud databases from being proportional to marginal resource costs to virtually zero fixed learning costs</strong>.</p>
<p><strong>If you can use a better RDS service at a fraction of the cost, then continuing to use cloud databases is truly just a tax on your intellect.</strong></p>
<hr>
<h2 id="reference">Reference</h2>
<p>【1】<a href="https://world.hey.com/dhh/why-we-re-leaving-the-cloud-654b47e0">Why we&rsquo;re leaving the cloud</a></p>
<p>【2】<a href="https://www.infoq.cn/article/qoq3v6jfenwwzmpg4fre">上云“被坑”十年终放弃，寒冬里第一轮“下云潮”要来了？</a></p>
<p>【3】<a href="https://rdsbuy.console.aliyun.com/create/rds/PostgreSQL">Aliyun RDS for PostgreSQL Pricing</a></p>
<p>【4】<a href="https://calculator.aws/#/addService/RDSPostgreSQL">AWS Pricing Calculator</a></p>
<p>【5】 <a href="https://calculator.amazonaws.cn/#/?trk=pricing-ban">AWS Pricing Calculator</a> (China NingXia)</p>

</div>





    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Mail" aria-label="Mail">
    <a target="_blank" rel="noopener" href="mailto:rh@vonng.com" aria-label="Mail">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/Vonng/pigsty" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/GobeUncleWang" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="WeChat" aria-label="WeChat">
    <a target="_blank" rel="noopener" href="/img/pigsty/pigsty-cc.jpg" aria-label="WeChat">
      <i class="fa fa-comment"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Discord" aria-label="Discord">
    <a target="_blank" rel="noopener" href="https://discord.gg/wDzt5VyWEz" aria-label="Discord">
      <i class="fab fa-discord"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Telegram" aria-label="Telegram">
    <a target="_blank" rel="noopener" href="https://t.me/joinchat/gV9zfZraNPM3YjFh" aria-label="Telegram">
      <i class="fab fa-telegram"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2018&ndash;2025
    <span class="td-footer__authors">Ruohang Feng</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span></span><span class="ms-2"><a href="https://vonng.com/en/" target="_blank" rel="noopener">@Vonng</a></span>
<br><span>Pigsty® distributed under <a href="/docs/about/license" target="_blank" rel="noopener">AGPLv3</a></span>
<br><span class="ms-2"><a href="/docs/about/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
<span><a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">浙ICP备15016890号</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.248655eb216150e39da254c2f7aa5357805d0ec66bdb741b591cd35fb5f629ab.js" integrity="sha256-JIZV6yFhUOOdolTC96pTV4BdDsZr23QbWRzTX7X2Kas=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
