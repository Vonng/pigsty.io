<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="/blog/">
<link rel="alternate" type="application/rss&#43;xml" href="/blog/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Pigsty Blog | Pigsty</title>
<meta name="description" content="Posts about Pigsty &amp; PostgreSQL, Notes about PostgreSQL development, administration and internal architecture.">
<meta property="og:title" content="Pigsty Blog" />
<meta property="og:description" content="Posts about Pigsty &amp; PostgreSQL, Notes about PostgreSQL development, administration and internal architecture." />
<meta property="og:type" content="website" />
<meta property="og:url" content="/blog/" />

<meta itemprop="name" content="Pigsty Blog">
<meta itemprop="description" content="Posts about Pigsty &amp; PostgreSQL, Notes about PostgreSQL development, administration and internal architecture."><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Pigsty Blog"/>
<meta name="twitter:description" content="Posts about Pigsty &amp; PostgreSQL, Notes about PostgreSQL development, administration and internal architecture."/>




<link rel="preload" href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" as="style">
<link href="/scss/main.min.194607c777ee31a481a26dfc3d1c65134dfc8eb296a0aae9d353b3bd5be6a683.css" rel="stylesheet" integrity="">

<script
  src="/js/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="/js/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-LG1V9WTKGE');
}
</script>
  </head>
  <body class="td-section td-blog">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class="navbar-brand__name">Pigsty</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/docs/"><i class='fa-solid fa-book'></i><span>Docs</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/blog/"><i class="fas fa-blog"></i><span>Blog</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/Vonng/pigsty/" target="_blank" rel="noopener"><i class='fab fa-github'></i><span>GitHub</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <i class="fa-solid fa-language"></i>English</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/zh/blog/">中文</a></li>
    </ul>
</div>
</li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.59065b2135623635057c633958cbfacb.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5 pe-md-4" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/blog/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Pigsty Blog</h1>
<div class="lead">Posts about Pigsty &amp; PostgreSQL, Notes about PostgreSQL development, administration and internal architecture.</div>




    <ul>
    
  
  
  
  

  
    
    
	

    <li><a href="#pg-d4c403d8393b56a8f4e75a36c552935f">Database</a></li>



    
    <ul>
        
  
  
  
  

  
    
    
	

    <li><a href="#pg-334087cf09542980cb6fca786dec3146">Self-Hosting Supabase on PostgreSQL</a></li>



    
  
    
    
	

    <li><a href="#pg-3085215d905f9975fefe74e9dc129cba">Database in K8S: Pros &amp; Cons</a></li>



    
  
    
    
	

    <li><a href="#pg-564f2bc59ef0064fb9b5b78f3ee282ef">NewSQL: Distributive Nonsens</a></li>



    
  
    
    
	

    <li><a href="#pg-65bb532e2949268a0bd020d4878070be">Is running postgres in docker a good idea?</a></li>



    
  

    </ul>
    
  
    
    
	

    <li><a href="#pg-5bcbeca414ff09093cc0deadee97e7ca">Cloud Exit</a></li>



    
    <ul>
        
  
  
  
  

  
    
    
	

    <li><a href="#pg-7f57c973bb7756d9b0ca9b96892a6d2d">S3: Elite to Mediocre</a></li>



    
  
    
    
	

    <li><a href="#pg-80ebd4282641b01facdbdf7ef86ea752">Reclaim Hardware Bonus from the Cloud</a></li>



    
  
    
    
	

    <li><a href="#pg-c0e49b0e5d0a3d0c994910d0cc773519">FinOps: Endgame Cloud-Exit</a></li>



    
  
    
    
	

    <li><a href="#pg-fb2b56bca82f7d919a808b2f73758318">SLA: Placebo or Insurance?</a></li>



    
  
    
    
	

    <li><a href="#pg-9acfe4d5f6e1972f749837119d2bab4b">EBS: Pig Slaughter Scam</a></li>



    
  
    
    
	

    <li><a href="#pg-2f6739426df63d5dd62ead985e471dc9">RDS: The Idiot Tax</a></li>



    
  

    </ul>
    
  
    
    
	

    <li><a href="#pg-772bd97e44fff7931858afc924365181">Postgres</a></li>



    
    <ul>
        
  
  
  
  

  
    
    
	

    <li><a href="#pg-cc0f3b60839047690e18daaf6e1b2eb0">Pig, The Postgres Extension Wizard</a></li>



    
  
    
    
	

    <li><a href="#pg-7f5a0de014a67abd29c62899ad7fa900">The idea way to install PostgreSQL Extensions</a></li>



    
  
    
    
	

    <li><a href="#pg-635f4dbe52424af419b468e194e22c72">Self-Hosting Dify with PG, PGVector, and Pigsty</a></li>



    
  
    
    
	

    <li><a href="#pg-7b7e2fed3610aaf3b302a1fa64530049">PGCon.Dev 2024, The conf that shutdown PG for a week</a></li>



    
  
    
    
	

    <li><a href="#pg-7d36280c97d93954ecc5eee99cde64b7">Postgres is eating the database world</a></li>



    
  
    
    
	

    <li><a href="#pg-fe0303de91d0c7a97aa03dbbd71290fa">PostgreSQL Convention 2024</a></li>



    
  
    
    
	

    <li><a href="#pg-9ac7b152e2b98d51f3cf9cda74feaf4a">PostgreSQL, The most successful database</a></li>



    
  

    </ul>
    
  
    
    
	

    <li><a href="#pg-fbc771f2981eed29c0bc016b2d68a41a">Releases</a></li>



    
    <ul>
        
  
  
  
  

  
    
    
	

    <li><a href="#pg-93a85e78558ffe12d450f9660ac47211">v3.1: PG 17 as default, Better Supabase &amp; MinIO, ARM &amp; U24 support</a></li>



    
  
    
    
	

    <li><a href="#pg-e7e4e4c92d83a217d8bda0fa106a91e3">Pigsty v3.0: Extension Exploding &amp; Plugable Kernels</a></li>



    
  
    
    
	

    <li><a href="#pg-cce82b7ac2e11e5d6e05c73c4fc50cbe">v2.7: Extension Overwhelming</a></li>



    
  
    
    
	

    <li><a href="#pg-3dc770fcdf858c1d69f4529ce3598e35">v2.6: the OLAP New Challenger</a></li>



    
  
    
    
	

    <li><a href="#pg-ed1ac65c2e587244099ee76432661f6f">v2.5: Debian / Ubuntu / PG16</a></li>



    
  
    
    
	

    <li><a href="#pg-96dd01ab4a3d0bd6dfab7c250bacba6a">v2.4: Monitoring Cloud RDS</a></li>



    
  
    
    
	

    <li><a href="#pg-7614bd9c24528f6c6b30f1ac2805f1a5">v2.3: Ecosystem Applications</a></li>



    
  
    
    
	

    <li><a href="#pg-6825bf79d1906fbbd528bd99a583848e">v2.2: Observability Overhaul</a></li>



    
  
    
    
	

    <li><a href="#pg-f0e725fb652dced07f33923430e0af98">v2.1: Vector Embedding &amp; RAG</a></li>



    
  
    
    
	

    <li><a href="#pg-245a6f15e780571746392362492e84ab">v2.0: Free RDS PG Alternative</a></li>



    
  
    
    
	

    <li><a href="#pg-81dacd29684b0b4454631f9f21450afb">v1.5.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-434178e5fe8c53371b4d97db657374b7">v1.4.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-a0fb8b384cade6ec407c2453f1e2d292">v1.3.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-d2b8bcedf0eac31226e2b7f3dcba7d8a">v1.2.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-854c111b55099c9d05d054f2e73a5cbf">v1.1.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-794b5d90dc8a76efe53cd1189faf34ff">v1.0.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-53940fb31dd185924dcbf98876521bbc">v0.9.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-1c0e38dfb9d42ffaff8ca7937ecd2e21">v0.8.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-a757729041ec674785eddd6b2c1694e2">v0.7.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-9d3157a4b85f04c552b9dc4e0605e241">v0.6.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-a31bec40c01f539af16d13999ac7c1ab">v0.5.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-b5d77a188caf8e3a09a3d3b5b8acaa94">v0.4.0 Release Note</a></li>



    
  
    
    
	

    <li><a href="#pg-7df560570ddd6f526d521202261d0bf9">v0.3.0 Release Note</a></li>



    
  

    </ul>
    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-d4c403d8393b56a8f4e75a36c552935f">Database</h1>
	<div class="lead">Articles about database industry, surveys, methods, ideas and best practices</div>
	<div class="td-byline mb-4">
		
        
	</div>
	
</div>





    
      
  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-334087cf09542980cb6fca786dec3146">Self-Hosting Supabase on PostgreSQL</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2024-11-25" class="text-muted">2024-11-25</time>
        
	</div>
	<p>Supabase is great, own your own Supabase is even better.
Here&rsquo;s a comprehensive tutorial for self-hosting production-grade supabase on local/cloud VM/BMs.</p>
<h2 id="what-is-supabase">What is Supabase?</h2>
<p><a href="https://supabase.com/">Supabase</a> is an open-source Firebase alternative, a Backend as a Service (BaaS).</p>
<p>Supabase wraps PostgreSQL kernel and vector extensions, alone with authentication, realtime subscriptions, edge functions, object storage, and instant REST and GraphQL APIs from your postgres schema.
It let you skip most backend work, requiring only database design and frontend skills to ship quickly.</p>
<p>Currently, Supabase may be the <a href="https://ossrank.com/cat/368-postgresql-extension-ecosystem">most popular</a> open-source project in the PostgreSQL ecosystem, boasting over 74,000 stars on GitHub.
And become quite popular among developers, and startups, since they have a <a href="https://supabase.com/pricing">generous free plan</a>, just like cloudflare &amp; neon.</p>
<hr>
<h2 id="why-self-hosting">Why Self-Hosting?</h2>
<p>Supabase&rsquo;s slogan is: &ldquo;<strong>Build in a weekend, Scale to millions</strong>&rdquo;. It has great cost-effectiveness in small scales (4c8g) indeed.
But there is no doubt that when you really grow to millions of users, some may choose to self-hosting their own Supabase —— for functionality, performance, cost, and other reasons.</p>
<p>That&rsquo;s where Pigsty comes in. Pigsty provides a complete one-click self-hosting solution for Supabase.
Self-hosted Supabase can enjoy full PostgreSQL monitoring, IaC, PITR, and high availability capability,</p>
<p>You can run the latest PostgreSQL 17(,16,15,14) kernels, (supabase is using the 15 currently), alone with <a href="https://ext.pigsty.io/#/list">340</a> PostgreSQL extensions out-of-the-box.
Run on <a href="/docs/reference/compatibility/">mainstream</a> Linus OS distros with production grade <a href="/docs/concept/ha/">HA</a> <a href="/docs/pgsql/">PostgreSQL</a>, <a href="/docs/minio/">MinIO</a>, Prometheus &amp; Grafana Stack for observability, and Nginx for reverse proxy.</p>
<p><a href="https://ext.pigsty.io/#/time"><strong>TIME</strong></a>: <a href="https://ext.pigsty.io/#/timescaledb"><code>timescaledb</code></a> <a href="https://ext.pigsty.io/#/timescaledb_toolkit"><code>timescaledb_toolkit</code></a> <a href="https://ext.pigsty.io/#/timeseries"><code>timeseries</code></a> <a href="https://ext.pigsty.io/#/periods"><code>periods</code></a> <a href="https://ext.pigsty.io/#/temporal_tables"><code>temporal_tables</code></a> <a href="https://ext.pigsty.io/#/emaj"><code>emaj</code></a> <a href="https://ext.pigsty.io/#/table_version"><code>table_version</code></a> <a href="https://ext.pigsty.io/#/pg_cron"><code>pg_cron</code></a> <a href="https://ext.pigsty.io/#/pg_later"><code>pg_later</code></a> <a href="https://ext.pigsty.io/#/pg_background"><code>pg_background</code></a>
<a href="https://ext.pigsty.io/#/gis"><strong>GIS</strong></a>: <a href="https://ext.pigsty.io/#/postgis"><code>postgis</code></a> <a href="https://ext.pigsty.io/#/postgis_topology"><code>postgis_topology</code></a> <a href="https://ext.pigsty.io/#/postgis_raster"><code>postgis_raster</code></a> <a href="https://ext.pigsty.io/#/postgis_sfcgal"><code>postgis_sfcgal</code></a> <a href="https://ext.pigsty.io/#/postgis_tiger_geocoder"><code>postgis_tiger_geocoder</code></a> <a href="https://ext.pigsty.io/#/address_standardizer"><code>address_standardizer</code></a> <a href="https://ext.pigsty.io/#/address_standardizer_data_us"><code>address_standardizer_data_us</code></a> <a href="https://ext.pigsty.io/#/pgrouting"><code>pgrouting</code></a> <a href="https://ext.pigsty.io/#/pointcloud"><code>pointcloud</code></a> <a href="https://ext.pigsty.io/#/pointcloud_postgis"><code>pointcloud_postgis</code></a> <a href="https://ext.pigsty.io/#/h3"><code>h3</code></a> <a href="https://ext.pigsty.io/#/h3_postgis"><code>h3_postgis</code></a> <a href="https://ext.pigsty.io/#/q3c"><code>q3c</code></a> <a href="https://ext.pigsty.io/#/ogr_fdw"><code>ogr_fdw</code></a> <a href="https://ext.pigsty.io/#/geoip"><code>geoip</code></a> <a href="https://ext.pigsty.io/#/pg_polyline"><code>pg_polyline</code></a> <a href="https://ext.pigsty.io/#/pg_geohash"><code>pg_geohash</code></a> <a href="https://ext.pigsty.io/#/mobilitydb"><code>mobilitydb</code></a> <a href="https://ext.pigsty.io/#/earthdistance"><code>earthdistance</code></a>
<a href="https://ext.pigsty.io/#/rag"><strong>RAG</strong></a>: <a href="https://ext.pigsty.io/#/vector"><code>vector</code></a> <a href="https://ext.pigsty.io/#/vectorscale"><code>vectorscale</code></a> <a href="https://ext.pigsty.io/#/vectorize"><code>vectorize</code></a> <a href="https://ext.pigsty.io/#/pg_similarity"><code>pg_similarity</code></a> <a href="https://ext.pigsty.io/#/smlar"><code>smlar</code></a> <a href="https://ext.pigsty.io/#/pg_summarize"><code>pg_summarize</code></a> <a href="https://ext.pigsty.io/#/pg_tiktoken"><code>pg_tiktoken</code></a> <a href="https://ext.pigsty.io/#/pgml"><code>pgml</code></a> <a href="https://ext.pigsty.io/#/pg4ml"><code>pg4ml</code></a>
<a href="https://ext.pigsty.io/#/fts"><strong>FTS</strong></a>: <a href="https://ext.pigsty.io/#/pg_search"><code>pg_search</code></a> <a href="https://ext.pigsty.io/#/pg_bigm"><code>pg_bigm</code></a> <a href="https://ext.pigsty.io/#/zhparser"><code>zhparser</code></a> <a href="https://ext.pigsty.io/#/hunspell_cs_cz"><code>hunspell_cs_cz</code></a> <a href="https://ext.pigsty.io/#/hunspell_de_de"><code>hunspell_de_de</code></a> <a href="https://ext.pigsty.io/#/hunspell_en_us"><code>hunspell_en_us</code></a> <a href="https://ext.pigsty.io/#/hunspell_fr"><code>hunspell_fr</code></a> <a href="https://ext.pigsty.io/#/hunspell_ne_np"><code>hunspell_ne_np</code></a> <a href="https://ext.pigsty.io/#/hunspell_nl_nl"><code>hunspell_nl_nl</code></a> <a href="https://ext.pigsty.io/#/hunspell_nn_no"><code>hunspell_nn_no</code></a> <a href="https://ext.pigsty.io/#/hunspell_pt_pt"><code>hunspell_pt_pt</code></a> <a href="https://ext.pigsty.io/#/hunspell_ru_ru"><code>hunspell_ru_ru</code></a> <a href="https://ext.pigsty.io/#/hunspell_ru_ru_aot"><code>hunspell_ru_ru_aot</code></a> <a href="https://ext.pigsty.io/#/fuzzystrmatch"><code>fuzzystrmatch</code></a> <a href="https://ext.pigsty.io/#/pg_trgm"><code>pg_trgm</code></a>
<a href="https://ext.pigsty.io/#/olap"><strong>OLAP</strong></a>: <a href="https://ext.pigsty.io/#/citus"><code>citus</code></a> <a href="https://ext.pigsty.io/#/citus_columnar"><code>citus_columnar</code></a> <a href="https://ext.pigsty.io/#/columnar"><code>columnar</code></a> <a href="https://ext.pigsty.io/#/pg_analytics"><code>pg_analytics</code></a> <a href="https://ext.pigsty.io/#/pg_duckdb"><code>pg_duckdb</code></a> <a href="https://ext.pigsty.io/#/pg_mooncake"><code>pg_mooncake</code></a> <a href="https://ext.pigsty.io/#/duckdb_fdw"><code>duckdb_fdw</code></a> <a href="https://ext.pigsty.io/#/pg_parquet"><code>pg_parquet</code></a> <a href="https://ext.pigsty.io/#/pg_fkpart"><code>pg_fkpart</code></a> <a href="https://ext.pigsty.io/#/pg_partman"><code>pg_partman</code></a> <a href="https://ext.pigsty.io/#/plproxy"><code>plproxy</code></a> <a href="https://ext.pigsty.io/#/pg_strom"><code>pg_strom</code></a> <a href="https://ext.pigsty.io/#/tablefunc"><code>tablefunc</code></a>
<a href="https://ext.pigsty.io/#/feat"><strong>FEAT</strong></a>: <a href="https://ext.pigsty.io/#/age"><code>age</code></a> <a href="https://ext.pigsty.io/#/hll"><code>hll</code></a> <a href="https://ext.pigsty.io/#/rum"><code>rum</code></a> <a href="https://ext.pigsty.io/#/pg_graphql"><code>pg_graphql</code></a> <a href="https://ext.pigsty.io/#/pg_jsonschema"><code>pg_jsonschema</code></a> <a href="https://ext.pigsty.io/#/jsquery"><code>jsquery</code></a> <a href="https://ext.pigsty.io/#/pg_hint_plan"><code>pg_hint_plan</code></a> <a href="https://ext.pigsty.io/#/hypopg"><code>hypopg</code></a> <a href="https://ext.pigsty.io/#/index_advisor"><code>index_advisor</code></a> <a href="https://ext.pigsty.io/#/plan_filter"><code>plan_filter</code></a> <a href="https://ext.pigsty.io/#/imgsmlr"><code>imgsmlr</code></a> <a href="https://ext.pigsty.io/#/pg_ivm"><code>pg_ivm</code></a> <a href="https://ext.pigsty.io/#/pgmq"><code>pgmq</code></a> <a href="https://ext.pigsty.io/#/pgq"><code>pgq</code></a> <a href="https://ext.pigsty.io/#/pg_cardano"><code>pg_cardano</code></a> <a href="https://ext.pigsty.io/#/rdkit"><code>rdkit</code></a> <a href="https://ext.pigsty.io/#/bloom"><code>bloom</code></a>
<a href="https://ext.pigsty.io/#/lang"><strong>LANG</strong></a>: <a href="https://ext.pigsty.io/#/pg_tle"><code>pg_tle</code></a> <a href="https://ext.pigsty.io/#/plv8"><code>plv8</code></a> <a href="https://ext.pigsty.io/#/pllua"><code>pllua</code></a> <a href="https://ext.pigsty.io/#/hstore_pllua"><code>hstore_pllua</code></a> <a href="https://ext.pigsty.io/#/plluau"><code>plluau</code></a> <a href="https://ext.pigsty.io/#/hstore_plluau"><code>hstore_plluau</code></a> <a href="https://ext.pigsty.io/#/plprql"><code>plprql</code></a> <a href="https://ext.pigsty.io/#/pldbgapi"><code>pldbgapi</code></a> <a href="https://ext.pigsty.io/#/plpgsql_check"><code>plpgsql_check</code></a> <a href="https://ext.pigsty.io/#/plprofiler"><code>plprofiler</code></a> <a href="https://ext.pigsty.io/#/plsh"><code>plsh</code></a> <a href="https://ext.pigsty.io/#/pljava"><code>pljava</code></a> <a href="https://ext.pigsty.io/#/plr"><code>plr</code></a> <a href="https://ext.pigsty.io/#/pgtap"><code>pgtap</code></a> <a href="https://ext.pigsty.io/#/faker"><code>faker</code></a> <a href="https://ext.pigsty.io/#/dbt2"><code>dbt2</code></a> <a href="https://ext.pigsty.io/#/pltcl"><code>pltcl</code></a> <a href="https://ext.pigsty.io/#/pltclu"><code>pltclu</code></a> <a href="https://ext.pigsty.io/#/plperl"><code>plperl</code></a> <a href="https://ext.pigsty.io/#/bool_plperl"><code>bool_plperl</code></a> <a href="https://ext.pigsty.io/#/hstore_plperl"><code>hstore_plperl</code></a> <a href="https://ext.pigsty.io/#/jsonb_plperl"><code>jsonb_plperl</code></a> <a href="https://ext.pigsty.io/#/plperlu"><code>plperlu</code></a> <a href="https://ext.pigsty.io/#/bool_plperlu"><code>bool_plperlu</code></a> <a href="https://ext.pigsty.io/#/jsonb_plperlu"><code>jsonb_plperlu</code></a> <a href="https://ext.pigsty.io/#/hstore_plperlu"><code>hstore_plperlu</code></a> <a href="https://ext.pigsty.io/#/plpgsql"><code>plpgsql</code></a> <a href="https://ext.pigsty.io/#/plpython3u"><code>plpython3u</code></a> <a href="https://ext.pigsty.io/#/jsonb_plpython3u"><code>jsonb_plpython3u</code></a> <a href="https://ext.pigsty.io/#/ltree_plpython3u"><code>ltree_plpython3u</code></a> <a href="https://ext.pigsty.io/#/hstore_plpython3u"><code>hstore_plpython3u</code></a>
<a href="https://ext.pigsty.io/#/type"><strong>TYPE</strong></a>: <a href="https://ext.pigsty.io/#/prefix"><code>prefix</code></a> <a href="https://ext.pigsty.io/#/semver"><code>semver</code></a> <a href="https://ext.pigsty.io/#/unit"><code>unit</code></a> <a href="https://ext.pigsty.io/#/md5hash"><code>md5hash</code></a> <a href="https://ext.pigsty.io/#/asn1oid"><code>asn1oid</code></a> <a href="https://ext.pigsty.io/#/roaringbitmap"><code>roaringbitmap</code></a> <a href="https://ext.pigsty.io/#/pgfaceting"><code>pgfaceting</code></a> <a href="https://ext.pigsty.io/#/pg_sphere"><code>pg_sphere</code></a> <a href="https://ext.pigsty.io/#/country"><code>country</code></a> <a href="https://ext.pigsty.io/#/currency"><code>currency</code></a> <a href="https://ext.pigsty.io/#/pgmp"><code>pgmp</code></a> <a href="https://ext.pigsty.io/#/numeral"><code>numeral</code></a> <a href="https://ext.pigsty.io/#/pg_rational"><code>pg_rational</code></a> <a href="https://ext.pigsty.io/#/uint"><code>uint</code></a> <a href="https://ext.pigsty.io/#/uint128"><code>uint128</code></a> <a href="https://ext.pigsty.io/#/ip4r"><code>ip4r</code></a> <a href="https://ext.pigsty.io/#/uri"><code>uri</code></a> <a href="https://ext.pigsty.io/#/pgemailaddr"><code>pgemailaddr</code></a> <a href="https://ext.pigsty.io/#/acl"><code>acl</code></a> <a href="https://ext.pigsty.io/#/debversion"><code>debversion</code></a> <a href="https://ext.pigsty.io/#/pg_rrule"><code>pg_rrule</code></a> <a href="https://ext.pigsty.io/#/timestamp9"><code>timestamp9</code></a> <a href="https://ext.pigsty.io/#/chkpass"><code>chkpass</code></a> <a href="https://ext.pigsty.io/#/isn"><code>isn</code></a> <a href="https://ext.pigsty.io/#/seg"><code>seg</code></a> <a href="https://ext.pigsty.io/#/cube"><code>cube</code></a> <a href="https://ext.pigsty.io/#/ltree"><code>ltree</code></a> <a href="https://ext.pigsty.io/#/hstore"><code>hstore</code></a> <a href="https://ext.pigsty.io/#/citext"><code>citext</code></a> <a href="https://ext.pigsty.io/#/xml2"><code>xml2</code></a>
<a href="https://ext.pigsty.io/#/func"><strong>FUNC</strong></a>: <a href="https://ext.pigsty.io/#/topn"><code>topn</code></a> <a href="https://ext.pigsty.io/#/gzip"><code>gzip</code></a> <a href="https://ext.pigsty.io/#/zstd"><code>zstd</code></a> <a href="https://ext.pigsty.io/#/http"><code>http</code></a> <a href="https://ext.pigsty.io/#/pg_net"><code>pg_net</code></a> <a href="https://ext.pigsty.io/#/pg_smtp_client"><code>pg_smtp_client</code></a> <a href="https://ext.pigsty.io/#/pg_html5_email_address"><code>pg_html5_email_address</code></a> <a href="https://ext.pigsty.io/#/pgsql_tweaks"><code>pgsql_tweaks</code></a> <a href="https://ext.pigsty.io/#/pg_extra_time"><code>pg_extra_time</code></a> <a href="https://ext.pigsty.io/#/timeit"><code>timeit</code></a> <a href="https://ext.pigsty.io/#/count_distinct"><code>count_distinct</code></a> <a href="https://ext.pigsty.io/#/extra_window_functions"><code>extra_window_functions</code></a> <a href="https://ext.pigsty.io/#/first_last_agg"><code>first_last_agg</code></a> <a href="https://ext.pigsty.io/#/tdigest"><code>tdigest</code></a> <a href="https://ext.pigsty.io/#/aggs_for_vecs"><code>aggs_for_vecs</code></a> <a href="https://ext.pigsty.io/#/aggs_for_arrays"><code>aggs_for_arrays</code></a> <a href="https://ext.pigsty.io/#/arraymath"><code>arraymath</code></a> <a href="https://ext.pigsty.io/#/quantile"><code>quantile</code></a> <a href="https://ext.pigsty.io/#/lower_quantile"><code>lower_quantile</code></a> <a href="https://ext.pigsty.io/#/pg_idkit"><code>pg_idkit</code></a> <a href="https://ext.pigsty.io/#/pg_uuidv7"><code>pg_uuidv7</code></a> <a href="https://ext.pigsty.io/#/permuteseq"><code>permuteseq</code></a> <a href="https://ext.pigsty.io/#/pg_hashids"><code>pg_hashids</code></a> <a href="https://ext.pigsty.io/#/sequential_uuids"><code>sequential_uuids</code></a> <a href="https://ext.pigsty.io/#/pg_math"><code>pg_math</code></a> <a href="https://ext.pigsty.io/#/random"><code>random</code></a> <a href="https://ext.pigsty.io/#/base36"><code>base36</code></a> <a href="https://ext.pigsty.io/#/base62"><code>base62</code></a> <a href="https://ext.pigsty.io/#/pg_base58"><code>pg_base58</code></a> <a href="https://ext.pigsty.io/#/floatvec"><code>floatvec</code></a> <a href="https://ext.pigsty.io/#/financial"><code>financial</code></a> <a href="https://ext.pigsty.io/#/pgjwt"><code>pgjwt</code></a> <a href="https://ext.pigsty.io/#/pg_hashlib"><code>pg_hashlib</code></a> <a href="https://ext.pigsty.io/#/shacrypt"><code>shacrypt</code></a> <a href="https://ext.pigsty.io/#/cryptint"><code>cryptint</code></a> <a href="https://ext.pigsty.io/#/pguecc"><code>pguecc</code></a> <a href="https://ext.pigsty.io/#/pgpcre"><code>pgpcre</code></a> <a href="https://ext.pigsty.io/#/icu_ext"><code>icu_ext</code></a> <a href="https://ext.pigsty.io/#/pgqr"><code>pgqr</code></a> <a href="https://ext.pigsty.io/#/envvar"><code>envvar</code></a> <a href="https://ext.pigsty.io/#/pg_protobuf"><code>pg_protobuf</code></a> <a href="https://ext.pigsty.io/#/url_encode"><code>url_encode</code></a> <a href="https://ext.pigsty.io/#/refint"><code>refint</code></a> <a href="https://ext.pigsty.io/#/autoinc"><code>autoinc</code></a> <a href="https://ext.pigsty.io/#/insert_username"><code>insert_username</code></a> <a href="https://ext.pigsty.io/#/moddatetime"><code>moddatetime</code></a> <a href="https://ext.pigsty.io/#/tsm_system_time"><code>tsm_system_time</code></a> <a href="https://ext.pigsty.io/#/dict_xsyn"><code>dict_xsyn</code></a> <a href="https://ext.pigsty.io/#/tsm_system_rows"><code>tsm_system_rows</code></a> <a href="https://ext.pigsty.io/#/tcn"><code>tcn</code></a> <a href="https://ext.pigsty.io/#/uuid-ossp"><code>uuid-ossp</code></a> <a href="https://ext.pigsty.io/#/btree_gist"><code>btree_gist</code></a> <a href="https://ext.pigsty.io/#/btree_gin"><code>btree_gin</code></a> <a href="https://ext.pigsty.io/#/intarray"><code>intarray</code></a> <a href="https://ext.pigsty.io/#/intagg"><code>intagg</code></a> <a href="https://ext.pigsty.io/#/dict_int"><code>dict_int</code></a> <a href="https://ext.pigsty.io/#/unaccent"><code>unaccent</code></a>
<a href="https://ext.pigsty.io/#/admin"><strong>ADMIN</strong></a>: <a href="https://ext.pigsty.io/#/pg_repack"><code>pg_repack</code></a> <a href="https://ext.pigsty.io/#/pg_squeeze"><code>pg_squeeze</code></a> <a href="https://ext.pigsty.io/#/pg_dirtyread"><code>pg_dirtyread</code></a> <a href="https://ext.pigsty.io/#/pgfincore"><code>pgfincore</code></a> <a href="https://ext.pigsty.io/#/pgdd"><code>pgdd</code></a> <a href="https://ext.pigsty.io/#/ddlx"><code>ddlx</code></a> <a href="https://ext.pigsty.io/#/prioritize"><code>prioritize</code></a> <a href="https://ext.pigsty.io/#/pg_checksums"><code>pg_checksums</code></a> <a href="https://ext.pigsty.io/#/pg_readonly"><code>pg_readonly</code></a> <a href="https://ext.pigsty.io/#/safeupdate"><code>safeupdate</code></a> <a href="https://ext.pigsty.io/#/pg_permissions"><code>pg_permissions</code></a> <a href="https://ext.pigsty.io/#/pgautofailover"><code>pgautofailover</code></a> <a href="https://ext.pigsty.io/#/pg_catcheck"><code>pg_catcheck</code></a> <a href="https://ext.pigsty.io/#/pre_prepare"><code>pre_prepare</code></a> <a href="https://ext.pigsty.io/#/pgcozy"><code>pgcozy</code></a> <a href="https://ext.pigsty.io/#/pg_orphaned"><code>pg_orphaned</code></a> <a href="https://ext.pigsty.io/#/pg_crash"><code>pg_crash</code></a> <a href="https://ext.pigsty.io/#/pg_cheat_funcs"><code>pg_cheat_funcs</code></a> <a href="https://ext.pigsty.io/#/pg_savior"><code>pg_savior</code></a> <a href="https://ext.pigsty.io/#/table_log"><code>table_log</code></a> <a href="https://ext.pigsty.io/#/pg_fio"><code>pg_fio</code></a> <a href="https://ext.pigsty.io/#/pgpool_adm"><code>pgpool_adm</code></a> <a href="https://ext.pigsty.io/#/pgpool_recovery"><code>pgpool_recovery</code></a> <a href="https://ext.pigsty.io/#/pgpool_regclass"><code>pgpool_regclass</code></a> <a href="https://ext.pigsty.io/#/pgagent"><code>pgagent</code></a> <a href="https://ext.pigsty.io/#/vacuumlo"><code>vacuumlo</code></a> <a href="https://ext.pigsty.io/#/pg_prewarm"><code>pg_prewarm</code></a> <a href="https://ext.pigsty.io/#/oid2name"><code>oid2name</code></a> <a href="https://ext.pigsty.io/#/lo"><code>lo</code></a> <a href="https://ext.pigsty.io/#/basic_archive"><code>basic_archive</code></a> <a href="https://ext.pigsty.io/#/basebackup_to_shell"><code>basebackup_to_shell</code></a> <a href="https://ext.pigsty.io/#/old_snapshot"><code>old_snapshot</code></a> <a href="https://ext.pigsty.io/#/adminpack"><code>adminpack</code></a> <a href="https://ext.pigsty.io/#/amcheck"><code>amcheck</code></a> <a href="https://ext.pigsty.io/#/pg_surgery"><code>pg_surgery</code></a>
<a href="https://ext.pigsty.io/#/stat"><strong>STAT</strong></a>: <a href="https://ext.pigsty.io/#/pg_profile"><code>pg_profile</code></a> <a href="https://ext.pigsty.io/#/pg_show_plans"><code>pg_show_plans</code></a> <a href="https://ext.pigsty.io/#/pg_stat_kcache"><code>pg_stat_kcache</code></a> <a href="https://ext.pigsty.io/#/pg_stat_monitor"><code>pg_stat_monitor</code></a> <a href="https://ext.pigsty.io/#/pg_qualstats"><code>pg_qualstats</code></a> <a href="https://ext.pigsty.io/#/pg_store_plans"><code>pg_store_plans</code></a> <a href="https://ext.pigsty.io/#/pg_track_settings"><code>pg_track_settings</code></a> <a href="https://ext.pigsty.io/#/pg_wait_sampling"><code>pg_wait_sampling</code></a> <a href="https://ext.pigsty.io/#/system_stats"><code>system_stats</code></a> <a href="https://ext.pigsty.io/#/meta"><code>meta</code></a> <a href="https://ext.pigsty.io/#/pgnodemx"><code>pgnodemx</code></a> <a href="https://ext.pigsty.io/#/pg_proctab"><code>pg_proctab</code></a> <a href="https://ext.pigsty.io/#/pg_sqlog"><code>pg_sqlog</code></a> <a href="https://ext.pigsty.io/#/bgw_replstatus"><code>bgw_replstatus</code></a> <a href="https://ext.pigsty.io/#/pgmeminfo"><code>pgmeminfo</code></a> <a href="https://ext.pigsty.io/#/toastinfo"><code>toastinfo</code></a> <a href="https://ext.pigsty.io/#/explain_ui"><code>explain_ui</code></a> <a href="https://ext.pigsty.io/#/pg_relusage"><code>pg_relusage</code></a> <a href="https://ext.pigsty.io/#/pg_top"><code>pg_top</code></a> <a href="https://ext.pigsty.io/#/pagevis"><code>pagevis</code></a> <a href="https://ext.pigsty.io/#/powa"><code>powa</code></a> <a href="https://ext.pigsty.io/#/pageinspect"><code>pageinspect</code></a> <a href="https://ext.pigsty.io/#/pgrowlocks"><code>pgrowlocks</code></a> <a href="https://ext.pigsty.io/#/sslinfo"><code>sslinfo</code></a> <a href="https://ext.pigsty.io/#/pg_buffercache"><code>pg_buffercache</code></a> <a href="https://ext.pigsty.io/#/pg_walinspect"><code>pg_walinspect</code></a> <a href="https://ext.pigsty.io/#/pg_freespacemap"><code>pg_freespacemap</code></a> <a href="https://ext.pigsty.io/#/pg_visibility"><code>pg_visibility</code></a> <a href="https://ext.pigsty.io/#/pgstattuple"><code>pgstattuple</code></a> <a href="https://ext.pigsty.io/#/auto_explain"><code>auto_explain</code></a> <a href="https://ext.pigsty.io/#/pg_stat_statements"><code>pg_stat_statements</code></a>
<a href="https://ext.pigsty.io/#/sec"><strong>SEC</strong></a>: <a href="https://ext.pigsty.io/#/passwordcheck_cracklib"><code>passwordcheck_cracklib</code></a> <a href="https://ext.pigsty.io/#/supautils"><code>supautils</code></a> <a href="https://ext.pigsty.io/#/pgsodium"><code>pgsodium</code></a> <a href="https://ext.pigsty.io/#/supabase_vault"><code>supabase_vault</code></a> <a href="https://ext.pigsty.io/#/pg_session_jwt"><code>pg_session_jwt</code></a> <a href="https://ext.pigsty.io/#/anon"><code>anon</code></a> <a href="https://ext.pigsty.io/#/pg_tde"><code>pg_tde</code></a> <a href="https://ext.pigsty.io/#/pgsmcrypto"><code>pgsmcrypto</code></a> <a href="https://ext.pigsty.io/#/pgaudit"><code>pgaudit</code></a> <a href="https://ext.pigsty.io/#/pgauditlogtofile"><code>pgauditlogtofile</code></a> <a href="https://ext.pigsty.io/#/pg_auth_mon"><code>pg_auth_mon</code></a> <a href="https://ext.pigsty.io/#/credcheck"><code>credcheck</code></a> <a href="https://ext.pigsty.io/#/pgcryptokey"><code>pgcryptokey</code></a> <a href="https://ext.pigsty.io/#/pg_jobmon"><code>pg_jobmon</code></a> <a href="https://ext.pigsty.io/#/logerrors"><code>logerrors</code></a> <a href="https://ext.pigsty.io/#/login_hook"><code>login_hook</code></a> <a href="https://ext.pigsty.io/#/set_user"><code>set_user</code></a> <a href="https://ext.pigsty.io/#/pg_snakeoil"><code>pg_snakeoil</code></a> <a href="https://ext.pigsty.io/#/pgextwlist"><code>pgextwlist</code></a> <a href="https://ext.pigsty.io/#/pg_auditor"><code>pg_auditor</code></a> <a href="https://ext.pigsty.io/#/sslutils"><code>sslutils</code></a> <a href="https://ext.pigsty.io/#/noset"><code>noset</code></a> <a href="https://ext.pigsty.io/#/sepgsql"><code>sepgsql</code></a> <a href="https://ext.pigsty.io/#/auth_delay"><code>auth_delay</code></a> <a href="https://ext.pigsty.io/#/pgcrypto"><code>pgcrypto</code></a> <a href="https://ext.pigsty.io/#/passwordcheck"><code>passwordcheck</code></a>
<a href="https://ext.pigsty.io/#/fdw"><strong>FDW</strong></a>: <a href="https://ext.pigsty.io/#/wrappers"><code>wrappers</code></a> <a href="https://ext.pigsty.io/#/multicorn"><code>multicorn</code></a> <a href="https://ext.pigsty.io/#/odbc_fdw"><code>odbc_fdw</code></a> <a href="https://ext.pigsty.io/#/jdbc_fdw"><code>jdbc_fdw</code></a> <a href="https://ext.pigsty.io/#/mysql_fdw"><code>mysql_fdw</code></a> <a href="https://ext.pigsty.io/#/oracle_fdw"><code>oracle_fdw</code></a> <a href="https://ext.pigsty.io/#/tds_fdw"><code>tds_fdw</code></a> <a href="https://ext.pigsty.io/#/db2_fdw"><code>db2_fdw</code></a> <a href="https://ext.pigsty.io/#/sqlite_fdw"><code>sqlite_fdw</code></a> <a href="https://ext.pigsty.io/#/pgbouncer_fdw"><code>pgbouncer_fdw</code></a> <a href="https://ext.pigsty.io/#/mongo_fdw"><code>mongo_fdw</code></a> <a href="https://ext.pigsty.io/#/redis_fdw"><code>redis_fdw</code></a> <a href="https://ext.pigsty.io/#/redis"><code>redis</code></a> <a href="https://ext.pigsty.io/#/kafka_fdw"><code>kafka_fdw</code></a> <a href="https://ext.pigsty.io/#/hdfs_fdw"><code>hdfs_fdw</code></a> <a href="https://ext.pigsty.io/#/firebird_fdw"><code>firebird_fdw</code></a> <a href="https://ext.pigsty.io/#/aws_s3"><code>aws_s3</code></a> <a href="https://ext.pigsty.io/#/log_fdw"><code>log_fdw</code></a> <a href="https://ext.pigsty.io/#/dblink"><code>dblink</code></a> <a href="https://ext.pigsty.io/#/file_fdw"><code>file_fdw</code></a> <a href="https://ext.pigsty.io/#/postgres_fdw"><code>postgres_fdw</code></a>
<a href="https://ext.pigsty.io/#/sim"><strong>SIM</strong></a>: <a href="https://ext.pigsty.io/#/orafce"><code>orafce</code></a> <a href="https://ext.pigsty.io/#/pgtt"><code>pgtt</code></a> <a href="https://ext.pigsty.io/#/session_variable"><code>session_variable</code></a> <a href="https://ext.pigsty.io/#/pg_statement_rollback"><code>pg_statement_rollback</code></a> <a href="https://ext.pigsty.io/#/pg_dbms_metadata"><code>pg_dbms_metadata</code></a> <a href="https://ext.pigsty.io/#/pg_dbms_lock"><code>pg_dbms_lock</code></a> <a href="https://ext.pigsty.io/#/pg_dbms_job"><code>pg_dbms_job</code></a> <a href="https://ext.pigsty.io/#/babelfishpg_common"><code>babelfishpg_common</code></a> <a href="https://ext.pigsty.io/#/babelfishpg_tsql"><code>babelfishpg_tsql</code></a> <a href="https://ext.pigsty.io/#/babelfishpg_tds"><code>babelfishpg_tds</code></a> <a href="https://ext.pigsty.io/#/babelfishpg_money"><code>babelfishpg_money</code></a> <a href="https://ext.pigsty.io/#/pgmemcache"><code>pgmemcache</code></a>
<a href="https://ext.pigsty.io/#/etl"><strong>ETL</strong></a>: <a href="https://ext.pigsty.io/#/pglogical"><code>pglogical</code></a> <a href="https://ext.pigsty.io/#/pglogical_origin"><code>pglogical_origin</code></a> <a href="https://ext.pigsty.io/#/pglogical_ticker"><code>pglogical_ticker</code></a> <a href="https://ext.pigsty.io/#/pgl_ddl_deploy"><code>pgl_ddl_deploy</code></a> <a href="https://ext.pigsty.io/#/pg_failover_slots"><code>pg_failover_slots</code></a> <a href="https://ext.pigsty.io/#/wal2json"><code>wal2json</code></a> <a href="https://ext.pigsty.io/#/wal2mongo"><code>wal2mongo</code></a> <a href="https://ext.pigsty.io/#/decoderbufs"><code>decoderbufs</code></a> <a href="https://ext.pigsty.io/#/decoder_raw"><code>decoder_raw</code></a> <a href="https://ext.pigsty.io/#/test_decoding"><code>test_decoding</code></a> <a href="https://ext.pigsty.io/#/mimeo"><code>mimeo</code></a> <a href="https://ext.pigsty.io/#/repmgr"><code>repmgr</code></a> <a href="https://ext.pigsty.io/#/pg_fact_loader"><code>pg_fact_loader</code></a> <a href="https://ext.pigsty.io/#/pg_bulkload"><code>pg_bulkload</code></a></p>
<p>Since most of the supabase maintained extensions are not available in the official PGDG repo,
we have compiled all the RPM/DEBs for these extensions and put them in the <a href="https://ext.pigsty.io">Pigsty repo</a>:
<a href="https://ext.pigsty.io/#/pg_graphql">pg_graphql</a>, <a href="https://ext.pigsty.io/#/pg_jsonschema">pg_jsonschema</a>, <a href="https://ext.pigsty.io/#/wrappers">wrappers</a>, <a href="https://ext.pigsty.io/#/index_advisor">index_advisor</a>, <a href="https://ext.pigsty.io/#/pg_net">pg_net</a>, <a href="https://ext.pigsty.io/#/vault">vault</a>, <a href="https://ext.pigsty.io/#/pgjwt">pgjwt</a>, <a href="https://ext.pigsty.io/#/supautils">supautils</a>, <a href="https://ext.pigsty.io/#/plan_filter">pg_plan_filter</a>,</p>
<p>Everything is under your control, you have the ability and freedom to scale PGSQL, MinIO, and Supabase itself.
And take full advantage of the performance and cost advantages of modern hardware like Gen5 NVMe SSD.</p>
<p>All you need is prepare a VM with several commands and wait for 10 minutes&hellip;.</p>
<hr>
<h2 id="get-started">Get Started</h2>
<p>First, download &amp; <a href="/docs/setup/install/">install</a> pigsty as usual, with the <code>supa</code> config template:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> curl -fsSL https://repo.pigsty.io/get <span style="color:#000;font-weight:bold">|</span> bash
</span></span><span style="display:flex;"><span>./bootstrap          <span style="color:#8f5902;font-style:italic"># install deps (ansible)</span>
</span></span><span style="display:flex;"><span>./configure -c supa  <span style="color:#8f5902;font-style:italic"># use supa config template (IMPORTANT: CHANGE PASSWORDS!)</span>
</span></span><span style="display:flex;"><span>./install.yml        <span style="color:#8f5902;font-style:italic"># install pigsty, create ha postgres &amp; minio clusters </span>
</span></span></code></pre></div><blockquote>
<p>Please change the <code>pigsty.yml</code> config file according to your need before deploying Supabase. (<strong>Credentials</strong>)
For dev/test/demo purposes, we will just skip that, and comes back later.</p>
</blockquote>
<p>Then, run the <a href="https://github.com/Vonng/pigsty/blob/main/supabase.yml"><code>supabase.yml</code></a> to launch stateless part of supabase.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./supabase.yml       <span style="color:#8f5902;font-style:italic"># launch stateless supabase containers with docker compose</span>
</span></span></code></pre></div><p>You can access the supabase API / Web UI through the <code>8000/8443</code> directly.</p>
<p>with configured DNS, or a local <code>/etc/hosts</code> entry, you can also use the default <code>supa.pigsty</code> domain name via the 80/443 infra portal.</p>
<blockquote>
<p>Credentials for Supabase Studio: <code>supabase</code> : <code>pigsty</code></p>
</blockquote>
<p><a href="https://asciinema.org/a/692194"><img alt="asciicast" src="https://asciinema.org/a/692194.svg"></a></p>
<hr>
<h2 id="architecture">Architecture</h2>
<p>Pigsty&rsquo;s supabase is based on the <a href="https://supabase.com/docs/guides/self-hosting/docker">Supabase Docker Compose Template</a>,
with some slight modifications to fit-in Pigsty&rsquo;s default <a href="/docs/pgsql/acl/">ACL</a> model.</p>
<p>The stateful part of this template is replaced by Pigsty&rsquo;s managed PostgreSQL cluster and MinIO cluster.
The container part are stateless, so you can launch / destroy / run multiple supabase containers on the same stateful PGSQL / MINIO cluster simultaneously to scale out.</p>
<p><img src="/img/pigsty/supa-arch.svg"></p>
<p>The built-in <a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml"><code>supa.yml</code></a> <a href="/docs/config/supa">config</a> template will create a single-node supabase, with a <a href="/docs/pgsql/">singleton PostgreSQL</a> and SNSD <a href="/docs/minio/">MinIO</a> server.
You can use <a href="/docs/pgsql/config/#replica">Multinode PostgreSQL Clusters</a> and <a href="/docs/minio/config/#multi-node-multi-drive">MNMD MinIO Clusters</a> / external S3 service instead in production, we will cover that later.</p>
<hr>
<h2 id="config-detail">Config Detail</h2>
<p>Here are checklists for self-hosting</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> <a href="/docs/setup/prepare/#node"><strong>Hardware</strong></a>: necessary VM/BM resources, one node at least, 3-4 are recommended for HA.</li>
<li><input checked="" disabled="" type="checkbox"> <a href="/docs/setup/prepare/#operating-system"><strong>Linux OS</strong></a>: Linux x86_64 server with fresh installed Linux, <a href="/docs/reference/compatibility/">check compatible distro</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="/docs/setup/prepare/#network"><strong>Network</strong></a>: Static IPv4 address which can be used as node identity</li>
<li><input checked="" disabled="" type="checkbox"> <a href="/docs/setup/prepare/#admin-user"><strong>Admin User</strong></a>: nopass ssh &amp; sudo are recommended for admin user</li>
<li><input checked="" disabled="" type="checkbox"> <a href="/docs/setup/config/"><strong>Conf Template</strong></a>: Use the <a href="/docs/conf/supa/"><code>supa</code></a> config template, if you don&rsquo;t know how to manually configure pigsty</li>
</ul>
<p>The built-in <a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml"><code>supa.yml</code></a> config template is shown below.</p>
<br>
<details><summary>The supa Config Template</summary>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">children</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># infra cluster for proxy, monitor, alert, etc..</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">infra</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">infra_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># etcd cluster for ha postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">etcd</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq: 1 } }, vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">etcd } }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># minio cluster, s3 compatible object storage</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">minio_seq: 1 } }, vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">minio_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio } }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># pg-meta, the underlying postgres database for supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg-meta</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">primary } }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-meta</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># supabase roles: anon, authenticated, dashboard_user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: anon           ,login</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: authenticated  ,login</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dashboard_user ,login: false ,replication: true ,createdb: true ,createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: service_role   ,login: false ,bypassrls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># supabase users: please use the same password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_admin             ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: true   ,roles: [ dbrole_admin ] ,superuser: true ,replication: true ,createdb: true ,createrole: true ,bypassrls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: authenticator              ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: false  ,roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_admin, authenticated ,anon ,service_role ] }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_auth_admin        ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: false  ,roles: [ dbrole_admin ] ,createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_storage_admin     ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: false  ,roles: [ dbrole_admin, authenticated ,anon ,service_role ] ,createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_functions_admin   ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: false  ,roles: [ dbrole_admin ] ,createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_replication_admin ,password: &#39;DBUser.Supa&#39; ,replication: true ,roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_admin ]}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_read_only_user    ,password: &#39;DBUser.Supa&#39; ,bypassrls: true ,roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_readonly, pg_read_all_data ] }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">baseline</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase.sql</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">owner</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase postgres database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">extensions ,auth ,realtime ,storage ,graphql_public ,supabase_functions ,_analytics ,_realtime ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgcrypto  ,schema: extensions  } # 1.3   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cryptographic functions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_net    ,schema: extensions  } # 0.9.2 </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">async HTTP</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgjwt     ,schema: extensions  } # 0.2.0 </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json web token API for postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: uuid-ossp ,schema: extensions  } # 1.1   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">generate universally unique identifiers (UUIDs)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgsodium        }                # 3.1.9 </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsodium is a modern cryptography library for Postgres.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_vault  }                # 0.2.8 </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Supabase Vault Extension</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_graphql      }                # 1.5.9 : pg_graphql</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">GraphQL support</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_jsonschema   }                # 0.3.3 : pg_jsonschema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Validate json schema</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: wrappers        }                # 0.4.3 : wrappers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FDW collections</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: http            }                # 1.6   : http</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allows web page retrieval inside the database.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_cron         }                # 1.6   : pg_cron</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Job scheduler for PostgreSQL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: timescaledb     }                # 2.17  : timescaledb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Enables scalable inserts and complex queries for time-series data</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_tle          }                # 1.2   : pg_tle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Trusted Language Extensions for PostgreSQL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: vector          }                # 0.8.0 : pgvector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">the vector similarity search</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># supabase required extensions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_libs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pg_stat_statements, plpgsql, plpgsql_check, pg_cron, pg_net, timescaledb, auto_explain, pg_tle, plan_filter&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># extensions to be installed on this cluster</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">supabase  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># essential extensions for supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">timescaledb postgis pg_graphql pg_jsonschema wrappers pg_search pg_analytics pg_parquet plv8 duckdb_fdw pg_cron pg_timetable pgqr</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">supautils pg_plan_filter passwordcheck plpgsql_check pgaudit pgsodium pg_vault pgjwt pg_ecdsa pg_session_jwt index_advisor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">pgvector pgvectorscale pg_summarize pg_tiktoken pg_tle pg_stat_monitor hypopg pg_hint_plan pg_http pg_net pg_smtp_client pg_idkit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">cron.database_name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">pgsodium.enable_event_trigger</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">off</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># supabase hba rules, require access from docker network</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">user: all ,db: postgres  ,addr: intra         ,auth: pwd ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow supabase access from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">user: all ,db: postgres  ,addr: 172.17.0.0/16 ,auth: pwd ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow access from local docker network&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">node_crontab</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># make a full backup every 1am</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># launch supabase stateless part with docker compose: ./supabase.yml</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">supabase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">supa_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># instance id</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supa           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># cluster name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">docker_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># enable docker</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># use these to pull docker images via proxy and mirror registries</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">#docker_registry_mirrors: [&#39;https://docker.xxxxx.io&#39;]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">#proxy_env:   # add [OPTIONAL] proxy env to /etc/docker/daemon.json configuration file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">#  no_proxy: &#34;localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16,*.pigsty,*.aliyun.com,mirrors.*,*.myqcloud.com,*.tsinghua.edu.cn&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">#  #all_proxy: http://user:pass@host:port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># these configuration entries will OVERWRITE or APPEND to /opt/supabase/.env file (src template: app/supabase/.env)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># check https://github.com/Vonng/pigsty/blob/main/app/supabase/.env for default values</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_config</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># IMPORTANT: CHANGE JWT_SECRET AND REGENERATE CREDENTIAL ACCORDING!!!!!!!!!!!</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># https://supabase.com/docs/guides/self-hosting/docker#securing-your-services</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">jwt_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">your-super-secret-jwt-token-with-at-least-32-characters-long</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">anon_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyAgCiAgICAicm9sZSI6ICJhbm9uIiwKICAgICJpc3MiOiAic3VwYWJhc2UtZGVtbyIsCiAgICAiaWF0IjogMTY0MTc2OTIwMCwKICAgICJleHAiOiAxNzk5NTM1NjAwCn0.dc_X5iR_VP_qT0zsiyj_I_OZ2T9FtRU2BBNWN8Bu4GE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">service_role_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyAgCiAgICAicm9sZSI6ICJzZXJ2aWNlX3JvbGUiLAogICAgImlzcyI6ICJzdXBhYmFzZS1kZW1vIiwKICAgICJpYXQiOiAxNjQxNzY5MjAwLAogICAgImV4cCI6IDE3OTk1MzU2MDAKfQ.DaYlNEoUrrEn2Ig7tqibS-PHK5vgusbcbo7X36XVt4Q</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">dashboard_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">dashboard_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># postgres connection string (use the correct ip and port)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5436</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># access via the &#39;default&#39; service, which always route to the primary postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_db</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Supa </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># password for supabase_admin and multiple supabase users</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># expose supabase via domain name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">site_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">api_external_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">supabase_public_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># if using s3/minio as file storage</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supa</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://sss.pigsty:9000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_access_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_secret_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">S3User.Supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_force_path_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_protocol</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">stub</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">minio_domain_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.10</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># sss.pigsty domain name will resolve to this ip statically</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># if using SMTP (optional)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_admin_email: admin@example.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_host: supabase-mail</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_port: 2500</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_user: fake_mail_user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_pass: fake_mail_password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_sender_name: fake_sender</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#enable_anonymous_users: false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v3.1.0                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pigsty version string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">admin_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.10</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># admin node ip address</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">region: default                   # upstream mirror region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default|china|europe</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">node_tune: oltp                   # node tuning specs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">oltp,olap,tiny,crit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_conf: oltp.yml                 # pgsql tuning specs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#000">oltp,olap,tiny,crit}.yml</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">infra_portal</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># domain names and upstream servers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">home         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">h.pigsty }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">grafana      </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: g.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3000&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">prometheus   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: p.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9090&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">alertmanager </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: a.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9093&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">minio        </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: m.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;10.10.10.10:9001&#34;</span><span style="color:#204a87;font-weight:bold">, https: true, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">blackbox     </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9115&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">loki         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3100&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># expose supa studio UI and API via nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">supa         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: supa.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;10.10.10.10:8000&#34;</span><span style="color:#204a87;font-weight:bold">, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#----------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Credential: CHANGE THESE PASSWORDS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#----------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#grafana_admin_username: admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">grafana_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#pg_admin_username: dbuser_dba</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.DBA</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#pg_monitor_username: dbuser_monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_monitor_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#pg_replication_username: replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_replication_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#patroni_username: postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">patroni_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Patroni.API</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#haproxy_admin_username: admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">haproxy_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># use minio as supabase file storage, single node single driver mode for demonstration purpose</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_access_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minioadmin     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># root access key, `minioadmin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_secret_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minioadmin     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># root secret key, `minioadmin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_buckets</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql }, { name: supa } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: dba , secret_key: S3User.DBA, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consoleAdmin }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: pgbackrest , secret_key: S3User.Backup,   policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: supabase   , secret_key: S3User.Supabase, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://sss.pigsty:9000   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># explicit overwrite minio endpoint with haproxy port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">node_etc_hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;10.10.10.10 sss.pigsty&#34;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># domain name to access minio from all nodes (required)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># use minio as default backup repo for PostgreSQL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbackrest_method: minio          # pgbackrest repo method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local,minio,[user-defined...]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbackrest_repo:                  # pgbackrest repo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://pgbackrest.org/configuration.html#section-repository</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">local</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># default pgbackrest repo with local posix fs</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/backup             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># local backup directory, `/pg/backup` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">count   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backups by count</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># keep 2, at most 3 full backup when using local fs repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># optional minio repo for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio is s3-compatible, so s3 is used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss.pigsty      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio endpoint domain name, `sss.pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio region, us-east-1 by default, useless for minio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio bucket name, `pgsql` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbackrest           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio user access key for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_key_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">S3User.Backup </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio user secret key for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_uri_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># use path style uri for minio rather than host style</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pgbackrest            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio backup path, default is `/pgbackrest`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">storage_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9000</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio port, 9000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">storage_ca_file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/cert/ca.crt </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio ca file path, `/pg/cert/ca.crt` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">bundle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">y</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># bundle small files into a single file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">cipher_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aes-256-cbc     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># enable AES encryption for remote backup repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">cipher_pass</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgBackRest      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># AES encryption password, default is &#39;pgBackRest&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">time    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backup by time on minio repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">14</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># keep full backup for last 14 days</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># download docker and supabase related extensions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">17</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repo_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node,pgsql,infra,docker</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repo_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">node-bootstrap, infra-package, infra-addons, node-package1, node-package2, pgsql-utility, docker ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repo_extra_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">pgsql-main</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">supabase  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># essential extensions for supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">timescaledb postgis pg_graphql pg_jsonschema wrappers pg_search pg_analytics pg_parquet plv8 duckdb_fdw pg_cron pg_timetable pgqr</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">supautils pg_plan_filter passwordcheck plpgsql_check pgaudit pgsodium pg_vault pgjwt pg_ecdsa pg_session_jwt index_advisor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">pgvector pgvectorscale pg_summarize pg_tiktoken pg_tle pg_stat_monitor hypopg pg_hint_plan pg_http pg_net pg_smtp_client pg_idkit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></details>
<br>
<p>For advanced topics, we may need to modify the configuration file to fit our needs.</p>
<ul>
<li><a href="/blog/db/supabase/#security-enhancement">Security Enhancement</a></li>
<li><a href="/blog/db/supabase/#domain-name-and-https">Domain Name and HTTPS</a></li>
<li><a href="/blog/db/supabase/#sending-mail-with-smtp">Sending Mail with SMTP</a></li>
<li><a href="/blog/db/supabase/#minio-or-external-s3">MinIO or External S3</a></li>
<li><a href="/blog/db/supabase/#true-high-availability">True High Availability</a></li>
</ul>
<hr>
<h2 id="security-enhancement">Security Enhancement</h2>
<p>For security reasons, you should change the default passwords in the <code>pigsty.yml</code> config file.</p>
<ul>
<li><a href="/docs/reference/param/#grafana_admin_password"><code>grafana_admin_password</code></a>: <code>pigsty</code>, Grafana admin password</li>
<li><a href="/docs/reference/param/#pg_admin_password"><code>pg_admin_password</code></a>: <code>DBUser.DBA</code>, PGSQL superuser password</li>
<li><a href="/docs/reference/param/#pg_monitor_password"><code>pg_monitor_password</code></a>: <code>DBUser.Monitor</code>, PGSQL monitor user password</li>
<li><a href="/docs/reference/param/#pg_replication_password"><code>pg_replication_password</code></a>: <code>DBUser.Replicator</code>, PGSQL replication user password</li>
<li><a href="/docs/reference/param/#patroni_password"><code>patroni_password</code></a>: <code>Patroni.API</code>, Patroni HA Agent Password</li>
<li><a href="/docs/reference/param/#haproxy_admin_password"><code>haproxy_admin_password</code></a>: <code>pigsty</code>, Load balancer admin password</li>
<li><a href="/docs/minio/param/#grafana_admin_password"><code>minio_access_key</code></a>: <code>minioadmin</code>, MinIO root username</li>
<li><a href="/docs/minio/param/#minio_secret_key"><code>minio_secret_key</code></a>: <code>minioadmin</code>, MinIO root password</li>
</ul>
<p>Supabase will use PostgreSQL &amp; MinIO as its backend, so also change the following passwords for supabase business users:</p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#L49"><code>pg_users</code></a>: password for supabase business users in postgres</li>
<li><a href="/docs/minio/param/#minio_secret_key"><code>minio_users</code></a>: <code>minioadmin</code>, MinIO business user&rsquo;s password</li>
</ul>
<p>The pgbackrest will take backups and WALs to MinIO, so also change the following passwords reference</p>
<ul>
<li><a href="/docs/minio/param/#pgbackrest_repo"><code>pgbackrest_repo</code></a>: refer to the</li>
</ul>
<p>PLEASE check the <a href="https://supabase.com/docs/guides/self-hosting/docker#generate-api-keys">Supabase Self-Hosting: Generate API Keys</a> to generate supabase credentials:</p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#L114"><code>jwt_secret</code></a>: a secret key with at least 40 characters</li>
<li><a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#L115"><code>anon_key</code></a>: a jwt token generate for anonymous users, based on <code>jwt_secret</code></li>
<li><a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#L116"><code>service_role_key</code></a>: a jwt token generate for elevated service roles, based on <code>jwt_secret</code></li>
<li><a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#L117"><code>dashboard_username</code></a>: supabase studio web portal username, <code>supabase</code> by default</li>
<li><a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#L128"><code>dashboard_password</code></a>: supabase studio web portal password, <code>pigsty</code> by default</li>
</ul>
<p>If you have chanaged the default password for PostgreSQL and MinIO, you have to update the following parameters as well:</p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#L126"><code>postgres_password</code></a>, according to <a href="/docs/pgsql/user/"><code>pg_users</code></a></li>
<li><a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#136"><code>s3_access_key</code></a> and <a href="https://github.com/Vonng/pigsty/blob/main/conf/supa.yml#137"><code>s3_secret_key</code></a>, according to <a href="/docs/minio/param/#minio_users"><code>minio_users</code></a></li>
</ul>
<hr>
<h2 id="domain-name-and-https">Domain Name and HTTPS</h2>
<p>For local or intranet use, you can connect directly to Kong port on <code>http://&lt;IP&gt;:8000</code> or <code>8443</code> for https.
This works but isn’t ideal. Using a domain with HTTPS is strongly recommended when serving Supabase to the public.</p>
<p>Pigsty has a Nginx server installed &amp; configured on the admin node to act as a reverse proxy for all web based service. which is configured via the <code>infra_portal</code> parameter.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#8f5902;font-style:italic"># global vars</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#.....</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">infra_portal</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># domain names and upstream servers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">home         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">h.pigsty }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">grafana      </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: g.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3000&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">prometheus   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: p.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9090&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">alertmanager </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: a.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9093&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">minio        </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: m.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;10.10.10.10:9001&#34;</span><span style="color:#204a87;font-weight:bold">, https: true, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">blackbox     </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9115&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">loki         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3100&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># expose supa studio UI and API via nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">supa         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: supa.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;10.10.10.10:8000&#34;</span><span style="color:#204a87;font-weight:bold">, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>On the client side, you can use the domain <code>supa.pigsty</code> to access the Supabase Studio management interface.
You can add this domain to your local <code>/etc/hosts</code> file or use a local DNS server to resolve it to the server&rsquo;s <strong>external</strong> IP address.</p>
<p>To use a real domain with HTTPS, you will need to modify the <code>all.vars.infra_portal.supa</code> with updated domain name (such as <code>supa.pigsty.cc</code> here).
You can obtain a free HTTPS certificate from <a href="https://letsencrypt.org/">Let’s Encrypt</a>, and just put the cert/key files in the specified path.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#supa : { domain: supa.pigsty ,endpoint: &#34;10.10.10.10:8000&#34;, websocket: true }  # add your HTTPS certs/keys and specify the path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">supa  </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: supa.pigsty.cc ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;10.10.10.10:8000&#34;</span><span style="color:#204a87;font-weight:bold">, websocket: true ,cert: /etc/cert/suap.pigsty.cc.crt ,key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/etc/cert/supa.pigsty.cc.key }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>To reload the new configuration after installation, use the <code>infra.yml</code> playbook:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./infra.yml -t nginx_config,nginx_launch   <span style="color:#8f5902;font-style:italic"># reload nginx config</span>
</span></span></code></pre></div><p>You also have to update the <code>all.children.supabase.vars.supa_config</code> to tell supabase to use the new domain name:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">children</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># clusters</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">supabase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># supabase group</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># supabase param</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_config</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># supabase config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># update supabase domain names here</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">site_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty.cc</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">api_external_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty.cc</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">supabase_public_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty.cc</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>And reload the supabase service to apply the new configuration:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./supabase.yml -t supa_config,supa_launch <span style="color:#8f5902;font-style:italic"># reload supabase config</span>
</span></span></code></pre></div><hr>
<h2 id="sending-mail-with-smtp">Sending Mail with SMTP</h2>
<p>Some Supabase features require email. For production use, I&rsquo;d recommend using an external SMTP service.
Since self-hosted SMTP servers often result in rejected or spam-flagged emails.</p>
<p>To do this, modify the Supabase configuration and add SMTP credentials:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">children</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">supabase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_config</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">smtp_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">smtpdm.aliyun.com:80</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">smtp_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">80</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">smtp_user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">no_reply@mail.your.domain.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">smtp_pass</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">your_email_user_password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">smtp_sender_name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">MySupabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">smtp_admin_email</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">adminxxx@mail.your.domain.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">enable_anonymous_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>And don&rsquo;t forget to reload the supabase service with <code>./supabase.yml -t supa_config,supa_launch</code></p>
<hr>
<h2 id="minio-or-external-s3">MinIO or External S3</h2>
<p>Pigsty&rsquo;s self-hosting supabase will use a local <a href="/docs/minio/config/#single-node-single-drive">SNSD MinIO</a> server,
which is used by Supabase itself for object storage, and by PostgreSQL for backups.
For production use, you should consider using a HA <a href="/docs/minio/config/#multi-node-multi-drive">MNMD MinIO</a> cluster or an external S3 compatible service instead.</p>
<p>We recommend using an external S3 when:</p>
<ul>
<li>you just have one single server available, then external s3 gives you a minimal disaster recovery guarantee, with RTO in hours and RPO in MBs.</li>
<li>you are operating in the cloud, then using S3 directly is recommended rather than wrap expensively EBS with MinIO</li>
</ul>
<blockquote>
<p>The <a href="https://github.com/Vonng/pigsty/blob/main/terraform/spec/aliyun-meta-s3.tf"><code>terraform/spec/aliyun-meta-s3.tf</code></a> provides an example of how to provision a single node alone with an S3 bucket.</p>
</blockquote>
<p>To use an external S3 compatible service, you&rsquo;ll have to update two related references in the <code>pigsty.yml</code> config.</p>
<p>For example, to use Aliyun OSS as the object storage for Supabase, you can modify the <code>all.children.supabase.vars.supa_config</code> to point to the Aliyun OSS bucket:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">children</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">supabase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_config</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty-oss</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://oss-cn-beijing-internal.aliyuncs.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_access_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">xxxxxxxxxxxxxxxx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_secret_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">xxxxxxxxxxxxxxxx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_force_path_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_protocol</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">oss-cn-beijing</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Reload the supabase service with <code>./supabase.yml -t supa_config,supa_launch</code> again.</p>
<p>The next reference is in the PostgreSQL backup repo:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># use minio as default backup repo for PostgreSQL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbackrest_method: minio          # pgbackrest repo method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local,minio,[user-defined...]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbackrest_repo:                  # pgbackrest repo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://pgbackrest.org/configuration.html#section-repository</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">local</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># default pgbackrest repo with local posix fs</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/backup             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># local backup directory, `/pg/backup` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">count   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backups by count</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># keep 2, at most 3 full backup when using local fs repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># optional minio repo for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio is s3-compatible, so s3 is used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># update your credentials here</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">oss-cn-beijing-internal.aliyuncs.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">oss-cn-beijing</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty-oss</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">xxxxxxxxxxxxxx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_key_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">xxxxxxxx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_uri_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">host</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pgbackrest            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio backup path, default is `/pgbackrest`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">storage_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9000</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio port, 9000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">storage_ca_file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/cert/ca.crt </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio ca file path, `/pg/cert/ca.crt` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">bundle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">y</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># bundle small files into a single file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">cipher_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aes-256-cbc     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># enable AES encryption for remote backup repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">cipher_pass</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgBackRest      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># AES encryption password, default is &#39;pgBackRest&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">time    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backup by time on minio repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">14</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># keep full backup for last 14 days</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>After updating the <code>pgbackrest_repo</code>, you can reset the pgBackrest backup with <code>./pgsql.yml -t pgbackrest</code>.</p>
<hr>
<h2 id="true-high-availability">True High Availability</h2>
<p>The default single-node deployment (with external S3) provide a minimal disaster recovery guarantee, with RTO in hours and RPO in MBs.</p>
<p>To achieve RTO &lt; 30s and zero data loss, you need a multi-node high availability cluster with at least 3-nodes.</p>
<p>Which involves high availability for these components:</p>
<ul>
<li><a href="/docs/etcd/">ETCD</a>: DCS requires at least three nodes to tolerate one node failure.</li>
<li><a href="/docs/pgsql/">PGSQL</a>: PGSQL synchronous commit mode recommends at least three nodes.</li>
<li><a href="/docs/infra/">INFRA</a>: It&rsquo;s good to have two or three copies of observability stack.</li>
<li>Supabase itself can also have multiple replicas to achieve high availability.</li>
</ul>
<p>We recommend you to refer to the <a href="/docs/conf/trio/">trio</a> and <a href="/docs/conf/safe/">safe</a> config to upgrade your cluster to three nodes or more.</p>
<p>In this case, you also need to modify the access points for PostgreSQL and MinIO to use the DNS / L2 VIP / HAProxy <a href="/docs/concept/svc/">HA access points</a>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">children</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">supabase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">supa_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">supa_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">supa_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> 
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supa           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># cluster name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_config</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.2</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># use the PG L2 VIP</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5433</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># use the 5433 port to access the primary instance through pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://sss.pigsty:9002 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># If you are using MinIO through the haproxy lb port 9002</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">minio_domain_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.3</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># use the L2 VIP binds to all proxy nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><details><summary>The 3-Node HA Supabase Config Template</summary>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic">#==============================================================#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Clusters, Nodes, and Modules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic">#==============================================================#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">children</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># infra cluster for proxy, monitor, alert, etc..</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">infra</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">infra_seq: 1 ,nodename</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">infra-1 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">infra_seq: 2 ,nodename: infra-2, repo_enabled: false, grafana_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">infra_seq: 3 ,nodename: infra-3, repo_enabled: false, grafana_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">vip_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">vip_vrid</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">128</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">vip_address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">haproxy_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># [REQUIRED] service name, unique</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9002</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># [REQUIRED] service port, unique</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">balance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">leastconn            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] load balancer algorithm</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># [OPTIONAL] minio health check</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- <span style="color:#000">option httpchk</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- <span style="color:#000">option http-keep-alive</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- <span style="color:#000">http-check send meth OPTIONS uri /minio/health/live</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- <span style="color:#000">http-check expect status 200</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">servers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: minio-1 ,ip: 10.10.10.10 ,port: 9000 ,options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: minio-2 ,ip: 10.10.10.11 ,port: 9000 ,options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: minio-3 ,ip: 10.10.10.12 ,port: 9000 ,options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">etcd</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dcs service for postgres/patroni ha consensus</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 1 node for testing, 3 or 5 for production</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># etcd_seq required</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># assign from 1 ~ n</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">etcd_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># odd number please</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># cluster level parameter override roles/etcd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">etcd_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">etcd </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># mark etcd cluster name etcd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">etcd_safeguard</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># safeguard against purging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">etcd_clean</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># purge etcd during init process</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># minio cluster 4-node</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">minio_seq: 1 , nodename</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio-1 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">minio_seq: 2 , nodename</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio-2 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">minio_seq: 3 , nodename</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio-3 }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">minio_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">minio_data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;/data{1...4}&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">minio_buckets</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql }, { name: supa } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">minio_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: dba , secret_key: S3User.DBA, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consoleAdmin }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: pgbackrest , secret_key: S3User.Backup,   policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: supabase   , secret_key: S3User.Supabase, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># pg-meta, the underlying postgres database for supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg-meta</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">primary }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 2, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 3, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-meta</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># supabase roles: anon, authenticated, dashboard_user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: anon           ,login</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: authenticated  ,login</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dashboard_user ,login: false ,replication: true ,createdb: true ,createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: service_role   ,login: false ,bypassrls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># supabase users: please use the same password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_admin             ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: true   ,roles: [ dbrole_admin ] ,superuser: true ,replication: true ,createdb: true ,createrole: true ,bypassrls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: authenticator              ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: false  ,roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_admin, authenticated ,anon ,service_role ] }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_auth_admin        ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: false  ,roles: [ dbrole_admin ] ,createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_storage_admin     ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: false  ,roles: [ dbrole_admin, authenticated ,anon ,service_role ] ,createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_functions_admin   ,password: &#39;DBUser.Supa&#39; ,pgbouncer: true ,inherit: false  ,roles: [ dbrole_admin ] ,createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_replication_admin ,password: &#39;DBUser.Supa&#39; ,replication: true ,roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_admin ]}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_read_only_user    ,password: &#39;DBUser.Supa&#39; ,bypassrls: true ,roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_readonly, pg_read_all_data ] }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">baseline</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase.sql</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">owner</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase postgres database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">extensions ,auth ,realtime ,storage ,graphql_public ,supabase_functions ,_analytics ,_realtime ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgcrypto  ,schema: extensions  } # 1.3   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cryptographic functions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_net    ,schema: extensions  } # 0.9.2 </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">async HTTP</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgjwt     ,schema: extensions  } # 0.2.0 </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json web token API for postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: uuid-ossp ,schema: extensions  } # 1.1   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">generate universally unique identifiers (UUIDs)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgsodium        }                # 3.1.9 </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsodium is a modern cryptography library for Postgres.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: supabase_vault  }                # 0.2.8 </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Supabase Vault Extension</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_graphql      }                # 1.5.9 : pg_graphql</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">GraphQL support</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_jsonschema   }                # 0.3.3 : pg_jsonschema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Validate json schema</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: wrappers        }                # 0.4.3 : wrappers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FDW collections</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: http            }                # 1.6   : http</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allows web page retrieval inside the database.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_cron         }                # 1.6   : pg_cron</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Job scheduler for PostgreSQL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: timescaledb     }                # 2.17  : timescaledb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Enables scalable inserts and complex queries for time-series data</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_tle          }                # 1.2   : pg_tle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Trusted Language Extensions for PostgreSQL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: vector          }                # 0.8.0 : pgvector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">the vector similarity search</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># supabase required extensions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_libs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pg_stat_statements, plpgsql, plpgsql_check, pg_cron, pg_net, timescaledb, auto_explain, pg_tle, plan_filter&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># extensions to be installed on this cluster</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">supabase  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># essential extensions for supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">timescaledb postgis pg_graphql pg_jsonschema wrappers pg_search pg_analytics pg_parquet plv8 duckdb_fdw pg_cron pg_timetable pgqr</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">supautils pg_plan_filter passwordcheck plpgsql_check pgaudit pgsodium pg_vault pgjwt pg_ecdsa pg_session_jwt index_advisor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">pgvector pgvectorscale pg_summarize pg_tiktoken pg_tle pg_stat_monitor hypopg pg_hint_plan pg_http pg_net pg_smtp_client pg_idkit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">cron.database_name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">pgsodium.enable_event_trigger</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">off</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># supabase hba rules, require access from docker network</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">user: all ,db: postgres  ,addr: intra         ,auth: pwd ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow supabase access from intranet&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">user: all ,db: postgres  ,addr: 172.17.0.0/16 ,auth: pwd ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow access from local docker network&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_vip_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_vip_address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.2</span><span style="color:#000">/24</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_vip_interface</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eth1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">node_crontab</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># make a full backup every 1am</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># launch supabase stateless part with docker compose: ./supabase.yml</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">supabase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">supa_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># instance 1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.11</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">supa_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># instance 2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">10.10.10.12</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">supa_seq</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># instance 3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supa           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># cluster name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">docker_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># enable docker</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># use these to pull docker images via proxy and mirror registries</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">#docker_registry_mirrors: [&#39;https://docker.xxxxx.io&#39;]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">#proxy_env:   # add [OPTIONAL] proxy env to /etc/docker/daemon.json configuration file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">#  no_proxy: &#34;localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16,*.pigsty,*.aliyun.com,mirrors.*,*.myqcloud.com,*.tsinghua.edu.cn&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic">#  #all_proxy: http://user:pass@host:port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># these configuration entries will OVERWRITE or APPEND to /opt/supabase/.env file (src template: app/supabase/.env)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># check https://github.com/Vonng/pigsty/blob/main/app/supabase/.env for default values</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">supa_config</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># IMPORTANT: CHANGE JWT_SECRET AND REGENERATE CREDENTIAL ACCORDING!!!!!!!!!!!</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># https://supabase.com/docs/guides/self-hosting/docker#securing-your-services</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">jwt_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">your-super-secret-jwt-token-with-at-least-32-characters-long</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">anon_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyAgCiAgICAicm9sZSI6ICJhbm9uIiwKICAgICJpc3MiOiAic3VwYWJhc2UtZGVtbyIsCiAgICAiaWF0IjogMTY0MTc2OTIwMCwKICAgICJleHAiOiAxNzk5NTM1NjAwCn0.dc_X5iR_VP_qT0zsiyj_I_OZ2T9FtRU2BBNWN8Bu4GE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">service_role_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyAgCiAgICAicm9sZSI6ICJzZXJ2aWNlX3JvbGUiLAogICAgImlzcyI6ICJzdXBhYmFzZS1kZW1vIiwKICAgICJpYXQiOiAxNjQxNzY5MjAwLAogICAgImV4cCI6IDE3OTk1MzU2MDAKfQ.DaYlNEoUrrEn2Ig7tqibS-PHK5vgusbcbo7X36XVt4Q</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">dashboard_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">dashboard_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># postgres connection string (use the correct ip and port)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.3</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># use the pg_vip_address rather than single node ip</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5433</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># access via the &#39;default&#39; service, which always route to the primary postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_db</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">postgres_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Supa </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># password for supabase_admin and multiple supabase users</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># expose supabase via domain name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">site_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">api_external_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">supabase_public_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://supa.pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># if using s3/minio as file storage</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supa</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://sss.pigsty:9002</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_access_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_secret_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">S3User.Supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_force_path_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_protocol</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">stub</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">minio_domain_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.3</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># sss.pigsty domain name will resolve to this l2 vip that bind to all nodes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># if using SMTP (optional)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_admin_email: admin@example.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_host: supabase-mail</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_port: 2500</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_user: fake_mail_user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_pass: fake_mail_password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#smtp_sender_name: fake_sender</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic">#enable_anonymous_users: false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic">#==============================================================#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Global Parameters</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic">#==============================================================#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v3.1.0                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># pigsty version string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">admin_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">10.10.10.10</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># admin node ip address</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">region: china                     # upstream mirror region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default|china|europe</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">node_tune: oltp                   # node tuning specs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">oltp,olap,tiny,crit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_conf: oltp.yml                 # pgsql tuning specs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#000">oltp,olap,tiny,crit}.yml</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">infra_portal</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># domain names and upstream servers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">home         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">h.pigsty }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">grafana      </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: g.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3000&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">prometheus   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: p.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9090&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">alertmanager </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: a.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9093&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">minio        </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: m.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;10.10.10.10:9001&#34;</span><span style="color:#204a87;font-weight:bold">, https: true, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">blackbox     </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9115&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">loki         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3100&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># expose supa studio UI and API via nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">supa         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: supa.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;10.10.10.10:8000&#34;</span><span style="color:#204a87;font-weight:bold">, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#----------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Credential: CHANGE THESE PASSWORDS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#----------------------------------#</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#grafana_admin_username: admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">grafana_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#pg_admin_username: dbuser_dba</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.DBA</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#pg_monitor_username: dbuser_monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_monitor_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#pg_replication_username: replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_replication_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#patroni_username: postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">patroni_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Patroni.API</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#haproxy_admin_username: admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">haproxy_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># use minio as supabase file storage, single node single driver mode for demonstration purpose</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_access_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minioadmin     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># root access key, `minioadmin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_secret_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">minioadmin     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># root secret key, `minioadmin` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_buckets</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql }, { name: supa } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: dba , secret_key: S3User.DBA, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consoleAdmin }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: pgbackrest , secret_key: S3User.Backup,   policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">access_key: supabase   , secret_key: S3User.Supabase, policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">readwrite }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">minio_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://sss.pigsty:9000   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># explicit overwrite minio endpoint with haproxy port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">node_etc_hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;10.10.10.3 sss.pigsty&#34;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># domain name to access minio from all nodes (required)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># use minio as default backup repo for PostgreSQL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbackrest_method: minio          # pgbackrest repo method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local,minio,[user-defined...]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbackrest_repo:                  # pgbackrest repo</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://pgbackrest.org/configuration.html#section-repository</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">local</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># default pgbackrest repo with local posix fs</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/backup             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># local backup directory, `/pg/backup` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">count   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backups by count</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># keep 2, at most 3 full backup when using local fs repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">minio</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># optional minio repo for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio is s3-compatible, so s3 is used</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sss.pigsty      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio endpoint domain name, `sss.pigsty` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_region</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio region, us-east-1 by default, useless for minio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_bucket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsql             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio bucket name, `pgsql` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbackrest           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio user access key for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_key_secret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">S3User.Backup </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio user secret key for pgbackrest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">s3_uri_style</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">path           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># use path style uri for minio rather than host style</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pgbackrest            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio backup path, default is `/pgbackrest`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">storage_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9002</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># minio port, 9000 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">storage_ca_file</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/pg/cert/ca.crt </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># minio ca file path, `/pg/cert/ca.crt` by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">bundle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">y</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># bundle small files into a single file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">cipher_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aes-256-cbc     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># enable AES encryption for remote backup repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">cipher_pass</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgBackRest      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># AES encryption password, default is &#39;pgBackRest&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full_type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">time    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># retention full backup by time on minio repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">retention_full</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">14</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># keep full backup for last 14 days</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># download docker and supabase related extensions</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">17</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repo_modules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node,pgsql,infra,docker</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repo_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">node-bootstrap, infra-package, infra-addons, node-package1, node-package2, pgsql-utility, docker ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repo_extra_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">pgsql-main</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">supabase  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># essential extensions for supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">timescaledb postgis pg_graphql pg_jsonschema wrappers pg_search pg_analytics pg_parquet plv8 duckdb_fdw pg_cron pg_timetable pgqr</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">supautils pg_plan_filter passwordcheck plpgsql_check pgaudit pgsodium pg_vault pgjwt pg_ecdsa pg_session_jwt index_advisor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">pgvector pgvectorscale pg_summarize pg_tiktoken pg_tle pg_stat_monitor hypopg pg_hint_plan pg_http pg_net pg_smtp_client pg_idkit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></details>
<br>
<hr>
<br>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-3085215d905f9975fefe74e9dc129cba">Database in K8S: Pros &amp; Cons</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://medium.com/@fengruohang/database-in-kubernetes-is-that-a-good-idea-daf5775b5c1f">Medium</a> ｜<a href="https://mp.weixin.qq.com/s/4a8Qy4O80xqsnytC4l9lRg">Wechat</a></b> |
        
		<time datetime="2023-12-06" class="text-muted">2023-12-06</time>
        
	</div>
	<p>Whether databases should be housed in Kubernetes/Docker remains highly controversial. While Kubernetes (k8s) excels in managing stateless applications, it has fundamental drawbacks with stateful services, especially databases like PostgreSQL and MySQL.</p>
<p>In the previous article, &ldquo;<a href="/blog/db/pg-in-docker/">Databases in Docker: Good or Bad</a>,&rdquo; we discussed the pros and cons of containerizing databases. Today, let&rsquo;s delve into the trade-offs in orchestrating databases in K8S and explore why it&rsquo;s not a wise decision.</p>
<hr>
<h2 id="summary">Summary</h2>
<p>Kubernetes (k8s) is an exceptional container orchestration tool aimed at helping developers better manage a vast array of complex stateless applications. Despite its offerings like StatefulSet, PV, PVC, and LocalhostPV for supporting stateful services (i.e., databases), these features are still insufficient for running production-level databases that demand higher reliability.</p>
<p>Databases are more like &ldquo;<strong>pets</strong>&rdquo; than &ldquo;<strong>cattle</strong>&rdquo; and require careful nurturing. Treating databases as &ldquo;cattle&rdquo; in K8S essentially turns external disk/file system/storage services into new &ldquo;database pets.&rdquo; Running databases on EBS/network storage presents significant disadvantages in reliability and performance. However, using high-performance local NVMe disks will make the database bound to nodes and non-schedulable, negating the primary purpose of putting them in K8S.</p>
<p>Placing databases in K8S results in a <strong>&ldquo;lose-lose&rdquo;</strong> situation - K8S loses its simplicity in statelessness, lacking the flexibility to quickly relocate, schedule, destroy, and rebuild like purely stateless use. On the other hand, databases suffer several crucial attributes: reliability, security, performance, and complexity costs, in exchange for limited &ldquo;elasticity&rdquo; and utilization - something virtual machines can also achieve. For users outside public cloud vendors, the disadvantages far outweigh the benefits.</p>
<p>The &ldquo;<strong>cloud-native frenzy</strong>,&rdquo; exemplified by K8S, has become a distorted phenomenon: adopting k8s for the sake of k8s. Engineers add extra complexity to increase their irreplaceability, while managers fear being left behind by the industry and getting caught up in deployment races. Using tanks for tasks that could be done with bicycles, to gain experience or prove oneself, without considering if the problem needs such &ldquo;dragon-slaying&rdquo; techniques - this kind of architectural juggling will eventually lead to adverse outcomes.</p>
<p>Until the reliability and performance of the network storage surpass local storage, placing databases in K8S is an unwise choice. There are other ways to seal the complexity of database management, such as RDS and open-source RDS solutions like <a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485518&idx=1&sn=3d5f3c753facc829b2300a15df50d237&chksm=fe4b3d95c93cb4833b8e80433cff46a893f939154be60a2a24ee96598f96b32271301abfda1f&scene=21#wechat_redirect"><strong>Pigsty</strong></a>, which are based on bare Metal or bare OS. Users should make wise decisions based on their situations and needs, carefully weighing the pros and cons.</p>
<hr>
<h2 id="the-status-quo">The Status Quo</h2>
<p>K8S excels in orchestrating stateless application services but was initially limited to stateful services. Despite not being the intended purpose of K8S and Docker, the community&rsquo;s zeal for expansion has been unstoppable. Evangelists depict K8S as the next-generation cloud operating system, asserting that databases will inevitably become regular applications within Kubernetes. Various abstractions have emerged to support stateful services: StatefulSet, PV, PVC, and LocalhostPV.</p>
<p>Countless cloud-native enthusiasts have attempted to migrate existing databases into K8S, resulting in a proliferation of CRDs and Operators for databases. Taking PostgreSQL as an example, there are already more than ten different K8S deployment solutions available: PGO, StackGres, CloudNativePG, PostgresOperator, PerconaOperator, CYBERTEC-pg-operator, TemboOperator,  Kubegres, KubeDB, KubeBlocks, and so on. The CNCF landscape rapidly expands, turning into a playground of complexity.</p>
<p>However, complexity is a cost. With &ldquo;cost reduction&rdquo; becoming mainstream, voices of reflection have begun to emerge. Could-Exit Pioneers like DHH, who deeply utilized K8S in public clouds, abandoned it due to its excessive complexity during the transition to <a href="https://mp.weixin.qq.com/s/CicctyvV1xk5B-AsKfzPjw">self-hosted open-source solutions</a>, relying only on Docker and a Ruby tool named Kamal as alternatives. Many began to question whether stateful services like databases suit Kubernetes.</p>
<p>K8S itself, in its effort to support stateful applications, has become increasingly complex, straying from its original intention as a container orchestration platform. Tim Hockin, a co-founder of Kubernetes, also voiced his rare concerns at this year&rsquo;s KubeCon in <a href="https://mp.weixin.qq.com/s/9Q9kze9D2LT0-G2lXSvADg">&ldquo;K8s is Cannibalizing Itself!&rdquo;</a>: &ldquo;<em><strong>Kubernetes has become too complex; it needs to learn restraint, or it will stop innovating and lose its base</strong></em>.&rdquo;</p>
<hr>
<h2 id="lose-lose-situation">Lose-Lose Situation</h2>
<p>In the cloud-native realm, the analogy of &ldquo;pets&rdquo; versus &ldquo;cattle&rdquo; is often used for illustrating stateful services. &ldquo;Pets,&rdquo; like databases, need careful and individual care, while &ldquo;cattle&rdquo; represent disposable, stateless applications (Disposability).</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 778px">
<img class="card-img-top" src="/zh/blog/db/db-in-k8s/12-factor_hue92b117bbc262aa2b08fc07fefd75e09_483297_768x384_fit_catmullrom_3.png" width="768" height="379">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">
<p>Cloud Native Applications 12 Factors: <strong>Disposability</strong>
<small class="text-muted"><br/><em>source</em>: <a href="https://user-images.githubusercontent.com/5445356/47986421-a8f62080-e117-11e8-9a39-3fdc6030c324.png">https://user-images.githubusercontent.com/5445356/47986421-a8f62080-e117-11e8-9a39-3fdc6030c324.png</a></small></p>
</p>
</figcaption>
</figure>
<blockquote>
<p>Cloud Native Applications 12 Factors: <strong>Disposability</strong></p>
</blockquote>
<p>One of the leading architectural goals of K8S is to <strong>treat what can be treated as cattle as cattle</strong>. The attempt to &ldquo;separate storage from computation&rdquo; in databases follows this strategy: splitting stateful database services into state storage outside K8S and pure computation inside K8S. The state is stored on the EBS/cloud disk/distributed storage service, allowing the &ldquo;stateless&rdquo; database part to be freely created, destroyed, and scheduled in K8S.</p>
<p>Unfortunately, databases, especially OLTP databases, heavily depend on disk hardware, and network storage&rsquo;s reliability and performance still lag behind local disks by <a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">orders of magnitude</a>. Thus, K8S offers the LocalhostPV option, allowing containers to use data volumes directly lies on the host operating system, utilizing high-performance/high-reliability local NVMe disk storage.</p>
<p>However, this presents a dilemma: should one use subpar cloud disks and tolerate poor database reliability/performance for K8S&rsquo;s scheduling and orchestration capabilities? Or use high-performance local disks tied to host nodes, virtually losing all flexible scheduling abilities? The former is like stuffing an anchor into K8S&rsquo;s small boat, slowing overall speed and agility; the latter is like anchoring and pinning the ship to a specific point.</p>
<p>Running a stateless K8S cluster is simple and reliable, as is running a stateful database on a physical machine&rsquo;s bare operating system. Mixing the two, however, results in a <strong>lose-lose situation</strong>: <em><strong>K8S loses its stateless flexibility and casual scheduling abilities, while the database sacrifices core attributes like reliability, security, efficiency, and simplicity in exchange for elasticity, resource utilization, and Day1 delivery speed that are not fundamentally important to databases</strong></em>.</p>
<p>A vivid example of the former is the performance optimization of <a href="https://mp.weixin.qq.com/s/SCImfwEvkCPqZhLGx758Sw">PostgreSQL@K8S</a>, which KubeBlocks contributed. K8S experts employed various advanced methods to solve performance issues that did not exist on bare metal/bare OS at all. A fresh case of the latter is Didi&rsquo;s <a href="https://mp.weixin.qq.com/s/FIOB_Oqefx1oez1iu7AGGg">K8S architecture juggling disaster</a>; if it weren&rsquo;t for putting the stateful MySQL in K8S, would rebuilding a stateless K8S cluster and redeploying applications take 12 hours to recover?</p>
<hr>
<h2 id="pros-and-cons">Pros and Cons</h2>
<p>For serious technology decisions, the most crucial aspect is weighing the pros and cons. Here, in the order of &ldquo;quality, security, performance, cost,&rdquo; let&rsquo;s discuss the technical trade-offs of placing databases in K8S versus classic bare metal/VM deployments. I don&rsquo;t want to write a comprehensive paper that covers everything. Instead, I&rsquo;ll throw some specific questions for consideration and discussion.</p>
<p><strong>Quality</strong></p>
<p>K8S, compared to physical deployments, introduces additional failure points and architectural complexity, increasing the blast radius and significantly prolonging the average recovery time of failures. In <a href="https://mp.weixin.qq.com/s/kFftay1IokBDqyMuArqOpg">&ldquo;Is it a Good Idea to Put Databases into Docker?&rdquo;</a>, we provided an argument about reliability, which can also apply to Kubernetes — K8S and Docker introduce additional and unnecessary dependencies and failure points to databases, lacking community failure knowledge accumulation and reliability track record (MTTR/MTBF).</p>
<p>In the cloud vendor classification system, K8S belongs to PaaS, while RDS belongs to a more fundamental layer, IaaS. <strong>Database services have higher reliability requirements than K8S</strong>; for instance, many companies&rsquo; cloud management platforms rely on an additional CMDB database. Where should this database be placed? You shouldn&rsquo;t let K8S manage things it depends on, nor should you add unnecessary extra dependencies. The <a href="https://mp.weixin.qq.com/s/OIlR0rolEQff9YfCpj3wIQ">Alibaba Cloud global epic failure</a> and <a href="https://mp.weixin.qq.com/s/FIOB_Oqefx1oez1iu7AGGg">Didi&rsquo;s K8S architecture juggling disaster</a> have taught us this lesson. Moreover, maintaining a separate database system inside K8S when there&rsquo;s already one outside is even more unjustifiable.</p>
<p><strong>Security</strong></p>
<p>The database in a multi-tenant environment introduces additional attack surfaces, bringing higher risks and more complex audit compliance challenges. Does K8S make your database more secure? Maybe the complexity of K8S architecture juggling will deter script kiddies unfamiliar with K8S, but for real attackers, more components and dependencies often mean a broader attack surface.</p>
<p>In <a href="https://mp.weixin.qq.com/s/Tvuy0kAiqh66sOwkr3WWMA">&ldquo;BrokenSesame Alibaba Cloud PostgreSQL Vulnerability Technical Details&rdquo;</a>, security personnel escaped to the K8S host node using their own PostgreSQL container and accessed the K8S API and other tenants&rsquo; containers and data. This is clearly a K8S-specific issue — the risk is real, such attacks have occurred, and even Alibaba Cloud, a local cloud industry leader, has been compromised.</p>
<p><img alt="security.png" src="/zh/blog/db/db-in-k8s/security.png"></p>
<blockquote>
<p>《<a href="https://www.youtube.com/watch?v=d81qnGKv4EE">The Attacker Perspective - Insights From Hacking Alibaba Cloud</a>》</p>
</blockquote>
<p><strong>Performance</strong></p>
<p>As stated in <a href="https://mp.weixin.qq.com/s/kFftay1IokBDqyMuArqOpg">&ldquo;Is it a Good Idea to Put Databases into Docker?&rdquo;</a>, whether it&rsquo;s additional network overhead, Ingress bottlenecks, or underperforming cloud disks, all negatively impact database performance. For example, as revealed in <a href="https://mp.weixin.qq.com/s/SCImfwEvkCPqZhLGx758Sw">&ldquo;PostgreSQL@K8s Performance Optimization&rdquo;</a> — you need a considerable level of technical prowess to make database performance in K8S barely match that on bare metal.</p>
<p><img alt="performence.png" src="/zh/blog/db/db-in-k8s/performence.png"></p>
<blockquote>
<p>Latency is measured in <strong>ms</strong>, not <strong>µs</strong>; I almost thought my eyes were deceiving me.</p>
</blockquote>
<p>Another misconception about efficiency is resource utilization. Unlike offline analytical businesses, critical online OLTP databases should not aim to increase resource utilization but rather deliberately lower it to enhance system reliability and user experience. If there are many fragmented businesses, resource utilization can be improved through PDB/shared database clusters. K8S&rsquo;s advocated elasticity efficiency is not unique to it — KVM/EC2 can also effectively address this issue.</p>
<p>In terms of <strong>cost</strong>, K8S and various Operators provide a decent abstraction, encapsulating some of the complexity of database management, which is attractive for teams without DBAs. However, the complexity reduced by using it to manage databases pales in comparison to the complexity introduced by using K8S itself. For instance, random IP address drifts and automatic Pod restarts may not be a big issue for stateless applications, but for databases, they are intolerable — many companies have had to attempt to modify kubelet to avoid this behavior, thereby introducing more complexity and maintenance costs.</p>
<p>As stated in <a href="https://mp.weixin.qq.com/s/FIOB_Oqefx1oez1iu7AGGg">&ldquo;From Reducing Costs and Smiles to Reducing Costs and Efficiency&rdquo;</a> &ldquo;Reducing Complexity Costs&rdquo; section: <strong>Intellectual power is hard to accumulate spatially</strong>: when a database encounters problems, it needs database experts to solve them; when Kubernetes has problems, it needs K8S experts to look into them; however, when you put a database into Kubernetes, complexities combine, the state space explodes, but the intellectual bandwidth of individual database experts and K8S experts is hard to stack — you need a dual expert to solve the problem, and such experts are undoubtedly much rarer and more expensive than pure database experts. Such architectural juggling is enough to cause major setbacks for most teams, including top public clouds/big companies, in the event of a failure.</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 242px">
<img class="card-img-top" src="/zh/blog/db/db-in-k8s/k8s-meme_huf5d25fac398b63a780ca47347ed1606d_448418_768x300_fit_catmullrom_3.png" width="232" height="300">
</figure>
<hr>
<h2 id="the-cloud-native-frenzy">The Cloud-Native Frenzy</h2>
<p>An interesting question arises: if K8S is unsuitable for stateful databases, why are so many companies, including big players, rushing to do this? The reasons are not technical.</p>
<p>Google open-sourced its K8S battleship, modeled after its internal Borg spaceship, and managers, fearing being left behind, rushed to adopt it, thinking using K8S would put them on par with Google. Ironically, Google doesn&rsquo;t use K8S; it was more likely to disrupt AWS and mislead the industry. However, most companies don&rsquo;t have the manpower like Google to operate such a battleship. More importantly, their problems might need a simple vessel. Running MySQL + PHP, PostgreSQL + Go/Python on bare metal has already taken many companies to IPO.</p>
<p>Under <a href="https://mp.weixin.qq.com/s/1OSRcBfd58s0tgZTUZHB9g">modern hardware conditions</a>, the complexity of most applications throughout their lifecycle doesn&rsquo;t justify using K8S. Yet, the &ldquo;cloud-native&rdquo; frenzy, epitomized by K8S, has become a distorted phenomenon: adopting k8s just for the sake of k8s. Some engineers are looking for &ldquo;advanced&rdquo; and &ldquo;cool&rdquo; technologies used by big companies to fulfill their personal goals like job hopping or promotions or to increase their job security by adding complexity, not considering if these &ldquo;dragon-slaying&rdquo; techniques are necessary for solving their problems.</p>
<p>The cloud-native landscape is filled with fancy projects. Every new development team wants to introduce something new: Helm today, Kubevela tomorrow. They talk big about bright futures and peak efficiency, but in reality, they create a mountain of architectural complexities and a playground for &ldquo;YAML Boys&rdquo; - tinkering with the latest tech, inventing concepts, earning experience and reputation at the expense of users who bear the complexity and maintenance costs.</p>
<p><img alt="cncf-landscape.png" src="/zh/blog/db/db-in-k8s/cncf-landscape.png"></p>
<blockquote>
<p>CNCF Landscape</p>
</blockquote>
<p>The cloud-native movement&rsquo;s philosophy is compelling - democratizing the elastic scheduling capabilities of public clouds for every user. K8S indeed excels in stateless applications. However, excessive enthusiasm has led K8S astray from its original intent and direction - simply doing well in orchestrating stateless applications, burdened by the ill-conceived support for stateful applications.</p>
<hr>
<h2 id="making-wise-decisions">Making Wise Decisions</h2>
<p>Years ago, when I first encountered K8S, I too was fervent —— It was at TanTan. We had over twenty thousand cores and hundreds of database clusters, and I was eager to try putting databases in Kubernetes and testing all the available Operators. However, after two to three years of extensive research and architectural design, I calmed down and abandoned this madness. Instead, I architected our database service based on bare metal/operating systems. For us, the benefits K8S brought to databases were negligible compared to the problems and hassles it introduced.</p>
<p>Should databases be put into K8S? It depends: for public cloud vendors who thrive on overselling resources, elasticity and utilization are crucial, which are directly linked to revenue and profit, While reliability and performance take a back seat - after all, an availability below three nines means <a href="https://vonng.com/cn/blog/cloud/sla/">compensating 25% monthly credit</a>. But for most user, including ourselves, these trade-offs hold different: One-time Day1 Setup, elasticity, and resource utilization aren&rsquo;t their primary concerns; reliability, performance, Day2 Operation costs, these core database attributes are what matter most.</p>
<p>We open-sourced our database service architecture — an out-of-the-box PostgreSQL distribution and a local-first RDS alternative: <a href="https://vonng.com/cn/blog/db/pigsty-intro/">Pigsty</a>. We didn&rsquo;t choose the so-called &ldquo;build once, run anywhere&rdquo; approach of K8S and Docker. Instead, we adapted to different <a href="https://mp.weixin.qq.com/s/xHG8OURTYlmnQTorFkzioA">OS distros</a> &amp; major versions, and used Ansible to achieve a K8S CRD IaC-like API to seal management complexity. This was arduous, but it was the right thing to do - the world does not need another clumsy attempt at putting PostgreSQL into K8S. Still, it does need a production database service architecture that maximizes hardware performance and reliability.</p>
<p><img alt="stackgres-pigsty.png" src="/zh/blog/db/db-in-k8s/pigsty-stackgres.png"></p>
<blockquote>
<p>Pigsty vs StackGres</p>
</blockquote>
<p>Perhaps one day, when the reliability and performance of distributed network storage surpass local storage and mainstream databases have some native support for storage-computation separation, things might change again — K8S might become suitable for databases. But for now, I believe putting serious production OLTP databases into K8S is immature and inappropriate. I hope readers will make wise choices on this matter.</p>
<hr>
<h2 id="reference">Reference</h2>
<p><strong><a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247486572&idx=1&sn=274a51976bf8ae5974beb1d3173380c1&chksm=fe4b39b7c93cb0a14c4d99f8ffd1e00c36b972a8058fd99e9d06e6035c4f378b6d327892260b&scene=21#wechat_redirect">Database in Docker: Is that a good idea?</a></strong></p>
<p><strong><a href="https://mp.weixin.qq.com/s/9Q9kze9D2LT0-G2lXSvADg">《Kubernetes is Rotten!》</a></strong></p>
<p><strong><a href="https://mp.weixin.qq.com/s/EWCblHU-vDC3ebV6ITE45A">《Curse of Docker?》</a></strong></p>
<p><strong><a href="https://mp.weixin.qq.com/s/KFZCQFP1oB5YOrT3tHBRCQ">《What can we learn from DiDi&rsquo;s Epic k8s Failure》</a></strong></p>
<p><strong><a href="https://mp.weixin.qq.com/s/0kbWa6AnkCr5jkN4WIgu5Q">《PostgreSQL@K8s Performance Optimization》</a></strong></p>
<p><strong><a href="https://questdb.io/blog/databases-on-k8s/">《Running Database on Kubernetes》</a></strong></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-564f2bc59ef0064fb9b5b78f3ee282ef">NewSQL: Distributive Nonsens</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/-eaCoZR9Z5srQ-1YZm1QJA">Wechat Column</a></b> |
        
		<time datetime="2023-05-07" class="text-muted">2023-05-07</time>
        
	</div>
	<blockquote>
<p><a href="https://mp.weixin.qq.com/s/-eaCoZR9Z5srQ-1YZm1QJA">WeChat Column</a></p>
</blockquote>
<p>As hardware technology advances, the capacity and performance of standalone databases have reached unprecedented heights. In this transformative era, distributed (TP) databases appear utterly powerless, much like the &ldquo;data middle platform,&rdquo; donning the emperor&rsquo;s new clothes in a state of self-deception.</p>
<ul>
<li><a href="/blog/db/distributive-bullshit/#tl-dr">TL; DR</a></li>
<li><a href="/blog/db/distributive-bullshit/#the-pull-of-the-internet">The Pull of the Internet</a></li>
<li><a href="/blog/db/distributive-bullshit/#the-trade-offs-of-distributive">The Trade-Offs of Distributive</a></li>
<li><a href="/blog/db/distributive-bullshit/#the-impact-of-new-hardware">The Impact of New Hardware</a></li>
<li><a href="/blog/db/distributive-bullshit/#the-predicament-of-false-needs">The Predicament of False Needs</a></li>
<li><a href="/blog/db/distributive-bullshit/#the-struggles-in-confusion">The Struggles in Confusion</a></li>
<li><a href="/blog/db/distributive-bullshit/#references">References</a></li>
</ul>
<hr>
<h2 id="tl-dr">TL; DR</h2>
<p>The core trade-off of distributed databases is: &ldquo;<strong>quality for quantity</strong>,&rdquo; sacrificing functionality, performance, complexity, and reliability for greater data capacity and throughput. However, &ldquo;what divides must eventually converge,&rdquo; and hardware innovations have propelled centralized databases to new heights in capacity and throughput, rendering distributed (TP) databases obsolete.</p>
<p>Hardware, exemplified by NVMe SSDs, follows Moore&rsquo;s Law, evolving at an exponential pace. Over a decade, performance has increased by tens of times, and prices have dropped significantly, <strong>improving the cost-performance ratio by three orders of magnitude</strong>. A single card can now hold 32TB+, with 4K random read/write IOPS reaching 1600K/600K, latency at 70µs/10µs, and a cost of less than 200 ¥/TB·year. Running a centralized database on a single machine can achieve one to two million point write/point query QPS.</p>
<p>Scenarios truly requiring distributed databases are few and far between, with typical mid-sized internet companies/banks handling request volumes ranging from tens to hundreds of thousands of QPS, and non-repetitive TP data at the hundred TB level. <strong>In the real world, over 99% of scenarios do not need distributed databases</strong>, and the remaining 1% can likely be addressed through classic engineering solutions like horizontal/vertical partitioning.</p>
<p>Top-tier internet companies might have a few genuine use cases, yet these companies have no intention to pay. The market simply cannot sustain so many distributed database cores, and the few products that do survive don&rsquo;t necessarily rely on distribution as their selling point. HATP and the integration of distributed and standalone databases represent the struggles of confused distributed TP database vendors seeking transformation, but they are still far from achieving product-market fit.</p>
<hr>
<h2 id="the-pull-of-the-internet">The Pull of the Internet</h2>
<p>&ldquo;Distributed database&rdquo; is not a term with a strict definition. In a narrow sense, it highly overlaps with NewSQL databases such as CockroachDB, YugabyteDB, TiDB, OceanBase, and TDSQL; broadly speaking, classic databases like Oracle, PostgreSQL, MySQL, SQL Server, PolarDB, and Aurora, which span multiple physical nodes and use master-slave replication or shared storage, can also be considered distributed databases. <strong>In the context of this article, a distributed database refers to the former, specifically focusing on transactional processing (OLTP) distributed relational databases</strong>.</p>
<p>The rise of distributed databases stemmed from the rapid development of internet applications and the explosive growth of data volumes. In that era, traditional relational databases often encountered performance bottlenecks and scalability issues when dealing with massive data and high concurrency. Even using Oracle with Exadata struggled in the face of voluminous CRUD operations, not to mention the prohibitively expensive annual hardware and software costs.</p>
<p>Internet companies embarked on a different path, building their infrastructure with free, open-source databases like MySQL. Veteran developers/DBAs might still recall the MySQL best practice: keep single-table records below 21 million to avoid rapid performance degradation. Correspondingly, database sharding became a widely recognized practice among large companies.</p>
<p>The basic idea here was &ldquo;three cobblers with their wits combined equal Zhuge Liang,&rdquo; using a bunch of inexpensive x86 servers + numerous sharded open-source database instances to create a massive CRUD simple data store. Thus, <strong>distributed databases often originated from internet company scenarios, evolving along the manual sharding → sharding middleware → distributed database path</strong>.</p>
<p>As an industry solution, distributed databases have successfully met the needs of internet companies. However, before abstracting and solidifying it into a product for external output, several questions need to be clarified:</p>
<p><strong>Do the trade-offs from ten years ago still hold up today?</strong></p>
<p><strong>Are the scenarios of internet companies applicable to other industries?</strong></p>
<p><strong>Could distribute OLTP databases be a false necessity?</strong></p>
<hr>
<h2 id="the-trade-offs-of-distributive">The Trade-Offs of Distributive</h2>
<p>&ldquo;Distributed,&rdquo; along with buzzwords like &ldquo;HTAP,&rdquo; &ldquo;compute-storage separation,&rdquo; &ldquo;Serverless,&rdquo; and &ldquo;lakehouse,&rdquo; holds no inherent meaning for enterprise users. Practical clients focus on tangible attributes and capabilities: functionality, performance, security, reliability, return on investment, and cost-effectiveness. <strong>What truly matters is the trade-off: compared to classic centralized databases, what do distributed databases sacrifice, and what do they gain in return?</strong></p>
<p><img alt="distributive-bullshit-1.png" src="/zh/blog/db/distributive-bullshit/distributive-bullshit-1.png"></p>
<blockquote>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485399&idx=1&sn=0b7d5a7dc24295afcc56ec688b2c2d06&chksm=fe4b320cc93cbb1a369f9c9a7c50811c6a4f784fd2dd070f6ce5b16378502b8e5c7c76b716e1&scene=21#wechat_redirect">数据库需求层次金字塔</a>[1]</p>
</blockquote>
<p><strong>The core trade-off of distributed databases can be summarized as &ldquo;quality for quantity&rdquo;: sacrificing functionality, performance, complexity, and reliability to gain greater data capacity and request throughput.</strong></p>
<p>NewSQL often markets itself on the concept of &ldquo;distribution,&rdquo; solving <strong>scalability</strong> issues through &ldquo;distribution.&rdquo; Architecturally, it typically features multiple peer data nodes and a coordinator, employing distributed consensus protocols like Paxos/Raft for replication, allowing for <strong>horizontal scaling</strong> by adding data nodes.</p>
<p><strong>Firstly</strong>, due to their inherent limitations, distributed databases sacrifice many <strong>features</strong>, offering only basic and limited CRUD query support. <strong>Secondly</strong>, because distributed databases require multiple network RPCs to complete requests, their <strong>performance</strong> typically suffers a 70% or more degradation compared to centralized databases. <strong>Furthermore</strong>, distributed databases, consisting of DN/CN and TSO components among others, introduce significant <strong>complexity</strong> in operations and management. <strong>Lastly</strong>, in terms of <strong>high availability and disaster recovery</strong>, distributed databases do not offer a qualitative improvement over the classic centralized master-slave setup; instead, they introduce numerous additional failure points due to their complex components.</p>
<p><img alt="distributive-bullshit-2.png" src="/zh/blog/db/distributive-bullshit/distributive-bullshit-2.png"></p>
<blockquote>
<p><a href="https://mp.weixin.qq.com/s/651zXDKGwFy8i0Owrmm-Xg">SYSBENCH吞吐对比</a>[2]</p>
</blockquote>
<p>In the past, the trade-offs of distributed databases were justified: the internet required larger data storage capacities and higher access throughputs—a must-solve problem, and these drawbacks were surmountable. But today, hardware advancements have rendered the &ldquo;quantity&rdquo; question obsolete, thus erasing the raison d&rsquo;être of distributed databases along with the very problem they sought to solve.</p>
<p><img alt="distributive-bullshit-3.png" src="/zh/blog/db/distributive-bullshit/distributive-bullshit-3.png"></p>
<blockquote>
<p>Times have changed, My lord!</p>
</blockquote>
<hr>
<h2 id="the-impact-of-new-hardware">The Impact of New Hardware</h2>
<p>Moore&rsquo;s Law posits that every 18 to 24 months, processor performance doubles while costs halve. This principle largely applies to storage as well. From 2013 to 2023, spanning 5 to 6 cycles, we should see performance and cost differences of <strong>dozens of times</strong> compared to a decade ago. Is this the case?</p>
<p>Let&rsquo;s examine the performance metrics of a typical SSD from 2013 and compare them with those of a typical PCI-e Gen4 NVMe SSD from 2022. It&rsquo;s evident that the SSD&rsquo;s 4K random read/write IOPS have jumped from <strong>60K/40K</strong> to <strong>1600K/600K</strong>, with prices plummeting from <strong>2220$/TB</strong> to <strong>40$/TB</strong>. Performance has improved by 15 to 26 times, while prices have dropped 56-fold[3,4,5], certainly validating the rule of thumb at a magnitude level.</p>
<p><img alt="distributive-bullshit-4.png" src="/zh/blog/db/distributive-bullshit/distributive-bullshit-4.png"></p>
<blockquote>
<p>HDD/SSD Performance in 2013</p>
</blockquote>
<p><img alt="distributive-bullshit-5.png" src="/zh/blog/db/distributive-bullshit/distributive-bullshit-5.png"></p>
<blockquote>
<p>NVMe Gen4 SSD in 2022</p>
</blockquote>
<p>A decade ago, mechanical hard drives dominated the market. A 1TB hard drive cost about seven or eight hundred yuan, and a 64GB SSD was even more expensive. Ten years later, a mainstream 3.2TB enterprise-grade NVMe SSD costs just three thousand yuan. Considering a five-year warranty, the monthly cost per TB is only <strong>16</strong> yuan, with an annual cost under <strong>200</strong> yuan. For reference, cloud providers&rsquo; reputedly cost-effective S3 object storage costs <strong>1800¥/TB·year.</strong></p>
<p><img alt="distributive-bullshit-6.png" src="/zh/blog/db/distributive-bullshit/distributive-bullshit-6.png"></p>
<blockquote>
<p>Price per unit of SSD/HDD from 2013 to 2030 with predictions</p>
</blockquote>
<p>The typical fourth-generation local NVMe disk can reach a maximum capacity of <strong>32TB to 64TB</strong>, offering <strong>70µs/10µs</strong> 4K random read/write latencies, and <strong>1600K/600K</strong> read/write IOPS, with the fifth generation boasting an astonishing bandwidth of <strong>several GB/s</strong> per card.</p>
<p>Equipping a classic Dell 64C / 512G server with such a card, factoring in five years of IDC depreciation, the total cost is under one hundred thousand yuan. Such a server running PostgreSQL <strong>sysbench</strong> can nearly reach one million QPS for single-point writes and two million QPS for point queries without issue.</p>
<p>What does this mean? For a typical mid-sized internet company/bank, the demand for database requests is usually in the tens of thousands to hundreds of thousands of QPS, with non-repeated TP data volumes fluctuating around hundreds of TBs. Considering hardware storage compression cards can achieve several times compression ratio, such scenarios might now be manageable by a centralized database on a single machine and card under modern hardware conditions[6].</p>
<p>Previously, users might have had to invest millions in high-end storage solutions like exadata, then spend a fortune on Oracle commercial database licenses and original factory services. Now, achieving similar outcomes starts with just a few thousand yuan on an enterprise-grade SSD card; open-source Oracle alternatives like PostgreSQL, capable of smoothly running the largest single tables of 32TB, no longer suffer from the limitations that once forced MySQL into partitioning. High-performance database services, once luxury items restricted to intelligence/banking sectors, have become affordable for all industries[7].</p>
<p><strong>Cost-effectiveness is the primary product strength</strong>. The cost-effectiveness of high-performance, large-capacity storage has improved by three orders of magnitude over a decade, making the once-highlighted value of distributed databases appear weak in the face of such remarkable hardware evolution.</p>
<hr>
<h2 id="the-predicament-of-false-needs">The Predicament of False Needs</h2>
<p>Nowadays, sacrificing functionality, performance, complexity for scalability is most likely to be a fake-demands in most scenarios.</p>
<p>With the support of modern hardware, over 99% of real-world scenarios do not exceed the capabilities of a centralized, single-machine database. The remaining scenarios can likely be addressed through classical engineering methods like horizontal or vertical splitting. This holds true even for internet companies: even among the global top firms, scenarios where a transactional (TP) single table exceeds several tens of TBs are still rare.</p>
<p>Google Spanner, the forefather of NewSQL, was designed to solve the problem of massive data scalability, but how many enterprises actually handle data volumes comparable to Google&rsquo;s? In terms of data volume, the lifetime TP data volume for the vast majority of enterprises will not exceed the bottleneck of a centralized database, which continues to grow exponentially with Moore&rsquo;s Law. Regarding request throughput, many enterprises have enough database performance headroom to implement all their business logic in stored procedures and run it smoothly within the database.</p>
<p>&ldquo;<em>Premature optimization is the root of all evil</em>,&rdquo; designing for unneeded scale is a waste of effort. If volume is no longer an issue, then sacrificing other attributes for unneeded volume becomes meaningless.</p>
<p><img alt="distributive-bullshit-7.png" src="/zh/blog/db/distributive-bullshit/distributive-bullshit-7.png"></p>
<blockquote>
<p>“Premature optimization is the root of all evil”</p>
</blockquote>
<p><strong>In many subfields of databases, distributed technology is not a pseudo-requirement</strong>: if you need a highly reliable, disaster-resilient, simple, low-frequency KV storage for metadata, then a distributed etcd is a suitable choice; if you require a globally distributed table for arbitrary reads and writes across different locations and are willing to endure significant performance degradation, then YugabyteDB might be a good choice. For ensuring transparency and preventing tampering and denial, blockchain is fundamentally a leaderless distributed ledger database;</p>
<p>For large-scale data analytics (OLAP), distributed technology is <strong>indispensable</strong> (though this is usually referred to as data warehousing, MPP); however, in the transaction processing (OLTP) domain, distributed technology is <strong>largely unnecessary</strong>: OLTP databases are like working memory, characterized by being small, fast, and feature-rich. Even in very large business systems, the active working set at any one moment is not particularly large. A basic rule of thumb for OLTP system design is: <strong>If your problem can be solved within a single machine, don&rsquo;t bother with distributed databases</strong>.</p>
<p><strong>OLTP</strong> databases have a history spanning several decades, with existing cores developing to a mature stage. Standards in the TP domain are gradually converging towards three Wire Protocols: PostgreSQL, MySQL, and Oracle. If the discussion is about tinkering with database auto-sharding and adding global transactions as a form of &ldquo;distribution,&rdquo; it&rsquo;s definitely a dead end. If a &ldquo;distributed&rdquo; database manages to break through, it&rsquo;s likely not because of the &ldquo;pseudo-requirement&rdquo; of &ldquo;distribution,&rdquo; but rather due to new features, open-source ecosystems, compatibility, ease of use, domestic innovation, and self-reliance.</p>
<hr>
<h2 id="the-struggles-in-confusion">The Struggles in Confusion</h2>
<p>The greatest challenge for distributed databases stems from the market structure: <strong>Internet companies, the most likely candidates to utilize distributed TP databases, are paradoxically the least likely to pay for them</strong>. Internet companies can serve as high-quality users or even contributors, offering case studies, feedback, and PR, but they inherently resist the notion of financially supporting software, clashing with their <strong>meme instincts</strong>. Even leading distributed database vendors face the challenge of being applauded but not financially supported.</p>
<p>In a recent casual conversation with an engineer at a distributed database company, it was revealed that during a POC with a client, a query that Oracle completed in 10 seconds, their distributed database could only match with an order of magnitude difference, even when utilizing various resources and Dirty Hacks. Even openGauss, which forked from PostgreSQL 9.2 a decade ago, can outperform many distributed databases in certain scenarios, not to mention the advancements seen in PostgreSQL 15 and Oracle 23c ten years later. This gap is so significant that even the original manufacturers are left puzzled about the future direction of distributed databases.</p>
<p>Thus, some distributed databases have started pivoting towards self-rescue, with <strong>HTAP</strong> being a prime example: while transaction processing in a distributed setting is suboptimal, analytics can benefit greatly. So, why not combine the two? A single system capable of handling both transactions and analytics! However, engineers in the real world understand that <strong>AP systems and TP systems each have their own patterns, and forcibly merging two diametrically opposed systems will only result in both tasks failing to succeed</strong>. Whether it&rsquo;s classic ETL/CDC pushing and pulling to specialized solutions like ClickHouse/Greenplum/Doris, or logical replication to a dedicated in-memory columnar store, any of these approaches is more reliable than using a chimera HTAP database.</p>
<p>Another idea is <strong>monolithic-distributed integration</strong>: <strong>if you can&rsquo;t beat them, join them</strong> by adding a monolithic mode to avoid the high costs of network RPCs, ensuring that in 99% of scenarios where distributed capabilities are unnecessary, they aren&rsquo;t completely outperformed by centralized databases — <strong>even if distributed isn&rsquo;t needed, it&rsquo;s essential to stay in the game and prevent others from taking the lead!</strong> But the fundamental issue here is the same as with HTAP: forcing heterogeneous data systems together is pointless. If there was value in doing so, why hasn&rsquo;t anyone created a monolithic binary that integrates all heterogeneous databases into a do-it-all behemoth — <strong>the Database Jack-of-all-trades?</strong> Because it violates the KISS principle: <strong>Keep It Simple, Stupid!</strong></p>
<p><img alt="distributive-bullshit-8.png" src="/zh/blog/db/distributive-bullshit/distributive-bullshit-8.png"></p>
<p>The plight of distributed databases is similar to that of <strong>Middle Data Platforms</strong>: originating from internal scenarios at major internet companies and solving domain-specific problems. Once riding the wave of the internet industry, the discussion of databases was dominated by distributed technologies, enjoying a moment of pride. However, due to excessive hype and promises of unrealistic capabilities, they failed to meet user expectations, ending in disappointment and becoming akin to the emperor&rsquo;s new clothes.</p>
<p>There are still many areas within the TP database field worthy of focus: Leveraging new hardware, actively embracing changes in underlying architectures like CXL, RDMA, NVMe; or providing simple and intuitive declarative interfaces to make database usage and management more convenient; offering more intelligent automatic monitoring and control systems to minimize operational tasks; developing compatibility plugins like Babelfish for MySQL/Oracle, aiming for a unified relational database WireProtocol. Even investing in better support services would be more meaningful than chasing the false need for &ldquo;distributed&rdquo; features.</p>
<p>Time changes, and a wise man adapts. It is hoped that distributed database vendors will find their Product-Market Fit and focus on what users truly need.</p>
<hr>
<h2 id="references">References</h2>
<p>[1] <a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485399&idx=1&sn=0b7d5a7dc24295afcc56ec688b2c2d06&chksm=fe4b320cc93cbb1a369f9c9a7c50811c6a4f784fd2dd070f6ce5b16378502b8e5c7c76b716e1&scene=21#wechat_redirect">数据库需求层次金字塔 </a>: <em><a href="https://mp.weixin.qq.com/s/1xR92Z67kvvj2_NpUMie1Q">https://mp.weixin.qq.com/s/1xR92Z67kvvj2_NpUMie1Q</a></em></p>
<p>[2] <a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485240&idx=1&sn=9052f03ae2ef21d9e21037fd7a1fa7fe&chksm=fe4b32e3c93cbbf522616346c1afd49e1e6edbb0898694df224fe2134a69c0c4562aab35587a&scene=21#wechat_redirect">PostgreSQL到底有多强？</a> : <em><a href="https://mp.weixin.qq.com/s/651zXDKGwFy8i0Owrmm-Xg">https://mp.weixin.qq.com/s/651zXDKGwFy8i0Owrmm-Xg</a></em></p>
<p>[3] SSD Performence in 2013 : <em><a href="https://www.snia.org/sites/default/files/SNIASSSI.SSDPerformance-APrimer2013.pdf">https://www.snia.org/sites/default/files/SNIASSSI.SSDPerformance-APrimer2013.pdf</a></em></p>
<p>[4] 2022 Micron NVMe SSD Spec: <em><a href="https://media-www.micron.com/-/media/client/global/documents/products/product-flyer/9400_nvme_ssd_product_brief.pdf">https://media-www.micron.com/-/media/client/global/documents/products/product-flyer/9400_nvme_ssd_product_brief.pdf</a></em></p>
<p>[5] 2013-2030 SSD Pricing : <em><a href="https://blocksandfiles.com/2021/01/25/wikibon-ssds-vs-hard-drives-wrights-law/">https://blocksandfiles.com/2021/01/25/wikibon-ssds-vs-hard-drives-wrights-law/</a></em></p>
<p>[6] <a href="https://mp.weixin.qq.com/s?__biz=MzIxNTQ0MDQxNg==&mid=2247516311&idx=1&sn=b93dc765a952f998ccea6e85ebfb7b8d&scene=21#wechat_redirect">Single Instance with 100TB</a>: <a href="https://mp.weixin.qq.com/s?__biz=MzIxNTQ0MDQxNg==&mid=2247516311&idx=1&sn=b93dc765a952f998ccea6e85ebfb7b8d&scene=21#wechat_redirect"><em>https://mp.weixin.qq.com/s/JSQPzep09rDYbM-x5ptsZA</em></a></p>
<p>[7] <a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485391&idx=1&sn=4cec9af2b58160eb345a6b12411f0b68&chksm=fe4b3214c93cbb023c13a89133c75bf1e88e1543de9359df7447498e4a9d5ec555313a954566&scene=21#wechat_redirect">EBS: Scam</a>: <em><a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag</a></em></p>
<p>[8] <a href="https://mp.weixin.qq.com/s?__biz=Mzg3NjcyNDk3MQ==&mid=2247486918&idx=1&sn=c1c0331b01e2c91e65ec6ed755093582&scene=21#wechat_redirect">中台：一场彻头彻尾的自欺欺人</a>: <em><a href="https://mp.weixin.qq.com/s/VgTU7NcOwmrX-nbrBBeH_w">https://mp.weixin.qq.com/s/VgTU7NcOwmrX-nbrBBeH_w</a></em></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-65bb532e2949268a0bd020d4878070be">Is running postgres in docker a good idea?</h1>
	<div class="lead">Thou shalt not run a prod database inside a container</div>
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2019-01-13" class="text-muted">2019-01-13</time>
        
	</div>
	<p>For stateless app services, containers are an almost perfect devops solution. However, for stateful services like databases, it&rsquo;s not so straightforward. Whether production databases should be containerized remains controversial.</p>
<p>From a developer&rsquo;s perspective, I&rsquo;m a big fan of Docker &amp; Kubernetes and believe that they might be the future standard for software deployment and operations. But as a database administrator, I think hosting production databases in Docker/K8S is still a bad idea.</p>
<hr>
<h2 id="what-problems-does-docker-solve">What problems does Docker solve?</h2>
<p>Docker is described with terms like lightweight, standardized, portable, cost-effective, efficient, automated, integrated, and high-performance in operations. These claims are valid, as Docker indeed simplifies both development and operations. This explains why many companies are eager to containerize their software and services. However, this enthusiasm sometimes goes to the extreme of containerizing everything, including <strong>production databases</strong>.</p>
<p>Containers were originally designed for <strong>stateless</strong> apps, where temporary data produced by the app is logically part of the container. A service is created with a container and destroyed after use. These apps are stateless, with the state typically stored outside in a database, reflecting the classic architecture and philosophy of containerization.</p>
<p>But when it comes to containerizing the production database itself, the scenario changes: databases are stateful. To maintain their state without losing it when the container stops, database containers need to &ldquo;punch a hole&rdquo; to the underlying OS, which is named data volumes.</p>
<p>Such containers are no longer ephemeral entities that can be freely created, destroyed, moved, or transferred; they become bound to the underlying environment. Thus, the many advantages of using containers for traditional apps are not applicable to database containers.</p>
<hr>
<h2 id="reliability">Reliability</h2>
<p>Getting software up &amp; running is one thing; ensuring its reliability is another. Databases, central to information systems, are often critical, with failure leading to catastrophic consequences. This reflects common experience: while office software crashes can be tolerated and resolved with restarts, document loss or corruption is unresolvable and disastrous. Database failure without replica &amp; backups can be terminal, particularly for internet/finance companies.</p>
<p><strong>Reliability</strong> is the paramount attribute for databases. It&rsquo;s the system&rsquo;s ability to function correctly during adversity (hardware/software faults, human error), i.e. fault tolerance and resilience. Unlike <strong>liveness attribute</strong> such as performance, reliability, a safety attribute, proves itself over time or falsify by failures, often overlooked until disaster strikes.</p>
<p>Docker&rsquo;s description notably omits &ldquo;reliability&rdquo; —— the crucial attribute for database.</p>
<h3 id="reliability-proof">Reliability Proof</h3>
<p>As mentioned, reliability lacks a definitive measure. Confidence in a system&rsquo;s reliability builds over time through consistent, correct operation (MTTF). Deploying databases on bare metal has been a long-standing practice, proven reliable over decades. Docker, despite revolutionizing DevOps, has a mere ten-year track record, which is insufficient for establishing reliability, especially for mission-critical production databases. In essence, <strong>there haven&rsquo;t been enough &ldquo;guinea pigs&rdquo; to clear the minefield</strong>.</p>
<h3 id="community-knowledge">Community Knowledge</h3>
<p>Improving reliability hinges on learning from failures. Failures are invaluable, turning unknowns into knowns and forming the bedrock of operational knowledge. <strong>Community experience with failures is predominantly based on bare-metal deployments</strong>, with a plethora of issues well-trodden over decades. Encountering a problem often means finding a well-documented solution, thanks to previous experiences. However, add &ldquo;Docker&rdquo; to the mix, and the pool of useful information shrinks significantly. This implies a lower success rate in data recovery and longer times to resolve complex issues when they arise.</p>
<blockquote>
<p>A subtle reality is that, without compelling reasons, businesses and individuals are generally reluctant to share experiences with failures. Failures can tarnish a company’s reputation, potentially exposing sensitive data or reflecting poorly on the organization and team. Moreover, insights from failures are often the result of costly lessons and financial losses, representing core value for operations personnel, thus public documentation on failures is scarce.</p>
</blockquote>
<h3 id="extra-failure-point">Extra Failure Point</h3>
<p>Running databases in Docker doesn&rsquo;t reduce the chances of hardware failures, software bugs, or human errors. Hardware issues persist with or without Docker. Software defects, mainly application bugs, aren&rsquo;t lessened by containerization, and the same goes for human errors. In fact, Docker introduces <strong>extra components, complexity, and failure points, decreasing overall system reliability</strong>.</p>
<p>Consider this simple scenario: if the Docker daemon crashes, the database process dies. Such incidents, albeit rare, are non-existent on bare-metal.</p>
<p>Moreover, the failure points from an additional component like Docker aren’t limited to Docker itself. Issues could arise from interactions between Docker and the database, the OS, orchestration systems, VMs, networks, or disks. For evidence, see the issue tracker for the official PostgreSQL Docker image: <a href="https://github.com/docker-library/postgres/issues?q=">https://github.com/docker-library/postgres/issues?q=</a>.</p>
<p><strong>Intellectual power doesn&rsquo;t easily stack</strong> — a team&rsquo;s intellect relies on the few seasoned members and their communication overhead. Database issues require database experts; container issues, container experts. However, when databases are deployed on kubernetes &amp; dockers, merging the expertise of database and K8S specialists is challenging — you need a dual-expert to resolve issues, and such individuals are rarer than specialists in one domain.</p>
<p>Moreover, one man&rsquo;s meat is another man&rsquo;s poison. Certain Docker features might turn into bugs under specific conditions.</p>
<h3 id="unnecessary-isolation">Unnecessary Isolation</h3>
<p>Docker provides process-level isolation, which generally benefits applications by reducing interaction-related issues, thereby enhancing system reliability. However, this isolation isn&rsquo;t always advantageous for databases.</p>
<p>A subtle <strong>real-world case</strong> involved starting two PostgreSQL server on the same data directory, either on the host or one in the host and another inside a container. On bare metal, the second instance would fail to start as PostgreSQL recognizes the existing instance and refuses to launch; however, Docker&rsquo;s <strong>isolation</strong> allows the second instance to start obliviously, potentially <strong>toast</strong> the data files if proper fencing mechanisms (like host port or PID file exclusivity) aren&rsquo;t in place.</p>
<p>Do databases need isolation? Absolutely, but not this kind. Databases often demand dedicated physical machines for performance reasons, with only the database process and essential tools running. Even in containers, they&rsquo;re typically bound exclusively to physical/virtual machines. Thus, the type of isolation Docker provides is somewhat irrelevant for such deployments, though it is a handy feature for cloud providers to efficiently oversell in a multi-tenant environment.</p>
<hr>
<h2 id="maintainability">Maintainability</h2>
<blockquote>
<p>Docker simplify the day one setup, but bring much more troubles on day two operation.</p>
</blockquote>
<p>The bulk of software expenses isn&rsquo;t in initial development but in ongoing maintenance, which includes fixing vulnerabilities, ensuring operational continuity, handling outages, upgrading versions, repaying technical debt, and adding new features. Maintainability is crucial for the quality of life in operations work. Docker shines in this aspect with its infrastructure-as-code approach, effectively turning operational knowledge into reusable code, accumulating it in a streamlined manner rather than scattered across various installation/setup documents. Docker excels here, especially for stateless applications with frequently changing logic. Docker and Kubernetes facilitate deployment, scaling, publishing, and rolling upgrades, allowing Devs to perform Ops tasks, and Ops to handle DBA duties (somewhat convincingly).</p>
<h3 id="day-1-setup">Day 1 Setup</h3>
<p>Perhaps Docker&rsquo;s greatest strength is the standardization of environment configuration. A standardized environment aids in delivering changes, discussing issues, and reproducing bugs. Using binary images (essentially materialized Dockerfile installation scripts) is quicker and easier to manage than running installation scripts. Not having to rebuild complex, dependency-heavy extensions each time is a notable advantage.</p>
<p>Unfortunately, databases don&rsquo;t behave like typical business applications with frequent updates, and creating new instances or delivering environments is a rare operation. Additionally, DBAs often accumulate various installation and configuration scripts, making environment setup almost as fast as using Docker. Thus, Docker&rsquo;s advantage in environment configuration isn&rsquo;t as pronounced, falling into the &ldquo;nice to have&rdquo; category. Of course, in the absence of a dedicated DBA, using Docker images might still be preferable as they encapsulate some operational experience.</p>
<p>Typically, it&rsquo;s not unusual for databases to run continuously for months or years after initialization. The primary aspect of database management isn&rsquo;t creating new instances or delivering environments, but the day-to-day operations — Day2 Operation. Unfortunately, Docker doesn&rsquo;t offer much benefit in this area and can introduce additional complications.</p>
<h3 id="day2-operation">Day2 Operation</h3>
<p>Docker can significantly streamline the maintenance of stateless apps, enabling easy create/destroy, version upgrades, and scaling. However, does this extend to databases?</p>
<p>Unlike app containers, database containers can&rsquo;t be freely destroyed or created. Docker doesn&rsquo;t enhance the operational experience for databases; tools like Ansible are more beneficial. Often, operations require executing scripts inside containers via <code>docker exec</code>, adding unnecessary complexity.</p>
<p>CLI tools often struggle with Docker integration. For instance, <code>docker exec</code> mixes <code>stderr</code> and <code>stdout</code>, breaking pipeline-dependent commands. In bare-metal deployments, certain ETL tasks for PostgreSQL can be easily done with a single Bash line.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>psql &lt;src-url&gt; -c <span style="color:#4e9a06">&#39;COPY tbl TO STDOUT&#39;</span> <span style="color:#000;font-weight:bold">|</span> psql &lt;dst-url&gt; -c <span style="color:#4e9a06">&#39;COPY tdb FROM STDIN&#39;</span>
</span></span></code></pre></div><p>Yet, without proper client binaries on the host, one must awkwardly use Docker&rsquo;s binaries like:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker <span style="color:#204a87">exec</span> -it srcpg gosu postgres bash -c <span style="color:#4e9a06">&#34;psql -c \&#34;COPY tbl TO STDOUT\&#34; 2&gt;/dev/null&#34;</span> <span style="color:#000;font-weight:bold">|</span><span style="color:#4e9a06">\ </span>
</span></span><span style="display:flex;"><span>  docker <span style="color:#204a87">exec</span> -i dstpg gosu postgres psql -c <span style="color:#4e9a06">&#39;COPY tbl FROM STDIN;&#39;</span>
</span></span></code></pre></div><p>complicating simple commands like physical backups, which require layers of command wrapping:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker <span style="color:#204a87">exec</span> -i postgres_pg_1 gosu postgres bash -c <span style="color:#4e9a06">&#39;pg_basebackup -Xf -Ft -c fast -D - 2&gt;/dev/null&#39;</span> <span style="color:#000;font-weight:bold">|</span> tar -xC /tmp/backup/basebackup
</span></span></code></pre></div><blockquote>
<p><code>docker</code>, <code>gosu</code>, <code>bash</code>, <code>pg_basebackup</code></p>
</blockquote>
<p>Client-side applications (<code>psql</code>, <code>pg_basebackup</code>, <code>pg_dump</code>) can bypass these issues with version-matched client tools on the host, but server-side solutions lack such workarounds. Upgrading containerized database software shouldn&rsquo;t necessitate host server binary upgrades.</p>
<p>Docker advocates for easy software versioning; updating a minor database version is straightforward by tweaking the Dockerfile and restarting the container. However, major version upgrades requiring state modification are more complex in Docker, often leading to convoluted processes like those in <a href="https://github.com/tianon/docker-postgres-upgrade">https://github.com/tianon/docker-postgres-upgrade</a>.</p>
<p>If database containers can&rsquo;t be scheduled, scaled, or maintained as easily as AppServers, why use them in production? While stateless apps benefit from Docker and Kubernetes&rsquo; scaling ease, stateful applications like databases don&rsquo;t enjoy such flexibility. Replicating a large production database is time-consuming and manual, questioning the efficiency of using <code>docker run</code> for such operations.</p>
<p>Docker&rsquo;s awkwardness in hosting production databases stems from the stateful nature of databases, requiring additional setup steps. Setting up a new PostgreSQL replica, for instance, involves a local data directory clone and starting the <code>postmaster</code> process. Container lifecycle tied to a single process complicates database scaling and replication, leading to inelegant and complex solutions. This process isolation in containers, or &ldquo;abstraction leakage,&rdquo; fails to neatly cover the multiprocess, multitasking nature of databases, introducing unnecessary complexity and affecting maintainability.</p>
<p>In conclusion, while Docker can improve system maintainability in some aspects, like simplifying new instance creation, the introduced complexities often undermine these benefits.</p>
<h3 id="tooling">Tooling</h3>
<p>Databases require tools for maintenance, including a variety of operational scripts, deployment, backup, archiving, failover, version upgrades, plugin installation, connection pooling, performance analysis, monitoring, tuning, inspection, and repair. Most of these tools are designed for bare-metal deployments. Like databases, these tools need thorough and careful testing. Getting something to run versus ensuring its stable, long-term, and correct operation are distinct levels of reliability.</p>
<p>A simple example is plugin and package management. PostgreSQL offers many useful plugins, such as PostGIS. On bare metal, installing this plugin is as easy as executing <code>yum install</code> followed by <code>create extension postgis</code>. However, in Docker, following best practices requires making changes at the image level to persist the extension beyond container restarts. This necessitates modifying the Dockerfile, rebuilding the image, pushing it to the server, and restarting the database container, undeniably a more cumbersome process.</p>
<p>Package management is a core aspect of OS distributions. Docker complicates this, as many PostgreSQL binaries are distributed not as RPM/DEB packages but as Docker images with pre-installed extensions. This raises a significant issue: how to consolidate multiple disparate images if one needs to use two, three, or over a hundred extensions from the PostgreSQL ecosystem? Compared to reliable OS package management, building Docker images invariably requires more time and effort to function properly.</p>
<p>Take monitoring as another example. In traditional bare-metal deployment, <strong>machine metrics</strong> are crucial for database monitoring. Monitoring in containers differs subtly from that on bare metal, and oversight can lead to pitfalls. For instance, the sum of various CPU mode durations always equals 100% on bare metal, but this assumption doesn&rsquo;t necessarily hold in containers. Moreover, monitoring tools relying on the <code>/proc</code> filesystem may yield metrics in containers that differ significantly from those on bare metal. While such issues are solvable (e.g., mounting the Proc filesystem inside the container), complex and ugly workarounds are generally unwelcome compared to straightforward solutions.</p>
<p>Similar issues arise with some failure detection tools and common system commands. Theoretically, these could be executed directly on the host, but can we guarantee that the results in the container will be identical to those on bare metal? More frustrating is the emergency troubleshooting process, where necessary tools might be missing in the container, and with no external network access, the Dockerfile→Image→Restart path can be exasperating.</p>
<p>Treating Docker like a VM, many tools may still function, but this defeats much of Docker&rsquo;s purpose, reducing it to just another package manager. Some argue that Docker enhances system reliability through standardized deployment, given the more controlled environment. While this is true, I believe that if the personnel managing the database understand how to configure the database environment, there&rsquo;s no fundamental difference between scripting environment initialization in a Shell script or in a Dockerfile.</p>
<hr>
<h2 id="scalability">Scalability</h2>
<p>Performance is another point that people concerned a lot. From the performance perspective, the basic principle of  database deployment is: The close to hardware, The better it is.  Additional isolation &amp; abstraction layer is bad for database performance. More isolation means more overhead, even if it is just an additional <code>memcpy</code> in the kernel .</p>
<p>For performance-seeking scenarios, some databases choose to bypass the operating system&rsquo;s page management mechanism to operate the disk directly, while some databases may even use FPGA or GPU to speed up query processing. Docker as a lightweight container, performance suffers not much, and the impact to performance-insensitive scenarios may not be significant, but the extra abstract layer will definitely make performance worse than make it better.</p>
<hr>
<h2 id="summary">Summary</h2>
<p>Container and orchestration technologies are valuable for operations, bridging the gap between software and services by aiming to codify and modularize operational expertise and capabilities. Container technology is poised to become the future of package management, while orchestration evolves into a &ldquo;data center distributed cluster operating system,&rdquo; forming the underlying infrastructure runtime for all software. As more challenges are addressed, confidently running both stateful and stateless applications in containers will become feasible. However, for databases, this remains an ideal rather than a practical option, especially in production.</p>
<p>It&rsquo;s crucial to reiterate that the above discussion applies specifically to <strong>production databases</strong>. For development and testing, despite the existence of Vagrant-based virtual machine sandboxes, I advocate for Docker use—many developers are unfamiliar with configuring local test database environments, and Docker provides a clearer, simpler solution. For stateless production applications or those with non-critical derivative state data (like Redis caches), Docker is a good choice. But for core relational databases in production, where data integrity is paramount, one should carefully consider the risks and benefits: What&rsquo;s the value of using Docker here? Can it handle potential issues? Are you prepared to assume the responsibility if things go wrong?</p>
<p>Every technological decision involves balancing pros and cons, like the core trade-off here of <strong>sacrificing reliability for maintainability</strong> with Docker. Some scenarios may warrant this, such as cloud providers optimizing for containerization to oversell resources, where container isolation, high resource utilization, and management convenience align well. Here, the benefits might outweigh the drawbacks. However, in many cases, reliability is the top priority, and compromising it for maintainability is not advisable. Moreover, it&rsquo;s debatable whether using Docker significantly eases database management; sacrificing long-term operational maintainability for short-term deployment ease is unwise.</p>
<p>In conclusion, containerizing production databases is likely not a prudent choice.</p>

</div>





    
	
  

    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-5bcbeca414ff09093cc0deadee97e7ca">Cloud Exit</h1>
	
	<div class="td-byline mb-4">
		
        
	</div>
	
</div>





    
      
  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-7f57c973bb7756d9b0ca9b96892a6d2d">S3: Elite to Mediocre</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/HathxpQ_KUuqxyrtyCDzWw">WeChat</a></b> |
        
		<time datetime="2023-12-26" class="text-muted">2023-12-26</time>
        
	</div>
	<p>Object storage (S3) has been a defining service of cloud computing, once hailed as a paragon of cost reduction in the cloud era. Unfortunately, with the evolution of hardware and the emergence of resources cloud (Cloudflare R2) and open-source alternatives (MinIO), the once &ldquo;cost-effective&rdquo; object storage services have lost their value for money, becoming as much a &ldquo;cash cow&rdquo; as EBS. In our &ldquo;Mudslide of Cloud Computing&rdquo; series, we&rsquo;ve already delved into the cost structure of cloud-based EC2 compute power, EBS disks, and RDS databases. Today, let&rsquo;s examine the anchor of cloud services—object storage.</p>
<p><a href="https://mp.weixin.qq.com/s/HathxpQ_KUuqxyrtyCDzWw"><img src="/zh/blog/cloud/s3/featured.webp"></a></p>
<hr>
<h2 id="from-cost-reduction-to-cash-cow">From Cost Reduction to Cash Cow</h2>
<p><strong>Object Storage</strong>, also known as Simple Storage Service (abbreviated as <strong>S3</strong>, hereafter referred to as S3), was once the flagship product for its cost-effectiveness in the cloud.</p>
<p>A decade ago, hardware was expensive; managing to use a bunch of several hundred GB mechanical hard drives to build a reliable storage service and design an elegant HTTP API was a significant barrier. Therefore, compared to those &ldquo;enterprise IT&rdquo; storage solutions, the cost-effective S3 seemed very attractive.</p>
<p>However, the field of computer hardware is quite unique—with a Moore&rsquo;s Law that sees prices halve every two years. AWS S3 has indeed seen several price reductions in its history. The table below organizes the main post-reduction prices for S3 standard tier storage, along with the reference unit prices for enterprise-grade HDD/SSD in the corresponding years.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Date</th>
<th style="text-align:center">$/GB·Month</th>
<th style="text-align:center">¥/TB·5年</th>
<th style="text-align:center">HDD ¥/TB</th>
<th style="text-align:center">SSD ¥/TB</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/cn/blogs/aws/amazon_s3/">2006</a>.03</td>
<td style="text-align:center">0.150</td>
<td style="text-align:center">63000</td>
<td style="text-align:center">2800</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2010/11/what-can-i-say-another-amazon-s3-price-reduction.html">2010</a>.11</td>
<td style="text-align:center">0.140</td>
<td style="text-align:center">58800</td>
<td style="text-align:center">1680</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2012/11/amazon-s3-price-reduction-december-1-2012.html">2012</a>.12</td>
<td style="text-align:center">0.095</td>
<td style="text-align:center">39900</td>
<td style="text-align:center">420</td>
<td style="text-align:center">15400</td>
</tr>
<tr>
<td style="text-align:center"><a href="http://aws.typepad.com/aws/2014/03/aws-price-reduction-42-ec2-s3-rds-elasticache-and-elastic-mapreduce.html">2014</a>.04</td>
<td style="text-align:center">0.030</td>
<td style="text-align:center">12600</td>
<td style="text-align:center">371</td>
<td style="text-align:center">9051</td>
</tr>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/ru/blogs/aws/aws-storage-update-s3-glacier-price-reductions/">2016</a>.12</td>
<td style="text-align:center">0.023</td>
<td style="text-align:center">9660</td>
<td style="text-align:center">245</td>
<td style="text-align:center">3766</td>
</tr>
<tr>
<td style="text-align:center"><a href="https://aws.amazon.com/cn/s3/pricing">2023</a>.12</td>
<td style="text-align:center">0.023</td>
<td style="text-align:center">9660</td>
<td style="text-align:center">105</td>
<td style="text-align:center">280</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Price Ref</strong></th>
<th style="text-align:center"><strong>EBS</strong></th>
<th style="text-align:center"><strong>All Upfront</strong></th>
<th style="text-align:center"><strong>Buy NVMe SSD</strong></th>
<th style="text-align:center"><strong>Price Ref</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S3 Express</td>
<td style="text-align:center">0.160</td>
<td style="text-align:center">67200</td>
<td style="text-align:center">DHH 12T</td>
<td style="text-align:center">1400</td>
</tr>
<tr>
<td style="text-align:center">EBS io2</td>
<td style="text-align:center">0.125 + IOPS</td>
<td style="text-align:center">114000</td>
<td style="text-align:center">Shannon 3.2T</td>
<td style="text-align:center">900</td>
</tr>
</tbody>
</table>
<p>It&rsquo;s not hard to see that the unit price of S3&rsquo;s standard tier dropped from <strong>$0.15/GB·month</strong> in 2006 to <strong>$0.023/GB·month</strong> in 2023, a reduction to <strong>15%</strong> of the original or a <strong>6-fold</strong> decrease, which sounds good. However, when you consider that the price of the underlying HDDs for S3 dropped to <strong>3.7%</strong> of their original, a whopping <strong>26-fold</strong> decrease, the trickery becomes apparent.</p>
<p><strong>The resource premium multiple of S3 increased from 7 times in 2006 to 30 times today!</strong></p>
<p>In 2023, when we re-calculate the costs, it&rsquo;s clear that the value for money of storage services like S3/EBS has changed dramatically—cloud computing power EC2 compared to building one&rsquo;s own servers has a 5 – 10 times premium, while cloud block storage EBS has a several dozen to a hundred times premium compared to local SSDs. Cloud-based S3 compared to ordinary HDDs also has about a thirty times resource premium. And as the anchor of cloud services, the prices of S3/EBS/EC2 are passed on to almost all cloud services—completely stripping cloud services of their cost-effectiveness.</p>
<p>The core issue here is: <strong>The price of hardware resources drops exponentially according to Moore&rsquo;s Law, but the savings are not passed through the cloud providers&rsquo; intermediary layer to the end-user service prices.</strong> <strong>To not advance is to go back; failing to reduce prices at the pace of Moore&rsquo;s Law is effectively a price increase</strong>. Taking S3 as an example, over the past decade, cloud providers&rsquo; S3 has nominally reduced prices by 6-fold, but hardware resources have become 26 times cheaper, so how should we view this pricing now?</p>
<hr>
<h2 id="cost-performance-throughput">Cost, Performance, Throughput</h2>
<p>Despite the high premiums of cloud services, if it represents an irreplaceable <strong>best choice</strong>, the use by high-value, price-insensitive top-tier customers is not affected even with a high premium and low cost-effectiveness. However, it&rsquo;s not just about cost; the performance of storage hardware also follows Moore&rsquo;s Law. Over time, building one&rsquo;s own S3 has started to show a significant advantage in performance.</p>
<p>The performance of S3 is mainly reflected in its <strong>throughput</strong>. AWS S3&rsquo;s 100 Gb/s network provides up to 12.5 GB/s of access bandwidth, which is indeed commendable. Such throughput was undoubtedly impressive a decade ago. However, today, an enterprise-level 12 TB NVMe SSD, costing less than $20,000, can achieve 14 GB/s of read/write bandwidth. 100Gb switches and network cards have also become very common, making such performance readily achievable.</p>
<p>In another key performance indicator, &ldquo;latency,&rdquo; S3 is significantly outperformed by local disks. The first-byte latency of the S3 standard tier is quite poor, ranging between <strong>100-200ms</strong> according to the documentation. Of course, AWS has just launched &ldquo;High-Performance S3&rdquo; — <strong>S3 Express One Zone</strong> at 2023 Re:Invent, which can achieve millisecond-level latency, addressing this shortcoming. However, it still falls far short of the NVMe&rsquo;s 4K random read/write latency of <strong>55µs/9µs</strong>.</p>
<p>S3 Express&rsquo;s millisecond-level latency sounds good, but when we compare it to a self-built NVMe SSD + MinIO setup, this &ldquo;millisecond-level&rdquo; performance is embarrassingly inadequate. Modern NVMe SSDs achieve 4K random read/write latencies of 55µs/9µs. With a thin layer of MinIO forwarding, the first-byte output latency is at least an order of magnitude better than S3 Express. If standard tier S3 is used for comparison, the performance gap widens to three orders of magnitude.</p>
<p>The gap in performance is just one aspect; the cost is even more crucial. The price of standard tier S3 has remained unchanged since 2016 at $0.023/GB·month, equating to <strong>161 RMB/TB·month</strong>. The higher-tier S3 Express One Zone is an order of magnitude more expensive, at <strong>$0.16/GB·month</strong>, equating to <strong>1120 RMB/TB·month</strong>. For reference, we can compare the data from <a href="https://mp.weixin.qq.com/s/1OSRcBfd58s0tgZTUZHB9g">&ldquo;Reclaiming the Dividends of Computer Hardware&rdquo;</a> and <a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">&ldquo;Is Cloud Storage a Cash Cow?&rdquo;</a>:</p>
<table>
<thead>
<tr>
<th><strong>Factor</strong></th>
<th><strong>Local PCI-E NVME SSD</strong></th>
<th><strong>Aliyun ESSD PL3</strong></th>
<th><strong>AWS io2 Block Express</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Cost</td>
<td><strong>14.5 RMB/TB·month</strong> (5-year amortization / 3.2T MLC) 5-year warranty, ¥3000 retail</td>
<td><strong>3200 RMB/TB·month</strong> (Original price 6400 RMB, monthly package 4000 RMB) 50% discount for 3-year upfront payment</td>
<td><strong>1900 RMB/TB·month</strong> Best discount for the largest specification 65536GB 256K IOPS</td>
</tr>
<tr>
<td>Capacity</td>
<td>32TB</td>
<td>32 TB</td>
<td>64 TB</td>
</tr>
<tr>
<td>IOPS</td>
<td>4K random read: 600K ~ 1.1M 4K random write 200K ~ 350K</td>
<td>Max 4K random read: 1M</td>
<td>16K random IOPS: 256K</td>
</tr>
<tr>
<td>Latency</td>
<td>4K random read: 75µs 4K random write: 15µs</td>
<td>4K random read: 200µs</td>
<td>Random IO: 500µs (assumed 16K)</td>
</tr>
<tr>
<td>Reliability</td>
<td>UBER &lt; 1e-18, equivalent to 18 nines MTBF: 2 million hours 5DWPD, over three years</td>
<td>Data reliability: 9 nines <a href="https://help.aliyun.com/document_detail/476273.html">Storage and Data Reliability</a></td>
<td><strong>Durability</strong>: 99.999%, 5 nines (0.001% annual failure rate) <a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">io2 details</a></td>
</tr>
<tr>
<td>SLA</td>
<td>5-year warranty, direct replacement for issues</td>
<td><a href="https://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201910310944_35008.html?spm=a2c4g.11186623.0.0.270e6e37n8Exh5">Aliyun RDS SLA</a> Availability 99.99%: 15% monthly fee 99%: 30% monthly fee 95%: 100% monthly fee</td>
<td><a href="https://d1.awsstatic.com/legal/amazonrdsservice/Amazon-RDS-Service-Level-Agreement-Chinese.pdf">Amazon RDS SLA</a> Availability 99.95%: 15% monthly fee 99%: 25% monthly fee 95%: 100% monthly fee</td>
</tr>
</tbody>
</table>
<p>e local NVMe SSD example used here is the Shannon DirectIO G5i 3.2TB MLC particle enterprise-level SSD, extensively used by us. Brand new, disassembled retail pieces are priced at ¥2788 (available on Xianyu!), translating to a monthly cost per TB of 14.5 RMB over 60 months (5 years). Even if we calculate using the Inspur list price of ¥4388, the cost per TB·month is only 22.8. If this example is not convincing enough, we can refer to the 12 TB Gen4 NVMe enterprise-level SSDs purchased by DHH in <a href="https://mp.weixin.qq.com/s/CicctyvV1xk5B-AsKfzPjw">&ldquo;Is It Time to Give Up on Cloud Computing?&rdquo;</a>, priced at $2390 each, with a cost per TB·month of exactly <strong>23</strong> RMB.</p>
<p>So, why are NVMe SSDs, which outperform by several orders of magnitude, priced an order of magnitude cheaper than standard tier S3 (161 vs 23) and two orders of magnitude cheaper than S3 Express (1120 vs 23 x3)? If I were to use such hardware (even accounting for triple replication) + open-source software to build an object storage service, could I achieve a three orders of magnitude improvement in cost-effectiveness? (This doesn&rsquo;t even account for the reliability advantages of SSDs over HDDs.)</p>
<p>It&rsquo;s worth noting that the comparison above focuses solely on the cost of storage space. The cost of data transfer in and out of object storage is also a significant expense, with some tiers charging not for storage but for retrieval traffic. Additionally, there are issues of SSD reliability compared to HDD, data sovereignty in the cloud, etc., which will not be elaborated further here.</p>
<p>Of course, cloud providers might argue that their S3 service is not just about storage hardware resources but an out-of-the-box <strong>service</strong>. This includes software intellectual property and maintenance labor costs. They may claim that self-hosting has a higher failure rate, is riskier, and incurs significant operational labor costs. Unfortunately, these arguments might have been valid in 2006 or 2013, but they seem rather ludicrous today.</p>
<hr>
<h2 id="self-hosted-oss-s3">Self-Hosted OSS S3</h2>
<p>A decade and a half ago, the vast majority of users lacked the IT capabilities to self-host, and there were no mature open-source alternatives to S3. Users could tolerate the premium for this high technology. However, as various cloud providers and IDCs began offering object storage, and even open-source free object storage solutions like MinIO emerged, the market shifted from a seller&rsquo;s to a buyer&rsquo;s market. The logic of value pricing turned into cost pricing, and the unyielding premium on resources naturally faced scrutiny — what extra value does it actually provide to justify such significant costs?</p>
<p>Proponents of cloud storage claim that moving to the cloud is cheaper, simpler, and faster than self-hosting. For individual webmasters and small to medium-sized internet companies within the cloud&rsquo;s suitable spectrum, this claim certainly holds. If your data scale is only a few dozen GBs, or you have some medium-scale overseas business and CDN needs, I would not recommend jumping on the bandwagon to self-host object storage. You should instead turn to Cloudflare and use R2 — perhaps the best solution.</p>
<p>However, for the truly high-value, medium-to-large scale customers who contribute the majority of revenue, these value propositions do not necessarily hold. If you are primarily using local storage for TB/PB scale data, then you should seriously consider the cost and benefits of self-hosting object storage services — which has become very simple, stable, and mature with open-source software. Storage service reliability mainly depends on disk redundancy: apart from occasional hard drive failures (HDD AFR 1%, SSD 0.2-0.3%), requiring you (or a maintenance service provider) to replace parts, there isn&rsquo;t much additional burden.</p>
<p>If the open-source Ceph, which mixes EBS/S3 capabilities, is considered somewhat operationally complex and not fully feature-complete; then the fully S3-compatible object storage service MinIO can be considered truly plug-and-play — a standalone binary without external dependencies, requiring only a few configuration parameters to quickly set up, transforming server disk arrays into a standard local S3-compatible service, even integrating AWS&rsquo;s AK/SK/IAM compatible implementations!</p>
<p>From an operational management perspective, the operational complexity of Redis is an order of magnitude lower than PostgreSQL, and MinIO&rsquo;s operational complexity is another order of magnitude lower than Redis. It&rsquo;s so simple that I could spend less than a week to integrate MinIO deployment/monitoring as an add-on into our open-source PostgreSQL RDS solution, serving as an optional central backup storage repository.</p>
<p>At Tantan, several MinIO clusters were built and maintained this way: holding 25PB of data, possibly the largest scale of MinIO deployment in China at the time. How many people were needed for maintenance? Just a fraction of one operations engineer&rsquo;s working time was enough, and the overall self-hosting cost was about half of the cloud list price. Practice proves the point, if anyone tells you that self-hosting object storage is difficult and expensive, you can try it yourself — in just a few hours, these sales FUD tactics will fall apart.</p>
<p>For object storage services, the cloud&rsquo;s three core value propositions: &ldquo;cheaper, simpler, faster&rdquo;, the &ldquo;simpler&rdquo; part may not hold up, &ldquo;cheaper&rdquo; has turned the other way, probably only leaving &ldquo;faster&rdquo; — indeed, no one can beat the cloud on this point. You can apply for PB-level storage services across all regions of the world in less than a minute on the cloud, which is amazing! However, you also have to pay a high premium, several times to dozens of times over for this privilege.</p>
<p>Therefore, for object storage services, among the cloud&rsquo;s three core value propositions: &ldquo;cheaper, simpler, faster&rdquo;, the &ldquo;simpler&rdquo; part may not hold, and &ldquo;cheaper&rdquo; has gone in the opposite direction, probably only leaving &ldquo;faster&rdquo; — indeed, no one can beat the cloud on this point. You can indeed apply for PB-level storage services across all regions of the world in less than a minute on the cloud, which is amazing! However, you also have to pay a high premium for this privilege, several to dozens of times over. For enterprises of a certain scale, compared to the cost of operations increasing several times, waiting a couple of weeks or making a one-time capital investment is not a big deal.</p>
<hr>
<h2 id="summary">Summary</h2>
<p>The exponential decline in hardware costs has not been fully reflected in the service prices of cloud providers, turning public clouds from universally beneficial infrastructure into monopolistic profit centers.</p>
<p>However, the tide is turning. Hardware is becoming interesting again, and cloud providers can no longer indefinitely hide this advantage. The savvy are starting to crunch the numbers, and the bold have already taken action. Pioneers like Elon Musk and DHH have fully realized this, moving away from the cloud to reap millions in financial benefits, enjoy performance gains, and gain more operational independence. More and more people are beginning to notice this, following in the footsteps of these pioneers to make the wise choice and reclaim their hardware dividends.</p>
<h3 id="references">References</h3>
<p><code>[1]</code> 2006: <em><a href="https://aws.amazon.com/cn/blogs/aws/amazon_s3/">https://aws.amazon.com/cn/blogs/aws/amazon_s3/</a></em></p>
<p><code>[2]</code> 2010: <em><a href="http://aws.typepad.com/aws/2010/11/what-can-i-say-another-amazon-s3-price-reduction.html">http://aws.typepad.com/aws/2010/11/what-can-i-say-another-amazon-s3-price-reduction.html</a></em></p>
<p><code>[3]</code> 2012: <em><a href="http://aws.typepad.com/aws/2012/11/amazon-s3-price-reduction-december-1-2012.html">http://aws.typepad.com/aws/2012/11/amazon-s3-price-reduction-december-1-2012.html</a></em></p>
<p><code>[4]</code> 2014: <em><a href="http://aws.typepad.com/aws/2014/03/aws-price-reduction-42-ec2-s3-rds-elasticache-and-elastic-mapreduce.html">http://aws.typepad.com/aws/2014/03/aws-price-reduction-42-ec2-s3-rds-elasticache-and-elastic-mapreduce.html</a></em></p>
<p><code>[5]</code> 2016: <em><a href="https://aws.amazon.com/ru/blogs/aws/aws-storage-update-s3-glacier-price-reductions/">https://aws.amazon.com/ru/blogs/aws/aws-storage-update-s3-glacier-price-reductions/</a></em></p>
<p><code>[6]</code> 2023: <em><a href="https://aws.amazon.com/cn/s3/pricing">https://aws.amazon.com/cn/s3/pricing</a></em></p>
<p><code>[7]</code> First-byte Latency: <em><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/optimizing-performance.html">https://docs.aws.amazon.com/AmazonS3/latest/userguide/optimizing-performance.html</a></em></p>
<p><code>[8]</code> Storage &amp; Reliability: <em><a href="https://help.aliyun.com/document_detail/476273.html">https://help.aliyun.com/document_detail/476273.html</a></em></p>
<p><code>[9]</code> EBS io2 Spec: <em><a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/</a></em></p>
<p><code>[10]</code> Aliyun RDS SLA: <em><a href="https://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201910310944_35008.html?spm=a2c4g.11186623.0.0.270e6e37n8Exh5">https://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201910310944_35008.html?spm=a2c4g.11186623.0.0.270e6e37n8Exh5</a></em></p>
<p><code>[11]</code> Amazon RDS SLA: <em><a href="https://d1.awsstatic.com/legal/amazonrdsservice/Amazon-RDS-Service-Level-Agreement-Chinese.pdf">https://d1.awsstatic.com/legal/amazonrdsservice/Amazon-RDS-Service-Level-Agreement-Chinese.pdf</a></em></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-80ebd4282641b01facdbdf7ef86ea752">Reclaim Hardware Bonus from the Cloud</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/1OSRcBfd58s0tgZTUZHB9g">WeChat</a></b> |
        
		<time datetime="2023-11-16" class="text-muted">2023-11-16</time>
        
	</div>
	<p>Hardware is interesting again, with the AI wave fueling a GPU frenzy. However, the intrigue isn’t limited to GPUs —— developments in CPUs and SSDs remain largely unnoticed by the majority of devs. A whole generation of developers is obscured by cloud hype and marketing noise.</p>
<p>Hardware performance is skyrocketing, and costs are plummeting, turning the public cloud from a decent service into a cash cow. These shifts necessitate a reevaluation of technology and software. It&rsquo;s time to get back to basics and reclaim the hardware dividend that belongs to users.</p>
<p><a href="https://mp.weixin.qq.com/s/1OSRcBfd58s0tgZTUZHB9g"><img src="/zh/blog/cloud/bonus/featured.jpg"></a></p>
<hr>
<h2 id="revolutionary-new-hardware">Revolutionary New Hardware</h2>
<p>If you&rsquo;ve been unaware of computer hardware for a while, the specs of the latest gear might shock you.</p>
<p>Once, Intel’s CPUs saw marginal gains each generation, allowing old PCs to remain viable year after year. However, CPU evolution has recently accelerated, with significant leaps in core counts and regular 20-30% improvements in <a href="https://www.tomshardware.com/pc-components/cpus/core-i9-14900ks-overclocked-to-91-ghz-breaking-numerous-world-records">single-core performance</a>.</p>
<p>For instance, AMD&rsquo;s recently released desktop CPU, the <a href="https://www.amd.com/en/products/cpu/amd-ryzen-threadripper-pro-7995wx">Threadripper 7995WX</a>, is a performance beast with 96 cores and 192 threads at speeds ranging from 2.5 to 5.1 GHz, retailing on Amazon for $5600. The server CPU series, EPYC, includes the previous generation <a href="https://www.amd.com/en/products/cpu/amd-epyc-9654">EPYC Genoa 9654</a>, with 96 cores and 192 threads at speeds ranging from 2.4 to 3.55 GHz, priced at $3940 on Amazon. This year&rsquo;s new <a href="https://www.amd.com/zh-hans/products/cpu/amd-epyc-9754">EPYC 9754</a> goes even further, offering a single CPU with 128 cores and 256 threads. This means a standard dual-socket server could have an astonishing 512 threads! If we consider cloud computing/container platforms&rsquo; 500% overselling rate, this could virtualize more than two thousand five hundred 1-core virtual machines.</p>
<p>Take AMD&rsquo;s new <a href="https://www.amd.com/en/products/cpu/amd-ryzen-threadripper-pro-7995wx">Threadripper 7995WX</a>, a 96-core, 192-thread behemoth clocked at 2.5 to 5.1 GHz, retailing at $5600 on Amazon. On the server side, the previous-gen <a href="https://www.amd.com/en/products/cpu/amd-epyc-9654">EPYC Genoa 9654</a> offered 96 cores and 192 threads at 2.4 to 3.55 GHz, priced at $3940. The latest <a href="https://www.amd.com/en/products/cpu/amd-epyc-9754">EPYC 9754</a> pushes boundaries further with 128 cores and 256 threads, enabling a dual-socket server to boast a staggering 512 vCPUs — enough to oversubscribe and virtualize over 2500+ 1c VMs at 500% oversell rates.</p>
<p><img alt="epyc-list.png" src="/zh/blog/cloud/bonus/bonus-epyc-list.png"></p>
<hr>
<p>SSD/NVMe storage has seen even more dramatic generational jumps. Speeds have escalated from Gen2’s 500MB/s to Gen3’s 2.5GB/s, and now Gen4’s mainstream 7GB/s, with Gen5 at 14GB/s emerging. Gen6 is released, with Gen7 on the horizon, as I/O bandwidth doubles exponentially.</p>
<p><img alt="io-bandwidth.png" src="/zh/blog/cloud/bonus/bonus-io-bandwidth.png"></p>
<p>Consider the Gen5 NVMe SSD: <a href="https://www.storagereview.com/review/kioxia-cm7-gen5-enterprise-ssd-review">KIOXIA CM7</a>, which offers 128K sequential read bandwidth of 14GB/s and write bandwidth of 7GB/s, with 4K random IOPS of 2.7M for reads and 600K for writes. It&rsquo;s doubtful that many database software packages can fully utilize this insane read/write bandwidth and IOPS. For context, HDD generally fluctuates around a read/write bandwidth of a few hundred MB/s, with 7200 RPM drives achieving IOPS in the tens and 15000 RPM drives in the low hundreds. <strong>NVMe SSDs&rsquo; I/O bandwidth rates are already four orders of magnitude better than HDD — 10,000x better.</strong></p>
<p>In terms of 4K RankRW response times, which are of utmost concern for databases, NVMe SSDs have achieved 55/9 µs for reads &amp; writes since several generations ago. Meanwhile, HDD seek time usually measures around 10ms, with an average rotational latency depending on speed between 2ms and 4ms, meaning a single I/O operation typically takes over a dozen milliseconds. Comparing dozens of milliseconds to 55/9µs, <strong>NVMe SSDs are three orders of magnitude faster than mechanical disks — 1000x faster!</strong></p>
<hr>
<p>Besides computing and storage, network hardware has also improved significantly. 40GbE and 100GbE are now commonplace — a 100GbE optical module network card costs just about several hundred dollars, offering a network transfer speed of 12 GB/s, <strong>a hundred times faster</strong> than the gigabit network cards familiar to older programmers.</p>
<p><img alt="Ethernet Speeds: chart" src="/zh/blog/cloud/bonus/bonus-ethernet.png"></p>
<blockquote>
<p><a href="https://www.synopsys.com/blogs/chip-design/1-6t-ethernet-specification-ip.html">1.6T Ethernet</a> is already on the radar.</p>
</blockquote>
<p>As computing, storage, and networking hardware evolve exponentially following Moore&rsquo;s Law, hardware becomes fascinating again. But the real intrigue lies in how these technological leaps will impact the world.</p>
<hr>
<h2 id="distributed-losing-favor">Distributed Losing Favor</h2>
<p>The landscape of hardware has undergone monumental changes over the past decade, rendering many assumptions in the software realm obsolete, such as those concerning <a href="/blog/db/distributive-bullshit/">distributed databases</a>.</p>
<p>Today, the capabilities of a standard x86 server have reached astonishing levels. An intriguing <a href="https://thume.ca/2023/01/02/one-machine-twitter/">draft calculation</a> roughly demonstrates the feasibility of running the entirety of Twitter on a modern server (Dell PowerEdge R740xd, with 32 cores, 768GB RAM, 6TB NVMe, 360TB HDD, GPU slots, and 4x40Gbe networking). While you wouldn&rsquo;t do this for production redundancy (using two or three servers might be safer), this calculation indeed raises an interesting question — <strong>Is scalability still a real issue?</strong></p>
<p>At the turn of the century, an Apache server could barely handle a few hundred concurrent requests. The best software struggled with tens of thousands of concurrent connections — the industry&rsquo;s notorious C10K problem, where handling several thousand connections was seen as a feat. However, with the advent of Epoll and Nginx in 2003/2004, &ldquo;high concurrency&rdquo; ceased to be a challenge — any novice who learned to configure Nginx could achieve what masters only dreamed of a few years earlier. &ldquo;Customers in the Eyes of Cloud Providers: Poor, Idle, and Lacking Love&rdquo; details this evolution.</p>
<p>As of 2023, the impact of hardware has once again revolutionized distributed databases: <strong>Scalability, much like the C10K problem two decades ago, has become a solved issue of the past</strong>. If a service like Twitter can run on a single server, then 99.xxxx+% of services will not exceed the scalability needs that such a server can provide throughout their entire lifecycle. This means the once-prized &ldquo;distributed&rdquo; technology boasted by big tech companies has become redundant with the advent of new hardware — <strong>Anyone still discussing partitioning, distributed databases, and high concurrency on a massive scale is living in the past, having ceased to learn and grow over the past decade.</strong></p>
<p>The foundational assumption of distributed databases — that a single machine&rsquo;s processing power is insufficient to support the load — has been shattered by contemporary hardware. Centralized databases don&rsquo;t even need to lift a finger; their capacity automatically scales to meet demands that most services will never reach in their lifetime. Some might argue that services like WeChat or Alipay require distributed databases, but setting aside whether distributed databases are the only solution, assuming these rare extreme cases can sustain a couple of distributed TP kernels, distributed OLTP databases will no longer be the main direction for database development as network hardware becomes more cost-effective than disk storage. Alibaba&rsquo;s choice of a distributed path for its database progeny, OceanBase, versus its current preference for centralized architectures with PolarDB, serves as a telling example.</p>
<p>In the realm of big data analytics (OLAP), distributed systems might have been essential, but now even this is questionable — for the majority of companies, their entire database volume could potentially be processed on a single server. Scenarios that previously demanded &ldquo;distributed data warehouses&rdquo; might now be addressed by running PostgreSQL or DuckDB on a modern server. True, large internet companies may have PB/ZB-level data scenarios, but even for core internet services, it&rsquo;s rare for a single service&rsquo;s data volume to exceed a single machine&rsquo;s processing limits. For instance, BreachForums&rsquo; recent leak of 5 years of Taobao shopping records (2015-2020, 8.2 billion records) compressed to 600GB, and similarly, the data sizes for JD.com&rsquo;s billions and Pinduoduo&rsquo;s 14.5 billion records are on par. Moreover, companies like Dell or Inspur offer <strong>PB-level</strong> NVMe all-flash storage cabinets, capable of housing the entire U.S. insurance industry&rsquo;s historical data and analysis tasks in a single box for less than $200,000.</p>
<p>The core trade-off of distributed databases is &ldquo;quality for quantity,&rdquo; sacrificing functionality, performance, complexity, and reliability in exchange for greater data capacity and throughput. However, &ldquo;premature optimization is the root of all evil,&rdquo; and designing for unnecessary scale is futile. If scale is no longer an issue, then sacrificing other attributes for unneeded capacity, incurring extra complexity and costs, becomes utterly pointless.</p>
<hr>
<h2 id="cost-of-owning-servers">Cost of Owning Servers</h2>
<p>With new hardware boasting such powerful performance, what about the cost? Moore&rsquo;s Law states that <strong>every 18 to 24 months, processor performance doubles while the cost halves</strong>. Compared to a decade ago, new hardware is not only more powerful but also cheaper.</p>
<p>In &ldquo;<a href="/blog/cloud/odyssey">DHH: The Cloud-Exit Odyssey</a>&rdquo;, we have a fresh example of a public procurement. DHH and 37 Signals purchased a batch of physical machines for their move away from the cloud in 2023: they bought 20 servers from Dell, totaling 4,000-core vCPUs, 7,680GB of memory, and 384TB of NVMe storage, among other things, for a total expenditure of $500,000.</p>
<p>The specific configuration of each server was as follows: Dell R7625 server, 192 vCPU / 384 GB memory: two AMD EPYC 9454 processors (48 cores/96 threads, 2.75 GHz), equipped with 2x vCPU memory (16 x 32GB memory), a 12 TB NVMe Gen4 SSD, plus other components, <strong>at a cost of $20,000 per server ($\19,980), amortized over five years is $333 per month</strong>.</p>
<p>To verify the validity of this quote, we can directly refer to the retail market prices of the core components: the CPU is the EPYC 9654, with a current retail price of $3,725 each, totaling $7,450 for two. 32GB DDR5 ECC server memory, retailing at $128 per stick, 16 sticks total $2,048. Enterprise-grade NVMe SSD 12TB, priced at $2,390. 100G optical module 100GbE QSFP28 priced at $1,804, adding up to around $13,692, plus the server barebone, power supply, system disk, RAID card, fans, etc., the total price of $20,000 is reasonable.</p>
<p>Of course, a server is not just made up of CPUs, memory, hard drives, and network cards; we also need to consider the total cost of ownership. Data centers need to provide these machines with electricity, rack space, and networking, maintenance fees, and reserve redundancy (prices in the US). After accounting for these costs, they are basically on par with the monthly hardware amortization cost, so the comprehensive monthly cost of a server with 192C / 384G / 12T NVMe storage is <strong>$666, which is about $3.5 / vCPU·month</strong>.</p>
<p>I believe DHH&rsquo;s figures are accurate, as at Tantan, from day one, we chose to build our IDC / resource cloud, and after several rounds of cost optimization, we achieved a similar price — our database server model (Dell R730, 64 vCPU / 512GB / 3.2 TB NVMe SSD) plus the cost of manpower, maintenance, electricity, and internet, the <strong>TCO was about $10,400 , with a core-month cost of $2.71 / vCPU·month</strong>. Here is a table for reference on the price per unit of computing power:</p>
<table>
<thead>
<tr>
<th style="text-align:center">BM / EC2 / ECS Specs</th>
<th style="text-align:center">$ / vCPU·Month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">DHH&rsquo;s self-hosted vCPU·Month Price (192C 384G)</td>
<td style="text-align:center"><strong>3.5</strong></td>
</tr>
<tr>
<td style="text-align:center">TanTan IDC self-hosted DC (64C 384G)</td>
<td style="text-align:center"><strong>2.7</strong></td>
</tr>
<tr>
<td style="text-align:center">TanTan container platform (container, oversold 500%)</td>
<td style="text-align:center">1.0</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), hourly</td>
<td style="text-align:center">23.8</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), monthly</td>
<td style="text-align:center">18.2</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), yearly</td>
<td style="text-align:center">15.6</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), 3-year upfront</td>
<td style="text-align:center">10.0</td>
</tr>
<tr>
<td style="text-align:center">Aliyun ECS family c 2x (us-east-1), 5-year upfront</td>
<td style="text-align:center">6.9</td>
</tr>
<tr>
<td style="text-align:center">AWS C5N.METAL 96C (On Demand)</td>
<td style="text-align:center">35.0</td>
</tr>
<tr>
<td style="text-align:center">AWS C5N.METAL 96C (1y Reserve, All Upfront)</td>
<td style="text-align:center">20.6</td>
</tr>
<tr>
<td style="text-align:center">AWS C5N.METAL 96C (3y Reserve, All Upfront)</td>
<td style="text-align:center">12.8</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="cloud-rental-price">Cloud Rental Price</h2>
<p>For reference, we can compare the cost to leasing compute power from AWS EC2. A monthly expense of $666 can get you the best specification without storage, the <a href="https://instances.vantage.sh/aws/ec2/c6in.4xlarge">c6in.4xlarge</a> on-demand instance (16 cores, 32G x 3.5GHz); while the on-demand cost for a <a href="https://instances.vantage.sh/aws/ec2/c6a.metal">c7a.metal</a> instance, which has similar compute and memory specification (192C/384G) but excludes EBS storage, is $7,200 per month, which is 10.8 times the comprehensive local build cost; the lowest monthly cost for a 3-year reserved instance can go down to $2,756, which is still 4.1 times the cost of building your own server. If we calculate the cost per core-month, the price for the majority of AWS EC2 instances ranges between $10 ~ $30, which is roughly a hundred to a few hundred dollars, leading us to a rough conclusion: <strong>the unit price of cloud compute is 5 to 10 times that of self-built solutions</strong>.</p>
<p>Note that these prices do not include the hundredfold premium for EBS cloud storage. In &ldquo;<a href="/blog/cloud/ebs/">Is Cloud Disk a Rip-off?</a>&rdquo;, we&rsquo;ve already detailed the cost comparison between enterprise SSDs and equivalent cloud disks. Here, we can provide two updated reference values: the cost per TB-month for the 12TB enterprise NVMe SSD purchased by DHH (with a five-year warranty) is 24 CNY, while the cost per TB-month for a retail Samsung consumer SSD 990Pro on GameStop can reach an astonishing 6.6 CNY&hellip; Meanwhile, the corresponding block storage TB-month cost on AWS and Alibaba Cloud, even after full discounts, is respectively 1,900 and 3,200 CNY. In the most outrageous scenarios (6400 vs 6.6), the premium can even reach a thousandfold. However, a more apples-to-apples comparison results in: <strong>the unit price of cloud block storage is 100 to 200 times that of self-built solutions</strong> (and the performance is not as good as local disks).</p>
<p>EC2 and EBS prices can be considered the anchor of cloud service pricing, for example, the premium rate of cloud databases RDS that mainly use EC2 and EBS compared to local self-built solutions fluctuates between the two, depending on your storage usage: <strong>the unit price of cloud databases is dozens of times that of self-built solutions</strong>. For more details, refer to &ldquo;<a href="/blog/cloud/rds/">Is Cloud Database a Dumb Tax?</a>&rdquo;.</p>
<p>Of course, we can&rsquo;t deny the cost advantages of public clouds for micro instances and startups — for example, the nano instances on public clouds used to patch together 1<del>2C, 0.5</del>2G configurations really can be offered to users at a core-month cost of a few dollars. In &ldquo;<a href="/blog/cloud/cheap-ecs/">Exploiting Alibaba Cloud ECS for a Digital Homestead</a>,&rdquo; I recommended exploiting Alibaba Cloud&rsquo;s Double 11 virtual machine deals for this reason. For instance, a 2C 2G server&rsquo;s compute cost, calculated with a 500% overselling, is 84 CNY per year, and the cost for 40G cloud disk storage, calculated with triple replication, is about 20 CNY per year, making the annual cost for these two parts over a hundred CNY. This doesn&rsquo;t include the cost of a public IP or the more valuable 3M bandwidth (for example, if you could fully utilize 3M bandwidth 24 hours a day, that would mean 32G of data per day, costing about 25 CNY). The list price for such cloud servers is ¥1500 per year, so the 99¥ price allowing for a low-cost renewal for four years indeed can be considered a loss-leading benefit.</p>
<p>However, when your business can no longer be covered by a bunch of micro instances, you really should do the math again carefully: in several key examples, the cost of cloud services is extremely high — whether for large physical machine databases, large NVMe storage, or just the latest and fastest compute. The rental price for such production-grade resources is so high — that a few months&rsquo; rent could equal the cost of buying it outright. In such cases, you really should just buy the donkey!</p>
<hr>
<h2 id="reclaim-hardware-bonus-from-cloud">Reclaim Hardware Bonus from Cloud</h2>
<p>I still remember on April 1, 2019, when the domestic value-added tax in China was officially reduced from 16% to 13%, Apple&rsquo;s official website immediately <a href="https://www.lifeweek.com.cn/article/71403">implemented a price reduction</a> across the board, with the maximum discount reaching 8% — several iconic iPhone models were reduced by 500 yuan, effectively passing the tax cut benefits to the users. However, many manufacturers chose to turn a deaf ear and maintain their original prices, pocketing the benefits for themselves — why would they want to distribute this newfound wealth to the less fortunate? A similar situation has occurred in the cloud computing domain — the exponential decrease in hardware costs has not been fully reflected in the service prices of cloud providers, gradually turning public cloud from a universally accessible infrastructure into a monopolistic cash cow.</p>
<p>In the old days, developers had to deeply understand hardware to write code. However, the older generation of engineers and programmers, who had a keen sense of hardware, have mostly retired, changed positions, moved into management, or stopped learning. Subsequently, as operating systems and compiler technologies advanced and various VM programming languages emerged, software no longer needed to concern itself with how hardware executed instructions. Then came services like EC2, which encapsulated computing power, and S3/EBS, which encapsulated storage, leading applications to interact with HTTP APIs rather than system calls. Software and hardware diverged into two separate realms, each going its own way. An entire new generation of engineers grew up in the cloud environment, shielded from an understanding of computer hardware.</p>
<p>However, things are beginning to change, with hardware becoming interesting again, and cloud providers are unable to perpetually hide this dividend — <strong>the wise are starting to crunch the numbers, and the brave have already taken action</strong>. Pioneers like Musk and DHH have fully recognized this, moving off the cloud and onto solid ground — directly generating tens of millions of dollars in financial benefits, with returns in performance, and gaining more independence in operations. More and more people will come to the same realization, following in the footsteps of these trailblazers to make the wise choice of reclaiming their hardware bonus from the cloud.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-c0e49b0e5d0a3d0c994910d0cc773519">FinOps: Endgame Cloud-Exit</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/Yp_PU8nmyK-NVq0clD98RQ">WeChat</a></b> |
        
		<time datetime="2023-07-06" class="text-muted">2023-07-06</time>
        
	</div>
	<p>At the SACC 2023 FinOps session, I fiercely criticized cloud vendors. This is a transcript of my speech, introducing the ultimate FinOps concept — <strong>cloud-exit</strong> and its best practice.</p>
<hr>
<h2 id="tl-dr">TL; DR</h2>
<p><strong>Misaligned FinOps Focus</strong>: <strong>Total Cost = Unit Price x Quantity</strong>. FinOps efforts are centered around reducing the <strong>quantity</strong> of wasted resources, deliberately ignoring the elephant in the room — <strong>cloud resource unit price</strong>.</p>
<p><strong>Public Cloud as a Slaughterhouse</strong>: Attract customers with cheap EC2/S3, then slaughter them with EBS/RDS. The cost of cloud compute is five times that of in-house, while block storage costs can be over a hundred times more, making it the ultimate cost assassin.</p>
<p><strong>The Endgame of FinOps is Going Off-Cloud</strong>: For enterprises of a certain scale, the cost of in-house IDC is around 10% of the list price of cloud services. Going off-cloud is both the endgame of orthodox FinOps and the starting point of true FinOps.</p>
<p><strong>In-house Capabilities Determine Bargaining Power</strong>: Users with in-house capabilities can negotiate extremely low discounts even without going off-cloud, while companies without in-house capabilities can only pay a high &ldquo;no-expert tax&rdquo; to public cloud vendors.</p>
<p><strong>Databases are Key to In-House Transition</strong>: Migrating stateless applications on K8S and data warehouses is relatively easy. The real challenge is building databases in-house without compromising <strong>quality and security</strong>.</p>
<p><a href="https://mp.weixin.qq.com/s/Yp_PU8nmyK-NVq0clD98RQ"><img src="/img/blog/hero/finops.jpg"></a></p>
<hr>
<h2 id="misaligned-finops-focus">Misaligned FinOps Focus</h2>
<blockquote>
<p>Compared to the amount of waste, the unit price of resources is the key point.</p>
</blockquote>
<p>The FinOps Foundation states that FinOps focuses on &ldquo;<strong>cloud cost optimization</strong>&rdquo;. However, we believe that emphasizing only <strong>public clouds</strong> deliberately narrows this concept — the focus should be on the cost control and optimization of <strong>all</strong> resources, not just those on public clouds — including &ldquo;hybrid clouds&rdquo; and &ldquo;private clouds&rdquo;. Even without using public clouds, some FinOps methodologies can still be applied to the entire K8S cloud-native ecosystem. Because of this, many involved in FinOps are led astray — their focus is limited to <strong>reducing the quantity of cloud resource waste</strong>, neglecting a very important issue: <strong>unit price</strong>.</p>
<p><strong>Total cost</strong> depends on two factors: <strong>Quantity ✖️ Unit Price</strong>. Compared to quantity, <strong>unit price might be the key to cost reduction and efficiency improvement</strong>. Previous speakers mentioned that about 1/3 of cloud resources are wasted on average, which is the optimization space for FinOps. However, if you use non-elastic services on public clouds, the <strong>unit price of the resources</strong> you use is already several to dozens of times higher, making the wasted portion negligible in comparison.</p>
<p>In the first stop of my career, I experienced a FinOps movement firsthand. Our BU was among the first internal users of Alibaba Cloud and also where the &ldquo;<strong>data middle platform</strong>&rdquo; concept originated. Alibaba Cloud sent over a dozen engineers to help us migrate to the cloud. After migrating to ODPS, our annual storage and computing costs were <strong>70 million</strong>, and through FinOps methods like health scoring, we did optimize and save tens of millions. However, running the same services with an in-house Hadoop suite in our data center cost <strong>less than 10 million annually</strong> — <strong>savings are good, but they&rsquo;re nothing compared to the multiplied resource costs</strong>.</p>
<p>As cost reduction and efficiency become the main theme, cloud repatriation is becoming a trend. Alibaba, the inventor of the middle platform concept, has already started dismantling its own middle platform. Yet, many companies are still falling into the trap of the slaughterhouse, repeating the old path of cloud migration - cloud repatriation.</p>
<hr>
<h2 id="public-clouds-a-slaughterhouse-in-disguise">Public Clouds: A Slaughterhouse in Disguise</h2>
<blockquote>
<p>Attract customers with cheap EC2/S3, then slaughter them with EBS/RDS pricing.</p>
</blockquote>
<p>The elasticity touted by public clouds is designed for their business model: <strong>low startup costs, exorbitant maintenance costs</strong>. Low initial costs lure users onto the cloud, and its good elasticity can adapt to business growth at any time. However, once the business stabilizes, vendor lock-in occurs, making it difficult to switch providers without incurring high costs, turning maintenance into a financial nightmare for users. This model is colloquially known as a <a href="/blog/cloud/ebs/"><strong>pig slaughterhouse</strong></a>.</p>
<p><strong>To slaughter pigs, one must first raise them</strong>. You can&rsquo;t catch a wolf without putting your child at risk. Hence, for new users, startups, and small businesses, public clouds offer sweet deals, even at a loss, to make noise and attract business. New users get first-time discounts, startups receive free or half-price credits, and there&rsquo;s a sophisticated pricing strategy. Taking AWS RDS pricing as an example, the mini models with 1 or 2 cores are priced at just <strong>a few dollars per core per month</strong>, translating to a few hundred yuan per year (excluding storage). This is an affordable option for those needing a low-usage database for small data storage.</p>
<p><img src="/img/blog/cloud/finops-1.png"></p>
<p>However, even a slight increase in configuration leads to a <strong>magnitude</strong> increase in the price per core month, skyrocketing to twenty or thirty to a hundred dollars, sometimes even more — not to mention the shocking EBS prices. Users may only realize what has happened when they see the exorbitant bill suddenly appearing.</p>
<p>Compared to in-house solutions, <strong>the price of cloud resources is generally several to more than ten times higher, with a rent-to-buy ratio ranging from a few days to several months</strong>. For example, the cost of a physical server core month in an IDC, including all costs for network, electricity, maintenance, and IT staff, is about 19 yuan. Using a K8S container private cloud, the cost of a virtual core month is only 7 yuan.</p>
<p>In contrast, the price per core month for Alibaba Cloud&rsquo;s ECS is a couple of hundred yuan, and for AWS EC2, it&rsquo;s two to three hundred yuan. If you &ldquo;don&rsquo;t care about elasticity&rdquo; and prepay for three years, you can usually get a discount of about 50-60%. But no matter how you calculate it, the price difference between cloud computing power and local in-house computing power is there and significant.</p>
<p><img src="/img/blog/cloud/finops-2.png"></p>
<p>The pricing of <strong>cloud storage</strong> resources is even more outrageous. A common 3.2 TB enterprise-grade NVMe SSD, with its formidable performance, reliability, and cost-effectiveness, has a wholesale price of just over <strong>¥3000</strong>, significantly outperforming older storage solutions. However, for the same storage on the cloud, providers dare to charge 100 times the price. Compared to direct hardware procurement, <strong>the cost of AWS EBS io2 is 120 times higher, while Alibaba Cloud&rsquo;s ESSD PL3 is 200 times higher</strong>.</p>
<p>Using a 3.2TB enterprise-grade PCI-E SSD card as a benchmark, <strong>the rent-to-buy ratio on AWS is 15 days, while on Alibaba Cloud it&rsquo;s less than 5 days</strong>, meaning renting for this period allows you to purchase the entire disk outright. If you opt for a three-year prepaid purchase on Alibaba Cloud with the maximum discount of 50%, <strong>the three-year rental fee could buy over 120 similar disks</strong>.</p>
<p><img src="/img/blog/cloud/finops-3.png"></p>
<blockquote>
<p>《<a href="/blog/cloud/ebs/">EBS: a real Scam</a>》</p>
</blockquote>
<p>The price markup ratio of cloud databases (RDS) falls between that of cloud disks and cloud servers. For example, using RDS for PostgreSQL on AWS, a 64C / 256GB RDS costs $25,817 per month, equivalent to 180,000 yuan per month. One month&rsquo;s rent is enough to purchase two servers with much better performance for in-house use. <strong>The rent-to-buy ratio is not even a month</strong>; renting for just over ten days would be enough to purchase an entire server.</p>
<p>Any rational enterprise user can see the folly in this: <strong>If the procurement of such services is not for short-term, temporary needs, then it definitely qualifies as a significant financial misjudgment.</strong></p>
<table>
<thead>
<tr>
<th>Payment Model</th>
<th>Price</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted IDC (Single Physical Server)</td>
<td>¥75k / 5 years</td>
<td>1.5</td>
</tr>
<tr>
<td>Self-hosted IDC (2-3 Server HA Cluster)</td>
<td>¥150k / 5 years</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (On-demand)</td>
<td>¥87.36/hour</td>
<td>76.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Monthly)</td>
<td>¥42k / month</td>
<td>50</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Yearly, 15% off)</td>
<td>¥425,095 / year</td>
<td>42.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (3-year, 50% off)</td>
<td>¥750,168 / 3 years</td>
<td>25</td>
</tr>
<tr>
<td>AWS (On-demand)</td>
<td>$25,817 / month</td>
<td>217</td>
</tr>
<tr>
<td>AWS (1-year, no upfront)</td>
<td>$22,827 / month</td>
<td>191.7</td>
</tr>
<tr>
<td>AWS (3-year, full upfront)</td>
<td>$120k + $17.5k/month</td>
<td>175</td>
</tr>
<tr>
<td>AWS China/Ningxia (On-demand)</td>
<td>¥197,489 / month</td>
<td>237</td>
</tr>
<tr>
<td>AWS China/Ningxia (1-year, no upfront)</td>
<td>¥143,176 / month</td>
<td>171</td>
</tr>
<tr>
<td>AWS China/Ningxia (3-year, full upfront)</td>
<td>¥647k + ¥116k/month</td>
<td>160.6</td>
</tr>
</tbody>
</table>
<p>Comparing the costs of self-hosting versus using a cloud database:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted Servers 64C / 384G / 3.2TB NVME SSD 660K IOPS (2-3 servers)</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS PG High-Availability pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3</td>
<td>25 ~ 50</td>
</tr>
<tr>
<td>AWS RDS PG High-Availability db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS</td>
<td>160 ~ 217</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>RDS</strong> pricing compared to self-hosting, see &ldquo;<a href="/blog/cloud/rds/">Is Cloud Database an idiot Tax?</a>&rdquo;</p>
</blockquote>
<p>Any meaningful cost reduction and efficiency increase initiative cannot ignore this issue: if there&rsquo;s potential to slash resource prices by 50% to 200%, then focusing on a 30% reduction in waste is not a priority. As long as your main business is on the cloud, traditional FinOps is like scratching an itch through a boot — <strong>migrating off the cloud is the focal point of FinOps</strong>.</p>
<hr>
<h2 id="the-endgame-of-finops-is-exiting-from-the-cloud">The Endgame of FinOps is Exiting from the Cloud</h2>
<blockquote>
<p>The well-fed do not understand the pangs of hunger, human joys and sorrows are not universally shared.</p>
</blockquote>
<p>I spent five years at Tantan — a Nordic-style internet startup founded by a Swede. Nordic engineers have a characteristic pragmatism. When it comes to choosing between cloud and on-premise solutions, they are not swayed by hype or marketing but rather make decisions based on quantitative analysis of pros and cons. We meticulously calculated the costs of building our own infrastructure versus using the cloud — the straightforward conclusion was that <strong>the total cost of on-premise solutions (including labor) generally fluctuates between 10% to 100% of the list price for cloud services</strong>.</p>
<p>Thus, from its inception, Tantan chose to build its own infrastructure. Apart from overseas compliance businesses, CDN, and a very small amount of elastic services using public clouds, the main part of our operations was entirely hosted in IDC-managed data centers. Our database was not small, with 13K cores for PostgreSQL and 12K cores for Redis, 4.5 million QPS, and 300TB of unique transactional data. The annual cost for these two parts was less than 10 million yuan: including salaries for two DBAs, one network engineer, network and electricity, managed hosting fees, and hardware amortized over five years. However, for such a scale, if we were to use cloud databases, even with significant discounts, the starting cost would be between 50 to 60 million yuan, not to mention the even more expensive big data sector.</p>
<p>However, digitalization in enterprises is phased, and different companies are at different stages. For many internet companies, they have reached the stage where they are fully engaged with building cloud-native K8S ecosystems. At this stage, focusing on resource utilization, mixed online and offline deployments, and reducing waste are reasonable demands and directions where FinOps should concentrate its efforts. Yet, for the vast majority of enterprises outside the digital realm, the urgent need is not reducing waste but <strong>lowering the unit cost of resources</strong> — Dell servers can be discounted by 50%, IDC virtual machines by 50%, and even cloud services can be heavily discounted. Are these companies still paying the list price, or even facing several times the markup in rebates? <strong>A great many companies are still being severely exploited due to information asymmetry and lack of capability</strong>.</p>
<p>Enterprises should evaluate their scale and stage, assess their business, and weigh the pros and cons accordingly. For small-scale startups, the cloud can indeed save a lot of manpower costs, which is very attractive — <strong>but please be cautious not to be locked in by vendors due to the convenience offered</strong>. If your annual cloud expenditure has already exceeded 1 million yuan, it&rsquo;s time to seriously consider <strong>the benefits of descending from the cloud</strong> — many businesses do not require the elasticity for massive concurrent spikes or training AI models. Paying a premium for temporary/sudden needs or overseas compliance is reasonable, but paying several times to tens of times more for <strong>unnecessary elasticity</strong> is wasteful. You can keep the truly elastic parts of your operations on the public cloud and transfer those parts that do not require elasticity to IDCs. Just by doing this, the cost savings could be astonishing.</p>
<p><strong>Descending from the cloud is the ultimate goal of traditional FinOps and the starting point of true FinOps.</strong></p>
<hr>
<h2 id="self-hosting-matters">Self-Hosting Matters</h2>
<blockquote>
<p>&ldquo;To seek peace through struggle is to preserve peace; to seek peace through compromise is to lose peace.&rdquo;</p>
</blockquote>
<p>When the times are favorable, the world joins forces; when fortune fades, even heroes lose their freedom: During the bubble phase, it was easy to disregard spending heavily in the cloud. However, in an economic downturn, cost reduction and efficiency become central themes. An increasing number of companies are realizing that using cloud services is essentially paying a &ldquo;no-expert tax&rdquo; and &ldquo;protection money&rdquo;. Consequently, a trend of &ldquo;cloud repatriation&rdquo; has emerged, with 37Signals&rsquo; DHH being one of the most notable proponents. Correspondingly, the revenue growth rate of major cloud providers worldwide has been experiencing a continuous decline, with Alibaba Cloud&rsquo;s revenue even starting to shrink in the first quarter of 2023.</p>
<p><img src="/img/blog/cloud/finops-5.png"></p>
<blockquote>
<p>《<a href="/blog/cloud/profit/">&ldquo;Why Cloud Computing Hasn&rsquo;t Yet Hit Its Stride in Earning Profits&rdquo;</a>》</p>
</blockquote>
<p>The underlying trend is the emergence of <strong>open-source alternatives</strong>, breaking down the <strong>technical barriers</strong> of public clouds; the advent of resource clouds/IDC2.0, offering a cost-effective alternative to public cloud resources; and the release of technical talents from large layoffs, along with the future of AI models, giving every industry the opportunity to possess the expert knowledge and capability required for self-hosting. Combining these trends, <strong>the combination of IDC2.0 + open-source self-hosting is becoming increasingly competitive</strong>: <strong>Bypassing the public cloud intermediaries and working directly with IDCs is clearly a more economical choice</strong>.</p>
<p>Public cloud providers are not incapable of engaging in the business of selling IDC resources profitably. Given their higher level of expertise compared to IDCs, they should, in theory, leverage their technological advantages and economies of scale to offer cheaper resources than IDC self-hosting. However, the harsh reality is that resource clouds can offer users virtual machines at a 80% discount, while public clouds cannot. Even considering the exponential growth law of Moore&rsquo;s Law in the storage and computing industry, public clouds are actually <strong>increasing their prices</strong> every year!</p>
<p>Well-informed major clients, especially those capable of migrating at will, can indeed negotiate for <strong>80% off</strong> the list prices with public clouds, a feat unlikely for smaller clients — in this sense, <strong>clouds are essentially subsidizing large clients by bleeding small and medium-sized clients dry</strong>. <strong>Cloud vendors offer massive discounts to large clients while fleecing small and medium-sized clients and developers</strong>, completely contradicting the original intention and vision of cloud computing.</p>
<p>Clouds lure in users with low initial prices, but once users are deeply locked in, the slaughter begins — the previously discussed discounts and benefits disappear at each renewal. Escaping the cloud entails a significant cost, leaving users in a dilemma between a rock and a hard place, forced to continue paying protection money.</p>
<p>However, for users with the capability to self-host, capable of flexibly moving between multi-cloud and on-premises hybrid clouds, this is not an issue: <strong>The trump card in negotiations is the ability to go off-cloud or migrate to another cloud at any time</strong>. This is more effective than any argument — as the saying goes, &ldquo;<strong>To seek peace through struggle is to preserve peace; to seek peace through compromise is to lose peace</strong>.&rdquo; <strong>The extent of cost reduction depends on your bargaining power, which in turn depends on your ability to self-host</strong>.</p>
<p><strong>Self-hosting might seem daunting, but it is not difficult for those who know how</strong>. The key is addressing the core issues of <strong>resources</strong> and <strong>capabilities</strong>. In 2023, due to the emergence of resource clouds and open-source alternatives, these issues have become much simpler than before.</p>
<p><strong>In terms of resources, IDC and resource clouds have solved the problem adequately</strong>. The aforementioned IDC self-hosting doesn&rsquo;t mean buying land and building data centers from scratch but directly using the hosting services of resource clouds/IDCs — you might only need a network engineer to plan the network, with other maintenance tasks managed by the provider.</p>
<p>If you prefer not to hassle, IDCs can directly sell you virtual machines at 20% of the list price, or you can rent a physical server with 64C/256G for a couple thousand a month; whether renting an entire data center or just a single colocation space, it&rsquo;s all feasible. A retail colocation space with comprehensive services can be settled for about five thousand a year, running a K8S or virtualization on a couple of hundred-core physical servers, why bother with flexible ECS?</p>
<hr>
<h2 id="finops-leads-to-cloud-exit">FinOps Leads to CLoud-Exit</h2>
<p>Building your own infrastructure comes with the added perk of extreme FinOps—utilizing out-of-warranty or even second-hand servers. Servers are typically depreciated over three to five years, yet it&rsquo;s not rare to see them operational for eight to ten years. This contrasts with cloud services, where you&rsquo;re just consuming resources; owning your server translates to tangible assets, making any extended use essentially a gain.</p>
<p>For instance, a new 64-core, 256GB server could cost around $7,000, but after a year or two, the price for such &ldquo;electronic waste&rdquo; drops to merely $400.
By replacing the most failure-prone components with brand new enterprise-grade 3.2TB NVMe SSDs (costing $390), you could secure the entire setup for just $800.</p>
<p>In such scenarios, your vCPU·Month price could plummet to less than $0.15, a figure legendary in the gaming industry, where server costs can dip to mere cents.
With Kubernetes (K8S) orchestration and database high-availability switching, reliability can be assured through parallel operation of multiple such servers, achieving an astonishing cost-efficiency ratio.</p>
<p>In terms of capability, with the emergence of sufficiently robust open-source alternatives, the difficulty of self-hosting has dramatically decreased compared to a few years ago.</p>
<p>For example, Kubernetes/OpenStack/SealOS are open-source alternatives to cloud providers&rsquo; EC2/ECS/VPS management software; MinIO/Ceph aim to replace S3/OSS; while Pigsty and various database operators serve as open-source substitutes for RDS cloud database management. There&rsquo;s a plethora of open-source software available for effectively utilizing these resources, along with numerous commercial entities offering transparently priced support services.</p>
<p>Your operations should ideally converge to using just virtual machines and object storage, the lowest common denominator across all cloud providers. Ideally, all applications should run on Kubernetes, which can operate in any environment—be it a cloud-hosted K8S, ECS, dedicated servers, or your own data center. External states like database backups and big data warehouses should be managed with compute-storage separation, using MinIO/S3 storage.</p>
<p>Such a CloudNative tech stack theoretically enables operation and flexible migration across any resource environment, thus avoiding vendor lock-in and maintaining control. This allows you to either significantly cut costs by moving off the cloud or leverage it to negotiate discounts with public cloud providers.</p>
<p>However, self-hosting isn&rsquo;t without risks, with RDS representing a major potential vulnerability.</p>
<hr>
<h3 id="database-the-biggest-risk-factor">Database: The Biggest Risk Factor</h3>
<blockquote>
<p><strong>Cloud databases</strong> may not be the most expensive line item, but they are definitely the most deeply locked-in and challenging to migrate.</p>
</blockquote>
<p>Quality, security, efficiency, and cost represent different levels of a hierarchical pyramid of needs. The goal of FinOps is to reduce costs and increase efficiency <strong>without compromising quality and security</strong>.</p>
<p>Stateless apps on K8S or offline big data platforms pose little fatal risk when migrating. Especially if you have already achieved <strong>big data compute-storage separation</strong> and <strong>stateless app cloud-native</strong> transformation, moving these components is generally not too troublesome. The former can afford a few hours of downtime, while the latter can be updated through blue-green deployments and canary releases. <strong>The database, serving as the working memory, is prone to major issues when migrated.</strong></p>
<p>Most IT system architectures are centered around the database, making it the key risk point in cloud migration, particularly with OLTP databases/RDS. Many users hesitate to move off the cloud and self-host due to the lack of reliable database services — traditional Kubernetes Operators don’t fully replicate the cloud database experience: hosting OLTP databases on K8S/containers with EBS is not yet a mature practice.</p>
<p><strong>There&rsquo;s a growing demand for a viable open-source alternative to RDS</strong>, and that&rsquo;s precisely what we aim to address: enabling users to establish a local RDS service in any environment that matches or exceeds cloud databases — <strong>Pigsty</strong>, a free open-source alternative to RDS PG. It empowers users to effectively utilize <a href="/zh/blog//db/pg-is-best/">PostgreSQL, the world’s most advanced and successful database</a>.</p>
<p>Pigsty is a non-profit, open-source software powered by community love. It offers a ready-to-use, feature-rich PostgreSQL distribution with automatic high availability, PITR, top-tier monitoring systems, Infrastructure as Code, cloud-based Terraform templates, local Vagrant sandbox for one-click installation, and SOP manuals for various operations, enabling quick RDS self-setup without needing a professional DBA.</p>
<p>Although Pigsty is a database distribution, it enables users to practice ultimate FinOps—running production-level PostgreSQL RDS services anywhere (ECS, resource clouds, data center servers, or even local laptop VMs) at almost pure resource cost. <strong>It turns the cost of cloud database capabilities from being proportional to marginal resource costs to nearly zero in fixed learning costs</strong>.</p>
<p><img src="/img/blog/cloud/finops-7.png"></p>
<p>Perhaps it&rsquo;s the socialist ethos of Nordic companies that nurtures such pure free software. Our goal isn’t profit but to promote a philosophy: to democratize the expertise of using the advanced open-source database PostgreSQL for everyone, not just cloud monopolies. Cloud providers monopolize open-source expertise and roles, exploiting free open-source software, and we aim to break this monopoly—<strong>Freedom is not free. You shouldn&rsquo;t concede the world to those you despise but rather overturn their table</strong>.</p>
<p><strong>This is the essence of FinOps—empowering users with viable alternatives and the ability to self-host, thus negotiating with cloud providers from a position of strength</strong>.</p>
<hr>
<h2 id="references">References</h2>
<p>[1] <a href="https://mp.weixin.qq.com/s/JU4lznF6-5Q4LaJTnG8SSQ">云计算为啥还没挖沙子赚钱？</a></p>
<p>[2] <a href="https://mp.weixin.qq.com/s/c8bpK4o3H7-EyRqVdNDndQ">云数据库是不是智商税？</a></p>
<p>[3] <a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA">云SLA是不是安慰剂？</a></p>
<p>[4] <a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">云盘是不是杀猪盘？</a></p>
<p>[5] <a href="https://mp.weixin.qq.com/s/Yp6L0hh4b4HuJQRPD3aJYw">范式转移：从云到本地优先</a></p>
<p>[6] <a href="https://mp.weixin.qq.com/s/TksQ108v_nGaW11-87Es3A">杀猪盘真的降价了吗？</a></p>
<p>[7] <a href="https://mp.weixin.qq.com/s/WsR-c64OJfkMql7zX7XmDA">炮打 RDS，Pigsty v2.0 发布</a></p>
<p>[8] <a href="https://mp.weixin.qq.com/s/ANFnbDXwuhKI99fgYRZ9ug">垃圾腾讯云CDN：从入门到放弃</a></p>
<p>[9] <a href="https://mp.weixin.qq.com/s/AGEW1iHQkQy4NQyYC2GonQ">云RDS：从删库到跑路</a></p>
<p>[10] <a href="https://mp.weixin.qq.com/s/-eaCoZR9Z5srQ-1YZm1QJA">分布式数据库是伪需求吗？</a></p>
<p>[11] <a href="https://mp.weixin.qq.com/s/mEmz8pviahEAWy1-SA8vcg">微服务是不是个蠢主意？</a></p>
<p>[12] <a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485518&idx=1&sn=3d5f3c753facc829b2300a15df50d237&chksm=fe4b3d95c93cb4833b8e80433cff46a893f939154be60a2a24ee96598f96b32271301abfda1f&scene=21#wechat_redirect">更好的开源RDS替代：Pigsty</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-fb2b56bca82f7d919a808b2f73758318">SLA: Placebo or Insurance?</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA">WeChat</a></b> |
        
		<time datetime="2023-06-12" class="text-muted">2023-06-12</time>
        
	</div>
	<p>In the world of cloud computing, Service Level Agreements (SLAs) are seen as a cloud provider&rsquo;s commitment to the quality of its services. However, a closer examination of these SLAs reveals that they might not offer the safety net one might expect: you might think you&rsquo;ve insured your database for peace of mind, but in reality, you&rsquo;ve bought a placebo that provides emotional comfort rather than actual coverage.</p>
<p><a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA"><img src="/img/blog/hero/sla.jpg"></a></p>
<hr>
<h2 id="insurance-policy-or-placebo">Insurance Policy or Placebo?</h2>
<p>One of the reasons many users opt for cloud services is for the &ldquo;safety net&rdquo; they supposedly provide, often referring to the <strong>SLA</strong> when asked what this &ldquo;safety net&rdquo; entails. Cloud experts liken purchasing cloud services to buying insurance: certain failures might never occur throughout many companies&rsquo; lifespans, but should they happen, the consequences could be catastrophic. In such cases, a cloud service provider&rsquo;s SLA is supposed to act as this safety net. Yet, when we actually review these SLAs, we find that this &ldquo;policy&rdquo; isn&rsquo;t as useful as one might think.</p>
<p>Data is the lifeline of many businesses, and cloud storage serves as the foundation for nearly all data storage on the public cloud. Let&rsquo;s take cloud storage services as an example. Many cloud service providers boast of their cloud storage services having nine nines of <strong>data reliability</strong> [1]. However, upon examining their SLAs, we find that these crucial promises are conspicuously absent from the SLAs [2].</p>
<p>What is typically included in the SLAs is the service&rsquo;s <strong>availability</strong>. Even this promised availability is superficial, paling in comparison to the core business reliability metrics in the real world, with compensation schemes that are practically negligible in the face of common downtime losses. <strong>Compared to an insurance policy, SLAs more closely resemble placebos that offer emotional value.</strong></p>
<hr>
<h2 id="subpar-availability">Subpar Availability</h2>
<p>The key metric used in cloud SLAs is availability. Cloud service availability is typically represented as the proportion of time a resource can be accessed from the outside, usually over a one-month period. If a user cannot access the resource over the Internet due to a problem on the cloud provider&rsquo;s end, the resource is considered unavailable/down.</p>
<p>Taking the industry benchmark AWS as an example, most of its services use a similar SLA template [3]. The SLA for a single virtual machine on AWS is as follows [4]. This means that in the best-case scenario, if an EC2 instance on AWS is unavailable for less than 21 minutes in a month (99.9% availability), AWS compensates nothing. In the worst-case scenario, only when the unavailability exceeds 36 hours (95% availability) can you receive a 100% credit return.</p>
<blockquote>
<p><strong>Instance-Level SLA</strong></p>
<p>For each individual Amazon EC2 instance (“Single EC2 Instance”), AWS will use commercially reasonable efforts to make the Single EC2 Instance available with an Instance-Level Uptime Percentage of at least 99.5%, in each case during any monthly billing cycle (the “Instance-Level SLA”). In the event any Single EC2 Instance does not meet the Instance-Level SLA, you will be eligible to receive a Service Credit as described below.</p>
<table>
<thead>
<tr>
<th><strong>Instance-Level Uptime Percentage</strong></th>
<th><strong>Service Credit Percentage</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Less than 99.5% but equal to or greater than 99.0%</td>
<td>10%</td>
</tr>
<tr>
<td>Less than 99.0% but equal to or greater than 95.0%</td>
<td>30%</td>
</tr>
<tr>
<td>Less than 95.0%</td>
<td>100%</td>
</tr>
</tbody>
</table>
<p>Note: In addition to the Instance-Level SLA, AWS will not charge you for any Single EC2 Instance that is Unavailable for more than six minutes of a clockhour. This applies automatically and you do not need to request credit for any such hour with more than six minutes of Unavailability.</p>
</blockquote>
<blockquote>
<p><a href="https://aws.amazon.com/compute/sla/">https://aws.amazon.com/compute/sla/</a></p>
</blockquote>
<p>For some internet companies, a 15-minute service outage is enough to jeopardize bonuses, and a 30-minute outage is sufficient for leadership changes. The actual availability of core systems running most of the time might have five nines, six nines, or even infinite nines. Cloud providers, incubated from major internet companies, using such inferior availability metrics is indeed disappointing.</p>
<p>What&rsquo;s more outrageous is that these compensations are not automatically provided to you after a failure occurs. Users are required to measure downtime themselves, submit evidence for claims within a specific timeframe (<strong>usually two months</strong>), and request compensation to receive any. This requires users to collect monitoring metrics and log evidence to negotiate with cloud providers, and the compensation returned is not in cash but in vouchers/duration compensations — <strong>meaning virtually no real loss for the cloud providers and no actual value for the users, with almost no chance of compensating for the actual losses incurred during service interruptions.</strong></p>
<hr>
<h2 id="is-the-safety-net-meaningful">Is the &ldquo;Safety Net&rdquo; Meaningful?</h2>
<p>For businesses, a &ldquo;safety net&rdquo; means minimizing losses as much as possible when failures occur. Unfortunately, SLAs are of little help in this regard.</p>
<p>The impact of service unavailability on business varies by industry, time, and duration. A brief outage of a few seconds to minutes might not significantly affect general industries, <strong>however, long-term outages (several hours to several days) can severely affect revenue and reputation</strong>.</p>
<p>In the Uptime Institute&rsquo;s 2021 data center survey [5], several of the most severe outages cost respondents an average of nearly $1 million, not including the worst 2% of cases, which suffered losses exceeding $40 million.</p>
<p><img src="/zh/blog/cloud/sla/sla-2.png"></p>
<p>However, SLA compensations are a drop in the ocean compared to these business losses. Taking the <code>t4g.nano</code> virtual machine instance in the <code>us-east-1</code> region as an example, priced at about $3 per month. If the unavailability is less than 7 hours and 18 minutes (99% monthly availability), AWS will pay 10% of the monthly cost of that virtual machine, a total compensation of 30 cents. If the virtual machine is unavailable for less than 36 hours (95% availability within a month), the compensation is only 30% — less than $1. <strong>Only if the unavailability exceeds a day and a half, can users receive a full refund for the month — $3</strong>. Even if compensating for thousands of instances, this is virtually negligible compared to the losses.</p>
<p>In contrast, the traditional insurance industry genuinely provides coverage for its customers. For instance, SF Express charges 1% of the item&rsquo;s value for insurance, but if the item is lost, they compensate the full amount. Similarly, commercial health insurance costing tens of thousands yearly can cover millions in medical expenses. &ldquo;Insurance&rdquo; in this industry truly means you get what you pay for.</p>
<p>Cloud service providers charge far more than the BOM for their expensive services (see: &ldquo;Are Public Clouds a Pig Butchering Scam?&rdquo; [7]), but when service issues arise, their so-called &ldquo;safety net&rdquo; compensation is merely vouchers, which is clearly unfair.</p>
<hr>
<h2 id="vanished-reliability">Vanished Reliability</h2>
<p>Some people use cloud services to &ldquo;pass the buck,&rdquo; absolving themselves of responsibility. However, some critical responsibilities cannot be shifted to external IT suppliers, such as <strong>data security</strong>. Users might tolerate temporary service unavailability, but the damage caused by lost or corrupted data is often unacceptable. <strong>Blindly trusting exaggerated promises can have severe consequences, potentially a matter of life and death for a startup.</strong></p>
<p>In storage products offered by various cloud providers, it&rsquo;s common to see promises of nine nines of reliability [1], implying a one in a billion chance of data loss when using cloud disks. Examining actual reports on cloud provider disk failure rates [6] casts doubt on these figures. However, as long as providers are bold enough to make, stand by, and honor such claims, there shouldn&rsquo;t be an issue.</p>
<p><img src="/zh/blog/cloud/sla/sla-3.png"></p>
<p>Yet, upon examining the SLAs of various cloud providers, this promise disappears! [2]</p>
<p>In the 2018 sensational case &ldquo;The Disaster Tencent Cloud Brought to a Startup Company!&rdquo; [8], the startup believed the cloud provider&rsquo;s promises and stored data on server hard drives, only to encounter what was termed &ldquo;silent disk errors&rdquo;: &ldquo;Years of accumulated data were lost, causing nearly ten million yuan in losses.&rdquo; Tencent Cloud expressed apologies to the company, willing to compensate the actual expenses incurred on Tencent Cloud totaling 3,569 yuan and, with the aim of helping the business quickly recover, promised an additional compensation of 132,900 yuan</p>
<hr>
<h2 id="what-exactly-is-an-sla">What Exactly is an SLA</h2>
<p>Having discussed this far, proponents of cloud services might play their last card: although the post-failure &ldquo;safety net&rdquo; is a facade, what users need is to avoid failures as much as possible. According to the SLA promises, there is a 99.99% probability of avoiding failures, which is of the most value to users.</p>
<p>However, SLAs are deliberately confused with the actual reliability of the service: Users should not consider SLAs as reliable indicators of service availability — not even as accurate records of past availability levels. For providers, an SLA is not a real commitment to reliability or a track record but a marketing tool designed to convince buyers that the cloud provider can host critical business applications.</p>
<p>The UPTIME INSTITUTE&rsquo;s annual data center failure analysis report shows that many cloud services perform below their published SLAs. The analysis of failures in 2022 found that efforts to contain the frequency of failures have failed, and the cost and consequences of failures are worsening [9].</p>
<blockquote>
<p><strong>Key Findings Include</strong>:</p>
<ul>
<li><strong>High outage rates haven’t changed significantly.</strong> One in five organizations report experiencing a “serious” or “severe” outage (involving significant financial losses, reputational damage, compliance breaches and in some severe cases, loss of life) in the past three years, marking a slight upward trend in the prevalence of major outages. According to Uptime’s 2022 Data Center Resiliency Survey, 80% of data center managers and operators have experienced some type of outage in the past three years – a marginal increase over the norm, which has fluctuated between 70% and 80%.</li>
<li><strong>The proportion of outages costing over $100,000 has soared in recent years.</strong> Over 60% of failures result in at least $100,000 in total losses, up substantially from 39% in 2019. The share of outages that cost upwards of $1 million increased from 11% to 15% over that same period.</li>
<li><strong>Power-related problems continue to dog data center operators.</strong> Power-related outages account for 43% of outages that are classified as significant (causing downtime and financial loss). The single biggest cause of power incidents is uninterruptible power supply (UPS) failures.</li>
<li><strong>Networking issues are causing a large portion of IT outages.</strong> According to Uptime’s 2022 Data Center Resiliency Survey, networking-related problems have been the single biggest cause of all IT service downtime incidents – regardless of severity – over the past three years. Outages attributed to software, network and systems issues are on the rise due to complexities from the increasing use of cloud technologies, software-defined architectures and hybrid, distributed architectures.</li>
<li><strong>The overwhelming majority of human error-related outages involve ignored or inadequate procedures.</strong> Nearly 40% of organizations have suffered a major outage caused by human error over the past three years. Of these incidents, 85% stem from staff failing to follow procedures or from flaws in the processes and procedures themselves.</li>
<li><strong>External IT providers cause most major public outages.</strong> The more workloads that are outsourced to external providers, the more these operators account for high-profile, public outages. Third-party, commercial IT operators (including cloud, hosting, colocation, telecommunication providers, etc.) account for 63% of all publicly reported outages that Uptime has tracked since 2016. In 2021, commercial operators caused 70% of all outages.</li>
<li><strong>Prolonged downtime is becoming more common in publicly reported outages.</strong> The gap between the beginning of a major public outage and full recovery has stretched significantly over the last five years. Nearly 30% of these outages in 2021 lasted more than 24 hours, a disturbing increase from just 8% in 2017.</li>
<li><strong>Public outage trends suggest there will be at least 20 serious, high-profile IT outages worldwide each year.</strong> Of the 108 publicly reported outages in 2021, 27 were serious or severe. This ratio has been fairly consistent since the Uptime Intelligence team began cataloging major outages in 2016, indicating that roughly one-fourth of publicly recorded outages each year are likely to be serious or severe.</li>
</ul>
</blockquote>
<p>Rather than compensating users, SLAs are more of a &ldquo;punishment&rdquo; for cloud providers when their service quality fails to meet standards. The deterrent effect of the punishment depends on the certainty and severity of the punishment. Monthly duration/voucher compensations impose virtually no real cost on cloud providers, making the severity of the punishment nearly zero; compensation also requires users to submit evidence and get approval from the cloud provider, meaning the certainty is not high either.</p>
<p>Compared to experts and engineers who might lose bonuses and jobs due to failures, the punishment of SLAs for cloud providers is akin to a slap on the wrist. If the punishment is meaningless, then cloud providers have no incentive to improve service quality. When users encounter problems, they can only wait and die, and the service attitude towards small customers, in particular, is arrogantly dismissive compared to self-built/third-party service companies.</p>
<p>More subtly, cloud providers have absolute power over the SLA agreement: they reserve the right to unilaterally adjust and revise SLAs and inform users of their effectiveness, leaving users with only the right to choose not to use the service, without any participation or choice. As a default &ldquo;take-it-or-leave-it&rdquo; clause, it blocks any possibility for users to seek meaningful compensation.</p>
<p>Thus, SLAs are not an insurance policy against losses for users. In the worst-case scenario, it&rsquo;s an unavoidable loss; at best, it provides emotional comfort. Therefore, when choosing cloud services, we need to be vigilant and fully understand the contents of their SLAs to make informed decisions.</p>
<hr>
<h2 id="reference">Reference</h2>
<p>【1】<a href="https://help.aliyun.com/document_detail/122389.html">阿里云 ESSD云盘</a></p>
<p>【2】<a href="https://help.aliyun.com/document_detail/56773.htm">阿里云 SLA 汇总页</a></p>
<p>【3】<a href="https://aws.amazon.com/cn/legal/service-level-agreements/">AWS SLA 汇总页</a></p>
<p>【4】<a href="https://d1.awsstatic.com/legal/AmazonComputeServiceLevelAgreement/Amazon_Compute_Service_Level_Agreement_Chinese_Simplfied_(CN)2022-05-25.pdf">AWS EC2 SLA 样例</a></p>
<p>【5】<a href="https://journal.uptimeinstitute.com/cloud-slas-punish-not-compensate/">云SLA更像是惩罚用户而不是补偿用户</a></p>
<p>【6】<a href="https://www.usenix.org/system/files/atc22-lu.pdf">NVMe SSD失效率统计</a></p>
<p>【7】<a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">公有云是不是杀猪盘</a></p>
<p>【8】<a href="https://www.doit.com.cn/p/312087.html">腾讯云给一家创业公司带来的灾难！</a></p>
<p>【9】<a href="https://www.businesswire.com/news/home/20220608005265/en/Uptime-Institute%E2%80%99s-2022-Outage-Analysis-Finds-Downtime-Costs-and-Consequences-Worsening-as-Industry-Efforts-to-Curb-Outage-Frequency-Fall-Short">Uptime Institute 2022 故障分析</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-9acfe4d5f6e1972f749837119d2bab4b">EBS: Pig Slaughter Scam</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag">WeChat</a></b> |
        
		<time datetime="2023-03-15" class="text-muted">2023-03-15</time>
        
	</div>
	<p>We already answer the question: <a href="/blog/cloud/rds/">Is RDS an Idiot Tax?</a>.
But when compared to the <strong>hundredfold markup of public cloud block storage</strong>, cloud databases seem almost reasonable. This article uses real data to reveal the true business model of public cloud: <strong>&ldquo;Cheap&rdquo; EC2/S3 to attract customers, and fleece with &ldquo;Expensive&rdquo; EBS/RDS</strong>. Such practices have led public clouds to diverge from their original mission and vision.</p>
<ul>
<li><a href="/blog/cloud/ebs/#tl-dr">TLDR</a></li>
<li><a href="/blog/cloud/ebs/#what-a-scam">WHAT a Scam</a></li>
<li><a href="/blog/cloud/ebs/#why-so-pricing">WHY so pricing</a></li>
<li><a href="/blog/cloud/ebs/#how-to-do-that">HOW to do that</a></li>
<li><a href="/blog/cloud/ebs/#the-forgotten-vision">The Forgotten Vision</a></li>
<li><a href="/blog/cloud/ebs/#where-to-go">Where to Go</a></li>
<li><a href="/blog/cloud/ebs/#references">References</a></li>
</ul>
<p><a href="https://mp.weixin.qq.com/s/UxjiUBTpb1pRUfGtR9V3ag"><img src="/zh/blog/cloud/ebs/featured.jpg"></a></p>
<hr>
<h2 id="tl-dr">TL; DR</h2>
<p>EC2/S3/EBS pricing serves as the anchor for all cloud services pricing. While the pricing for EC2/S3 might still be considered reasonable, EBS pricing is outright extortionate. The best block storage services offered by public cloud providers are essentially on par with off-the-shelf PCI-E NVMe SSDs in terms of performance specifications. Yet, compared to direct hardware purchases, <strong>the cost of AWS EBS can be up to 60 times higher, and Alibaba Cloud&rsquo;s ESSD can reach up to 100 times higher.</strong></p>
<p>Why is there such a staggering markup for plug-and-play disk hardware? Cloud providers fail to justify the exorbitant prices. When considering the design and pricing models of other cloud storage services, there&rsquo;s only one plausible explanation: <strong>The high markup on EBS is a deliberately set barrier, intended to fleece cloud database customers</strong>.</p>
<p>With EC2 and EBS serving as the pricing anchors for cloud databases, their markups are several and several dozen times higher, respectively, thus supporting the exorbitant profit margins of cloud databases. However, such monopolistic profits are unsustainable: the impact of IDC 2.0/telecom/national cloud on IaaS; private cloud/cloud-native/open source as alternatives to PaaS; and the tech industry&rsquo;s massive layoffs, AI disruption, and the impact of China&rsquo;s low labor costs on cloud services (through IT outsourcing/shared expertise). <strong>If public clouds continue to adhere to their current fleecing model, diverging from their original mission of providing fundamental compute and storage infrastructure, they will inevitably face increasingly severe competition and challenges from the aforementioned forces.</strong></p>
<hr>
<h2 id="what-a-scam">WHAT a Scam!</h2>
<p>When you use a microwave at home to heat up a ready-to-eat braised chicken rice meal costing 10 yuan, you wouldn&rsquo;t mind if a restaurant charges you 30 yuan for microwaving the same meal and serving it to you, considering the costs of rent, utilities, labor, and service. But what if the restaurant charges you 1000 yuan for the same dish, claiming: <strong>&ldquo;What we offer is not just braised chicken rice, but a reliable and flexible dining service&rdquo;</strong>, with the chef controlling the quality and cooking time, pay-per-portion so you get exactly as much as you want, pay-per-need so you get as much as you eat, with options to switch to hot and spicy soup or skewers if you don&rsquo;t feel like chicken, claiming it&rsquo;s all worth the price. Wouldn&rsquo;t you feel the urge to give the owner a piece of your mind? This is exactly what&rsquo;s happening with block storage!</p>
<p>With hardware technology evolving rapidly, <strong>PCI-E NVMe SSDs</strong> have reached a new level of performance across various metrics. A common 3.2 TB enterprise-grade MLC SSD offers incredible performance, reliability, and value for money, costing less than ¥3000, significantly outperforming older storage solutions.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-1.png"></p>
<p>Aliyun ESSD PL3 and our own IDC&rsquo;s procured PCI-E NVMe SSDs come from the same supplier. Hence, their maximum capacity and IOPS limitations are identical. AWS&rsquo;s top-tier block storage solution, io2 Block Express, also shares similar specifications and metrics. Cloud providers&rsquo; highest-end storage solutions utilize these 32TB single cards, leading to a maximum capacity limit of 32TB (64TB for AWS), which suggests a high degree of hardware consistency underneath.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-2.png"></p>
<p>However, compared to direct hardware procurement, <strong>the cost of AWS EBS io2 is up to 120 times higher, while Aliyun&rsquo;s ESSD PL3 is up to 200 times higher</strong>. Taking a 3.2TB enterprise-grade PCI-E SSD card as a reference, the ratio of on-demand rental to purchase price is 15 days on AWS and less than 5 days on Aliyun, meaning you could own the entire disk after renting it for this duration. If you opt for a three-year prepaid purchase on Aliyun, taking advantage of the maximum 50% discount, the rental fees over three years could buy over 120 disks of the same model.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-3.gif"></p>
<blockquote>
<p>Is that SSD made of gold ?</p>
</blockquote>
<p><strong>Cloud providers argue that block storage should be compared to SAN</strong> rather than local DAS, which should be compared to <strong>instance storage (Host Storage)</strong> on the cloud. However, public cloud instance storage is generally ephemeral (Ephemeral Storage), with data being wiped once the instance is paused/stopped【7,11】, making it unsuitable for serious production databases. Cloud providers themselves advise against storing critical data on it. Therefore, the only viable option for database storage is EBS block storage. Products like DBFS, which have similar performance and cost metrics to EBS, are also included in this category.</p>
<p>Ultimately, users care not about whether the underlying hardware is SAN, SSD, or HDD; the real priorities are tangible metrics: <strong>latency, IOPS, reliability, and cost</strong>. Comparing local options with the best cloud solutions poses no issue, especially when the top-tier cloud storage uses the same local disks.</p>
<p>Some &ldquo;experts&rdquo; claim that cloud block storage is stable and reliable, offering multi-replica redundancy and error correction. In the past, Share Everything databases required SAN storage, but many databases now operate on a Share Nothing architecture. Redundancy is managed at the database instance level, eliminating the need for triple-replica storage redundancy, especially since enterprise-grade disks already possess strong self-correction capabilities and safety redundancy (UBER &lt; 1e-18). <strong>With redundancy already in place at the database level, multi-replica block storage becomes an unnecessary waste for databases</strong>. Even if cloud providers did use two additional replicas for redundancy, it would only reduce the markup from 200x to 66x, without fundamentally changing the situation.</p>
<p><strong>&ldquo;Experts&rdquo; also liken purchasing &ldquo;cloud services&rdquo; to buying insurance</strong>: &ldquo;An annual failure rate of 0.02% may seem negligible to most, but a single incident can be devastating, with the cloud provider offering a safety net.&rdquo; This sounds appealing, but a closer look at cloud providers&rsquo; EBS SLAs reveals no guarantees for reliability. ESSD cloud disk promotions mention 9 nines of data reliability, but such claims are conspicuously absent from the SLAs. <strong>Cloud providers only guarantee availability, and even then, the guarantees are modest</strong>, as illustrated by the AWS EBS SLA:</p>
<p><img src="/zh/blog/cloud/ebs/ebs-4.png"></p>
<blockquote>
<p>《<a href="/blog/cloud/sla/">Is the Cloud SLA Just a Placebo?</a>》</p>
</blockquote>
<p>In plain language: if the service is down for a day and a half in a month (95% availability), you get a 100% coupon for that month&rsquo;s service fee; seven hours of downtime (99%) yields a 30% coupon; and a few minutes of downtime (99.9% for a single disk, 99.99% for a region) earns a 10% coupon. Cloud providers charge a hundredfold more, yet offer mere coupons as compensation for significant outages. Applications that can&rsquo;t tolerate even a few minutes of downtime wouldn&rsquo;t benefit from these meager coupons, reminiscent of the past incident, &ldquo;The Disaster Tencent Cloud Brought to a Startup Company.&rdquo;</p>
<p>SF Express offers 1% insurance for parcels, compensating for losses with real money. Annual commercial health insurance plans costing tens of thousands can cover millions in expenses when issues arise. The insurance industry should not be insulted; it operates on a principle of value for money. <strong>Thus, an SLA is not an insurance policy against losses for users. At worst, it&rsquo;s a bitter pill to swallow without recourse; at best, it provides emotional comfort.</strong></p>
<p>The premium charged for cloud database services might be justified by &ldquo;expert manpower,&rdquo; but this rationale falls flat for plug-and-play disks, <strong>with cloud providers unable to explain the exorbitant price markup</strong>. When pressed, their engineers might only say:</p>
<p>&ldquo;We&rsquo;re just following AWS; that&rsquo;s how they designed it.&rdquo;</p>
<hr>
<h2 id="why-so-pricing">WHY so Pricing?</h2>
<p>Even engineers within public cloud services may not fully grasp the rationale behind their pricing strategies, and those who do are unlikely to share. However, this does not prevent us from deducing the reasoning behind such decisions from the <strong>design of the product</strong> itself.</p>
<p>Storage follows a de facto standard: <strong>POSIX file system + block storage</strong>. Whether it&rsquo;s database files, images, audio, or video, they all use the same file system interface to store data on disks. But AWS&rsquo;s &ldquo;divine intervention&rdquo; splits this into two distinct services: <strong>S3</strong> (Simple Storage Service) and <strong>EBS</strong> (Elastic Block Store). Many &ldquo;followers&rdquo; have imitated AWS&rsquo;s product design and pricing model, yet the logic and principles behind such actions remain elusive.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-5.png"></p>
<blockquote>
<p>Aliyun EBS OSS Compare</p>
</blockquote>
<p><strong>S3</strong>, standing for <strong>Simple Storage Service</strong>, is a simplified alternative to file system/storage: sacrificing strong consistency, directory management, and access latency for the sake of low cost and massive scalability. It offers a simple, high-latency, high-throughput flat KV storage service, detached from standard storage services. This aspect, being cost-effective, serves as a major allure for users to migrate to the cloud, thus becoming possibly the only <strong>de facto cloud computing standard across all public cloud providers</strong>.</p>
<p><strong>Databases, on the other hand, require low latency, strong consistency, high quality, high performance, and random read/write block storage</strong>, which is encapsulated in the EBS service: Elastic Block Store. This segment becomes the forbidden fruit for cloud providers: reluctant to let users dabble. <strong>Because EBS serves as the pricing anchor for RDS — the barrier and moat for cloud databases</strong>.</p>
<p>For IaaS providers, who make their living by selling resources, there&rsquo;s not much room for price inflation, as costs can be precisely calculated against the BOM. However, for PaaS services like cloud databases, which include &ldquo;services,&rdquo; labor/development costs are significantly marked up, allowing for <strong>astronomical pricing</strong> and high profits. Despite storage, computing, and networking making up half of the revenue for domestic public cloud IaaS, their gross margin stands only at <strong>15% to 20%</strong>. In contrast, public cloud PaaS, represented by cloud databases, can achieve gross margins of <strong>50%</strong> or higher, vastly outperforming the IaaS model.</p>
<p><strong>If users opt to use IaaS resources (EC2/EBS) to build their own databases, it represents a significant loss of profit for cloud providers. Thus, cloud providers go to great lengths to prevent this scenario. But how is such a product designed to meet this need?</strong></p>
<p>Firstly, <strong>instance storage</strong>, which is best suited for self-hosted databases, must come with various restrictions: instances that are hibernated/stopped are reclaimed and wiped, preventing serious production database services from running on EC2&rsquo;s built-in disks. Although EBS&rsquo;s performance and reliability might slightly lag behind local NVMe SSD storage, it&rsquo;s still viable for database operations, hence the restrictions: but not without giving users an option, hence the <strong>exorbitant pricing</strong>! As compensation, the secondary, cheaper, and massive storage option, S3, can be priced more affordably to lure customers.</p>
<p>Of course, to make customers bite, some cloud computing KOLs promote the accompanying &ldquo;public cloud-native&rdquo; philosophy: &ldquo;EC2 is not suitable for stateful applications. Please store state in S3 or RDS and other managed services, as these are the &lsquo;best practices&rsquo; for using our cloud.&rdquo;</p>
<p><img src="/zh/blog/cloud/ebs/ebs-7.png"></p>
<p>These four points are well summarized, but what public clouds will not disclose is the cost of these &ldquo;best practices.&rdquo; To put <a href="https://github.com/lipingtababa/cloud-native-best-practices/blob/main/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%8E%8B%E5%9B%9B%E6%9D%A1.md">these four points</a> in layman&rsquo;s terms, they form a carefully designed trap for customers:</p>
<p><strong>Dump ordinary files in S3!</strong> (With such cost-effective S3, who needs EBS?)</p>
<p><strong>Don&rsquo;t build your own database!</strong> (Forget about tinkering with open-source alternatives using instance storage)</p>
<p><strong>Please deeply use the vendor&rsquo;s proprietary identity system</strong> (vendor lock-in)</p>
<p><strong>Faithfully contribute to the cloud database!</strong> (Once users are locked in, the time to &ldquo;slaughter&rdquo; arrives)</p>
<hr>
<h2 id="how-to-do-that">HOW to Do that</h2>
<p>The business model of public clouds can be summarized as: <strong>Attract customers with cheap EC2/S3, make a killing with EBS/RDS</strong>.</p>
<p>To slaughter the pig, you first need to raise it. No pains, no gains. Thus, for new users, startups, and small-to-medium enterprises, public clouds spare no effort in offering sweeteners, even at a loss, to drum up business. New users enjoy a significant discount on their first order, startups receive free or half-price credits, and the pricing strategy is subtly crafted.</p>
<p>Taking AWS RDS <a href="https://instances.vantage.sh/">pricing</a> as an example, the unit price for mini models with 1 to 2 cores is only <strong>a few dollars per core per month</strong>, which translates to three to four hundred yuan per year (excluding storage): If you need a low-usage database for minor storage, this might be the most straightforward and affordable choice.</p>
<p><a href="https://instances.vantage.sh/"><img src="/zh/blog/cloud/ebs/ebs-8.png"></a></p>
<p>However, <strong>as soon as you slightly increase the configuration, even by just a little, the price per core per month jumps by orders of magnitude</strong>, reaching twenty to a hundred dollars, with the potential to skyrocket by dozens of times — <strong>and that&rsquo;s before the doubling effect of the astonishing EBS prices</strong>. Users only realize what has happened when they are faced with a suddenly astronomical bill.</p>
<p>For instance, using RDS for PostgreSQL on AWS, the price for a 64C / 256GB db.m5.16xlarge RDS for one month is $25,817, which is equivalent to about 180,000 yuan per month. The monthly rent is enough for you to buy two servers with even better performance and set them up on your own. <strong>The rent-to-buy ratio doesn&rsquo;t even last a month; renting for just over ten days is enough to buy the whole server for yourself</strong>.</p>
<table>
<thead>
<tr>
<th>Payment Model</th>
<th>Price</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted IDC (Single Physical Server)</td>
<td>¥75k / 5 years</td>
<td>1.5</td>
</tr>
<tr>
<td>Self-hosted IDC (2-3 Server HA Cluster)</td>
<td>¥150k / 5 years</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (On-demand)</td>
<td>¥87.36/hour</td>
<td>76.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Monthly)</td>
<td>¥42k / month</td>
<td>50</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (Yearly, 15% off)</td>
<td>¥425,095 / year</td>
<td>42.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS (3-year, 50% off)</td>
<td>¥750,168 / 3 years</td>
<td>25</td>
</tr>
<tr>
<td>AWS (On-demand)</td>
<td>$25,817 / month</td>
<td>217</td>
</tr>
<tr>
<td>AWS (1-year, no upfront)</td>
<td>$22,827 / month</td>
<td>191.7</td>
</tr>
<tr>
<td>AWS (3-year, full upfront)</td>
<td>$120k + $17.5k/month</td>
<td>175</td>
</tr>
<tr>
<td>AWS China/Ningxia (On-demand)</td>
<td>¥197,489 / month</td>
<td>237</td>
</tr>
<tr>
<td>AWS China/Ningxia (1-year, no upfront)</td>
<td>¥143,176 / month</td>
<td>171</td>
</tr>
<tr>
<td>AWS China/Ningxia (3-year, full upfront)</td>
<td>¥647k + ¥116k/month</td>
<td>160.6</td>
</tr>
</tbody>
</table>
<p>Comparing the costs of self-hosting versus using a cloud database:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted Servers 64C / 384G / 3.2TB NVME SSD 660K IOPS (2-3 servers)</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS PG High-Availability pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3</td>
<td>25 ~ 50</td>
</tr>
<tr>
<td>AWS RDS PG High-Availability db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS</td>
<td>160 ~ 217</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>RDS</strong> pricing compared to self-hosting, see &ldquo;<a href="/blog/cloud/rds/">Is Cloud Database an idiot Tax?</a>&rdquo;</p>
</blockquote>
<p>Any rational business user can see the logic here: **If the purchase of such a service is not for short-term, temporary needs, then it is definitely considered a <strong>major financial misstep</strong>.</p>
<p>This is not just the case with Relational Database Services / RDS, but with all sorts of cloud databases. MongoDB, ClickHouse, Cassandra, if it uses EC2 / EBS, they are all doing the same. Take the popular NoSQL document database MongoDB as an example:</p>
<blockquote>
<p>This kind of pricing could only come from a product manager without a decade-long cerebral thrombosis</p>
</blockquote>
<p><strong>Five years is the typical depreciation period for servers</strong>, and with the maximum discount, a 12-node (64C 512G) configuration is priced at twenty-three million. The minor part of this quote alone could easily cover the five-year hardware maintenance, plus you could afford a team of MongoDB experts to customize and set up as you wish.</p>
<p><strong>Fine dining restaurants charge a 15% service fee on dishes, and users can understand and support this reasonable profit margin</strong>. If cloud databases charge a few tens of percent on top of hardware resources for service fees and elasticity premiums (let&rsquo;s not even start on software costs for cloud services that piggyback on open-source), it can be justified as pricing for productive elements, with the problems solved and services provided being worth the money.</p>
<p>However, charging several hundred or even thousands of percent as a premium falls into the category of <strong>destructive element distribution</strong>: cloud providers bank on the fact that once users are onboard, they have no alternatives, and migration would incur significant costs, so they can confidently proceed with the slaughter! In this sense, the money users pay is not for the service, but rather a compulsory levy of a &ldquo;no-expert tax&rdquo; and &ldquo;protection money&rdquo;.</p>
<hr>
<h2 id="the-forgotten-vision">The Forgotten Vision</h2>
<p>Facing accusations of &ldquo;slaughtering the pig,&rdquo; cloud vendors often defend themselves by saying: &ldquo;Oh, what you&rsquo;re seeing is the list price. Sure, it&rsquo;s said to be a minimum of 50% off, but for major customers, there are no limits to the discounts.&rdquo; As a rule of thumb: <strong>the cost of self-hosting fluctuates around 5% to 10% of the current cloud service list prices</strong>. If such discounts can be maintained long-term, cloud services become more competitive than self-hosting.</p>
<p>Professional and knowledgeable large customers, especially those capable of migrating at any time, can indeed negotiate steep discounts of up to 80% with public clouds, while smaller customers naturally lack bargaining power and are unlikely to secure such deals.</p>
<p>However, <strong>cloud computing should not turn into &lsquo;calculating clouds&rsquo;</strong>: if cloud providers can only offer massive discounts to large enterprises while &ldquo;shearing the sheep&rdquo; and &ldquo;slaughtering the pig&rdquo; when dealing with small and medium-sized customers and developers, they are essentially <strong>robbing the poor to subsidize the rich</strong>. This practice completely contradicts the original intent and vision of cloud computing and is unsustainable in the long run.</p>
<p>When cloud computing first emerged, the focus was on the <strong>cloud hardware / IaaS layer</strong>: computing power, storage, bandwidth. Cloud hardware represents the founding story of cloud vendors: to make computing and storage resources as accessible as utilities, with themselves playing the role of infrastructure providers. This is a compelling vision: public cloud vendors can reduce hardware costs and spread labor costs through economies of scale; ideally, while keeping a profit for themselves, they can offer storage and computing power that is more cost-effective and flexible than IDC prices.</p>
<p>On the other hand, <strong>cloud software (PaaS / SaaS)</strong> follows a fundamentally different business logic: cloud hardware relies on economies of scale to optimize overall efficiency and earn money through resource pooling and overselling, which represents a progress in efficiency. Cloud software, however, relies on sharing expertise and charging service fees for outsourced operations and maintenance. Many services on the public cloud are essentially wrappers around free open-source software, relying on monopolizing expertise and exploiting information asymmetry to charge exorbitant insurance fees, which constitutes a transfer of value.</p>
<p>Unfortunately, for the sake of obfuscation, both cloud software and cloud hardware are branded under the &ldquo;cloud&rdquo; title. Thus, the narrative of cloud computing mixes breaking resource monopolies with establishing expertise monopolies: <strong>it combines the idealistic glow of democratizing computing power across millions of households</strong> with <strong>the greed of monopolizing and unethically profiting from it</strong>.</p>
<p><strong>Public cloud providers that abandon platform neutrality and their original intent of being infrastructure providers, indulging in PaaS / SaaS / and even application layer profiteering, will sink in a bottomless competition.</strong></p>
<hr>
<h2 id="where-to-go">Where to Go</h2>
<p><strong>Monopolistic profits vanish as competition emerges, plunging public cloud providers into a grueling battle.</strong></p>
<p>At the infrastructure level, telecom operators, state-owned clouds, and IDC 1.5/2.0 have entered the fray, offering highly competitive IaaS services. These services include turnkey network and electricity hosting and maintenance, with high-end servers available for either purchase and hosting or direct rental at actual prices, showing no fear in terms of flexibility.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-11.png"></p>
<blockquote>
<p>IDC 2.0&rsquo;s new server rental model: Actual price rental, ownership transfers to the user after a full term</p>
</blockquote>
<p>On the software front, what once were the technical barriers of public clouds, various management software / <strong>PaaS</strong> solutions, have seen excellent open-source alternatives emerge. OpenStack / Kubernetes have replaced EC2, MinIO / Ceph have taken the place of S3, and on RDS, open-source alternatives like <strong>Pigsty</strong> and various K8S Operators have appeared.</p>
<p>The whole &ldquo;cloud-native&rdquo; movement, in essence, is the open-source ecosystem&rsquo;s response to the challenge of public cloud &ldquo;freeloading&rdquo;: <strong>users and developers have created a complete set of local-priority public cloud open-source alternatives to avoid being exploited by public cloud providers</strong>.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-12.png"></p>
<blockquote>
<p>The term &ldquo;CloudNative&rdquo; is aptly named, reflecting different perspectives: public clouds see it as being &ldquo;born on the public cloud,&rdquo; while private clouds think of it as &ldquo;running cloud-like services locally.&rdquo; Ironically, the biggest proponents of Kubernetes are the public clouds themselves, akin to a salesman crafting his own noose.</p>
</blockquote>
<p>In the context of economic downturn, cost reduction and efficiency gains have become the main theme. Massive layoffs in the tech sector, coupled with the future large-scale impact of AI on intellectual industries, will release a large amount of related talent. Additionally, the low-wage advantage in our era will significantly alleviate the scarcity and high cost of building one&rsquo;s own talent pool. Labor costs, in comparison to cloud service costs, offer much more advantage.</p>
<p>Considering these trends, the combination of IDC2.0 and open-source self-building is becoming increasingly competitive: for organizations with a bit of scale and talent reserves, bypassing public clouds as middlemen and directly collaborating with IDCs is clearly a more economical choice.</p>
<p>Staying true to the original mission is essential. Public clouds do an admirable job at the cloud hardware / IaaS level, except for being outrageously expensive, there aren’t many issues, and the offerings are indeed solid. If they could return to their original vision and truly excel as providers of basic infrastructure, akin to utilities, selling resources might not offer high margins, but it would allow them to earn money standing up. Continuing down the path of exploitation, however, will ultimately lead customers to vote with their feet.</p>
<p><img src="/zh/blog/cloud/ebs/ebs-13.png"></p>
<h2 id="references">References</h2>
<p>【1】<a href="https://mp.weixin.qq.com/s/w5XKsXf_NLWnKB6G-sbZaw">撤离 AWS：3年省下27.5亿元</a></p>
<p>【2】<a href="/blog/cloud/rds/">云数据库是不是智商税</a></p>
<p>【3】<a href="/blog/cloud/paradigm/">范式转移：从云到本地优先</a></p>
<p>【4】<a href="https://mp.weixin.qq.com/s/ANFnbDXwuhKI99fgYRZ9ug">腾讯云CDN：从入门到放弃</a></p>
<p>【5】<a href="https://mp.weixin.qq.com/s/WsR-c64OJfkMql7zX7XmDA">炮打 RDS，Pigsty v2.0 发布</a></p>
<p>【6】<a href="https://en.shannon-sys.com/product.html?name=gen_4">Shannon NVMe Gen4 Series</a></p>
<p>【7】<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html">AWS实例存储</a></p>
<p>【8】<a href="https://aws.amazon.com/cn/blogs/storage/achieve-higher-database-performance-using-amazon-ebs-io2-block-express-volumes/">AWS io2 gp3 存储性能与定价</a></p>
<p>【9】<a href="https://aws.amazon.com/cn/ebs/sla/">AWS EBS SLA</a></p>
<p>【10】<a href="https://instances.vantage.sh/">AWS EC2 / RDS 报价查询</a></p>
<p>【11】<a href="https://help.aliyun.com/document_detail/63138.html">Aliyun：Host Storage</a></p>
<p>【12】<a href="https://help.aliyun.com/document_detail/25383.html">阿里云：云盘概述</a></p>
<p>【13】<a href="https://help.aliyun.com/document_detail/445806.html">图说块存储与云盘</a></p>
<p>【14】<a href="https://news.futunn.com/post/24656633">从狂飙到集体失速，云计算换挡寻出路</a></p>
<p>【15】<a href="https://mp.weixin.qq.com/s/LC5jAhuVObRcrTLxI1FUQA">云计算为啥还没挖沙子赚钱？</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-2f6739426df63d5dd62ead985e471dc9">RDS: The Idiot Tax</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/LefEAXTcBH-KBJNhXNoc7A">WeChat</a></b> |
        
		<time datetime="2023-01-30" class="text-muted">2023-01-30</time>
        
	</div>
	<p>As the season of layoffs hits big tech companies, cost-cutting and efficiency are top of mind. Public cloud databases, often referred to as the &ldquo;slaughterhouse knives&rdquo; of the cloud, are under increasing scrutiny. The question now is: <em>Can their dominance continue?</em></p>
<p>Recently, DHH (David Heinemeier Hansson), co-founder of Basecamp and HEY, published a thought-provoking piece that has sparked a lot of debate. His core message is succinct:</p>
<blockquote>
<p>&ldquo;We spend $500,000 a year on cloud databases (RDS/ES). Do you know how many powerful servers that kind of money could buy?</p>
<p><strong>We’re off the cloud. Goodbye!</strong>&rdquo;</p>
</blockquote>
<p><strong>So, How Many Powerful Servers Could $500,000 Buy?</strong></p>
<p><a href="https://mp.weixin.qq.com/s/YKqH324Qtg0mj6WfSMb66w"><img src="/zh/blog/cloud/rds/featured.jpg"></a></p>
<hr>
<h2 id="absurd-pricing">Absurd Pricing</h2>
<blockquote>
<p>Sharpening the knives for the sheep and pigs</p>
</blockquote>
<p><strong>Let&rsquo;s rephrase the question: how much do servers and RDS (Relational Database Service) cost?</strong></p>
<p>Taking the physical server model we heavily use as an example: Dell R730, 64 cores, 384GB of memory, equipped with a 3.2 TB MLC NVME SSD. A server like this, running a standard production-level PostgreSQL, can handle up to hundreds of thousands of TPS (Transactions Per Second), and read-only queries can reach four to five hundred thousand. How much does it cost? Including electricity, internet, IDC (Internet Data Center) hosting, and maintenance fees, and amortizing the cost over a 5-year depreciation period, the total lifecycle cost is around seventy-five thousand, or fifteen thousand per year. Of course, for production use, high availability is a must, so a typical database cluster would need two to three physical servers, amounting to an annual cost of thirty to forty-five thousand dollars.</p>
<p>This calculation does not include the cost of DBA (Database Administrator) salaries: managing tens of thousands of cores with just two or three people is not that expensive.</p>
<p>If you directly purchase a cloud database of this specification, what would the cost be? Let&rsquo;s look at the pricing from Alibaba Cloud in China. Since the basic version is practically unusable for production (for reference, see: &ldquo;Cloud Database: From Deletion to Desertion&rdquo;), we&rsquo;ll choose the high-availability version, which usually involves two to three instances. Opting for a yearly or monthly subscription, for an exclusive use of a 64-core, 256GB instance with PostgreSQL 15 on x86 in East China 1 availability zone, and adding a 3.2TB ESSD PL3 cloud disk, the annual cost ranges from 250,000 (for a 3-year contract) to 750,000 (on-demand), with storage costs accounting for about a third.</p>
<p><img src="/zh/blog/cloud/rds/rds-1.png"></p>
<p>Let&rsquo;s also consider AWS, the leading public cloud provider. The closest equivalent on AWS is the db.m5.16xlarge, also with 64 cores and 256GB across multiple availability zones. Similarly, we add a 3.2TB io1 SSD disk with up to 80,000 IOPS, and review the global and China-specific pricing from AWS. The overall cost ranges from 1.6 million to 2.17 million yuan per year, with storage costs accounting for about half. The table below summarizes the costs:</p>
<table>
<thead>
<tr>
<th>Payment Model</th>
<th>Price</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted IDC (Single Physical Server)</td>
<td>¥75k / 5 years</td>
<td>1.5</td>
</tr>
<tr>
<td>Self-hosted IDC (2-3 Server HA Cluster)</td>
<td>¥150k / 5 years</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>AWS (On-demand)</td>
<td>$25,817 / month</td>
<td>217</td>
</tr>
<tr>
<td>AWS (1-year, no upfront)</td>
<td>$22,827 / month</td>
<td>191.7</td>
</tr>
<tr>
<td>AWS (3-year, full upfront)</td>
<td>$120k + $17.5k/month</td>
<td>175</td>
</tr>
<tr>
<td>AWS China/Ningxia (On-demand)</td>
<td>¥197,489 / month</td>
<td>237</td>
</tr>
<tr>
<td>AWS China/Ningxia (1-year, no upfront)</td>
<td>¥143,176 / month</td>
<td>171</td>
</tr>
<tr>
<td>AWS China/Ningxia (3-year, full upfront)</td>
<td>¥647k + ¥116k/month</td>
<td>160.6</td>
</tr>
</tbody>
</table>
<p>Comparing the costs of self-hosting versus using a cloud database:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Cost Per Year (¥10k)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Self-hosted Servers 64C / 384G / 3.2TB NVME SSD 660K IOPS (2-3 servers)</td>
<td>3.0 ~ 4.5</td>
</tr>
<tr>
<td>Alibaba Cloud RDS PG High-Availability pg.x4m.8xlarge.2c, 64C / 256GB / 3.2TB ESSD PL3</td>
<td>25 ~ 50</td>
</tr>
<tr>
<td>AWS RDS PG High-Availability db.m5.16xlarge, 64C / 256GB / 3.2TB io1 x 80k IOPS</td>
<td>160 ~ 217</td>
</tr>
</tbody>
</table>
<p>So, the question arises, <strong>if the cost of using a cloud database for one year is enough to buy several or even more than a dozen better-performing servers, what then is the real benefit of using a cloud database?</strong> Of course, large public cloud customers can usually receive business discounts, but even with discounts, the magnitude of the cost difference is hard to ignore.</p>
<p><strong>Is using a cloud database essentially paying a &ldquo;tax&rdquo; for lack of better judgment?</strong></p>
<hr>
<h2 id="comfort-zone">Comfort Zone</h2>
<blockquote>
<p>No Silver Bullet</p>
</blockquote>
<p><strong>Databases are the heart of data-intensive applications</strong>, and since applications follow the lead of databases, choosing the right database requires great care. Evaluating a database involves many dimensions: reliability, security, simplicity, scalability, extensibility, observability, maintainability, cost-effectiveness, and more. What clients truly care about are these attributes, not the fluffy tech hype: decoupling of compute and storage, Serverless, HTAP, cloud-native, hyper-converged&hellip; These must be translated into the language of engineering: <strong>what is sacrificed for what is gained</strong> to be meaningful.</p>
<p>Public cloud proponents like to gild it: cost-saving, flexible elasticity, reliable security, a panacea for enterprise digital transformation, a revolution from horse-drawn carriage to automobile, good, fast, and cheap, and so on. Unfortunately, few of these claims are realistic. Cutting through the fluff, the only real advantage of cloud databases over professional database services is <strong>elasticity</strong>, specifically in two aspects: <strong>low startup costs and strong scalability</strong>.</p>
<p><strong>Low startup costs</strong> mean that users don&rsquo;t need to build data centers, hire and train personnel, or purchase servers to get started; <strong>strong scalability</strong> refers to the ease of upgrading or downgrading configurations and scaling capacity. Thus, the core scenarios where public cloud truly fits are these two:</p>
<ol>
<li><strong>Initial stages, simple applications with minimal traffic</strong></li>
<li><strong>Workloads with no predictable pattern, experiencing drastic fluctuations</strong></li>
</ol>
<p>The former mainly includes simple websites, personal blogs, small apps and tools, demos/PoC, and the latter includes low-frequency data analysis/model training, sudden spike sales or ticket grabs, celebrity concurrent affairs, and other special scenarios.</p>
<p><strong>The business model of the public cloud is essentially renting</strong>: renting servers, bandwidth, storage, experts. It&rsquo;s fundamentally no different from renting houses, cars, or power banks. Of course, renting servers and outsourcing operations doesn&rsquo;t sound very appealing, hence the term &ldquo;cloud&rdquo; sounds more like a cyber landlord. The characteristic of the renting model is its elasticity.</p>
<p><strong>The renting model has its benefits</strong>, for example, shared power banks can meet the temporary, small-scale charging needs when out and about. However, for many people who travel daily between home and work, using shared power banks to charge phones and computers every day is undoubtedly absurd, especially when renting a power bank for an hour costs about the same as buying one outright after just a few hours. Renting a car can perfectly meet temporary, emergency, or one-off transportation needs: traveling or hauling goods on short notice. But if your travel needs are frequent and local, purchasing an autonomous car might be the most convenient and cost-effective choice.</p>
<p><strong>The key issue is the rent-to-own ratio</strong>, with houses taking decades, cars a few years, but public cloud servers usually only a few months. If your business can sustain for more than a few months, why rent instead of buying outright?</p>
<p>Thus, the money cloud vendors make comes either from VC-funded tech startups seeking explosive growth, from entities in gray areas where the rent-seeking space exceeds the cloud premium, from the foolishly wealthy, or from a mishmash of webmasters, students, VPN individual users. Smart, high-net-worth enterprise customers, who could enjoy a comfortable, affordable big house, why would they choose to squeeze into rental cube apartments?</p>
<p><strong>If your business fits within the suitable spectrum for the public cloud, that&rsquo;s fantastic; but paying several times or even more than a tenfold premium for unnecessary flexibility and elasticity is purely a tax on lack of intelligence</strong>.</p>
<hr>
<h2 id="the-cost-assassin">The Cost Assassin</h2>
<blockquote>
<p>Profit margins lie in information asymmetry, but you can&rsquo;t fool everyone forever.</p>
</blockquote>
<p>The elasticity of public clouds is designed for their business model: <strong>low startup costs, high maintenance costs</strong>. Low startup costs lure users to the cloud, and the excellent elasticity adapts to business growth at any time. However, once the business stabilizes, vendor lock-in occurs, making it difficult to switch providers, and the high maintenance costs become unbearable for users. This model is colloquially known as the <strong>pig slaughtering scam</strong>.</p>
<p><img src="/zh/blog/cloud/rds/rds-2.gif"></p>
<p>In the first stop of my career, I had such a pig slaughtering experience that remains vivid in my memory. As one of the first internal BUs forced onto A Cloud, A Cloud directly sent engineers to handhold us through the cloud migration process. We replaced our self-built big data/database suite with ODPS. The service was indeed decent, but the annual cost of storage and computing soared from tens of millions to nearly a hundred million, almost transferring all profits to A Cloud, making it the ultimate cost assassin.</p>
<p><img src="/zh/blog/cloud/rds/rds-3.jpeg"></p>
<p>At my next stop, the situation was entirely different. We managed a PostgreSQL and Redis database cluster with 25,000 cores and 4.5 million QPS. For databases of this size, if charged by AWS RCU/WCU, the cost would be billions annually; even with a long-term, yearly subscription and a substantial business discount, it would still cost at least fifty to sixty million. Yet, we had only two or three DBAs and a few hundred servers, with a total annual cost of manpower and assets of less than ten million.</p>
<p><img src="/zh/blog/cloud/rds/rds-31.png"></p>
<p>Here, we can calculate the unit cost in a simple way: the comprehensive cost of using one core (including memory/disk) for a month, termed as <strong>core·month</strong>. We have calculated the costs of self-built server types and compared them with the quotes from cloud providers, with the following rough results:</p>
<table>
<thead>
<tr>
<th style="text-align:center">硬件算力</th>
<th style="text-align:center">单价</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">IDC自建机房(独占物理机 A1: 64C384G)</td>
<td style="text-align:center">19</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房(独占物理机 B1: 40C64G)</td>
<td style="text-align:center">26</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房(独占物理机 C2: 8C16G)</td>
<td style="text-align:center">38</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房(容器，超卖200%)</td>
<td style="text-align:center">17</td>
</tr>
<tr>
<td style="text-align:center">IDC自建机房(容器，超卖500%)</td>
<td style="text-align:center">7</td>
</tr>
<tr>
<td style="text-align:center">UCloud 弹性虚拟机(8C16G，有超卖)</td>
<td style="text-align:center">25</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 2x内存(独占无超卖)</td>
<td style="text-align:center">107</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 4x内存(独占无超卖)</td>
<td style="text-align:center">138</td>
</tr>
<tr>
<td style="text-align:center">阿里云 弹性服务器 8x内存(独占无超卖)</td>
<td style="text-align:center">180</td>
</tr>
<tr>
<td style="text-align:center">AWS C5D.METAL 96C 200G (按月无预付)</td>
<td style="text-align:center">100</td>
</tr>
<tr>
<td style="text-align:center">AWS C5D.METAL 96C 200G(预付3年)</td>
<td style="text-align:center">80</td>
</tr>
<tr>
<td style="text-align:center"><strong>数据库</strong></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">AWS RDS PostgreSQL db.T2 (4x)</td>
<td style="text-align:center">440</td>
</tr>
<tr>
<td style="text-align:center">AWS RDS PostgreSQL db.M5 (4x)</td>
<td style="text-align:center">611</td>
</tr>
<tr>
<td style="text-align:center">AWS RDS PostgreSQL db.R6G (8x)</td>
<td style="text-align:center">786</td>
</tr>
<tr>
<td style="text-align:center">AWS RDS PostgreSQL db.M5 24xlarge</td>
<td style="text-align:center">1328</td>
</tr>
<tr>
<td style="text-align:center">阿里云 RDS PG 2x内存(独占)</td>
<td style="text-align:center">260</td>
</tr>
<tr>
<td style="text-align:center">阿里云 RDS PG 4x内存(独占)</td>
<td style="text-align:center">320</td>
</tr>
<tr>
<td style="text-align:center">阿里云 RDS PG 8x内存(独占)</td>
<td style="text-align:center">410</td>
</tr>
<tr>
<td style="text-align:center">ORACLE数据库授权</td>
<td style="text-align:center">10000</td>
</tr>
</tbody>
</table>
<p>So, the question arises, why can server hardware priced at twenty units be sold for hundreds, and why does installing cloud database software on it multiply the price? <strong>Is it because the operations are made of gold, or is the server made of gold?</strong></p>
<p>A common response is: <em><strong>Databases are the crown jewels of foundational software, embodying countless intangible intellectual properties BlahBlah</strong></em>. Thus, it&rsquo;s reasonable for the software to be priced much higher than the hardware. This reasoning might be acceptable for top-tier commercial databases like Oracle, or console games from Sony and Nintendo.</p>
<p>But for cloud databases (RDS for PostgreSQL/MySQL/&hellip;) on public clouds, which are essentially rebranded and modified open-source database kernels with added control software and shared DBA services, this markup is absurd: the database kernel is free. <strong>Is your control software made of gold, or are your DBAs made of gold?</strong></p>
<p>The secret of public clouds lies here: <strong>they acquire customers with &lsquo;cheap&rsquo; S3 and EC2, then &ldquo;slaughter the pig&rdquo; with RDS</strong>.</p>
<p>Although nearly half of the revenue of domestic public cloud IaaS (storage, computing, network) comes with only a 15% to 20% gross margin, the revenue from public cloud PaaS may be lower, but its gross margin can reach 50%, utterly outperforming the resource-selling IaaS. <strong>And the most representative of PaaS services is the cloud database</strong>.</p>
<p>Normally, if you&rsquo;re not using public cloud as just an IDC 2.0 or CDN provider, the most expensive service would be the database. Are the storage, computing, and networking resources on the public cloud expensive? Strictly speaking, not outrageously so. The cost of hosting and maintaining a physical machine in an IDC is about twenty to thirty units per core·month, while the price of using one CPU core for a month on the public cloud ranges from seventy to two hundred units, considering various discounts and activities, as well as the premium for elasticity, it&rsquo;s barely within an acceptable range.</p>
<p>However, cloud databases are outrageously expensive, with the price for the same computing power per month being several times to over ten times higher than the corresponding hardware. For the cheaper Alibaba Cloud, the price per core·month ranges from two hundred to four hundred units, and for the more expensive AWS, it can reach seven to eight hundred or even more than a thousand.</p>
<p>If you&rsquo;re only using one or two cores of RDS, then it might not be worth the hassle to switch, just consider it a tax. But if your business scales up and you&rsquo;re still not moving away from the cloud, then you&rsquo;re really paying a tax on intelligence.</p>
<hr>
<h2 id="good-enough">Good Enough?</h2>
<blockquote>
<p>Make no mistake, RDS are just mediocre solutions.</p>
</blockquote>
<p>When it comes to the cost of cloud databases/cloud servers, if you manage to bring this up with a sales representative, their pitch usually shifts to: Yes, we are expensive, but we are good!</p>
<p><strong>But, is RDS really that good?</strong></p>
<p>It could be argued that for toy applications, small websites, personal hosting, and self-built databases by those without technical knowledge, RDS might be good enough. However, from the perspective of high-value clients and database experts, RDS is seen as nothing more than a barely passable, communal pot meal.</p>
<p>At its core, the public cloud stems from the operational capabilities that overflowed from major tech companies. People within these companies are well aware of their own technological capabilities, so there’s no need for any undue idolization. (Google might be an exception).</p>
<p><img src="/zh/blog/cloud/rds/rds-4.png"></p>
<p>Take <strong>performance</strong> as an example, where the core metric is <strong>latency/response time</strong>, especially tail latency, which directly impacts user experience: nobody wants to wait several seconds for a screen swipe to register. Here, <strong>disks</strong> play a crucial role.</p>
<p>In our production environment, we use local NVME SSDs, with a typical 4K write latency of 15µs and read latency of 94µs. Consequently, the response time for a simple query on PostgreSQL is usually between 100 ~ 300µs, and the response time on the application side typically ranges from 200 ~ 600µs; for simple queries, our SLO is to achieve within 1ms for hits, and within 10ms for misses, with anything over 10ms considered a slow query that needs optimization.</p>
<p><img src="/zh/blog/cloud/rds/rds-41.png"></p>
<p>AWS&rsquo;s EBS service, when tested with fio, shows disastrously poor performance【6】, with default gp3 read/write latencies at 40ms and io1 at 10ms, a difference of nearly three orders of magnitude. Moreover, the maximum IOPS is only eighty thousand. RDS uses EBS for storage, and if even a single disk access takes 10ms, it’s just not workable. io2 does use the same kind of NVMe SSDs as we do, but remote block storage has double the latency compared to local disks.</p>
<p><img src="/zh/blog/cloud/rds/rds-5.png"></p>
<p>Indeed, sometimes cloud providers do offer sufficiently good local NVMe SSDs, but they cunningly impose various restrictions to prevent users from using EC2 to build their own databases. AWS restricts this by offering NVMe SSD Ephemeral Storage, which is wiped clean upon EC2 restart, rendering it unusable. Alibaba Cloud, on the other hand, sells at exorbitant prices, with <strong>Alibaba Cloud&rsquo;s ESSD PL3 being 200 times more expensive</strong> compared to direct hardware purchases. For a reference, a 3.2TB enterprise-grade PCI-E SSD card, AWS’s rental ratio is one month, while Alibaba Cloud’s is nine days, meaning the cost of renting for this period is equivalent to purchasing the entire disk. If purchasing on Alibaba Cloud with a three-year maximum discount at 50% off, the cost of three years of rent could buy 123 of the same disks, nearly 400TB in total ownership.</p>
<p><strong>Observability is another example where no RDS monitoring can be considered &ldquo;good&rdquo;</strong>. Just looking at the number of monitoring metrics, while knowing whether a service is dead or alive may require only a few metrics, fault root cause analysis benefits from as many monitoring metrics as possible to build a good context. Most RDS services only provide basic monitoring metrics and rudimentary dashboards. For example, Alibaba Cloud RDS PG【7】&rsquo;s so-called &ldquo;enhanced monitoring&rdquo; includes only a few pitiful metrics. AWS and PG database-related metrics are also less than 100, while our own monitoring system includes over 800 types of host metrics, 610 types for PGSQL database, 257 types for REDIS, totaling around three thousand metrics, dwarfing those of RDS.</p>
<p><img src="/zh/blog/cloud/rds/rds-6.png"></p>
<p><img src="/img/pigsty/dashboard.jpg"></p>
<blockquote>
<p>Public <a href="https://demo.pigsty.cc">Demo</a>: <a href="https://demo.pigsty.cc">https://demo.pigsty.cc</a></p>
</blockquote>
<p>As for <strong>reliability</strong>, I used to have basic trust in the reliability of RDS, until the scandal in A Cloud&rsquo;s Hong Kong data center a month ago. The rented data center had a fire suppression incident with water spraying, OSS malfunction, and numerous RDS services became unusable and could not be switched over; then, A Cloud&rsquo;s entire Region&rsquo;s control services crashed due to a single AZ failure, <strong>making a mockery of the idea of remote disaster recovery for cloud databases</strong>.</p>
<p>Of course, this is not to say that self-hosting would not have these issues, but a somewhat reliable IDC hosting would not commit such egregious errors. Security needs no further discussion; recent high-profile incidents, such as the infamous SHGA; hardcoding AK/SK in a bunch of sample codes, is cloud RDS more secure? Don’t make me laugh. At least traditional architecture has a VPN bastion as a layer of protection, while databases exposed on the public network with weak passwords are all too common, undeniably increasing the attack surface.</p>
<p><strong>Another widespread criticism of cloud databases is their extensibility</strong>. RDS does not grant users dbsu permissions, meaning users cannot install extension plugins in the database. PostgreSQL&rsquo;s charm lies in its extensions; without extensions, PostgreSQL is like cola without ice, yogurt without sugar. A more severe issue is that <strong>in some failure scenarios, users even lose the ability to help themselves</strong>, as seen in the real case of &ldquo;<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485093&idx=1&sn=5815f71f1d832101d35a75f5aa4acd3c&chksm=fe4b337ec93cba68fbf30eb0ed50d052c6e8972d42cf506051b5016668f4555edaa0756688dc&scene=21#wechat_redirect">Cloud Database: From Deleting Databases to Running Away</a>&rdquo;: WAL archiving and PITR, basic functionalities, are charged features in RDS. Regarding maintainability, some say cloud databases are convenient as they can be created and destroyed with just a few clicks, but those people have likely never experienced the ordeal of receiving SMS verification codes for restarting each database. <strong>With Database as Code style management tools, true engineers would never resort to such &ldquo;ClickOps&rdquo;</strong>.</p>
<p>However, everything has its rationale for existence, and cloud databases are not entirely without merit. In terms of <strong>scalability</strong>, cloud databases have indeed reached new heights, such as various Serverless offerings, but this is more about saving money and overselling for cloud providers, offering little real benefit to users.</p>
<hr>
<h2 id="the-obsolescence-of-dbas">The Obsolescence of DBAs?</h2>
<blockquote>
<p>Dominated by cloud vendors, hard to hire, and now obsolete?</p>
</blockquote>
<p><strong>Another pitch from cloud databases is that with RDS, you don&rsquo;t need a DBA anymore!</strong></p>
<p>For instance, this infamous article, <a href="https://mp.weixin.qq.com/s/DtRFnh8LgtfesCNMNl3eNw">&ldquo;Why Are You Still Hiring DBAs?&rdquo;</a>, argues: We have autonomous database services! RDS and DAS can solve these database-related issues for you, making DBAs redundant, haha. I believe anyone who seriously reviews these so-called &ldquo;autonomous services&rdquo; or &ldquo;AI4DB&rdquo; official documents will not buy into this nonsense: <strong>Can a module, hardly a decent monitoring system, truly autonomize database management? This is simply a pipe dream.</strong></p>
<p>DBA, Database Administrator, historically also known as database coordinators or database programmers, is a role that spans across development and operations teams, covering responsibilities related to DA, SA, Dev, Ops, and SRE. They manage everything related to data and databases: setting management policies and operational standards, planning hardware and software architecture, coordinating database management, verifying table schema designs, optimizing SQL queries, analyzing execution plans, and even handling emergencies and data recovery.</p>
<p><strong>The first value of a DBA is in security fallback</strong>: <strong>They are the guardians of a company&rsquo;s core data assets and can potentially inflict fatal damage on the company</strong>. There&rsquo;s a joke at Ant Financial that besides regulatory bodies, DBAs could bring Alipay down. Executives often fail to recognize the importance of DBAs until a database incident occurs, and a group of CXOs anxiously watches the DBA firefighting and fixing&hellip; Compared to the cost of avoiding a database failure, such as a nationwide flight halt, Youtube downtime, or a factory&rsquo;s day-long shutdown, hiring a DBA seems trivial.</p>
<p><strong>The second value of a DBA is in model design and optimization</strong>. Many companies do not care if their queries perform poorly, thinking &ldquo;hardware is cheap,&rdquo; and solve problems by throwing money at hardware. However, improperly tuned queries/SQL or poorly designed data models and table structures can degrade performance by orders of magnitude. At some scale, the cost of stacking hardware becomes prohibitively expensive compared to hiring a competent DBA. Frankly, <strong>I believe the largest IT expenditure in most companies is due to developers not using databases correctly</strong>.</p>
<p><strong>A DBA&rsquo;s basic skill is managing DBs, but their essence lies in Administration</strong>: managing the entropy created by developers requires more than just technical skills. &ldquo;Autonomous databases&rdquo; might help analyze loads and create indexes, but they cannot understand business needs or push for table structure optimization, and this is something unlikely to be replaced by cloud services in the next two to three decades.</p>
<p>Whether it&rsquo;s public cloud vendors, cloud-native/private clouds represented by Kubernetes, or local open-source RDS alternatives like Pigsty, <strong>their core value is to use software as much as possible, not manpower, to deal with system complexity</strong>. So, <strong>will cloud software revolutionize operations and DBA roles</strong>?</p>
<p><strong>Cloud is not a maintenance-free outsourcing magic</strong>. According to the law of complexity conservation, the only way for the roles of system administrators or database administrators to disappear is for them to be rebranded as &ldquo;DevOps Engineers&rdquo; or SREs. <strong>Good cloud software can shield you from mundane operational tasks and solve 70% of routine issues, but there will always be complex problems that only humans can handle</strong>. You might need fewer people to manage these cloud services, but you still need people【12】. After all, <strong>you need knowledgeable individuals to coordinate and manage, so you don&rsquo;t get exploited by cloud vendors</strong>.</p>
<p><strong>In large organizations, a good DBA is crucial</strong>. However, excellent DBAs are quite rare and in high demand, leading to this role being outsourced in most organizations: either to professional database service companies or to cloud database RDS service teams. Organizations unable to find DBA providers must internally assign this responsibility to their development/operations staff, until the company grows large enough or suffers enough setbacks for some Dev/Ops to develop the necessary skills.</p>
<p><strong>DBAs won&rsquo;t become obsolete; they will just be monopolized by cloud vendors to provide services.</strong></p>
<hr>
<h2 id="the-shadow-of-monopoly">The Shadow of Monopoly</h2>
<blockquote>
<p>In 2020, the adversary of computing freedom was cloud computing software.</p>
</blockquote>
<p><strong>Beyond the &ldquo;obsolescence of DBAs,&rdquo; the emergence of the cloud harbors a larger threat</strong>. We should be concerned about a scenario where public clouds (or &ldquo;Fruit Clouds&rdquo;) grow dominant, controlling both hardware and operators up and down the stream, monopolizing computation, storage, networking, and top-tier expert resources to become the de facto standards. If all top-tier DBAs are poached by cloud vendors to provide centralized shared expert services, ordinary business organizations will completely lose the capability to utilize databases effectively, eventually left with no choice but to be &ldquo;taxed&rdquo; by public clouds. Ultimately, all IT resources would be concentrated in the hands of cloud vendors, who, by controlling a critical few, could control the entire internet. This is undeniably contrary to the original intent behind the creation of the internet.</p>
<p>Let me reference Martin Kelppmann:</p>
<p><strong>In the 2020s, the enemy of freedom in computing is cloud software</strong></p>
<blockquote>
<p>i.e. software that runs primarily on the vendor’s servers, with all your data also stored on those servers. This cloud software may have a client-side component (a mobile app, or the JavaScript running in your web browser), but it only works in conjunction with the vendor’s server. And there are lots of problems with cloud software:</p>
<ul>
<li>If the company providing the cloud software goes out of business or decides to discontinue a product, the software stops working, and you are locked out of the documents and data you created with that software. This is an especially common problem with software made by a startup, which may get acquired by a bigger company that has no interest in continuing to maintain the startup’s product.</li>
<li>Google and other cloud services may suddenly suspend your account with no warning and no recourse, for example if an automated system thinks you have violated its terms of service. Even if your own behaviour has been faultless, someone else may have hacked into your account and used it to send malware or phishing emails without your knowledge, triggering a terms of service violation. Thus, you could suddenly find yourself permanently locked out of every document you ever created on Google Docs or another app.</li>
<li>With software that runs on your own computer, even if the software vendor goes bust, you can continue running it forever (in a VM/emulator if it’s no longer compatible with your OS, and assuming it doesn’t need to contact a server to check for a license check). For example, the Internet Archive has a collection of over 100,000 historical software titles that you can run in an emulator inside your web browser! In contrast, if cloud software gets shut down, there is no way for you to preserve it, because you never had a copy of the server-side software, neither as source code nor in compiled form.</li>
<li>The 1990s problem of not being able to customise or extend software you use is aggravated further in cloud software. With closed-source software that runs on your own computer, at least someone could reverse-engineer the file format it uses to store its data, so that you could load it into alternative software (think pre-OOXML Microsoft Office file formats, or Photoshop files before the spec was published). With cloud software, not even that is possible, since the data is only stored in the cloud, not in files on your own computer.</li>
</ul>
<p>If all software was free and open source, these problems would all be solved. However, making the source code available is not actually necessary to solve the problems with cloud software; even closed-source software avoids the aforementioned problems, as long as it is running on your own computer rather than the vendor’s cloud server. Note that the Internet Archive is able to keep historical software working without ever having its source code: for purposes of preservation, running the compiled machine code in an emulator is just fine. Maybe having the source code would make it a little easier, but it’s not crucial. The important thing is having a copy of the software at all.</p>
<p>My collaborators and I have previously argued for <strong>local-first software</strong>, which is a response to these problems with cloud software. Local-first software runs on your own computer, and stores its data on your local hard drive, while also retaining the convenience of cloud software, such as real-time collaboration and syncing your data across all of your devices. It is nice for local-first software to also be open source, but this is not necessary: 90% of its benefits apply equally to closed-source local-first software.</p>
<p>Cloud software, not closed-source software, is the real threat to software freedom, because the harm from being suddenly locked out of all of your data at the whim of a cloud provider is much greater than the harm from not being able to view and modify the source code of your software. For that reason, it is much more important and pressing that we make local-first software ubiquitous. If, in that process, we can also make more software open-source, then that would be nice, but that is less critical. Focus on the biggest and most urgent challenges first.</p>
</blockquote>
<p>However, where there is action, there is reaction; local-first software began to emerge as a countermeasure to cloud software. For instance, the Cloud Native movement, represented by Kubernetes, is a prime example. &ldquo;Cloud Native,&rdquo; as interpreted by cloud vendors, means &ldquo;software that is natively developed in a public cloud environment&rdquo;; but its real significance should be &ldquo;local,&rdquo; as in the opposite of &ldquo;Cloud&rdquo; — &ldquo;Local&rdquo; cloud / private cloud / proprietary cloud / native cloud, the name doesn&rsquo;t matter. What matters is that it can run anywhere the user desires (including on cloud servers), not just exclusively in public clouds!</p>
<p>Open-source projects, like Kubernetes, have democratized resource scheduling/smart operations capabilities previously unique to public clouds, enabling enterprises to run &lsquo;cloud&rsquo;-like capabilities locally. For stateless applications, it already serves as a sufficiently robust &ldquo;cloud operating system&rdquo; kernel. Open-source alternatives like Ceph/Minio offer S3 object storage solutions, leaving only one question unanswered: how to manage and deploy stateful, production-grade database services?</p>
<p>The era is calling for an open-source alternative to RDS.</p>
<hr>
<h2 id="answer--solution">Answer &amp; Solution</h2>
<blockquote>
<p>Pigsty —— Battery-Included, Local-First <strong>PostgreSQL</strong> Distribution as an Open-Source <strong>RDS</strong> Alternative</p>
</blockquote>
<p>I envision a future where everyone has the factual right to freely use superior services, not confined within the pens (Pigsty) provided by a few public cloud vendors, feeding on subpar offerings. This is why I created Pigsty — <strong>a better, open-source, free alternative to PostgreSQL RDS</strong>. It enables users to launch a database service better than cloud RDS with just one click, anywhere (including on cloud servers).</p>
<p>Pigsty is a comprehensive complement to PostgreSQL, <strong>and a spicy critique of cloud databases</strong>. Its name signifies &ldquo;pigpen,&rdquo; but it also stands for Postgres In Great STYle, symbolizing PostgreSQL at its peak. It is a solution distilled from best practices in managing and using PostgreSQL, entirely based on open source software and capable of running anywhere. Born from real-world, high-standard PostgreSQL clusters, it was developed to fulfill the database management needs of Tantan, performing valuable work across eight dimensions:</p>
<p><img src="/zh/blog/cloud/rds/rds-7.png"></p>
<p><strong>Observability is akin to heaven; as heaven maintains vigor through movement, a gentleman should constantly strive for self-improvement</strong>; Pigsty utilizes a modern observability tech stack to create an unparalleled monitoring system for PostgreSQL, offering a comprehensive overview from global dashboards to granular historical metrics for individual tables/indexes/functions, enabling users to see through the system and control everything. Additionally, Pigsty&rsquo;s monitoring system can operate independently to monitor third-party database instances.</p>
<p><strong>Controllability is akin to earth; as earth&rsquo;s nature is broad and bearing, a gentleman should carry the world with broad virtue</strong>; Pigsty provides Database as Code capabilities: describing the state of database clusters through expressive declarative interfaces and employing idempotent scripts for deployment and adjustments. This allows users to customize finely without worrying about implementation details, freeing their mental capacity and lowering the barrier from expert to novice level in database operations and management.</p>
<p><strong>Scalability is like water; as water flows and encompasses all, a gentleman should maintain virtue consistently</strong>; Pigsty offers pre-configured tuning templates (OLTP / OLAP / CRIT / TINY), automatically optimizes system parameters, and can infinitely scale read capabilities through cascading replication. It also utilizes Pgbouncer for connection pool optimization to handle massive concurrent connections; Pigsty ensures PostgreSQL&rsquo;s performance is maximized under modern hardware conditions: achieving tens of thousands of concurrent connections, million-level single-point query QPS, and hundred thousand-level single transaction TPS.</p>
<p><strong>Maintainability is like fire; as fire illuminates, a great person should illuminate the surroundings</strong>; Pigsty allows for online instance addition or removal for scaling, Switchover/rolling upgrades for scaling up or down, and offers a downtime-free migration solution based on logical replication, minimizing maintenance windows to sub-second levels, thus enhancing the system&rsquo;s evolvability, availability, and maintainability to a new standard.</p>
<p><strong>Security is like thunder; as thunder signifies awe, a gentleman should reflect and be cautious</strong>; Pigsty offers an access control model following the principle of least privilege, along with various security features: synchronous commit for replication to prevent data loss, data directory checksums to prevent corruption, SSL encryption for network traffic to prevent eavesdropping, and AES-256 for remote backups to prevent data leaks. As long as physical hardware and passwords are secure, users need not worry about database security.</p>
<p><strong>Simplicity is like wind; as wind follows its path, a gentleman should decree and act accordingly</strong>; Using Pigsty is no more difficult than any cloud database. It aims to deliver complete RDS functionality with the least complexity, allowing users to choose and combine modules as needed. Pigsty offers a Vagrant-based local development testing sandbox and Terraform cloud IaC for one-click deployment templates, enabling offline installation on any new EL node and complete environment replication.</p>
<p><strong>Reliability is like a mountain; as a mountain stands firm, a gentleman should be steadfast in thought</strong>; Pigsty provides a high-availability architecture with self-healing capabilities to address hardware issues and offers out-of-the-box PITR for recovery from accidental data deletion and software flaws, verified through long-term, large-scale production environment operation and high-availability drills.</p>
<p><strong>Extensibility is like a lake; as a lake reflects beauty, a gentleman should discuss and practice with friends</strong>; Pigsty deeply integrates core PostgreSQL ecosystem extensions like PostGIS, TimescaleDB, Citus, PGVector, and numerous extension plugins. It offers a modular design of the Prometheus/Grafana observability tech stack, and high-availability deployment of MINIO, ETCD, Redis, Greenplum, etc., in combination with PostgreSQL.</p>
<p><img src="/zh/blog/cloud/rds/rds-8.png"></p>
<p><strong>More importantly, Pigsty is entirely open-source and free software</strong>, licensed under AGPL v3.0. Powered by passion, you can run a fully functional, even superior RDS service at the cost of mere hardware expenses per month. Whether you are a beginner or a seasoned DBA, managing a massive cluster or a small setup, whether you&rsquo;re already using RDS or have set up databases locally, if you are a PostgreSQL user, Pigsty will be beneficial to you, completely free. <strong>You can focus on the most interesting or valuable parts of your business and leave the routine tasks to the software</strong>.</p>
<p><img src="/zh/blog/cloud/rds/rds-9.png"></p>
<blockquote>
<p>RDS Cost and Scale Cost Curve</p>
</blockquote>
<p>Pigsty allows you to practice the ultimate FinOps principle — running production-level PostgreSQL RDS database services anywhere (ECS, resource cloud, data center servers, even local notebook virtual machines) at prices close to pure resource costs. <strong>Turning the cost capability of cloud databases from being proportional to marginal resource costs to virtually zero fixed learning costs</strong>.</p>
<p><strong>If you can use a better RDS service at a fraction of the cost, then continuing to use cloud databases is truly just a tax on your intellect.</strong></p>
<hr>
<h2 id="reference">Reference</h2>
<p>【1】<a href="https://world.hey.com/dhh/why-we-re-leaving-the-cloud-654b47e0">Why we&rsquo;re leaving the cloud</a></p>
<p>【2】<a href="https://www.infoq.cn/article/qoq3v6jfenwwzmpg4fre">上云“被坑”十年终放弃，寒冬里第一轮“下云潮”要来了？</a></p>
<p>【3】<a href="https://rdsbuy.console.aliyun.com/create/rds/PostgreSQL">Aliyun RDS for PostgreSQL Pricing</a></p>
<p>【4】<a href="https://calculator.aws/#/addService/RDSPostgreSQL">AWS Pricing Calculator</a></p>
<p>【5】 <a href="https://calculator.amazonaws.cn/#/?trk=pricing-ban">AWS Pricing Calculator</a> (China NingXia)</p>

</div>





    
	
  

    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-772bd97e44fff7931858afc924365181">Postgres</h1>
	<div class="lead">Posts about Pigsty and PostgreSQL</div>
	<div class="td-byline mb-4">
		
        
	</div>
	
</div>





    
      
  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-cc0f3b60839047690e18daaf6e1b2eb0">Pig, The Postgres Extension Wizard</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com">RuohangFeng</a>(<a href="https://vonng.com/en/">@Vonng</a>)| <a href="https://mp.weixin.qq.com/s/8zxeDQ7p5tPNGYED_1Bugg">WeChat</a></b> |
        
		<time datetime="2024-12-29" class="text-muted">2024-12-29</time>
        
	</div>
	<h2 id="title-meet-pig-the-postgres-extension-wizard"><strong>Title</strong>: Meet <em>Pig</em>: The Postgres Extension Wizard</h2>
<p>Ever wished installing or upgrading PostgreSQL extensions didn’t feel like digging through outdated readmes, cryptic configure scripts, or random GitHub forks &amp; patches? The painful truth is that Postgres’s richness of extension often comes at the cost of complicated setups—especially if you’re juggling multiple distros or CPU architectures.</p>
<p>Enter <strong>Pig</strong>, a Go-based package manager built to tame Postgres and its ecosystem of <a href="https://ext.pigsty.io/#/list">340+</a> extensions in one fell swoop. TimescaleDB, Citus, PGVector, 20+ Rust extensions, plus every must-have piece to <a href="https://pigsty.io/blog/db/supabase">self-host</a> Supabase — Pig’s unified CLI makes them all effortlessly accessible. It cuts out messy source builds and half-baked repos, offering version-aligned RPM/DEB packages that work seamlessly across Debian, Ubuntu, and RedHat flavors. No guesswork, no drama.</p>
<p>Instead of reinventing the wheel, Pig piggyback your system’s native package manager (APT, YUM, DNF) and follow official PGDG packaging conventions to ensure a glitch-free fit. That means you don’t have to choose between “the right way” and “the quick way”; Pig respects your existing repos, aligns with standard OS best practices, and fits neatly alongside other packages you already use.</p>
<p>Ready to give your Postgres superpowers without the usual hassle? Check out <strong><a href="https://github.com/pgsty/pig">GitHub</a></strong> for documentation, installation steps, and a peek at its massive <a href="https://ext.pigsty.io/#/list">extension list</a>. Then, watch your local Postgres instance transform into a powerhouse of specialized modules—no black magic is required. If <a href="https://medium.com/@fengruohang/postgres-is-eating-the-database-world-157c204dcfc4">the future of Postgres is unstoppable extensibility</a>, Pig is the genie that helps you unlock it. Honestly, nobody ever complained that they had <em>too many</em> extensions.</p>
<p><a href="https://github.com/pgsty/pig">PIG v0.1 Release</a> | <a href="https://github.com/pgsty/pig">GitHub Repo</a> | Blog: <a href="https://medium.com/@fengruohang/the-idea-way-to-deliver-postgresql-extensions-35646464bb71">The Idea Way to deliver PG Extensions</a></p>
<hr>
<h2 id="get-started">Get Started</h2>
<p><a href="/blog/pg/pig/#installation">Install</a> the <code>pig</code> package itself with scripts or the traditional yum/apt way.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL https://repo.pigsty.io/pig <span style="color:#000;font-weight:bold">|</span> bash
</span></span></code></pre></div><p>Then it&rsquo;s ready to use; assume you want to install the <a href="https://ext.pigsty.io/#/pg_duckdb"><code>pg_duckdb</code></a> extension:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ pig repo add pigsty pgdg -u  <span style="color:#8f5902;font-style:italic"># add pgdg &amp; pigsty repo, update cache</span>
</span></span><span style="display:flex;"><span>$ pig repo <span style="color:#204a87">set</span> -u              <span style="color:#8f5902;font-style:italic"># overwrite all existing repos, brute but effective</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ pig ext install pg17         <span style="color:#8f5902;font-style:italic"># install native PGDG PostgreSQL 17 kernels packages</span>
</span></span><span style="display:flex;"><span>$ pig ext install pg_duckdb    <span style="color:#8f5902;font-style:italic"># install the pg_duckdb extension (for current pg17)</span>
</span></span></code></pre></div><h3 id="extension-management"><strong>Extension Management</strong></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pig ext list    <span style="color:#ce5c00;font-weight:bold">[</span>query<span style="color:#ce5c00;font-weight:bold">]</span>      <span style="color:#8f5902;font-style:italic"># list &amp; search extension      </span>
</span></span><span style="display:flex;"><span>pig ext info    <span style="color:#ce5c00;font-weight:bold">[</span>ext...<span style="color:#ce5c00;font-weight:bold">]</span>     <span style="color:#8f5902;font-style:italic"># get information of a specific extension</span>
</span></span><span style="display:flex;"><span>pig ext status  <span style="color:#ce5c00;font-weight:bold">[</span>-v<span style="color:#ce5c00;font-weight:bold">]</span>         <span style="color:#8f5902;font-style:italic"># show installed extension and pg status</span>
</span></span><span style="display:flex;"><span>pig ext add     <span style="color:#ce5c00;font-weight:bold">[</span>ext...<span style="color:#ce5c00;font-weight:bold">]</span>     <span style="color:#8f5902;font-style:italic"># install extension for current pg version</span>
</span></span><span style="display:flex;"><span>pig ext rm      <span style="color:#ce5c00;font-weight:bold">[</span>ext...<span style="color:#ce5c00;font-weight:bold">]</span>     <span style="color:#8f5902;font-style:italic"># remove extension for current pg version</span>
</span></span><span style="display:flex;"><span>pig ext update  <span style="color:#ce5c00;font-weight:bold">[</span>ext...<span style="color:#ce5c00;font-weight:bold">]</span>     <span style="color:#8f5902;font-style:italic"># update extension to the latest version</span>
</span></span><span style="display:flex;"><span>pig ext import  <span style="color:#ce5c00;font-weight:bold">[</span>ext...<span style="color:#ce5c00;font-weight:bold">]</span>     <span style="color:#8f5902;font-style:italic"># download extension to local repo</span>
</span></span><span style="display:flex;"><span>pig ext link    <span style="color:#ce5c00;font-weight:bold">[</span>ext...<span style="color:#ce5c00;font-weight:bold">]</span>     <span style="color:#8f5902;font-style:italic"># link postgres installation to path</span>
</span></span><span style="display:flex;"><span>pig ext build   <span style="color:#ce5c00;font-weight:bold">[</span>ext...<span style="color:#ce5c00;font-weight:bold">]</span>     <span style="color:#8f5902;font-style:italic"># setup building env for extension</span>
</span></span></code></pre></div><h3 id="repo-management"><strong>Repo Management</strong></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pig repo list                    <span style="color:#8f5902;font-style:italic"># available repo list             (info)</span>
</span></span><span style="display:flex;"><span>pig repo info   <span style="color:#ce5c00;font-weight:bold">[</span>repo<span style="color:#000;font-weight:bold">|</span>module...<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#8f5902;font-style:italic"># show repo info                  (info)</span>
</span></span><span style="display:flex;"><span>pig repo status                  <span style="color:#8f5902;font-style:italic"># show current repo status        (info)</span>
</span></span><span style="display:flex;"><span>pig repo add    <span style="color:#ce5c00;font-weight:bold">[</span>repo<span style="color:#000;font-weight:bold">|</span>module...<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#8f5902;font-style:italic"># add repo and modules            (root)</span>
</span></span><span style="display:flex;"><span>pig repo rm     <span style="color:#ce5c00;font-weight:bold">[</span>repo<span style="color:#000;font-weight:bold">|</span>module...<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#8f5902;font-style:italic"># remove repo &amp; modules           (root)</span>
</span></span><span style="display:flex;"><span>pig repo update                  <span style="color:#8f5902;font-style:italic"># update repo pkg cache           (root)</span>
</span></span><span style="display:flex;"><span>pig repo create                  <span style="color:#8f5902;font-style:italic"># create repo on current system   (root)</span>
</span></span><span style="display:flex;"><span>pig repo boot                    <span style="color:#8f5902;font-style:italic"># boot repo from offline package  (root)</span>
</span></span><span style="display:flex;"><span>pig repo cache                   <span style="color:#8f5902;font-style:italic"># cache repo as offline package   (root)</span>
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7f5a0de014a67abd29c62899ad7fa900">The idea way to install PostgreSQL Extensions</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com">Vonng</a>(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2024-11-02" class="text-muted">2024-11-02</time>
        
	</div>
	<p><a href="/blog/pg/pg-eat-db-world/"><strong>PostgreSQL Is Eating the Database World</strong></a> through the power of <strong>extensibility</strong>.
With <strong>340</strong> extensions powering PostgreSQL, we may not say it&rsquo;s invincible, but it’s definitely getting much closer.</p>
<p>I believe the PostgreSQL community has reached a consensus on the importance of extensions.
So the real question now becomes: <strong>&ldquo;What should we do about it?&rdquo;</strong></p>
<p>What&rsquo;s the primary problem with PostgreSQL extensions? In my opinion, it’s their <strong>accessibility</strong>.
Extensions are useless if most users can’t easily install and enable them. But it&rsquo;s not that easy.</p>
<p>Even the largest cloud postgres vendors are struggling with this.
They have some inherent limitations (multi-tenancy, security, licensing) that make it hard for them to fully address this issue.</p>
<p>So here&rsquo;s my plan, I&rsquo;ve created a <a href="https://ext.pigsty.io/"><strong>repository</strong></a> that hosts <a href="https://ext.pigsty.io/#/list"><strong>340</strong></a> of the most capable extensions in the PostgreSQL ecosystem,
available as RPM / DEB packages on mainstream Linux OS distros.  And the goal is to take PostgreSQL one solid step closer to becoming the all-powerful database and achieve <strong>the great alignment</strong> between the Debian and EL OS ecosystems.</p>
<blockquote>
<p><a href="/blog/pg/pg-ext-repo/#apt-repo"><strong>TL;DR: Take me to the HOW-TO part!</strong></a></p>
</blockquote>
<p><a href="/blog/pg/pg-eat-deb-world"><img src="/img/pigsty/ecosystem.jpg" style="max-width: 800px; max-height: 1000px; width: 100%; height: auto;"></a></p>
<hr>
<h2 id="the-status-quo">The status quo</h2>
<p>The PostgreSQL ecosystem is rich with extensions, but how do you actually install and use them? This initial hurdle becomes a roadblock for many. There are some existing solutions:</p>
<p>PGXN says, &ldquo;<em>You can download and compile extensions on the fly with <code>pgxnclient</code>.</em>&rdquo;
Tembo says, &ldquo;<em>We have prepared pre-configured extension stack as Docker images.</em>&rdquo;
StackGres &amp; Omnigres says, &ldquo;<em>We download <code>.so</code> files on the fly.</em>&rdquo; All solid ideas.</p>
<p>While based on my experience, the vast majority of users still rely on their operating system&rsquo;s package manager to install PG extensions.
On-the-fly compilation and downloading shared libraries might not be a viable option for production env. Since many DB setups don’t have internet access or a proper toolchain ready.</p>
<p>In the meantime, Existing OS package managers like <code>yum</code>/<code>dnf</code>/<code>apt</code> already solve issues like dependency resolution, upgrades, and version management well.
There&rsquo;s no need to reinvent the wheel or disrupt existing standards. So the real question is: Who&rsquo;s going to package these extensions into ready-to-use software?</p>
<p>PGDG has already made a fantastic effort with official <a href="https://download.postgresql.org/pub/repos/yum/">YUM</a> and <a href="http://apt.postgresql.org/pub/repos/apt/">APT</a> repositories.
In addition to the <strong>70</strong> built-in <a href="https://ext.pigsty.io/#/contrib">Contrib</a> extensions bundled with PostgreSQL,the PGDG YUM repo offers <strong>128</strong> RPM extensions, while the APT repo offers <strong>104</strong> DEB extensions.
These extensions are compiled and packaged in the same environment as the PostgreSQL kernel, making them easy to install alongside the PostgreSQL binary packages.
In fact, even most PostgreSQL Docker images rely on the PGDG repo to install extensions.</p>
<p>I’m deeply grateful for Devrim&rsquo;s maintenance of the PGDG YUM repo and Christoph&rsquo;s work with the APT repo. Their efforts to make PostgreSQL installation and extension management seamless are incredibly valuable.
But as a distribution creator myself, I’ve encountered some challenges with PostgreSQL extension distribution.</p>
<hr>
<h2 id="whats-the-challenge">What&rsquo;s the challenge?</h2>
<p>The first major issue facing extension users is <strong>Alignment</strong>.</p>
<p>In the two primary Linux distro camps — Debian and EL — there’s a significant number of PostgreSQL extensions.
Excluding the <strong>70</strong> built-in Contrib extensions bundled with PostgreSQL, the YUM repo offers <strong>128</strong> extensions, and the APT repo provides <strong>104</strong>.</p>
<p>However, when we dig deeper, we see that alignment between the two repos is not ideal.
The combined total of extensions across both repos is <strong>153</strong>, but the overlap is just <strong>79</strong>. That means <strong>only half</strong> of the extensions are available in both ecosystems!</p>
<p><a href="pgdg-ext.png"><img src="pgdg-ext.png" style="max-width: 1000px; max-height: 1000px; width: 100%; height: auto;"></a></p>
<blockquote>
<p>Only half of the extensions are available in both EL and Debian ecosystems!</p>
</blockquote>
<p>Next, we run into further alignment issues within each ecosystem itself. The availability of extensions can vary between different major OS versions.
For instance, <code>pljava</code>, <code>sequential_uuids</code>, and <code>firebird_fdw</code> are only available in EL9, but not in EL8. Similarly, <code>rdkit</code> is available in Ubuntu 22+ / Debian 12+, but not in Ubuntu 20 / Debian 11.
There’s also the issue of architecture support. For example, <code>citus</code> does not provide <code>arm64</code> packages in the Debian repo.</p>
<p>And then we have alignment issues across different PostgreSQL major versions. Some extensions won’t compile on older PostgreSQL versions, while others won’t work on newer ones.
Some extensions are only available for specific PostgreSQL versions in certain distributions, and so on.</p>
<p>These alignment issues lead to a significant number of permutations. For example, if we consider five mainstream OS distributions (el8, el9, debian12, ubuntu22, ubuntu24),
two CPU architectures (<code>x86_64</code> and <code>arm64</code>), and six PostgreSQL major versions (12–17), that’s <strong>60-70</strong> RPM/DEB packages per extension—just for one extension!</p>
<p>On top of alignment, there’s the problem of <strong>completeness</strong>. PGXN lists over <strong>375</strong> extensions, but the PostgreSQL ecosystem could have as many as <a href="https://gist.github.com/joelonsql/e5aa27f8cc9bd22b8999b7de8aee9d47"><strong>1,000+</strong></a>. The PGDG repos, however, contain only about <strong>one-tenth</strong> of them.</p>
<p>There are also several powerful new Rust-based extensions that PGDG doesn’t include, such as <code>pg_graphql</code>, <code>pg_jsonschema</code>, and <code>wrappers</code> for <a href="/">self-hosting Supabase</a>;
<code>pg_search</code> as an Elasticsearch alternative; and <code>pg_analytics</code>, <code>pg_parquet</code>, <code>pg_mooncake</code> for OLAP processing. The reason? They are too slow to compile&hellip;</p>
<hr>
<h2 id="whats-the-solution">What&rsquo;s the solution?</h2>
<p>Over the past six months, I’ve focused on consolidating the PostgreSQL extension ecosystem.
Recently, I reached a milestone I’m quite happy with. I’ve created a PG YUM/APT repository with a catalog of <strong>340</strong>available PostgreSQL extensions.</p>
<p>Here are some key stats for the repo: It hosts <strong>340</strong> extensions in total. Excluding the <strong>70</strong> built-in extensions that come with PostgreSQL, this leaves <strong>270</strong> third-party extensions.
Of these, about half are maintained by the official PGDG repos (<strong>126</strong> RPM, <strong>102</strong> DEB). The other half (<strong>131</strong> RPM, <strong>143</strong>DEB) are maintained, fixed, compiled, packaged, and distributed by myself.</p>
<table>
<thead>
<tr>
<th style="text-align:center">OS \ Entry</th>
<th style="text-align:center">All</th>
<th style="text-align:center">PGDG</th>
<th style="text-align:center">PIGSTY</th>
<th style="text-align:center">CONTRIB</th>
<th style="text-align:center">MISC</th>
<th style="text-align:center">MISS</th>
<th style="text-align:center">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://ext.pigsty.io/#/rpm"><strong>RPM</strong></a></td>
<td style="text-align:center">334</td>
<td style="text-align:center">115</td>
<td style="text-align:center">143</td>
<td style="text-align:center">70</td>
<td style="text-align:center">4</td>
<td style="text-align:center">6</td>
<td style="text-align:center">301</td>
<td style="text-align:center">330</td>
<td style="text-align:center">333</td>
<td style="text-align:center">319</td>
<td style="text-align:center">307</td>
<td style="text-align:center">294</td>
</tr>
<tr>
<td style="text-align:center"><a href="https://ext.pigsty.io/#/deb"><strong>DEB</strong></a></td>
<td style="text-align:center">326</td>
<td style="text-align:center">104</td>
<td style="text-align:center">144</td>
<td style="text-align:center">70</td>
<td style="text-align:center">4</td>
<td style="text-align:center">14</td>
<td style="text-align:center">302</td>
<td style="text-align:center">322</td>
<td style="text-align:center">325</td>
<td style="text-align:center">316</td>
<td style="text-align:center">303</td>
<td style="text-align:center">293</td>
</tr>
</tbody>
</table>
<p>For each extension, I’ve built versions for the <strong>6</strong> major PostgreSQL versions (12–17) across five popular Linux distributions: EL8, EL9, Ubuntu 22.04, Ubuntu 24.04, and Debian 12.
I’ve also provided some limited support for older OS versions like EL7, Debian 11, and Ubuntu 20.04.</p>
<p>This repository also addresses most of the <strong>alignment</strong> issue. Initially, there were extensions in the APT and YUM repos that were unique to each, but I’ve worked to port as many of these unique extensions to the other ecosystem.
Now, only <strong>7</strong> APT extensions are missing from the YUM repo, and <strong>16</strong> extensions are missing in APT—just <strong>6%</strong> of the total. Many missing PGDG extensions have also been resolved.</p>
<p><a href="pigsty-ext.png"><img src="pigsty-ext.png" style="max-width: 1000px; max-height: 1000px; width: 100%; height: auto;"></a></p>
<p>I’ve created a comprehensive directory listing all supported extensions, with detailed info, dependency installation instructions, and other important notes.</p>
<p><a href="citus.png"><img src="citus.png" style="max-width: 800px; max-height: 1000px; width: 100%; height: auto;"></a></p>
<p>I hope this repository can serve as the ultimate solution to the frustration users face when extensions are difficult to find, compile, or install.</p>
<hr>
<h2 id="how-to-use-this-repo">How to use this repo?</h2>
<p>Now, for a quick plug — what’s the easiest way to install and use these extensions?</p>
<p>The simplest option is to use the OSS PostgreSQL distribution: <a href="https://ext.pigsty.io/"><strong>Pigsty</strong></a>.
The repo is autoconfigured by default, so all you need to do is declare them in the <a href="/docs/setup/config/">config inventory</a>.</p>
<p>For example,  the <a href="/docs/db/supabase">self-hosting supabase</a> template requires extensions that aren’t available in the PGDG repo.
You can simply  <a href="/docs/pgext/usage/download/">download</a>, <a href="/docs/pgext/usage/install/">install</a>, <a href="/docs/pgext/usage/load/">preload</a>, <a href="/docs/pgext/usage/config">config</a> and <a href="/docs/pgext/usage/create/">create</a> extensions by referring to their names.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">all</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">children</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg-meta</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">primary } }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-meta</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># INSTALL EXTENSIONS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">supabase  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># essential extensions for supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">timescaledb postgis pg_graphql pg_jsonschema wrappers pg_search pg_analytics pg_parquet plv8 duckdb_fdw pg_cron pg_timetable pgqr</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">supautils pg_plan_filter passwordcheck plpgsql_check pgaudit pgsodium pg_vault pgjwt pg_ecdsa pg_session_jwt index_advisor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">pgvector pgvectorscale pg_summarize pg_tiktoken pg_tle pg_stat_monitor hypopg pg_hint_plan pg_http pg_net pg_smtp_client pg_idkit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># LOAD EXTENSIONS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_libs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;pg_stat_statements, plpgsql, plpgsql_check, pg_cron, pg_net, timescaledb, auto_explain, pg_tle, plan_filter&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># CONFIG EXTENSIONS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">cron.database_name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">pgsodium.enable_event_trigger</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">off</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># CREATE EXTENSIONS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">baseline</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase.sql</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">extensions ,auth ,realtime ,storage ,graphql_public ,supabase_functions ,_analytics ,_realtime ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgcrypto  ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">extensions  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pg_net    ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">extensions  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: pgjwt     ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">extensions  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: uuid-ossp ,schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">extensions  }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgsodium        }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">supabase_vault  }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_graphql      }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_jsonschema   }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">wrappers        }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http            }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_cron         }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">timescaledb     }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_tle          }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">vector          }               </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">17</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># DOWNLOAD EXTENSIONS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repo_extra_packages</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">pgsql-main</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">supabase  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># essential extensions for supabase</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">timescaledb postgis pg_graphql pg_jsonschema wrappers pg_search pg_analytics pg_parquet plv8 duckdb_fdw pg_cron pg_timetable pgqr</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">supautils pg_plan_filter passwordcheck plpgsql_check pgaudit pgsodium pg_vault pgjwt pg_ecdsa pg_session_jwt index_advisor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">pgvector pgvectorscale pg_summarize pg_tiktoken pg_tle pg_stat_monitor hypopg pg_hint_plan pg_http pg_net pg_smtp_client pg_idkit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>To simply add extensions to existing clusters:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./infra.yml -t repo_build -e <span style="color:#4e9a06">&#39;{&#34;repo_packages&#34;:[citus]}&#39;</span>         <span style="color:#8f5902;font-style:italic"># download</span>
</span></span><span style="display:flex;"><span>./pgsql.yml -t pg_extension -e <span style="color:#4e9a06">&#39;{&#34;pg_extensions&#34;: [&#34;citus&#34;]}&#39;</span>    <span style="color:#8f5902;font-style:italic"># install</span>
</span></span></code></pre></div><p>Through this repo was meant to be used with Pigsty, But it is <strong>not mandatory</strong>. You can still enable this repository on any EL/Debian/Ubuntu system with a simple one-liner in the shell:</p>
<h3 id="apt-repo">APT Repo</h3>
<p><a href="https://pigsty.io/docs/node"><img alt="Linux" src="https://img.shields.io/badge/Linux-x86_64-%23FCC624?style=flat&logo=linux&labelColor=FCC624&logoColor=black"></a>
<a href="https://pigsty.io/docs/pgext/list/deb/"><img alt="Ubuntu Support: 24" src="https://img.shields.io/badge/Ubuntu-24/noble-%23E95420?style=flat&logo=ubuntu&logoColor=%23E95420"></a>
<a href="https://pigsty.io/docs/pgext/list/deb/"><img alt="Ubuntu Support: 22" src="https://img.shields.io/badge/Ubuntu-22/jammy-%23E95420?style=flat&logo=ubuntu&logoColor=%23E95420"></a>
<a href="https://pigsty.io/docs/reference/compatibility/"><img alt="Debian Support: 12" src="https://img.shields.io/badge/Debian-12/bookworm-%23A81D33?style=flat&logo=debian&logoColor=%23A81D33"></a></p>
<p>For Ubuntu 22.04 &amp; Debian 12 or any compatible platforms, use the following commands to add the APT repo:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL https://repo.pigsty.io/key <span style="color:#000;font-weight:bold">|</span> sudo gpg --dearmor -o /etc/apt/keyrings/pigsty.gpg
</span></span><span style="display:flex;"><span>sudo tee /etc/apt/sources.list.d/pigsty-io.list &gt; /dev/null <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">deb [signed-by=/etc/apt/keyrings/pigsty.gpg] https://repo.pigsty.io/apt/infra generic main 
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">deb [signed-by=/etc/apt/keyrings/pigsty.gpg] https://repo.pigsty.io/apt/pgsql/$(lsb_release -cs) $(lsb_release -cs) main
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">EOF</span>
</span></span><span style="display:flex;"><span>sudo apt update
</span></span></code></pre></div><h3 id="yum-repo">YUM Repo</h3>
<p><a href="https://pigsty.io/docs/node"><img alt="Linux" src="https://img.shields.io/badge/Linux-x86_64-%23FCC624?style=flat&logo=linux&labelColor=FCC624&logoColor=black"></a>
<a href="https://pigsty.io/docs/pgext/list/rpm/"><img alt="RHEL Support: 8/9" src="https://img.shields.io/badge/EL-7/8/9-red?style=flat&logo=redhat&logoColor=red"></a>
<a href="https://pigsty.io/docs/pgext/list/rpm/"><img alt="RHEL" src="https://img.shields.io/badge/RHEL-slategray?style=flat&logo=redhat&logoColor=red"></a>
<a href="https://almalinux.org/"><img alt="CentOS" src="https://img.shields.io/badge/CentOS-slategray?style=flat&logo=centos&logoColor=%23262577"></a>
<a href="https://almalinux.org/"><img alt="RockyLinux" src="https://img.shields.io/badge/RockyLinux-slategray?style=flat&logo=rockylinux&logoColor=%2310B981"></a>
<a href="https://almalinux.org/"><img alt="AlmaLinux" src="https://img.shields.io/badge/AlmaLinux-slategray?style=flat&logo=almalinux&logoColor=black"></a>
<a href="https://almalinux.org/"><img alt="OracleLinux" src="https://img.shields.io/badge/OracleLinux-slategray?style=flat&logo=oracle&logoColor=%23F80000"></a></p>
<p>For EL 8/9 and compatible platforms, use the following commands to add the YUM repo:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL https://repo.pigsty.io/key      <span style="color:#000;font-weight:bold">|</span> sudo tee /etc/pki/rpm-gpg/RPM-GPG-KEY-pigsty &gt;/dev/null  <span style="color:#8f5902;font-style:italic"># add gpg key</span>
</span></span><span style="display:flex;"><span>curl -fsSL https://repo.pigsty.io/yum/repo <span style="color:#000;font-weight:bold">|</span> sudo tee /etc/yum.repos.d/pigsty.repo        &gt;/dev/null  <span style="color:#8f5902;font-style:italic"># add repo file</span>
</span></span><span style="display:flex;"><span>sudo yum makecache
</span></span></code></pre></div><hr>
<h2 id="whats-in-this-repo">What&rsquo;s in this repo?</h2>
<p>In this repo, all the extensions are categorized into one of the <strong>15</strong> categories: TIME, GIS, RAG, FTS, OLAP, FEAT, LANG, TYPE, FUNC, ADMIN, STAT, SEC, FDW, SIM, ETL, as shown below.</p>
<p><a href="https://ext.pigsty.io/#/time"><strong>TIME</strong></a>: <a href="https://ext.pigsty.io/#/timescaledb"><code>timescaledb</code></a> <a href="https://ext.pigsty.io/#/timescaledb_toolkit"><code>timescaledb_toolkit</code></a> <a href="https://ext.pigsty.io/#/timeseries"><code>timeseries</code></a> <a href="https://ext.pigsty.io/#/periods"><code>periods</code></a> <a href="https://ext.pigsty.io/#/temporal_tables"><code>temporal_tables</code></a> <a href="https://ext.pigsty.io/#/emaj"><code>emaj</code></a> <a href="https://ext.pigsty.io/#/table_version"><code>table_version</code></a> <a href="https://ext.pigsty.io/#/pg_cron"><code>pg_cron</code></a> <a href="https://ext.pigsty.io/#/pg_later"><code>pg_later</code></a> <a href="https://ext.pigsty.io/#/pg_background"><code>pg_background</code></a>
<a href="https://ext.pigsty.io/#/gis"><strong>GIS</strong></a>: <a href="https://ext.pigsty.io/#/postgis"><code>postgis</code></a> <a href="https://ext.pigsty.io/#/postgis_topology"><code>postgis_topology</code></a> <a href="https://ext.pigsty.io/#/postgis_raster"><code>postgis_raster</code></a> <a href="https://ext.pigsty.io/#/postgis_sfcgal"><code>postgis_sfcgal</code></a> <a href="https://ext.pigsty.io/#/postgis_tiger_geocoder"><code>postgis_tiger_geocoder</code></a> <a href="https://ext.pigsty.io/#/address_standardizer"><code>address_standardizer</code></a> <a href="https://ext.pigsty.io/#/address_standardizer_data_us"><code>address_standardizer_data_us</code></a> <a href="https://ext.pigsty.io/#/pgrouting"><code>pgrouting</code></a> <a href="https://ext.pigsty.io/#/pointcloud"><code>pointcloud</code></a> <a href="https://ext.pigsty.io/#/pointcloud_postgis"><code>pointcloud_postgis</code></a> <a href="https://ext.pigsty.io/#/h3"><code>h3</code></a> <a href="https://ext.pigsty.io/#/h3_postgis"><code>h3_postgis</code></a> <a href="https://ext.pigsty.io/#/q3c"><code>q3c</code></a> <a href="https://ext.pigsty.io/#/ogr_fdw"><code>ogr_fdw</code></a> <a href="https://ext.pigsty.io/#/geoip"><code>geoip</code></a> <a href="https://ext.pigsty.io/#/pg_polyline"><code>pg_polyline</code></a> <a href="https://ext.pigsty.io/#/pg_geohash"><code>pg_geohash</code></a> <a href="https://ext.pigsty.io/#/mobilitydb"><code>mobilitydb</code></a> <a href="https://ext.pigsty.io/#/earthdistance"><code>earthdistance</code></a>
<a href="https://ext.pigsty.io/#/rag"><strong>RAG</strong></a>: <a href="https://ext.pigsty.io/#/vector"><code>vector</code></a> <a href="https://ext.pigsty.io/#/vectorscale"><code>vectorscale</code></a> <a href="https://ext.pigsty.io/#/vectorize"><code>vectorize</code></a> <a href="https://ext.pigsty.io/#/pg_similarity"><code>pg_similarity</code></a> <a href="https://ext.pigsty.io/#/smlar"><code>smlar</code></a> <a href="https://ext.pigsty.io/#/pg_summarize"><code>pg_summarize</code></a> <a href="https://ext.pigsty.io/#/pg_tiktoken"><code>pg_tiktoken</code></a> <a href="https://ext.pigsty.io/#/pgml"><code>pgml</code></a> <a href="https://ext.pigsty.io/#/pg4ml"><code>pg4ml</code></a>
<a href="https://ext.pigsty.io/#/fts"><strong>FTS</strong></a>: <a href="https://ext.pigsty.io/#/pg_search"><code>pg_search</code></a> <a href="https://ext.pigsty.io/#/pg_bigm"><code>pg_bigm</code></a> <a href="https://ext.pigsty.io/#/zhparser"><code>zhparser</code></a> <a href="https://ext.pigsty.io/#/hunspell_cs_cz"><code>hunspell_cs_cz</code></a> <a href="https://ext.pigsty.io/#/hunspell_de_de"><code>hunspell_de_de</code></a> <a href="https://ext.pigsty.io/#/hunspell_en_us"><code>hunspell_en_us</code></a> <a href="https://ext.pigsty.io/#/hunspell_fr"><code>hunspell_fr</code></a> <a href="https://ext.pigsty.io/#/hunspell_ne_np"><code>hunspell_ne_np</code></a> <a href="https://ext.pigsty.io/#/hunspell_nl_nl"><code>hunspell_nl_nl</code></a> <a href="https://ext.pigsty.io/#/hunspell_nn_no"><code>hunspell_nn_no</code></a> <a href="https://ext.pigsty.io/#/hunspell_pt_pt"><code>hunspell_pt_pt</code></a> <a href="https://ext.pigsty.io/#/hunspell_ru_ru"><code>hunspell_ru_ru</code></a> <a href="https://ext.pigsty.io/#/hunspell_ru_ru_aot"><code>hunspell_ru_ru_aot</code></a> <a href="https://ext.pigsty.io/#/fuzzystrmatch"><code>fuzzystrmatch</code></a> <a href="https://ext.pigsty.io/#/pg_trgm"><code>pg_trgm</code></a>
<a href="https://ext.pigsty.io/#/olap"><strong>OLAP</strong></a>: <a href="https://ext.pigsty.io/#/citus"><code>citus</code></a> <a href="https://ext.pigsty.io/#/citus_columnar"><code>citus_columnar</code></a> <a href="https://ext.pigsty.io/#/columnar"><code>columnar</code></a> <a href="https://ext.pigsty.io/#/pg_analytics"><code>pg_analytics</code></a> <a href="https://ext.pigsty.io/#/pg_duckdb"><code>pg_duckdb</code></a> <a href="https://ext.pigsty.io/#/pg_mooncake"><code>pg_mooncake</code></a> <a href="https://ext.pigsty.io/#/duckdb_fdw"><code>duckdb_fdw</code></a> <a href="https://ext.pigsty.io/#/pg_parquet"><code>pg_parquet</code></a> <a href="https://ext.pigsty.io/#/pg_fkpart"><code>pg_fkpart</code></a> <a href="https://ext.pigsty.io/#/pg_partman"><code>pg_partman</code></a> <a href="https://ext.pigsty.io/#/plproxy"><code>plproxy</code></a> <a href="https://ext.pigsty.io/#/pg_strom"><code>pg_strom</code></a> <a href="https://ext.pigsty.io/#/tablefunc"><code>tablefunc</code></a>
<a href="https://ext.pigsty.io/#/feat"><strong>FEAT</strong></a>: <a href="https://ext.pigsty.io/#/age"><code>age</code></a> <a href="https://ext.pigsty.io/#/hll"><code>hll</code></a> <a href="https://ext.pigsty.io/#/rum"><code>rum</code></a> <a href="https://ext.pigsty.io/#/pg_graphql"><code>pg_graphql</code></a> <a href="https://ext.pigsty.io/#/pg_jsonschema"><code>pg_jsonschema</code></a> <a href="https://ext.pigsty.io/#/jsquery"><code>jsquery</code></a> <a href="https://ext.pigsty.io/#/pg_hint_plan"><code>pg_hint_plan</code></a> <a href="https://ext.pigsty.io/#/hypopg"><code>hypopg</code></a> <a href="https://ext.pigsty.io/#/index_advisor"><code>index_advisor</code></a> <a href="https://ext.pigsty.io/#/plan_filter"><code>plan_filter</code></a> <a href="https://ext.pigsty.io/#/imgsmlr"><code>imgsmlr</code></a> <a href="https://ext.pigsty.io/#/pg_ivm"><code>pg_ivm</code></a> <a href="https://ext.pigsty.io/#/pgmq"><code>pgmq</code></a> <a href="https://ext.pigsty.io/#/pgq"><code>pgq</code></a> <a href="https://ext.pigsty.io/#/pg_cardano"><code>pg_cardano</code></a> <a href="https://ext.pigsty.io/#/rdkit"><code>rdkit</code></a> <a href="https://ext.pigsty.io/#/bloom"><code>bloom</code></a>
<a href="https://ext.pigsty.io/#/lang"><strong>LANG</strong></a>: <a href="https://ext.pigsty.io/#/pg_tle"><code>pg_tle</code></a> <a href="https://ext.pigsty.io/#/plv8"><code>plv8</code></a> <a href="https://ext.pigsty.io/#/pllua"><code>pllua</code></a> <a href="https://ext.pigsty.io/#/hstore_pllua"><code>hstore_pllua</code></a> <a href="https://ext.pigsty.io/#/plluau"><code>plluau</code></a> <a href="https://ext.pigsty.io/#/hstore_plluau"><code>hstore_plluau</code></a> <a href="https://ext.pigsty.io/#/plprql"><code>plprql</code></a> <a href="https://ext.pigsty.io/#/pldbgapi"><code>pldbgapi</code></a> <a href="https://ext.pigsty.io/#/plpgsql_check"><code>plpgsql_check</code></a> <a href="https://ext.pigsty.io/#/plprofiler"><code>plprofiler</code></a> <a href="https://ext.pigsty.io/#/plsh"><code>plsh</code></a> <a href="https://ext.pigsty.io/#/pljava"><code>pljava</code></a> <a href="https://ext.pigsty.io/#/plr"><code>plr</code></a> <a href="https://ext.pigsty.io/#/pgtap"><code>pgtap</code></a> <a href="https://ext.pigsty.io/#/faker"><code>faker</code></a> <a href="https://ext.pigsty.io/#/dbt2"><code>dbt2</code></a> <a href="https://ext.pigsty.io/#/pltcl"><code>pltcl</code></a> <a href="https://ext.pigsty.io/#/pltclu"><code>pltclu</code></a> <a href="https://ext.pigsty.io/#/plperl"><code>plperl</code></a> <a href="https://ext.pigsty.io/#/bool_plperl"><code>bool_plperl</code></a> <a href="https://ext.pigsty.io/#/hstore_plperl"><code>hstore_plperl</code></a> <a href="https://ext.pigsty.io/#/jsonb_plperl"><code>jsonb_plperl</code></a> <a href="https://ext.pigsty.io/#/plperlu"><code>plperlu</code></a> <a href="https://ext.pigsty.io/#/bool_plperlu"><code>bool_plperlu</code></a> <a href="https://ext.pigsty.io/#/jsonb_plperlu"><code>jsonb_plperlu</code></a> <a href="https://ext.pigsty.io/#/hstore_plperlu"><code>hstore_plperlu</code></a> <a href="https://ext.pigsty.io/#/plpgsql"><code>plpgsql</code></a> <a href="https://ext.pigsty.io/#/plpython3u"><code>plpython3u</code></a> <a href="https://ext.pigsty.io/#/jsonb_plpython3u"><code>jsonb_plpython3u</code></a> <a href="https://ext.pigsty.io/#/ltree_plpython3u"><code>ltree_plpython3u</code></a> <a href="https://ext.pigsty.io/#/hstore_plpython3u"><code>hstore_plpython3u</code></a>
<a href="https://ext.pigsty.io/#/type"><strong>TYPE</strong></a>: <a href="https://ext.pigsty.io/#/prefix"><code>prefix</code></a> <a href="https://ext.pigsty.io/#/semver"><code>semver</code></a> <a href="https://ext.pigsty.io/#/unit"><code>unit</code></a> <a href="https://ext.pigsty.io/#/md5hash"><code>md5hash</code></a> <a href="https://ext.pigsty.io/#/asn1oid"><code>asn1oid</code></a> <a href="https://ext.pigsty.io/#/roaringbitmap"><code>roaringbitmap</code></a> <a href="https://ext.pigsty.io/#/pgfaceting"><code>pgfaceting</code></a> <a href="https://ext.pigsty.io/#/pg_sphere"><code>pg_sphere</code></a> <a href="https://ext.pigsty.io/#/country"><code>country</code></a> <a href="https://ext.pigsty.io/#/currency"><code>currency</code></a> <a href="https://ext.pigsty.io/#/pgmp"><code>pgmp</code></a> <a href="https://ext.pigsty.io/#/numeral"><code>numeral</code></a> <a href="https://ext.pigsty.io/#/pg_rational"><code>pg_rational</code></a> <a href="https://ext.pigsty.io/#/uint"><code>uint</code></a> <a href="https://ext.pigsty.io/#/uint128"><code>uint128</code></a> <a href="https://ext.pigsty.io/#/ip4r"><code>ip4r</code></a> <a href="https://ext.pigsty.io/#/uri"><code>uri</code></a> <a href="https://ext.pigsty.io/#/pgemailaddr"><code>pgemailaddr</code></a> <a href="https://ext.pigsty.io/#/acl"><code>acl</code></a> <a href="https://ext.pigsty.io/#/debversion"><code>debversion</code></a> <a href="https://ext.pigsty.io/#/pg_rrule"><code>pg_rrule</code></a> <a href="https://ext.pigsty.io/#/timestamp9"><code>timestamp9</code></a> <a href="https://ext.pigsty.io/#/chkpass"><code>chkpass</code></a> <a href="https://ext.pigsty.io/#/isn"><code>isn</code></a> <a href="https://ext.pigsty.io/#/seg"><code>seg</code></a> <a href="https://ext.pigsty.io/#/cube"><code>cube</code></a> <a href="https://ext.pigsty.io/#/ltree"><code>ltree</code></a> <a href="https://ext.pigsty.io/#/hstore"><code>hstore</code></a> <a href="https://ext.pigsty.io/#/citext"><code>citext</code></a> <a href="https://ext.pigsty.io/#/xml2"><code>xml2</code></a>
<a href="https://ext.pigsty.io/#/func"><strong>FUNC</strong></a>: <a href="https://ext.pigsty.io/#/topn"><code>topn</code></a> <a href="https://ext.pigsty.io/#/gzip"><code>gzip</code></a> <a href="https://ext.pigsty.io/#/zstd"><code>zstd</code></a> <a href="https://ext.pigsty.io/#/http"><code>http</code></a> <a href="https://ext.pigsty.io/#/pg_net"><code>pg_net</code></a> <a href="https://ext.pigsty.io/#/pg_smtp_client"><code>pg_smtp_client</code></a> <a href="https://ext.pigsty.io/#/pg_html5_email_address"><code>pg_html5_email_address</code></a> <a href="https://ext.pigsty.io/#/pgsql_tweaks"><code>pgsql_tweaks</code></a> <a href="https://ext.pigsty.io/#/pg_extra_time"><code>pg_extra_time</code></a> <a href="https://ext.pigsty.io/#/timeit"><code>timeit</code></a> <a href="https://ext.pigsty.io/#/count_distinct"><code>count_distinct</code></a> <a href="https://ext.pigsty.io/#/extra_window_functions"><code>extra_window_functions</code></a> <a href="https://ext.pigsty.io/#/first_last_agg"><code>first_last_agg</code></a> <a href="https://ext.pigsty.io/#/tdigest"><code>tdigest</code></a> <a href="https://ext.pigsty.io/#/aggs_for_vecs"><code>aggs_for_vecs</code></a> <a href="https://ext.pigsty.io/#/aggs_for_arrays"><code>aggs_for_arrays</code></a> <a href="https://ext.pigsty.io/#/arraymath"><code>arraymath</code></a> <a href="https://ext.pigsty.io/#/quantile"><code>quantile</code></a> <a href="https://ext.pigsty.io/#/lower_quantile"><code>lower_quantile</code></a> <a href="https://ext.pigsty.io/#/pg_idkit"><code>pg_idkit</code></a> <a href="https://ext.pigsty.io/#/pg_uuidv7"><code>pg_uuidv7</code></a> <a href="https://ext.pigsty.io/#/permuteseq"><code>permuteseq</code></a> <a href="https://ext.pigsty.io/#/pg_hashids"><code>pg_hashids</code></a> <a href="https://ext.pigsty.io/#/sequential_uuids"><code>sequential_uuids</code></a> <a href="https://ext.pigsty.io/#/pg_math"><code>pg_math</code></a> <a href="https://ext.pigsty.io/#/random"><code>random</code></a> <a href="https://ext.pigsty.io/#/base36"><code>base36</code></a> <a href="https://ext.pigsty.io/#/base62"><code>base62</code></a> <a href="https://ext.pigsty.io/#/pg_base58"><code>pg_base58</code></a> <a href="https://ext.pigsty.io/#/floatvec"><code>floatvec</code></a> <a href="https://ext.pigsty.io/#/financial"><code>financial</code></a> <a href="https://ext.pigsty.io/#/pgjwt"><code>pgjwt</code></a> <a href="https://ext.pigsty.io/#/pg_hashlib"><code>pg_hashlib</code></a> <a href="https://ext.pigsty.io/#/shacrypt"><code>shacrypt</code></a> <a href="https://ext.pigsty.io/#/cryptint"><code>cryptint</code></a> <a href="https://ext.pigsty.io/#/pguecc"><code>pguecc</code></a> <a href="https://ext.pigsty.io/#/pgpcre"><code>pgpcre</code></a> <a href="https://ext.pigsty.io/#/icu_ext"><code>icu_ext</code></a> <a href="https://ext.pigsty.io/#/pgqr"><code>pgqr</code></a> <a href="https://ext.pigsty.io/#/envvar"><code>envvar</code></a> <a href="https://ext.pigsty.io/#/pg_protobuf"><code>pg_protobuf</code></a> <a href="https://ext.pigsty.io/#/url_encode"><code>url_encode</code></a> <a href="https://ext.pigsty.io/#/refint"><code>refint</code></a> <a href="https://ext.pigsty.io/#/autoinc"><code>autoinc</code></a> <a href="https://ext.pigsty.io/#/insert_username"><code>insert_username</code></a> <a href="https://ext.pigsty.io/#/moddatetime"><code>moddatetime</code></a> <a href="https://ext.pigsty.io/#/tsm_system_time"><code>tsm_system_time</code></a> <a href="https://ext.pigsty.io/#/dict_xsyn"><code>dict_xsyn</code></a> <a href="https://ext.pigsty.io/#/tsm_system_rows"><code>tsm_system_rows</code></a> <a href="https://ext.pigsty.io/#/tcn"><code>tcn</code></a> <a href="https://ext.pigsty.io/#/uuid-ossp"><code>uuid-ossp</code></a> <a href="https://ext.pigsty.io/#/btree_gist"><code>btree_gist</code></a> <a href="https://ext.pigsty.io/#/btree_gin"><code>btree_gin</code></a> <a href="https://ext.pigsty.io/#/intarray"><code>intarray</code></a> <a href="https://ext.pigsty.io/#/intagg"><code>intagg</code></a> <a href="https://ext.pigsty.io/#/dict_int"><code>dict_int</code></a> <a href="https://ext.pigsty.io/#/unaccent"><code>unaccent</code></a>
<a href="https://ext.pigsty.io/#/admin"><strong>ADMIN</strong></a>: <a href="https://ext.pigsty.io/#/pg_repack"><code>pg_repack</code></a> <a href="https://ext.pigsty.io/#/pg_squeeze"><code>pg_squeeze</code></a> <a href="https://ext.pigsty.io/#/pg_dirtyread"><code>pg_dirtyread</code></a> <a href="https://ext.pigsty.io/#/pgfincore"><code>pgfincore</code></a> <a href="https://ext.pigsty.io/#/pgdd"><code>pgdd</code></a> <a href="https://ext.pigsty.io/#/ddlx"><code>ddlx</code></a> <a href="https://ext.pigsty.io/#/prioritize"><code>prioritize</code></a> <a href="https://ext.pigsty.io/#/pg_checksums"><code>pg_checksums</code></a> <a href="https://ext.pigsty.io/#/pg_readonly"><code>pg_readonly</code></a> <a href="https://ext.pigsty.io/#/safeupdate"><code>safeupdate</code></a> <a href="https://ext.pigsty.io/#/pg_permissions"><code>pg_permissions</code></a> <a href="https://ext.pigsty.io/#/pgautofailover"><code>pgautofailover</code></a> <a href="https://ext.pigsty.io/#/pg_catcheck"><code>pg_catcheck</code></a> <a href="https://ext.pigsty.io/#/pre_prepare"><code>pre_prepare</code></a> <a href="https://ext.pigsty.io/#/pgcozy"><code>pgcozy</code></a> <a href="https://ext.pigsty.io/#/pg_orphaned"><code>pg_orphaned</code></a> <a href="https://ext.pigsty.io/#/pg_crash"><code>pg_crash</code></a> <a href="https://ext.pigsty.io/#/pg_cheat_funcs"><code>pg_cheat_funcs</code></a> <a href="https://ext.pigsty.io/#/pg_savior"><code>pg_savior</code></a> <a href="https://ext.pigsty.io/#/table_log"><code>table_log</code></a> <a href="https://ext.pigsty.io/#/pg_fio"><code>pg_fio</code></a> <a href="https://ext.pigsty.io/#/pgpool_adm"><code>pgpool_adm</code></a> <a href="https://ext.pigsty.io/#/pgpool_recovery"><code>pgpool_recovery</code></a> <a href="https://ext.pigsty.io/#/pgpool_regclass"><code>pgpool_regclass</code></a> <a href="https://ext.pigsty.io/#/pgagent"><code>pgagent</code></a> <a href="https://ext.pigsty.io/#/vacuumlo"><code>vacuumlo</code></a> <a href="https://ext.pigsty.io/#/pg_prewarm"><code>pg_prewarm</code></a> <a href="https://ext.pigsty.io/#/oid2name"><code>oid2name</code></a> <a href="https://ext.pigsty.io/#/lo"><code>lo</code></a> <a href="https://ext.pigsty.io/#/basic_archive"><code>basic_archive</code></a> <a href="https://ext.pigsty.io/#/basebackup_to_shell"><code>basebackup_to_shell</code></a> <a href="https://ext.pigsty.io/#/old_snapshot"><code>old_snapshot</code></a> <a href="https://ext.pigsty.io/#/adminpack"><code>adminpack</code></a> <a href="https://ext.pigsty.io/#/amcheck"><code>amcheck</code></a> <a href="https://ext.pigsty.io/#/pg_surgery"><code>pg_surgery</code></a>
<a href="https://ext.pigsty.io/#/stat"><strong>STAT</strong></a>: <a href="https://ext.pigsty.io/#/pg_profile"><code>pg_profile</code></a> <a href="https://ext.pigsty.io/#/pg_show_plans"><code>pg_show_plans</code></a> <a href="https://ext.pigsty.io/#/pg_stat_kcache"><code>pg_stat_kcache</code></a> <a href="https://ext.pigsty.io/#/pg_stat_monitor"><code>pg_stat_monitor</code></a> <a href="https://ext.pigsty.io/#/pg_qualstats"><code>pg_qualstats</code></a> <a href="https://ext.pigsty.io/#/pg_store_plans"><code>pg_store_plans</code></a> <a href="https://ext.pigsty.io/#/pg_track_settings"><code>pg_track_settings</code></a> <a href="https://ext.pigsty.io/#/pg_wait_sampling"><code>pg_wait_sampling</code></a> <a href="https://ext.pigsty.io/#/system_stats"><code>system_stats</code></a> <a href="https://ext.pigsty.io/#/meta"><code>meta</code></a> <a href="https://ext.pigsty.io/#/pgnodemx"><code>pgnodemx</code></a> <a href="https://ext.pigsty.io/#/pg_proctab"><code>pg_proctab</code></a> <a href="https://ext.pigsty.io/#/pg_sqlog"><code>pg_sqlog</code></a> <a href="https://ext.pigsty.io/#/bgw_replstatus"><code>bgw_replstatus</code></a> <a href="https://ext.pigsty.io/#/pgmeminfo"><code>pgmeminfo</code></a> <a href="https://ext.pigsty.io/#/toastinfo"><code>toastinfo</code></a> <a href="https://ext.pigsty.io/#/explain_ui"><code>explain_ui</code></a> <a href="https://ext.pigsty.io/#/pg_relusage"><code>pg_relusage</code></a> <a href="https://ext.pigsty.io/#/pg_top"><code>pg_top</code></a> <a href="https://ext.pigsty.io/#/pagevis"><code>pagevis</code></a> <a href="https://ext.pigsty.io/#/powa"><code>powa</code></a> <a href="https://ext.pigsty.io/#/pageinspect"><code>pageinspect</code></a> <a href="https://ext.pigsty.io/#/pgrowlocks"><code>pgrowlocks</code></a> <a href="https://ext.pigsty.io/#/sslinfo"><code>sslinfo</code></a> <a href="https://ext.pigsty.io/#/pg_buffercache"><code>pg_buffercache</code></a> <a href="https://ext.pigsty.io/#/pg_walinspect"><code>pg_walinspect</code></a> <a href="https://ext.pigsty.io/#/pg_freespacemap"><code>pg_freespacemap</code></a> <a href="https://ext.pigsty.io/#/pg_visibility"><code>pg_visibility</code></a> <a href="https://ext.pigsty.io/#/pgstattuple"><code>pgstattuple</code></a> <a href="https://ext.pigsty.io/#/auto_explain"><code>auto_explain</code></a> <a href="https://ext.pigsty.io/#/pg_stat_statements"><code>pg_stat_statements</code></a>
<a href="https://ext.pigsty.io/#/sec"><strong>SEC</strong></a>: <a href="https://ext.pigsty.io/#/passwordcheck_cracklib"><code>passwordcheck_cracklib</code></a> <a href="https://ext.pigsty.io/#/supautils"><code>supautils</code></a> <a href="https://ext.pigsty.io/#/pgsodium"><code>pgsodium</code></a> <a href="https://ext.pigsty.io/#/supabase_vault"><code>supabase_vault</code></a> <a href="https://ext.pigsty.io/#/pg_session_jwt"><code>pg_session_jwt</code></a> <a href="https://ext.pigsty.io/#/anon"><code>anon</code></a> <a href="https://ext.pigsty.io/#/pg_tde"><code>pg_tde</code></a> <a href="https://ext.pigsty.io/#/pgsmcrypto"><code>pgsmcrypto</code></a> <a href="https://ext.pigsty.io/#/pgaudit"><code>pgaudit</code></a> <a href="https://ext.pigsty.io/#/pgauditlogtofile"><code>pgauditlogtofile</code></a> <a href="https://ext.pigsty.io/#/pg_auth_mon"><code>pg_auth_mon</code></a> <a href="https://ext.pigsty.io/#/credcheck"><code>credcheck</code></a> <a href="https://ext.pigsty.io/#/pgcryptokey"><code>pgcryptokey</code></a> <a href="https://ext.pigsty.io/#/pg_jobmon"><code>pg_jobmon</code></a> <a href="https://ext.pigsty.io/#/logerrors"><code>logerrors</code></a> <a href="https://ext.pigsty.io/#/login_hook"><code>login_hook</code></a> <a href="https://ext.pigsty.io/#/set_user"><code>set_user</code></a> <a href="https://ext.pigsty.io/#/pg_snakeoil"><code>pg_snakeoil</code></a> <a href="https://ext.pigsty.io/#/pgextwlist"><code>pgextwlist</code></a> <a href="https://ext.pigsty.io/#/pg_auditor"><code>pg_auditor</code></a> <a href="https://ext.pigsty.io/#/sslutils"><code>sslutils</code></a> <a href="https://ext.pigsty.io/#/noset"><code>noset</code></a> <a href="https://ext.pigsty.io/#/sepgsql"><code>sepgsql</code></a> <a href="https://ext.pigsty.io/#/auth_delay"><code>auth_delay</code></a> <a href="https://ext.pigsty.io/#/pgcrypto"><code>pgcrypto</code></a> <a href="https://ext.pigsty.io/#/passwordcheck"><code>passwordcheck</code></a>
<a href="https://ext.pigsty.io/#/fdw"><strong>FDW</strong></a>: <a href="https://ext.pigsty.io/#/wrappers"><code>wrappers</code></a> <a href="https://ext.pigsty.io/#/multicorn"><code>multicorn</code></a> <a href="https://ext.pigsty.io/#/odbc_fdw"><code>odbc_fdw</code></a> <a href="https://ext.pigsty.io/#/jdbc_fdw"><code>jdbc_fdw</code></a> <a href="https://ext.pigsty.io/#/mysql_fdw"><code>mysql_fdw</code></a> <a href="https://ext.pigsty.io/#/oracle_fdw"><code>oracle_fdw</code></a> <a href="https://ext.pigsty.io/#/tds_fdw"><code>tds_fdw</code></a> <a href="https://ext.pigsty.io/#/db2_fdw"><code>db2_fdw</code></a> <a href="https://ext.pigsty.io/#/sqlite_fdw"><code>sqlite_fdw</code></a> <a href="https://ext.pigsty.io/#/pgbouncer_fdw"><code>pgbouncer_fdw</code></a> <a href="https://ext.pigsty.io/#/mongo_fdw"><code>mongo_fdw</code></a> <a href="https://ext.pigsty.io/#/redis_fdw"><code>redis_fdw</code></a> <a href="https://ext.pigsty.io/#/redis"><code>redis</code></a> <a href="https://ext.pigsty.io/#/kafka_fdw"><code>kafka_fdw</code></a> <a href="https://ext.pigsty.io/#/hdfs_fdw"><code>hdfs_fdw</code></a> <a href="https://ext.pigsty.io/#/firebird_fdw"><code>firebird_fdw</code></a> <a href="https://ext.pigsty.io/#/aws_s3"><code>aws_s3</code></a> <a href="https://ext.pigsty.io/#/log_fdw"><code>log_fdw</code></a> <a href="https://ext.pigsty.io/#/dblink"><code>dblink</code></a> <a href="https://ext.pigsty.io/#/file_fdw"><code>file_fdw</code></a> <a href="https://ext.pigsty.io/#/postgres_fdw"><code>postgres_fdw</code></a>
<a href="https://ext.pigsty.io/#/sim"><strong>SIM</strong></a>: <a href="https://ext.pigsty.io/#/orafce"><code>orafce</code></a> <a href="https://ext.pigsty.io/#/pgtt"><code>pgtt</code></a> <a href="https://ext.pigsty.io/#/session_variable"><code>session_variable</code></a> <a href="https://ext.pigsty.io/#/pg_statement_rollback"><code>pg_statement_rollback</code></a> <a href="https://ext.pigsty.io/#/pg_dbms_metadata"><code>pg_dbms_metadata</code></a> <a href="https://ext.pigsty.io/#/pg_dbms_lock"><code>pg_dbms_lock</code></a> <a href="https://ext.pigsty.io/#/pg_dbms_job"><code>pg_dbms_job</code></a> <a href="https://ext.pigsty.io/#/babelfishpg_common"><code>babelfishpg_common</code></a> <a href="https://ext.pigsty.io/#/babelfishpg_tsql"><code>babelfishpg_tsql</code></a> <a href="https://ext.pigsty.io/#/babelfishpg_tds"><code>babelfishpg_tds</code></a> <a href="https://ext.pigsty.io/#/babelfishpg_money"><code>babelfishpg_money</code></a> <a href="https://ext.pigsty.io/#/pgmemcache"><code>pgmemcache</code></a>
<a href="https://ext.pigsty.io/#/etl"><strong>ETL</strong></a>: <a href="https://ext.pigsty.io/#/pglogical"><code>pglogical</code></a> <a href="https://ext.pigsty.io/#/pglogical_origin"><code>pglogical_origin</code></a> <a href="https://ext.pigsty.io/#/pglogical_ticker"><code>pglogical_ticker</code></a> <a href="https://ext.pigsty.io/#/pgl_ddl_deploy"><code>pgl_ddl_deploy</code></a> <a href="https://ext.pigsty.io/#/pg_failover_slots"><code>pg_failover_slots</code></a> <a href="https://ext.pigsty.io/#/wal2json"><code>wal2json</code></a> <a href="https://ext.pigsty.io/#/wal2mongo"><code>wal2mongo</code></a> <a href="https://ext.pigsty.io/#/decoderbufs"><code>decoderbufs</code></a> <a href="https://ext.pigsty.io/#/decoder_raw"><code>decoder_raw</code></a> <a href="https://ext.pigsty.io/#/test_decoding"><code>test_decoding</code></a> <a href="https://ext.pigsty.io/#/mimeo"><code>mimeo</code></a> <a href="https://ext.pigsty.io/#/repmgr"><code>repmgr</code></a> <a href="https://ext.pigsty.io/#/pg_fact_loader"><code>pg_fact_loader</code></a> <a href="https://ext.pigsty.io/#/pg_bulkload"><code>pg_bulkload</code></a></p>
<p>Check <a href="https://ext.pigsty.io">ext.pigsty.io</a> for all the details.</p>
<hr>
<h2 id="some-thoughts">Some Thoughts</h2>
<p>Each major PostgreSQL version introduces changes, making the maintenance of <strong>140+</strong> extension packages a bit of a beast.</p>
<p>Especially when some extension authors haven’t updated their work in years. In these cases, you often have no choice but to take matters into your own hands.
I’ve personally fixed several extensions and ensured they support the latest PostgreSQL major versions. For those authors I could reach, I’ve submitted numerous PRs and issues to keep things moving forward.</p>
<p><a href="https://github.com/Vonng"><img src="github-contrib.png" style="max-width: 800px; width: 100%; height: auto;"></a></p>
<p>Back to the point: <strong>my goal with this repo is to establish a standard for PostgreSQL extension installation and distribution, solving the distribution challenges that have long troubles the users</strong>.</p>
<p>A recent milestone is that, the popular open-source PostgreSQL HA cluster project <a href="https://autobase.tech/docs/extensions/list"><strong>postgresql_cluster</strong></a>, has made this extension repository the default upstream for PG extension installation.</p>
<p>Currently, this repository (repo.pigsty.io) is hosted on Cloudflare. In the past month, the repo and its mirrors have served about <strong>300GB</strong> of downloads.
Given that most extensions are just a few KB to a few MB, that amounts to nearly <strong>a million downloads per month</strong>.
Since Cloudflare doesn’t charge for traffic, I can confidently commit to keeping this repository completely free &amp; under active maintenance for the foreseeable future, as long as cloudflare doesn&rsquo;t charge me too much.</p>
<p>I believe my work can help PostgreSQL users worldwide and contribute to the thriving PostgreSQL ecosystem. I hope it proves useful to you as well. <strong>Enjoy PostgreSQL!</strong></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-635f4dbe52424af419b468e194e22c72">Self-Hosting Dify with PG, PGVector, and Pigsty</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com">Wechat Column</a></b> |
        
		<time datetime="2024-06-22" class="text-muted">2024-06-22</time>
        
	</div>
	<p><a href="https://dify.ai/"><strong>Dify</strong></a> &ndash; The Innovation Engine for GenAI Applications</p>
<p>Dify is an open-source LLM app development platform. Orchestrate LLM apps from agents to complex AI workflows, with an RAG engine.
Which claims to be more production-ready than LangChain.</p>
<p>Of course, a workflow orchestration software like this needs a database underneath — Dify uses <strong>PostgreSQL</strong> for meta data storage, as well as Redis for caching and a dedicated vector database.
You can pull the Docker images and play locally, but for production deployment, this setup won&rsquo;t suffice — there&rsquo;s no HA, backup, PITR, monitoring, and many other things.</p>
<p>Fortunately, Pigsty provides a battery-include production-grade highly available PostgreSQL cluster, along with the Redis and S3 (MinIO) capabilities that Dify needs, as well as Nginx to expose the Web service, making it the perfect companion for Dify.</p>
<p><a href="https://github.com/langgenius/dify/blob/main/docker/docker-compose.yaml"><img alt="docker-compose.png" src="/zh/blog/pg/dify-setup/docker-compose.png"></a></p>
<blockquote>
<p>Off-load the stateful part to Pigsty, you only need to pull up the stateless blue circle part with a simple <code>docker compose up</code>.</p>
</blockquote>
<p>BTW, I have to criticize the design of the Dify template. Since the metadata is already stored in PostgreSQL, why not add <code>pgvector</code> to use it as a vector database? What&rsquo;s even more baffling is that <code>pgvector</code> is a separate image and container. Why not just use a PG image with <code>pgvector</code> included?</p>
<p>Dify &ldquo;supports&rdquo; a bunch of flashy vector databases, but since PostgreSQL is already chosen, using <code>pgvector</code> as the default vector database is the natural choice. Similarly, I think the Dify team should consider removing Redis. Celery task queues can use PostgreSQL as backend storage, so having multiple databases is unnecessary. Entities should not be multiplied without necessity.</p>
<p>Therefore, the Pigsty-provided <a href="https://github.com/Vonng/pigsty/tree/master/app/dify">Dify Docker Compose template</a> has made some adjustments to the official example. It removes the <code>db</code> and <code>redis</code> database images, using instances managed by Pigsty. The vector database is fixed to use <code>pgvector</code>, reusing the same PostgreSQL instance.</p>
<p>In the end, the architecture is simplified to three stateless containers: <code>dify-api</code>, <code>dify-web</code>, and <code>dify-worker</code>, which can be created and destroyed at will. There are also two optional containers, <code>ssrf_proxy</code> and <code>nginx</code>, for providing proxy and some security features.</p>
<p>There’s a bit of state management left with <a href="https://github.com/Vonng/pigsty/blob/main/app/dify/docker-compose.yml#L128">file system volumes</a>, storing things like private keys. Regular backups are sufficient.</p>
<p>Reference:</p>
<ul>
<li><a href="https://github.com/langgenius/dify/">GitHub: langgenius/Dify</a></li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/dify">Pigsty: Dify Docker Compose Template</a></li>
</ul>
<hr>
<h2 id="pigsty-preparation">Pigsty Preparation</h2>
<p>Let&rsquo;s take the <a href="/docs/concept/arch/#singleton-meta">single-node installation</a> of Pigsty as an example. Suppose you have a machine with the IP address <code>10.10.10.10</code> and already pigsty <a href="/docs/setup/install/">installed</a>.</p>
<p>We need to define the database clusters required in the Pigsty configuration file <code>pigsty.yml</code>.</p>
<p>Here, we define a cluster named <code>pg-meta</code>, which includes a superuser named <code>dbuser_dify</code> (the implementation is a bit rough as the Migration script executes <code>CREATE EXTENSION</code> which require dbsu privilege for now),</p>
<p>And there&rsquo;s a database named <code>dify</code> with the <code>pgvector</code> extension installed, and a specific firewall rule allowing users to access the database from anywhere using a password (you can also restrict it to a more precise range, such as the Docker subnet <code>172.0.0.0/8</code>).</p>
<p>Additionally, a standard single-instance Redis cluster <code>redis-dify</code> with the password <code>redis.dify</code> is defined.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg-meta</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">pg_seq: 1, pg_role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">primary } }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_cluster</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg-meta</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dbuser_dify ,password: DBUser.Dify  ,superuser: true ,pgbouncer: true ,roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_admin ] } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: dify, owner: dbuser_dify, extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgvector } ] } ]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pg_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">user: dbuser_dify , db: all ,addr: world ,auth: pwd ,title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;allow dify user world pwd access&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">redis-dify</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">hosts</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">10.10.10.10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">redis_node: 1 , redis_instances</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">6379</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">vars</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">redis_cluster: redis-dify ,redis_password: &#39;redis.dify&#39; ,redis_max_memory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">64MB }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For demonstration purposes, we use single-instance configurations. You can refer to the Pigsty documentation to deploy <a href="/docs/concept/ha/">high availability</a> PG and Redis clusters. After defining the clusters, use the following commands to create the PG and Redis clusters:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bin/pgsql-add  pg-meta                <span style="color:#8f5902;font-style:italic"># create the dify database cluster</span>
</span></span><span style="display:flex;"><span>bin/redis-add  redis-dify             <span style="color:#8f5902;font-style:italic"># create redis cluster</span>
</span></span></code></pre></div><p>Alternatively, you can define a new <a href="/docs/pgsql/user/">business user</a> and <a href="/docs/pgsql/db/">business database</a> on an existing PostgreSQL cluster, such as <code>pg-meta</code>, and create them with the following commands:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bin/pgsql-user pg-meta dbuser_dify    <span style="color:#8f5902;font-style:italic"># create dify biz user</span>
</span></span><span style="display:flex;"><span>bin/pgsql-db   pg-meta dify           <span style="color:#8f5902;font-style:italic"># create dify biz database</span>
</span></span></code></pre></div><p>You should be able to access PostgreSQL and Redis with the following connection strings, adjusting the connection information as needed:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>psql postgres://dbuser_dify:DBUser.Dify@10.10.10.10:5432/dify -c <span style="color:#4e9a06">&#39;SELECT 1&#39;</span>
</span></span><span style="display:flex;"><span>redis-cli -u redis://redis.dify@10.10.10.10:6379/0 ping
</span></span></code></pre></div><p>Once you confirm these connection strings are working, you&rsquo;re all set to start deploying Dify.</p>
<p>For demonstration purposes, we&rsquo;re using direct IP connections. For a multi-node high availability PG cluster, please refer to the <a href="/docs/concept/svc/">service access</a> section.</p>
<p>The above assumes you are already a Pigsty user familiar with deploying PostgreSQL and Redis clusters. You can skip the next section and proceed to see <a href="/blog/pg/dify-setup/#dify-configuration">how to configure Dify</a>.</p>
<hr>
<h2 id="starting-from-scratch">Starting from Scratch</h2>
<p>If you&rsquo;re already familiar with setting up Pigsty, feel free to skip this section.</p>
<p><a href="/docs/setup/prepare/">Prepare</a> a fresh Linux x86_64 node that runs <a href="/docs/reference/compatibility/">compatible</a> OS, then run as a <strong>sudo-able</strong> user:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL https://repo.pigsty.io/get <span style="color:#000;font-weight:bold">|</span> bash
</span></span></code></pre></div><p>It will <a href="/blog/pg/dify-setup/#download">download</a> Pigsty source to your home, then perform <a href="/blog/pg/dify-setup/#configure">configure</a> and <a href="/blog/pg/dify-setup/#install">install</a> to finish the installation.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty   <span style="color:#8f5902;font-style:italic"># get pigsty source and entering dir</span>
</span></span><span style="display:flex;"><span>./bootstrap   <span style="color:#8f5902;font-style:italic"># download bootstrap pkgs &amp; ansible [optional]</span>
</span></span><span style="display:flex;"><span>./configure   <span style="color:#8f5902;font-style:italic"># pre-check and config templating   [optional]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># change pigsty.yml, adding those cluster definitions above into all.children </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>./install.yml <span style="color:#8f5902;font-style:italic"># install pigsty according to pigsty.yml</span>
</span></span></code></pre></div><p>You should insert the above PostgreSQL cluster and Redis cluster definitions into the <code>pigsty.yml</code> file, then run <a href="/docs/infra/#infrayml"><code>install.yml</code></a> to complete the installation.</p>
<p><strong>Redis Deploy</strong></p>
<p>Pigsty will not deploy redis in <code>install.yml</code>, so you have to run <a href="/zh/docs/redis#redisyml"><code>redis.yml</code></a> playbook to install Redis explicitly:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./redis.yml
</span></span></code></pre></div><p><strong>Docker Deploy</strong></p>
<p>Pigsty will not deploy Docker by default, so you need to install Docker with the <a href="/zh/docs/docker#dockeryml"><code>docker.yml</code></a> playbook.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./docker.yml
</span></span></code></pre></div><hr>
<h2 id="dify-confiugration">Dify Confiugration</h2>
<p>You can configure dify in the <a href="https://github.com/Vonng/pigsty/blob/main/app/dify/.env"><code>.env</code></a> file:</p>
<p>All parameters are self-explanatory and filled in with default values that work directly in the <a href="/docs/setup/provision/">Pigsty sandbox env</a>.
Fill in the database connection information according to your actual conf, consistent with the PG/Redis cluster configuration above.</p>
<p>Changing the <code>SECRET_KEY</code> field is recommended. You can generate a strong key with <code>openssl rand -base64 42</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># meta parameter</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DIFY_PORT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">8001</span> <span style="color:#8f5902;font-style:italic"># expose dify nginx service with port 8001 by default</span>
</span></span><span style="display:flex;"><span><span style="color:#000">LOG_LEVEL</span><span style="color:#ce5c00;font-weight:bold">=</span>INFO <span style="color:#8f5902;font-style:italic"># The log level for the application. Supported values are `DEBUG`, `INFO`, `WARNING`, `ERROR`, `CRITICAL`</span>
</span></span><span style="display:flex;"><span><span style="color:#000">SECRET_KEY</span><span style="color:#ce5c00;font-weight:bold">=</span>sk-9f73s3ljTXVcMT3Blb3ljTqtsKiGHXVcMT3BlbkFJLK7U <span style="color:#8f5902;font-style:italic"># A secret key for signing and encryption, gen with `openssl rand -base64 42`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># postgres credential</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PG_USERNAME</span><span style="color:#ce5c00;font-weight:bold">=</span>dbuser_dify
</span></span><span style="display:flex;"><span><span style="color:#000">PG_PASSWORD</span><span style="color:#ce5c00;font-weight:bold">=</span>DBUser.Dify
</span></span><span style="display:flex;"><span><span style="color:#000">PG_HOST</span><span style="color:#ce5c00;font-weight:bold">=</span>10.10.10.10
</span></span><span style="display:flex;"><span><span style="color:#000">PG_PORT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">5432</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PG_DATABASE</span><span style="color:#ce5c00;font-weight:bold">=</span>dify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># redis credential</span>
</span></span><span style="display:flex;"><span><span style="color:#000">REDIS_HOST</span><span style="color:#ce5c00;font-weight:bold">=</span>10.10.10.10
</span></span><span style="display:flex;"><span><span style="color:#000">REDIS_PORT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">6379</span>
</span></span><span style="display:flex;"><span><span style="color:#000">REDIS_USERNAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">REDIS_PASSWORD</span><span style="color:#ce5c00;font-weight:bold">=</span>redis.dify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># minio/s3 [OPTIONAL] when STORAGE_TYPE=s3</span>
</span></span><span style="display:flex;"><span><span style="color:#000">STORAGE_TYPE</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87">local</span>
</span></span><span style="display:flex;"><span><span style="color:#000">S3_ENDPOINT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;https://sss.pigsty&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">S3_BUCKET_NAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;infra&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">S3_ACCESS_KEY</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;dba&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">S3_SECRET_KEY</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;S3User.DBA&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">S3_REGION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;us-east-1&#39;</span>
</span></span></code></pre></div><p>Now we can pull up dify with docker compose:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> pigsty/app/dify <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> make up
</span></span></code></pre></div><hr>
<h2 id="expose-dify-service-via-nginx">Expose Dify Service via Nginx</h2>
<p>Dify expose web/api via its own nginx through port 80 by default, while pigsty uses port 80 for its own Nginx. T</p>
<p>herefore, we expose Dify via port <code>8001</code> by default, and use Pigsty&rsquo;s Nginx to forward to this port.</p>
<p>Change <code>infra_portal</code> in <code>pigsty.yml</code>, with the new <code>dify</code> line:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">infra_portal</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># domain names and upstream servers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">home         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">h.pigsty }</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">grafana      </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: g.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3000&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">prometheus   </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: p.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9090&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">alertmanager </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: a.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9093&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">blackbox     </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:9115&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">loki         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${admin_ip}:3100&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">dify         </span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">domain: dify.pigsty ,endpoint</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;10.10.10.10:8001&#34;</span><span style="color:#204a87;font-weight:bold">, websocket</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Then expose dify web service via Pigsty&rsquo;s Nginx server:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./infra.yml -t nginx
</span></span></code></pre></div><p>Don&rsquo;t forget to add <code>dify.pigsty</code> to your DNS or local <code>/etc/hosts</code> / <code>C:\Windows\System32\drivers\etc\hosts</code> to access via domain name.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7b7e2fed3610aaf3b302a1fa64530049">PGCon.Dev 2024, The conf that shutdown PG for a week</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com">Ruohang Feng</a>(<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/dW3byoQkEIR0_EzWxobrWg">Wechat Column</a></b> |
        
		<time datetime="2024-06-17" class="text-muted">2024-06-17</time>
        
	</div>
	<p>PGCon.Dev, once known as PGCon—the annual must-attend gathering for PostgreSQL hackers and key forum for its future direction, has been held in Ottawa since its inception in 2007.</p>
<p>This year marks a new chapter as the original organizer, Dan, hands over the reins to a new team, and the event moves to SFU&rsquo;s Harbour Centre in Vancouver, kicking off a new era with grandeur.</p>
<p>How engaging was this event? <a href="https://peter.eisentraut.org/">Peter Eisentraut</a>, member of the PostgreSQL core team, noted that during PGCon.Dev, <a href="https://peter.eisentraut.org/blog/2024/06/04/how-engaging-was-pgconfdev-really">there were no code commits to PostgreSQL</a> &ndash; resulting in the longest pause in twenty years, a whopping week! a historic coding ceasefire! Why? Because all the developers were at the conference!</p>
<p><img alt="intro.png" src="/zh/blog/pg/pgcondev-2024/intro.png"></p>
<blockquote>
<p>Considering the last few interruptions that occurred in the early days of the project twenty years ago,</p>
</blockquote>
<p>I’ve been embracing PostgreSQL for a decade, but attending a global PG Hacker conference in person was a first for me, and I’m immensely grateful for the organizer&rsquo;s efforts.
PGCon.Dev 2024 wrapped up on May 31st, though this post comes a bit delayed as I’ve been exploring Vancouver and Banff National Park ;)</p>
<hr>
<h2 id="day-zero-extension-summit">Day Zero: Extension Summit</h2>
<p>Day zero is for leadership meetings, and I&rsquo;ve signed up for the afternoon&rsquo;s Extension Ecosystem Summit.</p>
<p>Maybe this summit is somewhat subtly related to my recent post, &ldquo;<a href="https://medium.com/@fengruohang/postgres-is-eating-the-database-world-157c204dcfc4">Postgres is eating the database world</a>,&rdquo;  highlighting PostgreSQL&rsquo;s thriving extension ecosystem as a unique and critical success factor and drawing the community&rsquo;s attention.</p>
<p><a href="https://medium.com/@fengruohang/postgres-is-eating-the-database-world-157c204dcfc4"><img alt="ecosystem.jpg" src="/zh/blog/pg/pgcondev-2024/ecosystem.jpg"></a></p>
<p>I participated in David Wheeler&rsquo;s Binary Packing session along with other PostgreSQL community leaders. Despite some hesitation to new standards like PGXN v2 from current RPM/APT maintainers.
In the latter half of the summit, I attended a session led by Yurii Rashkovskii, discussing extension directory structures, metadata, naming conflicts, version control, and binary distribution ideas.</p>
<p><img alt="extension-summit.jpg" src="/zh/blog/pg/pgcondev-2024/extension-summit.jpg"></p>
<p>Prior to this summit, the PostgreSQL community had held <a href="https://www.eventbrite.com/e/postgres-extension-ecosystem-mini-summit-tickets-851127263557">six mini-summits</a> discussing these topics intensely, with visions for the extension ecosystem&rsquo;s future development shared by various speakers. Recordings of these sessions are available on <a href="https://www.youtube.com/playlist?list=PL11N188AYb_aT6ulbJfrQJJziWb012jG3">YouTube</a>.</p>
<p>And after the summit, I had a chance to chat with Devrim, the RPM maintainer, about extension packing, which was quite enlightening.</p>
<p><img src="/zh/blog/pg/pgcondev-2024/devrim-keith.gif"></p>
<blockquote>
<p>&ldquo;Keith Fan Group&rdquo; &ndash; from Devrim on Extension Summit</p>
</blockquote>
<hr>
<h2 id="day-one-brilliant-talks-and-bar-social">Day One: Brilliant Talks and Bar Social</h2>
<p>The core of PGCon.Dev lies in its sessions. Unlike some China domestic conferences with mundane product pitches or irrelevant tech details, PGCon.Dev presentations are genuinely engaging and substantive. The official program kicked off on May 29th, after a day of closed-door leadership meetings and the Ecosystem Summit on the 28th.</p>
<p>The opening was co-hosted by <a href="https://jkatz05.com/">Jonathan Katz</a>, 1 of the 7 core PostgreSQL team members and a chief product manager at AWS RDS, and <a href="https://postgresql.life/post/melanie_plageman/">Melanie Plageman</a>, a recent PG committer from Microsoft. A highlight was when Andres Freund, the developer who uncovered the famous <code>xz</code> backdoor, was celebrated as a superhero on stage.</p>
<p><img alt="andres-hero.jpeg" src="/zh/blog/pg/pgcondev-2024/andres-hero.jpeg"></p>
<p>Following the opening, the regular session tracks began. Although conference videos aren&rsquo;t out yet, I&rsquo;m confident they&rsquo;ll &ldquo;soon&rdquo; be available on YouTube. Most sessions had three tracks running simultaneously; here are some highlights I chose to attend.</p>
<hr>
<h3 id="pushing-the-boundaries-of-pg-extensions">Pushing the Boundaries of PG Extensions</h3>
<p>Yurii&rsquo;s talk, &ldquo;<a href="https://slides.omnigr.es/pushing-boundaries-pgconfdev2024/1">Pushing the Boundaries of PG Extensions</a>,&rdquo; tackled what kind of extension APIs PostgreSQL should offer. PostgreSQL boasts robust extensibility, but the current extension API set is decades old, from the 9.x era. Yurii&rsquo;s proposal aims to address issues with the existing extension mechanisms. Challenges such as installing multiple versions of an extension simultaneously, avoiding database restarts post-extension installations, managing extensions as seamlessly as data, and handling dependencies among extensions were discussed.</p>
<p>Yurii and Viggy, founders of <a href="https://omnigres.com/">Omnigres</a>, aim to transform PostgreSQL into a full-fledged application development platform, including hosting HTTP servers directly within the database. They designed a new extension API and management system for PostgreSQL to achieve this. Their innovative improvements represent the forefront of exploration into PostgreSQL&rsquo;s core extension mechanisms.</p>
<p><img alt="yurii-extension.png" src="/zh/blog/pg/pgcondev-2024/yurii-extension.png"></p>
<p>I had a great conversation with Viggy and Yurii. Yurii walked me through compiling and installing Omni. I plan to support the Omni extension series in the next version of Pigsty, making this powerful application development framework plug-and-play.</p>
<hr>
<h3 id="anarchy-in-dbms">Anarchy in DBMS</h3>
<p>Abigale Kim from CMU, under the mentorship of celebrity professor Andy Pavlo, delivered the talk &ldquo;<a href="https://abigalekim.github.io/assets/pdf/Anarchy_in_the_Database_PGConfDev2024.pdf">Anarchy in the Database—A Survey and Evaluation of DBMS Extensibility</a>.&rdquo; This topic intrigued me since Pigsty&rsquo;s primary value proposition is about PostgreSQL&rsquo;s <a href="https://pigsty.io/docs/reference/extension/"><strong>extensibility</strong></a>.</p>
<p>Kim’s research revealed interesting insights: <strong>PostgreSQL is the most extensible DBMS</strong>, supporting 9 out of 10 extensibility points, closely followed by DuckDB. With over 375+ available extensions, PostgreSQL significantly outpaces other databases.</p>
<p><img alt="kim-extensibility.png" src="/zh/blog/pg/pgcondev-2024/kim-extensibility.png"></p>
<p>Kim&rsquo;s quantitative analysis of compatibility levels among these extensions resulted in a compatibility matrix, unveiling conflicts—most notably, powerful extensions like TimescaleDB and Citus are prone to clashes. This information is very valuable for users and distribution maintainers. <a href="https://abigalekim.github.io/assets/pdf/Anarchy_in_the_Database_PGConfDev2024.pdf">Read the detailed study</a>.</p>
<p>I joked with Kim that — now I could brag about PostgreSQL&rsquo;s extensibility with her research data.</p>
<hr>
<h3 id="how-postgresql-is-misused-and-abused">How PostgreSQL is Misused and Abused</h3>
<p>The first-afternoon session featured <a href="https://postgresql.life/post/karen_jex/">Karen Jex</a> from CrunchyData, an unusual perspective from a user — and a female DBA. Karen shared common blunders by PostgreSQL beginners. While I knew all of what was discussed, it reaffirmed that beginners worldwide make similar mistakes — an enlightening perspective for PG Hackers, who found the session quite engaging.</p>
<h3 id="postgresql-and-the-ai-ecosystem">PostgreSQL and the AI Ecosystem</h3>
<p>The second-afternoon session by <a href="https://postgresql.life/post/bruce_momjian/">Bruce Momjian</a>, co-founder of the PGDG and a core committee member from the start, was unexpectedly about using PostgreSQL&rsquo;s multi-dimensional arrays and queries to implement <a href="https://momjian.us/main/writings/pgsql/AI.pdf">neural network inference and training</a>.</p>
<p><img alt="bruce-ai.png" src="/zh/blog/pg/pgcondev-2024/bruce-ai.png"></p>
<blockquote>
<p>Haha, some ArgParser code. I see it</p>
</blockquote>
<p>During the lunch, Bruce explained that Jonathan Katz needed a topic to introduce the vector database extension PGVector in the PostgreSQL ecosystem, so Bruce was roped in to &ldquo;fill the gap.&rdquo; <a href="/">Check out Bruce’s presentation</a>.</p>
<h3 id="pb-level-postgresql-deployments">PB-Level PostgreSQL Deployments</h3>
<p>The third afternoon session by <a href="https://postgresql.life/post/chris_travers/">Chris Travers</a> discussed their transition from using ElasticSearch for data storage—with a poor experience and high maintenance for 1PB over 30 days retention, to a horizontally scaled PostgreSQL cluster perfectly <a href="https://www.pgevents.ca/events/pgconfdev2024/sessions/session/135/slides/30/">handling 10PB of data</a>. Normally, PostgreSQL comfort levels on a single machine range from several dozen to a few hundred TB. Deployments at the PB scale, especially at 10PB, even within a horizontally scaled cluster, are exceptionally rare. While the practice itself is standard—partitioning and sharding—the scale of data managed is truly impressive.</p>
<hr>
<h3 id="highlight-when-hardware-and-database-collide">Highlight: When Hardware and Database Collide</h3>
<p>Undoubtedly, the standout presentation of the event, Margo Seltzer&rsquo;s talk &ldquo;<a href="https://www.pgevents.ca/events/pgconfdev2024/schedule/session/192-keynote-when-hardware-and-databases-collide/">When Hardware and Database Collide</a>&rdquo; was not only the most passionate and compelling talk I&rsquo;ve attended live but also a highlight across all conferences.</p>
<p>Professor Margo Seltzer, formerly of Harvard and now at UBC, a member of the National Academy of Engineering and the creator of BerkeleyDB, delivered a powerful discourse on the core challenges facing databases today. She pinpointed that the bottleneck for databases has shifted from disk I/O to main memory speed. Emerging hardware technologies like <strong>HBM</strong> and <strong>CXL</strong> could be the solution, posing new challenges for PostgreSQL hackers to tackle.</p>
<p><img alt="margo.png" src="/zh/blog/pg/pgcondev-2024/margo.png"></p>
<p>This was a refreshing divergence from China&rsquo;s typically monotonous academic talks, leaving a profound impact and inspiration. Once the conference video is released, I highly recommend checking out her energizing presentation.</p>
<hr>
<h3 id="wetbar-social">WetBar Social</h3>
<p>Following Margo&rsquo;s session, the official Social Event took place at Rogue Kitchen &amp; Wetbar, just a street away from the venue at Waterfront Station, boasting views of the Pacific and iconic Vancouver landmarks.</p>
<p>The informal setting was perfect for engaging with new and old peers. Conversations with notable figures like Devrim, Tomasz, Yurii, and Keith were particularly enriching. As an RPM maintainer, I had an extensive and fruitful discussion with Devrim, resolving many longstanding queries.</p>
<p><img alt="social-bar.png" src="/zh/blog/pg/pgcondev-2024/social-bar.png"></p>
<p>The atmosphere was warm and familiar, with many reconnecting after long periods. A couple of beers in, conversations flowed even more freely among fellow PostgreSQL enthusiasts. The event concluded with an invitation from Melanie for a board game session, which I regretfully declined due to my limited English in such interactive settings.</p>
<hr>
<h2 id="day-2-debate-lunch-and-lighting-talks">Day 2: Debate, Lunch, and Lighting Talks</h2>
<h3 id="multi-threading-postgres">Multi-Threading Postgres</h3>
<p>The warmth from the previous night&rsquo;s socializing carried over into the next day, marked by the eagerly anticipated session on &ldquo;<strong>Multi-threaded PostgreSQL</strong>,&rdquo; which was packed to capacity. The discussion, initiated by Heikki, centered on the pros and cons of PostgreSQL&rsquo;s process and threading models, along with detailed implementation plans and current progress.</p>
<p>The threading model promises numerous benefits: cheaper connections (akin to a built-in connection pool), shared relation and plan caches, dynamic adjustment of shared memory, config changes without restarts, more aggressive Vacuum operations, runtime Explain Analyze, and easier memory usage limits per connection. However, there&rsquo;s significant opposition, maybe led by Tom Lane, concerned about potential bugs, loss of isolation benefits from the multi-process model, and extensive incompatibilities requiring many extensions to be rewritten.</p>
<p><img alt="heikki-multithread.png" src="/zh/blog/pg/pgcondev-2024/heikki-multithread.png"></p>
<p>Heikki laid out a detailed plan to transition to the threading model over five to seven years, aiming for a seamless shift without intermediate states. Intriguingly, he cited Tom Lane&rsquo;s critical comment in his presentation:</p>
<blockquote>
<p>For the record, I think this will be a disaster. There is far too much code that will get broken, largely silently, and much of it is not under our control. &ndash; regards, tom lane</p>
</blockquote>
<p>Although Tom Lane smiled benignly without voicing any objections, the strongest dissent at the conference came not from him but from an extension maintainer. The elder developer, who maintained several extensions, raised concerns about compatibility, specifically regarding memory allocation and usage. Heikki suggested that extension authors should adapt their work to a new model during a transition grace period of about five years. This suggestion visibly upset the maintainer, who left the meeting in anger.</p>
<p>Given the proposed threading model&rsquo;s significant impact on the existing extension ecosystem, I&rsquo;m skeptical about this change. At the conference, I consulted on the threading model with Heikki, Tom Lane, and other hackers. The community&rsquo;s overall stance is one of curious &amp; cautious observation. So far, the only progress is in PG 17, where the fork-exec-related code has been refactored and global variables marked for future modifications. Any real implementation would likely not occur until at least PG 20+.</p>
<hr>
<h3 id="hallway-track">Hallway Track</h3>
<p>The sessions on the second day were slightly less intense than the first, so many attendees chose the &ldquo;Hallway Track&rdquo;—engaging in conversations in the corridors and lobby. I&rsquo;m usually not great at networking as an introvert, but the vibrant atmosphere quickly drew me in. Eye contact alone was enough to spark conversations, like triggering NPC dialogue in an RPG. I also managed to subtly promote Pigsty to every corner of the PG community.</p>
<p><img alt="hallway-track.jpg" src="/zh/blog/pg/pgcondev-2024/hallway-track.jpg"></p>
<p>Despite being a first-timer at PGCon.Dev, I was surprised by the recognition and attention I received, largely thanks to the widely read article, &ldquo;<a href="https://medium.com/@fengruohang/postgres-is-eating-the-database-world-157c204dcfc4">PostgreSQL is eating the Database world</a>.&rdquo; Many recognized me by my badge <a href="https://vonng.com/en/">Vonng</a> / <a href="https://pigsty.io">Pigsty</a>.</p>
<p>A simple yet effective networking trick is never to underestimate small gifts&rsquo; effect. I handed out gold-plated Slonik pins, PostgreSQL&rsquo;s mascot, which became a coveted item at the conference. Everyone who talked with me received one, and those who didn&rsquo;t have one were left asking where to get one. LOL</p>
<p><img alt="collect.png" src="/zh/blog/pg/pgcondev-2024/collect.png"></p>
<p>Anyway, I&rsquo;m glad to have made many new friends and connections.</p>
<hr>
<h3 id="multinational-community-lunch">Multinational Community Lunch</h3>
<p>As for lunch, HighGo hosted key participants from the American, European, Japanese, and Chinese PostgreSQL communities at a Cantonese restaurant in Vancouver. The conversation ranged from serious technical discussions to lighter topics. I&rsquo;ve made acquaintance with Tatsuro Yamada, who gives a talk, &ldquo;<a href="https://www.pgevents.ca/events/pgconfdev2024/schedule/session/62-advice-is-seldom-welcome-but-efficacious/">Advice is seldom welcome but efficacious</a>&rdquo;, and Kyotaro Horiguchi, a core contributor to PostgreSQL known for his work on WAL replication and multibyte string processing and the author of pg_hint_plan.</p>
<p><img alt="lunch.jpeg" src="/zh/blog/pg/pgcondev-2024/lunch.jpeg"></p>
<p>Another major contributor to the PostgreSQL community, <strong>Mark Wong</strong> organizes PGUS and has developed a series of PostgreSQL monitoring extensions. He also manages community merchandise like contributor coins, shirts, and stickers. He even handcrafted a charming yarn elephant mascot, which was so beloved that one was sneakily &ldquo;borrowed&rdquo; at the last PG Conf US.</p>
<p><img alt="elephant.png" src="/zh/blog/pg/pgcondev-2024/elephant.png"></p>
<p>Bruce, already a familiar face in the PG Chinese community, Andreas Scherbaum from Germany, organizer of the European PG conferences, and Miao Jian, founder of Han Gao, representing the only Chinese database company at PGCon.Dev, all shared insightful stories and discussions about the challenges and nuances of developing databases in their respective regions.</p>
<p>On returning to the conference venue, I had a conversation with <a href="https://www.crunchydata.com/news/jan-wieck-former-postgres-core-team-member-joins-crunchy-data">Jan Wieck</a>, a PostgreSQL Hackers Emeritus. He shared his story of participating in the PostgreSQL project from the early days and encouraged me to get more involved in the PostgreSQL community, reminding me its future depends on the younger generation.</p>
<hr>
<h3 id="making-pg-hacking-more-inclusive">Making PG Hacking More Inclusive</h3>
<p>At PGCon.Dev, a special session on community building chaired by Robert Hass, featured three new PostgreSQL contributors sharing their journey and challenges, notably the barriers for non-native English speakers, timezone differences, and emotionally charged email communications.</p>
<p>Robert emphasized in a post-conference blog <a href="https://rhaas.blogspot.com/2024/06/2024pgconfdev-and-growing-community.html">his desire to see more developers from India and Japan rise to senior positions within PostgreSQL&rsquo;s ranks</a>, noting the underrepresentation from these countries despite their significant developer communities.</p>
<blockquote>
<p>While we&rsquo;re at it, I&rsquo;d really like to see more people from India and Japan in senior positions within the project. We have very large developer communities from both countries, but there is no one from either of those countries on the core team, and they&rsquo;re also underrepresented in other senior positions. At the risk of picking specific examples to illustrate a general point, there is no one from either country on the infrastructure team or the code of conduct committee. We do have a few committers from those countries, which is very good, and I was pleased to see Amit Kapila on the 2024.pgconf.dev organizing commitee, but, overall, I think we are still not where we should be. Part of getting people involved is making them feel like they are not alone, and part of it is also making them feel like progression is possible. Let&rsquo;s try harder to do that.</p>
</blockquote>
<p>Frankly, the lack of mention of China in discussions about inclusivity at PGCon.Dev, in favor of India and Japan, left a bittersweet taste. But I think China deserves the snub, given its poor international community engagement.</p>
<p>China has hundreds of &ldquo;domestic/national&rdquo; databases, many mere forks of PostgreSQL, yet there&rsquo;s only a single notable Chinese contributor to PostgreSQL is Richard Guo from PieCloudDB, recently promoted to PG Committer.
At the conference, the Chinese presence was minimal, summing up to five attendees, including myself. It&rsquo;s regrettable that China&rsquo;s understanding and adoption of PostgreSQL lag behind the global standard by about 10-15 years.</p>
<p>I hope my involvement can bootstrap and enhance Chinese participation in the global PostgreSQL ecosystem, making their users, developers, products, and open-source projects more recognized and accepted worldwide.</p>
<hr>
<h3 id="lightning-talks">Lightning Talks</h3>
<p>Yesterday’s event closed with a series of lightning talks—5 minutes max per speaker, or you&rsquo;re out. Concise and punchy, the session wrapped up 11 topics in just 45 minutes. Keith shared improvements to PG Monitor, and Peter Eisentraut discussed SQL standard updates. But from my perspective, the highlight was Devrim Gündüz&rsquo;s talk on PG RPMs, which lived up to his promise of a &ldquo;big reveal&rdquo; made at the bar the previous night, packing a 75-slide presentation into 5 lively minutes.</p>
<p><img alt="devrim.png" src="/zh/blog/pg/pgcondev-2024/devrim.png"></p>
<p>Speaking of PostgreSQL, despite being open-source, most users rely on official pre-compiled binaries packages rather than building from source. I maintain 34 RPM extensions for <a href="https://pigsty.io">Pigsty</a>, my Postgres distribution, but much of the ecosystem, including over a hundred other extensions, is managed by Devrim from the official PGDG repo. His efforts ensure quality for the world’s most advanced and popular database.</p>
<p>Devrim is a fascinating character — a Turkish native living in London, a part-time DJ, and the maintainer of the PGDG RPM repository, sporting a PostgreSQL logo tattoo. After an engaging chat about the PGDG repository, he shared insights on how extensions are added, highlighting the community-driven nature of PGXN and recent popular additions like <code>pgvector</code>, (<a href="https://github.com/pgvector/pgvector/issues/76">which I made the suggestion haha</a>).</p>
<p>Interestingly, with the latest Pigsty v2.7 release, four of my maintained (packaging) extensions (<code>pgsql-http</code>, <code>pgsql-gzip</code>, <code>pg_net</code>, <code>pg_bigm</code>) were adopted into the PGDG official repository. Devrim admitted to scouring Pigsty&rsquo;s <a href="/docs/reference/extension/">extension list</a> for good picks, though he humorously dismissed any hopes for my Rust pgrx extensions making the cut, reaffirming his commitment to not blending Go and Rust plugins into the official repository. Our conversation was so enriching that I&rsquo;ve committed myself to becoming a &ldquo;PG Extension Hunter,&rdquo; scouting and recommending new plugins for official inclusion.</p>
<hr>
<h2 id="day-3-unconference">Day 3: Unconference</h2>
<p>One of the highlights of PGCon.Dev is the Unconference, a self-organized meeting with no predefined agenda, driven by attendee-proposed topics. On day three, Joseph Conway facilitated the session where anyone could pitch topics for discussion, which were then voted on by participants. My proposal for a <strong>Built-in Prometheus Metrics Exporter</strong> was merged into a broader <strong>Observability</strong> topic spearheaded by Jeremy.</p>
<p><img alt="unconference.png" src="/zh/blog/pg/pgcondev-2024/unconference.png"></p>
<p>The top-voted topics were Multithreading (42 votes), Observability (35 votes), and Enhanced Community Engagement (35 votes). Observability features were a major focus, reflecting the community&rsquo;s priority. I proposed integrating a contrib monitoring extension in PostgreSQL to directly expose metrics via HTTP endpoint, using <code>pg_exporter</code> as a blueprint but embedded to overcome the limitations of external components, especially during crash recovery scenarios.</p>
<p><img alt="unconference2.png" src="/zh/blog/pg/pgcondev-2024/unconference2.png"></p>
<p>There&rsquo;s a clear focus on observability among the community. As the author of <a href="https://github.com/Vonng/pg_exporter">pg_exporter</a>, I proposed developing a first-party monitoring extension. This extension would integrate Prometheus monitoring endpoints directly into PostgreSQL, exposing metrics via HTTP without needing external components.</p>
<p>The rationale for this proposal is straightforward. While <code>pg_exporter</code> works well, it&rsquo;s an external component that adds management complexity. Additionally, in scenarios where PostgreSQL is recovering from a crash and cannot accept new connections, external tools struggle to access internal states. An in-kernel extension could seamlessly capture this information.</p>
<p>The suggested implementation involves a background worker process similar to the <code>bgw_replstatus</code> extension. This process would listen on an additional port to expose monitoring metrics through HTTP, using pg_exporter as a blueprint. Metrics would primarily be defined via a Collector configuration table, except for a few critical system indicators.</p>
<p>This idea garnered attention from several PostgreSQL hackers at the event. Developers from EDB and CloudNativePG are evaluating whether <a href="https://github.com/Vonng/pg_exporter"><code>pg_exporter</code></a> could be directly integrated into their distributions as part of their monitoring solutions. And finally, an Observability Special Interest Group (SIG) was formed by attendees interested in observability, planning to continue discussions through a mailing list.</p>
<hr>
<h3 id="issue-support-for-loongarch-architecture">Issue: Support for LoongArch Architecture</h3>
<p>During the last two days, I have had some discussions with PG Hackers about some Chinese-specific issues.</p>
<p>A notable suggestion was supporting the LoongArch architecture in the PGDG global repository, which was backed by some enthusiastically local chip and OS manufacturers. Despite the interest, Devrim indicated a &ldquo;No&rdquo; due to the lack of support for LoongArch in OS Distro used in the PG community, like CentOS 7, Rocky 8/9, and Debian 10/11/12. Tomasz Rybak was more receptive, noting potential future support if LoongArch runs on Debian 13.</p>
<p>In summary, official PG RPMs might not yet support LoongArch, but APT has a chance, contingent on broader OS support for mainstream open-source Linux distributions.</p>
<hr>
<h3 id="issue-server-side-chinese-character-encoding">Issue: Server-side Chinese Character Encoding</h3>
<p>At the recent conference, Jeremy Schneider presented an insightful talk on collation rules that resonated with me. He highlighted the pitfalls of not using C.UTF8 for collation, a practice I&rsquo;ve advocated for based on my own <a href="https://pigsty.cc/zh/blog/admin/collate/">research</a>, and which is detailed in his presentation here.</p>
<p>Post-talk, I discussed further with Jeremy and Peter Eisentraut the nuances of character sets in China, especially the challenges posed by the mandatory <strong>GB18030</strong> standard, which PostgreSQL can handle on the client side but not the server side. Also, there are some issues about 20 Chinese characters not working on the <code>convert_to</code> + <code>gb18030</code> encoding mapping.</p>
<hr>
<h3 id="closing">Closing</h3>
<p>The event closed with Jonathan Katz and Melanie Plageman wrapping up an exceptional conference that leaves us looking forward to next year&rsquo;s PGCon.Dev 2025 in Canada, possibly in Vancouver, Toronto, Ottawa, or Montreal.</p>
<p><img alt="closing.jpeg" src="/zh/blog/pg/pgcondev-2024/closing.jpeg"></p>
<p>Inspired by the engagement at this conference, I&rsquo;m considering presenting on Pigsty or PostgreSQL observability next year.</p>
<hr>
<p>Notably, following the conference, Pigsty&rsquo;s international CDN traffic spiked significantly, highlighting the growing global reach of our PostgreSQL distribution, which really made my day.</p>
<p><a href="https://pigsty.io/"><img alt="pigsty-traffic-en.png" src="/zh/blog/pg/pgcondev-2024/pigsty-traffic-en.png"></a></p>
<blockquote>
<p>Pigsty CDN Traffic Growth after PGCon.Dev 2024</p>
</blockquote>
<hr>
<p>Some slides are <a href="https://www.pgevents.ca/events/pgconfdev2024/sessions/">available</a> on the official site, and some blog posts about PGCon are here.Dev 2024:</p>
<ul>
<li>
<p><a href="https://andreas.scherbaum.la/post/2024-06-14_postgresql-development-conference-2024-review/">Andreas Scherbaum PostgreSQL Development Conference 2024 - Review</a></p>
</li>
<li>
<p><a href="https://wiki.postgresql.org/wiki/PgCon_2024_Developer_Meeting">PgCon 2024 Developer Meeting</a></p>
</li>
<li>
<p><a href="https://rhaas.blogspot.com/2024/06/2024pgconfdev-and-growing-community.html">Robert Haas: 2024.pgconf.dev and Growing the Community</a></p>
</li>
<li>
<p><a href="https://peter.eisentraut.org/blog/2024/06/04/how-engaging-was-pgconfdev-really">How engaging was PGConf.dev really?</a></p>
</li>
<li>
<p><a href="https://www.highgo.ca/2024/06/11/pgconf-dev-2024-shaping-the-future-of-postgresql-in-vancouver/">Cary Huang: PGConf.dev 2024：在温哥华塑造 PostgreSQL 的未来</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/C0YyE52KbLLbnG1C2FqGRg">PGCon.Dev 扩展生态峰会小记 @ 温哥华</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/4t1thBCDVS8y9dHiOxPZaA">PG大会2024开幕，温哥华饭搭子驴友团呢？</a></p>
</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7d36280c97d93954ecc5eee99cde64b7">Postgres is eating the database world</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com">Ruohang Feng</a>(<a href="https://vonng.com/en/">@Vonng</a>)| <a href="https://mp.weixin.qq.com/s/8_uhRH93oAoHZqoC90DA6g">WeChat</a> | <a href="https://medium.com/@fengruohang/postgres-is-eating-the-database-world-157c204dcfc4">Medium</a></b> |
        
		<time datetime="2024-03-04" class="text-muted">2024-03-04</time>
        
	</div>
	<p>PostgreSQL isn’t just a simple relational database; it’s a data management framework with the potential to engulf the entire database realm. The trend of “Using Postgres for Everything” is no longer limited to a few elite teams but is becoming a mainstream best practice.</p>
<hr>
<h2 id="olaps-new-challenger">OLAP&rsquo;s New Challenger</h2>
<p>In a 2016 database meetup, I argued that a significant gap in the PostgreSQL ecosystem was the lack of a <strong>sufficiently good</strong> columnar storage engine for OLAP workloads. While PostgreSQL itself offers lots of analysis features, its performance in full-scale analysis on larger datasets doesn’t quite measure up to dedicated real-time data warehouses.</p>
<p>Consider <a href="https://benchmark.clickhouse.com/">ClickBench</a>, an analytics performance benchmark, where we’ve documented the performance of PostgreSQL, its ecosystem extensions, and derivative databases. The untuned PostgreSQL performs poorly (<strong>x1050</strong>), but it can reach (<strong>x47</strong>) with optimization. Additionally, there are three analysis-related extensions: columnar store <strong>Hydra</strong> (<strong>x42</strong>), time-series <strong>TimescaleDB</strong> (<strong>x103</strong>), and distributed <strong>Citus</strong> (<strong>x262</strong>).</p>
<p><a href="https://benchmark.clickhouse.com/"><img alt="clickbench.png" src="/zh/blog/pg/pg-eat-db-world/clickbench-en.png"></a></p>
<blockquote>
<p>ClickBench c6a.4xlarge, 500gb gp2 results in relative time</p>
</blockquote>
<p>This performance can&rsquo;t be considered bad, especially compared to pure OLTP databases like MySQL and MariaDB (<strong>x3065, x19700</strong>); however, its third-tier performance is not &ldquo;good enough,&rdquo; lagging behind the first-tier OLAP components like Umbra, ClickHouse, Databend, SelectDB (<strong>x3~x4</strong>) by an order of magnitude. It&rsquo;s a tough spot - not satisfying enough to use, but too good to discard.</p>
<p>However, the arrival of <a href="https://www.paradedb.com/"><strong>ParadeDB</strong></a> and <a href="https://duckdb.org/"><strong>DuckDB</strong></a> changed the game!</p>
<p><strong>ParadeDB</strong>&rsquo;s native PG extension <strong>pg_analytics</strong> achieves second-tier performance (<strong>x10</strong>), narrowing the gap to the top tier to just 3–4x. Given the additional benefits, this level of performance discrepancy is often acceptable - ACID, freshness and real-time data without ETL, no additional learning curve, no maintenance of separate services, not to mention its ElasticSearch grade full-text search capabilities.</p>
<p><strong>DuckDB</strong> focuses on pure OLAP, pushing analysis performance to the extreme (<strong>x3.2</strong>) — excluding the academically focused, closed-source database Umbra, DuckDB is arguably the fastest for practical OLAP performance. It’s not a PG extension, but PostgreSQL can fully leverage DuckDB’s analysis performance boost as an embedded file database through projects like <a href="https://github.com/alitrack/duckdb_fdw"><strong>DuckDB FDW</strong></a> and <a href="https://github.com/hydradatabase/pg_quack"><strong>pg_quack</strong></a>.</p>
<p>The emergence of ParadeDB and DuckDB propels PostgreSQL&rsquo;s analysis capabilities to the top tier of OLAP, filling the last crucial gap in its analytic performance.</p>
<hr>
<h2 id="the-pendulum-of-database-realm">The Pendulum of Database Realm</h2>
<p>The distinction between OLTP and OLAP didn’t exist at the inception of databases. The separation of OLAP data warehouses from databases emerged in the 1990s due to traditional OLTP databases struggling to support analytics scenarios&rsquo; query patterns and performance demands.</p>
<p>For a long time, best practice in data processing involved using MySQL/PostgreSQL for OLTP workloads and syncing data to specialized OLAP systems like Greenplum, ClickHouse, Doris, Snowflake, etc., through ETL processes.</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 735px">
<img class="card-img-top" src="/zh/blog/pg/pg-eat-db-world/ddia_hu04f70ed29e59e1b4862c5f1df5de3cec_998548_768x512_fit_catmullrom_3.png" width="725" height="512">
</figure>
<blockquote>
<p>DDIA, Martin Kleppmann, ch3, The republic of OLTP &amp; Kingdom of OLAP</p>
</blockquote>
<p>Like many &ldquo;specialized databases,&rdquo; the strength of dedicated OLAP systems often lies in <strong>performance</strong> — achieving 1-3 orders of magnitude improvement over native PG or MySQL. The <strong>cost</strong>, however, is redundant data, excessive data movement, lack of agreement on data values among distributed components, extra labor expense for specialized skills, extra licensing costs, limited query language power, programmability and extensibility, limited tool integration, poor data integrity and availability compared with a complete DMBS.</p>
<p>However, as the saying goes, &ldquo;What goes around comes around&rdquo;. With <a href="/blog/cloud/bonus/">hardware improving over thirty years following Moore&rsquo;s Law</a>, performance has increased exponentially while costs have plummeted. In 2024, a single x86 machine can have hundreds of cores (512 vCPU <a href="https://www.amd.com/zh-hans/products/cpu/amd-epyc-9754">EPYC 9754</a>x2), several TBs of RAM, a single NVMe SSD can hold up to 64TB, and a single all-flash rack can reach 2PB; object storage like S3 offers virtually unlimited storage.</p>
<p><a href="/blog/cloud/bonus/"><img alt="io-bandwidth.png" src="/zh/blog/pg/pg-eat-db-world/io-bandwidth.png"></a></p>
<p>Hardware advancements have solved the data volume and performance issue, while database software developments (PostgreSQL, ParadeDB, DuckDB) have addressed access method challenges. This puts the fundamental assumptions of the analytics sector — the so-called “big data” industry — under scrutiny.</p>
<p>As DuckDB&rsquo;s manifesto <a href="https://motherduck.com/blog/big-data-is-dead/">&quot;<strong>Big Data is Dead</strong>&quot;</a> suggests, <strong>the era of big data is over</strong>. Most people don&rsquo;t have that much data, and most data is seldom queried. The frontier of big data recedes as hardware and software evolve, rendering &ldquo;big data&rdquo; unnecessary for 99% of scenarios.</p>
<p>If 99% of use cases can now be handled on a single machine with standalone DuckDB or PostgreSQL (and its replicas), what&rsquo;s the point of using dedicated analytics components? If every smartphone can send and receive texts freely, what&rsquo;s the point of pagers? (With the caveat that North American hospitals still use pagers, indicating that maybe less than 1% of scenarios might genuinely need &ldquo;big data.&rdquo;)</p>
<p>The shift in fundamental assumptions is steering the database world from a phase of diversification back to convergence, from a big bang to a mass extinction. In this process, a new era of unified, multi-modeled, super-converged databases will emerge, reuniting OLTP and OLAP. But who will lead this monumental task of reconsolidating the database field?</p>
<hr>
<h2 id="postgresql-the-database-world-eater">PostgreSQL: The Database World Eater</h2>
<p>There are a plethora of niches in the database realm: time-series, geospatial, document, search, graph, vector databases, message queues, and object databases. PostgreSQL makes its presence felt across all these domains.</p>
<p>A case in point is the PostGIS extension, which sets the de facto standard in geospatial databases; the TimescaleDB extension awkwardly positions “generic” time-series databases; and the vector extension, <strong>PGVector</strong>, turns the dedicated vector database niche into a punchline.</p>
<p>This isn’t the first time; we’re witnessing it again in the oldest and largest subdomain: OLAP analytics. But PostgreSQL’s ambition doesn’t stop at OLAP; it’s eyeing the entire database world!</p>
<p><a href="/docs/reference/extension/"><img alt="ecosystem.jpg" src="/zh/blog/pg/pg-eat-db-world/ecosystem.jpg"></a></p>
<p>What makes PostgreSQL so capable? Sure, it&rsquo;s advanced, but so is Oracle; it&rsquo;s open-source, as is MySQL. PostgreSQL&rsquo;s edge comes from being <strong>both advanced and open-source</strong>, allowing it to compete with Oracle/MySQL. But its true uniqueness lies in its <strong>extreme extensibility and thriving extension ecosystem</strong>.</p>
<p><a href="https://www.timescale.com/state-of-postgres/2022/"><img alt="survey.png" src="/zh/blog/pg/pg-eat-db-world/survey.png"></a></p>
<blockquote>
<p>TimescaleDB survey: <a href="https://www.timescale.com/state-of-postgres/2022/">what is the main reason you choose to use PostgreSQL</a></p>
</blockquote>
<p>PostgreSQL isn’t just a relational database; it’s a data management framework capable of engulfing the entire database galaxy. Besides being open-source and advanced, its core competitiveness stems from <strong>extensibility</strong>, i.e., its infra’s reusability and extension&rsquo;s composability.</p>
<hr>
<h3 id="the-magic-of-extreme-extensibility">The Magic of Extreme Extensibility</h3>
<p>PostgreSQL allows users to develop extensions, leveraging the database&rsquo;s common infra to deliver features at minimal cost. For instance, the vector database extension <a href="https://github.com/pgvector/pgvector">pgvector</a>, with just several thousand lines of code, is negligible in complexity compared to PostgreSQL&rsquo;s millions of lines. Yet, this &ldquo;insignificant&rdquo; extension achieves complete vector data types and indexing capabilities, <a href="https://supabase.com/blog/pgvector-vs-pinecone">outperforming</a> lots of specialized vector databases.</p>
<p>Why? Because pgvector&rsquo;s creators didn&rsquo;t need to worry about the database&rsquo;s general additional complexities: ACID, recovery, backup &amp; PITR, high availability, access control, monitoring, deployment, 3rd-party ecosystem tools, client drivers, etc., which require millions of lines of code to solve well. They only focused on the essential complexity of their problem.</p>
<p>For example, ElasticSearch was developed on the Lucene search library, while the Rust ecosystem has an improved next-gen full-text search library, <a href="https://github.com/quickwit-oss/tantivy">Tantivy</a>, as a Lucene alternative. ParadeDB only needs to wrap and connect it to PostgreSQL&rsquo;s interface to offer search services comparable to ElasticSearch. More importantly, it can stand on the shoulders of PostgreSQL, leveraging the entire PG ecosystem&rsquo;s united strength (e.g., mixed searches with PG Vector) to &ldquo;unfairly&rdquo; compete with another dedicated database.</p>
<p><a href="/docs/reference/extension/"><img alt="img" src="/img/pigsty/extension.png"></a></p>
<blockquote>
<p>Pigsty has 255 <a href="/docs/reference/extension/"><strong>extensions</strong></a> available. And there are <a href="https://gist.github.com/joelonsql/e5aa27f8cc9bd22b8999b7de8aee9d47"><strong>1000+</strong></a> more in the ecosystem</p>
</blockquote>
<hr>
<p>The extensibility brings another huge advantage: the <strong>composability</strong> of extensions, allowing different extensions to work together, creating a synergistic effect where 1+1 &raquo; 2. For instance, TimescaleDB can be combined with PostGIS for spatio-temporal data support; the BM25 extension for full-text search can be combined with the PGVector extension, providing hybrid search capabilities.</p>
<p>Furthermore, the <strong>distributive</strong> extension <a href="https://www.citusdata.com/"><strong>Citus</strong></a> can transparently transform a standalone cluster into a horizontally partitioned distributed database cluster. This capability can be orthogonally combined with other features, making PostGIS a distributed geospatial database, PGVector a distributed vector database, ParadeDB a distributed full-text search database, and so on.</p>
<hr>
<p>What’s more powerful is that extensions <strong>evolve independently</strong>, without the cumbersome need for main branch merges and coordination.  This allows for scaling — PG’s extensibility lets numerous teams explore database possibilities in parallel, with all extensions being optional, not affecting the core functionality’s reliability. Those features that are mature and robust have the chance to be stably integrated into the main branch.</p>
<p>PostgreSQL achieves both foundational <strong>reliability</strong> and <strong>agile functionality</strong> through the magic of extreme extensibility, making it an outlier in the database world and changing the game rules of the database landscape.</p>
<hr>
<h2 id="game-changer-in-the-db-arena">Game Changer in the DB Arena</h2>
<p><strong>The emergence of PostgreSQL has shifted the paradigms in the database domain</strong>: Teams endeavoring to craft a “new database kernel” now face a formidable trial — how to stand out against the open-source, feature-rich Postgres. What’s their unique value proposition?</p>
<p>Until a revolutionary hardware breakthrough occurs, the advent of practical, new, general-purpose database kernels seems unlikely. No singular database can match the overall prowess of PG, bolstered by all its extensions — not even Oracle, given PG’s ace of being open-source and free.</p>
<p>A niche database product might carve out a space for itself if it can outperform PostgreSQL by an order of magnitude in specific aspects (typically performance). However, it usually doesn’t take long before the PostgreSQL ecosystem spawns open-source extension alternatives. Opting to develop a PG extension rather than a whole new database gives teams a crushing speed advantage in playing catch-up!</p>
<p>Following this logic, the PostgreSQL ecosystem is poised to snowball, accruing advantages and inevitably moving towards a monopoly, mirroring the Linux kernel’s status in server OS within a few years. Developer surveys and database trend reports confirm this trajectory.</p>
<p><a href="https://survey.stackoverflow.co/2023/#section-most-popular-technologies-databases"><img alt="sf-survey.png" src="/zh/blog/pg/pg-eat-db-world/sf-survey.png"></a></p>
<blockquote>
<p><a href="https://survey.stackoverflow.co/2023/#section-most-popular-technologies-databases"><strong>StackOverflow 2023 Survey: PostgreSQL, the Decathlete</strong></a></p>
</blockquote>
<p><a href="https://demo.pigsty.cc/d/sf-survey"><img alt="sf-trend.jpg" src="/zh/blog/pg/pg-eat-db-world/sf-trend.jpg"></a></p>
<blockquote>
<p><a href="https://demo.pigsty.cc/d/sf-survey"><strong>StackOverflow&rsquo;s Database Trends Over the Past 7 Years</strong></a></p>
</blockquote>
<p>PostgreSQL has long been the favorite database in HackerNews &amp; StackOverflow. Many new open-source projects default to PostgreSQL as their primary, if not only, database choice. And many new-gen companies are going All in PostgreSQL.</p>
<p>As “<a href="https://www.amazingcto.com/postgres-for-everything/"><strong>Radical Simplicity: Just Use Postgres</strong></a>” says, Simplifying tech stacks, reducing components, accelerating development, lowering risks, and adding more features can be achieved by <strong>“Just Use Postgres.”</strong> Postgres can replace many backend technologies, including MySQL, Kafka, RabbitMQ, ElasticSearch, Mongo, and Redis, effortlessly serving millions of users. <strong>Just Use Postgres</strong> is no longer limited to a few elite teams but becoming a mainstream best practice.</p>
<hr>
<h2 id="what-else-can-be-done">What Else Can Be Done?</h2>
<p>The endgame for the database domain seems predictable. But what can we do, and what should we do?</p>
<p>PostgreSQL is already a near-perfect database kernel for the vast majority of scenarios, making the idea of a kernel &ldquo;bottleneck&rdquo; absurd. Forks of PostgreSQL and MySQL that tout kernel modifications as selling points are essentially going nowhere.</p>
<p>This is similar to the situation with the Linux OS kernel today; despite the plethora of Linux distros, everyone opts for the same kernel. Forking the Linux kernel is seen as creating unnecessary difficulties, and the industry frowns upon it.</p>
<p>Accordingly, the main conflict is no longer the database kernel itself but two directions— database <strong>extensions</strong> and <strong>services</strong>! The former pertains to internal extensibility, while the latter relates to external composability. Much like the OS ecosystem, the competitive landscape will concentrate on <strong>database distributions</strong>. In the database domain, only those distributions centered around extensions and services stand a chance for ultimate success.</p>
<p>Kernel remains lukewarm, with MariaDB, the fork of MySQL’s parent, nearing delisting, while AWS, profiting from offering services and extensions on top of the free kernel, thrives. Investment has flowed into numerous PG ecosystem extensions and service distributions: Citus, TimescaleDB, Hydra, PostgresML, ParadeDB, FerretDB, StackGres, Aiven, Neon, Supabase, Tembo, PostgresAI, and our own PG distro — — <a href="https://pigsty.io/">Pigsty</a>.</p>
<p><img src="/img/pigsty/players.png"></p>
<hr>
<p>A dilemma within the PostgreSQL ecosystem is the independent evolution of many extensions and tools, lacking a unifier to synergize them. For instance, Hydra releases its own package and Docker image, and so does PostgresML, each distributing PostgreSQL images with their own extensions and only their own. These images and packages are far from comprehensive database services like AWS RDS.</p>
<p>Even service providers and ecosystem integrators like AWS fall short in front of numerous extensions, unable to include many due to various reasons (AGPLv3 license, security challenges with multi-tenancy),
thus failing to leverage the synergistic amplification potential of PostgreSQL ecosystem extensions.</p>
<blockquote>
<table>
<thead>
<tr>
<th><strong>Extesion Category</strong></th>
<th><a href="https://pigsty.io/docs/reference/extension/"><strong>Pigsty RDS &amp; PGDG</strong></a></th>
<th style="text-align:center"><a href="https://docs.aws.amazon.com/AmazonRDS/latest/PostgreSQLReleaseNotes/postgresql-extensions.html"><strong>AWS RDS PG</strong></a></th>
<th style="text-align:center"><a href="https://help.aliyun.com/zh/rds/apsaradb-rds-for-postgresql/extensions-supported-by-apsaradb-rds-for-postgresql"><strong>Aliyun RDS PG</strong></a></th>
</tr>
</thead>
<tbody>
<tr>
<td>Add Extension</td>
<td><i class="fas fa-circle-check text-success"></i> Free to Install</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i> Not Allowed</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i> Not Allowed</td>
</tr>
<tr>
<td>Geo Spatial</td>
<td><i class="fas fa-circle-check text-success"></i> PostGIS 3.4.2</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PostGIS 3.4.1</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PostGIS 3.3.4</td>
</tr>
<tr>
<td>Time Series</td>
<td><i class="fas fa-circle-check text-success"></i> TimescaleDB 2.14.2</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Distributive</td>
<td><i class="fas fa-circle-check text-success"></i> Citus 12.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>AI / ML</td>
<td><i class="fas fa-circle-check text-success"></i> PostgresML 2.8.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Columnar</td>
<td><i class="fas fa-circle-check text-success"></i> Hydra 1.1.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Vector</td>
<td><i class="fas fa-circle-check text-success"></i> PGVector 0.6</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> PGVector 0.6</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pase 0.0.1</td>
</tr>
<tr>
<td>Sparse Vector</td>
<td><i class="fas fa-circle-check text-success"></i> PG Sparse 0.5.6</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Full-Text Search</td>
<td><i class="fas fa-circle-check text-success"></i> pg_bm25 0.5.6<br /></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Graph</td>
<td><i class="fas fa-circle-check text-success"></i> Apache AGE 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>GraphQL</td>
<td><i class="fas fa-circle-check text-success"></i> PG GraphQL 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Message Queue</td>
<td><i class="fas fa-circle-check text-success"></i> pgq 3.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>OLAP</td>
<td><i class="fas fa-circle-check text-success"></i> pg_analytics 0.5.6</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>DuckDB</td>
<td><i class="fas fa-circle-check text-success"></i> duckdb_fdw 1.1</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>CDC</td>
<td><i class="fas fa-circle-check text-success"></i> wal2json 2.5.3</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> wal2json 2.5</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
</tr>
<tr>
<td>Bloat Control</td>
<td><i class="fas fa-circle-check text-success"></i> pg_repack 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pg_repack 1.5.0</td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> pg_repack 1.4.8</td>
</tr>
<tr>
<td>Point Cloud</td>
<td><i class="fas fa-circle-check text-success"></i> PG PointCloud 1.2.5</td>
<td style="text-align:center"><i class="fas fa-circle-xmark text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-success"></i> Ganos PointCloud 6.1</td>
</tr>
</tbody>
</table>
<p>Many important extensions are not available on Cloud RDS (PG 16, 2024-02-29)</p>
</blockquote>
<p>Extensions are the soul of PostgreSQL. A Postgres without the freedom to use extensions is like cooking without salt, a giant constrained.</p>
<p>Addressing this issue is one of our primary goals.</p>
<hr>
<h2 id="our-resolution-pigsty">Our Resolution: Pigsty</h2>
<p>Despite earlier exposure to MySQL Oracle, and MSSQL, when I first used PostgreSQL in 2015, I was convinced of its future dominance in the database realm. Nearly a decade later, I’ve transitioned from a user and administrator to a contributor and developer, witnessing PG’s march toward that goal.</p>
<p>Interactions with diverse users revealed that the database field&rsquo;s shortcoming isn&rsquo;t the kernel anymore — PostgreSQL is already sufficient. The real issue is <strong>leveraging the kernel’s capabilities</strong>, which is the reason behind RDS’s booming success.</p>
<p>However, I believe this capability should be as accessible as free software, like the PostgreSQL kernel itself — available to every user, not just renting from cyber feudal lords.</p>
<p>Thus, I created <a href="https://pigsty.io/"><strong>Pigsty</strong></a>, a battery-included, local-first PostgreSQL distribution as an open-source <a href="/blog/cloud/rds/">RDS</a> Alternative, which aims to harness the collective power of PostgreSQL ecosystem extensions and democratize access to production-grade database services.</p>
<p><a href="https://pigsty.io"><img alt="img" src="/img/pigsty/homepage.en.png"></a></p>
<blockquote>
<p>Pigsty stands for <strong>P</strong>ostgreSQL <strong>i</strong>n <strong>G</strong>reat <strong>STY</strong>le, representing the zenith of PostgreSQL.</p>
</blockquote>
<p>We’ve defined six core propositions addressing the central issues in PostgreSQL database services:</p>
<p><strong>Extensible Postgres</strong>, <strong>Reliable Infras</strong>, <strong>Observable Graphics</strong>, <strong>Available Services</strong>, <strong>Maintainable Toolbox</strong>, and <strong>Composable Modules</strong>.</p>
<p>The initials of these value propositions offer another acronym for Pigsty:</p>
<blockquote>
<p><strong>P</strong>ostgres, <strong>I</strong>nfras, <strong>G</strong>raphics, <strong>S</strong>ervice, <strong>T</strong>oolbox, <strong>Y</strong>ours.</p>
<p>Your graphical Postgres infrastructure service toolbox.</p>
</blockquote>
<p><strong>Extensible PostgreSQL</strong> is the linchpin of this distribution. In the recently launched <a href="https://github.com/Vonng/pigsty/releases/tag/v2.6.0"><strong>Pigsty v2.6</strong></a>, we integrated DuckDB FDW and ParadeDB extensions, massively boosting PostgreSQL’s analytical capabilities and ensuring every user can easily harness this power.</p>
<p>Our aim is to integrate the strengths within the PostgreSQL ecosystem, creating a synergistic force akin to the <strong>Ubuntu</strong> of the database world. I believe the kernel debate is settled, and the real competitive frontier lies here.</p>
<ul>
<li><a href="https://postgis.net/"><strong>PostGIS</strong></a>: Provides geospatial data types and indexes, the de facto standard for GIS (&amp; <strong>pgPointCloud</strong>, <strong>pgRouting</strong>).</li>
<li><a href="https://www.timescale.com/"><strong>TimescaleDB</strong></a>: Adds time-series, continuous aggregates, distributed, columnar storage, and automatic compression capabilities.</li>
<li><a href="https://github.com/pgvector/pgvector"><strong>PGVector</strong></a>: Support AI vectors/embeddings and ivfflat, hnsw vector indexes (&amp; <strong>pg_sparse</strong> for sparse vectors).</li>
<li><a href="https://www.citusdata.com/"><strong>Citus</strong></a>: Transforms classic master-slave PG clusters into horizontally partitioned distributed database clusters.</li>
<li><a href="https://www.hydra.so/"><strong>Hydra</strong></a>: Adds columnar storage and analytics, rivaling ClickHouse’s analytic capabilities.</li>
<li><a href="https://www.paradedb.com/"><strong>ParadeDB</strong></a>: Elevates full-text search and mixed retrieval to ElasticSearch levels (&amp; <strong>zhparser</strong> for Chinese tokenization).</li>
<li><a href="https://age.apache.org/"><strong>Apache AGE</strong></a>: Graph database extension, adding Neo4J-like OpenCypher query support to PostgreSQL.</li>
<li><a href="https://github.com/supabase/pg_graphql"><strong>PG GraphQL</strong></a>: Adds native built-in GraphQL query language support to PostgreSQL.</li>
<li><a href="https://github.com/alitrack/duckdb_fdw"><strong>DuckDB FDW</strong></a>: Enables direct access to DuckDB’s powerful embedded analytic database files through PostgreSQL (&amp; DuckDB CLI).</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/supabase"><strong>Supabase</strong></a>: An open-source Firebase alternative based on PostgreSQL, providing a complete app development storage solution.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/ferretdb"><strong>FerretDB</strong></a>: An open-source MongoDB alternative based on PostgreSQL, compatible with MongoDB APIs/drivers.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/pgml"><strong>PostgresML</strong></a>: Facilitates classic machine learning algorithms, calling, deploying, and training AI models with SQL.</li>
</ul>
<p><a href="https://pigsty.io"><img alt="img" src="/img/pigsty/desc.png"></a></p>
<p>Developers, your choices will shape the future of the database world. I hope my work helps you better utilize the world’s most advanced open-source database kernel: <strong>PostgreSQL</strong>.</p>
<blockquote>
<p><a href="https://pigsty.io/blog/pg/pg-eat-db-world/">Read in Pigsty’s Blog</a> <em>|</em> <a href="https://github.com/Vonng/pigsty">GitHub Repo: Pigsty</a> <em>|</em> <a href="https://pigsty.io/">Official Website</a></p>
</blockquote>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-fe0303de91d0c7a97aa03dbbd71290fa">PostgreSQL Convention 2024</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com/en/">Ruohang Feng</a> (<a href="https://vonng.com/en/">@Vonng</a>) | <a href="https://mp.weixin.qq.com/s/W1hwbl3qmjC4Dcmadc8uSg">Wechat Column</a></b> |
        
		<time datetime="2023-11-27" class="text-muted">2023-11-27</time>
        
	</div>
	<p><img src="/img/blog/hero/pg-convention.jpg"></p>
<ul>
<li><a href="/blog/pg/pg-convention/#background">Background</a></li>
<li><a href="/blog/pg/pg-convention/#0x01-naming-convention">0x01 Naming Convention</a></li>
<li><a href="/blog/pg/pg-convention/#0x02-design-convention">0x01 Design Convention</a></li>
<li><a href="/blog/pg/pg-convention/#0x03-query-convention">0x01 Query Convention</a></li>
<li><a href="/blog/pg/pg-convention/#0x04-administration-convention">0x01 Admin Convention</a></li>
</ul>
<blockquote>
<p>Roughly translated from <a href="/zh/blog/pg/pg-convention/">PostgreSQL Convention 2024</a> with Google.</p>
</blockquote>
<hr>
<h2 id="0x00-background">0x00 Background</h2>
<blockquote>
<p>No Rules, No Lines</p>
</blockquote>
<p>The functions of PostgreSQL are very powerful, but to use PostgreSQL well requires the cooperation of backend, operation and maintenance, and DBA.</p>
<p>This article has compiled a development/operation and maintenance protocol based on the principles and characteristics of the PostgreSQL database, hoping to reduce the confusion you encounter when using the PostgreSQL database: hello, me, everyone.</p>
<p>The first version of this article is mainly for PostgreSQL 9.4 - PostgreSQL 10. The latest version has been updated and adjusted for PostgreSQL 15/16.</p>
<hr>
<h2 id="0x01-naming-convention">0x01 naming convention</h2>
<blockquote>
<p>There are only two hard problems in computer science: cache invalidation and <strong>naming</strong> .</p>
</blockquote>
<p><strong>Generic naming rules</strong> (Generic)</p>
<ul>
<li>This rule applies to all objects <strong>in the database</strong> , including: library names, table names, index names, column names, function names, view names, serial number names, aliases, etc.</li>
<li>The object name must use only lowercase letters, underscores, and numbers, and the first letter must be a lowercase letter.</li>
<li>The length of the object name must not exceed 63 characters, and the naming <code>snake_case</code>style must be uniform.</li>
<li>The use of SQL reserved words is prohibited, use <code>select pg_get_keywords();</code>to obtain a list of reserved keywords.</li>
<li>Dollar signs are prohibited <code>$</code>, Chinese characters are prohibited, and do not <code>pg</code>begin with .</li>
<li>Improve your wording taste and be honest and elegant; do not use pinyin, do not use uncommon words, and do not use niche abbreviations.</li>
</ul>
<p><strong>Cluster naming rules</strong> (Cluster)</p>
<ul>
<li>The name of the PostgreSQL cluster will be used as the namespace of the cluster resource and must be a valid DNS domain name without any dots or underscores.</li>
<li>The cluster name should start with a lowercase letter, contain only lowercase letters, numbers, and minus signs, and conform to the regular expression: <code>[a-z][a-z0-9-]*</code>.</li>
<li>PostgreSQL database cluster naming usually follows a three-part structure: <code>pg-&lt;biz&gt;-&lt;tld&gt;</code>. Database type/business name/business line or environment</li>
<li><code>biz</code>The English words that best represent the characteristics of the business should only consist of lowercase letters and numbers, and should not contain hyphens <code>-</code>.</li>
<li>When using a backup cluster to build a delayed slave database of an existing cluster, <code>biz</code>the name should be <code>&lt;biz&gt;delay</code>, for example <code>pg-testdelay</code>.</li>
<li>When branching an existing cluster, you can <code>biz</code>add a number at the end of : for example, <code>pg-user1</code>you can branch from <code>pg-user2</code>, <code>pg-user3</code>etc.</li>
<li>For horizontally sharded clusters, <code>biz</code>the name should include <code>shard</code>and be preceded by the shard number, for example <code>pg-testshard1</code>, <code>pg-testshard2</code>,&hellip;</li>
<li><code>&lt;tld&gt;</code>It is the top-level business line and can also be used to distinguish different environments: for example <code>-tt</code>, <code>-dev</code>, <code>-uat</code>, <code>-prod</code>etc. It can be omitted if not required.</li>
</ul>
<p><strong>Service naming rules</strong> (Service)</p>
<ul>
<li>Each PostgreSQL cluster will provide 2 to 6 types of external services, which use fixed naming rules by default.</li>
<li>The service name is prefixed with the cluster name and the service type is suffixed, for example <code>pg-test-primary</code>, <code>pg-test-replica</code>.</li>
<li>Read-write services are uniformly <code>primary</code>named with the suffix, and read-only services are uniformly <code>replica</code>named with the suffix. These two services are required.</li>
<li>ETL pull/individual user query is <code>offline</code>named with the suffix, and direct connection to the main database/ETL write is <code>default</code>named with the suffix, which is an optional service.</li>
<li>The synchronous read service is <code>standby</code>named with the suffix, and the delayed slave library service is <code>delayed</code>named with the suffix. A small number of core libraries can provide this service.</li>
</ul>
<p><strong>Instance naming rules</strong> (Instance)</p>
<ul>
<li>A PostgreSQL cluster consists of at least one instance, and each instance has a unique instance number assigned from zero or one within the cluster.</li>
<li><strong>The instance name</strong><code>-</code> is composed of the cluster name + instance number with hyphens , for example: <code>pg-test-1</code>, <code>pg-test-2</code>.</li>
<li>Once assigned, the instance number cannot be modified until the instance is offline and destroyed, and cannot be reassigned for use.</li>
<li>The instance name will be used as a label for monitoring system data <code>ins</code>and will be attached to all data of this instance.</li>
<li>If you are using a host/database 1:1 exclusive deployment, the node Hostname can use the database instance name.</li>
</ul>
<p><strong>Database naming rules</strong> (Database)</p>
<ul>
<li>The database name should be consistent with the cluster and application, and must be a highly distinguishable English word.</li>
<li>The naming is <code>&lt;tld&gt;_&lt;biz&gt;</code>constructed in the form of , <code>&lt;tld&gt;</code>which is the top-level business line. It can also be used to distinguish different environments and can be omitted if not used.</li>
<li><code>&lt;biz&gt;</code>For a specific business name, for example, <code>pg-test-tt</code>the cluster can use the library name <code>tt_test</code>or <code>test</code>. This is not mandatory, i.e. it is allowed to create <code>&lt;biz&gt;</code>other databases with different cluster names.</li>
<li>For sharded libraries, <code>&lt;biz&gt;</code>the section must <code>shard</code>end with but <strong>should not</strong> contain the shard number, for example <code>pg-testshard1</code>, <code>pg-testshard2</code>both <code>testshard</code>should be used.</li>
<li>Multiple parts use <code>-</code>joins. For example: <code>&lt;biz&gt;-chat-shard</code>, <code>&lt;biz&gt;-payment</code>etc., no more than three paragraphs in total.</li>
</ul>
<p><strong>Role naming convention</strong> (Role/User)</p>
<ul>
<li><code>dbsu</code>There is only one database super user : <code>postgres</code>, the user used for streaming replication is named <code>replicator</code>.</li>
<li>The users used for monitoring are uniformly named <code>dbuser_monitor</code>, and the super users used for daily management are: <code>dbuser_dba</code>.</li>
<li>The business user used by the program/service defaults to using <code>dbuser_&lt;biz&gt;</code>as the username, for example <code>dbuser_test</code>. Access from different services should be differentiated using separate business users.</li>
<li>The database user applied for by the individual user agrees to use <code>dbp_&lt;name&gt;</code>, where is <code>name</code>the standard user name in LDAP.</li>
<li>The default permission group naming is fixed as: <code>dbrole_readonly</code>, <code>dbrole_readwrite</code>, <code>dbrole_admin</code>, <code>dbrole_offline</code>.</li>
</ul>
<p><strong>Schema naming rules</strong> (Schema)</p>
<ul>
<li>The business uniformly uses a global <code>&lt;prefix&gt;</code>as the schema name, as short as possible, and is set to <code>search_path</code>the first element by default.</li>
<li><code>&lt;prefix&gt;</code>You must not use <code>public</code>, <code>monitor</code>, and must not conflict with any schema name used by PostgreSQL extensions, such as: <code>timescaledb</code>, <code>citus</code>, <code>repack</code>, <code>graphql</code>, <code>net</code>, <code>cron</code>,&hellip; It is not appropriate to use special names: <code>dba</code>, <code>trash</code>.</li>
<li>Sharding mode naming rules adopt: <code>rel_&lt;partition_total_num&gt;_&lt;partition_index&gt;</code>. The middle is the total number of shards, which is currently fixed at 8192. The suffix is the shard number, counting from 0. Such as <code>rel_8192_0</code>,&hellip;,,, <code>rel_8192_11</code>etc.</li>
<li>Creating additional schemas, or using <code>&lt;prefix&gt;</code>schema names other than , will require R&amp;D to explain their necessity.</li>
</ul>
<p><strong>Relationship naming rules</strong> (Relation)</p>
<ul>
<li>The first priority for relationship naming is to have clear meaning. Do not use ambiguous abbreviations or be too lengthy. Follow general naming rules.</li>
<li>Table names should use <strong>plural nouns</strong> and be consistent with historical conventions. Words with irregular plural forms should be avoided as much as possible.</li>
<li>Views use <code>v_</code>as the naming prefix, materialized views use <code>mv_</code>as the naming prefix, temporary tables use <code>tmp_</code>as the naming prefix.</li>
<li>Inherited or partitioned tables should be prefixed by the parent table name and suffixed by the child table attributes (rules, shard ranges, etc.).</li>
<li>The time range partition uses the starting interval as the naming suffix. If the first partition has no upper bound, the R&amp;D will specify a far enough time point: grade partition: <code>tbl_2023</code>, month-level partition <code>tbl_202304</code>, day-level partition <code>tbl_20230405</code>, hour-level partition <code>tbl_2023040518</code>. The default partition <code>_default</code>ends with .</li>
<li>The hash partition is named with the remainder as the suffix of the partition table name, and the list partition is manually specified by the R&amp;D team with a reasonable partition table name corresponding to the list item.</li>
</ul>
<p><strong>Index naming rules</strong> (Index)</p>
<ul>
<li>When creating an index, the index name should be <strong>specified explicitly</strong> and consistent with the PostgreSQL default naming rules.</li>
<li>Index names are prefixed with the table name, primary key indexes <code>_pkey</code>end with , unique indexes <code>_key</code>end with , ordinary indexes end <code>_idx</code>with , and indexes used for <code>EXCLUDED</code>constraints <code>_excl</code>end with .</li>
<li>When using conditional index/function index, the function and condition content used should be reflected in the index name. For example <code>tbl_md5_title_idx</code>, <code>tbl_ts_ge_2023_idx</code>, but the length limit cannot be exceeded.</li>
</ul>
<p><strong>Field naming rules</strong> (Attribute)</p>
<ul>
<li>It is prohibited to use system column reserved field names: <code>oid</code>, <code>xmin</code>, <code>xmax</code>, <code>cmin</code>, <code>cmax</code>, <code>ctid</code>.</li>
<li>Primary key columns are usually named with <code>id</code>or as <code>id</code>a suffix.</li>
<li>The conventional name is the creation time field <code>created_time</code>, and the conventional name is the last modification time field.<code>updated_time</code></li>
<li><code>is_</code>It is recommended to use , etc. as the prefix for Boolean fields <code>has_</code>.</li>
<li>Additional flexible JSONB fields are fixed using <code>extra</code>as column names.</li>
<li>The remaining field names must be consistent with existing table naming conventions, and any field naming that breaks conventions should be accompanied by written design instructions and explanations.</li>
</ul>
<p><strong>Enumeration item naming</strong> (Enum)</p>
<ul>
<li>Enumeration items should be used by default <code>camelCase</code>, but other styles are allowed.</li>
</ul>
<p><strong>Function naming rules</strong> (Function)</p>
<ul>
<li>Function names start with verbs: <code>select</code>, <code>insert</code>, <code>delete</code>, <code>update</code>, <code>upsert</code>, <code>create</code>,….</li>
<li>Important parameters can be reflected in the function name through <code>_by_ids</code>the <code>_by_user_ids</code>suffix of.</li>
<li>Avoid function overloading and try to keep only one function with the same name.</li>
<li><code>BIGINT/INTEGER/SMALLINT</code>It is forbidden to overload function signatures through integer types such as , which may cause ambiguity when calling.</li>
<li>Use named parameters for variables in stored procedures and functions, and avoid positional parameters ( <code>$1</code>, <code>$2</code>,&hellip;).</li>
<li>If the parameter name conflicts with the object name, add before the parameter <code>_</code>, for example <code>_user_id</code>.</li>
</ul>
<p><strong>Comment specifications</strong> (Comment)</p>
<ul>
<li>Try your best to provide comments ( <code>COMMENT</code>) for various objects. Comments should be in English, concise and concise, and one line should be used.</li>
<li>When the object&rsquo;s schema or content semantics change, be sure to update the annotations to keep them in sync with the actual situation.</li>
</ul>
<hr>
<h2 id="0x02-design-convention">0x02 Design Convention</h2>
<blockquote>
<p>To each his own</p>
</blockquote>
<p><strong>Things to note when creating a table</strong></p>
<ul>
<li>The DDL statement for creating a table needs to use the standard format, with SQL keywords in uppercase letters and other words in lowercase letters.</li>
<li>Use lowercase letters uniformly in field names/table names/aliases, and try not to be case-sensitive. If you encounter a mixed case, or a name that conflicts with SQL keywords, you need to use double quotation marks for quoting.</li>
<li>Use specialized type (NUMERIC, ENUM, INET, MONEY, JSON, UUID, &hellip;) if applicable, and avoid using <code>TEXT</code> type as much as possible. The <code>TEXT</code> type is not conducive to the database&rsquo;s understanding of the data. Use these types to improve data storage, query, indexing, and calculation efficiency, and improve maintainability.</li>
<li>Optimizing column layout and alignment types can have additional performance/storage gains.</li>
<li>Unique constraints must be guaranteed by the database, and any unique column must have a corresponding unique constraint. <code>EXCLUDE</code>Constraints are generalized unique constraints that can be used to ensure data integrity in low-frequency update scenarios.</li>
</ul>
<p><strong>Partition table considerations</strong></p>
<ul>
<li>If a single table exceeds hundreds of TB, or the monthly incremental data exceeds more than ten GB, you can consider table partitioning.</li>
<li>A guideline for partitioning is to keep the size of each partition within the comfortable range of 1GB to 64GB.</li>
<li>Tables that are conditionally partitioned by time range are first partitioned by time range. Commonly used granularities include: decade, year, month, day, and hour. The partitions required in the future should be created at least three months in advance.</li>
<li>For extremely skewed data distributions, different time granularities can be combined, for example: 1900 - 2000 as one large partition, 2000 - 2020 as year partitions, and after 2020 as month partitions. When using time partitioning, the table name uses the value of the lower limit of the partition (if infinity, use a value that is far enough back).</li>
</ul>
<p><strong>Notes on wide tables</strong></p>
<ul>
<li>Wide tables (for example, tables with dozens of fields) can be considered for vertical splitting, with mutual references to the main table through the same primary key.</li>
<li>Because of the PostgreSQL MVCC mechanism, the write amplification phenomenon of wide tables is more obvious, reducing frequent updates to wide tables.</li>
<li>In Internet scenarios, it is allowed to appropriately lower the normalization level and reduce multi-table connections to improve performance.</li>
</ul>
<p><strong>Primary key considerations</strong></p>
<ul>
<li>Every table <strong>must</strong> have <strong>an identity column</strong> , and in principle it must have a primary key. The minimum requirement is to have <strong>a non-null unique constraint</strong> .</li>
<li>The identity column is used to uniquely identify any tuple in the table, and logical replication and many third-party tools depend on it.</li>
<li>If the primary key contains multiple columns, it should be specified using a single column after creating the field list of the table DDL <code>PRIMARY KEY(a,b,...)</code>.</li>
<li>In principle, it is recommended to use integer <code>UUID</code>types for primary keys, which can be used with caution and text types with limited length. Using other types requires explicit explanation and evaluation.</li>
<li>The primary key usually uses a single integer column. In principle, it is recommended to use it <code>BIGINT</code>. Use it with caution <code>INTEGER</code>and it is not allowed <code>SMALLINT</code>.</li>
<li>The primary key should be used to <code>GENERATED ALWAYS AS IDENTITY</code>generate a unique primary key; <code>SERIAL</code>, <code>BIGSERIAL</code>which is only allowed when compatibility with PG versions below 10 is required.</li>
<li>The primary key can use <code>UUID</code>the type as the primary key, and it is recommended to use UUID v1/v7; use UUIDv4 as the primary key with caution, as random UUID has poor locality and has a collision probability.</li>
<li>When using a string column as a primary key, you should add a length limit. Generally used <code>VARCHAR(64)</code>, use of longer strings should be explained and evaluated.</li>
<li><code>INSERT/UPDATE</code>In principle, it is forbidden to modify the value of the primary key column, and <code>INSERT RETURNING</code> it can be used to return the automatically generated primary key value.</li>
</ul>
<p><strong>Foreign key considerations</strong></p>
<ul>
<li>When defining a foreign key, the reference must explicitly set the corresponding action: <code>SET NULL</code>, <code>SET DEFAULT</code>, <code>CASCADE</code>, and use cascading operations with caution.</li>
<li>The columns referenced by foreign keys need to be primary key columns in other tables/this table.</li>
<li>Internet businesses, especially partition tables and horizontal shard libraries, use foreign keys with caution and can be solved at the application layer.</li>
</ul>
<p><strong>Null/Default Value Considerations</strong></p>
<ul>
<li>If there is no distinction between zero and null values in the field semantics, null values are not allowed and <code>NOT NULL</code>constraints must be configured for the column.</li>
<li>If a field has a default value semantically, <code>DEFAULT</code>the default value should be configured.</li>
</ul>
<p><strong>Numeric type considerations</strong></p>
<ul>
<li>Used for regular numeric fields <code>INTEGER</code>. Used for numeric columns whose capacity is uncertain <code>BIGINT</code>.</li>
<li>Don&rsquo;t use it without special reasons <code>SMALLINT</code>. The performance and storage improvements are very small, but there will be many additional problems.</li>
<li>Note that the SQL standard does not provide unsigned integers, and values exceeding <code>INTMAX</code>but not exceeding <code>UINTMAX</code>need to be upgraded and stored. Do not store more <code>INT64MAX</code>values in <code>BIGINT</code>the column as it will overflow into negative numbers.</li>
<li><code>REAL</code>Represents a 4-byte floating point number, <code>FLOAT</code>represents an 8-byte floating point number. Floating point numbers can only be used in scenarios where the final precision doesn&rsquo;t matter, such as geographic coordinates. <strong>Remember not to use equality judgment on floating point numbers, except for zero values</strong> .</li>
<li>Use exact numeric types <code>NUMERIC</code>. If possible, use <code>NUMERIC(p)</code>and <code>NUMERIC(p,s)</code>to set the number of significant digits and the number of significant digits in the decimal part. For example, the temperature in Celsius ( <code>37.0</code>) can <code>NUMERIC(3,1)</code>be stored with 3 significant digits and 1 decimal place using type.</li>
<li>Currency value type is used <code>MONEY</code>.</li>
</ul>
<p><strong>Text type considerations</strong></p>
<ul>
<li>PostgreSQL text types include <code>char(n)</code>, <code>varchar(n)</code>, <code>text</code>. By default, <code>text</code>the type can be used, which does not limit the string length, but is limited by the maximum field length of 1GB.</li>
<li>If conditions permit, it is preferable to use <code>varchar(n)</code>the type to set a maximum string length. This will introduce minimal additional checking overhead, but can avoid some dirty data and corner cases.</li>
<li>Avoid use <code>char(n)</code>, this type has unintuitive behavior (padding spaces and truncation) and has no storage or performance advantages in order to be compatible with the SQL standard.</li>
</ul>
<p><strong>Time type considerations</strong></p>
<ul>
<li>There are only two ways to store time: with time zone <code>TIMESTAMPTZ</code>and without time zone <code>TIMESTAMP</code>.</li>
<li>It is recommended to use one with time zone <code>TIMESTAMPTZ</code>. If you use <code>TIMESTAMP</code>storage, you must use 0 time zone standard time.</li>
<li>Please use it to generate 0 time zone time <code>now() AT TIME ZONE 'UTC'</code>. You cannot truncate the time zone directly <code>now()::TIMESTAMP</code>.</li>
<li>Uniformly use ISO-8601 format input and output time type: <code>2006-01-02 15:04:05</code>to avoid DMY and MDY problems.</li>
<li>Users in China can use <code>Asia/Hong_Kong</code>the +8 time zone uniformly because the Shanghai time zone abbreviation <code>CST</code>is ambiguous.</li>
</ul>
<p><strong>Notes on enumeration types</strong></p>
<ul>
<li>Fields that are more stable and have a small value space (within tens to hundreds) should use enumeration types instead of integers and strings.</li>
<li>Enumerations are internally implemented using dynamic integers, which have readability advantages over integers and performance, storage, and maintainability advantages over strings.</li>
<li>Enumeration items can only be added, not deleted, but existing enumeration values can be renamed. <code>ALTER TYPE &lt;enum_name&gt;</code>Used to modify enumerations.</li>
</ul>
<p><strong>UUID type considerations</strong></p>
<ul>
<li>Please note that the fully random UUIDv4 has poor locality when used as a primary key. Consider using UUIDv1/v7 instead if possible.</li>
<li>Some UUID generation/processing functions require additional extension plug-ins, such as <code>uuid-ossp</code>, <code>pg_uuidv7</code> etc. If you have this requirement, please specify it during configuration.</li>
</ul>
<p><strong>JSON type considerations</strong></p>
<ul>
<li>Unless there is a special reason, always use the binary storage <code>JSONB</code>type and related functions instead of the text version <code>JSON</code>.</li>
<li>Note the subtle differences between atomic types in JSON and their PostgreSQL counterparts: the zero character <code>text</code>is not allowed in the type corresponding to a JSON string <code>\u0000</code>, and the and <code>numeric</code>is not allowed in the type corresponding to a JSON numeric type . Boolean values only accept lowercase and literal values.<code>NaN``infinity``true``false</code></li>
<li>Please note that objects in the JSON standard <code>null</code>and null values in the SQL standard <code>NULL</code> are not the same concept.</li>
</ul>
<p><strong>Array type considerations</strong></p>
<ul>
<li>When storing a small number of elements, array fields can be used instead of individually.</li>
<li>Suitable for storing data with a relatively small number of elements and infrequent changes. If the number of elements in the array is very large or changes frequently, consider using a separate table to store the data and using foreign key associations.</li>
<li>For high-dimensional floating-point arrays, consider using <code>pgvector</code>the dedicated data types provided by the extension.</li>
</ul>
<p><strong>GIS type considerations</strong></p>
<ul>
<li>The GIS type uses the srid=4326 reference coordinate system by default.</li>
<li>Longitude and latitude coordinate points should use the Geography type without explicitly specifying the reference system coordinates 4326</li>
</ul>
<p><strong>Trigger considerations</strong></p>
<ul>
<li>Triggers will increase the complexity and maintenance cost of the database system, and their use is discouraged in principle. The use of rule systems is prohibited and such requirements should be replaced by triggers.</li>
<li>Typical scenarios for triggers are to automatically modify a row to the current timestamp after modifying it <code>updated_time</code>, or to record additions, deletions, and modifications of a table to another log table, or to maintain business consistency between the two tables.</li>
<li>Operations in triggers are transactional, meaning if the trigger or operations in the trigger fail, the entire transaction is rolled back, so test and prove the correctness of your triggers thoroughly. Special attention needs to be paid to recursive calls, deadlocks in complex query execution, and the execution sequence of multiple triggers.</li>
</ul>
<p><strong>Stored procedure/function considerations</strong></p>
<ul>
<li>
<p>Functions/stored procedures are suitable for encapsulating transactions, reducing concurrency conflicts, reducing network round-trips, reducing the amount of returned data, and executing <strong>a small amount</strong> of custom logic.</p>
</li>
<li>
<p>Stored procedures <strong>are not suitable</strong> for complex calculations, and are not suitable for trivial/frequent type conversion and packaging. In critical high-load systems, <strong>unnecessary</strong> computationally intensive logic in the database should be removed, such as using SQL in the database to convert WGS84 to other coordinate systems. Calculation logic closely related to data acquisition and filtering can use functions/stored procedures: for example, geometric relationship judgment in PostGIS.</p>
</li>
<li>
<p>Replaced functions and stored procedures that are no longer in use should be taken offline in a timely manner to avoid conflicts with future functions.</p>
</li>
<li>
<p>Use a unified syntax format for function creation. The signature occupies a separate line (function name and parameters), the return value starts on a separate line, and the language is the first label. Be sure to mark the function volatility level: <code>IMMUTABLE</code>, <code>STABLE</code>, <code>VOLATILE</code>. Add attribute tags, such as: <code>RETURNS NULL ON NULL INPUT</code>, <code>PARALLEL SAFE</code>, <code>ROWS 1</code>etc.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">CREATE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">OR</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">REPLACE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">FUNCTION</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">nspname</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">myfunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">arg1_</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87">TEXT</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">arg2_</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87">INTEGER</span><span style="color:#000;font-weight:bold">)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">RETURNS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">VOID</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">LANGUAGE</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">SQL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">STABLE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">PARALLEL</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SAFE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ROWS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">RETURNS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NULL</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">ON</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">NULL</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">INPUT</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">AS</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#a40000">$</span><span style="color:#204a87;font-weight:bold">function</span><span style="color:#a40000">$</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">SELECT</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#a40000">$</span><span style="color:#204a87;font-weight:bold">function</span><span style="color:#a40000">$</span><span style="color:#000;font-weight:bold">;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li>
</ul>
<p><strong>Use sensible Locale options</strong></p>
<ul>
<li>Used by default <code>en_US.UTF8</code>and cannot be changed without special reasons.</li>
<li>The default <code>collate</code>rule must be <code>C</code>, to avoid string indexing problems.</li>
<li><a href="https://mp.weixin.qq.com/s/SEXcyRFmdXNI7rpPUB3Zew">https://mp.weixin.qq.com/s/SEXcyRFmdXNI7rpPUB3Zew</a></li>
</ul>
<p><strong>Use reasonable character encoding and localization configuration</strong></p>
<ul>
<li>Character encoding must be used <code>UTF8</code>, any other character encoding is strictly prohibited.</li>
<li>Must be used <code>C</code>as <code>LC_COLLATE</code>the default collation, any special requirements must be explicitly specified in the DDL/query clause to implement.</li>
<li>Character set <code>LC_CTYPE</code>is used by default <code>en_US.UTF8</code>, some extensions rely on character set information to work properly, such as <code>pg_trgm</code>.</li>
</ul>
<p><strong>Notes on indexing</strong></p>
<ul>
<li>All online queries must design corresponding indexes according to their access patterns, and full table scans are not allowed except for very small tables.</li>
<li>Indexes have a price, and it is not allowed to create unused indexes. Indexes that are no longer used should be cleaned up in time.</li>
<li>When building a joint index, columns with high differentiation and selectivity should be placed first, such as ID, timestamp, etc.</li>
<li>GiST index can be used to solve the nearest neighbor query problem, and traditional B-tree index cannot provide good support for KNN problem.</li>
<li>For data whose values are linearly related to the storage order of the heap table, if the usual query is a range query, it is recommended to use the BRIN index. The most typical scenario is to only append written time series data. BRIN index is more efficient than Btree.</li>
<li>When retrieving against JSONB/array fields, you can use GIN indexes to speed up queries.</li>
</ul>
<p><strong>Clarify the order of null values in B-tree indexes</strong></p>
<ul>
<li><code>NULLS FIRST</code>If there is a sorting requirement on a nullable column, it needs to be explicitly specified in the query and index <code>NULLS LAST</code>.</li>
<li>Note that <code>DESC</code>the default rule for sorting is <code>NULLS FIRST</code>that null values appear first in the sort, which is generally not desired behavior.</li>
<li>The sorting conditions of the index must match the query, such as:<code>CREATE INDEX ON tbl (id DESC NULLS LAST);</code></li>
</ul>
<p><strong>Disable indexing on large fields</strong></p>
<ul>
<li>The size of the indexed field cannot exceed 2KB (1/3 of the page capacity). You need to be careful when creating indexes on text types. The text to be indexed should use <code>varchar(n)</code>types with length constraints.</li>
<li>When a text type is used as a primary key, a maximum length must be set. In principle, the length should not exceed 64 characters. In special cases, the evaluation needs to be explicitly stated.</li>
<li>If there is a need for large field indexing, you can consider hashing the large field and establishing a function index. Or use another type of index (GIN).</li>
</ul>
<p><strong>Make the most of functional indexes</strong></p>
<ul>
<li>Any redundant fields that can be inferred from other fields in the same row can be replaced using functional indexes.</li>
<li>For statements that often use expressions as query conditions, you can use expression or function indexes to speed up queries.</li>
<li>Typical scenario: Establish a hash function index on a large field, and establish a <code>reverse</code>function index for text columns that require left fuzzy query.</li>
</ul>
<p><strong>Take advantage of partial indexes</strong></p>
<ul>
<li>For the part of the query where the query conditions are fixed, partial indexes can be used to reduce the index size and improve query efficiency.</li>
<li>If a field to be indexed in a query has only a limited number of values, several corresponding partial indexes can also be established.</li>
<li>If the columns in some indexes are frequently updated, please pay attention to the expansion of these indexes.</li>
</ul>
<hr>
<h2 id="0x03-query-convention">0x03 Query Convention</h2>
<blockquote>
<p>The limits of my language mean the limits of my world.</p>
<p>—Ludwig Wittgenstein</p>
</blockquote>
<p><strong>Use service access</strong></p>
<ul>
<li>Access to the production database must be through domain name access <a href="https://doc.pigsty.cc/#/zh/PGSQL-SVC">services</a> , and direct connection using IP addresses is strictly prohibited.</li>
<li>VIP is used for services and access, LVS/HAProxy shields the role changes of cluster instance members, and master-slave switching does not require application restart.</li>
</ul>
<p><strong>Read and write separation</strong></p>
<ul>
<li>Internet business scenario: Write requests must go through the main library and be accessed through the Primary service.</li>
<li>In principle, read requests go from the slave library and are accessed through the Replica service.</li>
<li>Exceptions: If you need &ldquo;Read Your Write&rdquo; consistency guarantees, and significant replication delays are detected, read requests can access the main library; or apply to the DBA to provide Standby services.</li>
</ul>
<p><strong>Separation of speed and slowness</strong></p>
<ul>
<li>Queries within 1 millisecond in production are called fast queries, and queries that exceed 1 second in production are called slow queries.</li>
<li>Slow queries must go to the offline slave database - Offline service/instance, and a timeout should be set during execution.</li>
<li>In principle, the execution time of online general queries in production should be controlled within 1ms.</li>
<li>If the execution time of an online general query in production exceeds 10ms, the technical solution needs to be modified and optimized before going online.</li>
<li>Online queries should be configured with a Timeout of the order of 10ms or faster to avoid avalanches caused by accumulation.</li>
<li>ETL data from the primary is prohibited, and the offline service should be used to retrieve data from a dedicated instance.</li>
</ul>
<p><strong>Use connection pool</strong></p>
<ul>
<li>Production applications must access the database through a connection pool and the PostgreSQL database through a 1:1 deployed Pgbouncer proxy. Offline service, individual users are strictly prohibited from using the connection pool directly.</li>
<li>Pgbouncer connection pool uses Transaction Pooling mode by default. Some session-level functions may not be available (such as Notify/Listen), so special attention is required. Pre-1.21 Pgbouncer does not support the use of Prepared Statements in this mode. In special scenarios, you can use Session Pooling or bypass the connection pool to directly access the database, which requires special DBA review and approval.</li>
<li>When using a connection pool, it is prohibited to modify the connection status, including modifying connection parameters, modifying search paths, changing roles, and changing databases. The connection must be completely destroyed after modification as a last resort. Putting the changed connection back into the connection pool will lead to the spread of contamination. Use of pg_dump to dump data via Pgbouncer is strictly prohibited.</li>
</ul>
<p><strong>Configure active timeout for query statements</strong></p>
<ul>
<li>Applications should configure active timeouts for all statements and proactively cancel requests after timeout to avoid avalanches. (Go context)</li>
<li>Statements that are executed periodically must be configured with a timeout smaller than the execution period to avoid avalanches.</li>
<li>HAProxy is configured with a default connection timeout of 24 hours for rolling expired long connections. Please do not run SQL that takes more than 1 day to execute on offline instances. This requirement will be specially adjusted by the DBA.</li>
</ul>
<p><strong>Pay attention to replication latency</strong></p>
<ul>
<li>Applications must be aware of synchronization delays between masters and slaves and properly handle situations where replication delays exceed reasonable limits.</li>
<li>Under normal circumstances, replication delays are on the order of 100µs/tens of KB, but in extreme cases, slave libraries may experience replication delays of minutes/hours. Applications should be aware of this phenomenon and have corresponding degradation plans - Select Read from the main library and try again later, or report an error directly.</li>
</ul>
<p><strong>Retry failed transactions</strong></p>
<ul>
<li><strong>Queries</strong> may be killed due to concurrency contention, administrator commands, etc. Applications need to be aware of this and retry if necessary.</li>
<li>When the application reports a large number of errors in the database, it can trigger the circuit breaker to avoid an avalanche. But be careful to distinguish the type and nature of errors.</li>
</ul>
<p><strong>Disconnected and reconnected</strong></p>
<ul>
<li>The database <strong>connection</strong> may be terminated for various reasons, and the application <strong>must</strong> have a disconnection reconnection mechanism.</li>
<li>It can be used <code>SELECT 1</code>as a heartbeat packet query to detect the presence of messages on the connection and keep it alive periodically.</li>
</ul>
<p><strong>Online service application code prohibits execution of DDL</strong></p>
<ul>
<li>It is strictly forbidden to execute DDL in production applications and do not make big news in the application code.</li>
<li>Exception scenario: Creating new time partitions for partitioned tables can be carefully managed by the application.</li>
<li>Special exception: Databases used by office systems, such as Gitlab/Jira/Confluence, etc., can grant application DDL permissions.</li>
</ul>
<p><strong>SELECT statement explicitly specifies column names</strong></p>
<ul>
<li>Avoid using it <code>SELECT *</code>, or <code>RETURNING</code>use it in a clause <code>*</code>. Please use a specific field list and do not return unused fields. When the table structure changes (for example, a new value column), queries that use column wildcards are likely to encounter column mismatch errors.</li>
<li>After the fields of some tables are maintained, the order will change. For example: after <code>id</code>upgrading the INTEGER primary key to <code>BIGINT</code>, <code>id</code>the column order will be the last column. This problem can only be fixed during maintenance and migration. R&amp;D developers should resist the compulsion to adjust the column order and explicitly specify the column order in the SELECT statement.</li>
<li>Exception: Wildcards are allowed when a stored procedure returns a specific table row type.</li>
</ul>
<p><strong>Disable online query full table scan</strong></p>
<ul>
<li>Exceptions: constant minimal table, extremely low-frequency operations, table/return result set is very small (within 100 records/100 KB).</li>
<li>Using negative operators such as on the first-level filter condition will result in a full table scan and must be <code>!=</code>avoided .<code>&lt;&gt;</code></li>
</ul>
<p><strong>Disallow long waits in transactions</strong></p>
<ul>
<li>Transactions must be committed or rolled back as soon as possible after being started. Transactions that exceed 10 minutes <code>IDEL IN Transaction</code>will be forcibly killed.</li>
<li>Applications should enable AutoCommit to avoid <code>BEGIN</code>unpaired <code>ROLLBACK</code>or unpaired applications later <code>COMMIT</code>.</li>
<li>Try to use the transaction infrastructure provided by the standard library, and do not control transactions manually unless absolutely necessary.</li>
</ul>
<p><strong>Things to note when using count</strong></p>
<ul>
<li><code>count(*)</code>It is the standard syntax for <strong>counting rows</strong> and has nothing to do with null values.</li>
<li><code>count(col)</code>The count is <strong>the number of non-null records</strong><code>col</code> in the column . NULL values in this column will not be counted.</li>
<li><code>count(distinct col)</code>When <code>col</code>deduplicating columns and counting them, null values are also ignored, that is, only the number of non-null distinct values is counted.</li>
<li><code>count((col1, col2))</code>When counting multiple columns, even if the columns to be counted are all empty, they will still be counted. <code>(NULL,NULL)</code>This is valid.</li>
<li><code>a(distinct (col1, col2))</code>For multi-column deduplication counting, even if the columns to be counted are all empty, they will be counted, <code>(NULL,NULL)</code>which is effective.</li>
</ul>
<p><strong>Things to note when using aggregate functions</strong></p>
<ul>
<li>All <code>count</code>aggregate functions except <code>NULL</code>But <code>count(col)</code>in this case it will be returned <code>0</code>as an exception.</li>
<li>If returning null from an aggregate function is not expected, use <code>coalesce</code>to set a default value.</li>
</ul>
<p><strong>Handle null values with caution</strong></p>
<ul>
<li>
<p>Clearly distinguish between zero values and null values. Use null values <code>IS NULL</code>for equivalence judgment, and use regular <code>=</code>operators for zero values for equivalence judgment.</p>
</li>
<li>
<p>When a null value is used as a function input parameter, it should have a type modifier, otherwise the overloaded function will not be able to identify which one to use.</p>
</li>
<li>
<p>Pay attention to the null value comparison logic: the result of any comparison operation involving null values is <code>unknown</code>  you need to pay attention to <code>null</code> the logic involved in Boolean operations:</p>
<ul>
<li><code>and</code>: <code>TRUE or NULL</code>Will return due to logical short circuit <code>TRUE</code>.</li>
<li><code>or</code>: <code>FALSE and NULL</code>Will return due to logical short circuit<code>FALSE</code></li>
<li>In other cases, as long as the operand appears <code>NULL</code>, the result is<code>NULL</code></li>
</ul>
</li>
<li>
<p>The result of logical judgment between null value and <strong>any value</strong> is null value, for example, <code>NULL=NULL</code>the return result is <code>NULL</code>not <code>TRUE/FALSE</code>.</p>
</li>
<li>
<p>For equality comparisons involving null values and non-null values, please use ``IS DISTINCT FROM <code> </code>for comparison to ensure that the comparison result is not null.</p>
</li>
<li>
<p>NULL values and aggregate functions: When <strong>all</strong> input values are NULL, the aggregate function returns NULL.</p>
</li>
</ul>
<p><strong>Note that the serial number is empty</strong></p>
<ul>
<li>When using <code>Serial</code>types, <code>INSERT</code>, <code>UPSERT</code>and other operations will consume sequence numbers, and this consumption will not be rolled back when the transaction fails.</li>
<li>When using an integer <code>INTEGER</code>as the primary key and the table has frequent insertion conflicts, you need to pay attention to the problem of integer overflow.</li>
</ul>
<p><strong>The cursor must be closed promptly after use</strong></p>
<p><strong>Repeated queries using prepared statements</strong></p>
<ul>
<li><strong>Prepared Statements</strong> should be used for repeated queries to eliminate the CPU overhead of database hard parsing. Pgbouncer versions earlier than 1.21 cannot support this feature in transaction pooling mode, please pay special attention.</li>
<li>Prepared statements will modify the connection status. Please pay attention to the impact of the connection pool on prepared statements.</li>
</ul>
<p><strong>Choose the appropriate transaction isolation level</strong></p>
<ul>
<li>The default isolation level is <strong>read committed</strong> , which is suitable for most simple read and write transactions. For ordinary transactions, choose the lowest isolation level that meets the requirements.</li>
<li>For write transactions that require transaction-level consistent snapshots, use the <strong>Repeatable Read</strong> isolation level.</li>
<li>For write transactions that have strict requirements on correctness (such as money-related), use the <strong>serializable</strong> isolation level.</li>
<li>When a concurrency conflict occurs between the RR and SR isolation levels, the application should actively retry depending on the error type.</li>
</ul>
<p>rh 09 <strong>Do not use count when judging the existence of a result.</strong></p>
<ul>
<li>It is faster than Count to <code>SELECT 1 FROM tbl WHERE xxx LIMIT 1</code>judge whether there are columns that meet the conditions.</li>
<li><code>SELECT exists(SELECT * FROM tbl WHERE xxx LIMIT 1)</code>The existence result can be converted to a Boolean value using .</li>
</ul>
<p><strong>Use the RETURNING clause to retrieve the modified results in one go</strong></p>
<ul>
<li><code>RETURNING</code>The clause can be used after the <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>statement to effectively reduce the number of database interactions.</li>
</ul>
<p><strong>Use UPSERT to simplify logic</strong></p>
<ul>
<li>When the business has an insert-failure-update sequence of operations, consider using <code>UPSERT</code>substitution.</li>
</ul>
<p><strong>Use advisory locks to deal with hotspot concurrency</strong> .</p>
<ul>
<li>For extremely high-frequency concurrent writes (spike) of single-row records, advisory locks should be used to lock the record ID.</li>
<li>If high concurrency contention can be resolved at the application level, don&rsquo;t do it at the database level.</li>
</ul>
<p><strong>Optimize IN operator</strong></p>
<ul>
<li>Use <code>EXISTS</code>clause instead of <code>IN</code>operator for better performance.</li>
<li>Use <code>=ANY(ARRAY[1,2,3,4])</code>instead <code>IN (1,2,3,4)</code>for better results.</li>
<li>Control the size of the parameter list. In principle, it should not exceed 10,000. If it exceeds, you can consider batch processing.</li>
</ul>
<p><strong>It is not recommended to use left fuzzy search</strong></p>
<ul>
<li>Left fuzzy search <code>WHERE col LIKE '%xxx'</code>cannot make full use of B-tree index. If necessary, <code>reverse</code>expression function index can be used.</li>
</ul>
<p><strong>Use arrays instead of temporary tables</strong></p>
<ul>
<li>Consider using an array instead of a temporary table, for example when obtaining corresponding records for a series of IDs. <code>=ANY(ARRAY[1,2,3])</code>Better than temporary table JOIN.</li>
</ul>
<hr>
<h2 id="0x04-administration-convention">0x04 Administration Convention</h2>
<p><strong>Use Pigsty to build PostgreSQL cluster and infrastructure</strong></p>
<ul>
<li>The production environment uses the Pigsty trunk version uniformly, and deploys the database on x86_64 machines and CentOS 7.9 / RockyLinux 8.8 operating systems.</li>
<li><code>pigsty.yml</code>Configuration files usually contain highly sensitive and important confidential information. Git should be used for version management and access permissions should be strictly controlled.</li>
<li><code>files/pki</code>The CA private key and other certificates generated within the system should be properly kept, regularly backed up to a secure area for storage and archiving, and access permissions should be strictly controlled.</li>
<li>All passwords are not allowed to use default values, and make sure they have been changed to new passwords with sufficient strength.</li>
<li>Strictly control access rights to management nodes and configuration code warehouses, and only allow DBA login and access.</li>
</ul>
<p><strong>Monitoring system is a must</strong></p>
<ul>
<li>Any deployment must have a monitoring system, and the production environment uses at least two sets of Infra nodes to provide redundancy.</li>
</ul>
<p><strong>Properly plan the cluster architecture according to needs</strong></p>
<ul>
<li>Any production database cluster managed by a DBA must have at least one online slave database for online failover.</li>
<li>The template is used by default <code>oltp</code>, the analytical database uses <code>olap</code>the template, the financial database uses <code>crit</code>the template, and the micro virtual machine (within four cores) uses <code>tiny</code>the template.</li>
<li>For businesses whose annual data volume exceeds 1TB, or for clusters whose write TPS exceeds 30,000 to 50,000, you can consider building a horizontal sharding cluster.</li>
</ul>
<p><strong>Configure cluster high availability using Patroni and Etcd</strong></p>
<ul>
<li>The production database cluster uses Patroni as the high-availability component and etcd as the DCS.</li>
<li><code>etcd</code>Use a dedicated virtual machine cluster, with 3 to 5 nodes, strictly scattered and distributed on different cabinets.</li>
<li>Patroni Failsafe mode must be turned on to ensure that the cluster main library can continue to work when etcd fails.</li>
</ul>
<p><strong>Configure cluster PITR using pgBackRest and MinIO</strong></p>
<ul>
<li>The production database cluster uses pgBackRest as the backup recovery/PITR solution and MinIO as the backup storage warehouse.</li>
<li>MinIO uses a multi-node multi-disk cluster, and can also use S3/OSS/COS services instead. Password encryption must be set for cold backup.</li>
<li>All database clusters perform a local full backup every day, retain the backup and WAL of the last week, and save a full backup every other month.</li>
<li>When a WAL archiving error occurs, you should check the backup warehouse and troubleshoot the problem in time.</li>
</ul>
<p><strong>Core business database configuration considerations</strong></p>
<ul>
<li>The core business cluster needs to configure at least two online slave libraries, one of which is a dedicated offline query instance.</li>
<li>The core business cluster needs to build a delayed slave cluster with a 24-hour delay for emergency data recovery.</li>
<li>Core business clusters usually use asynchronous submission, while those related to money use synchronous submission.</li>
</ul>
<p><strong>Financial database configuration considerations</strong></p>
<ul>
<li>The financial database cluster requires at least two online slave databases, one of which is a dedicated synchronization Standby instance, and Standby service access is enabled.</li>
<li>Money-related libraries must use <code>crit</code>templates with RPO = 0, enable synchronous submission to ensure zero data loss, and enable Watchdog as appropriate.</li>
<li>Money-related libraries must be forced to turn on data checksums and, if appropriate, turn on full DML logs.</li>
</ul>
<p><strong>Use reasonable character encoding and localization configuration</strong></p>
<ul>
<li>Character encoding must be used <code>UTF8</code>, any other character encoding is strictly prohibited.</li>
<li>Must be used <code>C</code>as <code>LC_COLLATE</code>the default collation, any special requirements must be explicitly specified in the DDL/query clause to implement.</li>
<li>Character set <code>LC_CTYPE</code>is used by default <code>en_US.UTF8</code>, some extensions rely on character set information to work properly, such as <code>pg_trgm</code>.</li>
</ul>
<p><strong>Business database management considerations</strong></p>
<ul>
<li>Multiple different databases are allowed to be created in the same cluster, and Ansible scripts must be used to create new business databases.</li>
<li>All business databases must exist synchronously in the Pgbouncer connection pool.</li>
</ul>
<p><strong>Business user management considerations</strong></p>
<ul>
<li>Different businesses/services must use different database users, and Ansible scripts must be used to create new business users.</li>
<li>All production business users must be synchronized in the user list file of the Pgbouncer connection pool.</li>
<li>Individual users should set a password with a default validity period of 90 days and change it regularly.</li>
<li>Individual users are only allowed to access authorized cluster offline instances or slave <code>pg_offline_query</code>libraries with from the springboard machine.</li>
</ul>
<p><strong>Notes on extension management</strong></p>
<ul>
<li><code>yum/apt</code>When installing a new extension, you must first install the corresponding major version of the extension binary package in all instances of the cluster .</li>
<li>Before enabling the extension, you need to confirm whether the extension needs to be added <code>shared_preload_libraries</code>. If necessary, a rolling restart should be arranged.</li>
<li>Note that <code>shared_preload_libraries</code>in order of priority, <code>citus</code>, <code>timescaledb</code>, <code>pgml</code>are usually placed first.</li>
<li><code>pg_stat_statements</code>and <code>auto_explain</code>are required plugins and must be enabled in all clusters.</li>
<li>Install extensions uniformly using , and create them <code>dbsu</code>in the business database .<code>CREATE EXTENSION</code></li>
</ul>
<p><strong>Database XID and age considerations</strong></p>
<ul>
<li>Pay attention to the age of the database and tables to avoid running out of XID transaction numbers. If the usage exceeds 20%, you should pay attention; if it exceeds 50%, you should intervene immediately.</li>
<li>When processing XID, execute the table one by one in order of age from largest to smallest <code>VACUUM FREEZE</code>.</li>
</ul>
<p><strong>Database table and index expansion considerations</strong></p>
<ul>
<li>Pay attention to the expansion rate of tables and indexes to avoid index performance degradation, and use <code>pg_repack</code>online processing to handle table/index expansion problems.</li>
<li>Generally speaking, indexes and tables whose expansion rate exceeds 50% can be considered for reorganization.</li>
<li>When dealing with table expansion exceeding 100GB, you should pay special attention and choose business low times.</li>
</ul>
<p><strong>Database restart considerations</strong></p>
<ul>
<li>Before restarting the database, execute it <code>CHECKPOINT</code>twice to force dirty pages to be flushed, which can speed up the restart process.</li>
<li>Before restarting the database, perform <code>pg_ctl reload</code>reload configuration to confirm that the configuration file is available normally.</li>
<li>To restart the database, use <code>pg_ctl restart</code>patronictl or patronictl to restart the entire cluster at the same time.</li>
<li>Use <code>kill -9</code>to shut down any database process is strictly prohibited.</li>
</ul>
<p><strong>Replication latency considerations</strong></p>
<ul>
<li>Monitor replication latency, especially when using replication slots.</li>
</ul>
<p><strong>New slave database data warm-up</strong></p>
<ul>
<li>When adding a new slave database instance to a high-load business cluster, the new database instance should be warmed up, and the HAProxy instance weight should be gradually adjusted and applied in gradients: 4, 8, 16, 32, 64, and 100. <code>pg_prewarm</code>Hot data can be loaded into memory using .</li>
</ul>
<p><strong>Database publishing process</strong></p>
<ul>
<li>Online database release requires several evaluation stages: R&amp;D self-test, supervisor review, QA review (optional), and DBA review.</li>
<li>During the R&amp;D self-test phase, R&amp;D should ensure that changes are executed correctly in the development and pre-release environments.
<ul>
<li>If a new table is created, the record order magnitude, daily data increment estimate, and read and write throughput magnitude estimate should be given.</li>
<li>If it is a new function, the average execution time and extreme case descriptions should be given.</li>
<li>If it is a mode change, all upstream and downstream dependencies must be sorted out.</li>
<li>If it is a data change and record revision, a rollback SQL must be given.</li>
</ul>
</li>
<li>The R&amp;D Team Leader needs to evaluate and review changes and be responsible for the content of the changes.</li>
<li>The DBA evaluates and reviews the form and impact of the release, puts forward review opinions, and calls back or implements them uniformly.</li>
</ul>
<p><strong>Data work order format</strong></p>
<ul>
<li>Database changes are made through the platform, with one work order for each change.</li>
<li>The title is clear: A certain business needs <code>xx</code>to perform an action in the database <code>yy</code>.</li>
<li>The goal is clear: what operations need to be performed on which instances in each step, and how to verify the results.</li>
<li>Rollback plan: Any changes need to provide a rollback plan, and new ones also need to provide a cleanup script.</li>
<li>Any changes need to be recorded and archived, and have complete approval records. They are first approved by the R&amp;D superior TL Review and then approved by the DBA.</li>
</ul>
<p><strong>Database change release considerations</strong></p>
<ul>
<li>Using a unified release window, changes of the day will be collected uniformly at 16:00 every day and executed sequentially; requirements confirmed by TL after 16:00 will be postponed to the next day. Database release is not allowed after 19:00. For emergency releases, please ask TL to make special instructions and send a copy to the CTO for approval before execution.</li>
<li>Database DDL changes and DML changes are uniformly <code>dbuser_dba</code>executed remotely using the administrator user to ensure that the default permissions work properly.</li>
<li>When the business administrator executes DDL by himself, <strong>he must</strong><code>SET ROLE dbrole_admin</code> first execute the release to ensure the default permissions.</li>
<li>Any changes require a rollback plan before they can be executed, and very few operations that cannot be rolled back need to be handled with special caution (such as enumeration of value additions)</li>
<li>Database changes use <code>psql</code>command line tools, connect to the cluster main database to execute, use <code>\i</code>execution scripts or <code>\e</code>manual execution in batches.</li>
</ul>
<p><strong>Things to note when deleting tables</strong></p>
<ul>
<li>The production data table <code>DROP</code>should be renamed first and allowed to cool for 1 to 3 days to ensure that it is not accessed before being removed.</li>
<li>When cleaning the table, you must sort out all dependencies, including directly and indirectly dependent objects: triggers, foreign key references, etc.</li>
<li>The temporary table to be deleted is usually placed in <code>trash</code>Schema and <code>ALTER TABLE SET SCHEMA</code>the schema name is modified.</li>
<li>In high-load business clusters, when removing particularly large tables (&gt; 100G), select business valleys to avoid preempting I/O.</li>
</ul>
<p><strong>Things to note when creating and deleting indexes</strong></p>
<ul>
<li>You must use <code>CREATE INDEX CONCURRENTLY</code>concurrent index creation and <code>DROP INDEX CONCURRENTLY</code>concurrent index removal.</li>
<li>When rebuilding an index, always create a new index first, then remove the old index, and modify the new index name to be consistent with the old index.</li>
<li>After index creation fails, you should remove <code>INVALID</code>the index in time. After modifying the index, use <code>analyze</code>to re-collect statistical data on the table.</li>
<li>When the business is idle, you can enable parallel index creation and set it <code>maintenance_work_mem</code>to a larger value to speed up index creation.</li>
</ul>
<p><strong>Make schema changes carefully</strong></p>
<ul>
<li>Try to avoid full table rewrite changes as much as possible. Full table rewrite is allowed for tables within 1GB. The DBA should notify all relevant business parties when the changes are made.</li>
<li>When adding new columns to an existing table, you should avoid using functions in default values <code>VOLATILE</code>to avoid a full table rewrite.</li>
<li>When changing a column type, all functions and views that depend on that type should be rebuilt if necessary, and <code>ANALYZE</code>statistics should be refreshed.</li>
</ul>
<p><strong>Control the batch size of data writing</strong></p>
<ul>
<li>Large batch write operations should be divided into small batches to avoid generating a large amount of WAL or occupying I/O at one time.</li>
<li>After a large batch <code>UPDATE</code>is executed, <code>VACUUM</code>the space occupied by dead tuples is reclaimed.</li>
<li>The essence of executing DDL statements is to modify the system directory, and it is also necessary to control the number of DDL statements in a batch.</li>
</ul>
<p><strong>Data loading considerations</strong></p>
<ul>
<li>Use <code>COPY</code>load data, which can be executed in parallel if necessary.</li>
<li>You can temporarily shut down before loading data <code>autovacuum</code>, disable triggers as needed, and create constraints and indexes after loading.</li>
<li>Turn it up <code>maintenance_work_mem</code>, increase it <code>max_wal_size</code>.</li>
<li>Executed after loading is complete <code>vacuum verbose analyze table</code>.</li>
</ul>
<p><strong>Notes on database migration and major version upgrades</strong></p>
<ul>
<li>The production environment uniformly uses standard migration to build script logic, and realizes requirements such as non-stop cluster migration and major version upgrades through blue-green deployment.</li>
<li>For clusters that do not require downtime, you can use <code>pg_dump | psql</code>logical export and import to stop and upgrade.</li>
</ul>
<p><strong>Data Accidental Deletion/Accidental Update Process</strong></p>
<ul>
<li>After an accident occurs, immediately assess whether it is necessary to stop the operation to stop bleeding, assess the scale of the impact, and decide on treatment methods.</li>
<li>If there is a way to recover on the R&amp;D side, priority will be given to the R&amp;D team to make corrections through SQL publishing; otherwise, use <code>pageinspect</code>and <code>pg_dirtyread</code>to rescue data from the bad table.</li>
<li>If there is a delayed slave library, extract data from the delayed slave library for repair. First, confirm the time point of accidental deletion, and advance the delay to extract data from the database to the XID.</li>
<li>A large area was accidentally deleted and written. After communicating with the business and agreeing, perform an in-place PITR rollback to a specific time.</li>
</ul>
<p><strong>Data corruption processing process</strong></p>
<ul>
<li>Confirm whether the slave database data can be used for recovery. If the slave database data is intact, you can switchover to the slave database first.</li>
<li>Temporarily shut down <code>auto_vacuum</code>, locate the root cause of the error, replace the failed disk and add a new slave database.</li>
<li>If the system directory is damaged, or use to <code>pg_filedump</code>recover data from table binaries.</li>
<li>If the CLOG is damaged, use <code>dd</code>to generate a fake submission record.</li>
</ul>
<p><strong>Things to note when the database connection is full</strong></p>
<ul>
<li>When the connection is full (avalanche), immediately use the kill connection query to cure the symptoms and stop the loss: <code>pg_cancel_backend</code>or <code>pg_terminate_backend</code>.</li>
<li>Use to <code>pg_terminate_backend</code>abort all normal backend processes, <code>psql</code> <code>\watch 1</code>starting with once per second ( ). And confirm the connection status from the monitoring system. If the accumulation continues, continue to increase the execution frequency of the connection killing query, for example, once every 0.1 seconds until there is no more accumulation.</li>
<li>After confirming that the bleeding has stopped from the monitoring system, try to stop the killing connection. If the accumulation reappears, immediately resume the killing connection. Immediately analyze the root cause and perform corresponding processing (upgrade, limit current, add index, etc.)</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-9ac7b152e2b98d51f3cf9cda74feaf4a">PostgreSQL, The most successful database</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com">RuohangFeng</a>(<a href="https://vonng.com/en/">@Vonng</a>)| <a href="https://mp.weixin.qq.com/s/xewE87WEaZHp-K5hjuk65A">WeChat</a> | <a href="https://zhuanlan.zhihu.com/p/542019272">Zhihu</a></b> |
        
		<time datetime="2023-06-28" class="text-muted">2023-06-28</time>
        
	</div>
	<p>The <a href="https://survey.stackoverflow.co/2023">StackOverflow 2023 Survey</a>, featuring feedback from 90K developers across 185 countries, is out. PostgreSQL topped all three survey categories (used, loved, and wanted), earning its title as the undisputed &ldquo;Decathlete Database&rdquo; – it&rsquo;s hailed as the <strong>&ldquo;Linux of Database&rdquo;</strong>!</p>
<p><img src="/img/blog/db/pg-is-no1-1.png"></p>
<blockquote>
<p><a href="https://demo.pigsty.cc/d/sf-survey">https://demo.pigsty.cc/d/sf-survey</a></p>
</blockquote>
<p>What makes a database &ldquo;successful&rdquo;? It’s a mix of features, quality, security, performance, and cost, but success is mainly about adoption and legacy. The size, preference, and needs of its user base are what truly shape its ecosystem&rsquo;s prosperity. StackOverflow&rsquo;s annual surveys for seven years have provided a window into tech trends.</p>
<p><strong>PostgreSQL is now the world’s most popular database.</strong></p>
<p><strong>PostgreSQL is developers&rsquo; favorite database!</strong></p>
<p><strong>PostgreSQL sees the highest demand among users!</strong></p>
<p>Popularity, the <code>used</code> reflects the past, the <code>loved</code> indicates the present, and the <code>wanted</code> suggests the future. These metrics vividly showcase the vitality of a technology. PostgreSQL stands strong in both stock and potential, unlikely to be rivaled soon.</p>
<p>As a dedicated user, community member, expert, evangelist, and contributor to PostgreSQL, witnessing this moment is profoundly moving. Let&rsquo;s delve into the &ldquo;Why&rdquo; and &ldquo;What&rdquo; behind this phenomenon.</p>
<hr>
<h2 id="source-community-survey">Source: Community Survey</h2>
<p>Developers define the success of databases, and StackOverflow&rsquo;s survey, with popularity, love, and demand metrics, captures this directly.</p>
<blockquote>
<p>“Which <strong>database environments</strong> have you done extensive development work in over the past year, and which do you want to work in over the next year? If you both worked with the database and want to continue to do so, please check both boxes in that row.”</p>
</blockquote>
<p>Each database in the survey had two checkboxes: one for current use, marking the user as &ldquo;Used,&rdquo; and one for future interest, marking them as &ldquo;Wanted.&rdquo; Those who checked both were labeled as &ldquo;Loved/Admired.&rdquo;</p>
<p><img src="/img/blog/db/pg-is-no1-2.png"></p>
<blockquote>
<p><a href="https://survey.stackoverflow.co/2023">https://survey.stackoverflow.co/2023</a></p>
</blockquote>
<p>The percentage of &ldquo;Used&rdquo; respondents represents <strong>popularity</strong> or usage rate, shown as a bar chart, while &ldquo;Wanted&rdquo; indicates demand or desire, marked with blue dots. &ldquo;Loved/Admired&rdquo; shows as red dots, indicating love or reputation. In 2023, PostgreSQL outstripped MySQL in popularity, becoming the world’s most popular database, and led by a wide margin in demand and reputation.</p>
<p>Reviewing seven years of data and plotting the top 10 databases on a scatter chart of popularity vs. net love percentage (2*love% - 100), we gain insights into the database field&rsquo;s evolution and sense of scale.</p>
<p><img src="/img/blog/db/pg-is-no1-3.gif"></p>
<blockquote>
<p>X: Popularity, Y: Net Love Index (2 * loved - 100)</p>
</blockquote>
<p>The 2023 snapshot shows PostgreSQL in the top right, popular and loved, while MySQL, popular yet less favored, sits in the bottom right. Redis, moderately popular but much loved, is in the top left, and Oracle, neither popular nor loved, is in the bottom left. In the middle lie SQLite, MongoDB, and SQL Server.</p>
<p>Trends indicate PostgreSQL&rsquo;s growing popularity and love; MySQL&rsquo;s love remains flat with falling popularity. Redis and SQLite are progressing, MongoDB is peaking and declining, and the commercial RDBMSs SQL Server and Oracle are on a downward trend.</p>
<p>The takeaway: PostgreSQL&rsquo;s standing in the database realm, akin to Linux in server OS, seems unshakeable for the foreseeable future.</p>
<hr>
<h2 id="historical-accumulation-popularity">Historical Accumulation: Popularity</h2>
<blockquote>
<p>PostgreSQL — The world&rsquo;s most popular database</p>
</blockquote>
<p>Popularity is the percentage of total users who have used a technology in the past year. It reflects the accumulated usage over the past year and is a core metric of factual significance.</p>
<p>In 2023, PostgreSQL, branded as the &ldquo;most advanced,&rdquo; surpassed the &ldquo;most popular&rdquo; database MySQL with a usage rate of 45.6%, leading by 4.5% and reaching 1.1 times the usage rate of MySQL at 41.1%. Among professional developers (about three-quarters of the sample), PostgreSQL had already overtaken MySQL in 2022, with a 0.8 percentage point lead (46.5% vs 45.7%); this gap widened in 2023 to 49.1% vs 40.6%, or 1.2 times the usage rate among professional developers.</p>
<p>Over the past years, MySQL enjoyed the top spot in database popularity, proudly claiming the title of the “world’s most popular open-source relational database.” However, PostgreSQL has now claimed the crown. Compared to PostgreSQL and MySQL, other databases are not in the same league in terms of popularity.</p>
<p>The key trend to note is that among the top-ranked databases, only PostgreSQL has shown a consistent increase in popularity, demonstrating strong growth momentum, while all other databases have seen a decline in usage. As time progresses, the gap in popularity between PostgreSQL and other databases will likely widen, making it hard for any challenger to displace PostgreSQL in the near future.</p>
<p>Notably, the &ldquo;domestic database&rdquo; TiDB has entered the StackOverflow rankings for the first time, securing the 32nd spot with a 0.2% usage rate.</p>
<p>Popularity reflects the current scale and potential of a database, while love indicates its future growth potential.</p>
<hr>
<h2 id="current-momentum-love">Current Momentum: Love</h2>
<blockquote>
<p>PostgreSQL — The database developers love the most</p>
</blockquote>
<p>Love or admiration is a measure of the percentage of users who are willing to continue using a technology, acting as an annual &ldquo;retention rate&rdquo; metric that reflects the user&rsquo;s opinion and evaluation of the technology.</p>
<p>In 2023, PostgreSQL retained its title as the most loved database by developers. While Redis had been the favorite in previous years, PostgreSQL overtook Redis in 2022, becoming the top choice. PostgreSQL and Redis have maintained close reputation scores (around 70%), significantly outpacing other contenders.</p>
<p><img src="/img/blog/db/pg-is-no1-6.png"></p>
<p>In the 2022 PostgreSQL community survey, the majority of existing PostgreSQL users reported increased usage and deeper engagement, highlighting the stability of its core user base.</p>
<p><img src="/img/blog/db/pg-is-no1-7.png"></p>
<p>Redis, known for its simplicity and ease of use as a data structure cache server, is often paired with the relational database PostgreSQL, enjoying considerable popularity (20%, ranking sixth) among developers. Cross-analysis shows a strong connection between the two: 86% of Redis users are interested in using PostgreSQL, and 30% of PostgreSQL users want to use Redis. Other databases with positive reviews include SQLite, MongoDB, and SQL Server. MySQL and ElasticSearch receive mixed feedback, hovering around the 50% mark. The least favored databases include Access, IBM DB2, CouchDB, Couchbase, and Oracle.</p>
<p>Not all <strong>potential</strong> can be converted into kinetic energy. While user affection is significant, it doesn&rsquo;t always translate into action, leading to the third metric of interest – demand.</p>
<hr>
<h2 id="future-trends-demand">Future Trends: Demand</h2>
<blockquote>
<p>PostgreSQL - The Most Wanted Database</p>
</blockquote>
<p>The demand rate, or the level of desire, represents the percentage of users who will actually opt for a technology in the coming year. PostgreSQL stands out in demand/desire, significantly outpacing other databases with a 42.3% rate for the second consecutive year, showing relentless growth and widening the gap with its competitors.</p>
<p><img src="/img/blog/db/pg-is-no1-8.png"></p>
<p>In 2023, some databases saw notable demand increases, likely driven by the surge in large language model AI, spearheaded by OpenAI&rsquo;s ChatGPT. This demand for intelligence has, in turn, fueled the need for robust data infrastructure. A decade ago, support for NoSQL features like JSONB/GIN laid the groundwork for PostgreSQL&rsquo;s explosive growth during the internet boom. Today, the introduction of pgvector, the first vector extension built on a mature database, grants PostgreSQL a ticket into the AI era, setting the stage for growth in the next decade.</p>
<hr>
<h2 id="but-why">But Why?</h2>
<p>PostgreSQL leads in demand, usage, and popularity, with the right mix of timing, location, and human support, making it arguably the most successful database with no visible challengers in the near future. The secret to its success lies in its slogan: <strong>&ldquo;The World&rsquo;s Most Advanced Open Source Relational Database.&rdquo;</strong></p>
<p>Relational databases are so prevalent and crucial that they might dwarf the combined significance of other types like key-value, document, search engine, time-series, graph, and vector databases. Typically, &ldquo;database&rdquo; implicitly refers to &ldquo;relational database,&rdquo; where no other category dares claim mainstream status. Last year&rsquo;s &ldquo;Why PostgreSQL Will Be the Most Successful Database?&rdquo; delves into the competitive landscape of relational databases—a tripartite dominance. Excluding Microsoft’s relatively isolated SQL Server, the database scene, currently in a phase of consolidation, has three key players rooted in WireProtocol: Oracle, MySQL, and PostgreSQL, mirroring a <strong>&ldquo;Three Kingdoms&rdquo;</strong> saga in the relational database realm.</p>
<p><img src="/img/blog/db/pg-is-no1-9.png"></p>
<p>Oracle/MySQL are waning, while PostgreSQL is thriving. Oracle is an established commercial DB with deep tech history, rich features, and strong support, favored by well-funded, risk-averse enterprises, especially in finance. Yet, it&rsquo;s pricey and infamous for litigious practices. MS SQL Server shares similar traits with Oracle. Commercial databases are facing a slow decline due to the open-source wave.</p>
<p>MySQL, popular yet beleaguered, lags in stringent transaction processing and data analysis compared to PostgreSQL. Its agile development approach is also outperformed by NoSQL alternatives. Oracle&rsquo;s dominance, sibling rivalry with MariaDB, and competition from NewSQL players like TiDB/OB contribute to its decline.</p>
<p>Oracle, no doubt skilled, lacks integrity, hence &ldquo;talented but unprincipled.&rdquo; MySQL, despite its open-source merit, is limited in capability and sophistication, hence &ldquo;limited talent, weak ethics.&rdquo; PostgreSQL, embodying both capability and integrity, aligns with the open-source rise, popular demand, and advanced stability, epitomizing &ldquo;talented and principled.&rdquo;</p>
<hr>
<h2 id="open-source--advanced">Open Source &amp; Advanced</h2>
<p>The primary reasons for choosing PostgreSQL, as reflected in the TimescaleDB community survey, are its open-source nature and stability. Open-source implies free use, potential for modification, no vendor lock-in, and no &ldquo;chokepoint&rdquo; issues. Stability means reliable, consistent performance with a proven track record in large-scale production environments. Experienced developers value these attributes highly.</p>
<p>Broadly, aspects like extensibility, ecosystem, community, and protocols fall under &ldquo;open-source.&rdquo; Stability, ACID compliance, SQL support, scalability, and availability define &ldquo;advanced.&rdquo; These resonate with PostgreSQL&rsquo;s slogan: &ldquo;The world&rsquo;s most advanced open source relational database.&rdquo;</p>
<p><img src="/img/blog/db/pg-is-no1-10.png"></p>
<blockquote>
<p><a href="https://www.timescale.com/state-of-postgres/2022">https://www.timescale.com/state-of-postgres/2022</a></p>
</blockquote>
<hr>
<h2 id="the-virtue-of-open-source">The Virtue of Open Source</h2>
<blockquote>
<p>powered by developers worldwide. Friendly BSD license, thriving ecosystem, extensive expansion. A robust Oracle alternative, leading the charge.</p>
</blockquote>
<p>What is &ldquo;virtue&rdquo;? It&rsquo;s the manifestation of &ldquo;the way,&rdquo; and this way is <strong>open source</strong>. PostgreSQL stands as a venerable giant among open-source projects, epitomizing global collaborative success.</p>
<p>Back in the day, developing software/information services required exorbitantly priced <strong>commercial databases</strong>. Just the software licensing fees could hit six or seven figures, not to mention similar costs for hardware and service subscriptions. Oracle&rsquo;s licensing fee per CPU core could reach hundreds of thousands annually, prompting even giants like Alibaba to seek <strong>IOE alternatives</strong>. The rise of <strong>open-source databases</strong> like <strong>PostgreSQL</strong> and <strong>MySQL</strong> offered a fresh choice.</p>
<p>Open-source databases, free of charge, spurred an industry revolution: from tens of thousands per core per month for commercial licenses to a mere 20 bucks per core per month for hardware. Databases became accessible to regular businesses, enabling the provision of free information services.</p>
<p><img src="/img/blog/db/pg-is-no1-11.png"></p>
<p>Open source has been monumental: the history of the internet is a history of open-source software. The prosperity of the IT industry and the plethora of free information services owe much to open-source initiatives. <strong>Open source represents a form of successful Communism</strong> in software, with the industry&rsquo;s core means of production becoming communal property, available to developers worldwide as needed. Developers contribute according to their abilities, embracing the ethos of mutual benefit.</p>
<p>An open-source programmer&rsquo;s work encapsulates the intellect of countless top-tier developers. Programmers command high salaries because they are not mere laborers but <strong>contractors</strong> orchestrating software and hardware. They own the core means of production: software from the public domain and readily available server hardware. Thus, a few skilled engineers can swiftly tackle domain-specific problems leveraging the <strong>open-source ecosystem</strong>.</p>
<p><strong>Open source synergizes community efforts, drastically reducing redundancy and propelling technical advancements at an astonishing pace. Its momentum, now unstoppable, continues to grow like a snowball.</strong> Open source dominates foundational software, and the industry now views insular development or so-called &ldquo;self-reliance&rdquo; in software, especially in foundational aspects, as a colossal joke.</p>
<p><img src="/img/blog/db/pg-is-no1-12.png"></p>
<p><strong>For PostgreSQL, open source is its strongest asset against Oracle.</strong></p>
<p>Oracle is advanced, but PostgreSQL holds its own. It&rsquo;s the most Oracle-compatible open-source database, natively supporting 85% of Oracle&rsquo;s features, with specialized distributions reaching 96% compatibility. However, the real game-changer is cost: PG&rsquo;s open-source nature and significant cost advantage provide a substantial ecological niche. It doesn&rsquo;t need to surpass Oracle in features; being &ldquo;90% right at a fraction of the cost&rdquo; is enough to outcompete Oracle.</p>
<p>PostgreSQL is like an open-source &ldquo;Oracle,&rdquo; the only real threat to Oracle&rsquo;s dominance. As a leader in the &ldquo;de-Oracle&rdquo; movement, PG has spawned numerous &ldquo;domestically controllable&rdquo; database companies. According to CITIC, 36% of &ldquo;domestic databases&rdquo; are based on PG modifications or rebranding, with Huawei&rsquo;s openGauss and GaussDB as prime examples. Crucially, PostgreSQL uses a BSD-Like license, permitting such adaptations — you can rebrand and sell without deceit. This open attitude is something Oracle-acquired, GPL-licensed MySQL can&rsquo;t match.</p>
<hr>
<h2 id="the-advanced-in-talent">The advanced in Talent</h2>
<blockquote>
<p>The talent of PG lies in its advancement. Specializing in multiple areas, PostgreSQL offers a full-stack, multi-model approach: &ldquo;Self-managed, autonomous driving temporal-geospatial AI vector distributed document graph with full-text search, programmable hyper-converged, federated stream-batch processing in a single HTAP Serverless full-stack platform database&rdquo;, covering almost all database needs with a single component.</p>
</blockquote>
<p>PostgreSQL is not just a traditional OLTP &ldquo;relational database&rdquo; but a multi-modal database. For SMEs, a single PostgreSQL component can cover the vast majority of their data needs: OLTP, OLAP, time-series, GIS, tokenization and full-text search, JSON/XML documents, NoSQL features, graphs, vectors, and more.</p>
<p><img src="/img/blog/db/pg-is-no1-13.png"></p>
<blockquote>
<p>Emperor of Databases — Self-managed, autonomous driving temporal-geospatial AI vector distributed document graph with full-text search, programmable hyper-converged, federated stream-batch processing in a single HTAP Serverless full-stack platform database.</p>
</blockquote>
<p>The superiority of PostgreSQL is not only in its acclaimed <strong>kernel stability</strong> but also in its powerful <strong>extensibility</strong>. The plugin system transforms PostgreSQL from a single-threaded evolving database kernel to a platform with countless parallel-evolving extensions, exploring all possibilities simultaneously like quantum computing. PostgreSQL is omnipresent in every niche of data processing.</p>
<p>For instance, PostGIS for geospatial databases, TimescaleDB for time-series, Citus for distributed/columnar/HTAP databases, PGVector for AI vector databases, AGE for graph databases, PipelineDB for stream processing, and the ultimate trick — using Foreign Data Wrappers (FDW) for unified SQL access to all heterogeneous external databases. Thus, PG is a true full-stack database platform, far more advanced than a simple OLTP system like MySQL.</p>
<p><img src="/img/blog/db/pg-is-no1-14.png"></p>
<p>Within a significant scale, PostgreSQL can play multiple roles with a single component, greatly reducing project complexity and cost. Remember, designing for unneeded scale is futile and an example of <strong>premature optimization</strong>. If one technology can meet all needs, it&rsquo;s the best choice rather than reimplementing it with multiple components.</p>
<p>Taking Tantan as an example, with <strong>250 million TPS</strong> and <strong>200 TB</strong> of unique TP data, <strong>a single PostgreSQL selection</strong> remains stable and reliable, covering a wide range of functions beyond its primary OLTP role, including caching, OLAP, batch processing, and even message queuing. However, as the user base approaches <strong>tens of millions daily active users</strong>, these additional functions will eventually need to be handled by dedicated components.</p>
<p><img src="/img/blog/db/pg-is-no1-15.png"></p>
<p>PostgreSQL&rsquo;s advancement is also evident in its thriving ecosystem. Centered around the database kernel, there are specialized variants and &ldquo;higher-level databases&rdquo; built on it, like Greenplum, Supabase (an open-source alternative to Firebase), and the specialized graph database edgedb, among others. There are various open-source/commercial/cloud distributions integrating tools, like different RDS versions and the plug-and-play Pigsty; horizontally, there are even powerful mimetic components/versions emulating other databases without changing client drivers, like babelfish for SQL Server, FerretDB for MongoDB, and EnterpriseDB/IvorySQL for Oracle compatibility.</p>
<p><img src="/img/blog/db/pg-is-no1-16.png"></p>
<p>PostgreSQL&rsquo;s advanced features are its core competitive strength against MySQL, another open-source relational database.</p>
<p><strong>Advancement is PostgreSQL&rsquo;s core competitive edge over MySQL.</strong></p>
<p>MySQL&rsquo;s slogan is &ldquo;the world&rsquo;s most popular open-source relational database,&rdquo; characterized by being rough, fierce, and fast, catering to internet companies. These companies prioritize simplicity (mainly CRUD), data consistency and accuracy less than traditional sectors like banking, and can tolerate data inaccuracies over service downtime, unlike industries that cannot afford financial discrepancies.</p>
<p>However, times change, and PostgreSQL has rapidly advanced, surpassing MySQL in speed and robustness, leaving only &ldquo;roughness&rdquo; as MySQL&rsquo;s remaining trait.</p>
<p><img src="/img/blog/db/pg-is-no1-17.png"></p>
<blockquote>
<p>MySQL allows partial transaction commits by default, shocked</p>
</blockquote>
<p>MySQL allows partial transaction commits by default, revealing a gap between &ldquo;popular&rdquo; and &ldquo;advanced.&rdquo; Popularity fades with obsolescence, while advancement gains popularity through innovation. In times of change, without advanced features, popularity is fleeting. Research shows MySQL&rsquo;s pride in &ldquo;popularity&rdquo; cannot stand against PostgreSQL&rsquo;s &ldquo;advanced&rdquo; superiority.</p>
<p><strong>Advancement</strong> and <strong>open-source</strong> are PostgreSQL&rsquo;s success secrets. While Oracle is advanced and MySQL is open-source, PostgreSQL boasts both. With the right conditions, success is inevitable.</p>
<hr>
<h2 id="looking-ahead">Looking Ahead</h2>
<p>The PostgreSQL database kernel&rsquo;s role in the database ecosystem mirrors the Linux kernel&rsquo;s in the operating system domain. For databases, particularly OLTP, the battle of kernels has settled—PostgreSQL is now a perfect engine.</p>
<p>However, users need more than an engine; they need the complete car, driving capabilities, and traffic services. The database competition has shifted from software to <strong>Software enabled Service—complete database distributions and services</strong>. The race for PostgreSQL-based distributions is just beginning. Who will be the PostgreSQL equivalent of Debian, RedHat, or Ubuntu?</p>
<p>This is why we created <strong><a href="https://pigsty.io/">Pigsty</a></strong> — to develop an battery-included, open-source, local-first PostgreSQL distribution, making it easy for everyone to access and utilize a <strong>quality database service</strong>. Due to space limits, the detailed story is for <a href="/zh/blog//db/pgsql-x-pigsty/">another time</a>.</p>
<p><img src="/img/blog/db/pg-is-no1-18.png"></p>
<hr>
<h2 id="参考阅读">参考阅读</h2>
<p>2022-08 《<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485240&idx=1&sn=9052f03ae2ef21d9e21037fd7a1fa7fe&chksm=fe4b32e3c93cbbf522616346c1afd49e1e6edbb0898694df224fe2134a69c0c4562aab35587a&scene=21#wechat_redirect">PostgreSQL 到底有多强？</a>》</p>
<p>2022-07 《<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485216&idx=1&sn=1b59c7dda5f347145c2f39d2679a274d&chksm=fe4b32fbc93cbbed574358a3bcf127dd2e4f458638b46efaee1a885a5702a66a5d9ca18e3f90&scene=21#wechat_redirect">为什么PostgreSQL是最成功的数据库？</a>》</p>
<p>2022-06 《<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485170&idx=1&sn=657c75be06557df26e4521ce64178f14&chksm=fe4b3329c93cba3f840283c9df0e836e96a410f540e34ac9b1b68ca4d6247d5f31c94e2a41f4&scene=21#wechat_redirect">StackOverflow 2022数据库年度调查</a>》</p>
<p>2021-05 《<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247484604&idx=1&sn=357b3381e7636709fa9e5e06894b7273&chksm=fe4b3167c93cb8719b7c6b048fd300a7773c73319ba0c119359f4f8a6684cd969434c5abbdfd&scene=21#wechat_redirect">Why PostgreSQL Rocks!</a>》</p>
<p>2021-05 《<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247484591&idx=1&sn=a6ab13d93bfa26fca969ba163b01e1d5&chksm=fe4b3174c93cb862899cbce4b9063ed009bfe735df16bce6b246042e897d494648473eea3cea&scene=21#wechat_redirect">为什么说PostgreSQL前途无量？</a>》</p>
<p>2018 《<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247483706&idx=1&sn=b842684b41ac6dde8310448ae0a81a76&chksm=fe4b34e1c93cbdf7dcfcdae5f3ddc38bc422989421266dcda957fa2b596e361815624c92b3ec&scene=21#wechat_redirect">PostgreSQL 好处都有啥？</a>》</p>
<p>2023 《<a href="http://mp.weixin.qq.com/s?__biz=MzU5ODAyNTM5Ng==&mid=2247485518&idx=1&sn=3d5f3c753facc829b2300a15df50d237&chksm=fe4b3d95c93cb4833b8e80433cff46a893f939154be60a2a24ee96598f96b32271301abfda1f&scene=21#wechat_redirect">更好的开源RDS替代：Pigsty</a>》</p>
<p>2023 《<a href="http://demo.pigsty.cc/d/sf-db-survey">StackOverflow 7年调研数据跟踪</a>》</p>
<p>2022 《<a href="https://www.timescale.com/state-of-postgres/2022">PostgreSQL 社区状态调查报告 2022</a>》</p>

</div>





    
	
  

    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-fbc771f2981eed29c0bc016b2d68a41a">Releases</h1>
	
	<div class="td-byline mb-4">
		
        
	</div>
	
</div>





    
      
  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-93a85e78558ffe12d450f9660ac47211">v3.1: PG 17 as default, Better Supabase &amp; MinIO, ARM &amp; U24 support</h1>
	
	<div class="td-byline mb-4">
		By <b><a href="https://vonng.com">Ruohang Feng</a>(<a href="https://vonng.com/en/">@Vonng</a> | <a href="https://github.com/Vonng/pigsty/releases/tag/v3.1.0">ReleaseNote</a></b> |
        
		<time datetime="2024-11-24" class="text-muted">2024-11-24</time>
        
	</div>
	<p>With the release of <strong>PostgreSQL 17.2</strong> earlier this week, Pigsty promptly followed up with its <strong>v3.1</strong> release.</p>
<p>In this version, PostgreSQL 17 has been promoted as the default major version, and nearly <a href="https://ext.pigsty.io/#/list"><strong>340 PostgreSQL extensions</strong></a> are now available out of the box.</p>
<p>Additionally, Pigsty 3.1 introduces the ability to <a href="/blog/db/supabase/">self-hosting Supabase</a> with a simple command,
improves best practices for using <a href="/docs/minio/">MinIO</a> the object storage.</p>
<p>It also supports the ARM64 arch, and the newly released Ubuntu 24.04 LTS.
And provide a way to simplify configuration management across different OS distro and PG major versions.</p>
<p>Finally, pigsty also provides  a range of ready-to-use scenario-based <a href="/docs/conf/">templates</a> in this release.</p>
<hr>
<h2 id="self-hosting-supabase">Self-Hosting Supabase</h2>
<blockquote>
<p>The complete tutorial for <a href="/blog/db/supabase/">self-hosting supabase</a></p>
</blockquote>
<p><a href="https://supabase.com/">Supabase</a> is an open-source Firebase alternative, a Backend as a Service (BaaS).</p>
<p>Supabase wraps PostgreSQL kernel and vector extensions, alone with authentication, realtime subscriptions, edge functions, object storage, and instant REST and GraphQL APIs from your postgres schema.
It let you skip most backend work, requiring only database design and frontend skills to ship quickly.</p>
<p>Currently, Supabase may be the <a href="https://ossrank.com/cat/368-postgresql-extension-ecosystem">most popular</a> open-source project in the PostgreSQL ecosystem, boasting over 74,000 stars on GitHub.
And become quite popular among developers, and startups, since they have a <a href="https://supabase.com/pricing">generous free plan</a>, just like cloudflare &amp; neon.</p>
<p>Supabase&rsquo;s slogan is: &ldquo;<strong>Build in a weekend, Scale to millions</strong>&rdquo;. It has great cost-effectiveness in small scales (4c8g) indeed.
But there is no doubt that when you really grow to millions of users, some may choose to self-hosting their own Supabase —— for functionality, performance, cost, and other reasons.</p>
<p>That&rsquo;s where Pigsty comes in. Pigsty provides a complete one-click self-hosting solution for Supabase.
Self-hosted Supabase can enjoy full PostgreSQL monitoring, IaC, PITR, and high availability capability,</p>
<p>You can run the latest PostgreSQL 17(,16,15,14) kernels, (supabase is using the 15 currently), alone with <a href="https://ext.pigsty.io/#/list">340</a> PostgreSQL extensions out-of-the-box.
Run on <a href="/docs/reference/compatibility/">mainstream</a> Linus OS distros with production grade <a href="/docs/concept/ha/">HA</a> <a href="/docs/pgsql/">PostgreSQL</a>, <a href="/docs/minio/">MinIO</a>, Prometheus &amp; Grafana Stack for observability, and Nginx for reverse proxy.</p>
<p>Since most of the supabase maintained extensions are not available in the official PGDG repo,
we have compiled all the RPM/DEBs for these extensions and put them in the <a href="https://ext.pigsty.io">Pigsty repo</a>:
<a href="https://ext.pigsty.io/#/pg_graphql">pg_graphql</a>, <a href="https://ext.pigsty.io/#/pg_jsonschema">pg_jsonschema</a>, <a href="https://ext.pigsty.io/#/wrappers">wrappers</a>, <a href="https://ext.pigsty.io/#/index_advisor">index_advisor</a>, <a href="https://ext.pigsty.io/#/pg_net">pg_net</a>, <a href="https://ext.pigsty.io/#/vault">vault</a>, <a href="https://ext.pigsty.io/#/pgjwt">pgjwt</a>, <a href="https://ext.pigsty.io/#/supautils">supautils</a>, <a href="https://ext.pigsty.io/#/plan_filter">pg_plan_filter</a>,</p>
<p>Everything is under your control, you have the ability and freedom to scale PGSQL, MinIO, and Supabase itself.
And take full advantage of the performance and cost advantages of modern hardware like Gen5 NVMe SSD.</p>
<p>All you need is prepare a VM with several commands and wait for 10 minutes&hellip;.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> curl -fsSL https://repo.pigsty.io/get <span style="color:#000;font-weight:bold">|</span> bash
</span></span><span style="display:flex;"><span>./bootstrap          <span style="color:#8f5902;font-style:italic"># install deps (ansible)</span>
</span></span><span style="display:flex;"><span>./configure -c supa  <span style="color:#8f5902;font-style:italic"># use supa config template (IMPORTANT: CHANGE PASSWORDS!)</span>
</span></span><span style="display:flex;"><span>./install.yml        <span style="color:#8f5902;font-style:italic"># install pigsty, create ha postgres &amp; minio clusters </span>
</span></span><span style="display:flex;"><span>./supabase.yml       <span style="color:#8f5902;font-style:italic"># launch stateless supabase containers with docker compose</span>
</span></span></code></pre></div><p><a href="https://asciinema.org/a/692194"><img alt="asciicast" src="https://asciinema.org/a/692194.svg"></a></p>
<hr>
<h2 id="postgresql-17">PostgreSQL 17</h2>
<p>PostgreSQL 17 has some exciting new features, but the most notable improvement is its write performance.
I tested it on a 128c physical machine and found that it performed well as expected under pigsty&rsquo;s default OLTP configuration without any tuning.</p>
<p><img alt="perf.png" src="/zh/blog/releases/v3.1.0/perf.png"></p>
<blockquote>
<p>pgbench &amp; sysbench results on a 128c BM with PG 17.2</p>
</blockquote>
<p>For example, the max LSN Rate (WAL throughput) is around 110 MiB/s @ PostgreSQL 14,
while it can reach 180 MiB/s @ PostgreSQL 17. Of course, this is the software bottleneck, not the hardware.
We can see a significant improvement in write performance, which is crucial for many OLTP workloads.</p>
<p>The detailed performance comparison will be published in the upcoming blog post, so stay tuned!</p>
<hr>
<h2 id="340-extensions">340 Extensions</h2>
<p>One of the standout features of Pigsty 3.1 is its support for <strong>340 PostgreSQL extensions</strong>.
This impressive number comes even after carefully pruning over a dozen &ldquo;obsolete extensions&rdquo;.</p>
<p>To achieve this milestone, I’ve built a <a href="https://ext.pigsty.io/#/usage"><strong>YUM/APT repository</strong></a> that offers pre-packaged RPM/DEB files for the following combinations of operating systems and PostgreSQL versions:</p>
<ul>
<li><strong>Operating Systems</strong>: EL 8/9, Ubuntu 22.04/24.04, Debian 12</li>
<li><strong>PostgreSQL Versions</strong>: PG 12–17</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">Code</th>
<th>OS Distro</th>
<th style="text-align:center"><code>x86_64</code></th>
<th style="text-align:center">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>EL9</strong></td>
<td>RHEL 9 / Rocky9 / Alma9</td>
<td style="text-align:center"><code>el9.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>EL8</strong></td>
<td>RHEL 8 / Rocky8 / Alma8 / Anolis8</td>
<td style="text-align:center"><code>el8.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>U24</strong></td>
<td>Ubuntu 24.04 (<code>noble</code>)</td>
<td style="text-align:center"><code>u24.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>U22</strong></td>
<td>Ubuntu 22.04 (<code>jammy</code>)</td>
<td style="text-align:center"><code>u22.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>D12</strong></td>
<td>Debian 12 (<code>bookworm</code>)</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
</tbody>
</table>
<p>Currently, the repository provides packages for the <strong>x86_64</strong> architecture. ARM64 and other architectures are under development, and are currently only offered to advanced users upon request.</p>
<p>More importantly, I maintain an <a href="https://ext.pigsty.io/">Extension Directory</a> that meticulously documents metadata, compatibility across OS/DB versions, and usage guidelines for every extension, helping users quickly locate the extensions they need.</p>
<p><img alt="ext-repo.png" src="/zh/blog/releases/v3.1.0/ext-repo.png"></p>
<h3 id="using-the-repository"><strong>Using the Repository</strong></h3>
<p>Pigsty’s extension repository integrates seamlessly with native OS package managers and is openly shared.
<strong>You’re not required to use Pigsty to access these extensions</strong>. Simply add the repository to your existing system or Dockerfile, then install extensions with standard commands like <code>yum</code> or <code>apt install</code>.</p>
<p>Notably, the popular open-source project <a href="https://postgresql-cluster.org/docs/category/extensions">postgresql-cluster</a> has already adopted this repository. It integrates with the repository as part of its installation workflow to distribute extensions to its users.</p>
<p><a href="https://postgresql-cluster.org/docs/category/extensions"><img alt="postgresql-cluster.png" src="/zh/blog/releases/v3.1.0/postgresql-cluster.png"></a></p>
<h3 id="rust-extensions">Rust Extensions</h3>
<p>The PostgreSQL ecosystem is seeing a growing number of Rust-based extensions developed using the pgrx framework. Pigsty’s repository currently includes 23 Rust extensions.</p>
<p>If you know of a promising extension, feel free to recommend it! I’ll do my best to include them in the repository.
If you’re a PostgreSQL extension developer, I&rsquo;m happy to provide assistance with packaging and distribution to ensure a smooth final delivery process to all end users.</p>
<hr>
<h2 id="ubuntu-2404-support">Ubuntu 24.04 Support</h2>
<p>Ubuntu 24.04 &ldquo;Noble&rdquo; has been out for six months now, and some users have started using it in production. Pigsty 3.1 formally adds support for Ubuntu 24.04 as a primary platform.</p>
<p>That said, being a relatively new system, Ubuntu 24.04 still has a few gaps compared to 22.04. For instance:</p>
<ul>
<li>Extensions like <code>citus</code> and <code>topn</code> are unavailable system-wide.</li>
<li><code>timescaledb_toolkit</code> lacks pre-built binaries for Ubuntu 24.04 on x86_64.</li>
</ul>
<p>Despite these minor exceptions, most extensions are fully compatible with Ubuntu 24.04, making it a strong candidate for Pigsty’s supported platforms.</p>
<h3 id="sunsetting-ubuntu-2004"><strong>Sunsetting Ubuntu 20.04</strong></h3>
<p>As part of this update, Ubuntu 20.04 &ldquo;Focal&rdquo; is being retired from Pigsty’s list of primary supported systems, even though its official EOL is in May 2025. This decision stems from challenges like outdated software (e.g., PostGIS) and dependency issues, which made supporting it increasingly impractical. I’m more than happy to see it phased out.</p>
<p>However, you can still technically use Pigsty on Ubuntu 20.04, and <a href="/docs/about/service/">subscription</a> customers will continue to receive support for this version.</p>
<h3 id="current-supported-platforms"><strong>Current Supported Platforms</strong></h3>
<p>Pigsty now supports the following major operating systems:</p>
<ul>
<li><strong>EL 8/9</strong></li>
<li><strong>Ubuntu 22.04</strong> and <strong>Ubuntu 24.04</strong></li>
<li><strong>Debian 12</strong></li>
</ul>
<p>For these platforms, Pigsty provides the latest packages and the full set of PostgreSQL extensions.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Code</th>
<th>OS Distro</th>
<th style="text-align:center"><code>x86_64</code></th>
<th style="text-align:center">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
<th style="text-align:center"><code>Arm64</code></th>
<th style="text-align:right">PG17</th>
<th style="text-align:center">PG16</th>
<th style="text-align:center">PG15</th>
<th style="text-align:center">PG14</th>
<th style="text-align:center">PG13</th>
<th style="text-align:center">PG12</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>EL9</strong></td>
<td>RHEL 9 / Rocky9 / Alma9</td>
<td style="text-align:center"><code>el9.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><code>el9.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>EL8</strong></td>
<td>RHEL 8 / Rocky8 / Alma8 / Anolis8</td>
<td style="text-align:center"><code>el8.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><code>el8.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>U24</strong></td>
<td>Ubuntu 24.04 (<code>noble</code>)</td>
<td style="text-align:center"><code>u24.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><code>u24.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>U22</strong></td>
<td>Ubuntu 22.04 (<code>jammy</code>)</td>
<td style="text-align:center"><code>u22.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><code>u22.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>D12</strong></td>
<td>Debian 12 (<code>bookworm</code>)</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><code>d12.arm64</code></td>
<td style="text-align:right"><i class="fas fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-secondary"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
</tr>
<tr>
<td style="text-align:center"><strong>D11</strong></td>
<td>Debian 11 (<code>bullseye</code>)</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><code>d11.arm64</code></td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>U20</strong></td>
<td>Ubuntu 20.04 (<code>focal</code>)</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><code>u20.arm64</code></td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>EL7</strong></td>
<td>RHEL7 / CentOS7 / UOS &hellip;</td>
<td style="text-align:center"><code>d12.x86_64</code></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><i class="fas fa-circle-check text-danger"></i></td>
<td style="text-align:center"><code>el7.arm64</code></td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<blockquote>
<p><i class="fas fa-circle-check text-primary"></i> = Primary Support; <i class="fas fa-circle-check text-secondary"></i> = Optional; <i class="fas fa-circle-check text-danger"></i> = EOL, Extended Commercial Support</p>
</blockquote>
<hr>
<h2 id="arm64-support">ARM64 Support</h2>
<p>The ARM architecture has been steadily gaining ground, particularly in the cloud computing sector, where ARM servers are capturing an increasing market share. Users have been requesting ARM support for Pigsty for over two years. In fact, Pigsty previously supported ARM when adapting for &ldquo;domestic systems,&rdquo; but version 3.1 marks the first time ARM64 support is included in the open-source release.</p>
<p>Currently, ARM64 support is in <strong>Beta</strong>. All the core features are functional, and everything works end-to-end, but the actual performance and reliability need more real-world testing and user feedback.</p>
<h3 id="supported-features"><strong>Supported Features</strong></h3>
<p>Most of Pigsty’s key functionalities have been adapted, including the <strong>Grafana/Prometheus stack</strong>, which now has ARM-compatible packages. The remaining gap lies in PostgreSQL extensions, particularly the 140 extensions maintained by Pigsty. These are still in progress for ARM64 support. However, if you rely on extensions already provided by <strong>PGDG</strong>(e.g., <code>postgis</code>, <code>pgvector</code>), you should encounter no issues.</p>
<p>Currently, the ARM version runs smoothly on <strong>EL9</strong>, <strong>Debian 12</strong>, and <strong>Ubuntu 22.04</strong>.</p>
<ul>
<li><strong>EL8</strong>: Missing some official PGDG packages.</li>
<li><strong>Ubuntu 24.04</strong>: A few missing extensions.</li>
</ul>
<p>Due to these limitations, ARM64 support is not yet recommended for these two platforms.</p>
<h3 id="future-plans"><strong>Future Plans</strong></h3>
<p>I plan to run ARM in a pilot phase over the next one or two minor releases. Once the extension ecosystem is complete, ARM64 support will be marked as <strong>GA</strong>.
In the meantime, I welcome feedback from anyone testing Pigsty’s ARM version. Your input will help refine and stabilize the implementation.</p>
<hr>
<h2 id="simplified-config">Simplified Config</h2>
<p>Another significant improvement in Pigsty v3.1 is the <strong>simplification of config management</strong>. Handling package variations across different OS distros and PG major versions has always been a headache.</p>
<h3 id="the-problem"><strong>The Problem</strong></h3>
<p>Different OS distributions often have subtle differences in package names and available software, requiring Pigsty to generate separate configuration files for each distribution.
This approach quickly leads to <strong>combinatorial explosion</strong>. For instance, Pigsty offers <a href="/docs/conf/overview/">config templates</a> for over a dozen scenarios.
If each template must support 5–7 operating systems, the total number of configurations becomes unmanageable.</p>
<h3 id="the-solution-indirection"><strong>The Solution: Indirection</strong></h3>
<p>As the adage in computer science goes: <em>&ldquo;Any problem can be solved by adding a layer of indirection.&rdquo;</em>
Version 3.1 addresses this issue by introducing a new configuration file, <code>package_map</code>, which defines <strong>package aliases</strong>.
For each OS distribution, a <code>node_id/vars</code> file translates these aliases into the specific package names required by the OS.</p>
<p><img alt="config.png" src="/zh/blog/releases/v3.1.0/config.png"></p>
<h3 id="how-it-works"><strong>How It Works</strong></h3>
<p>Take the <strong>Supabase self-hosting template</strong> as an example. It uses dozens of PostgreSQL extensions.
Users only need to specify the extension names; details like CPU architecture, OS version, PostgreSQL version, or package names are handled internally.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pg_extensions: <span style="color:#8f5902;font-style:italic"># extensions to be installed on this cluster</span>
</span></span><span style="display:flex;"><span>- supabase   <span style="color:#8f5902;font-style:italic"># essential extensions for supabase</span>
</span></span><span style="display:flex;"><span>- timescaledb postgis pg_graphql pg_jsonschema wrappers pg_search pg_analytics pg_parquet plv8 duckdb_fdw pg_cron pg_timetable pgqr
</span></span><span style="display:flex;"><span>- supautils pg_plan_filter passwordcheck plpgsql_check pgaudit pgsodium pg_vault pgjwt pg_ecdsa pg_session_jwt index_advisor
</span></span><span style="display:flex;"><span>- pgvector pgvectorscale pg_summarize pg_tiktoken pg_tle pg_stat_monitor hypopg pg_hint_plan pg_http pg_net pg_smtp_client pg_idkit
</span></span></code></pre></div><p>Here’s an example: If you want to install PostgreSQL 16 and its extensions, you no longer need to manually specify the real package name in
<a href="/docs/reference/param/#repo_packages"><code>repo_packages</code></a> and <a href="/docs/reference/param/#repo_packages"><code>pg_extension</code></a> (you can still do that!)
the download or installation lists with PG16-specific packages. Instead, you just modify a single parameter: <code>pg_version: 16</code>, all settled!</p>
<p><img alt="config.png" src="/zh/blog/releases/v3.1.0/config.png"></p>
<hr>
<h2 id="infra-improvement">Infra Improvement</h2>
<p>Beyond functional improvements, Pigsty continues to enhance its underlying infrastructure.
For instance, in version 3.0, we introduced support for alternative PostgreSQL kernels such as <strong>Babelfish</strong> (MSSQL compatibility), <strong>IvorySQL</strong> (Oracle compatibility), and <strong>PolarDB</strong> (a domestic PG-compatible kernel).</p>
<p>Previously, users needed to install these kernels from external repositories online.
With Pigsty v3.1, the <strong>official repository</strong> now directly includes mirrors of Babelfish/WiltonDB, IvorySQL, PolarDB, and similar “exotic” PostgreSQL kernels.
This means installation is now much simpler—just use the pre-configured templates, and you can set up these alternative kernels with a single command, no extra configuration required.</p>
<p>Additionally, Pigsty maintains <strong>Prometheus</strong> and <strong>Grafana</strong> repositories for both YUM and APT package managers, supporting AMD and ARM architectures.
These repositories are updated in real-time to track the latest versions of these observability tools. In this release:</p>
<ul>
<li><strong>Prometheus</strong> was upgraded to its major <strong>v3</strong> version.</li>
<li><strong>VictoriaLogs</strong> officially released its <strong>v1.0</strong> version.</li>
</ul>
<p>If you rely on these monitoring tools, Pigsty’s repositories can be a valuable resource.</p>
<hr>
<h2 id="improvements-to-minio"><strong>Improvements to MinIO</strong></h2>
<p>Let’s talk about <strong>MinIO</strong>, an open-source object storage solution. Pigsty leverages MinIO for PostgreSQL backups and as the underlying storage service for Supabase.
Our goal with MinIO has always been to reduce deployment complexity to the bare minimum —— <strong>&ldquo;Deploy in minutes, Scale to millions.&rdquo;</strong></p>
<p>When we first adopted MinIO internally, it was still in its <strong>0.x</strong> days.
At the time, we used it to store <strong>25 PB of data</strong>, but since MinIO didn’t support online scaling, we had to break this into 7–8 independent clusters.
Today, MinIO has come a long way. While it still doesn’t support directly modifying disk/node counts online, it now offers <strong>storage pool expansion</strong>.
This allows smooth scaling by adding new storage pools, migrating data, and retiring old ones without downtime.</p>
<p><img alt="minio.png" src="/blog/releases/v3.1.0/minio.png"></p>
<p>For v3.1, I re-read MinIO’s latest documentation and updated the <a href="/docs/minio/config/"><strong>best-practice templates and SOPs</strong></a> to reflect its new features. These include:</p>
<ul>
<li>Single node, single disk</li>
<li>Single node, multi-disk</li>
<li>Multi-node, multi-disk</li>
<li>Multi-storage-pool deployments</li>
<li>Handling disk failures and node failures</li>
<li>Expand/Shrink cluster</li>
<li>Using <strong>VIP</strong> and <strong>HAProxy</strong> for high-availability access</li>
</ul>
<p>All procedures are documented and can be executed with just a few commands.</p>
<h3 id="the-case-for-minio"><strong>The Case for MinIO</strong></h3>
<p>Object storage is foundational for modern cloud infrastructure. MinIO, as a leading open-source object storage solution, delivers excellent performance and features.
Most importantly, it is <strong>cloud-neutral</strong>, giving you independence from cloud vendor lock-in.</p>
<p>MinIO is also a compelling alternative to cloud object storage. Consider the scenario outlined in <a href="https://world.hey.com/dhh/our-cloud-exit-savings-will-now-top-ten-million-over-five-years-c7d9b5bd">&ldquo;DHH: Our cloud-exit savings will now top ten million over five years&rdquo;</a>:</p>
<ul>
<li>Their cloud infrastructure included <strong>10 PB</strong> of object storage.</li>
<li>The standard cost: $3M/year, reduced to $1.3M/year with saving plans</li>
<li>By contrast, a <strong>dedicated storage server</strong> with 1.2 PB of capacity costs just <strong>$20,000</strong>.</li>
<li>With OSS MinIO, 3-copies, DC, power, operations,  the 5year TCO is still less than the one-year S3 cost.</li>
</ul>
<p>If your business heavily relies on object storage, a <strong>self-hosted MinIO deployment</strong> combined with <strong>Cloudflare</strong> for external access could unlock significant cost savings and efficiency improvements.
For many use cases, it’s an optimization worth serious consideration.</p>
<hr>
<h2 id="v310">v3.1.0</h2>
<p><strong>Features</strong></p>
<ul>
<li>PostgreSQL 17 as the default major version (17.2)</li>
<li>Ubuntu 24.04 noble support</li>
<li>ARM64 support (el9, debian12, ubuntu 22.04)</li>
<li>New playbook <code>supabase.yml</code> for quick self-hosting supabase</li>
<li>MinIO Enhancement, best, practice, conf template, dashboards,&hellip;</li>
<li>Allow using <code>-v</code> to specify PG major version during <code>configure</code></li>
<li>A series of out-of-the-box configuration templates and documentation.</li>
<li>Now install the <code>pgvector</code> extension by default</li>
<li>Simplify the repo packages configuration with package map alias</li>
<li>Setup WiltonDB, IvorySQL, PolarDB repo mirror</li>
<li>Enable postgres checksum by default</li>
</ul>
<p><strong>Software Upgrades</strong></p>
<ul>
<li>PostgreSQL 17.2, 16.6, 15.10, 14.15, 13.18, 12.22</li>
<li>PostgreSQL Extension Upgrades: <a href="https://ext.pigsty.io">https://ext.pigsty.io</a></li>
<li>Patroni 4.0.4</li>
<li>MinIO 20241107 / MCLI 20241117</li>
<li>Rclone 1.68.2</li>
<li>Prometheus: 2.54.0 -&gt; 3.0.0</li>
<li>VictoriaMetrics 1.102.1 -&gt; 1.106.1</li>
<li>VictoriaLogs v0.28.0 -&gt; 1.0.0</li>
<li>vslogcli 1.0.0</li>
<li>MySQL Exporter 0.15.1 -&gt; 0.16.0</li>
<li>Redis Exporter 1.62.0 -&gt; 1.66.0</li>
<li>MongoDB Exporter 0.41.2 -&gt; 0.42.0</li>
<li>Keepalived Exporter 1.3.3 -&gt; 1.4.0</li>
<li>DuckDB 1.1.2 -&gt; 1.1.3</li>
<li>etcd 3.5.16 -&gt; 3.5.17</li>
<li>tigerbeetle 16.8 -&gt; 0.16.13</li>
</ul>
<p><strong>API Change</strong></p>
<ul>
<li><code>repo_upstream</code>: Now has defaults per distro: <a href="https://github.com/Vonng/pigsty/tree/main/roles/node_id/vars"><code>roles/node_id/vars</code></a>.</li>
<li><code>repo_packages</code>: Now support using <code>package_map</code> alias.</li>
<li><code>repo_extra_packages</code>: Now support missing default values, and using <code>package_map</code> alias.</li>
<li><code>pg_checksum</code>: Now the default value is <code>true</code>.</li>
<li><code>pg_packages</code>: Change to <code>postgresql, wal2json pg_repack pgvector, patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager</code>.</li>
<li><code>pg_extensions</code>: Change to empty array <code>[]</code>.</li>
<li><code>infra_portal</code>: Now allow using <code>path</code> in the <code>home</code> server.</li>
</ul>
<hr>
<h2 id="news-pigsty-v31-released">News: Pigsty v3.1 Released</h2>
<p><a href="https://pigsty.io/blog/releases/v3.1.0/">Pigsty v3.1</a> is now live, closely following the release of PostgreSQL 17.2.
This version marks PostgreSQL 17 as the default, featuring compatibility with the latest Ubuntu 24.04 LTS and initial ARM64 arch support.
It also introduces nearly <a href="https://ext.pigsty.io/#/list">340</a> ready-to-use PostgreSQL extensions right from the start.</p>
<p>A notable feature is the one-click setup for a self-hosted <a href="https://pigsty.io/docs/kernel/supabase">Supabase</a>, which is built upon PostgreSQL.
Pigsty v3.1 enables you to run Supabase on local-first HA PostgreSQL (ver14-17) alone with 300+ extensions on <a href="https://pigsty.io/docs/reference/compatibility/">mainstream Linux distros</a> without virtualization or containers, utilizing modern hardware to its full potential.</p>
<p>The update enhances its <a href="https://ext.pigsty.io/#/usage">repository</a> with new PostgreSQL-compatible kernels like <a href="https://pigsty.io/docs/kernel/babelfish/">Babelfish</a>, <a href="https://pigsty.io/docs/kernel/ivorysql/">IvorySQL</a>, and <a href="https://pigsty.io/docs/kernel/polardb/">PolarDB</a>,
and the OLAP / DuckDB race players such as <a href="https://ext.pigsty.io/#/pg_analytics">pg_analytics</a>, <a href="https://ext.pigsty.io/#/pg_duckdb">pg_duckdb</a>, <a href="https://ext.pigsty.io/#/pg_mooncake">pg_mooncake</a>, <a href="https://ext.pigsty.io/#/pg_parquet">pg_parquet</a>, and <a href="https://ext.pigsty.io/#/duckdb_fdw"><code>duckdb_fdw</code></a>,
now directly accessible for the pigsty repo.</p>
<p>Additionally, MinIO best practices have been refined to lower deployment barriers and allow expanding existing clusters, which are detailed in the new <a href="http://pigsty.io/docs/minio/admin/">admin SOP</a>.</p>
<p>Pigsty 3.1 simplifies configuration across various OS distros by standardizing scenario-based <a href="https://pigsty.io/docs/conf/overview/">config templates</a>.
You can download and install kernels and extensions by specifying their name. and changing the significant versions with just one <code>pg_version</code> parameter.</p>
<p>With comprehensive support for new operating systems and architectural improvements, Pigsty 3.1 aims to deliver a more feature-rich and cost-effective OSS RDS PG solution.
I hope this could help you easily enjoy the latest PostgreSQL features and extensions.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-e7e4e4c92d83a217d8bda0fa106a91e3">Pigsty v3.0: Extension Exploding &amp; Plugable Kernels</h1>
	<div class="lead">The 340 extension provided by Pigsty v3 &amp; Plugable Kernels such as Babelfish, IvorySQL, and PolarDB</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2024-08-05" class="text-muted">2024-08-05</time>
        
	</div>
	<p>Get <a href="/docs/setup/install/">started</a> with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL https://repo.pigsty.io/get <span style="color:#000;font-weight:bold">|</span> bash
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty<span style="color:#000;font-weight:bold">;</span> ./bootstrap<span style="color:#000;font-weight:bold">;</span> ./configure<span style="color:#000;font-weight:bold">;</span> ./install.yml
</span></span></code></pre></div><hr>
<h3 id="highlight-features">Highlight Features</h3>
<p><strong>Extension Exploding</strong>:</p>
<p>Pigsty now has an unprecedented <a href="https://pigsty.io/docs/pgext/list/"><strong>340</strong></a> available extensions for PostgreSQL. This includes <strong>121</strong> extension <a href="https://pigsty.io/docs/pgext/list/rpm/">RPM packages</a> and <strong>133</strong> <a href="https://pigsty.io/docs/pgext/list/deb/">DEB packages</a>, surpassing the total number of extensions provided by the PGDG official repository (135 RPM/109 DEB).
Pigsty has ported unique PG extensions from the EL/DEB system to each other, achieving a great alignment of extension ecosystems between the two major distributions.</p>
<p>A crude list of the extension ecosystem is as follows:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">timescaledb periods temporal_tables emaj table_version pg_cron pg_later pg_background pg_timetable</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">postgis pgrouting pointcloud pg_h3 q3c ogr_fdw geoip #pg_geohash</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#mobilitydb</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pgvector pgvectorscale pg_vectorize pg_similarity pg_tiktoken pgml</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#smlar</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_search pg_bigm zhparser hunspell</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">hydra pg_lakehouse pg_duckdb duckdb_fdw pg_fkpart pg_partman plproxy</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pg_strom citus</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_hint_plan age hll rum pg_graphql pg_jsonschema jsquery index_advisor hypopg imgsmlr pg_ivm pgmq pgq</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#rdkit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_tle plv8 pllua plprql pldebugger plpgsql_check plprofiler plsh</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pljava plr pgtap faker dbt2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">prefix semver pgunit md5hash asn1oid roaringbitmap pgfaceting pgsphere pg_country pg_currency pgmp numeral pg_rational pguint ip4r timestamp9 chkpass #pg_uri #pgemailaddr #acl #debversion</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pg_rrule</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">topn pg_gzip pg_http pg_net pg_html5_email_address pgsql_tweaks pg_extra_time pg_timeit count_distinct extra_window_functions first_last_agg tdigest aggs_for_arrays pg_arraymath pg_idkit pg_uuidv7 permuteseq pg_hashids</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">sequential_uuids pg_math pg_random pg_base36 pg_base62 floatvec pg_financial pgjwt pg_hashlib shacrypt cryptint pg_ecdsa pgpcre icu_ext envvar url_encode #pg_zstd #aggs_for_vecs #quantile #lower_quantile #pgqr</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pg_protobuf</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_repack pg_squeeze pg_dirtyread pgfincore pgdd ddlx pg_prioritize pg_checksums pg_readonly safeupdate pg_permissions pgautofailover pg_catcheck preprepare pgcozy pg_orphaned pg_crash pg_cheat_funcs pg_savior table_log pg_fio</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pgpool pgagent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pg_profile pg_show_plans pg_stat_kcache pg_stat_monitor pg_qualstats pg_store_plans pg_track_settings pg_wait_sampling system_stats pg_meta pgnodemx pg_sqlog bgw_replstatus pgmeminfo toastinfo pagevis powa pg_top #pg_statviz #pgexporter_ext</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#pg_mon</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">passwordcheck supautils pgsodium pg_vault anonymizer pg_tde pgsmcrypto pgaudit pgauditlogtofile pg_auth_mon credcheck pgcryptokey pg_jobmon logerrors login_hook set_user pg_snakeoil pgextwlist pg_auditor noset</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#sslutils</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">wrappers multicorn mysql_fdw tds_fdw sqlite_fdw pgbouncer_fdw mongo_fdw redis_fdw pg_redis_pubsub kafka_fdw hdfs_fdw firebird_fdw aws_s3 log_fdw #oracle_fdw</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#db2_fdw</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">orafce pgtt session_variable pg_statement_rollback pg_dbms_metadata pg_dbms_lock pgmemcache #pg_dbms_job</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#wiltondb</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">pglogical pgl_ddl_deploy pg_failover_slots wal2json wal2mongo decoderbufs decoder_raw mimeo pgcopydb pgloader pg_fact_loader pg_bulkload pg_comparator pgimportdoc pgexportdoc #repmgr</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#slony</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">gis-stack rag-stack fdw-stack fts-stack etl-stack feat-stack olap-stack supa-stack stat-stack json-stack</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>Plugable Kernels</strong>:</p>
<p>Pigsty v3 allows you to replace the PostgreSQL kernel, currently supporting Babelfish (SQL Server compatible, with wire protocol emulation), IvorySQL (Oracle compatible), and RAC PolarDB for PostgreSQL.
Additionally, self-hosted Supabase is now available on Debian systems. You can emulate MSSQL (via WiltonDB), Oracle (via IvorySQL), Oracle RAC (via PolarDB), MongoDB (via FerretDB), and Firebase (via Supabase) in Pigsty
with production-grade PostgreSQL clusters featuring HA, IaC, PITR, and monitoring.</p>
<p><strong>Pro Edition</strong>:</p>
<p>We now offer <a href="https://pigsty.io/docs/about/service/">PGSTY Pro</a>, a professional edition that provides value-added services on top of the open-source features.
The professional edition includes additional modules: MSSQL, Oracle, Mongo, K8S, Victoria, Kafka, etc., and offers broader support for PG major versions, operating systems, and chip architectures.
It provides offline installation packages customized for precise minor versions of all operating systems, and support for legacy systems like EL7, Debian 11, Ubuntu 20.04.</p>
<hr>
<h3 id="major-changes">Major Changes</h3>
<p>This Pigsty release updates the major version number from 2.x to 3.0, with several significant changes:</p>
<ul>
<li>Primary supported operating systems updated to: EL 8 / EL 9 / Debian 12 / Ubuntu 22.04
<ul>
<li>EL7 / Debian 11 / Ubuntu 20.04 systems are now deprecated and no longer supported.</li>
<li>Users needing to run on these systems should consider our <a href="https://pigsty.io/docs/about/service">subscription service</a>.</li>
</ul>
</li>
<li>Default to online installation, offline packages are no longer provided to resolve minor OS version compatibility issues.
<ul>
<li>The <code>bootstrap</code> process will no longer prompt for downloading offline packages, but if <code>/tmp/pkg.tgz</code> exists, it will still use the offline package automatically.</li>
<li>For offline installation needs, please create offline packages yourself or consider our <a href="https://pigsty.io/docs/about/service">pro version</a>.</li>
</ul>
</li>
<li>Unified adjustment of upstream software repositories used by Pigsty, address changes, and GPG signing and verification for all packages.
<ul>
<li>Standard repository: <code>https://repo.pigsty.io/{apt/yum}</code></li>
<li>Domestic mirror: <code>https://repo.pigsty.cc/{apt/yum}</code></li>
</ul>
</li>
<li>API parameter changes and configuration template changes
<ul>
<li>Configuration templates for EL and Debian systems are now consolidated, with differing parameters managed in the <a href="https://github.com/Vonng/pigsty/tree/master/roles/node_id/vars"><code>roles/node_id/vars/</code></a> directory.</li>
<li>Configuration directory changes, all configuration file templates are now placed in the <code>conf</code> directory and categorized into <code>default</code>, <code>dbms</code>, <code>demo</code>, <code>build</code>.</li>
</ul>
</li>
<li><strong><code>Docker</code></strong> is now completely treated as a separate module, and will not be downloaded by default</li>
<li>New beta module: <strong><code>KAFKA</code></strong></li>
<li>New beta module: <strong><code>KUBE</code></strong></li>
</ul>
<hr>
<h3 id="other-new-features">Other New Features</h3>
<ul>
<li>Epic enhancement of PG OLAP analysis capabilities: DuckDB 1.0.0, DuckDB FDW, and PG Lakehouse, Hydra have been ported to the Debian system.</li>
<li>Strengthened PG vector search and full-text search capabilities: Vectorscale provides DiskANN vector indexing, Hunspell dictionary support, pg_search 0.8.6.</li>
<li>Resolved package build issues for ParadeDB, now available on Debian/Ubuntu.</li>
<li>All required extensions for Supabase are now available on Debian/Ubuntu, making Supabase self-hostable across all OSes.</li>
<li>Provided capability for scenario-based pre-configured extension stacks. If you&rsquo;re unsure which extensions to install, we offer extension recommendation packages (Stacks) tailored for specific application scenarios.</li>
<li>Created metadata tables, documentation, indexes, and name mappings for all PostgreSQL ecosystem extensions, ensuring alignment and usability for both EL and Debian systems.</li>
<li>Enhanced <code>proxy_env</code> parameter functionality to mitigate DockerHub ban issues, simplifying configuration.</li>
<li>Established a new dedicated software repository offering all extension plugins for versions 12-17, with the PG16 extension repository implemented by default in Pigsty.</li>
<li>Upgraded existing software repositories, employing standard signing and verification mechanisms to ensure package integrity and security. The APT repository adopts a new standard layout built through <code>reprepro</code>.</li>
<li>Provided sandbox environments for 1, 2, 3, 4, 43 nodes: <code>meta</code>, <code>dual</code>, <code>trio</code>, <code>full</code>, <code>prod</code>, and quick configuration templates for 7 major OS Distros.</li>
<li>Add PostgreSQL 17 and pgBouncer 1.23 metrics support in pg_exporter config, adding related dashboard panels.</li>
<li>Add logs panel for PGSQL Pgbouncer / PGSQL Patroni Dashboard</li>
<li>Add new playbook <code>cache.yml</code> to make offline packages, instead of bash <code>bin/cache</code> and <code>bin/release-pkg</code></li>
</ul>
<hr>
<h3 id="api-changes">API Changes</h3>
<ul>
<li>
<p>New parameter option: <code>pg_mode</code> now have several new options:</p>
<ul>
<li><code>pgsql</code>: Standard PostgreSQL high availability cluster.</li>
<li><code>citus</code>: Citus horizontally distributed PostgreSQL native high availability cluster.</li>
<li><code>gpsql</code>: Monitoring for Greenplum and GP compatible databases (Pro edition).</li>
<li><code>mssql</code>: Install WiltonDB / Babelfish to provide Microsoft SQL Server compatibility mode for standard PostgreSQL high availability clusters, with wire protocol level support, extensions unavailable.</li>
<li><code>ivory</code>: Install IvorySQL to provide Oracle compatibility for PostgreSQL high availability clusters, supporting Oracle syntax/data types/functions/stored procedures, extensions unavailable (Pro edition).</li>
<li><code>polar</code>: Install PolarDB for PostgreSQL (PG RAC) open-source version to support localization database capabilities, extensions unavailable (Pro edition).</li>
</ul>
</li>
<li>
<p>New parameter option: <code>pg_mode</code> now have several new options:</p>
<ul>
<li><code>pgsql</code>: Standard PostgreSQL high availability cluster.</li>
<li><code>citus</code>: Citus horizontally distributed PostgreSQL native high availability cluster.</li>
<li><code>gpsql</code>: Monitoring for Greenplum and GP compatible databases (Pro edition).</li>
<li><code>mssql</code>: Install WiltonDB / Babelfish to provide Microsoft SQL Server compatibility mode for standard PostgreSQL high availability clusters, with wire protocol level support, extensions unavailable.</li>
<li><code>ivory</code>: Install IvorySQL to provide Oracle compatibility for PostgreSQL high availability clusters, supporting Oracle syntax/data types/functions/stored procedures, extensions unavailable (Pro edition).</li>
<li><code>polar</code>: Install PolarDB for PostgreSQL (PG RAC) open-source version to support localization database capabilities, extensions unavailable (Pro edition).</li>
</ul>
</li>
<li>
<p>New parameter: <code>pg_parameters</code>, used to specify parameters in <code>postgresql.auto.conf</code> at the instance level, overriding cluster configurations for personalized settings on different instance members.</p>
</li>
<li>
<p>New parameter: <code>pg_files</code>, used to specify additional files to be written to the PostgreSQL data directory, to support license feature required by some kernel forks.</p>
</li>
<li>
<p>New parameter: <code>repo_extra_packages</code>, used to specify additional packages to download, to be used in conjunction with <code>repo_packages</code>, facilitating the specification of extension lists unique to OS versions.</p>
</li>
<li>
<p>Parameter renaming: <code>patroni_citus_db</code> renamed to <code>pg_primary_db</code>, used to specify the primary database in the cluster (used in Citus mode).</p>
</li>
<li>
<p>Parameter enhancement: Proxy server configurations in <code>proxy_env</code> will be written to the Docker Daemon to address internet access issues, and the <code>configure -x</code> option will automatically write the proxy server configuration of the current environment.</p>
</li>
<li>
<p>Parameter enhancement: Allow using <code>path</code> item in <code>infra_portal</code> entries, to expose local dir as web service rather than proxy to another upstream.</p>
</li>
<li>
<p>Parameter enhancement: The <code>repo_url_packages</code> in <code>repo.pigsty.io</code> will automatically switch to <code>repo.pigsty.cc</code> when the region is China, addressing internet access issues. Additionally, the downloaded file name can now be specified.</p>
</li>
<li>
<p>Parameter enhancement: The <code>extension</code> field in <code>pg_databases.extensions</code> now supports both dictionary and extension name string modes. The dictionary mode offers <code>version</code> support, allowing the installation of specific extension versions.</p>
</li>
<li>
<p>Parameter enhancement: If the <code>repo_upstream</code> parameter is not explicitly overridden, it will extract the default value for the corresponding system from <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> or <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/deb.yml"><code>deb.yml</code></a>.</p>
</li>
<li>
<p>Parameter enhancement: If the <code>repo_packages</code> parameter is not explicitly overridden, it will extract the default value for the corresponding system from <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> or <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/deb.yml"><code>deb.yml</code></a>.</p>
</li>
<li>
<p>Parameter enhancement: If the <code>infra_packages</code> parameter is not explicitly overridden, it will extract the default value for the corresponding system from <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> or <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/deb.yml"><code>deb.yml</code></a>.</p>
</li>
<li>
<p>Parameter enhancement: If the <code>node_default_packages</code> parameter is not explicitly overridden, it will extract the default value for the corresponding system from <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> or <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/deb.yml"><code>deb.yml</code></a>.</p>
</li>
<li>
<p>Parameter enhancement: The extensions specified in <code>pg_packages</code> and <code>pg_extensions</code> will now perform a lookup and translation from the <code>pg_package_map</code> defined in <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/rpm.yml"><code>rpm.yml</code></a> or <a href="https://github.com/Vonng/pigsty/blob/master/roles/node_id/vars/deb.yml"><code>deb.yml</code></a>.</p>
</li>
<li>
<p>Parameter enhancement: Packages specified in <code>node_packages</code> and <code>pg_extensions</code> will be upgraded to the latest version upon installation. The default value in <code>node_packages</code> is now <code>[openssh-server]</code>, helping to fix the <a href="https://pigsty.io/blog/db/cve-2024-6387/">OpenSSH CVE</a>.</p>
</li>
<li>
<p>Parameter enhancement: <code>pg_dbsu_uid</code> will automatically adjust to <code>26</code> (EL) or <code>543</code> (Debian) based on the operating system type, avoiding manual adjustments.</p>
</li>
<li>
<p>pgBouncer Parameter update, <code>max_prepared_statements = 128</code> enabled prepared statement support in transaction pooling mode, and set <code>server_lifetime</code> to 600.</p>
</li>
<li>
<p>Patroni template parameter update, uniformly increase <code>max_worker_processes</code> +8 available backend processes, increase <code>max_wal_senders</code> and <code>max_replication_slots</code> to 50, and increase the OLAP template temporary file size limit to 1/5 of the main disk.</p>
</li>
</ul>
<hr>
<h3 id="software-upgrade"><strong>Software Upgrade</strong></h3>
<p>The main components of Pigsty are upgraded to the following versions (as of the release time):</p>
<ul>
<li><a href="https://www.postgresql.org/about/news/postgresql-164-158-1413-1316-1220-and-17-beta-3-released-2910/"><strong>PostgreSQL</strong></a> 16.4, 15.8, 14.13, 13.16, 12.20</li>
<li><a href="https://github.com/Vonng/pg_exporter">pg_exporter</a> : 0.7.0</li>
<li><a href="https://patroni.readthedocs.io/en/latest/">Patroni</a>: 3.3.2</li>
<li><a href="https://www.pgbouncer.org/2024/08/pgbouncer-1-23-1">pgBouncer</a>: 1.23.1</li>
<li><a href="https://pgbackrest.org/release.html#2.53.1">pgBackRest</a>: 2.53.1</li>
<li><a href="https://github.com/duckdb/duckdb">duckdb</a> : 1.0.0</li>
<li><a href="https://github.com/etcd-io/etcd">etcd</a> : 3.5.15</li>
<li><a href="https://github.com/cybertec-postgresql/pg_timetable">pg_timetable</a>: 5.9.0</li>
<li><a href="https://github.com/FerretDB/FerretDB">ferretdb</a>: 1.23.1</li>
<li><a href="https://github.com/cybertec-postgresql/vip-manager">vip-manager</a>: 2.6.0</li>
<li><a href="https://github.com/minio/minio">minio</a>: 20240817012454</li>
<li><a href="https://github.com/minio/mc">mcli</a>: 20240817113350</li>
<li><a href="https://github.com/grafana/grafana/">grafana</a> : 11.1.4</li>
<li><a href="https://github.com/grafana/loki">loki</a> : 3.1.1</li>
<li><a href="https://github.com/grafana/loki">promtail</a> : 3.0.0</li>
<li><a href="https://github.com/prometheus/prometheus">prometheus</a> : 2.54.0</li>
<li><a href="https://github.com/prometheus/pushgateway">pushgateway</a> : 1.9.0</li>
<li><a href="https://github.com/prometheus/alertmanager">alertmanager</a> : 0.27.0</li>
<li><a href="https://github.com/prometheus/blackbox_exporter">blackbox_exporter</a> : 0.25.0</li>
<li><a href="https://github.com/nginxinc/nginx-prometheus-exporter">nginx_exporter</a> : 1.3.0</li>
<li><a href="https://github.com/prometheus/node_exporter">node_exporter</a> : 1.8.2</li>
<li><a href="https://github.com/gen2brain/keepalived_exporter">keepalived_exporter</a> : 0.7.0</li>
<li><a href="https://github.com/woblerr/pgbackrest_exporter">pgbackrest_exporter</a> 0.18.0</li>
<li><a href="https://github.com/prometheus/mysqld_exporter">mysqld_exporter</a> : 0.15.1</li>
<li><a href="https://github.com/oliver006/redis_exporter">redis_exporter</a> : v1.62.0</li>
<li><a href="https://github.com/danielqsj/kafka_exporter">kafka_exporter</a> : 1.8.0</li>
<li><a href="https://github.com/percona/mongodb_exporter">mongodb_exporter</a> : 0.40.0</li>
<li><a href="https://github.com/VictoriaMetrics/VictoriaMetrics">VictoriaMetrics</a> : 1.102.1</li>
<li><a href="https://github.com/VictoriaMetrics/VictoriaMetrics/releases">VictoriaLogs</a> : v0.28.0</li>
<li><a href="https://github.com/labring/sealos">sealos</a>: 5.0.0</li>
<li><a href="https://github.com/vectordotdev/vector/releases">vector</a> : 0.40.0</li>
</ul>
<p>The complete list of PostgreSQL extensions can be found <a href="https://pigsty.io/docs/pgext/list/">here</a>.</p>
<table>
<thead>
<tr>
<th>Extension (URL)</th>
<th>Alias</th>
<th style="text-align:center">Repo</th>
<th style="text-align:center">Version</th>
<th style="text-align:center">Category</th>
<th style="text-align:center">License</th>
<th style="text-align:center"><code>LOAD</code></th>
<th style="text-align:center"><code>DDL</code></th>
<th style="text-align:center"><code>TRUST</code></th>
<th style="text-align:center"><code>RELOC</code></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/timescale/timescaledb"><strong>timescaledb</strong></a></td>
<td><a href="/docs/pgext/time/timescaledb"><strong><code>timescaledb</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.15.3</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">Timescale</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Enables scalable inserts and complex queries for time-series data (Apache 2 Edition)</td>
</tr>
<tr>
<td><a href="https://github.com/xocolatl/periods"><strong>periods</strong></a></td>
<td><a href="/docs/pgext/time/periods"><strong><code>periods</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Provide Standard SQL functionality for PERIODs and SYSTEM VERSIONING</td>
</tr>
<tr>
<td><a href="https://pgxn.org/dist/temporal_tables/"><strong>temporal_tables</strong></a></td>
<td><a href="/docs/pgext/time/temporal_tables"><strong><code>temporal_tables</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.2.2</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>temporal tables</td>
</tr>
<tr>
<td><a href="https://github.com/dalibo/emaj"><strong>emaj</strong></a></td>
<td><a href="/docs/pgext/time/emaj"><strong><code>emaj</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.4.0</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>E-Maj extension enables fine-grained write logging and time travel on subsets of the database.</td>
</tr>
<tr>
<td><a href="https://github.com/linz/postgresql-tableversion"><strong>table_version</strong></a></td>
<td><a href="/docs/pgext/time/table_version"><strong><code>table_version</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.10.3</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostgreSQL table versioning extension</td>
</tr>
<tr>
<td><a href="https://github.com/citusdata/pg_cron"><strong>pg_cron</strong></a></td>
<td><a href="/docs/pgext/time/pg_cron"><strong><code>pg_cron</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.6</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Job scheduler for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/tembo-io/pg_later"><strong>pg_later</strong></a></td>
<td><a href="/docs/pgext/time/pg_later"><strong><code>pg_later</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.1.1</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>pg_later: Run queries now and get results later</td>
</tr>
<tr>
<td><a href="https://github.com/vibhorkum/pg_background"><strong>pg_background</strong></a></td>
<td><a href="/docs/pgext/time/pg_background"><strong><code>pg_background</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Run SQL queries in the background</td>
</tr>
<tr>
<td><a href="https://github.com/cybertec-postgresql/pg_timetable"><strong>pg_timetable</strong></a></td>
<td><a href="/docs/pgext/time/pg_timetable"><strong><code>pg_timetable</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">5.9.0</td>
<td style="text-align:center"><a href="/docs/pgext/time"><strong><code>TIME</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Advanced scheduling for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://git.osgeo.org/gitea/postgis/postgis"><strong>postgis</strong></a></td>
<td><a href="/docs/pgext/gis/postgis"><strong><code>postgis</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.4.2</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostGIS geometry and geography spatial types and functions</td>
</tr>
<tr>
<td><a href="https://git.osgeo.org/gitea/postgis/postgis"><strong>postgis_topology</strong></a></td>
<td><a href="/docs/pgext/gis/postgis"><strong><code>postgis</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.4.2</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostGIS topology spatial types and functions</td>
</tr>
<tr>
<td><a href="https://git.osgeo.org/gitea/postgis/postgis"><strong>postgis_raster</strong></a></td>
<td><a href="/docs/pgext/gis/postgis"><strong><code>postgis</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.4.2</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostGIS raster types and functions</td>
</tr>
<tr>
<td><a href="https://git.osgeo.org/gitea/postgis/postgis"><strong>postgis_sfcgal</strong></a></td>
<td><a href="/docs/pgext/gis/postgis"><strong><code>postgis</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.4.2</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>PostGIS SFCGAL functions</td>
</tr>
<tr>
<td><a href="https://git.osgeo.org/gitea/postgis/postgis"><strong>postgis_tiger_geocoder</strong></a></td>
<td><a href="/docs/pgext/gis/postgis"><strong><code>postgis</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.4.2</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostGIS tiger geocoder and reverse geocoder</td>
</tr>
<tr>
<td><a href="https://git.osgeo.org/gitea/postgis/postgis"><strong>address_standardizer</strong></a></td>
<td><a href="/docs/pgext/gis/postgis"><strong><code>postgis</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.4.2</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Used to parse an address into constituent elements. Generally used to support geocoding address normalization step.</td>
</tr>
<tr>
<td><a href="https://git.osgeo.org/gitea/postgis/postgis"><strong>address_standardizer_data_us</strong></a></td>
<td><a href="/docs/pgext/gis/postgis"><strong><code>postgis</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.4.2</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Address Standardizer US dataset example</td>
</tr>
<tr>
<td><a href="https://github.com/pgRouting/pgrouting"><strong>pgrouting</strong></a></td>
<td><a href="/docs/pgext/gis/pgrouting"><strong><code>pgrouting</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.6.0</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>pgRouting Extension</td>
</tr>
<tr>
<td><a href="https://github.com/pgpointcloud/pointcloud"><strong>pointcloud</strong></a></td>
<td><a href="/docs/pgext/gis/pointcloud"><strong><code>pointcloud</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.2.5</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>data type for lidar point clouds</td>
</tr>
<tr>
<td><a href="https://github.com/pgpointcloud/pointcloud"><strong>pointcloud_postgis</strong></a></td>
<td><a href="/docs/pgext/gis/pointcloud"><strong><code>pointcloud</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.2.5</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>integration for pointcloud LIDAR data and PostGIS geometry data</td>
</tr>
<tr>
<td><a href="https://github.com/zachasme/h3-pg"><strong>h3</strong></a></td>
<td><a href="/docs/pgext/gis/pg_h3"><strong><code>pg_h3</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.1.3</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>H3 bindings for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/zachasme/h3-pg"><strong>h3_postgis</strong></a></td>
<td><a href="/docs/pgext/gis/pg_h3"><strong><code>pg_h3</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.1.3</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>H3 PostGIS integration</td>
</tr>
<tr>
<td><a href="https://github.com/segasai/q3c"><strong>q3c</strong></a></td>
<td><a href="/docs/pgext/gis/q3c"><strong><code>q3c</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">2.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>q3c sky indexing plugin</td>
</tr>
<tr>
<td><a href="https://github.com/pramsey/pgsql-ogr-fdw"><strong>ogr_fdw</strong></a></td>
<td><a href="/docs/pgext/gis/ogr_fdw"><strong><code>ogr_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>foreign-data wrapper for GIS data access</td>
</tr>
<tr>
<td><a href="https://github.com/tvondra/geoip"><strong>geoip</strong></a></td>
<td><a href="/docs/pgext/gis/geoip"><strong><code>geoip</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.3.0</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>IP-based geolocation query</td>
</tr>
<tr>
<td><a href="https://github.com/jistok/pg_geohash"><strong>pg_geohash</strong></a></td>
<td><a href="/docs/pgext/gis/pg_geohash"><strong><code>pg_geohash</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Handle geohash based functionality for spatial coordinates</td>
</tr>
<tr>
<td><a href="https://github.com/MobilityDB/MobilityDB"><strong>mobilitydb</strong></a></td>
<td><a href="/docs/pgext/gis/mobilitydb"><strong><code>mobilitydb</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1.1</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>MobilityDB geospatial trajectory data management &amp; analysis platform</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/earthdistance.html"><strong>earthdistance</strong></a></td>
<td><a href="/docs/pgext/gis/earthdistance"><strong><code>earthdistance</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/gis"><strong><code>GIS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>calculate great-circle distances on the surface of the Earth</td>
</tr>
<tr>
<td><a href="https://github.com/pgvector/pgvector"><strong>vector</strong></a></td>
<td><a href="/docs/pgext/rag/pgvector"><strong><code>pgvector</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.7.3</td>
<td style="text-align:center"><a href="/docs/pgext/rag"><strong><code>RAG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>vector data type and ivfflat and hnsw access methods</td>
</tr>
<tr>
<td><a href="https://github.com/timescale/pgvectorscale"><strong>vectorscale</strong></a></td>
<td><a href="/docs/pgext/rag/pgvectorscale"><strong><code>pgvectorscale</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.2.0</td>
<td style="text-align:center"><a href="/docs/pgext/rag"><strong><code>RAG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>pgvectorscale:  Advanced indexing for vector data</td>
</tr>
<tr>
<td><a href="https://github.com/tembo-io/pg_vectorize"><strong>vectorize</strong></a></td>
<td><a href="/docs/pgext/rag/pg_vectorize"><strong><code>pg_vectorize</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.17.0</td>
<td style="text-align:center"><a href="/docs/pgext/rag"><strong><code>RAG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>The simplest way to do vector search on Postgres</td>
</tr>
<tr>
<td><a href="https://github.com/eulerto/pg_similarity"><strong>pg_similarity</strong></a></td>
<td><a href="/docs/pgext/rag/pg_similarity"><strong><code>pg_similarity</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/rag"><strong><code>RAG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>support similarity queries</td>
</tr>
<tr>
<td><a href="https://github.com/jirutka/smlar"><strong>smlar</strong></a></td>
<td><a href="/docs/pgext/rag/smlar"><strong><code>smlar</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/rag"><strong><code>RAG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Effective similarity search</td>
</tr>
<tr>
<td><a href="https://github.com/kelvich/pg_tiktoken"><strong>pg_tiktoken</strong></a></td>
<td><a href="/docs/pgext/rag/pg_tiktoken"><strong><code>pg_tiktoken</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/rag"><strong><code>RAG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>pg_tictoken: tiktoken tokenizer for use with OpenAI models in postgres</td>
</tr>
<tr>
<td><a href="https://github.com/postgresml/postgresml"><strong>pgml</strong></a></td>
<td><a href="/docs/pgext/rag/pgml"><strong><code>pgml</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">2.9.3</td>
<td style="text-align:center"><a href="/docs/pgext/rag"><strong><code>RAG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostgresML: Run AL/ML workloads with SQL interface</td>
</tr>
<tr>
<td><a href="https://github.com/paradedb/paradedb/tree/dev/pg_search"><strong>pg_search</strong></a></td>
<td><a href="/docs/pgext/fts/pg_search"><strong><code>pg_search</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.9.1</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">AGPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>pg_search: Full text search for PostgreSQL using BM25</td>
</tr>
<tr>
<td><a href="https://github.com/pgbigm/pg_bigm"><strong>pg_bigm</strong></a></td>
<td><a href="/docs/pgext/fts/pg_bigm"><strong><code>pg_bigm</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>create 2-gram (bigram) index for faster full text search.</td>
</tr>
<tr>
<td><a href="https://github.com/amutu/zhparser"><strong>zhparser</strong></a></td>
<td><a href="/docs/pgext/fts/zhparser"><strong><code>zhparser</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">2.2</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>a parser for full-text search of Chinese</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_cs_cz</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_cs_cz"><strong><code>hunspell_cs_cz</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Czech Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_de_de</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_de_de"><strong><code>hunspell_de_de</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>German Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_en_us</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_en_us"><strong><code>hunspell_en_us</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>en_US Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_fr</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_fr"><strong><code>hunspell_fr</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>French Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_ne_np</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_ne_np"><strong><code>hunspell_ne_np</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Nepali Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_nl_nl</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_nl_nl"><strong><code>hunspell_nl_nl</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Dutch Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_nn_no</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_nn_no"><strong><code>hunspell_nn_no</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Norwegian (norsk) Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_pt_pt</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_pt_pt"><strong><code>hunspell_pt_pt</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Portuguese Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_ru_ru</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_ru_ru"><strong><code>hunspell_ru_ru</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Russian Hunspell Dictionary</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/hunspell_dicts"><strong>hunspell_ru_ru_aot</strong></a></td>
<td><a href="/docs/pgext/fts/hunspell_ru_ru_aot"><strong><code>hunspell_ru_ru_aot</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Russian Hunspell Dictionary (from AOT.ru group)</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/fuzzystrmatch.html"><strong>fuzzystrmatch</strong></a></td>
<td><a href="/docs/pgext/fts/fuzzystrmatch"><strong><code>fuzzystrmatch</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>determine similarities and distance between strings</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgtrgm.html"><strong>pg_trgm</strong></a></td>
<td><a href="/docs/pgext/fts/pg_trgm"><strong><code>pg_trgm</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.6</td>
<td style="text-align:center"><a href="/docs/pgext/fts"><strong><code>FTS</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>text similarity measurement and index searching based on trigrams</td>
</tr>
<tr>
<td><a href="https://github.com/citusdata/citus"><strong>citus</strong></a></td>
<td><a href="/docs/pgext/olap/citus"><strong><code>citus</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">12.1-1</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">AGPLv3</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Distributed PostgreSQL as an extension</td>
</tr>
<tr>
<td><a href="https://github.com/citusdata/citus"><strong>citus_columnar</strong></a></td>
<td><a href="/docs/pgext/olap/citus"><strong><code>citus</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">11.3-1</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">AGPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Citus columnar storage engine</td>
</tr>
<tr>
<td><a href="https://github.com/hydradatabase/hydra"><strong>columnar</strong></a></td>
<td><a href="/docs/pgext/olap/hydra"><strong><code>hydra</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">11.1-11</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">AGPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Hydra Columnar extension</td>
</tr>
<tr>
<td><a href="https://github.com/paradedb/paradedb/tree/dev/pg_lakehouse"><strong>pg_lakehouse</strong></a></td>
<td><a href="/docs/pgext/olap/pg_lakehouse"><strong><code>pg_lakehouse</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.9.0</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">AGPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>pg_lakehouse: An analytical query engine for Postgres</td>
</tr>
<tr>
<td><a href="https://github.com/duckdb/pg_duckdb"><strong>pg_duckdb</strong></a></td>
<td><a href="/docs/pgext/olap/pg_duckdb"><strong><code>pg_duckdb</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>DuckDB Embedded in Postgres</td>
</tr>
<tr>
<td><a href="https://github.com/alitrack/duckdb_fdw"><strong>duckdb_fdw</strong></a></td>
<td><a href="/docs/pgext/olap/duckdb_fdw"><strong><code>duckdb_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>DuckDB Foreign Data Wrapper</td>
</tr>
<tr>
<td><a href="https://github.com/pgspider/parquet_s3_fdw"><strong>parquet_s3_fdw</strong></a></td>
<td><a href="/docs/pgext/olap/parquet_s3_fdw"><strong><code>parquet_s3_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.3.1</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>foreign-data wrapper for parquet on S3</td>
</tr>
<tr>
<td><a href="https://github.com/lemoineat/pg_fkpart"><strong>pg_fkpart</strong></a></td>
<td><a href="/docs/pgext/olap/pg_fkpart"><strong><code>pg_fkpart</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.7</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Table partitioning by foreign key utility</td>
</tr>
<tr>
<td><a href="https://github.com/pgpartman/pg_partman"><strong>pg_partman</strong></a></td>
<td><a href="/docs/pgext/olap/pg_partman"><strong><code>pg_partman</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">5.1.0</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Extension to manage partitioned tables by time or ID</td>
</tr>
<tr>
<td><a href="https://github.com/plproxy/plproxy"><strong>plproxy</strong></a></td>
<td><a href="/docs/pgext/olap/plproxy"><strong><code>plproxy</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.11.0</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Database partitioning implemented as procedural language</td>
</tr>
<tr>
<td><a href="https://github.com/heterodb/pg-strom"><strong>pg_strom</strong></a></td>
<td><a href="/docs/pgext/olap/pg_strom"><strong><code>pg_strom</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">5.1</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>PG-Strom - big-data processing acceleration using GPU and NVME</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/tablefunc.html"><strong>tablefunc</strong></a></td>
<td><a href="/docs/pgext/olap/tablefunc"><strong><code>tablefunc</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/olap"><strong><code>OLAP</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>functions that manipulate whole tables, including crosstab</td>
</tr>
<tr>
<td><a href="https://github.com/apache/age"><strong>age</strong></a></td>
<td><a href="/docs/pgext/feat/age"><strong><code>age</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.5.0</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>AGE graph database extension</td>
</tr>
<tr>
<td><a href="https://github.com/citusdata/postgresql-hll"><strong>hll</strong></a></td>
<td><a href="/docs/pgext/feat/hll"><strong><code>hll</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.18</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>type for storing hyperloglog data</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/rum"><strong>rum</strong></a></td>
<td><a href="/docs/pgext/feat/rum"><strong><code>rum</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.3</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>RUM index access method</td>
</tr>
<tr>
<td><a href="https://github.com/supabase/pg_graphql"><strong>pg_graphql</strong></a></td>
<td><a href="/docs/pgext/feat/pg_graphql"><strong><code>pg_graphql</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.5.7</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>pg_graphql: GraphQL support</td>
</tr>
<tr>
<td><a href="https://github.com/supabase/pg_jsonschema"><strong>pg_jsonschema</strong></a></td>
<td><a href="/docs/pgext/feat/pg_jsonschema"><strong><code>pg_jsonschema</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.3.1</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostgreSQL extension providing JSON Schema validation</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/jsquery"><strong>jsquery</strong></a></td>
<td><a href="/docs/pgext/feat/jsquery"><strong><code>jsquery</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>data type for jsonb inspection</td>
</tr>
<tr>
<td><a href="https://github.com/ossc-db/pg_hint_plan"><strong>pg_hint_plan</strong></a></td>
<td><a href="/docs/pgext/feat/pg_hint_plan"><strong><code>pg_hint_plan</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.6.0</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Give PostgreSQL ability to manually force some decisions in execution plans.</td>
</tr>
<tr>
<td><a href="https://github.com/HypoPG/hypopg"><strong>hypopg</strong></a></td>
<td><a href="/docs/pgext/feat/hypopg"><strong><code>hypopg</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4.1</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Hypothetical indexes for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/supabase/index_advisor"><strong>index_advisor</strong></a></td>
<td><a href="/docs/pgext/feat/index_advisor"><strong><code>index_advisor</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.2.0</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Query index advisor</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/imgsmlr"><strong>imgsmlr</strong></a></td>
<td><a href="/docs/pgext/feat/imgsmlr"><strong><code>imgsmlr</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Image similarity with haar</td>
</tr>
<tr>
<td><a href="https://github.com/sraoss/pg_ivm"><strong>pg_ivm</strong></a></td>
<td><a href="/docs/pgext/feat/pg_ivm"><strong><code>pg_ivm</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.8</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>incremental view maintenance on PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/tembo-io/pgmq"><strong>pgmq</strong></a></td>
<td><a href="/docs/pgext/feat/pgmq"><strong><code>pgmq</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.2.1</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>A lightweight message queue. Like AWS SQS and RSMQ but on Postgres.</td>
</tr>
<tr>
<td><a href="https://github.com/pgq/pgq"><strong>pgq</strong></a></td>
<td><a href="/docs/pgext/feat/pgq"><strong><code>pgq</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.5.1</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">ISC</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Generic queue for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/rdkit/rdkit"><strong>rdkit</strong></a></td>
<td><a href="/docs/pgext/feat/rdkit"><strong><code>rdkit</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.3.0</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Cheminformatics functionality for PostgreSQL.</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/bloom.html"><strong>bloom</strong></a></td>
<td><a href="/docs/pgext/feat/bloom"><strong><code>bloom</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/feat"><strong><code>FEAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>bloom access method - signature file based index</td>
</tr>
<tr>
<td><a href="https://github.com/aws/pg_tle"><strong>pg_tle</strong></a></td>
<td><a href="/docs/pgext/lang/pg_tle"><strong><code>pg_tle</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.2.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Trusted Language Extensions for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/plv8/plv8"><strong>plv8</strong></a></td>
<td><a href="/docs/pgext/lang/plv8"><strong><code>plv8</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">3.2.2</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PL/JavaScript (v8) trusted procedural language</td>
</tr>
<tr>
<td><a href="https://github.com/pllua/pllua"><strong>plluau</strong></a></td>
<td><a href="/docs/pgext/lang/pllua"><strong><code>pllua</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Lua as an untrusted procedural language</td>
</tr>
<tr>
<td><a href="https://github.com/pllua/pllua"><strong>hstore_plluau</strong></a></td>
<td><a href="/docs/pgext/lang/pllua"><strong><code>pllua</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Hstore transform for untrusted Lua</td>
</tr>
<tr>
<td><a href="https://github.com/pllua/pllua"><strong>pllua</strong></a></td>
<td><a href="/docs/pgext/lang/pllua"><strong><code>pllua</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Lua as a procedural language</td>
</tr>
<tr>
<td><a href="https://github.com/pllua/pllua"><strong>hstore_pllua</strong></a></td>
<td><a href="/docs/pgext/lang/pllua"><strong><code>pllua</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Hstore transform for Lua</td>
</tr>
<tr>
<td><a href="https://github.com/kaspermarstal/plprql"><strong>plprql</strong></a></td>
<td><a href="/docs/pgext/lang/plprql"><strong><code>plprql</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Use PRQL in PostgreSQL - Pipelined Relational Query Language</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/pldebugger"><strong>pldbgapi</strong></a></td>
<td><a href="/docs/pgext/lang/pldebugger"><strong><code>pldebugger</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Artistic</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>server-side support for debugging PL/pgSQL functions</td>
</tr>
<tr>
<td><a href="https://github.com/okbob/plpgsql_check"><strong>plpgsql_check</strong></a></td>
<td><a href="/docs/pgext/lang/plpgsql_check"><strong><code>plpgsql_check</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.7</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>extended check for plpgsql functions</td>
</tr>
<tr>
<td><a href="https://github.com/bigsql/plprofiler"><strong>plprofiler</strong></a></td>
<td><a href="/docs/pgext/lang/plprofiler"><strong><code>plprofiler</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.2</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Artistic</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>server-side support for profiling PL/pgSQL functions</td>
</tr>
<tr>
<td><a href="https://github.com/petere/plsh"><strong>plsh</strong></a></td>
<td><a href="/docs/pgext/lang/plsh"><strong><code>plsh</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>PL/sh procedural language</td>
</tr>
<tr>
<td><a href="https://github.com/tada/pljava"><strong>pljava</strong></a></td>
<td><a href="/docs/pgext/lang/pljava"><strong><code>pljava</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.6.6</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PL/Java procedural language (<a href="https://tada.github.io/pljava/">https://tada.github.io/pljava/</a>)</td>
</tr>
<tr>
<td><a href="https://github.com/postgres-plr/plr"><strong>plr</strong></a></td>
<td><a href="/docs/pgext/lang/plr"><strong><code>plr</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">8.4.6</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>load R interpreter and execute R script from within a database</td>
</tr>
<tr>
<td><a href="https://github.com/theory/pgtap"><strong>pgtap</strong></a></td>
<td><a href="/docs/pgext/lang/pgtap"><strong><code>pgtap</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.3.1</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Unit testing for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/anpandu/postgresql_faker"><strong>faker</strong></a></td>
<td><a href="/docs/pgext/lang/faker"><strong><code>faker</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.5.3</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Wrapper for the Faker Python library</td>
</tr>
<tr>
<td><a href="https://github.com/nuodb/dbt2/tree/master"><strong>dbt2</strong></a></td>
<td><a href="/docs/pgext/lang/dbt2"><strong><code>dbt2</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.45.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Artistic</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>OSDL-DBT-2 test kit</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pltcl.html"><strong>pltcl</strong></a></td>
<td><a href="/docs/pgext/lang/pltcl"><strong><code>pltcl</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>PL/Tcl procedural language</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pltcl.html"><strong>pltclu</strong></a></td>
<td><a href="/docs/pgext/lang/pltcl"><strong><code>pltcl</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>PL/TclU untrusted procedural language</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plperl.html"><strong>plperl</strong></a></td>
<td><a href="/docs/pgext/lang/plperl"><strong><code>plperl</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>PL/Perl procedural language</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plperl.html"><strong>bool_plperl</strong></a></td>
<td><a href="/docs/pgext/lang/plperl"><strong><code>plperl</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>transform between bool and plperl</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plperl.html"><strong>hstore_plperl</strong></a></td>
<td><a href="/docs/pgext/lang/plperl"><strong><code>plperl</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>transform between hstore and plperl</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plperl.html"><strong>jsonb_plperl</strong></a></td>
<td><a href="/docs/pgext/lang/plperl"><strong><code>plperl</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>transform between jsonb and plperl</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plperl.html"><strong>plperlu</strong></a></td>
<td><a href="/docs/pgext/lang/plperlu"><strong><code>plperlu</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>PL/PerlU untrusted procedural language</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plperl.html"><strong>bool_plperlu</strong></a></td>
<td><a href="/docs/pgext/lang/plperlu"><strong><code>plperlu</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>transform between bool and plperlu</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plperl.html"><strong>jsonb_plperlu</strong></a></td>
<td><a href="/docs/pgext/lang/plperlu"><strong><code>plperlu</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>transform between jsonb and plperlu</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plperl.html"><strong>hstore_plperlu</strong></a></td>
<td><a href="/docs/pgext/lang/plperlu"><strong><code>plperlu</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>transform between hstore and plperlu</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plpgsql.html"><strong>plpgsql</strong></a></td>
<td><a href="/docs/pgext/lang/plpgsql"><strong><code>plpgsql</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>PL/pgSQL procedural language</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plpython.html"><strong>plpython3u</strong></a></td>
<td><a href="/docs/pgext/lang/plpython3u"><strong><code>plpython3u</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PL/Python3U untrusted procedural language</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plpython.html"><strong>jsonb_plpython3u</strong></a></td>
<td><a href="/docs/pgext/lang/plpython3u"><strong><code>plpython3u</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>transform between jsonb and plpython3u</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plpython.html"><strong>ltree_plpython3u</strong></a></td>
<td><a href="/docs/pgext/lang/plpython3u"><strong><code>plpython3u</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>transform between ltree and plpython3u</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/plpython.html"><strong>hstore_plpython3u</strong></a></td>
<td><a href="/docs/pgext/lang/plpython3u"><strong><code>plpython3u</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/lang"><strong><code>LANG</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>transform between hstore and plpython3u</td>
</tr>
<tr>
<td><a href="https://github.com/dimitri/prefix"><strong>prefix</strong></a></td>
<td><a href="/docs/pgext/type/prefix"><strong><code>prefix</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.2.0</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Prefix Range module for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/theory/pg-semver"><strong>semver</strong></a></td>
<td><a href="/docs/pgext/type/semver"><strong><code>semver</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.32.1</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Semantic version data type</td>
</tr>
<tr>
<td><a href="https://github.com/df7cb/postgresql-unit"><strong>unit</strong></a></td>
<td><a href="/docs/pgext/type/pgunit"><strong><code>pgunit</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">7</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>SI units extension</td>
</tr>
<tr>
<td><a href="https://github.com/tvondra/md5hash"><strong>md5hash</strong></a></td>
<td><a href="/docs/pgext/type/md5hash"><strong><code>md5hash</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>type for storing 128-bit binary data inline</td>
</tr>
<tr>
<td><a href="https://github.com/df7cb/pgsql-asn1oid"><strong>asn1oid</strong></a></td>
<td><a href="/docs/pgext/type/asn1oid"><strong><code>asn1oid</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>asn1oid extension</td>
</tr>
<tr>
<td><a href="https://github.com/ChenHuajun/pg_roaringbitmap"><strong>roaringbitmap</strong></a></td>
<td><a href="/docs/pgext/type/roaringbitmap"><strong><code>roaringbitmap</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.5</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>support for Roaring Bitmaps</td>
</tr>
<tr>
<td><a href="https://github.com/cybertec-postgresql/pgfaceting"><strong>pgfaceting</strong></a></td>
<td><a href="/docs/pgext/type/pgfaceting"><strong><code>pgfaceting</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.2.0</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>fast faceting queries using an inverted index</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/pgsphere"><strong>pg_sphere</strong></a></td>
<td><a href="/docs/pgext/type/pgsphere"><strong><code>pgsphere</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.5.1</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>spherical objects with useful functions, operators and index support</td>
</tr>
<tr>
<td><a href="https://github.com/adjust/pg-country"><strong>country</strong></a></td>
<td><a href="/docs/pgext/type/pg_country"><strong><code>pg_country</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.3</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Country data type, ISO 3166-1</td>
</tr>
<tr>
<td><a href="https://github.com/adjust/pg-currency"><strong>currency</strong></a></td>
<td><a href="/docs/pgext/type/pg_currency"><strong><code>pg_currency</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.3</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Custom PostgreSQL currency type in 1Byte</td>
</tr>
<tr>
<td><a href="https://github.com/dvarrazzo/pgmp/"><strong>pgmp</strong></a></td>
<td><a href="/docs/pgext/type/pgmp"><strong><code>pgmp</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">LGPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Multiple Precision Arithmetic extension</td>
</tr>
<tr>
<td><a href="https://github.com/df7cb/postgresql-numeral"><strong>numeral</strong></a></td>
<td><a href="/docs/pgext/type/numeral"><strong><code>numeral</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>numeral datatypes extension</td>
</tr>
<tr>
<td><a href="https://github.com/begriffs/pg_rational"><strong>pg_rational</strong></a></td>
<td><a href="/docs/pgext/type/pg_rational"><strong><code>pg_rational</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.2</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>bigint fractions</td>
</tr>
<tr>
<td><a href="https://github.com/petere/pguint"><strong>uint</strong></a></td>
<td><a href="/docs/pgext/type/pguint"><strong><code>pguint</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>unsigned integer types</td>
</tr>
<tr>
<td><a href="https://github.com/RhodiumToad/ip4r"><strong>ip4r</strong></a></td>
<td><a href="/docs/pgext/type/ip4r"><strong><code>ip4r</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.4</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>IPv4/v6 and IPv4/v6 range index type for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/petere/pguri"><strong>uri</strong></a></td>
<td><a href="/docs/pgext/type/pg_uri"><strong><code>pg_uri</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.20151224</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>URI Data type for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/petere/pgemailaddr"><strong>pgemailaddr</strong></a></td>
<td><a href="/docs/pgext/type/pgemailaddr"><strong><code>pgemailaddr</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Email address type for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/arkhipov/acl"><strong>acl</strong></a></td>
<td><a href="/docs/pgext/type/acl"><strong><code>acl</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.4</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong>BSD-2</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>ACL Data type</td>
</tr>
<tr>
<td><a href="https://github.com/ATIX-AG/postgresql-debversion-evr"><strong>debversion</strong></a></td>
<td><a href="/docs/pgext/type/debversion"><strong><code>debversion</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Debian version number data type</td>
</tr>
<tr>
<td><a href="https://github.com/petropavel13/pg_rrule"><strong>pg_rrule</strong></a></td>
<td><a href="/docs/pgext/type/pg_rrule"><strong><code>pg_rrule</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.2.0</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>RRULE field type for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/optiver/timestamp9"><strong>timestamp9</strong></a></td>
<td><a href="/docs/pgext/type/timestamp9"><strong><code>timestamp9</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4.0</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>timestamp nanosecond resolution</td>
</tr>
<tr>
<td><a href="https://github.com/lacanoid/chkpass"><strong>chkpass</strong></a></td>
<td><a href="/docs/pgext/type/chkpass"><strong><code>chkpass</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>data type for auto-encrypted passwords</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/isn.html"><strong>isn</strong></a></td>
<td><a href="/docs/pgext/type/isn"><strong><code>isn</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>data types for international product numbering standards</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/seg.html"><strong>seg</strong></a></td>
<td><a href="/docs/pgext/type/seg"><strong><code>seg</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.4</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>data type for representing line segments or floating-point intervals</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/cube.html"><strong>cube</strong></a></td>
<td><a href="/docs/pgext/type/cube"><strong><code>cube</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.5</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>data type for multidimensional cubes</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/ltree.html"><strong>ltree</strong></a></td>
<td><a href="/docs/pgext/type/ltree"><strong><code>ltree</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>data type for hierarchical tree-like structures</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/hstore.html"><strong>hstore</strong></a></td>
<td><a href="/docs/pgext/type/hstore"><strong><code>hstore</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.8</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>data type for storing sets of (key, value) pairs</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/citext.html"><strong>citext</strong></a></td>
<td><a href="/docs/pgext/type/citext"><strong><code>citext</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.6</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>data type for case-insensitive character strings</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/xml2.html"><strong>xml2</strong></a></td>
<td><a href="/docs/pgext/type/xml2"><strong><code>xml2</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/type"><strong><code>TYPE</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>XPath querying and XSLT</td>
</tr>
<tr>
<td><a href="https://github.com/citusdata/postgresql-topn"><strong>topn</strong></a></td>
<td><a href="/docs/pgext/func/topn"><strong><code>topn</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.6.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">AGPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>type for top-n JSONB</td>
</tr>
<tr>
<td><a href="https://github.com/pramsey/pgsql-gzip"><strong>gzip</strong></a></td>
<td><a href="/docs/pgext/func/pg_gzip"><strong><code>pg_gzip</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>gzip and gunzip functions.</td>
</tr>
<tr>
<td><a href="https://github.com/grahamedgecombe/pgzstd"><strong>zstd</strong></a></td>
<td><a href="/docs/pgext/func/pg_zstd"><strong><code>pg_zstd</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">ISC</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Zstandard compression algorithm implementation in PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/pramsey/pgsql-http"><strong>http</strong></a></td>
<td><a href="/docs/pgext/func/pg_http"><strong><code>pg_http</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.6</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>HTTP client for PostgreSQL, allows web page retrieval inside the database.</td>
</tr>
<tr>
<td><a href="https://github.com/supabase/pg_net"><strong>pg_net</strong></a></td>
<td><a href="/docs/pgext/func/pg_net"><strong><code>pg_net</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.8.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Async HTTP Requests</td>
</tr>
<tr>
<td><a href="https://github.com/bigsmoke/pg_html5_email_address"><strong>pg_html5_email_address</strong></a></td>
<td><a href="/docs/pgext/func/pg_html5_email_address"><strong><code>pg_html5_email_address</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.2.3</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>PostgreSQL email validation that is consistent with the HTML5 spec</td>
</tr>
<tr>
<td><a href="https://github.com/sjstoelting/pgsql-tweaks"><strong>pgsql_tweaks</strong></a></td>
<td><a href="/docs/pgext/func/pgsql_tweaks"><strong><code>pgsql_tweaks</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.10.3</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Some functions and views for daily usage</td>
</tr>
<tr>
<td><a href="https://github.com/bigsmoke/pg_extra_time"><strong>pg_extra_time</strong></a></td>
<td><a href="/docs/pgext/func/pg_extra_time"><strong><code>pg_extra_time</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1.3</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Some date time functions and operators that,</td>
</tr>
<tr>
<td><a href="https://github.com/joelonsql/pg-timeit"><strong>timeit</strong></a></td>
<td><a href="/docs/pgext/func/pg_timeit"><strong><code>pg_timeit</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>High-accuracy timing of SQL expressions</td>
</tr>
<tr>
<td><a href="https://github.com/tvondra/count_distinct"><strong>count_distinct</strong></a></td>
<td><a href="/docs/pgext/func/count_distinct"><strong><code>count_distinct</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>An alternative to COUNT(DISTINCT …) aggregate, usable with HashAggregate</td>
</tr>
<tr>
<td><a href="https://github.com/xocolatl/extra_window_functions"><strong>extra_window_functions</strong></a></td>
<td><a href="/docs/pgext/func/extra_window_functions"><strong><code>extra_window_functions</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Extra Window Functions for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/wulczer/first_last_agg"><strong>first_last_agg</strong></a></td>
<td><a href="/docs/pgext/func/first_last_agg"><strong><code>first_last_agg</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.1.4</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>first() and last() aggregate functions</td>
</tr>
<tr>
<td><a href="https://github.com/tdunning/t-digest"><strong>tdigest</strong></a></td>
<td><a href="/docs/pgext/func/tdigest"><strong><code>tdigest</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Provides tdigest aggregate function.</td>
</tr>
<tr>
<td><a href="https://github.com/pjungwir/aggs_for_vecs"><strong>aggs_for_vecs</strong></a></td>
<td><a href="/docs/pgext/func/aggs_for_vecs"><strong><code>aggs_for_vecs</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.3.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Aggregate functions for array inputs</td>
</tr>
<tr>
<td><a href="https://github.com/pjungwir/aggs_for_arrays"><strong>aggs_for_arrays</strong></a></td>
<td><a href="/docs/pgext/func/aggs_for_arrays"><strong><code>aggs_for_arrays</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.3.2</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Various functions for computing statistics on arrays of numbers</td>
</tr>
<tr>
<td><a href="https://github.com/pramsey/pgsql-arraymath"><strong>arraymath</strong></a></td>
<td><a href="/docs/pgext/func/pg_arraymath"><strong><code>pg_arraymath</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Array math and operators that work element by element on the contents of arrays</td>
</tr>
<tr>
<td><a href="https://github.com/tvondra/quantile"><strong>quantile</strong></a></td>
<td><a href="/docs/pgext/func/quantile"><strong><code>quantile</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.1.7</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong>BSD</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Quantile aggregation function</td>
</tr>
<tr>
<td><a href="https://github.com/tvondra/lower_quantile"><strong>lower_quantile</strong></a></td>
<td><a href="/docs/pgext/func/lower_quantile"><strong><code>lower_quantile</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong>BSD-2</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Lower quantile aggregate function</td>
</tr>
<tr>
<td><a href="https://github.com/VADOSWARE/pg_idkit"><strong>pg_idkit</strong></a></td>
<td><a href="/docs/pgext/func/pg_idkit"><strong><code>pg_idkit</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.2.3</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>multi-tool for generating new/niche universally unique identifiers (ex. UUIDv6, ULID, KSUID)</td>
</tr>
<tr>
<td><a href="https://github.com/fboulnois/pg_uuidv7"><strong>pg_uuidv7</strong></a></td>
<td><a href="/docs/pgext/func/pg_uuidv7"><strong><code>pg_uuidv7</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.5</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">MPLv2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>pg_uuidv7: create UUIDv7 values in postgres</td>
</tr>
<tr>
<td><a href="https://github.com/dverite/permuteseq"><strong>permuteseq</strong></a></td>
<td><a href="/docs/pgext/func/permuteseq"><strong><code>permuteseq</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Pseudo-randomly permute sequences with a format-preserving encryption on elements</td>
</tr>
<tr>
<td><a href="https://github.com/iCyberon/pg_hashids"><strong>pg_hashids</strong></a></td>
<td><a href="/docs/pgext/func/pg_hashids"><strong><code>pg_hashids</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.3</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Short unique id generator for PostgreSQL, using hashids</td>
</tr>
<tr>
<td><a href="https://github.com/tvondra/sequential-uuids"><strong>sequential_uuids</strong></a></td>
<td><a href="/docs/pgext/func/sequential_uuids"><strong><code>sequential_uuids</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0.2</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>generator of sequential UUIDs</td>
</tr>
<tr>
<td><a href="https://github.com/chanukyasds/pg_math"><strong>pg_math</strong></a></td>
<td><a href="/docs/pgext/func/pg_math"><strong><code>pg_math</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong>GPLv3</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>GSL statistical functions for postgresql</td>
</tr>
<tr>
<td><a href="https://github.com/tvondra/random"><strong>random</strong></a></td>
<td><a href="/docs/pgext/func/pg_random"><strong><code>pg_random</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">2.0.0-dev</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>random data generator</td>
</tr>
<tr>
<td><a href="https://github.com/adjust/pg-base36"><strong>base36</strong></a></td>
<td><a href="/docs/pgext/func/pg_base36"><strong><code>pg_base36</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Integer Base36 types</td>
</tr>
<tr>
<td><a href="https://github.com/adjust/pg-base62"><strong>base62</strong></a></td>
<td><a href="/docs/pgext/func/pg_base62"><strong><code>pg_base62</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Base62 extension for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/pjungwir/floatvec"><strong>floatvec</strong></a></td>
<td><a href="/docs/pgext/func/floatvec"><strong><code>floatvec</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Math for vectors (arrays) of numbers</td>
</tr>
<tr>
<td><a href="https://github.com/intgr/pg_financial"><strong>financial</strong></a></td>
<td><a href="/docs/pgext/func/pg_financial"><strong><code>pg_financial</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Financial aggregate functions</td>
</tr>
<tr>
<td><a href="https://github.com/michelp/pgjwt"><strong>pgjwt</strong></a></td>
<td><a href="/docs/pgext/func/pgjwt"><strong><code>pgjwt</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.2.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>JSON Web Token API for Postgresql</td>
</tr>
<tr>
<td><a href="https://github.com/markokr/pghashlib"><strong>pg_hashlib</strong></a></td>
<td><a href="/docs/pgext/func/pg_hashlib"><strong><code>pg_hashlib</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Stable hash functions for Postgres</td>
</tr>
<tr>
<td><a href="https://github.com/dverite/postgres-shacrypt"><strong>shacrypt</strong></a></td>
<td><a href="/docs/pgext/func/shacrypt"><strong><code>shacrypt</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Implements SHA256-CRYPT and SHA512-CRYPT password encryption schemes</td>
</tr>
<tr>
<td><a href="https://github.com/dverite/cryptint"><strong>cryptint</strong></a></td>
<td><a href="/docs/pgext/func/cryptint"><strong><code>cryptint</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Encryption functions for int and bigint values</td>
</tr>
<tr>
<td><a href="https://github.com/ameensol/pg-ecdsa"><strong>pguecc</strong></a></td>
<td><a href="/docs/pgext/func/pg_ecdsa"><strong><code>pg_ecdsa</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong>BSD-2</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>uECC bindings for Postgres</td>
</tr>
<tr>
<td><a href="https://github.com/petere/pgpcre"><strong>pgpcre</strong></a></td>
<td><a href="/docs/pgext/func/pgpcre"><strong><code>pgpcre</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Perl Compatible Regular Expression functions</td>
</tr>
<tr>
<td><a href="https://github.com/dverite/icu_ext"><strong>icu_ext</strong></a></td>
<td><a href="/docs/pgext/func/icu_ext"><strong><code>icu_ext</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.8</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Access ICU functions</td>
</tr>
<tr>
<td><a href="https://github.com/Fenoman/pgqr"><strong>pgqr</strong></a></td>
<td><a href="/docs/pgext/func/pgqr"><strong><code>pgqr</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong>BSD-3</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>QR Code generator from PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/theory/pg-envvar"><strong>envvar</strong></a></td>
<td><a href="/docs/pgext/func/envvar"><strong><code>envvar</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Fetch the value of an environment variable</td>
</tr>
<tr>
<td><a href="https://github.com/afiskon/pg_protobuf"><strong>pg_protobuf</strong></a></td>
<td><a href="/docs/pgext/func/pg_protobuf"><strong><code>pg_protobuf</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Protobuf support for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/okbob/url_encode"><strong>url_encode</strong></a></td>
<td><a href="/docs/pgext/func/url_encode"><strong><code>url_encode</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.2.5</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>url_encode, url_decode functions</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/contrib-spi.html#CONTRIB-SPI-REFINT"><strong>refint</strong></a></td>
<td><a href="/docs/pgext/func/refint"><strong><code>refint</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>functions for implementing referential integrity (obsolete)</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/contrib-spi.html#CONTRIB-SPI-AUTOINC"><strong>autoinc</strong></a></td>
<td><a href="/docs/pgext/func/autoinc"><strong><code>autoinc</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>functions for autoincrementing fields</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/contrib-spi.html#CONTRIB-SPI-INSERT-USERNAME"><strong>insert_username</strong></a></td>
<td><a href="/docs/pgext/func/insert_username"><strong><code>insert_username</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>functions for tracking who changed a table</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/contrib-spi.html#CONTRIB-SPI-MODDATETIME"><strong>moddatetime</strong></a></td>
<td><a href="/docs/pgext/func/moddatetime"><strong><code>moddatetime</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>functions for tracking last modification time</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/tsm-system-time.html"><strong>tsm_system_time</strong></a></td>
<td><a href="/docs/pgext/func/tsm_system_time"><strong><code>tsm_system_time</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>TABLESAMPLE method which accepts time in milliseconds as a limit</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/dict-xsyn.html"><strong>dict_xsyn</strong></a></td>
<td><a href="/docs/pgext/func/dict_xsyn"><strong><code>dict_xsyn</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>text search dictionary template for extended synonym processing</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/tsm-system-rows.html"><strong>tsm_system_rows</strong></a></td>
<td><a href="/docs/pgext/func/tsm_system_rows"><strong><code>tsm_system_rows</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>TABLESAMPLE method which accepts number of rows as a limit</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/tcn.html"><strong>tcn</strong></a></td>
<td><a href="/docs/pgext/func/tcn"><strong><code>tcn</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>Triggered change notifications</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/uuid-ossp.html"><strong>uuid-ossp</strong></a></td>
<td><a href="/docs/pgext/func/uuid-ossp"><strong><code>uuid-ossp</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>generate universally unique identifiers (UUIDs)</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/btree-gist.html"><strong>btree_gist</strong></a></td>
<td><a href="/docs/pgext/func/btree_gist"><strong><code>btree_gist</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.7</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>support for indexing common datatypes in GiST</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/btree-gin.html"><strong>btree_gin</strong></a></td>
<td><a href="/docs/pgext/func/btree_gin"><strong><code>btree_gin</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.3</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>support for indexing common datatypes in GIN</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/intarray.html"><strong>intarray</strong></a></td>
<td><a href="/docs/pgext/func/intarray"><strong><code>intarray</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.5</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>functions, operators, and index support for 1-D arrays of integers</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/intagg.html"><strong>intagg</strong></a></td>
<td><a href="/docs/pgext/func/intagg"><strong><code>intagg</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>integer aggregator and enumerator (obsolete)</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/dict-int.html"><strong>dict_int</strong></a></td>
<td><a href="/docs/pgext/func/dict_int"><strong><code>dict_int</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>text search dictionary template for integers</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/unaccent.html"><strong>unaccent</strong></a></td>
<td><a href="/docs/pgext/func/unaccent"><strong><code>unaccent</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/func"><strong><code>FUNC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>text search dictionary that removes accents</td>
</tr>
<tr>
<td><a href="https://github.com/reorg/pg_repack"><strong>pg_repack</strong></a></td>
<td><a href="/docs/pgext/admin/pg_repack"><strong><code>pg_repack</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.5.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Reorganize tables in PostgreSQL databases with minimal locks</td>
</tr>
<tr>
<td><a href="https://github.com/cybertec-postgresql/pg_squeeze"><strong>pg_squeeze</strong></a></td>
<td><a href="/docs/pgext/admin/pg_squeeze"><strong><code>pg_squeeze</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.6</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>A tool to remove unused space from a relation.</td>
</tr>
<tr>
<td><a href="https://github.com/df7cb/pg_dirtyread"><strong>pg_dirtyread</strong></a></td>
<td><a href="/docs/pgext/admin/pg_dirtyread"><strong><code>pg_dirtyread</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">2</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Read dead but unvacuumed rows from table</td>
</tr>
<tr>
<td><a href="https://github.com/klando/pgfincore"><strong>pgfincore</strong></a></td>
<td><a href="/docs/pgext/admin/pgfincore"><strong><code>pgfincore</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.3.1</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>examine and manage the os buffer cache</td>
</tr>
<tr>
<td><a href="https://github.com/rustprooflabs/pgdd"><strong>pgdd</strong></a></td>
<td><a href="/docs/pgext/admin/pgdd"><strong><code>pgdd</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.5.2</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>An in-database data dictionary providing database introspection via standard SQL query syntax. Developed using pgx (<a href="https://github.com/zombodb/pgx)">https://github.com/zombodb/pgx)</a>.</td>
</tr>
<tr>
<td><a href="https://github.com/lacanoid/pgddl"><strong>ddlx</strong></a></td>
<td><a href="/docs/pgext/admin/ddlx"><strong><code>ddlx</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.27</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>DDL eXtractor functions</td>
</tr>
<tr>
<td><a href="https://github.com/schmiddy/pg_prioritize"><strong>prioritize</strong></a></td>
<td><a href="/docs/pgext/admin/pg_prioritize"><strong><code>pg_prioritize</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>get and set the priority of PostgreSQL backends</td>
</tr>
<tr>
<td><a href="https://github.com/credativ/pg_checksums"><strong>pg_checksums</strong></a></td>
<td><a href="/docs/pgext/admin/pg_checksums"><strong><code>pg_checksums</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Activate/deactivate/verify checksums in offline Postgres clusters</td>
</tr>
<tr>
<td><a href="https://github.com/pierreforstmann/pg_readonly"><strong>pg_readonly</strong></a></td>
<td><a href="/docs/pgext/admin/pg_readonly"><strong><code>pg_readonly</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>cluster database read only</td>
</tr>
<tr>
<td><a href="https://github.com/eradman/pg-safeupdate"><strong>safeupdate</strong></a></td>
<td><a href="/docs/pgext/admin/safeupdate"><strong><code>safeupdate</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">ISC</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Require criteria for UPDATE and DELETE</td>
</tr>
<tr>
<td><a href="https://github.com/cybertec-postgresql/pg_permissions"><strong>pg_permissions</strong></a></td>
<td><a href="/docs/pgext/admin/pg_permissions"><strong><code>pg_permissions</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.3</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>view object permissions and compare them with the desired state</td>
</tr>
<tr>
<td><a href="https://github.com/hapostgres/pg_auto_failover"><strong>pgautofailover</strong></a></td>
<td><a href="/docs/pgext/admin/pgautofailover"><strong><code>pgautofailover</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.1</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>pg_auto_failover</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/pg_catcheck"><strong>pg_catcheck</strong></a></td>
<td><a href="/docs/pgext/admin/pg_catcheck"><strong><code>pg_catcheck</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Diagnosing system catalog corruption</td>
</tr>
<tr>
<td><a href="https://github.com/dimitri/preprepare"><strong>pre_prepare</strong></a></td>
<td><a href="/docs/pgext/admin/preprepare"><strong><code>preprepare</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.4</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Pre Prepare your Statement server side</td>
</tr>
<tr>
<td><a href="https://github.com/vventirozos/pgcozy"><strong>pgcozy</strong></a></td>
<td><a href="/docs/pgext/admin/pgcozy"><strong><code>pgcozy</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Pre-warming shared buffers according to previous pg_buffercache snapshots for PostgreSQL.</td>
</tr>
<tr>
<td><a href="https://github.com/bdrouvot/pg_orphaned"><strong>pg_orphaned</strong></a></td>
<td><a href="/docs/pgext/admin/pg_orphaned"><strong><code>pg_orphaned</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Deal with orphaned files</td>
</tr>
<tr>
<td><a href="https://github.com/cybertec-postgresql/pg_crash"><strong>pg_crash</strong></a></td>
<td><a href="/docs/pgext/admin/pg_crash"><strong><code>pg_crash</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong>BSD-3</strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Send random signals to random processes</td>
</tr>
<tr>
<td><a href="https://github.com/MasaoFujii/pg_cheat_funcs"><strong>pg_cheat_funcs</strong></a></td>
<td><a href="/docs/pgext/admin/pg_cheat_funcs"><strong><code>pg_cheat_funcs</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Provides cheat (but useful) functions</td>
</tr>
<tr>
<td><a href="https://github.com/viggy28/pg_savior"><strong>pg_savior</strong></a></td>
<td><a href="/docs/pgext/admin/pg_savior"><strong><code>pg_savior</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Postgres extension to save OOPS mistakes</td>
</tr>
<tr>
<td><a href="https://github.com/df7cb/table_log"><strong>table_log</strong></a></td>
<td><a href="/docs/pgext/admin/table_log"><strong><code>table_log</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.6.1</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>record table modification logs and PITR for table/row</td>
</tr>
<tr>
<td><a href="https://github.com/csimsek/pgsql-fio"><strong>pg_fio</strong></a></td>
<td><a href="/docs/pgext/admin/pg_fio"><strong><code>pg_fio</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong>BSD-3</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>PostgreSQL File I/O Functions</td>
</tr>
<tr>
<td><a href="https://pgpool.net/"><strong>pgpool_adm</strong></a></td>
<td><a href="/docs/pgext/admin/pgpool"><strong><code>pgpool</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.5</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Administrative functions for pgPool</td>
</tr>
<tr>
<td><a href="https://pgpool.net/"><strong>pgpool_recovery</strong></a></td>
<td><a href="/docs/pgext/admin/pgpool"><strong><code>pgpool</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>recovery functions for pgpool-II for V4.3</td>
</tr>
<tr>
<td><a href="https://pgpool.net/"><strong>pgpool_regclass</strong></a></td>
<td><a href="/docs/pgext/admin/pgpool"><strong><code>pgpool</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>replacement for regclass</td>
</tr>
<tr>
<td><a href="https://www.pgadmin.org/docs/pgadmin4/development/pgagent.html"><strong>pgagent</strong></a></td>
<td><a href="/docs/pgext/admin/pgagent"><strong><code>pgagent</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.2</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>A PostgreSQL job scheduler</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/vacuumlo.html"><strong>vacuumlo</strong></a></td>
<td><a href="/docs/pgext/admin/vacuumlo"><strong><code>vacuumlo</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>utility program that will remove any orphaned large objects from a PostgreSQL database</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgprewarm.html"><strong>pg_prewarm</strong></a></td>
<td><a href="/docs/pgext/admin/pg_prewarm"><strong><code>pg_prewarm</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>prewarm relation data</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/oid2name.html"><strong>oid2name</strong></a></td>
<td><a href="/docs/pgext/admin/oid2name"><strong><code>oid2name</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>utility program that helps administrators to examine the file structure used by PostgreSQL</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/lo.html"><strong>lo</strong></a></td>
<td><a href="/docs/pgext/admin/lo"><strong><code>lo</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>Large Object maintenance</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/basic-archive.html"><strong>basic_archive</strong></a></td>
<td><a href="/docs/pgext/admin/basic_archive"><strong><code>basic_archive</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>an example of an archive module</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/basebackup-to-shell.html"><strong>basebackup_to_shell</strong></a></td>
<td><a href="/docs/pgext/admin/basebackup_to_shell"><strong><code>basebackup_to_shell</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>adds a custom basebackup target called shell</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/oldsnapshot.html"><strong>old_snapshot</strong></a></td>
<td><a href="/docs/pgext/admin/old_snapshot"><strong><code>old_snapshot</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>utilities in support of old_snapshot_threshold</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/adminpack.html"><strong>adminpack</strong></a></td>
<td><a href="/docs/pgext/admin/adminpack"><strong><code>adminpack</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">2.1</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>administrative functions for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/amcheck.html"><strong>amcheck</strong></a></td>
<td><a href="/docs/pgext/admin/amcheck"><strong><code>amcheck</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.3</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>functions for verifying relation integrity</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgsurgery.html"><strong>pg_surgery</strong></a></td>
<td><a href="/docs/pgext/admin/pg_surgery"><strong><code>pg_surgery</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/admin"><strong><code>ADMIN</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>extension to perform surgery on a damaged relation</td>
</tr>
<tr>
<td><a href="https://github.com/zubkov-andrei/pg_profile"><strong>pg_profile</strong></a></td>
<td><a href="/docs/pgext/stat/pg_profile"><strong><code>pg_profile</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.6</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostgreSQL load profile repository and report builder</td>
</tr>
<tr>
<td><a href="https://github.com/cybertec-postgresql/pg_show_plans"><strong>pg_show_plans</strong></a></td>
<td><a href="/docs/pgext/stat/pg_show_plans"><strong><code>pg_show_plans</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.1</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>show query plans of all currently running SQL statements</td>
</tr>
<tr>
<td><a href="https://github.com/powa-team/pg_stat_kcache"><strong>pg_stat_kcache</strong></a></td>
<td><a href="/docs/pgext/stat/pg_stat_kcache"><strong><code>pg_stat_kcache</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.2.3</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Kernel statistics gathering</td>
</tr>
<tr>
<td><a href="https://github.com/percona/pg_stat_monitor"><strong>pg_stat_monitor</strong></a></td>
<td><a href="/docs/pgext/stat/pg_stat_monitor"><strong><code>pg_stat_monitor</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.0</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>The pg_stat_monitor is a PostgreSQL Query Performance Monitoring tool, based on PostgreSQL contrib module pg_stat_statements. pg_stat_monitor provides aggregated statistics, client information, plan details including plan, and histogram information.</td>
</tr>
<tr>
<td><a href="https://github.com/powa-team/pg_qualstats"><strong>pg_qualstats</strong></a></td>
<td><a href="/docs/pgext/stat/pg_qualstats"><strong><code>pg_qualstats</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.1.0</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>An extension collecting statistics about quals</td>
</tr>
<tr>
<td><a href="https://github.com/ossc-db/pg_store_plans"><strong>pg_store_plans</strong></a></td>
<td><a href="/docs/pgext/stat/pg_store_plans"><strong><code>pg_store_plans</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.8</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>track plan statistics of all SQL statements executed</td>
</tr>
<tr>
<td><a href="https://github.com/rjuju/pg_track_settings"><strong>pg_track_settings</strong></a></td>
<td><a href="/docs/pgext/stat/pg_track_settings"><strong><code>pg_track_settings</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.1.2</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Track settings changes</td>
</tr>
<tr>
<td><a href="https://github.com/postgrespro/pg_wait_sampling"><strong>pg_wait_sampling</strong></a></td>
<td><a href="/docs/pgext/stat/pg_wait_sampling"><strong><code>pg_wait_sampling</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>sampling based statistics of wait events</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/system_stats"><strong>system_stats</strong></a></td>
<td><a href="/docs/pgext/stat/system_stats"><strong><code>system_stats</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.0</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>EnterpriseDB system statistics for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/aquameta/meta"><strong>meta</strong></a></td>
<td><a href="/docs/pgext/stat/pg_meta"><strong><code>pg_meta</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.4.0</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong>BSD-2</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Normalized, friendlier system catalog for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/CrunchyData/pgnodemx"><strong>pgnodemx</strong></a></td>
<td><a href="/docs/pgext/stat/pgnodemx"><strong><code>pgnodemx</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.6</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Capture node OS metrics via SQL queries</td>
</tr>
<tr>
<td><a href="https://github.com/markwkm/pg_proctab"><strong>pg_proctab</strong></a></td>
<td><a href="/docs/pgext/stat/pgnodemx"><strong><code>pgnodemx</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.10-compat</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>PostgreSQL extension to access the OS process table</td>
</tr>
<tr>
<td><a href="https://github.com/kouber/pg_sqlog"><strong>pg_sqlog</strong></a></td>
<td><a href="/docs/pgext/stat/pg_sqlog"><strong><code>pg_sqlog</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.6</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Provide SQL interface to logs</td>
</tr>
<tr>
<td><a href="https://github.com/mhagander/bgw_replstatus"><strong>bgw_replstatus</strong></a></td>
<td><a href="/docs/pgext/stat/bgw_replstatus"><strong><code>bgw_replstatus</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0.6</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Small PostgreSQL background worker to report whether a node is a replication master or standby</td>
</tr>
<tr>
<td><a href="https://github.com/okbob/pgmeminfo"><strong>pgmeminfo</strong></a></td>
<td><a href="/docs/pgext/stat/pgmeminfo"><strong><code>pgmeminfo</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>show memory usage</td>
</tr>
<tr>
<td><a href="https://github.com/credativ/toastinfo"><strong>toastinfo</strong></a></td>
<td><a href="/docs/pgext/stat/toastinfo"><strong><code>toastinfo</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>show details on toasted datums</td>
</tr>
<tr>
<td><a href="https://github.com/RafiaSabih/pg_mon"><strong>pg_mon</strong></a></td>
<td><a href="/docs/pgext/stat/pg_mon"><strong><code>pg_mon</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>PostgreSQL extension to enhance query monitoring</td>
</tr>
<tr>
<td><a href="https://github.com/vyruss/pg_statviz"><strong>pg_statviz</strong></a></td>
<td><a href="/docs/pgext/stat/pg_statviz"><strong><code>pg_statviz</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.6</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>stats visualization and time series analysis</td>
</tr>
<tr>
<td><a href="https://github.com/pgexporter/pgexporter_ext"><strong>pgexporter_ext</strong></a></td>
<td><a href="/docs/pgext/stat/pgexporter_ext"><strong><code>pgexporter_ext</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.2.3</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>pgexporter extension for extra metrics</td>
</tr>
<tr>
<td><a href="https://gitlab.com/pg_top/pg_top"><strong>pg_top</strong></a></td>
<td><a href="/docs/pgext/stat/pg_top"><strong><code>pg_top</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.7.0</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Monitor PostgreSQL processes similar to unix top</td>
</tr>
<tr>
<td><a href="https://github.com/hollobon/pagevis"><strong>pagevis</strong></a></td>
<td><a href="/docs/pgext/stat/pagevis"><strong><code>pagevis</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.1</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Visualise database pages in ascii code</td>
</tr>
<tr>
<td><a href="https://github.com/powa-team/powa"><strong>powa</strong></a></td>
<td><a href="/docs/pgext/stat/powa"><strong><code>powa</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.2.2</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostgreSQL Workload Analyser-core</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pageinspect.html"><strong>pageinspect</strong></a></td>
<td><a href="/docs/pgext/stat/pageinspect"><strong><code>pageinspect</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.12</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>inspect the contents of database pages at a low level</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgrowlocks.html"><strong>pgrowlocks</strong></a></td>
<td><a href="/docs/pgext/stat/pgrowlocks"><strong><code>pgrowlocks</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>show row-level locking information</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/sslinfo.html"><strong>sslinfo</strong></a></td>
<td><a href="/docs/pgext/stat/sslinfo"><strong><code>sslinfo</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>information about SSL certificates</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgbuffercache.html"><strong>pg_buffercache</strong></a></td>
<td><a href="/docs/pgext/stat/pg_buffercache"><strong><code>pg_buffercache</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.4</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>examine the shared buffer cache</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgwalinspect.html"><strong>pg_walinspect</strong></a></td>
<td><a href="/docs/pgext/stat/pg_walinspect"><strong><code>pg_walinspect</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>functions to inspect contents of PostgreSQL Write-Ahead Log</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgfreespacemap.html"><strong>pg_freespacemap</strong></a></td>
<td><a href="/docs/pgext/stat/pg_freespacemap"><strong><code>pg_freespacemap</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>examine the free space map (FSM)</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgvisibility.html"><strong>pg_visibility</strong></a></td>
<td><a href="/docs/pgext/stat/pg_visibility"><strong><code>pg_visibility</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>examine the visibility map (VM) and page-level visibility info</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgstattuple.html"><strong>pgstattuple</strong></a></td>
<td><a href="/docs/pgext/stat/pgstattuple"><strong><code>pgstattuple</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.5</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>show tuple-level statistics</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/auto-explain.html"><strong>auto_explain</strong></a></td>
<td><a href="/docs/pgext/stat/auto_explain"><strong><code>auto_explain</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Provides a means for logging execution plans of slow statements automatically</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgstatstatements.html"><strong>pg_stat_statements</strong></a></td>
<td><a href="/docs/pgext/stat/pg_stat_statements"><strong><code>pg_stat_statements</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.10</td>
<td style="text-align:center"><a href="/docs/pgext/stat"><strong><code>STAT</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>track planning and execution statistics of all SQL statements executed</td>
</tr>
<tr>
<td><a href="https://github.com/devrimgunduz/passwordcheck_cracklib"><strong>passwordcheck_cracklib</strong></a></td>
<td><a href="/docs/pgext/sec/passwordcheck"><strong><code>passwordcheck</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">LGPLv2</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Strengthen PostgreSQL user password checks with cracklib</td>
</tr>
<tr>
<td><a href="https://github.com/supabase/supautils"><strong>supautils</strong></a></td>
<td><a href="/docs/pgext/sec/supautils"><strong><code>supautils</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">3.1.9</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Extension that secures a cluster on a cloud environment</td>
</tr>
<tr>
<td><a href="https://github.com/michelp/pgsodium"><strong>pgsodium</strong></a></td>
<td><a href="/docs/pgext/sec/pgsodium"><strong><code>pgsodium</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.1.9</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Postgres extension for libsodium functions</td>
</tr>
<tr>
<td><a href="https://github.com/supabase/vault"><strong>supabase_vault</strong></a></td>
<td><a href="/docs/pgext/sec/pg_vault"><strong><code>pg_vault</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.2.8</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Supabase Vault Extension</td>
</tr>
<tr>
<td><a href="https://postgresql-anonymizer.readthedocs.io/en/stable/"><strong>anon</strong></a></td>
<td><a href="/docs/pgext/sec/anonymizer"><strong><code>anonymizer</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.3.2</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Data anonymization tools</td>
</tr>
<tr>
<td><a href="https://github.com/Percona-Lab/pg_tde"><strong>pg_tde</strong></a></td>
<td><a href="/docs/pgext/sec/pg_tde"><strong><code>pg_tde</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>pg_tde access method</td>
</tr>
<tr>
<td><a href="https://github.com/zhuobie/pgsmcrypto"><strong>pgsmcrypto</strong></a></td>
<td><a href="/docs/pgext/sec/pgsmcrypto"><strong><code>pgsmcrypto</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.1.0</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostgreSQL SM Algorithm Extension</td>
</tr>
<tr>
<td><a href="https://github.com/pgaudit/pgaudit"><strong>pgaudit</strong></a></td>
<td><a href="/docs/pgext/sec/pgaudit"><strong><code>pgaudit</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">16.0</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>provides auditing functionality</td>
</tr>
<tr>
<td><a href="https://github.com/fmbiete/pgauditlogtofile"><strong>pgauditlogtofile</strong></a></td>
<td><a href="/docs/pgext/sec/pgauditlogtofile"><strong><code>pgauditlogtofile</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.6</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>pgAudit addon to redirect audit log to an independent file</td>
</tr>
<tr>
<td><a href="https://github.com/RafiaSabih/pg_auth_mon"><strong>pg_auth_mon</strong></a></td>
<td><a href="/docs/pgext/sec/pg_auth_mon"><strong><code>pg_auth_mon</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>monitor connection attempts per user</td>
</tr>
<tr>
<td><a href="https://github.com/MigOpsRepos/credcheck"><strong>credcheck</strong></a></td>
<td><a href="/docs/pgext/sec/credcheck"><strong><code>credcheck</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.7.0</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>credcheck - postgresql plain text credential checker</td>
</tr>
<tr>
<td><a href="https://momjian.us/download/pgcryptokey/"><strong>pgcryptokey</strong></a></td>
<td><a href="/docs/pgext/sec/pgcryptokey"><strong><code>pgcryptokey</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>cryptographic key management</td>
</tr>
<tr>
<td><a href="https://github.com/omniti-labs/pg_jobmon"><strong>pg_jobmon</strong></a></td>
<td><a href="/docs/pgext/sec/pg_jobmon"><strong><code>pg_jobmon</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4.1</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Extension for logging and monitoring functions in PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/munakoiso/logerrors"><strong>logerrors</strong></a></td>
<td><a href="/docs/pgext/sec/logerrors"><strong><code>logerrors</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.1</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Function for collecting statistics about messages in logfile</td>
</tr>
<tr>
<td><a href="https://github.com/splendiddata/login_hook"><strong>login_hook</strong></a></td>
<td><a href="/docs/pgext/sec/login_hook"><strong><code>login_hook</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.5</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>login_hook - hook to execute login_hook.login() at login time</td>
</tr>
<tr>
<td><a href="https://github.com/pgaudit/set_user"><strong>set_user</strong></a></td>
<td><a href="/docs/pgext/sec/set_user"><strong><code>set_user</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>similar to SET ROLE but with added logging</td>
</tr>
<tr>
<td><a href="https://github.com/credativ/pg_snakeoil"><strong>pg_snakeoil</strong></a></td>
<td><a href="/docs/pgext/sec/pg_snakeoil"><strong><code>pg_snakeoil</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>The PostgreSQL Antivirus</td>
</tr>
<tr>
<td><a href="https://github.com/dimitri/pgextwlist"><strong>pgextwlist</strong></a></td>
<td><a href="/docs/pgext/sec/pgextwlist"><strong><code>pgextwlist</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.17</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>PostgreSQL Extension Whitelisting</td>
</tr>
<tr>
<td><a href="https://github.com/kouber/pg_auditor"><strong>pg_auditor</strong></a></td>
<td><a href="/docs/pgext/sec/pg_auditor"><strong><code>pg_auditor</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.2</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong>BSD-3</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Audit data changes and provide flashback ability</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/sslutils"><strong>sslutils</strong></a></td>
<td><a href="/docs/pgext/sec/sslutils"><strong><code>sslutils</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.3</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>A Postgres extension for managing SSL certificates through SQL</td>
</tr>
<tr>
<td><a href="https://gitlab.com/ongresinc/extensions/noset"><strong>noset</strong></a></td>
<td><a href="/docs/pgext/sec/noset"><strong><code>noset</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.3.0</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong>AGPLv3</strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Module for blocking SET variables for non-super users.</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/sepgsql.html"><strong>sepgsql</strong></a></td>
<td><a href="/docs/pgext/sec/sepgsql"><strong><code>sepgsql</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>label-based mandatory access control (MAC) based on SELinux security policy.</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/auth-delay.html"><strong>auth_delay</strong></a></td>
<td><a href="/docs/pgext/sec/auth_delay"><strong><code>auth_delay</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>pause briefly before reporting authentication failure</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/pgcrypto.html"><strong>pgcrypto</strong></a></td>
<td><a href="/docs/pgext/sec/pgcrypto"><strong><code>pgcrypto</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.3</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"></td>
<td>cryptographic functions</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/passwordcheck.html"><strong>passwordcheck</strong></a></td>
<td><a href="/docs/pgext/sec/passwordcheck"><strong><code>passwordcheck</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/sec"><strong><code>SEC</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>checks user passwords and reject weak password</td>
</tr>
<tr>
<td><a href="https://github.com/supabase/wrappers"><strong>wrappers</strong></a></td>
<td><a href="/docs/pgext/fdw/wrappers"><strong><code>wrappers</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.4.1</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Foreign data wrappers developed by Supabase</td>
</tr>
<tr>
<td><a href="https://github.com/pgsql-io/multicorn2"><strong>multicorn</strong></a></td>
<td><a href="/docs/pgext/fdw/multicorn"><strong><code>multicorn</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.0</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Fetch foreign data in Python in your PostgreSQL server.</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/mysql_fdw"><strong>mysql_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/mysql_fdw"><strong><code>mysql_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Foreign data wrapper for querying a MySQL server</td>
</tr>
<tr>
<td><a href="https://github.com/laurenz/oracle_fdw"><strong>oracle_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/oracle_fdw"><strong><code>oracle_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>foreign data wrapper for Oracle access</td>
</tr>
<tr>
<td><a href="https://github.com/tds-fdw/tds_fdw"><strong>tds_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/tds_fdw"><strong><code>tds_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.0.3</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Foreign data wrapper for querying a TDS database (Sybase or Microsoft SQL Server)</td>
</tr>
<tr>
<td><a href="https://github.com/wolfgangbrandl/db2_fdw"><strong>db2_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/db2_fdw"><strong><code>db2_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">6.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>foreign data wrapper for DB2 access</td>
</tr>
<tr>
<td><a href="https://github.com/pgspider/sqlite_fdw"><strong>sqlite_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/sqlite_fdw"><strong><code>sqlite_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>SQLite Foreign Data Wrapper</td>
</tr>
<tr>
<td><a href="https://github.com/CrunchyData/pgbouncer_fdw"><strong>pgbouncer_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/pgbouncer_fdw"><strong><code>pgbouncer_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Extension for querying PgBouncer stats from normal SQL views &amp; running pgbouncer commands from normal SQL functions</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/mongo_fdw"><strong>mongo_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/mongo_fdw"><strong><code>mongo_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">LGPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>foreign data wrapper for MongoDB access</td>
</tr>
<tr>
<td><a href="https://github.com/pg-redis-fdw/redis_fdw"><strong>redis_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/redis_fdw"><strong><code>redis_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>Foreign data wrapper for querying a Redis server</td>
</tr>
<tr>
<td><a href="https://github.com/brettlaforge/pg_redis_pubsub"><strong>redis</strong></a></td>
<td><a href="/docs/pgext/fdw/pg_redis_pubsub"><strong><code>pg_redis_pubsub</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Send redis pub/sub messages to Redis from PostgreSQL Directly</td>
</tr>
<tr>
<td><a href="https://github.com/adjust/kafka_fdw"><strong>kafka_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/kafka_fdw"><strong><code>kafka_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.3</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>kafka Foreign Data Wrapper for CSV formated messages</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/hdfs_fdw"><strong>hdfs_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/hdfs_fdw"><strong><code>hdfs_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.0.5</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>foreign-data wrapper for remote hdfs servers</td>
</tr>
<tr>
<td><a href="https://github.com/ibarwick/firebird_fdw"><strong>firebird_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/firebird_fdw"><strong><code>firebird_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.4.0</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Foreign data wrapper for Firebird</td>
</tr>
<tr>
<td><a href="https://github.com/chimpler/postgres-aws-s3"><strong>aws_s3</strong></a></td>
<td><a href="/docs/pgext/fdw/aws_s3"><strong><code>aws_s3</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">0.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>aws_s3 postgres extension to import/export data from/to s3</td>
</tr>
<tr>
<td><a href="https://github.com/aws/postgresql-logfdw"><strong>log_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/log_fdw"><strong><code>log_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.4</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td>foreign-data wrapper for Postgres log file access</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/dblink.html"><strong>dblink</strong></a></td>
<td><a href="/docs/pgext/fdw/dblink"><strong><code>dblink</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.2</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>connect to other PostgreSQL databases from within a database</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/file-fdw.html"><strong>file_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/file_fdw"><strong><code>file_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>foreign-data wrapper for flat file access</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/postgres-fdw.html"><strong>postgres_fdw</strong></a></td>
<td><a href="/docs/pgext/fdw/postgres_fdw"><strong><code>postgres_fdw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">1.1</td>
<td style="text-align:center"><a href="/docs/pgext/fdw"><strong><code>FDW</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>foreign-data wrapper for remote PostgreSQL servers</td>
</tr>
<tr>
<td><a href="https://github.com/orafce/orafce"><strong>orafce</strong></a></td>
<td><a href="/docs/pgext/sim/orafce"><strong><code>orafce</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.10</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Functions and operators that emulate a subset of functions and packages from the Oracle RDBMS</td>
</tr>
<tr>
<td><a href="https://github.com/darold/pgtt"><strong>pgtt</strong></a></td>
<td><a href="/docs/pgext/sim/pgtt"><strong><code>pgtt</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">4.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">ISC</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Extension to add Global Temporary Tables feature to PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/splendiddata/session_variable"><strong>session_variable</strong></a></td>
<td><a href="/docs/pgext/sim/session_variable"><strong><code>session_variable</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">3.3</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>Registration and manipulation of session variables and constants</td>
</tr>
<tr>
<td><a href="https://github.com/lzlabs/pg_statement_rollback"><strong>pg_statement_rollback</strong></a></td>
<td><a href="/docs/pgext/sim/pg_statement_rollback"><strong><code>pg_statement_rollback</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">ISC</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Server side rollback at statement level for PostgreSQL like Oracle or DB2</td>
</tr>
<tr>
<td><a href="https://github.com/HexaCluster/pg_dbms_metadata"><strong>pg_dbms_metadata</strong></a></td>
<td><a href="/docs/pgext/sim/pg_dbms_metadata"><strong><code>pg_dbms_metadata</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Extension to add Oracle DBMS_METADATA compatibility to PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/HexaCluster/pg_dbms_lock"><strong>pg_dbms_lock</strong></a></td>
<td><a href="/docs/pgext/sim/pg_dbms_lock"><strong><code>pg_dbms_lock</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Extension to add Oracle DBMS_LOCK full compatibility to PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/MigOpsRepos/pg_dbms_job"><strong>pg_dbms_job</strong></a></td>
<td><a href="/docs/pgext/sim/pg_dbms_job"><strong><code>pg_dbms_job</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.5.0</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Extension to add Oracle DBMS_JOB full compatibility to PostgreSQL</td>
</tr>
<tr>
<td><a href="https://babelfishpg.org/"><strong>babelfishpg_common</strong></a></td>
<td><a href="/docs/pgext/sim/babelfishpg_common"><strong><code>babelfishpg_common</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">WILTON</span></strong></td>
<td style="text-align:center">3.3.3</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>SQL Server Transact SQL Datatype Support</td>
</tr>
<tr>
<td><a href="https://babelfishpg.org/"><strong>babelfishpg_tsql</strong></a></td>
<td><a href="/docs/pgext/sim/babelfishpg_tsql"><strong><code>babelfishpg_tsql</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">WILTON</span></strong></td>
<td style="text-align:center">3.3.1</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>SQL Server Transact SQL compatibility</td>
</tr>
<tr>
<td><a href="https://babelfishpg.org/"><strong>babelfishpg_tds</strong></a></td>
<td><a href="/docs/pgext/sim/babelfishpg_tds"><strong><code>babelfishpg_tds</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">WILTON</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>SQL Server TDS protocol extension</td>
</tr>
<tr>
<td><a href="https://babelfishpg.org/"><strong>babelfishpg_money</strong></a></td>
<td><a href="/docs/pgext/sim/babelfishpg_money"><strong><code>babelfishpg_money</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">WILTON</span></strong></td>
<td style="text-align:center">1.1.0</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>SQL Server Money Data Type</td>
</tr>
<tr>
<td><a href="https://github.com/ohmu/pgmemcache"><strong>pgmemcache</strong></a></td>
<td><a href="/docs/pgext/sim/pgmemcache"><strong><code>pgmemcache</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.3.0</td>
<td style="text-align:center"><a href="/docs/pgext/sim"><strong><code>SIM</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>memcached interface</td>
</tr>
<tr>
<td><a href="https://github.com/2ndQuadrant/pglogical"><strong>pglogical</strong></a></td>
<td><a href="/docs/pgext/etl/pglogical"><strong><code>pglogical</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.4.4</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>PostgreSQL Logical Replication</td>
</tr>
<tr>
<td><a href="https://github.com/2ndQuadrant/pglogical"><strong>pglogical_origin</strong></a></td>
<td><a href="/docs/pgext/etl/pglogical"><strong><code>pglogical</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.0.0</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Dummy extension for compatibility when upgrading from Postgres 9.4</td>
</tr>
<tr>
<td><a href="https://github.com/2ndQuadrant/pglogical"><strong>pglogical_ticker</strong></a></td>
<td><a href="/docs/pgext/etl/pglogical"><strong><code>pglogical</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">1.4</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Have an accurate view on pglogical replication delay</td>
</tr>
<tr>
<td><a href="https://github.com/enova/pgl_ddl_deploy"><strong>pgl_ddl_deploy</strong></a></td>
<td><a href="/docs/pgext/etl/pgl_ddl_deploy"><strong><code>pgl_ddl_deploy</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.2</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>automated ddl deployment using pglogical</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/pg_failover_slots"><strong>pg_failover_slots</strong></a></td>
<td><a href="/docs/pgext/etl/pg_failover_slots"><strong><code>pg_failover_slots</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.1</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"><i class="fa-solid fa-circle-exclamation text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-check text-primary"></i></td>
<td>PG Failover Slots extension</td>
</tr>
<tr>
<td><a href="https://github.com/eulerto/wal2json"><strong>wal2json</strong></a></td>
<td><a href="/docs/pgext/etl/wal2json"><strong><code>wal2json</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.5.3</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Changing data capture in JSON format</td>
</tr>
<tr>
<td><a href="https://github.com/HighgoSoftware/wal2mongo"><strong>wal2mongo</strong></a></td>
<td><a href="/docs/pgext/etl/wal2mongo"><strong><code>wal2mongo</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0.7</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">Apache-2.0</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>PostgreSQL logical decoding output plugin for MongoDB</td>
</tr>
<tr>
<td><a href="https://github.com/debezium/postgres-decoderbufs"><strong>decoderbufs</strong></a></td>
<td><a href="/docs/pgext/etl/decoderbufs"><strong><code>decoderbufs</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.1.0</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Logical decoding plugin that delivers WAL stream changes using a Protocol Buffer format</td>
</tr>
<tr>
<td><a href="https://github.com/michaelpq/pg_plugins/blob/main/decoder_raw/"><strong>decoder_raw</strong></a></td>
<td><a href="/docs/pgext/etl/decoder_raw"><strong><code>decoder_raw</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.0</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Output plugin for logical replication in Raw SQL format</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/docs/current/test-decoding.html"><strong>test_decoding</strong></a></td>
<td><a href="/docs/pgext/etl/test_decoding"><strong><code>test_decoding</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">CONTRIB</span></strong></td>
<td style="text-align:center">16.3</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>SQL-based test/example module for WAL logical decoding</td>
</tr>
<tr>
<td><a href="https://github.com/omniti-labs/mimeo"><strong>mimeo</strong></a></td>
<td><a href="/docs/pgext/etl/mimeo"><strong><code>mimeo</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">PIGSTY</span></strong></td>
<td style="text-align:center">1.5.1</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>Extension for specialized, per-table replication between PostgreSQL instances</td>
</tr>
<tr>
<td><a href="https://github.com/EnterpriseDB/repmgr"><strong>repmgr</strong></a></td>
<td><a href="/docs/pgext/etl/repmgr"><strong><code>repmgr</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">5.4</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-secondary">GPLv3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Replication manager for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/dimitri/pgcopydb"><strong>pgcopydb</strong></a></td>
<td><a href="/docs/pgext/etl/pgcopydb"><strong><code>pgcopydb</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.15</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Copy a Postgres database to a target Postgres server</td>
</tr>
<tr>
<td><a href="https://github.com/dimitri/pgloader"><strong>pgloader</strong></a></td>
<td><a href="/docs/pgext/etl/pgloader"><strong><code>pgloader</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.6.10</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">PostgreSQL</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Migrate to PostgreSQL in a single command!</td>
</tr>
<tr>
<td><a href="https://github.com/enova/pg_fact_loader"><strong>pg_fact_loader</strong></a></td>
<td><a href="/docs/pgext/etl/pg_fact_loader"><strong><code>pg_fact_loader</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.0</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">MIT</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>build fact tables with Postgres</td>
</tr>
<tr>
<td><a href="https://github.com/ossc-db/pg_bulkload"><strong>pg_bulkload</strong></a></td>
<td><a href="/docs/pgext/etl/pg_bulkload"><strong><code>pg_bulkload</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">3.1.21</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-plus text-primary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td>pg_bulkload is a high speed data loading utility for PostgreSQL</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/ftp/projects/pgFoundry/pg-comparator/pg_comparator/2.2.1/"><strong>pg_comparator</strong></a></td>
<td><a href="/docs/pgext/etl/pg_comparator"><strong><code>pg_comparator</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">2.2.5</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 3</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>Comparation of testing and production services PostgreSQL databases.</td>
</tr>
<tr>
<td><a href="https://github.com/okbob/pgimportdoc"><strong>pgimportdoc</strong></a></td>
<td><a href="/docs/pgext/etl/pgimportdoc"><strong><code>pgimportdoc</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.1.4</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>command line utility for importing XML, JSON, BYTEA document to PostgreSQL</td>
</tr>
<tr>
<td><a href="https://github.com/okbob/pgexportdoc"><strong>pgexportdoc</strong></a></td>
<td><a href="/docs/pgext/etl/pgexportdoc"><strong><code>pgexportdoc</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-success">PGDG</span></strong></td>
<td style="text-align:center">0.1.4</td>
<td style="text-align:center"><a href="/docs/pgext/etl"><strong><code>ETL</code></strong></a></td>
<td style="text-align:center"><strong><span class="text-primary">BSD 2</span></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><i class="fa-solid fa-square-minus text-secondary"></i></td>
<td style="text-align:center"><i class="fa-solid fa-circle-xmark text-secondary"></i></td>
<td style="text-align:center"></td>
<td>export XML, JSON and BYTEA documents from PostgreSQL</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="docker-application"><strong>Docker Application</strong></h3>
<p>Pigsty now offers out-of-the-box Dify and Odoo Docker Compose templates:</p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/dify">Dify</a>: Open Source AI Agent Workflow &amp; LLMOps</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/Odoo">Odoo</a>: Open Source ERP System</li>
</ul>
<p>There two new beta modules available in Pigsty Pro version:</p>
<ul>
<li><strong><code>KAFKA</code></strong>: Deploy a high-availability Kafka cluster supported by the Kraft protocol.</li>
<li><strong><code>KUBE</code></strong>: Deploy a Kubernetes cluster managed by Pigsty using cri-dockerd or containerd.</li>
</ul>
<hr>
<h3 id="bug-fix">Bug Fix</h3>
<ul>
<li>Fixed <a href="https://pigsty.io/blog/db/cve-2024-6387/">CVE-2024-6387</a> by automatically repairing during the Pigsty installation process using the default value <code>[openssh-server]</code> in <code>node_packages</code>.</li>
<li>Fixed memory consumption issues caused by Loki parsing Nginx log tag cardinality being too large.</li>
<li>Fixed bootstrap failure caused by upstream Ansible dependency changes in EL8 systems (python3.11-jmespath upgraded to python3.12-jmespath).</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-cce82b7ac2e11e5d6e05c73c4fc50cbe">v2.7: Extension Overwhelming</h1>
	<div class="lead">Extension Overwhelming &amp; Docker VM preparation</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2024-05-20" class="text-muted">2024-05-20</time>
        
	</div>
	<p>The <a href="https://pigsty.io/">Pigsty</a> community is thrilled to announce Pigsty <a href="https://github.com/Vonng/pigsty/releases/tag/v2.7.0">v2.7.0</a>, which has <a href="https://pigsty.io/docs/reference/extension/">255</a> unique extensions available, to the free PostgreSQL distribution and RDS alternative. We also have introduced some new docker-compose templates for <a href="https://github.com/Vonng/pigsty/tree/master/app/odoo">Odoo</a>, <a href="https://github.com/Vonng/pigsty/tree/master/app/jupyter">Jupyter</a>, <a href="https://github.com/Vonng/pigsty/tree/master/app/polardb">PolarDB</a>, and GA <a href="https://github.com/Vonng/pigsty/tree/master/app/supabase">Supabase</a>.</p>
<h2 id="about-pigsty">About Pigsty</h2>
<p>Pigsty is a Battery-included, local-first PostgreSQL Distribution as a Free RDS alternative.</p>
<p><strong>Links</strong>: <a href="https://pigsty.io/">Website</a> | <a href="https://github.com/Vonng/pigsty">GitHub</a> | <a href="https://demo.pigsty.cc/">Demo</a> | <a href="https://pigsty.io/blog">Blog</a> | <a href="https://pigsty.io/docs/setup/install/">Install</a> | <a href="https://pigsty.io/docs/about/feature/">Feature</a></p>
<p><strong>Images</strong>: <a href="https://pigsty.io/img/pigsty/banner.en.jpg">Introduction</a> | <a href="https://pigsty.io/img/pigsty/extension.png">Extensions</a> | <a href="https://pigsty.io/img/pigsty/ha.png">Architecture</a> | <a href="https://pigsty.io/img/pigsty/dashboard.jpg">Dashboards</a></p>
<p><a href="https://pigsty.io/docs/setup/install/">Getting Started</a> with the latest <a href="https://github.com/Vonng/pigsty/releases/tag/v2.7.0">v2.7.0</a> release with: <code>curl -L https://get.pigsty.cc/install | bash</code></p>
<h2 id="pigsty-v27-extension-overwhelming">Pigsty v2.7: Extension Overwhelming</h2>
<p>I wrote a popular article last month - <a href="https://pigsty.io/blog/pg/pg-eat-db-world/"><em>Postgres is eating the database world</em></a>, explaining why extensions matter to the PostgreSQL ecosystem.</p>
<p>Based on this idea, we&rsquo;ve packaged <strong>20</strong> brand-new extensions in v2.7. With these extensions added, Pigsty offers <strong>157</strong> non-contrib extensions for <a href="https://pigsty.io/docs/reference/extension/#rpm-extension">EL Distros</a> and <strong>116</strong> for <a href="https://pigsty.io/docs/reference/extension/#deb-extension">Debian/Ubuntu Distros</a>. Combined with <strong>73</strong> built-in <a href="https://pigsty.io/docs/reference/extension/#contrib-extension">Contrib extensions</a>, Pigsty now has a total of <strong>255</strong> unique extensions available, which takes PostgreSQL&rsquo;s versatility to a whole new level!</p>
<blockquote>
<p><a href="https://pigsty.io/docs/reference/extension/">Complete list of available extensions</a>: <a href="https://pigsty.io/docs/reference/extension/">https://pigsty.io/docs/reference/extension/</a></p>
</blockquote>
<p><img src="/img/pigsty/ecosystem.jpg"></p>
<h2 id="v270-release-note">v2.7.0 Release Note</h2>
<h3 id="highlight"><strong>Highlight</strong></h3>
<p>Adding numerous new extensions written in <code>rust</code> &amp; <code>pgrx</code>:</p>
<ul>
<li><a href="https://github.com/paradedb/paradedb/tree/dev/pg_search">pg_search</a> v0.7.0 : Full text search over SQL tables using the BM25 algorithm</li>
<li><a href="https://github.com/paradedb/paradedb/tree/dev/pg_lakehouse">pg_lakehouse</a> v0.7.0 : Query engine over object stores like S3 and table formats like Delta Lake</li>
<li><a href="https://github.com/paradedb/pg_analytics">pg_analytics</a> v0.6.1 : Accelerates analytical query processing inside Postgres</li>
<li><a href="https://github.com/supabase/pg_graphql">pg_graphql</a> v1.5.4 : GraphQL support to your PostgreSQL database.</li>
<li><a href="https://github.com/supabase/pg_jsonschema">pg_jsonschema</a> v0.3.1 : PostgreSQL extension providing JSON Schema validation</li>
<li><a href="https://github.com/supabase/wrappers">wrappers</a> v0.3.1 : Postgres Foreign Data Wrappers Collections by Supabase</li>
<li><a href="https://github.com/tembo-io/pgmq">pgmq</a> v1.5.2 : A lightweight message queue. Like AWS SQS and RSMQ but on Postgres.</li>
<li><a href="https://github.com/tembo-io/pg_tier">pg_tier</a> v0.0.3 : Postgres Extension written in Rust, to enable data tiering to AWS S3</li>
<li><a href="https://github.com/tembo-io/pg_vectorize">pg_vectorize</a> v0.15.0 : The simplest way to orchestrate vector search on Postgres</li>
<li><a href="https://github.com/tembo-io/pg_later">pg_later</a> v0.1.0 : Execute SQL now and get the results later.</li>
<li><a href="https://github.com/VADOSWARE/pg_idkit">pg_idkit</a> v0.2.3 : Generating many popular types of identifiers</li>
<li><a href="https://github.com/kaspermarstal/plprql">plprql</a> v0.1.0 : Use PRQL in PostgreSQL</li>
<li><a href="https://github.com/zhuobie/pgsmcrypto">pgsmcrypto</a> v0.1.0 : PostgreSQL SM Algorithm Extension</li>
<li><a href="https://github.com/kelvich/pg_tiktoken">pg_tiktoken</a> v0.0.1 : OpenAI tiktoken tokenizer for PostgreSQL</li>
<li><a href="https://github.com/rustprooflabs/pgdd">pgdd</a> v0.5.2 : Access Data Dictionary metadata with pure SQL</li>
</ul>
<p>And some new extensions in plain C &amp; C++:</p>
<ul>
<li><a href="https://github.com/pgspider/parquet_s3_fdw">parquet_s3_fdw</a> 1.1.0 : ParquetS3 Foreign Data Wrapper for PostgreSQL</li>
<li><a href="https://github.com/plv8/plv8">plv8</a> 3.2.2 : V8 Engine Javascript Procedural Language add-on for PostgreSQL</li>
<li><a href="https://github.com/tvondra/md5hash">md5hash</a> 1.0.1 : Custom data type for storing MD5 hashes rather than text</li>
<li><a href="https://github.com/Percona-Lab/pg_tde">pg_tde</a> 1.0 alpha: Experimental encrypted access method for PostgreSQL</li>
<li><a href="https://github.com/df7cb/pg_dirtyread">pg_dirtyread</a> 2.6 : Read dead but unvacuumed tuples from a PostgreSQL relation</li>
<li>New deb PGDG extensions: <code>pg_roaringbitmap</code>, <code>pgfaceting</code>, <code>mobilitydb</code>, <code>pgsql-http</code>, <code>pg_hint_plan</code>, <code>pg_statviz</code>, <code>pg_rrule</code></li>
<li>New rpm PGDG extensions: <code>pg_profile</code>, <code>pg_show_plans</code>, use PGDG&rsquo;s <code>pgsql_http</code>, <code>pgsql_gzip</code>, <code>pg_net</code>, <code>pg_bigm</code> instead of Pigsty RPM.</li>
</ul>
<h3 id="new-features"><strong>New Features</strong></h3>
<ul>
<li>Prepare arm64 packages for infra &amp; pgsql packages for el &amp; deb distros.</li>
<li>New installation script to download from Cloudflare, and more hints.</li>
<li>New monitoring dashboard PGSQL PITR to assist the PITR procedure.</li>
<li>Make preparations for running pigsty inside docker VM containers</li>
<li>Add a <a href="https://github.com/Vonng/pigsty/issues/402">fool-proof design</a> for running pgsql.yml on a node that is not managed by Pigsty</li>
<li>Add separated template for each OS distro: el7, el8, el9, debian11, debian12, ubuntu20, ubuntu22</li>
</ul>
<h3 id="new-docker-application"><strong>New Docker Application</strong></h3>
<ul>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/odoo">Odoo</a>: launch open-source ERP over PostgreSQL.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/jupyter">Jupyter</a>: Run Jupyter notebook containers and expose the HTTP service.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/polardb">PolarDB</a>: run the demo playground for the shared-storage version of OSS PG.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/supabase">supabase</a>: bump to the latest GA version.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/bytebase">bytebase</a>: use the <code>latest</code> tag instead of the ad hoc version.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/pg_exporter">pg_exporter</a>: update docker image example</li>
</ul>
<h3 id="software-upgrade"><strong>Software Upgrade</strong></h3>
<ul>
<li><strong>PostgreSQL 16.3, 15.7, 14.12, 13.15, 12.19</strong></li>
<li>Patroni 3.3.0</li>
<li>pgBackRest 2.51</li>
<li>vip-manager v2.5.0</li>
<li>Haproxy 2.9.7</li>
<li>Grafana 10.4.2</li>
<li>Prometheus 2.51</li>
<li>Loki &amp; Promtail: 3.0.0 (breaking changes!)</li>
<li>Alertmanager 0.27.0</li>
<li>BlackBox Exporter 0.25.0</li>
<li>Node Exporter 1.8.0</li>
<li>pgBackrest Exporter 0.17.0</li>
<li>duckdb 0.10.2</li>
<li>etcd 3.5.13</li>
<li>minio-20240510014138 / mcli-20240509170424</li>
<li>pev2 v1.8.0 → v1.11.0</li>
<li><strong>pgvector</strong> 0.6.1 → 0.7.0</li>
<li>pg_tle: v1.3.4 → v1.4.0</li>
<li>hydra: v1.1.1 → v1.1.2</li>
<li>duckdb_fdw: v1.1.0 recompile with libduckdb 0.10.2</li>
<li>pg_bm25 0.5.6 → pg_search 0.7.0</li>
<li>pg_analytics: 0.5.6 → 0.6.1</li>
<li>pg_graphql: 1.5.0 → 1.5.4</li>
<li>pg_net 0.8.0 → 0.9.1</li>
<li>pg_sparse (deprecated due to pgvector 0.7)</li>
</ul>
<h3 id="fixed-issues"><strong>Fixed Issues</strong></h3>
<ul>
<li>Fix role pg_exporters white space in variable templates</li>
<li>Fix <code>minio_cluster</code> not commented in global variables</li>
<li>Fix the non-existent <code>postgis34</code> package name in the <code>el7</code> config template</li>
<li>Fix EL8 <code>python3.11-cryptography</code> deps to <code>python3-cryptography</code> according to upstream</li>
<li>Fix <code>/pg/bin/pg-role</code> can not get OS user name from environ in non-interact mode</li>
<li>Fix <code>/pg/bin/pg-pitr</code> can not hint <code>-X</code> <code>-P</code> flag properly</li>
</ul>
<h3 id="api-change"><strong>API Change</strong></h3>
<ul>
<li>New parameter <code>node_write_etc_hosts</code> to control whether to write <code>/etc/hosts</code> file on target nodes.</li>
<li>Relocatable prometheus target directory with new parameter <code>prometheus_sd_dir</code>.</li>
<li>Add <code>-x|--proxy</code> flag to enable and use the value of global proxy env by @waitingsong in <a href="https://github.com/Vonng/pigsty/pull/405">https://github.com/Vonng/pigsty/pull/405</a></li>
<li>No longer parse infra nginx log details since it brings too many labels to the log.</li>
<li>Use alertmanager API Version <code>v2</code> instead of <code>v1</code> in prometheus config.</li>
<li>Use <code>/pg/cert/ca.crt</code> instead of <code>/etc/pki/ca.crt</code> in role <code>pgsql</code>.</li>
</ul>
<h2 id="acknowledgment">Acknowledgment</h2>
<p>A huge thank you to all our users who contributed patches reported bugs and proposed new features.</p>
<p>Pigsty thrives on community contributions. We warmly welcome your ideas, feature requests, or patches. Please share your contributions on our <a href="https://github.com/Vonng/pigsty/">GitHub page</a>. We look forward to your feedback on Pigsty 2.7 and your continued support in making Pigsty even better.</p>
<p>Best regards,</p>
<p>Ruohang Feng (@vonng), <a href="mailto:rh@vonng.com">rh@vonng.com</a> , The Pigsty Community</p>
<p>Battery-Included PostgreSQL Distro as a Free RDS Alternative, with:</p>
<ul>
<li><a href="https://pigsty.io/docs/reference/extension/">Extensible Postgres</a> with <a href="https://pigsty.io/docs/reference/extension">255</a> <a href="https://pigsty.io/docs/reference/extension/">extensions</a> available: PostGIS, Timescale, Citus, PGVector, AGE, PGML, ParadeDB, Hydra, DuckFDW, GraphQL, ……</li>
<li><a href="https://pigsty.io/docs/concept/arch">Reliable Infras</a>: Create self-healing <a href="https://pigsty.io/docs/concept/ha/">HA</a> <a href="https://pigsty.io/docs/pgsql/">PostgreSQL</a> clusters with pre-configured <a href="https://pigsty.io/docs/concept/pitr/">PITR</a>, built-in <a href="https://pigsty.io/docs/concept/ac/">ACL</a>, &amp; SSL, and secure your infra with local <a href="https://pigsty.io/docs/concept/ca/">CA</a> &amp; best practices.</li>
<li><a href="https://demo.pigsty.cc/">Observable Graphics</a>: Unparalleled monitoring best practices build upon the modern <a href="https://pigsty.io/docs/infra/#prometheus">Prometheus</a> &amp; <a href="https://pigsty.io/docs/infra/#grafana">Grafana</a> stack. Reuse them to monitor existing DBs &amp; cloud <a href="https://pigsty.io/docs/pgsql/monitor/#monitor-rds">RDS</a>. Check our <a href="https://github.com/Vonng/pigsty/wiki/Gallery">Gallery</a> &amp; <a href="https://demo.pigsty.cc/">Demo</a></li>
<li><a href="https://pigsty.io/docs/concept/svc">High-Available Service</a>: Deliver auto-routed, high-performance, pooled, reliable, flexible database <a href="https://pigsty.io/docs/pgsql/svc/#default-service">Services</a> <a href="https://pigsty.io/docs/concept/svc/#access-service">Access</a> via Pgbouncer DNSMasq, Keepalived, vip-manager, and HAProxy.</li>
<li><a href="https://pigsty.io/docs/setup/config/">Maintainable Toolbox</a>: <a href="https://pigsty.io/docs/pgsql/config/">Infra as Code</a>, Declarative <a href="https://pigsty.io/docs/setup/config/">API</a> &amp; Idempotent <a href="https://pigsty.io/docs/setup/playbook/">Playbooks</a>, <a href="https://pigsty.io/docs/setup/provision/#vagrant">Vagrant</a> sandbox &amp; <a href="https://pigsty.io/docs/setup/provision/#terraform">Terraform</a> IaaS provisioning specs. Local repo, offline package, delivered without Internet access.</li>
<li><a href="https://pigsty.io/docs/about/module/">Composable Modules</a>: <a href="https://pigsty.io/docs/concept/arch/#module">Modular</a> design, flexible arch with many bonus features. <a href="https://pigsty.io/docs/redis/">Redis</a>, <a href="https://pigsty.io/docs/minio/">MinIO</a>, <a href="https://pigsty.io/docs/etcd/">ETCD</a>, <a href="https://pigsty.io/docs/ferret/">FerretDB</a>, <a href="https://github.com/Vonng/pigsty/tree/master/app/duckdb">DuckDB</a>, <a href="https://github.com/Vonng/pigsty/tree/master/app/supabase">Supabase</a>, and <a href="https://pigsty.io/docs/app/docker/">Docker</a> compose templates for software that uses Postgres.</li>
<li><a href="https://pigsty.io/docs/setup/install/">Painless Experience</a>: Easy to use: Download, <a href="https://pigsty.io/docs/setup/install/">Install</a>, and Configure in one command. Built-in configuration templates for different scenarios, auto-tuned params, admin <a href="https://pigsty.io/docs/pgsql/admin/">SOP</a>, and zero-downtime blue-green <a href="https://pigsty.io/docs/pgsql/migration/">migration</a> plans.</li>
<li><a href="https://pigsty.io/docs/reference/compatibility/">Compatible Distros</a>: Run on base OS without containerization support: EL 7, 8, 9 and Rocky, Alma, CentOS, OracleLinux,… and Ubuntu 20.04 / 22.04 and Debian 11 / 12 Support.</li>
<li><a href="https://pigsty.io/docs/reference/compare/">Open-Source RDS</a>: Free software open-sourced under the <a href="https://pigsty.io/docs/about/license/">AGPLv3</a> license, a <a href="https://pigsty.io/docs/reference/compare/">free</a> RDS for PostgreSQL alternative.</li>
</ul>
<hr>
<h2 id="v270">v2.7.0</h2>
<p><strong>Highlight</strong></p>
<p>Extension Overwhelming, adding numerous new extensions written in <code>rust</code> &amp; <code>pgrx</code>:</p>
<ul>
<li><a href="https://github.com/paradedb/paradedb/tree/dev/pg_search">pg_search</a> v0.7.0 : Full text search over SQL tables using the BM25 algorithm</li>
<li><a href="https://github.com/paradedb/paradedb/tree/dev/pg_lakehouse">pg_lakehouse</a> v0.7.0 : Query engine over object stores like S3 and table formats like Delta Lake</li>
<li><a href="https://github.com/paradedb/pg_analytics">pg_analytics</a> v0.6.1 : Accelerates analytical query processing inside Postgres</li>
<li><a href="https://github.com/supabase/pg_graphql">pg_graphql</a> v1.5.4 : GraphQL support to your PostgreSQL database.</li>
<li><a href="https://github.com/supabase/pg_jsonschema">pg_jsonschema</a> v0.3.1 : PostgreSQL extension providing JSON Schema validation</li>
<li><a href="https://github.com/supabase/wrappers">wrappers</a> v0.3.1 : Postgres Foreign Data Wrappers Collections by Supabase</li>
<li><a href="https://github.com/tembo-io/pgmq">pgmq</a> v1.5.2 : A lightweight message queue. Like AWS SQS and RSMQ but on Postgres.</li>
<li><a href="https://github.com/tembo-io/pg_tier">pg_tier</a> v0.0.3 : Postgres Extension written in Rust, to enable data tiering to AWS S3</li>
<li><a href="https://github.com/tembo-io/pg_vectorize">pg_vectorize</a> v0.15.0 : The simplest way to orchestrate vector search on Postgres</li>
<li><a href="https://github.com/tembo-io/pg_later">pg_later</a> v0.1.0 : Execute SQL now and get the results later.</li>
<li><a href="https://github.com/VADOSWARE/pg_idkit">pg_idkit</a> v0.2.3 : Generating many popular types of identifiers</li>
<li><a href="https://github.com/kaspermarstal/plprql">plprql</a> v0.1.0 : Use PRQL in PostgreSQL</li>
<li><a href="https://github.com/zhuobie/pgsmcrypto">pgsmcrypto</a> v0.1.0 : PostgreSQL SM Algorithm Extension</li>
<li><a href="https://github.com/kelvich/pg_tiktoken">pg_tiktoken</a> v0.0.1 : OpenAI tiktoken tokenizer for postgres</li>
<li><a href="https://github.com/rustprooflabs/pgdd">pgdd</a> v0.5.2 : Access Data Dictionary metadata with pure SQL</li>
</ul>
<p>And some new extensions in plain C &amp; C++</p>
<ul>
<li><a href="https://github.com/pgspider/parquet_s3_fdw">parquet_s3_fdw</a> 1.1.0 : ParquetS3 Foreign Data Wrapper for PostgresSQL</li>
<li><a href="https://github.com/plv8/plv8">plv8</a> 3.2.2 : V8 Engine Javascript Procedural Language add-on for PostgreSQL</li>
<li><a href="https://github.com/tvondra/md5hash">md5hash</a> 1.0.1 : Custom data type for storing MD5 hashes rather than text</li>
<li><a href="https://github.com/Percona-Lab/pg_tde">pg_tde</a> 1.0 alpha: Experimental encrypted access method for PostgreSQL</li>
<li><a href="https://github.com/df7cb/pg_dirtyread">pg_dirtyread</a> 2.6 : Read dead but unvacuumed tuples from a PostgreSQL relation</li>
<li>New deb PGDG extensions: <code>pg_roaringbitmap</code>, <code>pgfaceting</code>, <code>mobilitydb</code>, <code>pgsql-http</code>, <code>pg_hint_plan</code>, <code>pg_statviz</code>, <code>pg_rrule</code></li>
<li>New rpm PGDG extensions: <code>pg_profile</code>, <code>pg_show_plans</code>, use PGDG&rsquo;s <code>pgsql_http</code>, <code>pgsql_gzip</code>, <code>pg_net</code>, <code>pg_bigm</code> instead of Pigsty RPM.</li>
</ul>
<p><strong>New Features</strong></p>
<ul>
<li>running on certain <code>docker</code> containers.</li>
<li>prepare arm64 packages for infra &amp; pgsql packages for el &amp; deb distros.</li>
<li>new installation script to download from cloudflare, and more hint.</li>
<li>new monitoring dashboard for PGSQL PITR to assist the PITR procedure.</li>
<li>make preparation for running pigsty inside docker VM containers</li>
<li>add a <a href="https://github.com/Vonng/pigsty/issues/402">fool-proof design</a> for running pgsql.yml on node that is not managed by pigsty</li>
<li>add config template for each major version: el7, el8, el9, debian11, debian12, ubuntu20, ubuntu22</li>
</ul>
<p><strong>Software Upgrade</strong></p>
<ul>
<li><strong>PostgreSQL 16.3</strong></li>
<li>Patroni 3.3.0</li>
<li>pgBackRest 2.51</li>
<li>vip-manager v2.5.0</li>
<li>Haproxy 2.9.7</li>
<li>Grafana 10.4.2</li>
<li>Prometheus 2.51</li>
<li>Loki &amp; Promtail: 3.0.0 (breaking changes!)</li>
<li>Alertmanager 0.27.0</li>
<li>BlackBox Exporter 0.25.0</li>
<li>Node Exporter 1.8.0</li>
<li>pgBackrest Exporter 0.17.0</li>
<li>duckdb 0.10.2</li>
<li>etcd 3.5.13</li>
<li>minio-20240510014138 / mcli-20240509170424</li>
<li>pev2 v1.8.0 -&gt; v1.11.0</li>
<li><strong>pgvector</strong> 0.6.1 -&gt; 0.7.0</li>
<li>pg_tle: v1.3.4 -&gt; v1.4.0</li>
<li>hydra: v1.1.1 -&gt; v1.1.2</li>
<li>duckdb_fdw: v1.1.0 recompile with libduckdb 0.10.2</li>
<li>pg_bm25 0.5.6 -&gt; pg_search 0.7.0</li>
<li>pg_analytics: 0.5.6 -&gt; 0.6.1</li>
<li>pg_graphql: 1.5.0 -&gt; 1.5.4</li>
<li>pg_net 0.8.0 -&gt; 0.9.1</li>
<li>pg_sparse (deprecated)</li>
</ul>
<p><strong>Docker Application</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/odoo">Odoo</a>: launch open source ERP and plugins</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/jupyter">Jupyter</a>: run jupyter notebook container</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/polardb">PolarDB</a>: run the demo PG RAC playground.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/supabase">supabase</a>: bump to the latest GA version.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/bytebase">bytebase</a>: use the <code>latest</code> tag instead of ad hoc version.</li>
<li><a href="https://github.com/Vonng/pigsty/tree/master/app/pg_exporter">pg_exporter</a>: update docker image example</li>
</ul>
<p><strong>Bug Fix</strong></p>
<ul>
<li>Fix role pg_exporters white space in variable templates</li>
<li>Fix <code>minio_cluster</code> not commented in global variables</li>
<li>Fix the non-exist <code>postgis34</code> in el7 config template</li>
<li>Fix EL8 <code>python3.11-cryptography</code> deps to <code>python3-cryptography</code> according to upstream</li>
<li>Fix <code>/pg/bin/pg-role</code> can not get OS user name from environ in non-interact mode</li>
<li>Fix <code>/pg/bin/pg-pitr</code> can not hint -X -P flag properly</li>
</ul>
<p><strong>API Change</strong></p>
<ul>
<li>New parameter <code>node_write_etc_hosts</code> to control whether to write <code>/etc/hosts</code> file on target nodes.</li>
<li>Relocatable prometheus target directory with new parameter <code>prometheus_sd_dir</code>.</li>
<li>Add <code>-x|--proxy</code> flag to enable and use value of global proxy env by @waitingsong in <a href="https://github.com/Vonng/pigsty/pull/405">https://github.com/Vonng/pigsty/pull/405</a></li>
<li>No longer parse infra nginx log details since it brings too much labels to the log.</li>
<li>Use alertmanager API Version v2 instead of v1 in prometheus config.</li>
<li>Use <code>/pg/cert/ca.crt</code> instead of <code>/etc/pki/ca.crt</code> in pgsql roles.</li>
</ul>
<p><strong>New Contributors</strong></p>
<ul>
<li>@NeroSong made their first contribution in <a href="https://github.com/Vonng/pigsty/pull/373">https://github.com/Vonng/pigsty/pull/373</a></li>
<li>@waitingsong made their first contribution in <a href="https://github.com/Vonng/pigsty/pull/405">https://github.com/Vonng/pigsty/pull/405</a></li>
</ul>
<p><strong>Package Checksums</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ec271a1d34b2b1360f78bfa635986c3a  pigsty-pkg-v2.7.0.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>f3304bfd896b7e3234d81d8ff4b83577  pigsty-pkg-v2.7.0.debian12.x86_64.tgz
</span></span><span style="display:flex;"><span>5b071c2a651e8d1e68fc02e7e922f2b3  pigsty-pkg-v2.7.0.ubuntu22.x86_64.tgz
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-3dc770fcdf858c1d69f4529ce3598e35">v2.6: the OLAP New Challenger</h1>
	<div class="lead">PG 16 as default, ParadeDB &amp; DuckDB support</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2024-02-22" class="text-muted">2024-02-22</time>
        
	</div>
	<hr>
<h2 id="v260">v2.6.0</h2>
<p><strong>Highlight</strong></p>
<ul>
<li>Use PostgreSQL 16 as the default major version (16.2)</li>
<li>Introduce <a href="https://www.paradedb.com/">ParadeDB</a> extensions: <code>pg_analytics</code>, <code>pg_bm25</code>, and <code>pg_sparse</code></li>
<li>Introduce <a href="https://duckdb.org/">DuckDB</a> and corresponding foreign data wrapper: <code>duckdb_fdw</code></li>
<li>Cloudflare CDN <a href="https://repo.pigsty.io">https://repo.pigsty.io</a> and QCloud CDN <a href="https://repo.pigsty.cc">https://repo.pigsty.cc</a></li>
</ul>
<p><strong>Configuration</strong></p>
<ul>
<li>Disable Grafana Unified Alert to work around the &ldquo;Database Locked&rdquo; error.</li>
<li>add <code>node_repo_modules</code> to add upstream repos (including local one) to node</li>
<li>remove <code>node_local_repo_urls</code>, replaced by <code>node_repo_modules</code> &amp; <code>repo_upstream</code>.</li>
<li>remove <code>node_repo_method</code>, replaced by <code>node_repo_modules</code>.</li>
<li>add the new <code>local</code> repo into <code>repo_upstream</code> instead of <code>node_local_repo_urls</code></li>
<li>add <code>chrony</code> into <code>node_default_packages</code></li>
<li>remove redis,minio,postgresql client from infra packages</li>
<li>replace <code>repo_upstream.baseurl</code> $releasever for pgdg el8/el9 with <code>major.minor</code> instead of <code>major</code> version</li>
</ul>
<p><strong>Software Upgrade</strong></p>
<ul>
<li>Grafana 10.3.3</li>
<li>Prometheus 2.47</li>
<li>node_exporter 1.7.0</li>
<li>HAProxy 2.9.5</li>
<li>Loki / Promtail 2.9.4</li>
<li>minio-20240216110548 / mcli-20240217011557</li>
<li>etcd 3.5.11</li>
<li>Redis 7.2.4</li>
<li>Bytebase 2.13.2</li>
<li>HAProxy 2.9.5</li>
<li>DuckDB 0.10.0</li>
<li>FerretDB 1.19</li>
<li>Metabase: new docker compose app template added</li>
</ul>
<p><strong>PostgreSQL x Pigsty Extensions</strong></p>
<ul>
<li>PostgreSQL Minor Version Upgrade 16.2, 15.6, 14.11, 13.14, 12.18</li>
<li>PostgreSQL 16 is now used as the default major version</li>
<li>pg_exporter 0.6.1, security fix</li>
<li>Patroni 3.2.2</li>
<li>pgBadger 12.4</li>
<li>pgBouncer 1.22</li>
<li>pgBackRest 2.50</li>
<li>vip-manager 2.3.0</li>
<li>PostGIS 3.4.2</li>
<li>PGVector 0.6.0</li>
<li>TimescaleDB 2.14.1</li>
<li>New Extension <a href="https://github.com/alitrack/duckdb_fdw">duckdb_fdw</a> v1.1</li>
<li>New Extension <a href="https://github.com/pramsey/pgsql-gzip">pgsql-gzip</a> v1.0.0</li>
<li>New Extension <a href="https://github.com/paradedb/paradedb/tree/dev/pg_sparse">pg_sparse</a> from ParadeDB: v0.5.6</li>
<li>New Extension <a href="https://github.com/paradedb/paradedb/tree/dev/pg_bm25">pg_bm25</a> from ParadeDB: v0.5.6</li>
<li>New Extension <a href="https://github.com/paradedb/paradedb/tree/dev/pg_analytics">pg_analytics</a> from ParadeDB: v0.5.6</li>
<li>Bump AI/ML Extension <a href="https://github.com/postgresml/postgresml">pgml</a> to v2.8.1 with pg16 support</li>
<li>Bump Columnar Extension <a href="https://github.com/hydradatabase/">hydra</a> to v1.1.1 with pg16 support</li>
<li>Bump Graph Extension <a href="https://github.com/apache/age">age</a> to v1.5.0 with pg16 support</li>
<li>Bump Packaging Extension <a href="https://github.com/aws/pg_tle">pg_tle</a> to v1.3.4 with pg16 support</li>
<li>Bump GraphQL Extension <a href="https://github.com/supabase/pg_graphql">pg_graphql</a> to v1.5.0 to support supabase</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>330e9bc16a2f65d57264965bf98174ff  pigsty-v2.6.0.tgz
</span></span><span style="display:flex;"><span>81abcd0ced798e1198740ab13317c29a  pigsty-pkg-v2.6.0.debian11.x86_64.tgz
</span></span><span style="display:flex;"><span>7304f4458c9abd3a14245eaf72f4eeb4  pigsty-pkg-v2.6.0.debian12.x86_64.tgz
</span></span><span style="display:flex;"><span>f914fbb12f90dffc4e29f183753736bb  pigsty-pkg-v2.6.0.el7.x86_64.tgz
</span></span><span style="display:flex;"><span>fc23d122d0743d1c1cb871ca686449c0  pigsty-pkg-v2.6.0.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>9d258dbcecefd232f3a18bcce512b75e  pigsty-pkg-v2.6.0.el9.x86_64.tgz
</span></span><span style="display:flex;"><span>901ee668621682f99799de8932fb716c  pigsty-pkg-v2.6.0.ubuntu20.x86_64.tgz
</span></span><span style="display:flex;"><span>39872cf774c1fe22697c428be2fc2c22  pigsty-pkg-v2.6.0.ubuntu22.x86_64.tgz
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-ed1ac65c2e587244099ee76432661f6f">v2.5: Debian / Ubuntu / PG16</h1>
	<div class="lead">Ubuntu/Debian Support, New Extensions &amp; Monitor Update</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2023-10-24" class="text-muted">2023-10-24</time>
        
	</div>
	<hr>
<h2 id="v250">v2.5.0</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl https://get.pigsty.cc/latest <span style="color:#000;font-weight:bold">|</span> bash
</span></span></code></pre></div><p><strong>Highlights</strong></p>
<ul>
<li>
<p><a href="https://github.com/Vonng/pigsty/blob/master/files/pigsty/ubuntu.yml">Ubuntu</a> / <a href="https://github.com/Vonng/pigsty/blob/master/files/pigsty/debian.yml">Debian</a> Support:  bullseye, bookworm, jammy, focal</p>
</li>
<li>
<p>Dedicate yum/apt repo on <code>repo.pigsty.cc</code> and mirror on packagecloud.io</p>
</li>
<li>
<p>Anolis OS Support (EL 8.8 Compatible)</p>
</li>
<li>
<p>PG Major Candidate: Use PostgreSQL 16 instead of PostgreSQL 14.</p>
</li>
<li>
<p>New Dashboard PGSQL Exporter, PGSQL Patroni, rework on PGSQL Query</p>
</li>
<li>
<p>Extensions Update:</p>
<ul>
<li>Bump PostGIS version to v3.4 on el8, el9, ubuntu22, keep postgis 33 on EL7</li>
<li>Remove extension <code>pg_embedding</code> because it is no longer maintained, use <code>pgvector</code> instead.</li>
<li>New extension on EL: <code>pointcloud</code> with LIDAR data type support.</li>
<li>New extension on EL: <code>imgsmlr</code>, <code>pg_similarity</code>, <code>pg_bigm</code></li>
<li>Include columnar extension <code>hydra</code> and remove <code>citus</code> from default installed extension list.</li>
<li>Recompile <code>pg_filedump</code> as PG major version independent package.</li>
</ul>
</li>
<li>
<p>Software Version Upgrade:</p>
<ul>
<li>Grafana to v10.1.5</li>
<li>Prometheus to v2.47</li>
<li>Promtail/Loki to v2.9.1</li>
<li>Node Exporter to v1.6.1</li>
<li>Bytebase to v2.10.0</li>
<li>patroni to v3.1.2</li>
<li>pgbouncer to v1.21.0</li>
<li>pg_exporter to v0.6.0</li>
<li>pgbackrest to v2.48.0</li>
<li>pgbadger to v12.2</li>
<li>pg_graphql to v1.4.0</li>
<li>pg_net to v0.7.3</li>
<li>ferretdb to v0.12.1</li>
<li>sealos to 4.3.5</li>
<li>Supabase support to <code>20231013070755</code></li>
</ul>
</li>
</ul>
<p><strong>Ubuntu Support</strong></p>
<p>Pigsty has two ubuntu LTS support: 22.04 (jammy) and 20.04 (focal), and ship corresponding offline packages for them.</p>
<p>Some parameters need to be specified explicitly when deploying on Ubuntu, please refer to <a href="https://github.com/Vonng/pigsty/blob/master/files/pigsty/ubuntu.yml"><code>ubuntu.yml</code></a></p>
<ul>
<li><code>repo_upstream</code>: Adjust according to ubuntu / debian repo.</li>
<li><code>repo_packages</code>: Adjust according to ubuntu / debian naming convention</li>
<li><code>node_repo_local_urls</code>: use the default value: <code>['deb [trusted=yes] http://${admin_ip}/pigsty ./']</code></li>
<li><code>node_default_packages</code>:
<ul>
<li><code>zlib</code> -&gt; <code>zlib1g</code>, <code>readline</code> -&gt; <code>libreadline-dev</code></li>
<li><code>vim-minimal</code> -&gt; <code>vim-tiny</code>, <code>bind-utils</code> -&gt; <code>dnsutils</code>, <code>perf</code> -&gt; <code>linux-tools-generic</code>,</li>
<li>new packages <code>acl</code> to ensure ansible tmp file privileges are set correctly</li>
</ul>
</li>
<li><code>infra_packages</code>: replace all <code>_</code> with <code>-</code> in names, and replace <code>postgresql16</code> with <code>postgresql-client-16</code></li>
<li><code>pg_packages</code>: replace all <code>_</code> with <code>-</code> in names, <code>patroni-etcd</code> not needed on ubuntu</li>
<li><code>pg_extensions</code>: different naming convention, no <code>passwordcheck_cracklib</code> on ubuntu.</li>
<li><code>pg_dbsu_uid</code>: You have to manually specify <code>pg_dbsu_uid</code> on ubuntu, because PGDG deb package does not specify pg dbsu uid.</li>
</ul>
<p><strong>API Changes</strong></p>
<p>default values of following parameters have changed:</p>
<ul>
<li>
<p><code>repo_modules</code>: <code>infra,node,pgsql,redis,minio</code></p>
</li>
<li>
<p><code>repo_upstream</code>: Now add Pigsty Infra/MinIO/Redis/PGSQL modular upstream repo.</p>
</li>
<li>
<p><code>repo_packages</code>: remove unused <code>karma,mtail,dellhw_exporter</code> and pg 14 extra extensions, adding pg 16 extra extensions.</p>
</li>
<li>
<p><code>node_default_packages</code> now add <code>python3-pip</code> as default packages.</p>
</li>
<li>
<p><code>pg_libs</code>: <code>timescaledb</code> is remove from shared_preload_libraries by default.</p>
</li>
<li>
<p><code>pg_extensions</code>: citus is nolonger installed by default, and <code>passwordcheck_cracklib</code> is installed by default</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000">pg_repack_${pg_version}* wal2json_${pg_version}* passwordcheck_cracklib_${pg_version}*</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">postgis34_${pg_version}* timescaledb-2-postgresql-${pg_version}* pgvector_${pg_version}*</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>87e0be2edc35b18709d7722976e305b0  pigsty-pkg-v2.5.0.el7.x86_64.tgz
</span></span><span style="display:flex;"><span>e71304d6f53ea6c0f8e2231f238e8204  pigsty-pkg-v2.5.0.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>39728496c134e4352436d69b02226ee8  pigsty-pkg-v2.5.0.el9.x86_64.tgz
</span></span><span style="display:flex;"><span>e3f548a6c7961af6107ffeee3eabc9a7  pigsty-pkg-v2.5.0.debian11.x86_64.tgz
</span></span><span style="display:flex;"><span>1e469cc86a19702e48d7c1a37e2f14f9  pigsty-pkg-v2.5.0.debian12.x86_64.tgz
</span></span><span style="display:flex;"><span>cc3af3b7c12f98969d3c6962f7c4bd8f  pigsty-pkg-v2.5.0.ubuntu20.x86_64.tgz
</span></span><span style="display:flex;"><span>c5b2b1a4867eee624e57aed58ac65a80  pigsty-pkg-v2.5.0.ubuntu22.x86_64.tgz
</span></span></code></pre></div><hr>
<h2 id="v251">v2.5.1</h2>
<p>Routine update with v16.1, v15.5, 14.10, 13.13, 12.17, 11.22</p>
<p>Now PostgreSQL 16 has all the core extensions available (<code>pg_repack</code> &amp; <code>timescaledb</code> added)</p>
<ul>
<li>Software Version Upgrade:
<ul>
<li>PostgreSQL to v16.1, v15.5, 14.10, 13.13, 12.17, 11.22</li>
<li>Patroni v3.2.0</li>
<li>PgBackrest v2.49</li>
<li>Citus 12.1</li>
<li>TimescaleDB 2.13.0 (with PG 16 support)</li>
<li>Grafana v10.2.2</li>
<li>FerretDB 1.15</li>
<li>SealOS 4.3.7</li>
<li>Bytebase 2.11.1</li>
</ul>
</li>
</ul>
<ul>
<li>Remove <code>monitor</code> schema prefix from PGCAT dashboard queries</li>
<li>New template <code>wool.yml</code> for Aliyun free ECS singleton</li>
<li>Add <code>python3-jmespath</code> in addition to <code>python3.11-jmespath</code> for el9</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>31ee48df1007151009c060e0edbd74de  pigsty-pkg-v2.5.1.el7.x86_64.tgz
</span></span><span style="display:flex;"><span>a40f1b864ae8a19d9431bcd8e74fa116  pigsty-pkg-v2.5.1.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>c976cd4431fc70367124fda4e2eac0a7  pigsty-pkg-v2.5.1.el9.x86_64.tgz
</span></span><span style="display:flex;"><span>7fc1b5bdd3afa267a5fc1d7cb1f3c9a7  pigsty-pkg-v2.5.1.debian11.x86_64.tgz
</span></span><span style="display:flex;"><span>add0731dc7ed37f134d3cb5b6646624e  pigsty-pkg-v2.5.1.debian12.x86_64.tgz
</span></span><span style="display:flex;"><span>99048d09fa75ccb8db8e22e2a3b41f28  pigsty-pkg-v2.5.1.ubuntu20.x86_64.tgz
</span></span><span style="display:flex;"><span>431668425f8ce19388d38e5bfa3a948c  pigsty-pkg-v2.5.1.ubuntu22.x86_64.tgz
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-96dd01ab4a3d0bd6dfab7c250bacba6a">v2.4: Monitoring Cloud RDS</h1>
	<div class="lead">PG16, RDS Monitor, New Extensions, Redis Enhancement</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2023-09-14" class="text-muted">2023-09-14</time>
        
	</div>
	<hr>
<h2 id="v240">v2.4.0</h2>
<p>Get started with <code>bash -c &quot;$(curl -fsSL https://get.pigsty.cc/latest)&quot;</code>.</p>
<p><strong>Highlights</strong></p>
<ul>
<li>PostgreSQL 16 support</li>
<li>The first LTS version with business support and consulting service</li>
<li>Monitoring existing PostgreSQL, RDS for PostgreSQL / PolarDB with PGRDS Dashboards</li>
<li>New extension: Apache AGE, openCypher graph query engine on PostgreSQL</li>
<li>New extension: zhparser, full text search for Chinese language</li>
<li>New extension: pg_roaringbitmap, roaring bitmap for PostgreSQL</li>
<li>New extension: pg_embedding, hnsw alternative to pgvector</li>
<li>New extension: pg_tle, admin / manage stored procedure extensions</li>
<li>New extension: pgsql-http, issue http request with SQL interface</li>
<li>Add extensions: pg_auth_mon pg_checksums pg_failover_slots pg_readonly postgresql-unit pg_store_plans pg_uuidv7 set_user</li>
<li>Redis enhancement: add monitoring panels for redis sentinel, and auto HA configuration for redis ms cluster.</li>
</ul>
<p><strong>API Change</strong></p>
<ul>
<li>New Parameter: <code>REDIS</code>.<code>redis_sentinel_monitor</code>: specify masters monitor by redis sentinel cluster</li>
</ul>
<p><strong>Bug Fix</strong></p>
<ul>
<li>Fix Grafana 10.1 registered datasource will use random uid rather than <code>ins.datname</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.4.0.el7.x86_64.tgz) = 257443e3c171439914cbfad8e9f72b17
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.4.0.el8.x86_64.tgz) = 41ad8007ffbfe7d5e8ba5c4b51ff2adc
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.4.0.el9.x86_64.tgz) = 9a950aed77a6df90b0265a6fa6029250
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7614bd9c24528f6c6b30f1ac2805f1a5">v2.3: Ecosystem Applications</h1>
	<div class="lead">PGSQL/REDIS Update, NODE VIP, Mongo/FerretDB, MYSQL Stub</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2023-08-20" class="text-muted">2023-08-20</time>
        
	</div>
	<hr>
<h2 id="v230">v2.3.0</h2>
<p>PGSQL/REDIS Update, NODE VIP, Mongo/FerretDB, MYSQL Stub</p>
<p>Get started with <code>bash -c &quot;$(curl -fsSL https://get.pigsty.cc/latest)&quot;</code></p>
<p><strong>Highlight</strong></p>
<ul>
<li>INFRA: NODE/PGSQL VIP monitoring support</li>
<li>NODE:  Allow bind <code>node_vip</code> to node cluster with <code>keepalived</code></li>
<li>REPO: Dedicate yum repo, enable https for <a href="https://get.pigsty.cc"><code>get.pigsty.cc</code></a> and <a href="https://demo.pigsty.cc"><code>demo.pigsty.cc</code></a></li>
<li>PGSQL: Fix <a href="https://www.postgresql.org/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/">CVE-2023-39417</a> with PostgreSQL 15.4, 14.9, 13.12, 12.16, bump patroni version to v3.1.0</li>
<li>APP: Bump <code>app/bytebase</code> to v2.6.0, <code>app/ferretdb</code> version to v1.8, new application <a href="https://nocodb.com/">nocodb</a></li>
<li>REDIS: bump to v7.2 and rework on dashboards</li>
<li>MONGO: basic deploy &amp; monitor support with <a href="https://www.ferretdb.io/">FerretDB</a> 1.8</li>
<li>MYSQL: add prometheus/grafana/ca stub for future implementation.</li>
</ul>
<p><strong>API Change</strong></p>
<p>Add 1 new section <code>NODE</code>.<code>NODE_VIP</code> with 8 new parameter</p>
<ul>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_enabled</code> : enable vip on this node cluster?</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_address</code> : node vip address in ipv4 format, required if vip is enabled</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_vrid</code> : required, integer, 1-255 should be unique among same VLAN</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_role</code> : <code>master/backup</code>, backup by default, use as init role</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_preempt</code> : optional, <code>true/false</code>, false by default, enable vip preemption</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_interface</code> : node vip network interface to listen, <code>eth0</code> by default</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_dns_suffix</code> : node vip dns name suffix, <code>.vip</code> by default</li>
<li><code>NODE</code>.<code>VIP</code>.<code>vip_exporter_port</code> : keepalived exporter listen port, 9650 by default</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.3.0.el7.x86_64.tgz) = 81db95f1c591008725175d280ad23615
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.3.0.el8.x86_64.tgz) = 6f4d169b36f6ec4aa33bfd5901c9abbe
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.3.0.el9.x86_64.tgz) = 4bc9ae920e7de6dd8988ca7ee681459d
</span></span></code></pre></div><hr>
<h2 id="v231">v2.3.1</h2>
<p>Get started with <code>bash -c &quot;$(curl -fsSL https://get.pigsty.cc/latest)&quot;</code>.</p>
<p><strong>Highlights</strong></p>
<ul>
<li>PGVector 0.5 with HNSW index support</li>
<li>PostgreSQL 16 RC1 for el8/el9
** Adding SealOS for kubernetes support</li>
</ul>
<p><strong>Bug Fix</strong></p>
<ul>
<li>Fix <code>infra</code>.<code>repo</code>.<code>repo_pkg</code> task when downloading rpm with <code>*</code> in their names in <code>repo_packages</code>.
<ul>
<li>if <code>/www/pigsty</code> already have package name match that pattern, some rpm will be skipped.</li>
</ul>
</li>
<li>Change default value of <code>vip_dns_suffix</code> to <code>''</code> empty string rather than <code>.vip</code></li>
<li>Grant sudo privilege for postgres dbsu when <code>pg_dbsu_sudo</code> = <code>limit</code> and <code>patroni_watchdog_mode</code> = <code>required</code>
<ul>
<li><code>/usr/bin/sudo /sbin/modprobe softdog</code>: enable watchdog module before launching patroni</li>
<li><code>/usr/bin/sudo /bin/chown {{ pg_dbsu }} /dev/watchdog</code>: chown watchdog before launching patroni</li>
</ul>
</li>
</ul>
<p><strong>Documentation Update</strong></p>
<ul>
<li>Add details to English documentation</li>
<li>Add Chinese/zh-cn documentation</li>
</ul>
<p><strong>Software Upgrade</strong></p>
<ul>
<li>PostgreSQL 16 RC1 on el8/el9</li>
<li>PGVector 0.5.0 with hnsw index</li>
<li>TimescaleDB 2.11.2</li>
<li>grafana 10.1.0</li>
<li>loki &amp; promtail 2.8.4</li>
<li>mcli-20230829225506 / minio-20230829230735</li>
<li>ferretdb 1.9</li>
<li>sealos 4.3.3</li>
<li>pgbadger 1.12.2</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ce69791eb622fa87c543096cdf11f970  pigsty-pkg-v2.3.1.el7.x86_64.tgz
</span></span><span style="display:flex;"><span>495aba9d6d18ce1ebed6271e6c96b63a  pigsty-pkg-v2.3.1.el8.x86_64.tgz
</span></span><span style="display:flex;"><span>38b45582cbc337ff363144980d0d7b64  pigsty-pkg-v2.3.1.el9.x86_64.tgz
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-6825bf79d1906fbbd528bd99a583848e">v2.2: Observability Overhaul</h1>
	<div class="lead">Dashboard &amp; Provision overhaul, UOS compatibility</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2023-08-04" class="text-muted">2023-08-04</time>
        
	</div>
	<hr>
<h2 id="v220">v2.2.0</h2>
<p><a href="https://github.com/Vonng/pigsty/releases/tag/v2.2.0">https://github.com/Vonng/pigsty/releases/tag/v2.2.0</a></p>
<p>Get started with <code>bash -c &quot;$(curl -fsSL https://get.pigsty.cc/latest)&quot;</code></p>
<p>Release Note: <a href="https://doc.pigsty.cc/#/RELEASENOTE?id=v220">https://doc.pigsty.cc/#/RELEASENOTE?id=v220</a></p>
<p><strong>Highlight</strong></p>
<ul>
<li>Monitoring Dashboards Overhaul: <a href="https://demo.pigsty.cc">https://demo.pigsty.cc</a></li>
<li>Vagrant Sandbox Overhaul: libvirt support and new templates</li>
<li>Pigsty EL Yum Repo: Building simplified</li>
<li>OS Compatibility: UOS-v20-1050e support</li>
<li>New config template: prod simulation with 42 nodes</li>
<li>Use official pgdg citus distribution for el7</li>
</ul>
<p><strong>Software Upgrade</strong></p>
<ul>
<li>PostgreSQL 16 beta2</li>
<li>Citus 12 / PostGIS 3.3.3 / TimescaleDB 2.11.1 / PGVector 0.44</li>
<li>patroni 3.0.4 / pgbackrest 2.47 / pgbouncer 1.20</li>
<li>grafana 10.0.3 / loki/promtail/logcli 2.8.3</li>
<li>etcd 3.5.9 / haproxy v2.8.1 / redis v7.0.12</li>
<li>minio 20230711212934 / mcli 20230711233044</li>
</ul>
<p><strong>Bug Fix</strong></p>
<ul>
<li>Fix docker group ownership issue [29434bd]https://github.com/Vonng/pigsty/commit/29434bdd39548d95d80a236de9099874ed564f9b</li>
<li>Append infra os group rather than set it as primary group</li>
<li>Fix redis sentinel systemd enable status <a href="https://github.com/Vonng/pigsty/commit/5c96feb598ad6e44daa7a595e34c87e67952777b">5c96feb</a></li>
<li>Loose <code>bootstrap</code> &amp; <code>configure</code> if <code>/etc/redhat-release</code> not exists</li>
<li>Fix grafana 9.x <a href="https://grafana.com/blog/2023/03/22/grafana-security-release-new-versions-with-security-fixes-for-cve-2023-1410/">CVE-2023-1410</a> with 10.0.2</li>
<li>Add PG 14 - 16 new command tags and error codes for <code>pglog</code> schema</li>
</ul>
<p><strong>API Change</strong></p>
<p>Add 1 new parameter</p>
<ul>
<li><code>INFRA</code>.<code>NGINX</code>.<code>nginx_exporter_enabled</code>        : now you can disable nginx_exporter with this parameter</li>
</ul>
<p>Default value changes:</p>
<ul>
<li><code>repo_modules</code>: <code>node,pgsql,infra</code> : redis is removed from it</li>
<li><code>repo_upstream</code>:
<ul>
<li>add <code>pigsty-el</code>: distribution independent rpms: such as grafana, minio, pg_exporter, etc&hellip;</li>
<li>add <code>pigsty-misc</code>: distribution aware rpms: such as redis, prometheus stack binaries, etc&hellip;</li>
<li>remove <code>citus</code> repo since pgdg now have full official citus support (on el7)</li>
<li>remove <code>remi</code> , since redis is now included in <code>pigsty-misc</code></li>
<li>remove <code>grafana</code> in build config for acceleration</li>
</ul>
</li>
<li><code>repo_packages</code>:
<ul>
<li>ansible python3 python3-pip python3-requests python3.11-jmespath dnf-utils modulemd-tools # el7: python36-requests python36-idna yum-utils</li>
<li>grafana loki logcli promtail prometheus2 alertmanager karma pushgateway node_exporter blackbox_exporter nginx_exporter redis_exporter</li>
<li>redis etcd minio mcli haproxy vip-manager pg_exporter nginx createrepo_c sshpass chrony dnsmasq docker-ce docker-compose-plugin flamegraph</li>
<li>lz4 unzip bzip2 zlib yum pv jq git ncdu make patch bash lsof wget uuid tuned perf nvme-cli numactl grubby sysstat iotop htop rsync tcpdump</li>
<li>netcat socat ftp lrzsz net-tools ipvsadm bind-utils telnet audit ca-certificates openssl openssh-clients readline vim-minimal</li>
<li>postgresql13* wal2json_13* pg_repack_13* passwordcheck_cracklib_13* postgresql12* wal2json_12* pg_repack_12* passwordcheck_cracklib_12* postgresql16* timescaledb-tools</li>
<li>postgresql15 postgresql15* citus_15* pglogical_15* wal2json_15* pg_repack_15* pgvector_15* timescaledb-2-postgresql-15* postgis33_15* passwordcheck_cracklib_15* pg_cron_15*</li>
<li>postgresql14 postgresql14* citus_14* pglogical_14* wal2json_14* pg_repack_14* pgvector_14* timescaledb-2-postgresql-14* postgis33_14* passwordcheck_cracklib_14* pg_cron_14*</li>
<li>patroni patroni-etcd pgbouncer pgbadger pgbackrest pgloader pg_activity pg_partman_15 pg_permissions_15 pgaudit17_15 pgexportdoc_15 pgimportdoc_15 pg_statement_rollback_15*</li>
<li>orafce_15* mysqlcompat_15 mongo_fdw_15* tds_fdw_15* mysql_fdw_15 hdfs_fdw_15 sqlite_fdw_15 pgbouncer_fdw_15 multicorn2_15* powa_15* pg_stat_kcache_15* pg_stat_monitor_15* pg_qualstats_15 pg_track_settings_15 pg_wait_sampling_15 system_stats_15</li>
<li>plprofiler_15* plproxy_15 plsh_15* pldebugger_15 plpgsql_check_15*  pgtt_15 pgq_15* pgsql_tweaks_15 count_distinct_15 hypopg_15 timestamp9_15* semver_15* prefix_15* rum_15 geoip_15 periods_15 ip4r_15 tdigest_15 hll_15 pgmp_15 extra_window_functions_15 topn_15</li>
<li>pg_background_15 e-maj_15 pg_catcheck_15 pg_prioritize_15 pgcopydb_15 pg_filedump_15 pgcryptokey_15 logerrors_15 pg_top_15 pg_comparator_15 pg_ivm_15* pgsodium_15* pgfincore_15* ddlx_15 credcheck_15 safeupdate_15 pg_squeeze_15* pg_fkpart_15 pg_jobmon_15</li>
</ul>
</li>
<li><code>repo_url_packages</code>:
<ul>
<li><a href="https://get.pigsty.cc/rpm/pev.html">https://get.pigsty.cc/rpm/pev.html</a></li>
<li><a href="https://get.pigsty.cc/rpm/chart.tgz">https://get.pigsty.cc/rpm/chart.tgz</a></li>
</ul>
</li>
<li><code>node_default_packages</code>:
<ul>
<li>lz4,unzip,bzip2,zlib,yum,pv,jq,git,ncdu,make,patch,bash,lsof,wget,uuid,tuned,nvme-cli,numactl,grubby,sysstat,iotop,htop,rsync,tcpdump</li>
<li>netcat,socat,ftp,lrzsz,net-tools,ipvsadm,bind-utils,telnet,audit,ca-certificates,openssl,readline,vim-minimal,node_exporter,etcd,haproxy,python3,python3-pip</li>
</ul>
</li>
<li><code>infra_packages</code>
<ul>
<li>grafana,loki,logcli,promtail,prometheus2,alertmanager,karma,pushgateway</li>
<li>node_exporter,blackbox_exporter,nginx_exporter,redis_exporter,pg_exporter</li>
<li>nginx,dnsmasq,ansible,postgresql15,redis,mcli,python3-requests</li>
</ul>
</li>
<li><code>PGSERVICE</code> in <code>.pigsty</code> is removed, replaced with <code>PGDATABASE=postgres</code>.</li>
</ul>
<p>FHS Changes:</p>
<ul>
<li><code>bin/dns</code> and <code>bin/ssh</code> now moved to <code>vagrant/</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.2.0.el7.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 5fb6a449a234e36c0d895a35c76add3c
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.2.0.el8.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> c7211730998d3b32671234e91f529fd0
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.2.0.el9.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 385432fe86ee0f8cbccbbc9454472fdd
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-f0e725fb652dced07f33923430e0af98">v2.1: Vector Embedding &amp; RAG</h1>
	<div class="lead">PostgreSQL 12 ~ 16 support</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2023-06-09" class="text-muted">2023-06-09</time>
        
	</div>
	<hr>
<h2 id="v210">v2.1.0</h2>
<p>PostgreSQL 12 ~ 16 support and pgvector for AI embedding.</p>
<p><a href="https://github.com/Vonng/pigsty/releases/tag/v2.1.0">https://github.com/Vonng/pigsty/releases/tag/v2.1.0</a></p>
<p><strong>Highlight</strong></p>
<ul>
<li>PostgreSQL 16 beta support, and 12 ~ 15 support.</li>
<li>Add PGVector for AI Embedding for 12 - 15</li>
<li>Add 6 extra panel &amp; datasource plugins for grafana</li>
<li>Add <code>bin/profile</code> to profile remote process and generate flamegraph</li>
<li>Add <code>bin/validate</code> to validate pigsty.yml configuration file</li>
<li>Add <code>bin/repo-add</code> to add upstream repo files to /etc/yum.repos.d</li>
<li>PostgreSQL 16 observability: <code>pg_stat_io</code> and corresponding dashboards</li>
</ul>
<p><strong>Software Upgrade</strong></p>
<ul>
<li>PostgreSQL 15.3 , 14.8, 13.11, 12.15, 11.20, and 16 beta1</li>
<li>pgBackRest 2.46</li>
<li>pgbouncer 1.19</li>
<li>Redis 7.0.11</li>
<li>Grafana v9.5.3</li>
<li>Loki / Promtail / Logcli 2.8.2</li>
<li>Prometheus 2.44</li>
<li>TimescaleDB 2.11.0</li>
<li>minio-20230518000536 / mcli-20230518165900</li>
<li>Bytebase v2.2.0</li>
</ul>
<p><strong>Enhancement</strong></p>
<ul>
<li>Now use all <code>id*.pub</code> when installing local user&rsquo;s public key</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-245a6f15e780571746392362492e84ab">v2.0: Free RDS PG Alternative</h1>
	<div class="lead">Compatibility, Security and maintainability overhaul, a truly RDS PG alternative.</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2023-02-26" class="text-muted">2023-02-26</time>
        
	</div>
	<hr>
<h2 id="v200">v2.0.0</h2>
<p>&ldquo;PIGSTY&rdquo; is now the abbr of &ldquo;PostgreSQL in Great STYle&rdquo;</p>
<blockquote>
<p>or &ldquo;PostgreSQL &amp; Infrastructure &amp; Governance System allTogether for You&rdquo;.</p>
</blockquote>
<p>Get pigsty <a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.0">v2.0.0</a> release via the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL http://download.pigsty.cc/get<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">|</span> bash
</span></span></code></pre></div><details><summary>Download directly from GitHub Release</summary>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bash -c <span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">$(</span>curl -fsSL https://raw.githubusercontent.com/Vonng/pigsty/master/bin/get<span style="color:#204a87;font-weight:bold">)</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># or download tarball directly with curl (EL9)</span>
</span></span><span style="display:flex;"><span>curl -L https://github.com/Vonng/pigsty/releases/download/v2.0.0/pigsty-v2.0.0.tgz -o ~/pigsty.tgz
</span></span><span style="display:flex;"><span>curl -L https://github.com/Vonng/pigsty/releases/download/v2.0.0/pigsty-pkg-v2.0.0.el9.x86_64.tgz  -o /tmp/pkg.tgz
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># EL7: https://github.com/Vonng/pigsty/releases/download/v2.0.0/pigsty-pkg-v2.0.0.el7.x86_64.tgz</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># EL8: https://github.com/Vonng/pigsty/releases/download/v2.0.0/pigsty-pkg-v2.0.0.el8.x86_64.tgz</span>
</span></span></code></pre></div></details>
<h2 id="highlights"><strong>Highlights</strong></h2>
<ul>
<li>PostgreSQL 15.2, PostGIS 3.3, Citus 11.2, TimescaleDB 2.10 now works together and unite as one.</li>
<li>Now works on EL 7,8,9 for RHEL, CentOS, Rocky, AlmaLinux, and other EL compatible distributions</li>
<li>Security enhancement with self-signed CA, full SSL support, <code>scram-sha-256</code> pwd encryption, and more.</li>
<li>Patroni 3.0 with native HA citus cluster support and dcs failsafe mode to prevent global DCS failures.</li>
<li>Auto-Configured, Battery-Included PITR for PostgreSQL powered by <code>pgbackrest</code>, local or S3/minio.</li>
<li>Dedicate module <code>ETCD</code> which can be easily deployed and scaled in/out. Used as DCS instead of Consul.</li>
<li>Dedicate module <code>MINIO</code>, local S3 alternative for the optional central backup repo for PGSQL PITR.</li>
<li>Better config templates with adaptive tuning for Node &amp; PG according to your hardware spec.</li>
<li>Use AGPL v3.0 license instead of Apache 2.0 license due to Grafana &amp; MinIO reference.</li>
</ul>
<h2 id="compatibility"><strong>Compatibility</strong></h2>
<ul>
<li>Pigsty now works on EL7, EL8, EL9, and offers corresponding pre-packed offline packages.</li>
<li>Pigsty now works on EL compatible distributions: RHEL, CentOS, Rocky, AlmaLinux, OracleLinux,&hellip;</li>
<li>Pigsty now use RockyLinux 9 as default developing &amp; testing environment instead of CentOS 7</li>
<li>EL version, CPU arch, and pigsty version string are part of source &amp; offline package names.</li>
<li>PGSQL: PostgreSQL 15.2 / PostGIS 3.3 / TimescaleDB 2.10 / Citus 11.2 now works together.</li>
<li>PGSQL: Patroni 3.0 is used as default HA solution for PGSQL, and etcd is used as default DCS.
<ul>
<li>Patroni 3.0 with DCS failsafe mode to prevent global DCS failures (demoting all primary)</li>
<li>Patroni 3.0 with native HA citus cluster support, with entirely open sourced v11 citus.</li>
<li>vip-manager 2.x with ETCDv3 API, ETCDv2 API is deprecated, so does patroni.</li>
</ul>
</li>
<li>PGSQL: pgBackRest v2.44 is introduced to provide battery-include PITR for PGSQL.
<ul>
<li>it will use local backup FS on primary by default for a two-day retention policy</li>
<li>it will use S3/minio as an alternative central backup repo for a two-week retention policy</li>
</ul>
</li>
<li>ETCD is used as default DCS instead of Consul, And V3 API is used instead of V2 API.</li>
<li>NODE module now consist of <code>node</code> itself, <code>haproxy</code>, <code>docker</code>, <code>node_exporter</code>, and <code>promtail</code>
<ul>
<li><code>chronyd</code> is used as default NTP client instead of <code>ntpd</code></li>
<li>HAPROXY now attach to <code>NODE</code> instead of <code>PGSQL</code>, which can be used for exposing services</li>
<li>You can register PG Service to dedicate haproxy clusters rather than local cluster nodes.</li>
<li>You can expose ad hoc service in a NodePort manner with haproxy, not limited to pg services.</li>
</ul>
</li>
<li>INFRA now consist of <code>dnsmasq</code>, <code>nginx</code>, <code>prometheus</code>, <code>grafana</code>, <code>loki</code>
<ul>
<li>DNSMASQ is enabled on all infra nodes, and added to all nodes as the default resolver.</li>
<li>Add blackbox_exporter for ICMP probe, add pushgateway for batch job metrics.</li>
<li>Switch to official loki &amp; promtail rpm packages. Use official Grafana Echarts Panel.</li>
<li>Add infra dashboards for self-monitoring, add patroni &amp; pg15 metrics to monitoring system</li>
</ul>
</li>
<li>Software Upgrade
<ul>
<li>PostgreSQL 15.2 / PostGIS 3.3 / TimescaleDB 2.10 / Citus 11.2</li>
<li>Patroni 3.0 / Pgbouncer 1.18 / pgBackRest 2.44 / vip-manager 2.1</li>
<li>HAProxy 2.7 / Etcd 3.5 / MinIO 20230222182345 / mcli 20230216192011</li>
<li>Prometheus 2.42 / Grafana 9.3 / Loki &amp; Promtail 2.7 / Node Exporter 1.5</li>
</ul>
</li>
</ul>
<h2 id="security"><strong>Security</strong></h2>
<ul>
<li>A full-featured self-signed CA enabled by default</li>
<li>Redact password in postgres logs.</li>
<li>SSL for Nginx (you have to trust the self-signed CA or use <code>thisisunsafe</code> to dismiss warning)</li>
<li>SSL for etcd peer/client traffics by @alemacci</li>
<li>SSL for postgres/pgbouncer/patroni by @alemacci</li>
<li><code>scram-sha-256</code> auth for postgres password encryption by @alemacci</li>
<li>Pgbouncer Auth Query  by @alemacci</li>
<li>Use <code>AES-256-CBC</code> for <code>pgbackrest</code> encryption by @alemacci</li>
<li>Adding a security enhancement config template which enforce global SSL</li>
<li>Now all hba rules are defined in config inventory, no default rules.</li>
</ul>
<h2 id="maintainability"><strong>Maintainability</strong></h2>
<ul>
<li>Adaptive tuning template for PostgreSQL &amp; Patroni by @Vonng, @alemacci</li>
<li>configurable log dir for Patroni &amp; Postgres &amp; Pgbouncer &amp; Pgbackrest by @alemacci</li>
<li>Replace fixed ip placeholder <code>10.10.10.10</code> with <code>${admin_ip}</code> that can be referenced</li>
<li>Adaptive upstream repo definition that can be switched according EL ver, <code>region</code> &amp; arch.</li>
<li>Terraform Templates for AWS CN &amp; Aliyun, which can be used for sandbox IaaS provisioning</li>
<li>Vagrant Templates: <code>meta</code>, <code>full</code>, <code>el7</code> <code>el8</code>, <code>el9</code>, <code>build</code>, <code>minio</code>, <code>citus</code>, etc&hellip;</li>
<li>New playbook <code>pgsql-monitor.yml</code> for monitoring existing pg instance or RDS PG.</li>
<li>New playbook <code>pgsql-migration.yml</code> for migrating existing pg instance to pigsty manged pg.</li>
<li>New shell utils under <code>bin/</code> to simplify the daily administration tasks.</li>
<li>Optimize ansible role implementation. which can be used without default parameter values.</li>
<li>Now you can define pgbouncer parameters on database &amp; user level</li>
</ul>
<h2 id="api-changes"><strong>API Changes</strong></h2>
<p>69 parameters added, 16 parameters removed, rename 14 parameters</p>
<ul>
<li><code>INFRA</code>.<code>META</code>.<code>admin_ip</code>                        : primary meta node ip address</li>
<li><code>INFRA</code>.<code>META</code>.<code>region</code>                         : upstream mirror region: default|china|europe</li>
<li><code>INFRA</code>.<code>META</code>.<code>os_version</code>                     : enterprise linux release version: 7,8,9</li>
<li><code>INFRA</code>.<code>CA</code>.<code>ca_cn</code>                            : ca common name, pigsty-ca by default</li>
<li><code>INFRA</code>.<code>CA</code>.<code>cert_validity</code>                    : cert validity, 20 years by default</li>
<li><code>INFRA</code>.<code>REPO</code>.<code>repo_enabled</code>                   : build a local yum repo on infra node?</li>
<li><code>INFRA</code>.<code>REPO</code>.<code>repo_upstream</code>                  : list of upstream yum repo definition</li>
<li><code>INFRA</code>.<code>REPO</code>.<code>repo_home</code>                      : home dir of local yum repo, usually same as nginx_home &lsquo;/www&rsquo;</li>
<li><code>INFRA</code>.<code>NGINX</code>.<code>nginx_ssl_port</code>                : https listen port</li>
<li><code>INFRA</code>.<code>NGINX</code>.<code>nginx_ssl_enabled</code>             : nginx https enabled?</li>
<li><code>INFRA</code>.<code>PROMTETHEUS</code>.<code>alertmanager_endpoint</code>   : altermanager endpoint in (ip|domain):port format</li>
<li><code>NODE</code>.<code>NODE_TUNE</code>.<code>node_hugepage_count</code>        : number of 2MB hugepage, take precedence over <code>node_hugepage_ratio</code></li>
<li><code>NODE</code>.<code>NODE_TUNE</code>.<code>node_hugepage_ratio</code>        : mem hugepage ratio, 0 disable it by default</li>
<li><code>NODE</code>.<code>NODE_TUNE</code>.<code>node_overcommit_ratio</code>      : node mem overcommit ratio, 0 disable it by default</li>
<li><code>NODE</code>.<code>HAPROXY</code>.<code>haproxy_service</code>              : list of haproxy service to be exposed</li>
<li><code>PGSQL</code>.<code>PG_ID</code>.<code>pg_mode</code>                       : pgsql cluster mode: pgsql,citus,gpsql</li>
<li><code>PGSQL</code>.<code>PG_BUSINESS</code>.<code>pg_dbsu_password</code>        : dbsu password, empty string means no dbsu password by default</li>
<li><code>PGSQL</code>.<code>PG_INSTALL</code>.<code>pg_log_dir</code>               : postgres log dir, <code>/pg/data/log</code> by default</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_storage_type</code>        : SSD|HDD, SSD by default</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_log_dir</code>        : patroni log dir, <code>/pg/log</code> by default</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_ssl_enabled</code>    : secure patroni RestAPI communications with SSL?</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_username</code>       : patroni rest api username</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_password</code>       : patroni rest api password (IMPORTANT: CHANGE THIS)</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>patroni_citus_db</code>       : citus database managed by patroni, postgres by default</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_max_conn</code>            : postgres max connections, <code>auto</code> will use recommended value</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_shared_buffer_ratio</code> : postgres shared buffer memory ratio, 0.25 by default, 0.1~0.4</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_rto</code>                 : recovery time objective, ttl to failover, 30s by default</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_rpo</code>                 : recovery point objective, 1MB data loss at most by default</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pg_pwd_enc</code>             : algorithm for encrypting passwords: md5|scram-sha-256</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pgbouncer_log_dir</code>      : pgbouncer log dir, <code>/var/log/pgbouncer</code> by default</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pgbouncer_auth_query</code>   : if enabled, query pg_authid table to retrieve biz users instead of populating userlist</li>
<li><code>PGSQL</code>.<code>PG_BOOTSTRAP</code>.<code>pgbouncer_sslmode</code>      : SSL for pgbouncer client: disable|allow|prefer|require|verify-ca|verify-full</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_enabled</code>        : pgbackrest enabled?</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_clean</code>          : remove pgbackrest data during init ?</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_log_dir</code>        : pgbackrest log dir, <code>/pg/log</code> by default</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_method</code>         : pgbackrest backup repo method, local or minio</li>
<li><code>PGSQL</code>.<code>PG_BACKUP</code>.<code>pgbackrest_repo</code>           : pgbackrest backup repo config</li>
<li><code>PGSQL</code>.<code>PG_SERVICE</code>.<code>pg_service_provider</code>      : dedicate haproxy node group name, or empty string for local nodes by default</li>
<li><code>PGSQL</code>.<code>PG_SERVICE</code>.<code>pg_default_service_dest</code>  : default service destination if svc.dest=&lsquo;default&rsquo;</li>
<li><code>PGSQL</code>.<code>PG_SERVICE</code>.<code>pg_vip_enabled</code>           : enable a l2 vip for pgsql primary? false by default</li>
<li><code>PGSQL</code>.<code>PG_SERVICE</code>.<code>pg_vip_address</code>           : vip address in <code>&lt;ipv4&gt;/&lt;mask&gt;</code> format, require if vip is enabled</li>
<li><code>PGSQL</code>.<code>PG_SERVICE</code>.<code>pg_vip_interface</code>         : vip network interface to listen, eth0 by default</li>
<li><code>PGSQL</code>.<code>PG_SERVICE</code>.<code>pg_dns_suffix</code>            : pgsql cluster dns name suffix, &rsquo;&rsquo; by default</li>
<li><code>PGSQL</code>.<code>PG_SERVICE</code>.<code>pg_dns_target</code>            : auto, primary, vip, none, or ad hoc ip</li>
<li><code>ETCD</code>.<code>etcd_seq</code>                : etcd instance identifier, REQUIRED</li>
<li><code>ETCD</code>.<code>etcd_cluster</code>            : etcd cluster &amp; group name, etcd by default</li>
<li><code>ETCD</code>.<code>etcd_safeguard</code>          : prevent purging running etcd instance?</li>
<li><code>ETCD</code>.<code>etcd_clean</code>              : purging existing etcd during initialization?</li>
<li><code>ETCD</code>.<code>etcd_data</code>               : etcd data directory, /data/etcd by default</li>
<li><code>ETCD</code>.<code>etcd_port</code>               : etcd client port, 2379 by default</li>
<li><code>ETCD</code>.<code>etcd_peer_port</code>          : etcd peer port, 2380 by default</li>
<li><code>ETCD</code>.<code>etcd_init</code>               : etcd initial cluster state, new or existing</li>
<li><code>ETCD</code>.<code>etcd_election_timeout</code>   : etcd election timeout, 1000ms by default</li>
<li><code>ETCD</code>.<code>etcd_heartbeat_interval</code> : etcd heartbeat interval, 100ms by default</li>
<li><code>MINIO</code>.<code>minio_seq</code>        :  minio instance identifier, REQUIRED</li>
<li><code>MINIO</code>.<code>minio_cluster</code>    :  minio cluster name, minio by default</li>
<li><code>MINIO</code>.<code>minio_clean</code>      :  cleanup minio during init?, false by default</li>
<li><code>MINIO</code>.<code>minio_user</code>       :  minio os user, <code>minio</code> by default</li>
<li><code>MINIO</code>.<code>minio_node</code>       :  minio node name pattern</li>
<li><code>MINIO</code>.<code>minio_data</code>       :  minio data dir(s), use {x&hellip;y} to specify multi drivers</li>
<li><code>MINIO</code>.<code>minio_domain</code>     :  minio external domain name, <code>sss.pigsty</code> by default</li>
<li><code>MINIO</code>.<code>minio_port</code>       :  minio service port, 9000 by default</li>
<li><code>MINIO</code>.<code>minio_admin_port</code> :  minio console port, 9001 by default</li>
<li><code>MINIO</code>.<code>minio_access_key</code> :  root access key, <code>minioadmin</code> by default</li>
<li><code>MINIO</code>.<code>minio_secret_key</code> :  root secret key, <code>minioadmin</code> by default</li>
<li><code>MINIO</code>.<code>minio_extra_vars</code> :  extra environment variables for minio server</li>
<li><code>MINIO</code>.<code>minio_alias</code>      :  alias name for local minio deployment</li>
<li><code>MINIO</code>.<code>minio_buckets</code>    :  list of minio bucket to be created</li>
<li><code>MINIO</code>.<code>minio_users</code>      :  list of minio user to be created</li>
</ul>
<h2 id="removed-parameters"><strong>Removed Parameters</strong></h2>
<ul>
<li><code>INFRA</code>.<code>CA</code>.<code>ca_homedir</code>: ca home dir, now fixed as <code>/etc/pki/</code></li>
<li><code>INFRA</code>.<code>CA</code>.<code>ca_cert</code>: ca cert filename, now fixed as <code>ca.key</code></li>
<li><code>INFRA</code>.<code>CA</code>.<code>ca_key</code>: ca key filename, now fixed as <code>ca.key</code></li>
<li><code>INFRA</code>.<code>REPO</code>.<code>repo_upstreams</code>: replaced by <code>repo_upstream</code></li>
<li><code>PGSQL</code>.<code>PG_INSTALL</code>.<code>pgdg_repo</code>: now taken care by node playbooks</li>
<li><code>PGSQL</code>.<code>PG_INSTALL</code>.<code>pg_add_repo</code>: now taken care by node playbooks</li>
<li><code>PGSQL</code>.<code>PG_IDENTITY</code>.<code>pg_backup</code>: not used and conflict with section name</li>
<li><code>PGSQL</code>.<code>PG_IDENTITY</code>.<code>pg_preflight_skip</code>: not used anymore, replace by <code>pg_id</code></li>
<li><code>DCS</code>.<code>dcs_name</code>      : removed due to using etcd</li>
<li><code>DCS</code>.<code>dcs_servers</code>   : replaced by using ad hoc group <code>etcd</code></li>
<li><code>DCS</code>.<code>dcs_registry</code>  : removed due to using etcd</li>
<li><code>DCS</code>.<code>dcs_safeguard</code> : replaced by <code>etcd_safeguard</code></li>
<li><code>DCS</code>.<code>dcs_clean</code>     : replaced by <code>etcd_clean</code></li>
<li><code>PGSQL</code>.<code>PG_VIP</code>.<code>vip_mode</code>      : replaced by <code>pg_vip_enabled</code></li>
<li><code>PGSQL</code>.<code>PG_VIP</code>.<code>vip_address</code>   : replaced by <code>pg_vip_address</code></li>
<li><code>PGSQL</code>.<code>PG_VIP</code>.<code>vip_interface</code> : replaced by <code>pg_vip_interface</code></li>
</ul>
<h2 id="renamed-parameters"><strong>Renamed Parameters</strong></h2>
<ul>
<li><code>nginx_upstream</code>            -&gt; <code>infra_portal</code></li>
<li><code>repo_address</code>              -&gt; <code>repo_endpoint</code></li>
<li><code>pg_hostname</code>               -&gt; <code>node_id_from_pg</code></li>
<li><code>pg_sindex</code>                 -&gt; <code>pg_group</code></li>
<li><code>pg_services</code>               -&gt; <code>pg_default_services</code></li>
<li><code>pg_services_extra</code>         -&gt; <code>pg_services</code></li>
<li><code>pg_hba_rules_extra</code>        -&gt; <code>pg_hba_rules</code></li>
<li><code>pg_hba_rules</code>              -&gt; <code>pg_default_hba_rules</code></li>
<li><code>pgbouncer_hba_rules_extra</code> -&gt; <code>pgb_hba_rules</code></li>
<li><code>pgbouncer_hba_rules</code>       -&gt; <code>pgb_default_hba_rules</code></li>
<li><code>node_packages_default</code>     -&gt; <code>node_default_packages</code></li>
<li><code>node_packages_meta</code>        -&gt; <code>infra_packages</code></li>
<li><code>node_packages_meta_pip</code>    -&gt; <code>infra_packages_pip</code></li>
<li><code>node_data_dir</code>             -&gt; <code>node_data</code></li>
</ul>
<h2 id="checksums"><strong>Checksums</strong></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.0.0.el7.x86_64.tgz) = 9ff3c973fa5915f65622b91419817c9b
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.0.0.el8.x86_64.tgz) = bd108a6c8f026cb79ee62c3b68b72176
</span></span><span style="display:flex;"><span>MD5 (pigsty-pkg-v2.0.0.el9.x86_64.tgz) = e24288770f240af0511b0c38fa2f4774
</span></span></code></pre></div><p>Special thanks to @alemacci for his great contribution!</p>
<hr>
<h1 id="v201">v2.0.1</h1>
<p>Bug fix for <a href="https://github.com/Vonng/pigsty/releases/tag/v2.0.0">v2.0.0</a> and security improvement.</p>
<p><strong>Enhancement</strong></p>
<ul>
<li>Replace the pig shape logo for compliance with the PostgreSQL trademark policy.</li>
<li>Bump grafana version to v9.4 with better UI and bugfix.</li>
<li>Bump patroni version to v3.0.1 with some bugfix.</li>
<li>Change: rollback grafana systemd service file to rpm default.</li>
<li>Use slow <code>copy</code> instead of <code>rsync</code> to copy grafana dashboards.</li>
<li>Enhancement: add back default repo files after bootstrap</li>
<li>Add asciinema video for various administration tasks.</li>
<li>Security Enhance Mode: restrict monitor user privilege.</li>
<li>New config template: <code>dual.yml</code> for two-node deployment.</li>
<li>Enable <code>log_connections</code> and <code>log_disconnections</code> in <code>crit.yml</code> template.</li>
<li>Enable <code>$lib/passwordcheck</code> in <code>pg_libs</code> in <code>crit.yml</code> template.</li>
<li>Explicitly grant monitor view permission to <code>pg_monitor</code> role.</li>
<li>Remove default <code>dbrole_readonly</code> from <code>dbuser_monitor</code> to limit monitor user privilege</li>
<li>Now patroni listen on <code>{{ inventory_hostname }}</code> instead of <code>0.0.0.0</code></li>
<li>Now you can control postgres/pgbouncer listen to address with <code>pg_listen</code></li>
<li>Now you can use placeholder <code>${ip}</code>, <code>${lo}</code>, <code>${vip}</code> in <code>pg_listen</code></li>
<li>Bump Aliyun terraform image to rocky Linux 9 instead of centos 7.9</li>
<li>Bump bytebase to v1.14.0</li>
</ul>
<p><strong>Bug Fixes</strong></p>
<ul>
<li>Add missing advertise address for alertmanager</li>
<li>Fix missing <code>pg_mode</code> error when adding postgres user with <code>bin/pgsql-user</code></li>
<li>Add <code>-a password</code> to redis-join task @ <code>redis.yml</code></li>
<li>Fix missing default value in <code>infra-rm.yml</code>.<code>remove infra data</code></li>
<li>Fix prometheus targets file ownership to <code>prometheus</code></li>
<li>Use admin user rather than root to delete metadata in DCS</li>
<li>Fix Meta datasource missing database name due to grafana 9.4 bug.</li>
</ul>
<p><strong>Caveats</strong></p>
<p>Official EL8 pgdg upstream is broken now, DO use it with caution!</p>
<p>Affected packages: <code>postgis33_15, pgloader, postgresql_anonymizer_15*, postgresql_faker_15</code></p>
<p><strong>How to Upgrade</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty<span style="color:#000;font-weight:bold">;</span> tar -zcf /tmp/files.tgz files<span style="color:#000;font-weight:bold">;</span> rm -rf ~/pigsty    <span style="color:#8f5902;font-style:italic"># backup files dir and remove</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~<span style="color:#000;font-weight:bold">;</span> bash -c <span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">$(</span>curl -fsSL https://get.pigsty.cc/latest<span style="color:#204a87;font-weight:bold">)</span><span style="color:#4e9a06">&#34;</span>    <span style="color:#8f5902;font-style:italic"># get latest pigsty source</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> ~/pigsty<span style="color:#000;font-weight:bold">;</span> rm -rf files<span style="color:#000;font-weight:bold">;</span> tar -xf /tmp/files.tgz -C ~/pigsty  <span style="color:#8f5902;font-style:italic"># restore files dir</span>
</span></span></code></pre></div><p><strong>Checksums</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.1.el7.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 5cfbe98fd9706b9e0f15c1065971b3f6
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.1.el8.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> c34aa460925ae7548866bf51b8b8759c
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.1.el9.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 055057cebd93c473a67fb63bcde22d33
</span></span></code></pre></div><p>Special thanks to <a href="https://github.com/cocoonkid">@cocoonkid</a> for his feedback.</p>
<hr>
<h2 id="v202">v2.0.2</h2>
<p><strong>Highlight</strong></p>
<p>Store OpenAI embedding and search similar vectors with <a href="https://github.com/pgvector/pgvector"><code>pgvector</code></a></p>
<ul>
<li>New extension <a href="https://github.com/Vonng/pigsty/issues/267"><code>pgvector</code></a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/265">MinIO CVE-2023-28432</a> fix, and upgrade to 20230324 with new policy API:</li>
</ul>
<p><strong>Changes</strong></p>
<ul>
<li>New extension <a href="https://github.com/Vonng/pigsty/issues/267"><code>pgvector</code></a> for storing OpenAI embedding and searching similar vectors.</li>
<li><a href="https://github.com/Vonng/pigsty/issues/265">MinIO CVE-2023-28432</a> fix, and upgrade to 20230324 with new policy API.</li>
<li>Add reload functionality to DNSMASQ systemd services</li>
<li>Bump pev to v1.8</li>
<li>Bump grafana to v9.4.7</li>
<li>Bump MinIO and MCLI version to 20230324</li>
<li>Bump bytebase version to v1.15.0</li>
<li>Upgrade monitoring dashboards and fix dead links</li>
<li>Upgrade aliyun terraform template image to rockylinux 9</li>
<li>Adopt grafana provisioning API change since v9.4</li>
<li>Add asciinema videos for various administration tasks</li>
<li>Fix broken EL8 pgsql deps: remove anonymizer_15 faker_15 and pgloader</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.2.el7.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> d46440a115d741386d29d6de646acfe2
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.2.el8.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> 5fa268b5545ac96b40c444210157e1e1
</span></span><span style="display:flex;"><span>MD5 <span style="color:#ce5c00;font-weight:bold">(</span>pigsty-pkg-v2.0.2.el9.x86_64.tgz<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> c8b113d57c769ee86a22579fc98e8345
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-81dacd29684b0b4454631f9f21450afb">v1.5.0 Release Note</h1>
	<div class="lead">Docker Support, Infra self-monitoring, etcd as DCS, CMDB reforge</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2022-05-19" class="text-muted">2022-05-19</time>
        
	</div>
	<hr>
<h2 id="v150">v1.5.0</h2>
<h2 id="highlights">Highlights</h2>
<ul>
<li>Complete Docker Support, enable on meta nodes by default with lot&rsquo;s of software templates.
<ul>
<li>bytebase pgadmin4 pgweb postgrest kong minio,&hellip;</li>
</ul>
</li>
<li>Infra Self Monitoring: Nginx, ETCD, Consul, Grafana, Prometheus, Loki, etc&hellip;</li>
<li>New CMDB design compatible with redis &amp; greenplum, visualize with CMDB Overview</li>
<li>Service Discovery : Consul SD now works again for prometheus targets management</li>
<li>Redis playbook now works on single instance with <code>redis_port</code> option.</li>
<li>Better cold backup support: crontab for backup, delayed standby with <code>pg_delay</code></li>
<li>Use ETCD as DCS, alternative to Consul</li>
</ul>
<h2 id="monitoring">Monitoring</h2>
<p><strong>Dashboards</strong></p>
<ul>
<li>CMDB Overview: Visualize CMDB Inventory</li>
<li>DCS Overview: Show consul &amp; etcd metrics</li>
<li>Nginx Overview: Visualize nginx metrics &amp; access/error logs</li>
<li>Grafana Overview: Grafana self Monitoring</li>
<li>Prometheus Overview: Prometheus self Monitoring</li>
<li>INFRA Dashboard &amp; Home Dashboard Reforge</li>
</ul>
<p><strong>Architecture</strong></p>
<ul>
<li>Infra monitoring targets now have a separated target dir <code>targets/infra</code></li>
<li>Consul SD is available for prometheus</li>
<li>etcd , consul , patroni, docker metrics</li>
<li>Now infra targets are managed by role <code>infra_register</code></li>
<li>Upgrade pg_exporter to v0.5.0 with <code>scale</code> and <code>default</code> support
<ul>
<li><code>pg_bgwriter</code>, <code>pg_wal</code>, <code>pg_query</code>, <code>pg_db</code>, <code>pgbouncer_stat</code> now use seconds instead of ms and µs</li>
<li><code>pg_table</code> counters now have default value 0 instead of NaN</li>
<li><code>pg_class</code> is replaced by <code>pg_table</code> and <code>pg_index</code></li>
<li><code>pg_table_size</code> is now enabled with 300s ttl</li>
</ul>
</li>
</ul>
<h2 id="provisioning">Provisioning</h2>
<ul>
<li>New optional package <code>docker.tgz</code> contains: Pgadmin, Pgweb, Postgrest, ByteBase, Kong, Minio, etc.</li>
<li>New Role <code>etcd</code> to deploy &amp; monitor etcd dcs service</li>
<li>Specify which type of DCS to use with <code>pg_dcs_type</code> (<code>etcd</code> now available)</li>
<li>Add <code>pg_checksum</code> option to enable data checksum</li>
<li>Add <code>pg_delay</code> option to setup delayed standby leaders</li>
<li>Add <code>node_crontab</code> and <code>node_crontab_overwrite</code> to create routine jobs such as cold backup</li>
<li>Add a series of <code>*_enable</code> options to control  components</li>
<li>Loki and Promtail are now installed using the RPM package made by <code>frpm</code>.</li>
</ul>
<p><strong>Software Updates</strong></p>
<ul>
<li>Upgrade PostgreSQL to 14.3</li>
<li>Upgrade Redis to 6.2.7</li>
<li>Upgrade PG Exporter to 0.5.0</li>
<li>Upgrade Consul to 1.12.0</li>
<li>Upgrade vip-manager to v1.0.2</li>
<li>Upgrade Grafana to v8.5.2</li>
<li>Upgrade HAproxy to 2.5.7 without rsyslog dependency</li>
<li>Upgrade Loki &amp; Promtail to v2.5.0 with RPM packages</li>
<li>New packages: <code>pg_probackup</code></li>
</ul>
<p>New software / application based on docker:</p>
<ul>
<li>bytebase : DDL Schema Migrator</li>
<li>pgadmin4 : Web Admin UI for PostgreSQL</li>
<li>pgweb : Web Console for PostgreSQL</li>
<li>postgrest : Auto generated REST API for PostgreSQL</li>
<li>kong : API Gateway which use PostgreSQL as backend storage</li>
<li>swagger openapi : API Specification Generator</li>
<li>Minio : S3-compatible object storage</li>
</ul>
<h2 id="bug-fix">Bug Fix</h2>
<ul>
<li>Fix loki &amp; promtail <code>/etc/default</code> config file name issue</li>
<li>Now <code>node_data_dir (/data)</code> is created before consul init if not exists</li>
<li>Fix haproxy silence <code>/var/log/messages</code> with inappropriate rsyslog dependency</li>
</ul>
<h2 id="api-change">API Change</h2>
<p><strong>New Variable</strong></p>
<ul>
<li><code>node_data_dir</code> : major data mount path, will be created if not exist.</li>
<li><code>node_crontab_overwrite</code> : overwrite <code>/etc/crontab</code> instead of append</li>
<li><code>node_crontab</code>: node crontab to be appended or overwritten</li>
<li><code>nameserver_enabled</code>: enable nameserver on this meta node?</li>
<li><code>prometheus_enabled</code>: enable prometheus on this meta node?</li>
<li><code>grafana_enabled</code>: enable grafana on this meta node?</li>
<li><code>loki_enabled</code>: enable loki on this meta node?</li>
<li><code>docker_enable</code>: enable docker on this node?</li>
<li><code>consul_enable</code>: enable consul server/agent?</li>
<li><code>etcd_enable</code>: enable etcd server/clients?</li>
<li><code>pg_checksum</code>: enable pg cluster data-checksum?</li>
<li><code>pg_delay</code>: recovery min apply delay for standby leader</li>
</ul>
<p><strong>Reforge</strong></p>
<p>Now <code>*_clean</code> are boolean flags to clean up existing instance during init.</p>
<p>And <code>*_safeguard</code> are boolean flags to avoid purging running instance when executing any playbook.</p>
<ul>
<li><code>pg_exists_action</code> -&gt; <code>pg_clean</code></li>
<li><code>pg_disable_purge</code> -&gt; <code>pg_safeguard</code></li>
<li><code>dcs_exists_action</code> -&gt; <code>dcs_clean</code></li>
<li><code>dcs_disable_purge</code> -&gt; <code>dcs_safeguard</code></li>
</ul>
<p><strong>Rename</strong></p>
<ul>
<li><code>node_ntp_config</code> -&gt; <code>node_ntp_enabled</code></li>
<li><code>node_admin_setup</code> -&gt; <code>node_admin_enabled</code></li>
<li><code>node_admin_pks</code> -&gt; <code>node_admin_pk_list</code></li>
<li><code>node_dns_hosts</code> -&gt; <code>node_etc_hosts_default</code></li>
<li><code>node_dns_hosts_extra</code> -&gt; <code>node_etc_hosts</code></li>
<li><code>node_dns_server</code> -&gt; <code>node_dns_method</code></li>
<li><code>node_local_repo_url</code> -&gt; <code>node_repo_local_urls</code></li>
<li><code>node_packages</code> -&gt; <code>node_packages_default</code></li>
<li><code>node_extra_packages</code> -&gt; <code>node_packages</code></li>
<li><code>node_packages_meta</code> -&gt; <code>node_packages_meta</code></li>
<li><code>node_meta_pip_install</code> -&gt; <code>node_packages_meta_pip</code></li>
<li><code>node_sysctl_params</code> -&gt; <code>node_tune_params</code></li>
<li><code>app_list</code> -&gt; <code>nginx_indexes</code></li>
<li><code>grafana_plugin</code> -&gt; <code>grafana_plugin_method</code></li>
<li><code>grafana_cache</code> -&gt; <code>grafana_plugin_cache</code></li>
<li><code>grafana_plugins</code> -&gt; <code>grafana_plugin_list</code></li>
<li><code>grafana_git_plugin_git</code> -&gt; <code>grafana_plugin_git</code></li>
<li><code>haproxy_admin_auth_enabled</code> -&gt; <code>haproxy_auth_enabled</code></li>
<li><code>pg_shared_libraries</code> -&gt; <code>pg_libs</code></li>
<li><code>dcs_type</code> -&gt; <code>pg_dcs_type</code></li>
</ul>
<hr>
<h2 id="v151">v1.5.1</h2>
<h2 id="highlights-1">Highlights</h2>
<p>WARNING: <code>CREATE INDEX|REINDEX CONCURRENTLY</code> PostgreSQL 14.0 - 14.3 may lead to index data corruption!</p>
<p>Please upgrade postgres to 14.4 ASAP.</p>
<h3 id="software-upgrade">Software Upgrade</h3>
<ul>
<li>upgrade postgres to 14.4</li>
<li>Upgrade haproxy to 2.6.0</li>
<li>Upgrade grafana to 9.0.0</li>
<li>Upgrade prometheus 2.36.0</li>
<li>Upgrade patroni to 2.1.4</li>
</ul>
<h3 id="bug-fix-1">Bug fix:</h3>
<ul>
<li>Fix typo in <code>pgsql-migration.yml</code></li>
<li>remove pid file in haproxy config</li>
<li>remove i686 packages when using repotrack under el7</li>
<li>Fix redis service systemctl enabled issue</li>
<li>Fix patroni systemctl service enabled=no by default issue</li>
</ul>
<h3 id="api-changes">API Changes</h3>
<ul>
<li>Mark <code>grafana_database</code> and <code>grafana_pgurl</code> as obsolete</li>
</ul>
<h3 id="new-apps">New Apps</h3>
<ul>
<li>wiki.js : Local wiki with Postgres</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-434178e5fe8c53371b4d97db657374b7">v1.4.0 Release Note</h1>
	<div class="lead">Add matrixDB Support</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2022-03-31" class="text-muted">2022-03-31</time>
        
	</div>
	<hr>
<h2 id="v140">v1.4.0</h2>
<p><strong>Architecture</strong></p>
<ul>
<li>Decouple system into 4 major categories:  <code>INFRA</code>, <code>NODES</code>, <code>PGSQL</code>, <code>REDIS</code>, which makes pigsty far more clear and more extensible.</li>
<li>Single Node Deployment = <code>INFRA</code> + <code>NODES</code> + <code>PGSQL</code></li>
<li>Deploy pgsql clusters = <code>NODES</code> + <code>PGSQL</code></li>
<li>Deploy redis clusters = <code>NODES</code> + <code>REDIS</code></li>
<li>Deploy other databases = <code>NODES</code> + xxx (e.g <code>MONGO</code>, <code>KAFKA</code>, &hellip; TBD)</li>
</ul>
<p><strong>Accessibility</strong></p>
<ul>
<li>CDN for mainland China.</li>
<li>Get the latest source with <code>bash -c &quot;$(curl -fsSL http://download.pigsty.cc/get)&quot;</code></li>
<li>Download &amp; Extract packages with new <code>download</code> script.</li>
</ul>
<p><strong>Monitor Enhancement</strong></p>
<ul>
<li>Split monitoring system into 5 major categories:  <code>INFRA</code>, <code>NODES</code>, <code>REDIS</code>, <code>PGSQL</code>, <code>APP</code></li>
<li>Logging enabled by default
<ul>
<li>now <code>loki</code> and <code>promtail</code> are enabled by default. with prebuilt <a href="https://github.com/Vonng/loki-rpm">loki-rpm</a></li>
</ul>
</li>
<li>Models &amp; Labels
<ul>
<li>A hidden <code>ds</code> prometheus datasource variable is added for all dashboards, so you can easily switch different datasource simply by select a new one rather than modifying Grafana Datasources &amp; Dashboards</li>
<li>An <code>ip</code> label is added for all metrics, and will be used as join key between database metrics &amp; nodes metrics</li>
</ul>
</li>
<li>INFRA Monitoring
<ul>
<li>Home dashboard for infra: INFRA Overview</li>
<li>Add logging Dashboards : Logs Instance</li>
<li>PGLOG Analysis &amp; PGLOG Session now treated as an example Pigsty APP.</li>
</ul>
</li>
<li>NODES Monitoring Application
<ul>
<li>If you don&rsquo;t care database at all, Pigsty now can be used as host monitoring software alone!</li>
<li>Consist of 4 core dashboards: Nodes Overview &amp; Nodes Cluster &amp; Nodes Instance &amp; Nodes Alert</li>
<li>Introduce new identity variables for nodes: <code>node_cluster</code> and <code>nodename</code></li>
<li>Variable <code>pg_hostname</code> now means set hostname same as postgres instance name to keep backward-compatible</li>
<li>Variable <code>nodename_overwrite</code> control whether overwrite node&rsquo;s hostname with nodename</li>
<li>Variable <code>nodename_exchange</code> will write nodename to each other&rsquo;s <code>/etc/hosts</code></li>
<li>All nodes metrics reference are overhauled, join by <code>ip</code></li>
<li>Nodes monitoring targets are managed alone under <code>/etc/prometheus/targets/nodes</code></li>
</ul>
</li>
<li>PGSQL Monitoring Enhancement
<ul>
<li>Complete new PGSQL Cluster which simplify and focus on important stuff among cluster.</li>
<li>New Dashboard PGSQL Databases which is cluster level object monitoring. Such as tables &amp; queries among the entire cluster rather than single instance.</li>
<li>PGSQL Alert dashboard now only focus on pgsql alerts.</li>
<li>PGSQL Shard are added to PGSQL</li>
</ul>
</li>
<li>Redis Monitoring Enhancement
<ul>
<li>Add nodes monitoring for all redis dashboards.</li>
</ul>
</li>
</ul>
<p><strong>MatrixDB Support</strong></p>
<ul>
<li>MatrixDB (Greenplum 7) can be deployed via <code>pigsty-matrix.yml</code> playbook</li>
<li>MatrixDB Monitor Dashboards : PGSQL MatrixDB</li>
<li>Example configuration added: <code>pigsty-mxdb.yml</code></li>
</ul>
<h2 id="provisioning-enhancement">Provisioning Enhancement</h2>
<p>Now pigsty work flow works as this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> infra.yml ---&gt; install pigsty on single meta node
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">|</span>          <span style="color:#204a87;font-weight:bold">then</span> add more nodes under pigsty<span style="color:#a40000">&#39;</span>s management
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span> nodes.yml ---&gt; prepare nodes <span style="color:#204a87;font-weight:bold">for</span> pigsty <span style="color:#ce5c00;font-weight:bold">(</span>node setup, dcs, node_exporter, promtail<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">|</span>          <span style="color:#204a87;font-weight:bold">then</span> choose one playbook to deploy database clusters on those nodes
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span>      ^--&gt; pgsql.yml   install postgres on prepared nodes
</span></span><span style="display:flex;"><span>      ^--&gt; redis.yml   install redis on prepared nodes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>infra-demo.yml <span style="color:#ce5c00;font-weight:bold">=</span> 
</span></span><span style="display:flex;"><span>           infra.yml -l meta     +
</span></span><span style="display:flex;"><span>           nodes.yml -l pg-test  +
</span></span><span style="display:flex;"><span>           pgsql.yml -l pg-test +
</span></span><span style="display:flex;"><span>           infra-loki.yml + infra-jupyter.yml + infra-pgweb.yml
</span></span><span style="display:flex;"><span> 
</span></span></code></pre></div><ul>
<li><code>nodes.yml</code> to setup &amp; prepare nodes for pigsty
<ul>
<li>setup node, node_exporter, consul agent on nodes</li>
<li><code>node-remove.yml</code> are used for node de-register</li>
</ul>
</li>
<li><code>pgsql.yml</code> now only works on prepared nodes
<ul>
<li><code>pgsql-remove</code> now  only responsible for postgres itself. (dcs and node monitor are taken by <code>node.yml</code>)</li>
<li>Add a series of new options to reuse <code>postgres</code> role in greenplum/matrixdb</li>
</ul>
</li>
<li><code>redis.yml</code> now works on prepared nodes
<ul>
<li>and <code>redis-remove.yml</code> now remove redis from nodes.</li>
</ul>
</li>
<li><code>pgsql-matrix.yml</code> now install matrixdb (Greenplum 7) on prepared nodes.</li>
</ul>
<p><strong>Software Upgrade</strong></p>
<ul>
<li>PostgreSQL  14.2</li>
<li>PostGIS 3.2</li>
<li>TimescaleDB 2.6</li>
<li>Patroni 2.1.3 (Prometheus Metrics + Failover Slots)</li>
<li>HAProxy 2.5.5  (Fix stats error, more metrics)</li>
<li>PG Exporter 0.4.1 (Timeout Parameters, and)</li>
<li>Grafana 8.4.4</li>
<li>Prometheus 2.33.4</li>
<li>Greenplum 6.19.4 / MatrixDB 4.4.0</li>
<li>Loki are now shipped as rpm packages instead of zip archives</li>
</ul>
<p><strong>Bug Fix</strong></p>
<ul>
<li>Remove consul dependency for patroni , which makes it much more easier to migrate to a new consul cluster</li>
<li>Fix prometheus bin/new scripts default data dir path : <code>/export/prometheus</code> to <code>/data/prometheus</code></li>
<li>Fix typos and tasks</li>
<li>Add restart seconds to vip-manager systemd service</li>
</ul>
<p><strong>API Changes</strong></p>
<p>New Variable</p>
<ul>
<li><code>node_cluster</code>: Identity variable for node cluster</li>
<li><code>nodename_overwrite</code>: If set, nodename will be set to node&rsquo;s hostname</li>
<li><code>nodename_exchange</code> : exchange node hostname (in <code>/etc/hosts</code>) among play hosts</li>
<li><code>node_dns_hosts_extra</code> : extra static dns records which can be easily overwritten by single instance/cluster</li>
<li><code>patroni_enabled</code>: if disabled, postgres &amp; patroni bootstrap will not be performed during role <code>postgres</code></li>
<li><code>pgbouncer_enabled</code> : if disabled, pgbouncer will not be launched during role <code>postgres</code></li>
<li><code>pg_exporter_params</code>: extra url parameters for pg_exporter when generating monitor target url.</li>
<li><code>pg_provision</code>: bool var to indicate whether perform provision part of role <code>postgres</code> (template, db,user)</li>
<li><code>no_cmdb</code>: cli args for <code>infra.yml</code> and <code>infra-demo.yml</code> playbook which will not create cmdb on meta node.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>MD5 (app.tgz) = f887313767982b31a2b094e5589a75ea
</span></span><span style="display:flex;"><span>MD5 (matrix.tgz) = 3d063437c482d94bd7e35df1a08bbc84
</span></span><span style="display:flex;"><span>MD5 (pigsty.tgz) = e143b88ebea1474f9ebaffddc6072c49
</span></span><span style="display:flex;"><span>MD5 (pkg.tgz) = 73e8f5ce995b1f1760cb63c1904fb91b
</span></span></code></pre></div><hr>
<h2 id="v141">v1.4.1</h2>
<p>Routine bug fix / Docker Support / English Docs</p>
<p>Now docker is enabled on meta node by default. You can launch ton&rsquo;s of SaaS with it</p>
<p>English document is available now.</p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/commit/68f8c8da0576e043686137aca47bad01dd4e82c0">add docker to default packages</a></li>
<li><a href="https://github.com/Vonng/pigsty/commit/765077744836d8600a8703dce8623182784d65a7">add docker-compose to default pacakge list</a></li>
<li><a href="https://github.com/Vonng/pigsty/commit/9b8b7c5209d09049716318b624001de3b567452a">disable nameserver by default &amp; enable docker role by default</a></li>
</ul>
<p><strong>Bug Fix</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/commit/100f31842d473001f946200d9b8e2e3e89add35a">fix promtail &amp; loki config var issue</a></li>
<li>Fix grafana legacy alerts.</li>
<li>Disable nameserver by default</li>
<li>Rename pg-alias.sh for patroni shortcuts</li>
<li><a href="https://github.com/Vonng/pigsty/commit/62d74f15f8c164e5971d9d1d1215869359267b53">disable exemplars queries for all dashboards</a></li>
<li><a href="https://github.com/Vonng/pigsty/commit/b277f488b7ed0fd0a7eeeb995e2efd75a048e0ef">fix loki data dir issue</a> <a href="https://github.com/Vonng/pigsty/issues/100">https://github.com/Vonng/pigsty/issues/100</a></li>
<li><a href="https://github.com/Vonng/pigsty/commit/1690b490205af24d5f0394aba99007c0d9ebc49d">change autovacuum_freeze_max_age from 100000000 to 1000000000</a></li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-a0fb8b384cade6ec407c2453f1e2d292">v1.3.0 Release Note</h1>
	<div class="lead">Redis Support, PGCAT Overhaul</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2021-11-30" class="text-muted">2021-11-30</time>
        
	</div>
	<hr>
<h2 id="130">1.3.0</h2>
<ul>
<li>
<p>[ENHANCEMENT] Redis Deployment (cluster,sentinel,standalone)</p>
</li>
<li>
<p>[ENHANCEMENT] Redis Monitor</p>
<ul>
<li>Redis Overview Dashboard</li>
<li>Redis Cluster Dashboard</li>
<li>Redis Instance Dashboard</li>
</ul>
</li>
<li>
<p>[ENHANCEMENT] monitor: PGCAT Overhaul</p>
<ul>
<li>New Dashboard: PGCAT Instance</li>
<li>New Dashboard: PGCAT Database Dashboard</li>
<li>Remake Dashboard: PGCAT Table</li>
</ul>
</li>
<li>
<p>[ENHANCEMENT] monitor: PGSQL Enhancement</p>
<ul>
<li>New Panels: PGSQL Cluster, add 10 key metrics panel (toggled by default)</li>
<li>New Panels: PGSQL Instance, add 10 key metrics panel (toggled by default)</li>
<li>Simplify &amp; Redesign: PGSQL Service</li>
<li>Add cross-references between PGCAT &amp; PGSL dashboards</li>
</ul>
</li>
<li>
<p>[ENHANCEMENT] monitor deploy</p>
<ul>
<li>Now grafana datasource is automatically registered during monly deployment</li>
</ul>
</li>
<li>
<p>[ENHANCEMENT] software upgrade</p>
<ul>
<li>add PostgreSQL 13 to default package list</li>
<li>upgrade to PostgreSQL 14.1 by default</li>
<li>add greenplum rpm and dependencies</li>
<li>add redis rpm &amp; source packages</li>
<li>add perf as default packages</li>
</ul>
</li>
</ul>
<hr>
<h2 id="v131">v1.3.1</h2>
<p>[Monitor]</p>
<ul>
<li>PGSQL &amp; PGCAT Dashboard polish</li>
<li>optimize layout for pgcat instance &amp; pgcat database</li>
<li>add key metrics panels to pgsql instance dashboard, keep consist with pgsql cluster</li>
<li>add table/index bloat panels to pgcat database, remove pgcat bloat dashboard.</li>
<li>add index information in pgcat database dashboard</li>
<li>fix broken panels in grafana 8.3</li>
<li>add redis index in nginx homepage</li>
</ul>
<p>[Deploy]</p>
<ul>
<li>New <code>infra-demo.yml</code> playbook for one-pass bootstrap</li>
<li>Use <code>infra-jupyter.yml</code> playbook to deploy optional jupyter lab server</li>
<li>Use <code>infra-pgweb.yml</code> playbook to deploy optional pgweb server</li>
<li>New <code>pg</code> alias on meta node, can initiate postgres cluster from admin user (in addition to postgres)</li>
<li>Adjust all patroni conf templates&rsquo;s <code>max_locks_per_transactions</code> according to <code>timescaledb-tune</code> &rsquo;s advise</li>
<li>Add <code>citus.node_conninfo: 'sslmode=prefer'</code> to conf templates in order to use citus without SSL</li>
<li>Add all extensions (except for pgrouting) in pgdg14 in package list</li>
<li>Upgrade node_exporter to v1.3.1</li>
<li>Add PostgREST v9.0.0 to package list. Generate API from postgres schema.</li>
</ul>
<p>[BugFix]</p>
<ul>
<li>Grafana&rsquo;s security breach (upgrade to v8.3.1 <a href="https://grafana.com/blog/2021/12/07/grafana-8.3.1-8.2.7-8.1.8-and-8.0.7-released-with-high-severity-security-fix/">issue</a>)</li>
<li>fix <code>pg_instance</code> &amp; <code>pg_service</code> in <code>register</code> role when start from middle of playbook</li>
<li>Fix nginx homepage render issue when host without <code>pg_cluster</code> variable exists</li>
<li>Fix style issue when upgrading to grafana 8.3.1</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d2b8bcedf0eac31226e2b7f3dcba7d8a">v1.2.0 Release Note</h1>
	<div class="lead">Redis Support, PGCAT Overhaul</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2021-11-03" class="text-muted">2021-11-03</time>
        
	</div>
	<hr>
<h2 id="v120">v1.2.0</h2>
<ul>
<li>[ENHANCEMENT] Use PostgreSQL 14 as default version</li>
<li>[ENHANCEMENT] Use TimescaleDB 2.5 as default extension
<ul>
<li>now timescaledb &amp; postgis are enabled in cmdb by default</li>
</ul>
</li>
<li>[ENHANCEMENT] new monitor-only mode:
<ul>
<li>you can use pigsty to monitor existing pg instances with a connectable url only</li>
<li>pg_exporter will be deployed on meta node locally</li>
<li>new dashboard PGSQL Cluster Monly for remote clusters</li>
</ul>
</li>
<li>[ENHANCEMENT] Software upgrade
<ul>
<li>grafana to 8.2.2</li>
<li>pev2 to v0.11.9</li>
<li>promscale to 0.6.2</li>
<li>pgweb to 0.11.9</li>
<li>Add new extensions: pglogical pg_stat_monitor orafce</li>
</ul>
</li>
<li>[ENHANCEMENT] Automatic detect machine spec and use proper <code>node_tune</code> and <code>pg_conf</code> templates</li>
<li>[ENHANCEMENT] Rework on bloat related views, now more information are exposed</li>
<li>[ENHANCEMENT] Remove timescale &amp; citus internal monitoring</li>
<li>[ENHANCEMENT] New playbook <code>pgsql-audit.yml</code> to create audit report.</li>
<li>[BUG FIX] now pgbouncer_exporter resource owner are {{ pg_dbsu }} instead of postgres</li>
<li>[BUG FIX] fix pg_exporter duplicate metrics on pg_table pg_index while executing <code>REINDEX TABLE CONCURRENTLY</code></li>
<li>[CHANGE] now all config templates are minimize into two: auto &amp; demo. (removed: <code>pub4, pg14, demo4, tiny, oltp</code> )
<ul>
<li><code>pigsty-demo</code> is configured if <code>vagrant</code> is the default user, otherwise <code>pigsty-auto</code> is used.</li>
</ul>
</li>
</ul>
<p><strong>How to upgrade from v1.1.1</strong></p>
<p>There&rsquo;s no API change in 1.2.0 You can still use old <code>pigsty.yml</code> configuration files (PG13).</p>
<p>For the infrastructure part. Re-execution of <code>repo</code> will do most of the parts</p>
<p>As for the database. You can still use the existing PG13 instances. In-place upgrade is quite
tricky especially when involving extensions such as PostGIS &amp; Timescale. I would highly recommend
performing a database migration with logical replication.</p>
<p>The new playbook <code>pgsql-migration.yml</code> will make this a lot easier. It will create a series of
scripts which will help you to migrate your cluster with near-zero downtime.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-854c111b55099c9d05d054f2e73a5cbf">v1.1.0 Release Note</h1>
	<div class="lead">v1.1.0 Release</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2021-10-12" class="text-muted">2021-10-12</time>
        
	</div>
	<hr>
<h2 id="v110">v1.1.0</h2>
<ul>
<li>[ENHANCEMENT] add <code>pg_dummy_filesize</code> to create fs space placeholder</li>
<li>[ENHANCEMENT] home page overhaul</li>
<li>[ENHANCEMENT] add jupyter lab integration</li>
<li>[ENHANCEMENT] add pgweb console integration</li>
<li>[ENHANCEMENT] add pgbadger support</li>
<li>[ENHANCEMENT] add pev2 support, explain visualizer</li>
<li>[ENHANCEMENT] add pglog utils</li>
<li>[ENHANCEMENT] update default pkg.tgz software version:
<ul>
<li>upgrade postgres to v13.4  (with official pg14 support)</li>
<li>upgrade pgbouncer to v1.16 (metrics definition updates)</li>
<li>upgrade grafana to v8.1.4</li>
<li>upgrade prometheus to v2.2.29</li>
<li>upgrade node_exporter to v1.2.2</li>
<li>upgrade haproxy to v2.1.1</li>
<li>upgrade consul to v1.10.2</li>
<li>upgrade vip-manager to v1.0.1</li>
</ul>
</li>
</ul>
<p><strong>API Changes</strong></p>
<ul>
<li>
<p><code>nginx_upstream</code> now holds different structures. (incompatible)</p>
</li>
<li>
<p>new config entries: <code>app_list</code>, render into home page&rsquo;s nav entries</p>
</li>
<li>
<p>new config entries: <code>docs_enabled</code>, setup local docs on default server.</p>
</li>
<li>
<p>new config entries: <code>pev2_enabled</code>, setup local pev2 utils.</p>
</li>
<li>
<p>new config entries: <code>pgbadger_enabled</code>, create log summary/report dir</p>
</li>
<li>
<p>new config entries: <code>jupyter_enabled</code>, enable jupyter lab server on meta node</p>
</li>
<li>
<p>new config entries: <code>jupyter_username</code>, specify which user to run jupyter lab</p>
</li>
<li>
<p>new config entries: <code>jupyter_password</code>, specify jupyter lab default password</p>
</li>
<li>
<p>new config entries: <code>pgweb_enabled</code>, enable pgweb server on meta node</p>
</li>
<li>
<p>new config entries: <code>pgweb_username</code>, specify which user to run pgweb</p>
</li>
<li>
<p>rename internal flag <code>repo_exist</code> into <code>repo_exists</code></p>
</li>
<li>
<p>now default value for <code>repo_address</code> is <code>pigsty</code> instead of <code>yum.pigsty</code></p>
</li>
<li>
<p>now haproxy access point is <code>http://pigsty</code> instead of <code>http://h.pigsty</code></p>
</li>
</ul>
<hr>
<h2 id="v111">v1.1.1</h2>
<ul>
<li>[ENHANCEMENT] replace timescaledb <code>apache</code> version with <code>timescale</code> version</li>
<li>[ENHANCEMENT] upgrade prometheus to 2.30</li>
<li>[BUG FIX] now pg_exporter config dir&rsquo;s owner are {{ pg_dbsu }} instead of prometheus</li>
</ul>
<p><strong>How to upgrade from v1.1.0</strong>
The major change in this release is timescaledb. Which replace old <code>apache</code> license version with <code>timescale</code> license version</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>stop/pause postgres instance with timescaledb
</span></span><span style="display:flex;"><span>yum remove -y timescaledb_13
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>timescale_timescaledb<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">=</span>timescale_timescaledb
</span></span><span style="display:flex;"><span><span style="color:#000">baseurl</span><span style="color:#ce5c00;font-weight:bold">=</span>https://packagecloud.io/timescale/timescaledb/el/7/<span style="color:#000">$basearch</span>
</span></span><span style="display:flex;"><span><span style="color:#000">repo_gpgcheck</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gpgcheck</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span><span style="color:#000">enabled</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>yum install timescaledb-2-postgresql13 
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-794b5d90dc8a76efe53cd1189faf34ff">v1.0.0 Release Note</h1>
	<div class="lead">v1.0.0 Release</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2021-07-26" class="text-muted">2021-07-26</time>
        
	</div>
	<hr>
<h2 id="v100">v1.0.0</h2>
<h2 id="highlights">Highlights</h2>
<ul>
<li>
<p>Monitoring System Overhaul</p>
<ul>
<li>New Dashboards on Grafana 8.0</li>
<li>New metrics definition, with extra PG14 support</li>
<li>Simplified labeling system: static label set: (job, cls, ins)</li>
<li>New Alerting Rules &amp; Derived Metrics</li>
<li>Monitoring multiple database at one time</li>
<li>Realtime log search &amp; csvlog analysis</li>
<li>Link-Rich Dashboards, click graphic elements to drill-down|roll-up</li>
</ul>
</li>
<li>
<p>Architecture Changes</p>
<ul>
<li>Add citus &amp; timescaledb as part of default installation</li>
<li>Add PostgreSQL 14beta2 support</li>
<li>Simply haproxy admin page index</li>
<li>Decouple infra &amp; pgsql by adding a new role <code>register</code></li>
<li>Add new role <code>loki</code> and <code>promtail</code> for logging</li>
<li>Add new role <code>environ</code> for setting up environment for admin user on admin node</li>
<li>Using <code>static</code> service-discovery for prometheus by default (instead of <code>consul</code>)</li>
<li>Add new role <code>remove</code> to gracefully remove cluster &amp; instance</li>
<li>Upgrade prometheus &amp; grafana provisioning logics.</li>
<li>Upgrade to vip-manager 1.0 , node_exporter 1.2 , pg_exporter 0.4, grafana 8.0</li>
<li>Now every database on every instance can be auto-registered as grafana datasource</li>
<li>Move consul register tasks to role <code>register</code>, change consul service tags</li>
<li>Add cmdb.sql as pg-meta baseline definition (CMDB &amp; PGLOG)</li>
</ul>
</li>
<li>
<p>Application Framework</p>
<ul>
<li>Extensible framework for new functionalities</li>
<li>core app: PostgreSQL Monitor System: <code>pgsql</code></li>
<li>core app: PostgreSQL Catalog explorer: <code>pgcat</code></li>
<li>core app: PostgreSQL Csvlog Analyzer: <code>pglog</code></li>
<li>add example app <code>covid</code> for visualizing covid-19 data.</li>
<li>add example app <code>isd</code> for visualizing isd data.</li>
</ul>
</li>
<li>
<p>Misc</p>
<ul>
<li>Add jupyterlab which brings entire python environment for data science</li>
<li>Add <code>vonng-echarts-panel</code> to bring Echarts support back.</li>
<li>Add wrap script <code>createpg</code> , <code>createdb</code>, <code>createuser</code></li>
<li>Add cmdb dynamic inventory scripts: <code>load_conf.py</code>, <code>inventory_cmdb</code>, <code>inventory_conf</code></li>
<li>Remove obsolete playbooks: <code>pgsql-monitor</code>, <code>pgsql-service</code>, <code>node-remove</code>, etc&hellip;.</li>
</ul>
</li>
</ul>
<h2 id="api-change">API Change</h2>
<ul>
<li>new var :  <a href="http://doc.pigsty.cc/#/zh-cn/v-node?id=node_meta_pip_install"><code>node_meta_pip_install</code></a></li>
<li>rename var: <code>grafana_url</code> to <a href="http://doc.pigsty.cc/#/zh-cn/v-meta?id=grafana_endpoint"><code>grafana_endpoint</code></a></li>
<li>new var: <a href="http://doc.pigsty.cc/#/zh-cn/v-meta?id=grafana_admin_username"><code>grafana_admin_username</code></a></li>
<li>new var: <a href="http://doc.pigsty.cc/#/zh-cn/v-meta?id=grafana_database"><code>grafana_database</code></a></li>
<li>new var: <a href="http://doc.pigsty.cc/#/zh-cn/v-meta?id=grafana_pgurl"><code>grafana_pgurl</code></a></li>
<li>new var: <a href="http://doc.pigsty.cc/#/zh-cn/v-pg-provision?id=pg_shared_libraries"><code>pg_shared_libraries</code></a></li>
<li>new var: <a href="http://doc.pigsty.cc/#/zh-cn/v-monitor?id=pg_exporter_auto_discovery"><code>pg_exporter_auto_discovery</code></a></li>
<li>new var: <a href="http://doc.pigsty.cc/#/zh-cn/v-monitor?id=pg_exporter_exclude_database"><code>pg_exporter_exclude_database</code></a></li>
<li>new var: <a href="http://doc.pigsty.cc/#/zh-cn/v-monitor?id=pg_exporter_include_database"><code>pg_exporter_include_database</code></a></li>
</ul>
<h2 id="bug-fix">Bug Fix</h2>
<ul>
<li>Fix default timezone Asia/Shanghai (CST) issue</li>
<li>Fix nofile limit for pgbouncer &amp; patroni</li>
<li>Pgbouncer userlist &amp; database list will be generated when executing tag <code>pgbouncer</code></li>
</ul>
<hr>
<h2 id="v101">v1.0.1</h2>
<p>2021-09-14</p>
<ul>
<li>Documentation Update
<ul>
<li>Chinese document now viable</li>
<li>Machine-Translated English document now viable</li>
</ul>
</li>
<li>Bug Fix: <code>pgsql-remove</code> does not remove primary instance.</li>
<li>Bug Fix: replace pg_instance with pg_cluster + pg_seq
<ul>
<li>Start-At-Task may fail due to pg_instance undefined</li>
</ul>
</li>
<li>Bug Fix: remove citus from default shared preload library
<ul>
<li>citus will force max_prepared_transaction to non-zero value</li>
</ul>
</li>
<li>Bug Fix: ssh sudo checking in <code>configure</code>:
<ul>
<li>now <code>ssh -t sudo -n ls</code> is used for privilege checking</li>
</ul>
</li>
<li>Typo Fix: <code>pg-backup</code> script typo</li>
<li>Alert Adjust: Remove ntp sanity check alert (dupe with ClockSkew)</li>
<li>Exporter Adjust: remove collector.systemd to reduce overhead</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-53940fb31dd185924dcbf98876521bbc">v0.9.0 Release Note</h1>
	<div class="lead">v0.9 accessbility enhancement, logging improvement, pigsty CLI/GUI beta</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2021-05-05" class="text-muted">2021-05-05</time>
        
	</div>
	<hr>
<h2 id="pigsty-v090">Pigsty v0.9.0</h2>
<h3 id="features">Features</h3>
<ul>
<li>
<p>One-Line Installation</p>
<p>Run this on meta node <code>/bin/bash -c &quot;$(curl -fsSL https://pigsty.cc/install)&quot;</code></p>
</li>
<li>
<p>MetaDB provisioning</p>
<p>Now you can use pgsql database on meta node as inventory instead of static yaml file affter bootstrap.</p>
</li>
<li>
<p>Add Loki &amp; Prometail as optinal logging collector</p>
<p>Now you can view, query, search postgres|pgbouncer|patroni logs with Grafana UI (PG Instance Log)</p>
</li>
<li>
<p>Pigsty CLI/GUI (beta)</p>
<p>Mange you pigsty deployment with much more human-friendly command line interface.</p>
</li>
</ul>
<h3 id="bug-fix">Bug Fix</h3>
<ul>
<li>Log related issues
<ul>
<li>fix <code>connection reset by peer</code> entries in postgres log caused by Haproxy health check.</li>
<li>fix <code>Connect Reset Exception</code> in patroni logs caused by haproxy health check</li>
<li>fix patroni log time format (remove mill seconds, add timezone)</li>
<li>set <code>log_min_duration_statement=1s</code> for <code>dbuser_monitor</code> to get ride of monitor logs.</li>
</ul>
</li>
<li>Fix <code>pgbouncer-create-user</code> does not handle md5 password properly</li>
<li>Fix obsolete <code>Makefile</code> entries</li>
<li>Fix node dns nameserver lost when abort during resolv.conf rewrite</li>
<li>Fix db/user template and entry not null check</li>
</ul>
<h3 id="api-change">API Change</h3>
<ul>
<li>Set default value of <code>node_disable_swap</code> to <code>false</code></li>
<li>Remove example enties of <code>node_sysctl_params</code>.</li>
<li><code>grafana_plugin</code> default <code>install</code> will now download from CDN if plugins not exists</li>
<li><code>repo_url_packages</code> now download rpm via pigsty CDN to accelerate.</li>
<li><code>proxy_env.no_proxy</code> now add pigsty CDN to <code>noproxy</code> sites.</li>
<li><code>grafana_customize</code>  set to <code>false</code> by default, enable it means install pigsty pro UI.</li>
<li><code>node_admin_pk_current</code> add current user&rsquo;s <code>~/.ssh/id_rsa.pub</code> to admin pks</li>
<li><code>loki_clean</code> whether to cleanup existing loki data during init</li>
<li><code>loki_data_dir</code> set default data dir for loki logging service</li>
<li><code>promtail_enabled</code> enabling promtail logging agent service?</li>
<li><code>promtail_clean</code> remove existing promtail status during init?</li>
<li><code>promtail_port</code> default port used by promtail, 9080 by default</li>
<li><code>promtail_status_file</code> location of promtail status file</li>
<li><code>promtail_send_url</code> endpoint of loki service which receives log data</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-1c0e38dfb9d42ffaff8ca7937ecd2e21">v0.8.0 Release Note</h1>
	<div class="lead">v0.8 service provision overhaul and general RC</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2021-03-16" class="text-muted">2021-03-16</time>
        
	</div>
	<hr>
<h2 id="pigsty-v080">Pigsty v0.8.0</h2>
<p>Pigsty now is in <strong>RC</strong> status with guaranteed API stability.</p>
<h3 id="new-features">New Features</h3>
<ul>
<li>Service provision.</li>
<li>full locale support.</li>
</ul>
<h3 id="api-changes">API Changes</h3>
<p>Role <code>vip</code> and <code>haproxy</code> are merged into <code>service</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># SERVICE PROVISION</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#------------------------------------------------------------------------------</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_weight</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># default load balance weight (instance level)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - service - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_services</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                                  </span><span style="color:#8f5902;font-style:italic"># how to expose postgres service in cluster?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># primary service will route {ip|name}:5433 to primary pgbouncer (5433-&gt;6432 rw)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">primary          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service name {{ pg_cluster }}_primary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5433</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbouncer    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 5433 route to pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/primary    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># primary health check, success when instance is primary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># select all instance as primary service candidate</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># replica service will route {ip|name}:5434 to replica pgbouncer (5434-&gt;6432 ro)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service name {{ pg_cluster }}_replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5434</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/read-only  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># read-only health check. (including primary)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># select all instance as replica service candidate</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector_backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `primary`]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># primary are used as backup server in replica service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># default service will route {ip|name}:5436 to primary postgres (5436-&gt;5432 primary)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service&#39;s actual name is {{ pg_cluster }}-{{ service.name }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># service bind ip address, * for all, vip for cluster virtual ip address</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5436</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># bind port, mandatory</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port: postgres      # target port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres|pgbouncer|port_number , pgbouncer(6432) by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_method: http      # health check method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">only http is available for now</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_port: patroni     # health check port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">patroni|pg_exporter|port_number , patroni by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/primary    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># health check url path, / as default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_code</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">200</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># health check http code, 200 as default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># instance selector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">haproxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># haproxy specific fields</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">maxconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3000</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># default front-end connection</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">balance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">roundrobin  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># load balance algorithm (roundrobin by default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">default_server_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;inter 3s fastinter 1s downinter 5s rise 3 fall 3 on-marked-down shutdown-sessions slowstart 30s maxconn 3000 maxqueue 128 weight 100&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># offline service will route {ip|name}:5438 to offline postgres (5438-&gt;5432 offline)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">offline          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service name {{ pg_cluster }}_replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5438</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/replica    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># offline MUST be a replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `offline` || pg_offline_query ]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># instances with pg_role == &#39;offline&#39; or instance marked with &#39;pg_offline_query == true&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector_backup</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[? pg_role == `replica` &amp;&amp; !pg_offline_query]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># replica are used as backup server in offline service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_services_extra</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># extra services to be added</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - haproxy - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># enable haproxy among every cluster members</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># reload haproxy after config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_policy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">roundrobin                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># roundrobin, leastconn</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_auth_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># enable authentication for haproxy admin?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">admin                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default haproxy admin username</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">admin                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default haproxy admin password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_exporter_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">9101</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># default admin/exporter port</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_client_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">3h                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># client side connection timeout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_server_timeout</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">3h                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># server side connection timeout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - vip - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none                               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># none | l2 | l4</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                              </span><span style="color:#8f5902;font-style:italic"># whether reload service after config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_address: 127.0.0.1                      # virtual ip address ip (l2 or l4)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_cidrmask: 24                            # virtual ip address cidr mask (l2 only)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># vip_interface: eth0                         # virtual ip network interface (l2 only)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>New Options</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># - localization - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default to UTF8</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default to C</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_lc_collate</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default to C</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_lc_ctype</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">en_US.UTF8                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># default to en_US.UTF8</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                               </span><span style="color:#8f5902;font-style:italic"># reload postgres after hba changes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none                               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># none | l2 | l4</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">vip_reload</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                              </span><span style="color:#8f5902;font-style:italic"># whether reload service after config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>Remove Options</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>haproxy_check_port                            # covered by service options
</span></span><span style="display:flex;"><span>haproxy_primary_port
</span></span><span style="display:flex;"><span>haproxy_replica_port
</span></span><span style="display:flex;"><span>haproxy_backend_port
</span></span><span style="display:flex;"><span>haproxy_weight
</span></span><span style="display:flex;"><span>haproxy_weight_fallback
</span></span><span style="display:flex;"><span>vip_enabled                                   # replace by vip_mode
</span></span></code></pre></div><h3 id="service">Service</h3>
<p><code>pg_services</code> and <code>pg_services_extra</code> Defines the services in cluster:</p>
<p>A service has some mandatory fields:</p>
<ul>
<li><code>name</code>: service&rsquo;s name</li>
<li><code>src_port</code>: which port to listen and expose service?</li>
<li><code>selector</code>: which instances belonging to this service?</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># default service will route {ip|name}:5436 to primary postgres (5436-&gt;5432 primary)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># service&#39;s actual name is {{ pg_cluster }}-{{ service.name }}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_ip</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">             </span><span style="color:#8f5902;font-style:italic"># service bind ip address, * for all, vip for cluster virtual ip address</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">src_port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">5436</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># bind port, mandatory</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dst_port: postgres      # target port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres|pgbouncer|port_number , pgbouncer(6432) by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_method: http      # health check method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">only http is available for now</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_port: patroni     # health check port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">patroni|pg_exporter|port_number , patroni by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/primary    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># health check url path, / as default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">check_code</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">200</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># health check http code, 200 as default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># instance selector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">haproxy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># haproxy specific fields</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">maxconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">3000</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># default front-end connection</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">balance</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">roundrobin  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># load balance algorithm (roundrobin by default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">default_server_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;inter 3s fastinter 1s downinter 5s rise 3 fall 3 on-marked-down shutdown-sessions slowstart 30s maxconn 3000 maxqueue 128 weight 100&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="database">Database</h3>
<p>Add additional locale support: <code>lc_ctype</code> and <code>lc_collate</code>.</p>
<p>It&rsquo;s mainly because of <code>pg_trgm</code> &rsquo;s weird behavior on i18n characters.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># name is the only required field for a database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># owner: postgres                 # optional, database owner</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># template: template1             # optional, template1 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># encoding: UTF8                # optional, UTF8 by default , must same as template database, leave blank to set to db default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># locale: C                     # optional, C by default , must same as template database, leave blank to set to db default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># lc_collate: C                 # optional, C by default , must same as template database, leave blank to set to db default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># lc_ctype: C                   # optional, C by default , must same as template database, leave blank to set to db default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">allowconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, true by default, false disable connect at all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">revokeconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># optional, false by default, true revoke connect from public # (only default user and owner have connect privilege on database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># tablespace: pg_default          # optional, &#39;pg_default&#39; is the default tablespace</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, connection limit, -1 or none disable limit (default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extension name and where to create</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#204a87;font-weight:bold">name: postgis, schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extra parameters with ALTER DATABASE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable_partitionwise_join</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, add this database to pgbouncer list? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty meta database  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, comment string for database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-a757729041ec674785eddd6b2c1694e2">v0.7.0 Release Note</h1>
	<div class="lead">v0.7 Monitor Only Deployment</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2021-03-01" class="text-muted">2021-03-01</time>
        
	</div>
	<hr>
<h2 id="v070">v0.7.0</h2>
<h3 id="overview">Overview</h3>
<ul>
<li>
<p>Monitor Only Deployment</p>
<ul>
<li>Now you can monitor existing postgres clusters without Pigsty provisioning solution.</li>
<li>Intergration with other provisioning solution is available and under further test.</li>
</ul>
</li>
<li>
<p>Database/User Management</p>
<ul>
<li>Update user/database definition schema to cover more usecases.</li>
<li>Add <code>pgsql-createdb.yml</code> and <code>pgsql-createuser.yml</code> to mange user/db on running clusters.</li>
</ul>
</li>
</ul>
<h2 id="features">Features</h2>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/25">Monitor Only Deployment Support #25</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/36">Split monolith static monitor target file into per-cluster conf #36</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/29">Add create user playbook #29</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/28">Add create database playbook #28</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/33">Database provisioning interface enhancement #33</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/34">User provisioning interface enhancement #34</a></li>
</ul>
<h2 id="bug-fix">Bug Fix</h2>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/32">Create extension with schema typo #32</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/35">pgbouncer reload with systemctl not work #35</a></li>
</ul>
<h2 id="api-changes">API Changes</h2>
<p><strong>New Options</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">prometheus_sd_target</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">batch                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># batch|single</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_install</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none                       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># none|yum|binary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">exporter_repo_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># add to yum repo if set</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--no-collector.softnet --collector.systemd --collector.ntp --collector.tcpstat --collector.processes&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># default opts for node_exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># optional, overwrite default pg_exporter target</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># optional, overwrite default pgbouncer_expoter target</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>Remove Options</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">exporter_binary_install</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># covered by exporter_install</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>Structure Changes</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">pg_default_roles                              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># refer to pg_users</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">pg_users                                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># refer to pg_users</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">pg_databases                                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># refer to pg_databases</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>Rename Options</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#000">pg_default_privilegs -&gt; pg_default_privileges </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># fix typo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="enhancement">Enhancement</h3>
<p><strong>Monitoring Provisioning Enhancement</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/13">Decouple consul #13</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/14">Binary install mode for node_exporter and pg_exporter #14</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/11">Prometheus static targets mode support #11</a></li>
</ul>
<p><strong>Haproxy Enhancement</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/10">Adjust relative traffic weight with configuration #10</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/12">HAProxy admin page access via nginx #12</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/8">Readonly traffic fallback on primary if all replicas down #8</a></li>
</ul>
<p><strong>Security Enhancement</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/7">Offline access control #7</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/9">Safeguard for purge functionality #9</a></li>
</ul>
<p><strong>Software Update</strong></p>
<ul>
<li>
<p><a href="https://github.com/Vonng/pigsty/issues/6">Upgrade to PG 13.2 #6</a></p>
</li>
<li>
<p>Prometheus 2.25 / Grafana 7.4 / Consul 1.9.3 / Node Exporter 1.1 / PG Exporter 0.3.2</p>
</li>
</ul>
<h3 id="api-change">API Change</h3>
<p><strong>New Config Entries</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">service_registry</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consul                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># none | consul | etcd | both</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--storage.tsdb.retention=30d&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># prometheus cli opts</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_method: consul                  # Prometheus service discovery method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">static|consul</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">2s                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Prometheus service discovery refresh interval</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_offline_query</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># set to true to allow offline queries on this instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># enabling Node Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># enabling PG Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># enabling Pgbouncer Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">export_binary_install</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># install Node/PG Exporter via copy binary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">dcs_disable_purge</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># force dcs_exists_action = abort to avoid dcs purge</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_disable_purge</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># force pg_exists_action = abort to avoid pg purge</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_weight</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># relative lb weight for backend instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_weight_fallback</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># primary server weight in replica service group</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>Obsolete Config Entries</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">prometheus_metrics_path                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># duplicate with exporter_metrics_path </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">prometheus_retention                         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># covered by `prometheus_options`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h4 id="database-definition">Database Definition</h4>
<p><a href="https://github.com/Vonng/pigsty/issues/33">Database provisioning interface enhancement #33</a></p>
<h4 id="old-schema">Old Schema</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># create a business database &#39;meta&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">meta]                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># create extra schema named &#39;meta&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span>{<span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgis}]  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># create extra extension postgis</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># overwrite database meta&#39;s default search_path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">search_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public, monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h4 id="new-schema">New Schema</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">meta                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># name is the only required field for a database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">owner</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, database owner</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">template1            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, template1 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTF8                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, UTF8 by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">locale</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">C                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, C by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">allowconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, true by default, false disable connect at all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">revokeconn</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># optional, false by default, true revoke connect from public # (only default user and owner have connect privilege on database)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">tablespace</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_default         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, &#39;pg_default&#39; is the default tablespace</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># optional, connection limit, -1 or none disable limit (default)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extension name and where to create</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- {<span style="color:#204a87;font-weight:bold">name: postgis, schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># optional, extra parameters with ALTER DATABASE</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable_partitionwise_join</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># optional, add this database to pgbouncer list? true by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pigsty meta database  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># optional, comment string for database</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h4 id="changes">Changes</h4>
<ul>
<li>Add new options: <code>template</code> , <code>encoding</code>, <code>locale</code>, <code>allowconn</code>, <code>tablespace</code>, <code>connlimit</code></li>
<li>Add new option <code>revokeconn</code>, which revoke connect privileges from public for this database</li>
<li>Add <code>comment</code> field for database</li>
</ul>
<h4 id="apply-changes">Apply Changes</h4>
<p>You can create new database on running postgres clusters with <code>pgsql-createdb.yml</code> playbook.</p>
<ol>
<li>Define your new database in config files</li>
<li>Pass new database.name with option <code>pg_database</code> to playbook.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./pgsql-createdb.yml -e <span style="color:#000">pg_database</span><span style="color:#ce5c00;font-weight:bold">=</span>&lt;your_new_database_name&gt;
</span></span></code></pre></div><h3 id="user-definition">User Definition</h3>
<p><a href="https://github.com/Vonng/pigsty/issues/34">User provisioning interface enhancement #34</a></p>
<h4 id="old-schema-1">Old Schema</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># example production user have read-write access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># example user&#39;s password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">LOGIN                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># extra options</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_readwrite ]   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dborole_admin|dbrole_readwrite|dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default test user for production usage</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># add to pgbouncer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h4 id="new-schema-1">New Schema</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># complete example of user/role definition for production user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_meta              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># example production user have read-write access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Meta          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># example user&#39;s password, can be encrypted</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">login</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># can login, true by default (should be false for role)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">superuser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># is superuser? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">createdb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># can create database? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">createrole</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># can create role? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">inherit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># can this role use inherited privileges?</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">replication</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># can this role do replication? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">bypassrls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># can this role bypass row level security? false by default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">connlimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>-<span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># connection limit, -1 disable limit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">expire_at</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;2030-12-31&#39;</span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#8f5902;font-style:italic"># &#39;timestamp&#39; when this role is expired</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">expire_in</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">365</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># now + n days when this role is expired (OVERWRITE expire_at)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_readwrite]      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dborole_admin|dbrole_readwrite|dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">pgbouncer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                 </span><span style="color:#8f5902;font-style:italic"># add this user to pgbouncer? false by default (true for production user)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># user&#39;s default search path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">search_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h4 id="changes-1">Changes</h4>
<ul>
<li><code>username</code> field rename to <code>name</code></li>
<li><code>groups</code> field rename to <code>roles</code></li>
<li><code>options</code> now split into separated configration entries:
<code>login</code>, <code>superuser</code>, <code>createdb</code>, <code>createrole</code>, <code>inherit</code>, <code>replication</code>,<code>bypassrls</code>,<code>connlimit</code></li>
<li><code>expire_at</code> and <code>expire_in</code> options</li>
<li><code>pgbouncer</code> option for user is now <code>false</code> by default</li>
</ul>
<h4 id="apply-changes-1">Apply Changes</h4>
<p>You can create new users on running postgres clusters with <code>pgsql-createuser.yml</code> playbook.</p>
<ol>
<li>Define your new users in config files (<code>pg_users</code>)</li>
<li>Pass new user.name with option <code>pg_user</code> to playbook.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./pgsql-createuser.yml -e <span style="color:#000">pg_user</span><span style="color:#ce5c00;font-weight:bold">=</span>&lt;your_new_user_name&gt;
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-9d3157a4b85f04c552b9dc4e0605e241">v0.6.0 Release Note</h1>
	<div class="lead">v0.6 Provisioning Enhancement</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2021-02-19" class="text-muted">2021-02-19</time>
        
	</div>
	<hr>
<h2 id="v060">v0.6.0</h2>
<h3 id="bug-fix">Bug Fix</h3>
<ul>
<li>
<p><a href="https://github.com/Vonng/pigsty/issues/5">pg_hba reset on patroni restart (patroni 2.0) #5</a></p>
</li>
<li>
<p>Merge <a href="https://github.com/Vonng/pigsty/pull/1">Fix name of dashboard #1</a>, Fix PG Overview Dashboard typo</p>
</li>
<li>
<p>Fix default primary instance to <code>pg-test-1</code> of cluster <code>pg-test</code> in sandbox environment</p>
</li>
<li>
<p>Fix obsolete comments</p>
</li>
</ul>
<h3 id="enhancement">Enhancement</h3>
<p><strong>Monitoring Provisioning Enhancement</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/13">Decouple consul #13</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/14">Binary install mode for node_exporter and pg_exporter #14</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/11">Prometheus static targets mode support #11</a></li>
</ul>
<p><strong>Haproxy Enhancement</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/10">Adjust relative traffic weight with configuration #10</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/12">HAProxy admin page access via nginx #12</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/8">Readonly traffic fallback on primary if all replicas down #8</a></li>
</ul>
<p><strong>Security Enhancement</strong></p>
<ul>
<li><a href="https://github.com/Vonng/pigsty/issues/7">Offline access control #7</a></li>
<li><a href="https://github.com/Vonng/pigsty/issues/9">Safeguard for purge functionality #9</a></li>
</ul>
<p><strong>Software Update</strong></p>
<ul>
<li>
<p><a href="https://github.com/Vonng/pigsty/issues/6">Upgrade to PG 13.2 #6</a></p>
</li>
<li>
<p>Prometheus 2.25 / Grafana 7.4 / Consul 1.9.3 / Node Exporter 1.1 / PG Exporter 0.3.2</p>
</li>
</ul>
<h3 id="api-change">API Change</h3>
<p><strong>New Config Entries</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">service_registry</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">consul                     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># none | consul | etcd | both</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;--storage.tsdb.retention=30d&#39;</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># prometheus cli opts</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_method: consul                  # Prometheus service discovery method</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">static|consul</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">prometheus_sd_interval</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">2s                   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Prometheus service discovery refresh interval</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_offline_query</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># set to true to allow offline queries on this instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">node_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># enabling Node Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># enabling PG Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_exporter_enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># enabling Pgbouncer Exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">export_binary_install</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># install Node/PG Exporter via copy binary</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">dcs_disable_purge</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                      </span><span style="color:#8f5902;font-style:italic"># force dcs_exists_action = abort to avoid dcs purge</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_disable_purge</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># force pg_exists_action = abort to avoid pg purge</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_weight</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># relative lb weight for backend instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">haproxy_weight_fallback</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># primary server weight in replica service group</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><strong>Obsolete Config Entries</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000">prometheus_metrics_path                      </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># duplicate with exporter_metrics_path </span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">prometheus_retention                         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># covered by `prometheus_options`</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-a31bec40c01f539af16d13999ac7c1ab">v0.5.0 Release Note</h1>
	<div class="lead">Pigsty v0.5.0  has significant improvement on database templating</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2020-12-20" class="text-muted">2020-12-20</time>
        
	</div>
	<hr>
<h2 id="v050">v0.5.0</h2>
<p>Pigsty now have an <a href="http://pigsty.cc/">Official Site</a> 🎉 !</p>
<h2 id="new-features">New Features</h2>
<ul>
<li>Add Database Provision Template</li>
<li>Add Init Template</li>
<li>Add Business Init Template</li>
<li>Refactor HBA Rules variables</li>
<li>Fix dashboards bugs.</li>
<li>Move <code>pg-cluster-replication</code> to default dashboards</li>
<li>Use ZJU PostgreSQL mirror as default to accelerate repo build phase.</li>
<li>Move documentation to official site:  <a href="https://pigsty.cc">https://pigsty.cc</a></li>
<li>Download newly created offline installation packages:  <a href="https://github.com/Vonng/pigsty/releases/download/v0.5.0/pkg.tgz">pkg.tgz</a> (v0.5)</li>
</ul>
<h2 id="database-provision-template">Database Provision Template</h2>
<p>Now you can customize your database content with pigsty !</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">pg_users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default test user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_readwrite ]   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># dborole_admin|dbrole_readwrite|dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_databases</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># create a business database &#39;test&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span>{<span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgis}]  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># create extra extension postgis</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">parameters</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># overwrite database meta&#39;s default search_path</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">search_path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">public,monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><a href="https://github.com/Vonng/pigsty/blob/main/roles/postgres/templates/pg-init-template.sql">pg-init-template.sql</a> wil be used as default template1 database init script
<a href="https://github.com/Vonng/pigsty/blob/main/roles/postgres/templates/pg-init-business.sql">pg-init-business.sql</a> will be used as default business database init script</p>
<p>you can customize default role system, schemas, extensions, privileges with variables now:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># - system roles - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_replication_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replicator          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system replication user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_replication_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Replicator   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system replication password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_monitor_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_monitor          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system monitor user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_monitor_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Monitor          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system monitor password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_admin_username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_admin              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_admin_password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Admin              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># system admin password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># - default roles - #</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_roles</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">dbrole_readonly                 # sample user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">NOLOGIN                         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># role can not login</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for readonly access        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># comment string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username: dbrole_readwrite                # sample user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">one object for each user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">NOLOGIN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for read-write access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbrole_readonly ]              </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># read-write includes read-only access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username: dbrole_admin                    # sample user</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">one object for each user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">NOLOGIN BYPASSRLS               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># admin can bypass row level security</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">role for object creation</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_readwrite,pg_monitor,pg_signal_backend]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># NOTE: replicator, monitor, admin password are overwritten by separated config entry</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres                       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># reset dbsu password to NULL (if dbsu is not postgres)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SUPERUSER LOGIN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system superuser</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">REPLICATION LOGIN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">pg_monitor, dbrole_readonly]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system replicator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">LOGIN CONNECTION LIMIT 10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system monitor user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">pg_monitor, dbrole_readonly]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">LOGIN BYPASSRLS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">system admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_admin]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dbuser_stats</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DBUser.Stats</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">options</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">LOGIN</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">business read-only user for statistics</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">groups</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dbrole_readonly]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># object created by dbsu and admin will have their privileges properly set</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_privilegs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE                         ON SCHEMAS   TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT                        ON TABLES    TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT SELECT                        ON SEQUENCES TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT EXECUTE                       ON FUNCTIONS TO dbrole_readonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT INSERT, UPDATE, DELETE        ON TABLES    TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE,  UPDATE                ON SEQUENCES TO dbrole_readwrite</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT TRUNCATE, REFERENCES, TRIGGER ON TABLES    TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT CREATE                        ON SCHEMAS   TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">GRANT USAGE                         ON TYPES     TO dbrole_admin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># schemas</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_schemas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">monitor]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># extension</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_default_extensions</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_stat_statements&#39;,  schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pgstattuple&#39;,         schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_qualstats&#39;,        schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_buffercache&#39;,      schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pageinspect&#39;,         schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_prewarm&#39;,          schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_visibility&#39;,       schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_freespacemap&#39;,     schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- {<span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">name: &#39;pg_repack&#39;,           schema</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;monitor&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">postgres_fdw</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">file_fdw</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">btree_gist</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">btree_gin</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">pg_trgm</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">intagg</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">intarray</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># postgres host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow meta node password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     all                         10.10.10.10/32      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow intranet admin password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_admin               10.0.0.0/8          md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_admin               172.16.0.0/12       md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_admin               192.168.0.0/16      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow intranet password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all             all                 10.0.0.0/8          md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all             all                 172.16.0.0/12       md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all             all                 192.168.0.0/16      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow local read-write access (local production user via pgbouncer)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">local   all     +dbrole_readwrite                               md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_readwrite           127.0.0.1/32        md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">allow read-only user (stats, personal) password directly access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">replica</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">local   all     +dbrole_readonly                               md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host    all     +dbrole_readonly           127.0.0.1/32        md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pg_hba_rules_extra</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># pgbouncer host-based authentication rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_hba_rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">local  all          all                                     md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host   all          all                     127.0.0.1/32    md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">intranet password access</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">role</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">common</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rules</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host   all          all                     10.0.0.0/8      md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host   all          all                     172.16.0.0/12   md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000">host   all          all                     192.168.0.0/16  md5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">pgbouncer_hba_rules_extra</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-b5d77a188caf8e3a09a3d3b5b8acaa94">v0.4.0 Release Note</h1>
	<div class="lead">The second public beta (v0.4.0) of pigsty is available now</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2020-12-14" class="text-muted">2020-12-14</time>
        
	</div>
	<hr>
<h2 id="v040">v0.4.0</h2>
<p>The second public beta (v0.4.0) of pigsty is available now ! 🎉</p>
<h2 id="monitoring-system">Monitoring System</h2>
<p><strong>Skim version of monitoring system</strong> consist of 10 essential dashboards:</p>
<ul>
<li>PG Overview</li>
<li>PG Cluster</li>
<li>PG Service</li>
<li>PG Instance</li>
<li>PG Database</li>
<li>PG Query</li>
<li>PG Table</li>
<li>PG Table Catalog</li>
<li>PG Table Detail</li>
<li>Node</li>
</ul>
<h2 id="software-upgrade">Software upgrade</h2>
<ul>
<li>Upgrade to PostgreSQL 13.1, Patroni 2.0.1-4, add citus to repo.</li>
<li>Upgrade to <a href="https://github.com/Vonng/pg_exporter/releases/tag/v0.3.1"><code>pg_exporter 0.3.1</code></a></li>
<li>Upgrade to Grafana 7.3, Ton&rsquo;s of compatibility work</li>
<li>Upgrade to prometheus 2.23, with new UI as default</li>
<li>Upgrade to consul 1.9</li>
</ul>
<h2 id="misc">Misc</h2>
<ul>
<li>Update prometheus alert rules</li>
<li>Fix alertmanager info links</li>
<li>Fix bugs and typos.</li>
<li>add a simple backup script</li>
</ul>
<h2 id="offline-installation"><strong>Offline Installation</strong></h2>
<ul>
<li><a href="https://github.com/Vonng/pigsty/releases/download/v0.4.0/pkg.tgz">pkg.tgz</a> is the latest offline install package (1GB rpm packages, made under CentOS 7.8)</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7df560570ddd6f526d521202261d0bf9">v0.3.0 Release Note</h1>
	<div class="lead">Pigsty v0.3.0 First Public Beta now available!</div>
	<div class="td-byline mb-4">
		By <b>Ruohang Feng(<a href="https://vonng.com/en/">@Vonng</a>)</b> |
        
		<time datetime="2020-10-24" class="text-muted">2020-10-24</time>
        
	</div>
	<hr>
<h2 id="v030">v0.3.0</h2>
<p>The first public beta (v0.3.0) of pigsty is available now ! 🎉</p>
<h2 id="monitoring-system">Monitoring System</h2>
<p><strong>Skim version of monitoring system</strong> consist of 8 essential dashboards:</p>
<ul>
<li>PG Overview</li>
<li>PG Cluster</li>
<li>PG Service</li>
<li>PG Instance</li>
<li>PG Database</li>
<li>PG Table Overview</li>
<li>PG Table Catalog</li>
<li>Node</li>
</ul>
<h2 id="database-cluster-provision"><strong>Database Cluster Provision</strong></h2>
<ul>
<li>All config files are merged into one file: <code>conf/all.yml</code> by default</li>
<li>Use <code>infra.yml</code> to provision meta node(s) and infrastructure</li>
<li>Use <code>initdb.yml</code> to provision database clusters</li>
<li>Use <code>ins-add.yml</code> to add new instance to database cluster</li>
<li>Use <code>ins-del.yml</code> to remove instance from database cluster</li>
</ul>
<h2 id="offline-installation"><strong>Offline Installation</strong></h2>
<ul>
<li><a href="https://github.com/Vonng/pigsty/releases/download/v0.3.0/pkg.tgz">pkg.tgz</a> is the latest offline install package (1GB rpm packages, made under CentOS 7.8)</li>
</ul>

</div>





    
	
  

    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Mail" aria-label="Mail">
    <a target="_blank" rel="noopener" href="mailto:rh@vonng.com" aria-label="Mail">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/Vonng/pigsty" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/GobeUncleWang" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="WeChat" aria-label="WeChat">
    <a target="_blank" rel="noopener" href="/img/pigsty/pigsty-cc.jpg" aria-label="WeChat">
      <i class="fa fa-comment"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Discord" aria-label="Discord">
    <a target="_blank" rel="noopener" href="https://discord.gg/wDzt5VyWEz" aria-label="Discord">
      <i class="fab fa-discord"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Telegram" aria-label="Telegram">
    <a target="_blank" rel="noopener" href="https://t.me/joinchat/gV9zfZraNPM3YjFh" aria-label="Telegram">
      <i class="fab fa-telegram"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2018&ndash;2025
    <span class="td-footer__authors">Ruohang Feng</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span></span><span class="ms-2"><a href="https://vonng.com/en/" target="_blank" rel="noopener">@Vonng</a></span>
<br><span>Pigsty® distributed under <a href="/docs/about/license" target="_blank" rel="noopener">AGPLv3</a></span>
<br><span class="ms-2"><a href="/docs/about/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
<span><a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">浙ICP备15016890号</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.248655eb216150e39da254c2f7aa5357805d0ec66bdb741b591cd35fb5f629ab.js" integrity="sha256-JIZV6yFhUOOdolTC96pTV4BdDsZr23QbWRzTX7X2Kas=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
